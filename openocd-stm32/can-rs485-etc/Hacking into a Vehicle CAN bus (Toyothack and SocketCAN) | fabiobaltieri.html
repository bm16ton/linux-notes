<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head profile="http://gmpg.org/xfn/11">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>Hacking into a Vehicle CAN bus (Toyothack and SocketCAN) | fabiobaltieri</title>
	<link rel="pingback" href="https://fabiobaltieri.com/xmlrpc.php">
	<meta name="robots" content="max-image-preview:large">
<meta name="google-site-verification" content="JOrcXaaXV3pQ_4aOOW20szJJ0d_Xi_DK-1sYgvg2lfg">

<!-- Async WordPress.com Remote Login -->
<script id="wpcom_remote_login_js">
var wpcom_remote_login_extra_auth = '';
function wpcom_remote_login_remove_dom_node_id( element_id ) {
	var dom_node = document.getElementById( element_id );
	if ( dom_node ) { dom_node.parentNode.removeChild( dom_node ); }
}
function wpcom_remote_login_remove_dom_node_classes( class_name ) {
	var dom_nodes = document.querySelectorAll( '.' + class_name );
	for ( var i = 0; i < dom_nodes.length; i++ ) {
		dom_nodes[ i ].parentNode.removeChild( dom_nodes[ i ] );
	}
}
function wpcom_remote_login_final_cleanup() {
	wpcom_remote_login_remove_dom_node_classes( "wpcom_remote_login_msg" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_remote_login_key" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_remote_login_validate" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_remote_login_js" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_request_access_iframe" );
	wpcom_remote_login_remove_dom_node_id( "wpcom_request_access_styles" );
}

// Watch for messages back from the remote login
window.addEventListener( "message", function( e ) {
	if ( e.origin === "https://r-login.wordpress.com" ) {
		var data = {};
		try {
			data = JSON.parse( e.data );
		} catch( e ) {
			wpcom_remote_login_final_cleanup();
			return;
		}

		if ( data.msg === 'LOGIN' ) {
			// Clean up the login check iframe
			wpcom_remote_login_remove_dom_node_id( "wpcom_remote_login_key" );

			var id_regex = new RegExp( /^[0-9]+$/ );
			var token_regex = new RegExp( /^.*|.*|.*$/ );
			if (
				token_regex.test( data.token )
				&& id_regex.test( data.wpcomid )
			) {
				// We have everything we need to ask for a login
				var script = document.createElement( "script" );
				script.setAttribute( "id", "wpcom_remote_login_validate" );
				script.src = '/remote-login.php?wpcom_remote_login=validate'
					+ '&wpcomid=' + data.wpcomid
					+ '&token=' + encodeURIComponent( data.token )
					+ '&host=' + window.location.protocol
					+ '//' + window.location.hostname
					+ '&postid=1419'
					+ '&is_singular=1';
				document.body.appendChild( script );
			}

			return;
		}

		// Safari ITP, not logged in, so redirect
		if ( data.msg === 'LOGIN-REDIRECT' ) {
			window.location = 'https://wordpress.com/log-in?redirect_to=' + window.location.href;
			return;
		}

		// Safari ITP, storage access failed, remove the request
		if ( data.msg === 'LOGIN-REMOVE' ) {
			var css_zap = 'html { -webkit-transition: margin-top 1s; transition: margin-top 1s; } /* 9001 */ html { margin-top: 0 !important; } * html body { margin-top: 0 !important; } @media screen and ( max-width: 782px ) { html { margin-top: 0 !important; } * html body { margin-top: 0 !important; } }';
			var style_zap = document.createElement( 'style' );
			style_zap.type = 'text/css';
			style_zap.appendChild( document.createTextNode( css_zap ) );
			document.body.appendChild( style_zap );

			var e = document.getElementById( 'wpcom_request_access_iframe' );
			e.parentNode.removeChild( e );

			document.cookie = 'wordpress_com_login_access=denied; path=/; max-age=31536000';

			return;
		}

		// Safari ITP
		if ( data.msg === 'REQUEST_ACCESS' ) {
			console.log( 'request access: safari' );

			// Check ITP iframe enable/disable knob
			if ( wpcom_remote_login_extra_auth !== 'safari_itp_iframe' ) {
				return;
			}

			// If we are in a "private window" there is no ITP.
			var private_window = false;
			try {
				var opendb = window.openDatabase( null, null, null, null );
			} catch( e ) {
				private_window = true;
			}

			if ( private_window ) {
				console.log( 'private window' );
				return;
			}

			var iframe = document.createElement( 'iframe' );
			iframe.id = 'wpcom_request_access_iframe';
			iframe.setAttribute( 'scrolling', 'no' );
			iframe.setAttribute( 'sandbox', 'allow-storage-access-by-user-activation allow-scripts allow-same-origin allow-top-navigation-by-user-activation' );
			iframe.src = 'https://r-login.wordpress.com/remote-login.php?wpcom_remote_login=request_access&origin=' + encodeURIComponent( data.origin ) + '&wpcomid=' + encodeURIComponent( data.wpcomid );

			var css = 'html { -webkit-transition: margin-top 1s; transition: margin-top 1s; } /* 9001 */ html { margin-top: 46px !important; } * html body { margin-top: 46px !important; } @media screen and ( max-width: 660px ) { html { margin-top: 71px !important; } * html body { margin-top: 71px !important; } #wpcom_request_access_iframe { display: block; height: 71px !important; } } #wpcom_request_access_iframe { border: 0px; height: 46px; position: fixed; top: 0; left: 0; width: 100%; min-width: 100%; z-index: 99999; background: #23282d; } ';

			var style = document.createElement( 'style' );
			style.type = 'text/css';
			style.id = 'wpcom_request_access_styles';
			style.appendChild( document.createTextNode( css ) );
			document.body.appendChild( style );

			document.body.appendChild( iframe );
		}

		if ( data.msg === 'DONE' ) {
			wpcom_remote_login_final_cleanup();
		}
	}
}, false );

// Inject the remote login iframe after the page has had a chance to load
// more critical resources
window.addEventListener( "DOMContentLoaded", function( e ) {
	var iframe = document.createElement( "iframe" );
	iframe.style.display = "none";
	iframe.setAttribute( "scrolling", "no" );
	iframe.setAttribute( "id", "wpcom_remote_login_key" );
	iframe.src = "https://r-login.wordpress.com/remote-login.php"
		+ "?wpcom_remote_login=key"
		+ "&origin=aHR0cHM6Ly9mYWJpb2JhbHRpZXJpLmNvbQ%3D%3D"
		+ "&wpcomid=26221171"
		+ "&time=1635466655";
	document.body.appendChild( iframe );
}, false );
</script>
<link rel="dns-prefetch" href="https://s0.wp.com/">
<link rel="dns-prefetch" href="https://fabiobaltieri.wordpress.com/">
<link rel="dns-prefetch" href="https://s.pubmine.com/">
<link rel="dns-prefetch" href="https://x.bidswitch.net/">
<link rel="dns-prefetch" href="https://static.criteo.net/">
<link rel="dns-prefetch" href="https://ib.adnxs.com/">
<link rel="dns-prefetch" href="https://aax.amazon-adsystem.com/">
<link rel="dns-prefetch" href="https://bidder.criteo.com/">
<link rel="dns-prefetch" href="https://cas.criteo.com/">
<link rel="dns-prefetch" href="https://gum.criteo.com/">
<link rel="dns-prefetch" href="https://ads.pubmatic.com/">
<link rel="dns-prefetch" href="https://gads.pubmatic.com/">
<link rel="dns-prefetch" href="https://tpc.googlesyndication.com/">
<link rel="dns-prefetch" href="https://ad.doubleclick.net/">
<link rel="dns-prefetch" href="https://googleads.g.doubleclick.net/">
<link rel="dns-prefetch" href="https://www.googletagservices.com/">
<link rel="dns-prefetch" href="https://cdn.switchadhub.com/">
<link rel="dns-prefetch" href="https://delivery.g.switchadhub.com/">
<link rel="dns-prefetch" href="https://delivery.swid.switchadhub.com/">
<link rel="dns-prefetch" href="https://a.teads.tv/">
<link rel="dns-prefetch" href="https://prebid.media.net/">
<link rel="dns-prefetch" href="https://adserver-us.adtech.advertising.com/">
<link rel="dns-prefetch" href="https://fastlane.rubiconproject.com/">
<link rel="dns-prefetch" href="https://prebid-server.rubiconproject.com/">
<link rel="dns-prefetch" href="https://hb-api.omnitagjs.com/">
<link rel="dns-prefetch" href="https://mtrx.go.sonobi.com/">
<link rel="dns-prefetch" href="https://apex.go.sonobi.com/">
<link rel="dns-prefetch" href="https://u.openx.net/">
<link rel="alternate" type="application/rss+xml" title="fabiobaltieri » Feed" href="https://fabiobaltieri.com/feed/">
<link rel="alternate" type="application/rss+xml" title="fabiobaltieri » Comments Feed" href="https://fabiobaltieri.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="fabiobaltieri » Hacking into a Vehicle CAN bus (Toyothack and&nbsp;SocketCAN) Comments Feed" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/feed/">
	<script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script>
			<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/s0.wp.com\/wp-includes\/js\/wp-emoji-release.min.js?m=1625065786h&ver=5.8.1"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([10084,65039,8205,55357,56613],[10084,65039,8203,55357,56613])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/wp-emoji-release.js" type="text/javascript" defer="defer"></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel="stylesheet" id="all-css-0-1" href="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/a.css" type="text/css" media="all">
<style id="wp-block-library-inline-css">
.has-text-align-justify {
	text-align:justify;
}
</style>
<style id="global-styles-inline-css">
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--normal: 16px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--huge: 42px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-normal-font-size{font-size: var(--wp--preset--font-size--normal) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-huge-font-size{font-size: var(--wp--preset--font-size--huge) !important;}
</style>
<link rel="stylesheet" id="all-css-2-1" href="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/a_002.css" type="text/css" media="all">
<link rel="stylesheet" id="print-css-3-1" href="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/global-print.css" type="text/css" media="print">
<style id="jetpack-global-styles-frontend-style-inline-css">
:root { --font-headings: unset; --font-base: unset; --font-headings-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif; --font-base-default: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;}
</style>
<link rel="stylesheet" id="all-css-6-1" href="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/a_003.css" type="text/css" media="all">
<script id="jetpack_related-posts-js-extra">
var related_posts_js_options = {"post_heading":"h4"};
</script>
<script id="wpcom-actionbar-placeholder-js-extra">
var actionbardata = {"siteID":"26221171","siteName":"fabiobaltieri","siteURL":"https:\/\/fabiobaltieri.com","siteHost":"fabiobaltieri.com","icon":"<img alt='' src='https:\/\/s0.wp.com\/i\/logo\/wpcom-gray-white.png' class='avatar avatar-50' height='50' width='50' \/>","canManageOptions":"","canCustomizeSite":"","isFollowing":"","themeSlug":"pub\/enterprise","signupURL":"https:\/\/wordpress.com\/start\/","loginURL":"https:\/\/wordpress.com\/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Ffabiobaltieri.com%252F2013%252F07%252F23%252Fhacking-into-a-vehicle-can-bus-toyothack-and-socketcan%252F","themeURL":"","xhrURL":"https:\/\/fabiobaltieri.com\/wp-admin\/admin-ajax.php","nonce":"e02494fe4d","isSingular":"1","isFolded":"","isLoggedIn":"","isMobile":"","subscribeNonce":"<input type=\"hidden\" id=\"_wpnonce\" name=\"_wpnonce\" value=\"fafbba3f51\" \/>","referer":"https:\/\/fabiobaltieri.com\/2013\/07\/23\/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan\/","canFollow":"1","feedID":"1021110","statusMessage":"","subsEmailDefault":"instantly","customizeLink":"https:\/\/fabiobaltieri.wordpress.com\/wp-admin\/customize.php?url=https%3A%2F%2Ffabiobaltieri.wordpress.com%2F2013%2F07%2F23%2Fhacking-into-a-vehicle-can-bus-toyothack-and-socketcan%2F","postID":"1419","shortlink":"https:\/\/wp.me\/p1M1k7-mT","canEditPost":"","editLink":"https:\/\/wordpress.com\/post\/fabiobaltieri.com\/1419","statsLink":"https:\/\/wordpress.com\/stats\/post\/1419\/fabiobaltieri.com","i18n":{"view":"View site","follow":"Follow","following":"Following","edit":"Edit","login":"Log in","signup":"Sign up","customize":"Customize","report":"Report this content","themeInfo":"Get theme: Enterprise","shortlink":"Copy shortlink","copied":"Copied","followedText":"New posts from this site will now appear in your <a href=\"https:\/\/wordpress.com\/read\">Reader<\/a>","foldBar":"Collapse this bar","unfoldBar":"Expand this bar","editSubs":"Manage subscriptions","viewReader":"View site in Reader","viewReadPost":"View post in Reader","subscribe":"Sign me up","enterEmail":"Enter your email address","followers":"Join 69 other followers","alreadyUser":"Already have a WordPress.com account? <a href=\"https:\/\/wordpress.com\/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Ffabiobaltieri.com%252F2013%252F07%252F23%252Fhacking-into-a-vehicle-can-bus-toyothack-and-socketcan%252F\">Log in now.<\/a>","stats":"Stats","notifyNewPosts":"Notify me of new posts","notifyNewPostsDetails":"Receive web and mobile notifications for new posts from this site.","emailNewPosts":"Email me new posts","emailNewPostsDetails":"You can customize your notification settings further <a href=\"https:\/\/wordpress.com\/following\/manage?s=fabiobaltieri.com\">here<\/a>.","emailNewComments":"Email me new comments","instantly":"Instantly","daily":"Daily","weekly":"Weekly"}};
</script>
<script crossorigin="anonymous" type="text/javascript" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/a_002.js"></script>
<script type="text/javascript">
	window.addEventListener( 'DOMContentLoaded', function() {
		rltInitialize( {"token":null,"iframeOrigins":["https:\/\/widgets.wp.com"]} );
	} );
</script>
<link rel="stylesheet" id="all-css-0-2" href="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/style.css" type="text/css" media="all">
<!--[if lt IE 8]>
<link rel='stylesheet' id='highlander-comments-ie7-css'  href='https://s0.wp.com/wp-content/mu-plugins/highlander-comments/style-ie7.css?m=1351637563h&#038;ver=20110606' media='all' />
<![endif]-->
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://fabiobaltieri.wordpress.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://s0.wp.com/wp-includes/wlwmanifest.xml"> 
<meta name="generator" content="WordPress.com">
<link rel="canonical" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/">
<link rel="shortlink" href="https://wp.me/p1M1k7-mT">
<link rel="alternate" type="application/json+oembed" href="https://public-api.wordpress.com/oembed/?format=json&amp;url=https%3A%2F%2Ffabiobaltieri.com%2F2013%2F07%2F23%2Fhacking-into-a-vehicle-can-bus-toyothack-and-socketcan%2F&amp;for=wpcom-auto-discovery"><link rel="alternate" type="application/xml+oembed" href="https://public-api.wordpress.com/oembed/?format=xml&amp;url=https%3A%2F%2Ffabiobaltieri.com%2F2013%2F07%2F23%2Fhacking-into-a-vehicle-can-bus-toyothack-and-socketcan%2F&amp;for=wpcom-auto-discovery">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article">
<meta property="og:title" content="Hacking into a Vehicle CAN bus (Toyothack and SocketCAN)">
<meta property="og:url" content="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/">
<meta property="og:description" content="CAN bus is an automation fieldbus commonly used in the automotive industry as the main network bus to allow communications between the many on-board ECUs on modern vehicles. The Linux kernel has na…">
<meta property="article:published_time" content="2013-07-23T14:59:19+00:00">
<meta property="article:modified_time" content="2014-06-15T17:47:27+00:00">
<meta property="og:site_name" content="fabiobaltieri">
<meta property="og:image" content="https://fabiobaltieri.files.wordpress.com/2013/07/toyothack-intro.png">
<meta property="og:image:alt" content="https://fabiobaltieri.files.wordpress.com/2013/07/toyothack-intro.png">
<meta property="og:locale" content="en_US">
<meta name="twitter:site" content="@wordpressdotcom">
<meta name="twitter:text:title" content="Hacking into a Vehicle CAN bus (Toyothack and&nbsp;SocketCAN)">
<meta name="twitter:image" content="https://fabiobaltieri.files.wordpress.com/2013/07/toyothack-intro.png?w=144">
<meta name="twitter:image:alt" content="https://fabiobaltieri.files.wordpress.com/2013/07/toyothack-intro.png">
<meta name="twitter:card" content="summary">
<meta property="article:publisher" content="https://www.facebook.com/WordPresscom">

<!-- End Jetpack Open Graph Tags -->
<link rel="shortcut icon" type="image/x-icon" href="https://s0.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48">
<link rel="icon" type="image/x-icon" href="https://s0.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48">
<link rel="apple-touch-icon" href="https://s0.wp.com/i/webclip.png">
<link rel="openid.server" href="https://fabiobaltieri.com/?openidserver=1">
<link rel="openid.delegate" href="https://fabiobaltieri.com/">
<link rel="search" type="application/opensearchdescription+xml" href="https://fabiobaltieri.com/osd.xml" title="fabiobaltieri">
<link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com">
		<style id="wpcom-hotfix-masterbar-style">
			@media screen and (min-width: 783px) {
				#wpadminbar .quicklinks li#wp-admin-bar-my-account.with-avatar > a img {
					margin-top: 5px;
				}
			}
		</style>
		<meta name="application-name" content="fabiobaltieri"><meta name="msapplication-window" content="width=device-width;height=device-height"><meta name="msapplication-tooltip" content="Fabio Firmware?"><meta name="msapplication-task" content="name=Subscribe;action-uri=https://fabiobaltieri.com/feed/;icon-uri=https://s0.wp.com/i/favicon.ico"><meta name="msapplication-task" content="name=Sign up for a free blog;action-uri=http://wordpress.com/signup/;icon-uri=https://s0.wp.com/i/favicon.ico"><meta name="msapplication-task" content="name=WordPress.com Support;action-uri=http://support.wordpress.com/;icon-uri=https://s0.wp.com/i/favicon.ico"><meta name="msapplication-task" content="name=WordPress.com Forums;action-uri=http://forums.wordpress.com/;icon-uri=https://s0.wp.com/i/favicon.ico"><meta name="description" content="CAN bus is an automation fieldbus commonly used in the automotive industry as the main network bus to allow communications between the many on-board ECUs on modern vehicles. The Linux kernel has native CAN bus support at network layer since some years, with a lot of drivers for both embedded and USB CAN bus controllers,…">
		<style type="text/css">
			#header h1,
			#header h1 a,
			#header h1 a:visited,
			#header h4,
			#header h4 a,
			#header h4 a:visited,
			.header-left {
				color: #333333;
			}
		</style>
		<script type="text/javascript">
		function __ATA_CC() {var v = document.cookie.match('(^|;) ?personalized-ads-consent=([^;]*)(;|$)');return v ? 1 : 0;}
		var __ATA_PP = { 'pt': 1, 'ht': 1, 'tn': 'enterprise', 'amp': false, 'consent': __ATA_CC(), 'gdpr_applies': false, 'ad': { 'label': { 'text': 'Advertisements' }, 'reportAd': { 'text': 'Report this ad' } }, 'siteid': 26221171 };
		var __ATA = __ATA || {};
		__ATA.cmd = __ATA.cmd || [];
		__ATA.criteo = __ATA.criteo || {};
		__ATA.criteo.cmd = __ATA.criteo.cmd || [];
		</script>
		<script type="text/javascript">
		(function(){var g=Date.now||function(){return+new Date};function h(a,b){a:{for(var c=a.length,d="string"==typeof a?a.split(""):a,e=0;e<c;e++)if(e in d&&b.call(void 0,d[e],e,a)){b=e;break a}b=-1}return 0>b?null:"string"==typeof a?a.charAt(b):a[b]};function k(a,b,c){c=null!=c?"="+encodeURIComponent(String(c)):"";if(b+=c){c=a.indexOf("#");0>c&&(c=a.length);var d=a.indexOf("?");if(0>d||d>c){d=c;var e=""}else e=a.substring(d+1,c);a=[a.substr(0,d),e,a.substr(c)];c=a[1];a[1]=b?c?c+"&"+b:b:c;a=a[0]+(a[1]?"?"+a[1]:"")+a[2]}return a};var l=0;function m(a,b){var c=document.createElement("script");c.src=a;c.onload=function(){b&&b(void 0)};c.onerror=function(){b&&b("error")};a=document.getElementsByTagName("head");var d;a&&0!==a.length?d=a[0]:d=document.documentElement;d.appendChild(c)}function n(a){var b=void 0===b?document.cookie:b;return(b=h(b.split("; "),function(c){return-1!=c.indexOf(a+"=")}))?b.split("=")[1]:""}function p(a){return"string"==typeof a&&0<a.length}
		function r(a,b,c){b=void 0===b?"":b;c=void 0===c?".":c;var d=[];Object.keys(a).forEach(function(e){var f=a[e],q=typeof f;"object"==q&&null!=f||"function"==q?d.push(r(f,b+e+c)):null!==f&&void 0!==f&&(e=encodeURIComponent(b+e),d.push(e+"="+encodeURIComponent(f)))});return d.filter(p).join("&")}function t(a,b){a||((window.__ATA||{}).config=b.c,m(b.url))}var u=Math.floor(1E13*Math.random()),v=window.__ATA||{};window.__ATA=v;window.__ATA.cmd=v.cmd||[];v.rid=u;v.createdAt=g();var w=window.__ATA||{},x="s.pubmine.com";
		w&&w.serverDomain&&(x=w.serverDomain);var y="//"+x+"/conf",z=window.top===window,A=window.__ATA_PP&&window.__ATA_PP.gdpr_applies,B="boolean"===typeof A?Number(A):null,C=window.__ATA_PP||null,D=z?document.referrer?document.referrer:null:null,E=z?window.location.href:document.referrer?document.referrer:null,F,G=n("__ATA_tuuid");F=G?G:null;var H=window.innerWidth+"x"+window.innerHeight,I=n("usprivacy"),J=r({gdpr:B,pp:C,rid:u,src:D,ref:E,tuuid:F,vp:H,us_privacy:I?I:null},"",".");
		(function(a){var b=void 0===b?"cb":b;l++;var c="callback__"+g().toString(36)+"_"+l.toString(36);a=k(a,b,c);window[c]=function(d){t(void 0,d)};m(a,function(d){d&&t(d)})})(y+"?"+J);}).call(this);
		</script><script src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/conf"></script><link rel="amphtml" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/amp/"><link rel="stylesheet" type="text/css" href="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/shCore.css"><link rel="stylesheet" type="text/css" href="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/shThemeDefault.css"><link rel="stylesheet" type="text/css" id="gravatar-card-css" href="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/hovercard.css"><link rel="stylesheet" type="text/css" id="gravatar-card-services-css" href="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/services.css"><link href="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/actionbar.css" type="text/css" rel="stylesheet"></head>

<body class="post-template-default single single-post postid-1419 single-format-standard customizer-styles-applied highlander-enabled highlander-light">
			<div id="atatags-262211712-617b3d9fef8aa"></div>
			
			<script>
				__ATA.cmd.push(function() {
					__ATA.initDynamicSlot({
						id: 'atatags-262211712-617b3d9fef8aa',
						location: 110,
						formFactor: '002',
						label: {
							text: 'Advertisements',
						},
						creative: {
							reportAd: {
								text: 'Report this ad',
							},
							privacySettings: {
								text: 'Privacy',
								
							}
						}
					});
				});
			</script>
<div id="header">
	<div class="header-left">
					<h4><a href="https://fabiobaltieri.com/">fabiobaltieri</a></h4>
				<p id="description">Fabio Firmware?</p>
	</div>
	<div class="header-right">
		<form method="get" id="searchform" action="https://fabiobaltieri.com/">
			<div><label class="hidden" for="s">Search:</label>
			<input type="text" name="s" id="s">
			<input type="submit" id="searchsubmit" value="Go"></div>
		</form>
	</div>
</div>
<div id="access">
	<div id="nav">
		<div id="supernav" class="navleft nav">
			<div class="menu"><ul>
<li><a href="https://fabiobaltieri.com/">Home</a></li><li class="page_item page-item-2"><a href="https://fabiobaltieri.com/about/">About Me</a></li>
</ul></div>
		</div>
		<div class="navright">
			<a class="rsslink" rel="nofollow" href="https://fabiobaltieri.com/feed/">Posts</a>
			<a class="rsslink" rel="nofollow" href="https://fabiobaltieri.com/comments/feed/">Comments</a>
		</div>
	</div>

	<div id="subnav" class="subnav nav">
			<div class="menu">
		<ul>
				<li class="cat-item cat-item-79"><a href="https://fabiobaltieri.com/category/hardware/">Hardware</a>
</li>
	<li class="cat-item cat-item-7426"><a href="https://fabiobaltieri.com/category/networking/">Networking</a>
</li>
	<li class="cat-item cat-item-34922710"><a href="https://fabiobaltieri.com/category/linux-2/">Linux</a>
</li>
	<li class="cat-item cat-item-38819914"><a href="https://fabiobaltieri.com/category/avr-2/">AVR</a>
</li>
		</ul>
	</div>
	</div>
</div>

<div id="wrap">
<div id="content">

	<div id="content-left">

		
			<div id="nav-above">
				<div class="nav-previous"><a href="https://fabiobaltieri.com/2013/07/10/inside-a-hantek-dso-2090-usb-oscilloscope/" rel="prev"><span class="meta-nav">←</span> Inside a Hantek DSO-2090 USB&nbsp;Oscilloscope</a></div>
				<div class="nav-next"><a href="https://fabiobaltieri.com/2013/11/18/halogen-led/" rel="next">LED Light Replacement for AC Halogen&nbsp;Lamps <span class="meta-nav">→</span></a></div>
			</div>

			<div class="post-1419 post type-post status-publish format-standard hentry category-hardware category-linux-2 category-networking tag-automotive tag-canbus tag-hack tag-linux tag-obd tag-socketcan tag-toyota">

				<div class="entry">

					<h1>Hacking into a Vehicle CAN bus (Toyothack and&nbsp;SocketCAN)</h1>

					<div class="post-info">
						<p>
							<span class="time">2013/07/23</span>
																						<span class="post-comments"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comments">112 Comments</a></span>
																				</p>
					</div>

					<p><a href="http://en.wikipedia.org/wiki/Canbus">CAN bus</a> is an 
automation fieldbus commonly used in the automotive industry as the main
 network bus to allow communications between the many on-board ECUs on 
modern vehicles.</p>
<p>The Linux kernel has native CAN bus support at network layer since 
some years, with a lot of drivers for both embedded and USB CAN bus 
controllers, so it’s now fairly easy to add a CAN bus interface to any 
Linux laptop and have a playaround with it.</p>
<p>In this post I’ll show how to tap into a modern car local bus, dump a
 bunch of data and analyze the trace offline to write a decoder from 
scratch using the SocketCAN APIs and utilities.</p>
<p>This is based on my experiences hacking into my Toyota…  Toyothack!</p>
<p><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/"><br>
<img src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/toyothack-intro.webp" style="border-width:0;" alt="https://fabiobaltieri.files.wordpress.com/2013/07/toyothack-intro.png"><br>
</a></p>
<p><span id="more-1419"></span></p>
<p><strong>CAN bus Network Model</strong></p>
<p>If you are new to field busses, CAN bus may appear weird at first 
sight.  The bus is physically deployed as a terminated differential 
twisted pair with a ground reference, and it’s usually in a trunk-drop 
topology, where many nodes are connected to a main trunk cable with 
short drop lines, sometimes using T junctions.  The bus runs up to 
1Mbps, and the speed directly influences the max bus length.</p>
<p><img src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/toyothack-trunkdrop.webp" alt="https://fabiobaltieri.files.wordpress.com/2013/07/toyothack-trunkdrop.png" class="aligncenter"></p>
<p>(Image from Maxim <a href="http://datasheets.maximintegrated.com/en/ds/MAX3051.pdf">MAX3051</a> datasheet)</p>
<p>What is really interesting about CAN bus is the actual usage model: 
each packet has single address of either 11 or 29 bits (the latter is 
called extended frame), and a maximum payload of 8 bytes.  The unusual 
thing is that we think of frame address, not source or destination 
address, in fact CAN bus nodes does not have an address at all!</p>
<p><img src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/toyothack-canframe.webp" alt="https://fabiobaltieri.files.wordpress.com/2013/07/toyothack-canframe.png" class="aligncenter"></p>
<p>(Image from Analog Devices <a href="http://www.analog.com/static/imported-files/application_notes/AN-1123.pdf">AN-1123 Application Note</a> datasheet)</p>
<p>The idea behind this is that address are used to identify the type of
 frame (i.e. what’s the meaning of the payload), and all nodes on the 
bus can send and receive any type of frame.  As the bus can have a lot 
of traffic on it, but most nodes only care about some specific frame IDs
 and does not have the computational resources to handle the full 
traffic, each CAN bus controller implements some sort of “acceptance 
filter”, which is usually a bitmask to decide which range of frame 
addresses should be received by the node, while all the others are 
discarded silently.</p>
<p>What this means that while the bus is physically a broadcast (all the
 nodes are connected to the same cable), the protocol makes it work 
logically as multicast.</p>
<p>This makes the bus very well suitable in automotive and automation 
environment, where some sensor may put data on the bus that is used by 
many processors or actuators, and allows to mix nodes with different 
computing power on the same bus.</p>
<p>At the same time, nothing prohibit the designer to assign some frame 
addresses for a logically point-to-point communication between two 
specific nodes, and implement a stream protocol no top of it: in fact 
that’s what is done in the standard <a href="http://en.wikipedia.org/wiki/ISO_15765-2">ISO-TP</a> protocol, and there even is a SocketCAN example application to run a full Linux netdevice on top of it.</p>
<p>One additional feature is that the bus is designed so that lower 
frame addresses have an higher priority when contending for the bus.  
This should be kept into account when designing the high level protocol,
 where often the address is segmented into fields, dedicating an higher 
portion as a “priority” indication.</p>
<p><strong>CAN bus in Automotive</strong></p>
<p>CAN bus was designed for the automotive environment, and that’s where
 it’s still widely deployed.  A modern car have many different ECUs and 
sensors, and the multicast nature of CAN bus makes it ideal to 
distribute the data as needed.</p>
<p>Let’s take vehicle speed as an example, it is transmitted just once 
on the bus by some wheel sensor, and may be used at the same time by the
 dashboard, ABS, cruise control, radio/navigation and other devices.</p>
<p>Of course, some data and some nodes are more important than the 
others, and while CAN bus controller implements some safety features 
such as error counters to self-disconnect from the bus in case of 
errors, the bus itself can still suffer from a catastrophic failure, 
such as a cable short or a cut in the middle.</p>
<p>For this reason, complex cars usually have more than one bus, often 
running at different speed.  As an example that I found on a FIAT car, 
one bus is running at a relatively high speed (500kbps) and it’s wired 
only on the front of the car connecting critical systems, such as engine
 control, ABS, power steering and so on.  An additional bus runs at a 
much lower speed (50kbps), allowing for longer connection segments, and 
it’s only used by the non critical equipments, such as dashboard, 
stereo, electric windows, lights, parking sensors etc.  This one is also
 wired into the CAN pair of the OBD diagnostic connector, making this 
easier to tap into.</p>
<p>All vehicle busses are usually connected to a common ECU at some 
point, which may be used as a proxy to selectively transport some 
information between busses, while keeping the physical isolation for 
safety reasons.</p>
<p>How the bus is laid out is specific to each car, so you may want to 
search for the service manual of a specific model, where you can usually
 found information on the physical bus topology.  Some really complex 
installation may also spot additional LIN busses behind CAN bus nodes…  
Do your own research!</p>
<p><strong>On-Board What??</strong></p>
<p>OBD, or On-board Diagnostics, is a set of standards to provide diagnosis and error reporting from the vehicle ECU.</p>
<p>The idea behind OBD is that as modern vehicles rely heavily on 
electronics and have a many self test capability, a common protocol 
should allow a service center to read some standard error code to help 
troubleshooting.  Once an ECU detect some sensor value is out of a 
“safe” range, the system can store an error code and alert the driver by
 lighting up the well known “check engine” yellow light.  At this point,
 a service center should be able to connect a generic scanner to the 
vehicle standard OBD port, and that should give a indication of what 
have failed in the vehicle history.</p>
<p>How’s that related to CAN bus?  The OBD was originally implemented 
through some simple vendor-specific protocol, at the point that when the
 standard OBD-II connector was defined many different busses, including 
CAN bus, were supported on the same cable, and a generic scanner needed 
to support all of those and guess which one is used on a specific 
vehicle (see <a href="http://elmelectronics.com/obdic.html#ELM327">ELM327</a>).</p>
<p>Luckily enough, vehicle regulations become more specific over time, 
to the point that since 2008, all car sold in the USA are required to 
implement OBD-II in the CAN bus signaling variant.</p>
<p>This means that in most (possibly all) modern cars, you can find a 
standard diagnostic connector accessible somewhere near the dashboard, 
and on this connector you are sure to get access to one of the vehicle 
CAN bus.</p>
<p>So, what can you expect to find once you tap into that bus with your 
CAN bus interface?  You can’t tell until you try, because apart from OBD
 data (which doesn’t send anything on it’s own anyway), the bus can be 
used by the vendor for anything else: it may be the only bus of the car –
 in which case you get <strong>lots</strong> of data – or it may be dedicated for diagnosis, and in this case you get nothing at all.</p>
<p>If you are reading this just to have some fun and learn more about 
your car digital guts, you’ll not find OBD data that interesting, as 
that’s mostly diagnostic stuff.  On the other side, if you manage to 
attach and configure your interface correctly, turn on the ignition and 
see a flow of data, that means the bus you’re on is also shared with 
other vehicle ECUs, and that’s where the fun begins!</p>
<p>So, to sum up: most modern car have many digital busses, and at least
 one is a CAN bus and exposed on the standard diagnostics connector.  
You can attach a generic interface on it and send access generic OBD 
data, but if the vendor decided to use that bus for something else, 
you’ll also find a stream of vendor-specific frames, with real time 
sensor and control information, waiting to be reverse engineered.</p>
<p><strong>SocketCAN</strong></p>
<p>On a CAN bus system you have a lot of self-contained 
microcontroller/DSP based units connected together, each one with its 
own acceptance filter and possibly injecting some information on the 
bus, but how does it step-up to be used on a complex operating system?  
Enter SocketCAN.</p>
<p><a href="http://en.wikipedia.org/wiki/SocketCAN">SocketCAN</a> is CAN
 bus stack for the Linux kernel, contributed by a team at Volkswagen 
Research (well done VW!), and it’s really ingenious in that it 
implements CAN bus as a network device, exploiting many existing 
features of the Linux network stack.</p>
<p>What this means practically is that you are going to see your CAN bus
 controller as a network device, controlled by the “ip” system command.</p>
<p>That’s an example of how a CAN bus device appears on the system:</p>
<pre># ip link show dev can0
9: can0: &lt;NOARP,UP,LOWER_UP&gt; mtu 16 qdisc noqueue state UNKNOWN mode DEFAULT
    link/can</pre>
<p>From an application point-of-view this great news, as it means that 
CAN bus is handled by the well know Berkley sockets APIs and you have 
full software portability: there is no API difference between an USB 
interface connected to a big workstation or a memory mapped interface on
 a small ARM SoC.  The main “trick” is that when using a socketcan 
interface, the application actually send and receive a specific 
can_frame structure, defined as:</p>
<div><div id="highlighter_617452" class="syntaxhighlighter  cpp"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp preprocessor">#define CAN_EFF_FLAG 0x80000000U /* EFF/SFF is set in the MSB */</code></div><div class="line number2 index1 alt1"><code class="cpp preprocessor">#define CAN_RTR_FLAG 0x40000000U /* remote transmission request */</code></div><div class="line number3 index2 alt2"><code class="cpp preprocessor">#define CAN_ERR_FLAG 0x20000000U /* error message frame */</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="cpp keyword bold">typedef</code> <code class="cpp plain">__u32 canid_t;</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="cpp preprocessor">#define CAN_MAX_DLC 9</code></div><div class="line number8 index7 alt1"><code class="cpp preprocessor">#define CAN_MAX_DLEN 8</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="cpp keyword bold">struct</code> <code class="cpp plain">can_frame {</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">canid_t can_id;&nbsp; </code><code class="cpp comments">/* 32 bit CAN_ID + EFF/RTR/ERR flags */</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">__u8&nbsp;&nbsp;&nbsp; can_dlc; </code><code class="cpp comments">/* frame payload length in byte (0 .. CAN_MAX_DLEN) */</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">__u8&nbsp;&nbsp;&nbsp; data[CAN_MAX_DLEN] __attribute__aligned(8);</code></div><div class="line number14 index13 alt1"><code class="cpp plain">};</code></div></div></td></tr></tbody></table></div></div>
<p>At system level, it means that your applications behave like nodes on
 the bus: they can be attached to a “virtual” interface and exchange 
frames with any other node, without knowing if those are real devices on
 an external bus or other applications running locally on the same 
virtual interface.</p>
<p>At a low level, this also means that the interface driver is running 
with fully open acceptance filter, so the kernel actually receives all 
the bus data and decides whether or not to send frames to any 
application depending a higher level software filter, but that’s usually
 not a problem as modern Linux enabled SoCs are powerful enough to 
handle the full traffic anyway.</p>
<p>At this point you may be interested into how to find a list of 
supported USB-to-CANBUS devices to play with, and that’s quite easy as 
all of those are in a <a href="http://lxr.linux.no/#linux+v3.10/drivers/net/can/usb/">dedicated directory in the kernel sources</a>.  Either way, this is a quick list:</p>
<ul>
<li>
ems_usb.c: <a href="http://www.ems-wuensche.com/product/datasheet/html/can-usb-adapter-converter-interface-cpcusb.html">CPC-USB/ARM7 from EMS</a>
</li>
<li>
esd_usb2.c: <a href="http://www.esd-electronics-usa.com/Store/ProductDetails.aspx?itemID=56">CAN-USB/2 and CAN-USB/Micro from ESD</a>
</li>
<li>
kvaser_usb.c: <a href="http://www.kvaser.com/zh/products/can/usb.html">CAN/USB from Kvaser</a>
</li>
<li>
pcan_usb: <a href="http://www.peak-system.com/PCAN-USB.199.0.html?&amp;L=1">PCAN-USB from PEAK System</a>
</li>
<li>
usb_8dev.c: <a href="http://8devices.com/usb2can">USB2CAN from 8 devices</a>
</li>
</ul>
<p>Of all of this, I’ve only had experiences the EMS one, but that’s 
quite expensive and maybe harder to obtain, so the one I would buy right
 now is the USB2CAN from 8 devices: it’s cheap, you can get one from the
 webstore and they provide full schematics and firmware upgrades.  There
 is also a repository with the actual device source code, but that’s 
hardly of any use without the correct programming environment.</p>
<p>As for my setup, I’m using my own open hardware USB AVR + MCP2515 interface.  You can find the repository for my design <a href="https://github.com/fabiobaltieri/open-usb-can">here</a>, but the performances are not that good above 250kbps, so I’m planning a complete redesign in the future.</p>
<p><strong>What if I’m Stuck on Windows?</strong></p>
<p>While I don’t usually consider this case, I’ve seen <a href="http://www.canviausb.com/">CANviaUSB</a>
 used in the development on a critical project and seems to be a great 
tool. So, if you really can’t avoid Windows, CANviaUSB is probably the 
free tool for you (the homepage contains a list of supported device).</p>
<p><strong>Hacking Into the Bus</strong></p>
<p>If you’ve read all the way through here I hope you’ve understood that
 you will have no idea of what’s attached to the bus until you’ve 
analyzed it.  This also means that you don’t know what can break once 
you start poking on it, so this may be a good time for a bit of a 
disclaimer:</p>
<table style="margin:.2em 0;" width="100%" bgcolor="#ffffee">
<tbody><tr>
<td style="padding:.5em;">
<p>You shouldn’t mess with your vehicle bus while it’s moving unless you
 are 100% sure of what’s going on.  The chance of breaking something 
critical is high and you can hurt someone (possibly yourself) if you 
mess up.</p>
</td>
</tr>
</tbody></table>
<p>The first thing you need other than a laptop and the CAN bus interface is a matching cable for the OBD-II port.  I have an <a href="https://www.sparkfun.com/products/10087">OBD to DE-9</a>
 cable from SparkFun, but you may also find a suitable one from your CAN
 bus interface vendor.  As with my interface I used a custom 8P8C based 
connector, I’ve actually cut my DE-9 side of the cable and crimped the 
wires to a standard Ethernet Jack.</p>
<p><img src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/toyothack-sfcable.webp" alt="https://fabiobaltieri.files.wordpress.com/2013/07/toyothack-sfcable.jpg" class="aligncenter"></p>
<p>(Image from <a href="https://www.sparkfun.com/products/10087">Sparkfun</a>)</p>
<p>You should check the cable and interface pinout twice before 
attaching to the vehicle, as there are many signals on the connector, 
including a +12V and possibly some vendor specific ones.</p>
<p><img src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/toyothack-obdpinout.webp" alt="https://fabiobaltieri.files.wordpress.com/2013/07/toyothack-obdpinout.png" class="aligncenter"></p>
<p>(Image from <a href="http://en.wikipedia.org/wiki/File:OBD-connector-pinout.png">Wikipedia</a>)<br>
– pin 4: chassis ground<br>
– pin 5: signal ground<br>
– pin 6: CANH<br>
– pin 14: CANL<br>
– pin 16: Battery Voltage</p>
<p>This is the actual connector pinout.  Be sure to connect the CANH, 
CANL and GND signals.  Shielding and +12V may be useful too but the 
other lines should be left unconnected.</p>
<p>Next, you should find the connector in the vehicle.  The shape is 
easy to spot but it may actually be hidden under the dashboard, in an 
internal fuse box or under the ashtray or some other removable feature.</p>
<p>Don’t force the connector too much, many of those cheap cables are 
badly designed and fits too tight, I actually had to  chop off some 
plastic from mine.</p>
<p>Also, make sure to connect the car while the ignition is OFF for 
thirty seconds or so – I found my car transmits data for some time even 
when everything should be shut off.</p>
<p><strong>Device Configuration and Dumpting the Stream</strong></p>
<p>Time to dump some data, but the interface have to be configured first!</p>
<p>The standard command to configure a CAN bus interface is <code>ip</code>, as in:</p>
<pre># ip link set can0 type can help
Usage: ip link set DEVICE type can
        [ bitrate BITRATE [ sample-point SAMPLE-POINT] ] |
        [ tq TQ prop-seg PROP_SEG phase-seg1 PHASE-SEG1
          phase-seg2 PHASE-SEG2 [ sjw SJW ] ]

        [ loopback { on | off } ]
        [ listen-only { on | off } ]
        [ triple-sampling { on | off } ]
        [ one-shot { on | off } ]
        [ berr-reporting { on | off } ]

        [ restart-ms TIME-MS ]
        [ restart ]

        Where: BITRATE       := { 1..1000000 }
               SAMPLE-POINT  := { 0.000..0.999 }
               TQ            := { NUMBER }
               PROP-SEG      := { 1..8 }
               PHASE-SEG1    := { 1..8 }
               PHASE-SEG2    := { 1..8 }
               SJW           := { 1..4 }
               RESTART-MS    := { 0 | NUMBER }</pre>
<p>Here you need to set the bitrate to match the one used in your target
 bus.  As you probably don’t know that before starting, you have to take
 a guess (or probe it with an oscilloscope).</p>
<p>As CAN bus sends error frames if misconfigured, you most likely want 
to keep the interface in listen-only mode for all the time, so that 
other nodes does not notice that something weird is happening.  Just as 
you know, what may happen if you forget to do so is that something on 
the bus notices the problem and either display (like in the car stereo) 
or records the error.</p>
<p>This is how you set the <code>can0</code> interface at 500kbps in listen only mode:</p>
<pre># ip link set can0 type can bitrate 500000 listen-only on</pre>
<p>If there are no errors you can now bring the interface up and start dumping frames:</p>
<pre># ip link set can0 up
# candump -cae can0,0:0,#FFFFFFFF</pre>
<p>At this point, you are receiving everything that is happening on the 
bus, including errors.  You should try doing something on the car, like 
closing a door or turning on the ignition.</p>
<p>If your bitrate is wrong, you should receive a stream of errors from the CAN bus interface:</p>
<pre>$ candump -cae can0,0:0,#FFFFFFFF
  can0  20000008  [8] 00 00 04 00 00 00 00 00   ERRORFRAME
        protocol-violation{{bit-stuffing-error}{}}
...</pre>
<p>In this case, bring the interface back down, and try with a different
 bit-rate.  Most common ones are 500kbps, 250kbps and 50kbps.</p>
<p>If you are lucky, you’ll eventually find the correct configuration, and get a lot of valid frames from <code>candump</code>:</p>
<pre>balto@balto:~$ candump -cae any,0:0,#FFFFFFFF
  can0  440  [8] 40 00 80 00 00 00 00 00   '@.......'
  can0  442  [8] 42 00 80 00 00 00 00 00   'B.......'
  can0  440  [8] 40 01 80 00 00 00 00 00   '@.......'
  can0  620  [8] 10 80 00 00 00 40 00 80   '.....@..'
  can0  442  [8] 42 01 80 00 00 00 00 00   'B.......'
  can0  440  [8] 42 02 00 00 00 00 00 00   'B.......'
  can0  442  [8] 40 02 00 00 00 00 00 00   '@.......'
  can0  440  [8] 42 02 00 00 00 00 00 00   'B.......'
  can0  620  [8] 10 00 00 00 00 40 00 80   '.....@..'
  can0  442  [8] 40 02 00 00 00 00 00 00   '@.......'
...</pre>
<p>Now that you have the data, this probably looks like noise to you, as
 that’s all part of proprietary protocols used by your vehicle ECUs.  If
 you plan to do some reverse engineering on it, the best thing to do is 
to record all the data for offline playback, but also to setup a camera 
in the car to record what’s happening on the dashboard and on the road. 
 Be sure to record so that you can easily identify when you started 
dumping so that the video can be easily synchronized.</p>
<p>This is how to instruct <code>candump</code> to save all the received packets for offline analysis:</p>
<pre>$ candump -l can0,0:0,#FFFFFFFF
Disabled standard output while logging.

Enabling Logfile 'candump-2013-05-06_190603.log'</pre>
<p>This leads to a log file with a series precisely timestamped packet dumps:</p>
<pre>$ head -n5 candump-2013-05-06_190603.log
(1367859965.231495) can0 440#4000800000000000
(1367859965.249499) can0 442#4200800000000000
(1367859965.330495) can0 440#4001800000000000
(1367859965.335500) can0 620#1080000000400080
(1367859965.349499) can0 442#4201800000000000</pre>
<p><strong>Stream Playback on Virtual Device</strong></p>
<p>Now that you have an offline stream, you can replay it on a virtual interface for realtime analysis.</p>
<p>To do that, first create and bring up a new virtual interface with:</p>
<pre># modprobe vcan
# ip link add vcan0 type vcan
# ip link set vcan0 up</pre>
<p>Now you can run <code>canplayer</code> feeding in the original dump, 
but you also need to specify the mapping between the interface name used
 when recording and the new one, as in:</p>
<pre>$ canplayer vcan0=can0 &lt; candump-2013-05-06_190603.log</pre>
<p>At this point, if you have a <code>candump</code> instance running on <code>vcan0</code>, you should see packet flowing with the same timings of the original recording.</p>
<p>If you recorded a video stream of the car while dumping, this is a 
good time to find some way to synchronize it, possibly by cutting the 
video to the start of dumping.  What I actually did was using the <code>-ss</code> option of <code>mplayer</code> to get it to the right point, and start it simultaneously with <code>candump</code>:</p>
<pre>$ canplayer  &lt; candump-2013-05-06_190603.log &amp; mplayer SMOV0087.AVI -ss 1:17</pre>
<p><strong>Reverse Engineering of CAN bus Frames</strong></p>
<p>Now that you have the packet stream synchronized with a real world 
image, you can start reverse engineering some frame.  I found that my 
car only have one bus, and there are as many as 41 different frame types
 on it.</p>
<p>You should try to use <code>cansniffer</code> to get a first overview of the traffic, but that’s not really helping much.</p>
<p>What you should do instead is to prepare a basic application to quickly try and decode a frame and focus on one frame at a time.</p>
<p>First, you dump all frames with a specific ID, this is an example for 0x2c4:</p>
<pre>$ candump -cae vcan0,2c4:7ff
  vcan0  2C4  [8] 0A C5 00 18 00 00 92 47   '.......G'
  vcan0  2C4  [8] 0A C8 00 18 00 00 92 4A   '.......J'
  vcan0  2C4  [8] 0A D0 00 18 00 00 92 52   '.......R'
  vcan0  2C4  [8] 0A DC 00 18 00 00 92 5E   '.......^'
  vcan0  2C4  [8] 0A E1 00 18 00 00 92 63   '.......c'
  vcan0  2C4  [8] 0A EB 00 18 00 00 92 6D   '.......m'
  vcan0  2C4  [8] 0A F0 00 18 00 00 92 72   '.......r'
  vcan0  2C4  [8] 0A F2 00 18 00 00 92 74   '.......t'
  vcan0  2C4  [8] 0A F3 00 18 00 00 92 75   '.......u'</pre>
<p>What to look for is how the data is packed up: by looking at the dump
 changing you should try to guess for each byte if it contains flags or 
if it’s part of a signed or unsigned 8, 16 or 32 bits number.  This is 
easier than it seems, but a bit time consuming.</p>
<p>Once you have that, you can write a data structure to represent the 
information and print it out in your test application in a readable 
format, such as:</p>
<div><div id="highlighter_954947" class="syntaxhighlighter  cpp"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp keyword bold">struct</code> <code class="cpp plain">__packed {</code></div><div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uint16_t</code> <code class="cpp plain">unk0; </code><code class="cpp comments">/* in BE on the bus, use be16toh */</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uint8_t</code> <code class="cpp plain">_pad0;</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uint8_t</code> <code class="cpp plain">unk1;</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uint8_t</code> <code class="cpp plain">_pad1;</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uint8_t</code> <code class="cpp plain">_pad2;</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uint8_t</code> <code class="cpp plain">unk2;</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int8_t</code> <code class="cpp plain">unk3;</code></div><div class="line number9 index8 alt2"><code class="cpp plain">} test;</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="cpp plain">...</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="cpp plain">mvprintw(1, 1, </code><code class="cpp string">"test: unk0=%5hd unk1=%3d unk2=%3d, unk3=%3hhd"</code><code class="cpp plain">,</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">be16toh(toy-&gt;test.unk0),</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">toy-&gt;test.unk1,</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">toy-&gt;test.unk2,</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">toy-&gt;test.unk3);</code></div></div></td></tr></tbody></table></div></div>
<p>If you look at the numbers changing in realtime with the video, you 
may now be able to make some sense out of those: in this case it turns 
out that the first number is the actual RPM of the engine, so the 
structure can be modified into:</p>
<div><div id="highlighter_962037" class="syntaxhighlighter  cpp"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp keyword bold">struct</code> <code class="cpp plain">__packed {</code></div><div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uint16_t</code> <code class="cpp plain">rpm;</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uint8_t</code> <code class="cpp plain">_pad0;</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uint8_t</code> <code class="cpp plain">unk0;</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uint8_t</code> <code class="cpp plain">_pad1;</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uint8_t</code> <code class="cpp plain">_pad2;</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">uint8_t</code> <code class="cpp plain">unk1;</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int8_t</code> <code class="cpp plain">unk2;</code></div><div class="line number9 index8 alt2"><code class="cpp plain">} engine;</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="cpp plain">...</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="cpp plain">mvprintw(1, 1, </code><code class="cpp string">"engine: rpm=%5hd unk0=%3d unk1=%3d, unk2=%3hhd"</code><code class="cpp plain">,</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">be16toh(toy-&gt;engine.rpm),</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">toy-&gt;engine.unk0,</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">toy-&gt;engine.unk1,</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">toy-&gt;engine.unk2);</code></div></div></td></tr></tbody></table></div></div>
<p>Now that you know that the frame contains engine information, you can
 assume that other fields of the same frame are somehow related, as 
those come from the same ECU.</p>
<p>In my case I was able to identify some data such as throttle 
position, speed, rpm, mileage counters and the speed of individual 
wheels.  I wrote a simple application to open the CAN bus interface, 
read the frames and decode the supported ones.  You can use it as a base
 to write your own packet decoders, it’s easy to hack, ncurses based and
 gives a list of unknown packets… Grab it on <a href="http://github.com/fabiobaltieri/toyothack">GitHub</a>!</p>
<p><a href="http://github.com/fabiobaltieri/toyothack"><br>
<img src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/github_button.webp" style="border-width:0;" alt="GitHub"><br>
</a></p>
<p>Finally, this is a video of what the final result looks like:</p>
<span class="embed-youtube" style="text-align:center; display: block;"><iframe class="youtube-player" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/KHRPmjwXF1U.html" allowfullscreen="true" style="border:0;" sandbox="allow-scripts allow-same-origin allow-popups allow-presentation" width="630" height="355"></iframe></span>
			<div id="atatags-262211711-617b3d9ff23c4"></div>
			
			<script>
				__ATA.cmd.push(function() {
					__ATA.initDynamicSlot({
						id: 'atatags-262211711-617b3d9ff23c4',
						location: 120,
						formFactor: '001',
						label: {
							text: 'Advertisements',
						},
						creative: {
							reportAd: {
								text: 'Report this ad',
							},
							privacySettings: {
								text: 'Privacy',
								
							}
						}
					});
				});
			</script><div id="atatags-262211715-617b3d9ff23ef">
        <script type="text/javascript">
            __ATA.cmd.push(function() {
                __ATA.initVideoSlot('atatags-262211715-617b3d9ff23ef', {
                    sectionId: '262211715',
                    format: 'inread'
                });
            });
        </script>
    </div><div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul data-sharing-events-added="true"><li class="share-twitter"><a rel="nofollow noopener noreferrer" data-shared="sharing-twitter-1419" class="share-twitter sd-button share-icon no-text" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?share=twitter&amp;nb=1" target="_blank" title="Click to share on Twitter"><span></span><span class="sharing-screen-reader-text">Click to share on Twitter (Opens in new window)</span></a></li><li class="share-facebook"><a rel="nofollow noopener noreferrer" data-shared="sharing-facebook-1419" class="share-facebook sd-button share-icon no-text" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?share=facebook&amp;nb=1" target="_blank" title="Click to share on Facebook"><span></span><span class="sharing-screen-reader-text">Click to share on Facebook (Opens in new window)</span></a></li><li class="share-end"></li></ul></div></div></div><div class="sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-loaded" id="like-post-wrapper-26221171-1419-617b3d9ff30d2" data-src="//widgets.wp.com/likes/index.html?ver=20210831#blog_id=26221171&amp;post_id=1419&amp;origin=fabiobaltieri.wordpress.com&amp;obj_id=26221171-1419-617b3d9ff30d2&amp;domain=fabiobaltieri.com" data-name="like-post-frame-26221171-1419-617b3d9ff30d2" data-title="Like or Reblog"><h3 class="sd-title">Like this:</h3><div class="likes-widget-placeholder post-likes-widget-placeholder" style="height: 55px; display: none;"><span class="button"><span>Like</span></span> <span class="loading">Loading...</span></div><iframe class="post-likes-widget jetpack-likes-widget" name="like-post-frame-26221171-1419-617b3d9ff30d2" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/index.html" title="Like or Reblog" width="100%" height="55px" frameborder="0"></iframe><span class="sd-text-color"></span><a class="sd-link-color"></a></div>
<div id="jp-relatedposts" class="jp-relatedposts" style="display: block;">
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
<div class="jp-relatedposts-items jp-relatedposts-items-minimal jp-relatedposts-grid "><p class="jp-relatedposts-post jp-relatedposts-post0" data-post-id="185" data-post-format="false"><span class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://fabiobaltieri.com/2011/08/24/using-serial-ports-linux/" title="Using Serial Ports on GNU/Linux&nbsp;Systems" data-origin="1419" data-position="0">Using Serial Ports on GNU/Linux&nbsp;Systems</a></span><time class="jp-relatedposts-post-date" datetime="2011/08/24" style="display: block;">2011/08/24</time><span class="jp-relatedposts-post-context">In "Linux"</span></p><p class="jp-relatedposts-post jp-relatedposts-post1" data-post-id="1263" data-post-format="false"><span class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://fabiobaltieri.com/2013/02/14/hp-wi-fi-direct-mouse-on-linux/" title="HP Wi-Fi Direct Mouse on&nbsp;Linux" data-origin="1419" data-position="1">HP Wi-Fi Direct Mouse on&nbsp;Linux</a></span><time class="jp-relatedposts-post-date" datetime="2013/02/14" style="display: block;">2013/02/14</time><span class="jp-relatedposts-post-context">In "Linux"</span></p><p class="jp-relatedposts-post jp-relatedposts-post2" data-post-id="203" data-post-format="false"><span class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="https://fabiobaltieri.com/2011/09/21/linux-led-subsystem/" title="Linux LED Subsystem" data-origin="1419" data-position="2">Linux LED Subsystem</a></span><time class="jp-relatedposts-post-date" datetime="2011/09/21" style="display: block;">2011/09/21</time><span class="jp-relatedposts-post-context">In "Linux"</span></p></div></div></div><div class="clear"></div>
					
					<!--
					<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/"
    dc:identifier="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/"
    dc:title="Hacking into a Vehicle CAN bus (Toyothack and&nbsp;SocketCAN)"
    trackback:ping="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/trackback/" />
</rdf:RDF>					-->

				</div>

				<div class="post-meta">
					<p>
						<span class="categories">Filed under <a href="https://fabiobaltieri.com/category/hardware/" rel="category tag">Hardware</a>, <a href="https://fabiobaltieri.com/category/linux-2/" rel="category tag">Linux</a>, <a href="https://fabiobaltieri.com/category/networking/" rel="category tag">Networking</a></span>
						<span class="tags">Tagged with <a href="https://fabiobaltieri.com/tag/automotive/" rel="tag">automotive</a>, <a href="https://fabiobaltieri.com/tag/canbus/" rel="tag">canbus</a>, <a href="https://fabiobaltieri.com/tag/hack/" rel="tag">hack</a>, <a href="https://fabiobaltieri.com/tag/linux/" rel="tag">linux</a>, <a href="https://fabiobaltieri.com/tag/obd/" rel="tag">obd</a>, <a href="https://fabiobaltieri.com/tag/socketcan/" rel="tag">socketcan</a>, <a href="https://fabiobaltieri.com/tag/toyota/" rel="tag">Toyota</a></span>					</p>
				</div>

			</div>

			
						<p></p>

			<div id="comments">
	

	<h3 id="comments-title">112 Responses to <em>Hacking into a Vehicle CAN bus (Toyothack and&nbsp;SocketCAN)</em>	</h3>

	<ol class="commentlist snap_preview">
			<li class="comment even thread-even depth-1 highlander-comment" id="li-comment-688">
		<div id="comment-688">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/987f5d113a7febaefc63f44c2dec28c3.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-987f5d113a7febaefc63f44c2dec28c3-0" width="40" height="40">			<cite class="fn"><a href="http://gravatar.com/ildiopantofola" rel="external nofollow ugc" class="url">ildiopantofola</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-688">2013/07/23 at 16:09</a></div>

		<div class="comment-body"><p>Love it!!! *___*</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=688#respond" data-commentid="688" data-postid="1419" data-belowelement="comment-688" data-respondelement="respond" data-replyto="Reply to ildiopantofola" aria-label="Reply to ildiopantofola">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="li-comment-811">
		<div id="comment-811">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/fdf2e3488a4dced3545eaa3d2bb5bf79.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-fdf2e3488a4dced3545eaa3d2bb5bf79-0" width="40" height="40">			<cite class="fn">Daniel</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-811">2013/09/20 at 16:23</a></div>

		<div class="comment-body"><p>Great job, I really admire all your projects, ideas and, of course, skills.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=811#respond" data-commentid="811" data-postid="1419" data-belowelement="comment-811" data-respondelement="respond" data-replyto="Reply to Daniel" aria-label="Reply to Daniel">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2 highlander-comment" id="li-comment-812">
		<div id="comment-812">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-0" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-812">2013/09/20 at 17:01</a></div>

		<div class="comment-body"><p>Thanks Daniel!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=812#respond" data-commentid="812" data-postid="1419" data-belowelement="comment-812" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1 highlander-comment" id="li-comment-902">
		<div id="comment-902">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/dc63801b2623d9536ebd914d2c8c0303.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-dc63801b2623d9536ebd914d2c8c0303-0" width="40" height="40">			<cite class="fn"><a href="http://gravatar.com/mangodan2003" rel="external nofollow ugc" class="url">mangodan2003</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-902">2013/11/08 at 13:42</a></div>

		<div class="comment-body"><p>Hi there, great writeup! I am very interested in your open-usb-can project.</p>
<p>I have different hardware, an STM32f4 with 2 can controllers, I plan 
to eventually use both by making my firmware present 2 USB interface 
descriptors .</p>
<p>For now I have been coding firmware in the hope that I can just use 
your kernel module, by making my hardware appear to be the same as yours
 from the host’s point of view.</p>
<p>I have got the device/interface/endpoint descriptors working, and can
 set the hw config, and start the interface. But I cannot figure out how
 you start the data flow. The urb’s callbacks in the kernel module do 
not seem to ever be called.</p>
<p>I can make data go out, for a short while using cangen, but never get anything back in.</p>
<p>I can see in the ep0.c control values that do not seem to ever be 
sent by the driver. But which appear to be needed to start the data 
flow.</p>
<p>ATUSB_SPI_WRITE1/ATUSB_SPI_WRITE2<br>
and<br>
ATUSB_SPI_READ1/ATUSB_SPI_READ2</p>
<p>The Write one seems to be the only place the ep in callback gets set.</p>
<p>Am I missing something?</p>
<p>Are these parts of the code actually used?</p>
<p>Thanks in advance, Dan</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=902#respond" data-commentid="902" data-postid="1419" data-belowelement="comment-902" data-respondelement="respond" data-replyto="Reply to mangodan2003" aria-label="Reply to mangodan2003">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2 highlander-comment" id="li-comment-906">
		<div id="comment-906">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-1" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-906">2013/11/08 at 20:18</a></div>

		<div class="comment-body"><p>Hi Dan!</p>
<p>I was actually in the process of redesigning my open-usb-can with an 
STM32F103, as I abandoned the AVR based design for performance reasons, 
but then I stalled the project to work on other stuff…</p>
<p>Anyway, I’m happy that you’re using my kernel module as a base! 
That’s actually quite simple because the firmware uses socketcan 
compatible data structures and you can easily do the same.  You may also
 be interested into a discussion on the linux-can list about USB-CAN 
protocols (<a href="http://article.gmane.org/gmane.linux.can/2004" rel="nofollow ugc">http://article.gmane.org/gmane.linux.can/2004</a>) and maybe even join the list!</p>
<p>The firmware code is actually based on the ATUSB Ben-WPAN project (<a href="http://en.qi-hardware.com/wiki/Ben_WPAN" rel="nofollow ugc">http://en.qi-hardware.com/wiki/Ben_WPAN</a>)
 so you may find some debugging/helper code still there and not used by 
the kernel module, and that’s the case for the ATUSB_SPI_* calls – the 
AVR to CAN controller SPI data is not exposed on the USB side for normal
 operation.</p>
<p>As for the data flow, the stuff you find in ep0.c is only for the 
control endpoint (&amp;eps[0]), and that’s used only for device 
configuration/start/stop.  The actual bulk traffic is handled in 
buffer.c, where you can find references to usb_send(&amp;eps[2], …) and 
usb_recv[&amp;eps[1], …).  Those two maps to the two kernel queues: 
usb_sndbulkpipe(dev-&gt;udev, 1) and usb_rcvbulkpipe(dev-&gt;udev, 2) 
and relative callbacks.</p>
<p>There may be a *ton* of reasons why your traffic doesn’t go trough, 
and you may want to double check your descriptors and the hardware USB 
controller configuration on the STM32, especially for the endpoint 
sizes.</p>
<p>In this situation I would search for an working example project to 
run on the STM32 that uses bulk endpoint and adapt it to your 
configuration until you find what breaks.  On the Linux side you can use
 the usbmon module to see the raw traffic.  Also, one of my favorite 
utilities for hacking on USB is the usbtool application from the v-usb 
package, you can find it here <a href="https://github.com/obdev/v-usb" rel="nofollow ugc">https://github.com/obdev/v-usb</a>
 hidden into the examples/usbtool directory.  It allows you send and 
receive arbitrary USB traffic, it uses libusb internally.  If you use 
that just keep in mind that it doesn’t flip between the DATA0/1 packet 
id, so it will actually work only for the first packet… but that’s often
 enough! :-)</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=906#respond" data-commentid="906" data-postid="1419" data-belowelement="comment-906" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-mangodan2003 odd alt depth-3 highlander-comment" id="li-comment-907">
		<div id="comment-907">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/dc63801b2623d9536ebd914d2c8c0303.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-dc63801b2623d9536ebd914d2c8c0303-1" width="40" height="40">			<cite class="fn">mangodan2003</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-907">2013/11/09 at 11:19</a></div>

		<div class="comment-body"><p>Thankyou for such an in depth reply.</p>
<p>I have managed to get data flowing to the host, it was something to 
do with the FIFO buffer settings, I do not fully understand how these 
are allocated and used at present so need to investigate.<br>
I had based my CAN vender specific driver on the stm cdc example class, 
removing the command endpoint so I just have the control endpoint and 
two bulk end points as you do, but had over looked the FIFO settings.<br>
I have used lsusb with -v option to confirm the descriptors are all correct.</p>
<p>Although data flows to the host it is presently  split in to tiny 
packets, I am only sending 17 bytes and it seems to send this as 12 
bytes followed by the remaining 5 bytes.My wxPacket sizes for both the 
in and out Endpoint are set way higher than this, 64 and 32 bytes. So I 
have some work todo to find out why this is happening, but once resolved
 I am nearly there :).</p>
<p>I have been using usbmon module  with wireshark, and also a libusb 
test program adapted from something else I found online. I will 
investigate the other things you suggested.</p>
<p>Thanks again </p>
<p>Dan</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even depth-2 highlander-comment" id="li-comment-1177">
		<div id="comment-1177">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/b85633fd663b6632cd367194b913b039.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-b85633fd663b6632cd367194b913b039-0" width="40" height="40">			<cite class="fn">ZeroAviation</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-1177">2014/02/03 at 18:07</a></div>

		<div class="comment-body"><p>What kind of FIFO settings were you missing? I’m facing a similar problem.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=1177#respond" data-commentid="1177" data-postid="1419" data-belowelement="comment-1177" data-respondelement="respond" data-replyto="Reply to ZeroAviation" aria-label="Reply to ZeroAviation">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="li-comment-915">
		<div id="comment-915">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/8c71610a4ea707eac74c88900a5192d6.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-8c71610a4ea707eac74c88900a5192d6-0" width="40" height="40">			<cite class="fn">Arnold</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-915">2013/11/12 at 17:16</a></div>

		<div class="comment-body"><p>Hello.</p>
<p>Question: Can all cars engine be started by the OBD-2 Conector using CAN bus protocol?</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=915#respond" data-commentid="915" data-postid="1419" data-belowelement="comment-915" data-respondelement="respond" data-replyto="Reply to Arnold" aria-label="Reply to Arnold">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2 highlander-comment" id="li-comment-917">
		<div id="comment-917">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-2" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-917">2013/11/12 at 20:42</a></div>

		<div class="comment-body"><p>Hi Arnold, I think quite the opposite: 
*maybe* some car can be started with some can packet! Most cars probably
 still have a dedicated ignition circuit, and that’s even without 
accounting for some key authentication, immobilizer etc… :)</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=917#respond" data-commentid="917" data-postid="1419" data-belowelement="comment-917" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1 highlander-comment" id="li-comment-947">
		<div id="comment-947">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9a8607456a3fdc3935d9a9ac28d1109f.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9a8607456a3fdc3935d9a9ac28d1109f-0" width="40" height="40">			<cite class="fn">Sam Crooks</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-947">2013/11/23 at 21:52</a></div>

		<div class="comment-body"><p>Fabio:</p>
<p>You might consider using a Beagle Bone Black with a CAN cape.  You 
can then directly wire into the CAN networks in the car permanently (all
 of them) and dump continuously, automate data collection, and also not 
block the OBD-II port… Useful if you want to sniff out what dealer 
diagnostic tools are sending on the network, or ECU flash programmers.  
See my website for my project notes on taking this approach</p>
<p><a href="http://the8thlayerof.net/" rel="nofollow ugc">http://the8thlayerof.net</a></p>
<p>Sam</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=947#respond" data-commentid="947" data-postid="1419" data-belowelement="comment-947" data-respondelement="respond" data-replyto="Reply to Sam Crooks" aria-label="Reply to Sam Crooks">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2 highlander-comment" id="li-comment-948">
		<div id="comment-948">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-3" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-948">2013/11/23 at 22:15</a></div>

		<div class="comment-body"><p>Sure thing!  The BBB is a great board for
 this kind of hacks and has a very capable CPU and a good design in 
general as you would expect from TI.</p>
<p>I actually worked in the past with the standard BB and with the 
AM335x CPU in general, and I still think that it’s one of the best 
general purpose board/CPU available.</p>
<p>Thanks for the link! :-)</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=948#respond" data-commentid="948" data-postid="1419" data-belowelement="comment-948" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="li-comment-1054">
		<div id="comment-1054">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/279ca63896e5b8b7cdea19fea55424c5.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-279ca63896e5b8b7cdea19fea55424c5-0" width="40" height="40">			<cite class="fn"><a href="http://gravatar.com/dcgibbons" rel="external nofollow ugc" class="url">Chad Gibbons</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-1054">2013/12/30 at 00:29</a></div>

		<div class="comment-body"><p>Great post and information. You inspired me to do something similar to my Jeep and the results re here: <a href="http://chadgibbons.com/2013/12/29/hacking-the-jeep-interior-can-bus/" rel="nofollow ugc">http://chadgibbons.com/2013/12/29/hacking-the-jeep-interior-can-bus/</a></p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=1054#respond" data-commentid="1054" data-postid="1419" data-belowelement="comment-1054" data-respondelement="respond" data-replyto="Reply to Chad Gibbons" aria-label="Reply to Chad Gibbons">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2 highlander-comment" id="li-comment-1055">
		<div id="comment-1055">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-4" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-1055">2013/12/30 at 00:47</a></div>

		<div class="comment-body"><p>Thanks… and nice job on your Wrangler! :-)</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=1055#respond" data-commentid="1055" data-postid="1419" data-belowelement="comment-1055" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1 highlander-comment" id="li-comment-1156">
		<div id="comment-1156">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/2b094ee9d5a4e7c3f600ceac72caafb0.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-2b094ee9d5a4e7c3f600ceac72caafb0-0" width="40" height="40">			<cite class="fn">javad</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-1156">2014/02/02 at 10:57</a></div>

		<div class="comment-body"><p>hi fabio<br>
I want send and recieve can data, but when this command ” ip link set 
can0 type can” is ok but when I run this command “ip set link can0 type 
can listen-onl on” , operatiopn nor supporeted :-(<br>
 can you help me?</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=1156#respond" data-commentid="1156" data-postid="1419" data-belowelement="comment-1156" data-respondelement="respond" data-replyto="Reply to javad" aria-label="Reply to javad">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2 highlander-comment" id="li-comment-1161">
		<div id="comment-1161">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-5" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-1161">2014/02/02 at 16:03</a></div>

		<div class="comment-body"><p>Hi, looks like the device you are using 
does not support listen-only mode.  That’s implemented in the driver so 
you need an updated version or to do your own implementation.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=1161#respond" data-commentid="1161" data-postid="1419" data-belowelement="comment-1161" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="li-comment-1493">
		<div id="comment-1493">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/53b5891397ddda04ffd8ee491bd3bc33.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-53b5891397ddda04ffd8ee491bd3bc33-0" width="40" height="40">			<cite class="fn">Sarthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-1493">2014/02/21 at 11:47</a></div>

		<div class="comment-body"><p>Hey Fabio,</p>
<p>How you doing? The work you have done is fantastic and exciting. 
Actually, I am trying to get access to the CAN packets transferred among
 different ECUs. I am not sure what hardware you are exactly using. From
 the blog, I guess that you are using an OBD to DB9 cable, a laptop but 
what to connect the laptop and cable. Is it RJ45 port of the laptop you 
are using ? Please help !!<br>
Thank you !!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=1493#respond" data-commentid="1493" data-postid="1419" data-belowelement="comment-1493" data-respondelement="respond" data-replyto="Reply to Sarthak" aria-label="Reply to Sarthak">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2 highlander-comment" id="li-comment-1519">
		<div id="comment-1519">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-6" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-1519">2014/02/22 at 21:09</a></div>

		<div class="comment-body"><p>Hi Sarthak, that’s explained in the post,
 my specific setup is a laptop, a custom usb-to-canbus interface and a 
modified OBD cable that fits my CAN interface (which happens to have an 
8P8C connector but of course is not Ethernet).  The software part is 
just the socketcan and my test application.</p>
<p>You need to grab a CAN interface of some kind (USB are common 
nowadays) and an OBD cable, and modify the cable to fit the CAN 
interface pinout.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=1519#respond" data-commentid="1519" data-postid="1419" data-belowelement="comment-1519" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1 highlander-comment" id="li-comment-1536">
		<div id="comment-1536">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/53b5891397ddda04ffd8ee491bd3bc33.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-53b5891397ddda04ffd8ee491bd3bc33-1" width="40" height="40">			<cite class="fn">Sarthak</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-1536">2014/02/24 at 14:20</a></div>

		<div class="comment-body"><p>Yes, I am using an OBD-II UART board, 
FTDI Basic, Laptop and a standard OBD to DB9 cable. But I am not able to
 figure out that when I will connect the USB port to the laptop, then 
how will I link the USB port i.e.COM1(for ex) with the the commands you 
mentioned in your blog to start the  session. Please suggest.</p>
<p>Thank You !</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=1536#respond" data-commentid="1536" data-postid="1419" data-belowelement="comment-1536" data-respondelement="respond" data-replyto="Reply to Sarthak" aria-label="Reply to Sarthak">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2 highlander-comment" id="li-comment-1549">
		<div id="comment-1549">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-7" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-1549">2014/02/24 at 23:10</a></div>

		<div class="comment-body"><p>I think you have an ELM327 based board, 
that’s actualy designed to handle the OBD protocol on-chip and 
communicate with the host PC using AT commands.  I think that some 
version is able to inject raw CAN frames, but AFAIK it does not work 
with SocketCAN, so it’s totally a different thing from what I cover in 
the post.</p>
<p>If you are looking into OBD you should search for some ELM327 
specific tutorial, but if you are interested into raw CAN stuff and 
socketcan you should get a different CAN interface.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=1549#respond" data-commentid="1549" data-postid="1419" data-belowelement="comment-1549" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="li-comment-2525">
		<div id="comment-2525">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/2b094ee9d5a4e7c3f600ceac72caafb0.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-2b094ee9d5a4e7c3f600ceac72caafb0-1" width="40" height="40">			<cite class="fn">Yousef</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-2525">2014/04/05 at 14:41</a></div>

		<div class="comment-body"><p>Hi Fabio<br>
I work with “PEAK-SYSTEM- CAN card ” , I can connect two can interface, I
 generate CAN data in one can interface and dump can data in other 
inteface.<br>
 but I want reverse engineering on PLD engine controller and dump can 
data in this  controller. you can find specific of this controller in 
this link<br>
 (<a href="http://www.scribd.com/doc/57350358/PLD-Manual-MERCEDES-INJECTORS-FUEL-SYSTEM" rel="nofollow ugc">http://www.scribd.com/doc/57350358/PLD-Manual-MERCEDES-INJECTORS-FUEL-SYSTEM</a>)<br>
   but I can not receive any data with my interface! however I can 
connect it with  car diagnostic and receive CAN data! I try to determine
 output  signal with oscilloscope and saw voltage level of this 
controller are 9 V &amp; 12 V for CAN-H and CAN-L . but in my interface 
output level are -1.5 and +1.5 V . if I can connect this controller with
 my interface ?  how I should connect this controller physically? if I 
should run specific command for connect and dump CAN data without 
“candump can0”? please help me :-)<br>
thanks a lot.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=2525#respond" data-commentid="2525" data-postid="1419" data-belowelement="comment-2525" data-respondelement="respond" data-replyto="Reply to Yousef" aria-label="Reply to Yousef">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2 highlander-comment" id="li-comment-2564">
		<div id="comment-2564">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-8" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-2564">2014/04/07 at 19:15</a></div>

		<div class="comment-body"><p>Hi Yousef,</p>
<p>there are many things you should check to troubleshoot the problem: 
first make sure that you are able to display error messages from the CAN
 interface (candump has some specific flags), then it may be possible 
that the bus you are using generates data only when triggered (check for
 activity with the scope). It may be useful for you to build a split 
cable to connect the diagnostic tool and your CAN interface at the same 
time, so that you can check if you receive the same data from both.</p>
<p>For the voltage level, is actually quite high and may be saturating 
the transceiver.  You should check which transceiver p/n is used in your
 CAN interface, and make sure it works with common mode voltage as high 
as ~10V.  Ideally you would also use an isolated interface (if you are 
on a laptop using it from the battery may be enough).</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=2564#respond" data-commentid="2564" data-postid="1419" data-belowelement="comment-2564" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment odd alt depth-3 highlander-comment" id="li-comment-3217">
		<div id="comment-3217">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/2b094ee9d5a4e7c3f600ceac72caafb0.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-2b094ee9d5a4e7c3f600ceac72caafb0-2" width="40" height="40">			<cite class="fn">Yousef</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-3217">2014/04/29 at 08:20</a></div>

		<div class="comment-body"><p>Hi Fabio<br>
thanks a lot for you answers. I want connect to Mercedes Benz BUS and 
read CAN data from diagnostic connector. In your opinion are there 
difference between  CAN bus configuration of Buses and cars? can I 
receive CAN data similar way ?<br>
thanks a lot.<br>
Yousef</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-even depth-1 highlander-comment" id="li-comment-2630">
		<div id="comment-2630">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/fcc6cfe36a974ba59beaff244ada564d.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-fcc6cfe36a974ba59beaff244ada564d-0" width="40" height="40">			<cite class="fn">jon</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-2630">2014/04/09 at 23:49</a></div>

		<div class="comment-body"><p>How could I control the climate in my Lexus Lx470? I am a beginner with Can-bus and not sure where to begin.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=2630#respond" data-commentid="2630" data-postid="1419" data-belowelement="comment-2630" data-respondelement="respond" data-replyto="Reply to jon" aria-label="Reply to jon">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor odd alt depth-2 highlander-comment" id="li-comment-2631">
		<div id="comment-2631">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-9" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-2631">2014/04/10 at 00:06</a></div>

		<div class="comment-body"><p>Well, that’s a long shot, I would not suggest you to wire up stuff to your car unless you know what your are doing. :-)</p>
<p>That said, it’s hard to say, if you can equip with the proper tools 
you would have to find the correct bus, decode some control data and – 
if the protocol design allows – try to reinject it to control what you 
need.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=2631#respond" data-commentid="2631" data-postid="1419" data-belowelement="comment-2631" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-odd thread-alt depth-1 highlander-comment" id="li-comment-4179">
		<div id="comment-4179">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/ef816d9ad1d42ffe83554a54d3de888b.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-ef816d9ad1d42ffe83554a54d3de888b-0" width="40" height="40">			<cite class="fn">marius</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-4179">2014/05/29 at 06:57</a></div>

		<div class="comment-body"><p>Firstly, what a great post.  Thanks very 
much!  I have quite a bit of experience with CAN, and always get the 
question how to read fuel consumption from many different manufacturer’s
 CAN bus.  Yet, this signal is very difficult to reverse-engineer, I 
find, because many other signals (engine torque for example) look very 
similar.  I see you have fuel usage identified on the toyota.  How could
 you be sure it is the right signal? Any tips will be greatly 
appreciated! :-)  Again, thanks very much for an excellent article.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=4179#respond" data-commentid="4179" data-postid="1419" data-belowelement="comment-4179" data-respondelement="respond" data-replyto="Reply to marius" aria-label="Reply to marius">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor odd alt depth-2 highlander-comment" id="li-comment-4224">
		<div id="comment-4224">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-10" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-4224">2014/05/30 at 15:55</a></div>

		<div class="comment-body"><p>Hello Marius!</p>
<p>Thanks for the comment, I agree that most of this is very hard to 
reverse engineer… Even after you isolated some counter, everything spins
 up as soon as you rev up the engine! :-)</p>
<p>For the fuel consumption I’m afraid I found a hint on some other 
website for similar projects on other Toyotas, and the value seems to 
change together with the instant consumption on the dashboard. My first 
idea would be to try to see if the those two updates together but if 
that doesn’t work I guess you should compare with some other car 
diagnostic tool.</p>
<p>Cheers!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=4224#respond" data-commentid="4224" data-postid="1419" data-belowelement="comment-4224" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-entropy512 even depth-3 highlander-comment" id="li-comment-19597">
		<div id="comment-19597">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/1ba6286e0632c0a8c6c0dccb373ca6e0.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-1ba6286e0632c0a8c6c0dccb373ca6e0-0" width="40" height="40">			<cite class="fn">entropy512</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-19597">2017/01/03 at 01:32</a></div>

		<div class="comment-body"><p>Hey, out of curiosity – what other sites did you see discussion of Toyota CANbus traffic on?</p>
<p>I have a 2006 Sienna and while some of the CAN-IDs are the same as 
yours (and in fact have identical information for 1-2 of them), there 
are quite a few differences.</p>
<p>Well actually it’s the family’s Sienna – I’ve traded with my 2009 Outback for a few weeks for various reasons.</p>
<p>For example I’ve found a single vehicle speed value (appears to be 
km/h*256), but no individual wheelspeed values (likely due to older 
vehicle without stability control).</p>
<p>I’ve found an oddball signal that seems to be approximately RPM*2 
most of the time, but varies from that value.  (Usually gradually 
increases above RPM, but occasionally drops to 0)</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor odd alt depth-3 highlander-comment" id="li-comment-19613">
		<div id="comment-19613">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-11" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-19613">2017/01/07 at 21:45</a></div>

		<div class="comment-body"><p>Hi! From what I remember the only 
external reference I had when I wrote this was a report from some 
university group on another Toyota car. I remember observing something 
similar to what you described: some frame IDs matched but the content 
was slightly different, which probably reflect some different evolution 
of the various ECUs and the communication protocols used, or just 
different requirements on what data needs to be shared between ECUs.</p>
<p>The lack of individual wheel speed may mean that the ABS unit obtains
 the information by some other mean other than the CANBUS. No clue about
 the RPM*2 one… maybe some other control signal loosely related to the 
engine speed.</p>
<p>Are you going to try and do some test on the Outback? Would be 
curious to see what you find… I would expect that car to be quite more 
sophisticated and have multiple buses though. :-)</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-3 highlander-comment" id="li-comment-19614">
		<div id="comment-19614">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-12" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-19614">2017/01/07 at 21:49</a></div>

		<div class="comment-body"><p>…it may have been this one <a href="http://tucrrc.utulsa.edu/ToyotaCAN.html" rel="nofollow ugc">http://tucrrc.utulsa.edu/ToyotaCAN.html</a> (first hit on Google… oh well :-)</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1 highlander-comment" id="li-comment-5411">
		<div id="comment-5411">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/fe6cc3ecc9797820432120337aa416ae.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-fe6cc3ecc9797820432120337aa416ae-0" width="40" height="40">			<cite class="fn">Per</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-5411">2014/06/27 at 11:27</a></div>

		<div class="comment-body"><p>Nice job on decoding the CAN-frames. </p>
<p>Now that you have a CAN-OBD-interface it would be really simple to 
add functionality to also log supported OBD-PIDS for your vehicle</p>
<p>Have a look at <a href="http://en.wikipedia.org/wiki/OBD-II_PIDs" rel="nofollow ugc">http://en.wikipedia.org/wiki/OBD-II_PIDs</a>
 for a very nice guide. Basically, for the supported PIDS of your 
vehicle you just send a CAN-message and wait for respeonse. The list of 
supported PIDS is obtained by simpy asking, which is always supported 
(for non-electric vehicle).</p>
<p>Example:</p>
<p>Supported PIDs are obtained by sending a can message with [02,01,00,0,0,0,0,0], respone contains PIDS-supported. </p>
<p>Lets say PID=0x0A (fuel pressure) is supported, just send  
[02,01,0A,0,0,0,0,0] and wait for response. Response should be something
 like: CAN-Sender-ID=0x7E8 (message from main ecu), [numBytes, 0x41,  
PID=0x0A, A, B, C ,D, E, …] and actual fuel pressure is A*3 according to
 wikipedia.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=5411#respond" data-commentid="5411" data-postid="1419" data-belowelement="comment-5411" data-respondelement="respond" data-replyto="Reply to Per" aria-label="Reply to Per">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2 highlander-comment" id="li-comment-5425">
		<div id="comment-5425">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-13" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-5425">2014/06/27 at 20:09</a></div>

		<div class="comment-body"><p>Hi Per!</p>
<p>You’re right, I was more interested into reversing some vehicle 
specific data but at this point it would be cool to have a socket-can 
based OBD scanner like you described… Only problem with that: in the 
meantime I moved to Ireland and I don’t have a car anymore! :)</p>
<p>Thanks for the followup though, feel free to drop a link if you have a
 chance of writing something for socketcan + OBD, I’m not aware of any 
free software to do that and it would be great to start one!</p>
<p>Cheers,<br>
Fabio</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=5425#respond" data-commentid="5425" data-postid="1419" data-belowelement="comment-5425" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="li-comment-8530">
		<div id="comment-8530">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/4a84c9084bcff51d334878a2ca363362.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-4a84c9084bcff51d334878a2ca363362-0" width="40" height="40">			<cite class="fn"><a href="http://www.sattraktelematics.com/" rel="external nofollow ugc" class="url">Micheal Dada</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-8530">2014/09/12 at 20:29</a></div>

		<div class="comment-body"><p>Great job! really like your project. I 
have a project i’m actually working on, it’s all about acquiring 
odometer protocols from canbus, was able to acquire protocols for some 
vehicles but still have problem getting from vehicles like toyota hilux,
 toyota hiace, mistibushi l200, mistibushi lancer, ford ranger and other
 ford series. Kindly help with tips on resolving these.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=8530#respond" data-commentid="8530" data-postid="1419" data-belowelement="comment-8530" data-respondelement="respond" data-replyto="Reply to Micheal Dada" aria-label="Reply to Micheal Dada">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2 highlander-comment" id="li-comment-8532">
		<div id="comment-8532">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-14" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-8532">2014/09/12 at 21:41</a></div>

		<div class="comment-body"><p>Sweet! You are welcome! :-)</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=8532#respond" data-commentid="8532" data-postid="1419" data-belowelement="comment-8532" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1 highlander-comment" id="li-comment-8732">
		<div id="comment-8732">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/a1aa9b8ec2852869b5d15419902c3048.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-a1aa9b8ec2852869b5d15419902c3048-0" width="40" height="40">			<cite class="fn">Bill K</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-8732">2014/09/16 at 20:34</a></div>

		<div class="comment-body"><p>Thank you for this informative post. 
Although as a medical diagnostic imaging engineer I am familiar with CAN
 bus, what I am working with is pretty much presented by the 
manufacturers in hardware and software, as is the case with OBD II and 
OBD II readers. Your presentation differs in that it probes down to the 
signal level, which then may determine if a component is actually bad or
 if the signal is just bad. Am I right?<br>
I wish you had described a step by step use of the “socket can” for us who are less familiar with programming.<br>
Have you done any work into hacking the other CAN bus in cars, namely 
the Navigation-Radio-CD changer-Telephone-etc. can bus? From following 
the various automotive forums there seems to be an awful lot of problems
 in that area. I wonder why the power train CAN is so reliable and the 
entertainment CAN is not.  (Greater product liability?)</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=8732#respond" data-commentid="8732" data-postid="1419" data-belowelement="comment-8732" data-respondelement="respond" data-replyto="Reply to Bill K" aria-label="Reply to Bill K">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2 highlander-comment" id="li-comment-8733">
		<div id="comment-8733">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-15" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-8733">2014/09/16 at 22:46</a></div>

		<div class="comment-body"><p>Hi Bill! Yes you are just about right, I 
would not really say “signal” though as I did not really put too much 
effort on electrical signals but rather at the lowest digital layer – 
the raw transmission and receiving of CAN frames, such as if they were 
IP packets.</p>
<p>The socketcan part is actually easy if you get familiar with normal 
“internet” sockets before, and that is just the API used to interface 
applications with TCP and UDP (and more!) streams. SocketCAN is just an 
extension of that to use CAN frames with the well-known socket API, and 
it’s actually a huge step forward compared to previous implementation of
 low level CAN APIs in Linux, which would not do too much other than 
exposing the controller to the application.</p>
<p>I did not really do much in cars other than what I described here, 
and I think CAN it’s used for infotrainment devices just because “it’s 
already there”… One problem is that there is still low interoperability 
between devices, since even if they share the bus they still implement 
vendor specific protocols on top of it (think of after-market stereo or 
dashboards).</p>
<p>If you hear about reliability problems it’s probably juts because 
those are just less important busses and receive less attention to 
reliable design as a consequence… Maybe the cables and connectors are 
lower quality (gauge, twisting…), have longer trunks (worse signal 
integrity), moves through hinges and other stuff. I’m sure the 
drivetrain bus receive more attention and there’s much more than the 
protocol itself in designing a reliable field bus system.</p>
<p>Cheers!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=8733#respond" data-commentid="8733" data-postid="1419" data-belowelement="comment-8733" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="li-comment-9990">
		<div id="comment-9990">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/0a1bde5fa75da899b1ebe56139c58c21.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-0a1bde5fa75da899b1ebe56139c58c21-0" width="40" height="40">			<cite class="fn">xarxer</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-9990">2014/10/16 at 09:20</a></div>

		<div class="comment-body"><p>Hi Fabio,</p>
<p>I just ordered an OBD-II to DE-9 cable to do some car hacking, but 
I’d like to get started right away, so I was wondering if maybe you 
still have your recorded data? If so, I could use it to get the basics 
done of an application that utilizes it!</p>
<p>Thanks in advance!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=9990#respond" data-commentid="9990" data-postid="1419" data-belowelement="comment-9990" data-respondelement="respond" data-replyto="Reply to xarxer" aria-label="Reply to xarxer">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2 highlander-comment" id="li-comment-9999">
		<div id="comment-9999">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-16" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-9999">2014/10/16 at 20:17</a></div>

		<div class="comment-body"><p>Hi Xarxer… I don’t have the dump anymore! :-) Sorry!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=9999#respond" data-commentid="9999" data-postid="1419" data-belowelement="comment-9999" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment odd alt depth-3 highlander-comment" id="li-comment-11820">
		<div id="comment-11820">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/d085147dcf7abd5263798ae3f0b938f5.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-d085147dcf7abd5263798ae3f0b938f5-0" width="40" height="40">			<cite class="fn">mck1117</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-11820">2014/12/10 at 07:40</a></div>

		<div class="comment-body"><p>Could you grab another one? I’m also interested in a working dump.  Surely you still have the car!</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-3 highlander-comment" id="li-comment-11846">
		<div id="comment-11846">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-17" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-11846">2014/12/10 at 20:06</a></div>

		<div class="comment-body"><p>Nope, I moved shortly after writing this post and I don’t have a car anymore. :-)</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1 highlander-comment" id="li-comment-12541">
		<div id="comment-12541">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/b70da50706a8c3cffba65bc53324058f.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-b70da50706a8c3cffba65bc53324058f-0" width="40" height="40">			<cite class="fn"><a href="http://seven-labs.com/" rel="external nofollow ugc" class="url">SpoderMan</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-12541">2015/01/03 at 07:30</a></div>

		<div class="comment-body"><p>Hello Fabio,</p>
<p>Very nice work! I am quite interested in this project, and very 
impressed by this write-up. I am wondering if you have messed with 
writing to the ECU to add any special “tunes” or performance mods? I am 
wanting to take this approach to learn more about some newer diesel 
trucks, and what signals/data are running on the CAN bus, perhaps write 
some performance tunes in a C# program where they can then be uploaded 
via OBD.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=12541#respond" data-commentid="12541" data-postid="1419" data-belowelement="comment-12541" data-respondelement="respond" data-replyto="Reply to SpoderMan" aria-label="Reply to SpoderMan">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2 highlander-comment" id="li-comment-12549">
		<div id="comment-12549">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-18" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-12549">2015/01/03 at 19:24</a></div>

		<div class="comment-body"><p>Hi! Not really, I’m afraid all the 
information on how to change stuff on the ECU is model specific and non 
standard, and I haven’t tried to write anything on the bus. The idea 
should work, you can get some CAN interface with C# APIs and write stuff
 to the various ECUs, but you need to get or reverse the programming 
documentation first.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=12549#respond" data-commentid="12549" data-postid="1419" data-belowelement="comment-12549" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="li-comment-12631">
		<div id="comment-12631">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/53b5891397ddda04ffd8ee491bd3bc33.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-53b5891397ddda04ffd8ee491bd3bc33-2" width="40" height="40">			<cite class="fn"><a href="http://gravatar.com/sarthak7386" rel="external nofollow ugc" class="url">sarthak7386</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-12631">2015/01/07 at 15:18</a></div>

		<div class="comment-body"><p>Hey Fabio,</p>
<p>Hi! I am Sarthak Jain. I was currently analysing the CAN bus via 
ELM327. I captured some packets for window up and down. But when I 
replay those packets using ELM327, then I do not see any action other 
than flickering of ‘check engine light’. After asking some people, I 
came to know that the speed of ELM may be slow which is causing 
conflicts on the CAN bus.<br>
I came across this module – <a href="http://www.8devices.com/usb2can" rel="nofollow ugc">http://www.8devices.com/usb2can</a>.
 I need to know if I send those packets using this hardware, I would not
 get the same problem of speed as with ELM. Can you please comment upon 
this?<br>
There is one more module – ‘ECOM’ cable which is being used for hacking the CAN bus. Are you aware of this?</p>
<p>Thank you!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=12631#respond" data-commentid="12631" data-postid="1419" data-belowelement="comment-12631" data-respondelement="respond" data-replyto="Reply to sarthak7386" aria-label="Reply to sarthak7386">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2 highlander-comment" id="li-comment-12637">
		<div id="comment-12637">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-19" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-12637">2015/01/07 at 22:19</a></div>

		<div class="comment-body"><p>Hi Sarthak! I have no experience with 
ELM327 but the speed explanation sound awkward (speed of what btw? the 
micro that the elm is based on? its CAN interface?). If you are using 
the ELM correctly I think you could get the same result… but having a 
second device to crosscheck would not hurt for sure. Never heard for 
this ECOM thing.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=12637#respond" data-commentid="12637" data-postid="1419" data-belowelement="comment-12637" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1 highlander-comment" id="li-comment-12659">
		<div id="comment-12659">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/53b5891397ddda04ffd8ee491bd3bc33.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-53b5891397ddda04ffd8ee491bd3bc33-3" width="40" height="40">			<cite class="fn"><a href="http://gravatar.com/sarthak7386" rel="external nofollow ugc" class="url">sarthak7386in</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-12659">2015/01/08 at 17:32</a></div>

		<div class="comment-body"><p>Hey,</p>
<p>The speed is that of the CAN packets which I am sending via ‘pyserial’ package.<br>
Actually I am using OBD-II UART board which provides a serial interface 
to send and receive packets to the OBD-II bus. I used ELM 327 AT 
commands to analyse the traffic, reverse-engineered some of the packets,
 found the ones which change when, say window go up or down. But when I 
replay those packets using ‘pyserial’, all I get is ‘flickering of check
 engine light’.<br>
By the way, USB2CAN device provides a serial interface or some other?</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=12659#respond" data-commentid="12659" data-postid="1419" data-belowelement="comment-12659" data-respondelement="respond" data-replyto="Reply to sarthak7386in" aria-label="Reply to sarthak7386in">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2 highlander-comment" id="li-comment-12696">
		<div id="comment-12696">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-20" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-12696">2015/01/10 at 16:25</a></div>

		<div class="comment-body"><p>Right, so if the OBD adapter is passing 
through a standard UART to communicate with the host, it may be 
saturating that link. I think that’s a poor design in general, but it’s 
particularly bad if it’s using a real UART and a converter, limited to a
 specific bit rate, rather than a “virtual serial” implemented directly 
on the USB controller. In the case of the ELM controller I guess that 
the design made sense since you are supposed to use it to communicate 
with the ELM chip  using AT commands (let’s call it legacy), and that 
link should not require much bandwidth, but if you try to turn that into
 a CAN interface you are surely going to get very poor performances. 
None of the devices I listed in this post are implemented like that 
AFAIK, and all are using proper USB endpoints (and works with 
socketcan).</p>
<p>That said, I doubt that’s the problem that leads to your “check 
engine flickering” thing, you are more likely sending wrong data or just
 sending something that gets quickly overridden by some other periodic 
frame on the bus.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=12696#respond" data-commentid="12696" data-postid="1419" data-belowelement="comment-12696" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-sarthak7386 odd alt depth-3 highlander-comment" id="li-comment-12838">
		<div id="comment-12838">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/53b5891397ddda04ffd8ee491bd3bc33.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-53b5891397ddda04ffd8ee491bd3bc33-4" width="40" height="40">			<cite class="fn"><a href="http://sarthak7386.wordpress.com/" rel="external nofollow ugc" class="url">sarthak7386</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-12838">2015/01/17 at 20:24</a></div>

		<div class="comment-body"><p>Hey, yeah you are right that my data is being overridden by some other frames.</p>
<p>I have one more question. The OBD-II UART board is having MCP2551 CAN
 transreceiver and STN1110 as its controller. Clearly STN1110 is ELM 
based and is not CAN controller.<br>
But we can select CAN as one of its protocols and then we can talk to ecu and get sensors data. Right?<br>
It means it can talk to the CAN bus without any problem. But I guess the
 only issue is that of speed of the serial port which is causing 
trouble.<br>
I hope this trouble goes away by using USB2CAN device?</p>
<p>Thank you!</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-3 highlander-comment" id="li-comment-12840">
		<div id="comment-12840">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-21" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-12840">2015/01/17 at 23:00</a></div>

		<div class="comment-body"><p>Well, the fact that you only have a CAN 
transceiver on the board means that the STN1110 does have a hardware CAN
 interface (it’s probably some commercial microcontroller pre-programmed
 and custom branded), and the controller can surely operate on a 
full-speed bus (that’s 1Mbps), but that does not immediately translate 
in the fact that you can use it as a generic CAN interface and transfer 
the whole data stream of the bus on the control interface (your serial).
 The serial port speed is surely the first concern on that, but that’s 
far from being the only limitations. CAN based micros are designed with 
some kind of frame filter to be able to silently discard most data 
present on the bus, and only activate the CPU to process the essential 
frames. If you use the micro as a bus sniffer, thus opening the filters 
to grab the whole data stream, the micro may not even have enough power 
to unqueue the frames fast enough to prevent overrun, and that may even 
happen if the bus is lightly loaded but bursty.</p>
<p>Those ODB chips are nice in that they can implement the OBD protocols
 (on top of CAN and other busses), but they are not designed to be used 
as a raw CAN sniffer device (access the full bus data even in heavy load
 or bursty conditions – which as I understand is what you are trying to 
achieve here). If that is what you want to do you would surely have 
better results with something like the USB2CAN.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment byuser comment-author-sarthak7386 odd alt thread-odd thread-alt depth-1 highlander-comment" id="li-comment-12848">
		<div id="comment-12848">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/53b5891397ddda04ffd8ee491bd3bc33.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-53b5891397ddda04ffd8ee491bd3bc33-5" width="40" height="40">			<cite class="fn"><a href="http://sarthak7386.wordpress.com/" rel="external nofollow ugc" class="url">sarthak7386</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-12848">2015/01/18 at 09:05</a></div>

		<div class="comment-body"><p>Okay, I hope UsB2CAN solve the problem! 
By the way do you know what transreceiver and controller USB2CAN is 
using? I did not find any information on their website.</p>
<p>One more thing – If let say I replay the packets responsible for door
 lock , will I actually see the doors unlocking themselves? If you have 
some literature on how ECUs communicate, I would be really thankful to 
you if share the same.</p>
<p>Thank you!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=12848#respond" data-commentid="12848" data-postid="1419" data-belowelement="comment-12848" data-respondelement="respond" data-replyto="Reply to sarthak7386" aria-label="Reply to sarthak7386">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2 highlander-comment" id="li-comment-12853">
		<div id="comment-12853">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-22" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-12853">2015/01/18 at 16:49</a></div>

		<div class="comment-body"><p>They give complete schematics on the website: <a href="http://www.8devices.com/usb2can" rel="nofollow ugc">http://www.8devices.com/usb2can</a>, the setup is an MCP2551 + STR750FV2.</p>
<p>On the lock question, hard to say, it depends how the information on 
the frames is interpreted… it may not be that easy, and you are still 
racing with the frames sent by the original controller on the bus, and 
injecting/replying frames may or may not work depending on how the 
protocol is designed. The very fact that your check engine light blinks 
when you send stuff is telling you that something is detecting an 
erroneous condition on the bus (checksum? sequencing?…) which then 
resolves with the normal traffic.</p>
<p>I don’t have any literature for that, you may find something about 
the OBD stuff (which AFAIK is a request-response based protocol 
implemented on top of a pair of CAN IDs), but everything else is 
proprietary, vendor and model specific stuff… If you find something is 
either leaked or reverse engineered (well, this post is about reverse 
engineering it after all…).</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=12853#respond" data-commentid="12853" data-postid="1419" data-belowelement="comment-12853" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment odd alt depth-3 highlander-comment" id="li-comment-13946">
		<div id="comment-13946">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/picture_002.jpeg" class="avatar avatar-40" width="40" height="40">			<cite class="fn"><a href="http://www.facebook.com/100001472121713" rel="external nofollow ugc" class="url">Sarthak Jain</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-13946">2015/04/05 at 18:38</a></div>

		<div class="comment-body"><p>Hey,</p>
<p>Some time back, we had a discussion about ELM327 speed issues. Now, I
 purchased an USB2CAN converter from 8devices. After configuring the CAN
 interface, when I tried to use candump command, I got nothing from the 
car.</p>
<p>I also noticed some unusual change in the dashboard lights and data 
as soon as I am connecting the USB2CAN converter to the OBD-II port 
without even connecting it to the laptop.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-3 highlander-comment" id="li-comment-13956">
		<div id="comment-13956">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-23" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-13956">2015/04/06 at 19:30</a></div>

		<div class="comment-body"><p>Hey, dashboard errors are a clear 
indication of something wrong, it happened to me when I was fiddling 
with that on my Bravo, I had the wrong bitrate and did not se the 
listen-only option, and I think the interface was spamming error frames 
all over the place, causing some error indication to turn on. It should 
not happen when the device is not powered though, CAN transceivers 
should be designed to support that state and not interfeer with the bus.
 Are you sure you wired the CAN port correctly?</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1 highlander-comment" id="li-comment-13319">
		<div id="comment-13319">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/d91a0d9e9b07b48b694a4c19711cba88.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-d91a0d9e9b07b48b694a4c19711cba88-0" width="40" height="40">			<cite class="fn">Akshay</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-13319">2015/02/13 at 11:02</a></div>

		<div class="comment-body"><p>Hello sir , i would like your help in deciphering the following code </p>
<p>Bus speed: 500000 kbit/s H, Sampling point: 75%, SJW 2</p>
<p>18DAF130 X | 8 | 02 7E 00 55 55 55 55 55 |       5076<br>
18DAF128 X | 8 | 02 7E 00 55 55 55 55 55 |       1506<br>
18DAF110 X | 8 | 02 7E 00 55 55 55 55 55 |       1620<br>
18DAF153 X | 8 | 02 7E 00 55 55 55 55 55 |       8639<br>
18DAF160 X | 8 | 02 7E 00 55 55 55 55 55 |        797<br>
18DA30F1 X | 8 | 03 22 48 00 00 00 00 00 |     417576<br>
18DAF130 X | 8 | 10 3B 62 48 00 00 00 F8 |       4435<br>
18DA30F1 X | 8 | 30 00 00 00 00 00 00 00 |        484<br>
18DAF130 X | 8 | 21 C0 00 00 00 00 52 14 |       1483<br>
18DAF130 X | 8 | 22 11 21 01 00 00 00 08 |       1466</p>
<p>Can you explain me what the above data corresponds to in-terms of<br>
1: Start of frame<br>
2: Arbitration Field<br>
3: Control Field<br>
4: Data Field<br>
5: CRC Field<br>
6: ACK Field<br>
7: End of frame</p>
<p>If you can provide me with a  brief understanding on how to read the above mentioned data it would be very helpful.</p>
<p>The above mentioned CAN bus packet data  was gathered from a<br>
Honda City ,1.5L i-Vtec, Petrol Injection.<br>
Communication with the Engine Control Module was observed in<br>
ISO15765 CAN HIGH ( Pin no 6)<br>
ISO 15765 CAN LOW ( Pin no 14)</p>
<p>Your help will be much appreciated sir.<br>
Thank you<br>
With Regards<br>
Akshay</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=13319#respond" data-commentid="13319" data-postid="1419" data-belowelement="comment-13319" data-respondelement="respond" data-replyto="Reply to Akshay" aria-label="Reply to Akshay">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2 highlander-comment" id="li-comment-13330">
		<div id="comment-13330">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-24" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-13330">2015/02/13 at 21:01</a></div>

		<div class="comment-body"><p>Hi Askshay, I think you are 
overestimating my abilities to see through the matrix, I can barely tell
 that those are extended CAN frames but that’s about it. :-)</p>
<p>Anyway, the details you asked are not really related to that dump, 
those are part of the CAN framing, and does not really show up at 
application level. What you dumped are basically just the ID, the DLC 
(always 8 in your case) and the data — not sure about the last number.</p>
<p>I don’t really have any documentation for reading *that* specific 
data (the frame specs are ECU specific), though if you are interested in
 CANBUS in general there is plenty of literature on manufacturer 
websites, just Google it.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=13330#respond" data-commentid="13330" data-postid="1419" data-belowelement="comment-13330" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
	<li class="comment odd alt depth-2 highlander-comment" id="li-comment-14760">
		<div id="comment-14760">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/413431c238662735db83694b4fca0d7d.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-413431c238662735db83694b4fca0d7d-0" width="40" height="40">			<cite class="fn">David</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-14760">2015/06/26 at 00:57</a></div>

		<div class="comment-body"><p>Akshay,</p>
<p>I know this is a long time from your original post but I just got into Toyota’s and found this site courtesy of Google.</p>
<p>The CAN traffic you posted is very typical of the interaction between
 a tester(something like a dealer scan tool, ELM327…etc) and one or more
 modules.  I think for what your looking for you don’t need to worry so 
much about all those things you numbered off.  The things you are 
interested in are the Id and the data.</p>
<p>Using your first line as an example:</p>
<p>18DAF130 X | 8 | 02 7E 00 55 55 55 55 55 | 5076</p>
<p>The Id is 18DAF130.  The 18DA is a standard identifier for physically
 addressed signals(the tool is asking one module for a response). You 
may also see 18DB which is a way for one tool to ask all of the modules 
for data(functionally addressed). F1 lets you know a “tester” is asking 
for this information as opposed to another module onboard.  30 is the 
destination address.  This could be any module on that particular 
bus(engine, trans, body, HVAC…..). The X is just to let you know this is
 an extended message(29 bit identifier).</p>
<p>8 is the length of the message data to follow.</p>
<p>This is the data that you actually care about:<br>
02 7E 00 55 55 55 55 55</p>
<p>02 is the length of the data in this message that is significant(not counting itself)</p>
<p>7E is a standard identifier indicating a “tester present” message</p>
<p>00 is the “mode” for lack of a better term.  There are a bunch of 
different modes that do different things mainly it indicates whether or 
not this message should be acknowledged by the receiving module.  In 
this case it appears 00 means it does not require acknowledgement.</p>
<p>The rest of the 55’s are just padding.  I know that because the 02 in
 the first byte told me there was only two bytes of significant data.</p>
<p>Long story short, this message was just a signal from some tool on 
the bus to a specific module to let it know it was there. Not too 
exciting……There are 5 different modules this tool to talking to (30, 28,
 10, 53 and 60).  I don’t know which modules those numbers correspond to
 but you can probably figure it out with enough internet searching.</p>
<p>This is the interesting message:</p>
<p>18DA30F1 X | 8 | 03 22 48 00 00 00 00 00 | 417576</p>
<p>This is the tester asking module 30 for some Mode$22 data from PID 
4800. Module $30 then responded with 59 bytes of significant data. Who 
knows what information is contained within this message(it is 
proprietary but again you may be able to figure it out with some 
internet searches) but something in your car is asking for it.</p>
<p>Clear as mud?</p>
<p>Dave</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=14760#respond" data-commentid="14760" data-postid="1419" data-belowelement="comment-14760" data-respondelement="respond" data-replyto="Reply to David" aria-label="Reply to David">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment even depth-3 highlander-comment" id="li-comment-14761">
		<div id="comment-14761">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/413431c238662735db83694b4fca0d7d.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-413431c238662735db83694b4fca0d7d-1" width="40" height="40">			<cite class="fn">David</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-14761">2015/06/26 at 01:11</a></div>

		<div class="comment-body"><p>After I posted this, I realized I screwed it up.  I swapped the sender and receiver in my head. It should read:</p>
<p>“The Id is 18DAF130. The 18DA is a standard identifier for physically
 addressed signals(the tool is asking one module for a response). You 
may also see 18DB which is a way for one tool to ask all of the modules 
for data(functionally addressed). F1 lets you know a “tester” is 
receiving this information as opposed to another module onboard. 30 is 
the sender’s address. This could be any module on that particular 
bus(engine, trans, body, HVAC…..). The X is just to let you know this is
 an extended message(29 bit identifier).</p>
<p>8 is the length of the message data to follow.</p>
<p>This is the data that you actually care about:<br>
02 7E 00 55 55 55 55 55</p>
<p>02 is the length of the data in this message that is significant(not counting itself)</p>
<p>7E is a standard identifier indicating a “tester present acknowledged” message</p>
<p>00 is the “mode” for lack of a better term. There are a bunch of 
different modes that can be sent from the tester which do different 
things. Mainly it indicates whether or not this message should be 
acknowledged by the receiving module. In this case The tester did 
require an acknowledgement.</p>
<p>The rest of the 55’s are just padding. I know that because the 02 in 
the first byte told me there was only two bytes of significant data.</p>
<p>Long story short, this message was just a response from some module 
on the bus to the tester in response to its original tester present 
message(not included in your data dump). Not too exciting……There are 5 
different modules responding to the tester’s message (30, 28, 10, 53 and
 60). I don’t know which modules those numbers correspond to but you can
 probably figure it out with enough internet searching.”</p>
<p>Sorry about that, its been a long day…..</p>
<p>Dave</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
	<li class="comment odd alt depth-3 highlander-comment" id="li-comment-20045">
		<div id="comment-20045">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/picture.jpeg" class="avatar avatar-40" width="40" height="40">			<cite class="fn"><a href="https://www.facebook.com/app_scoped_user_id/10213127878335760/" rel="external nofollow ugc" class="url">Akshay Acharya</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-20045">2017/04/26 at 06:30</a></div>

		<div class="comment-body"><p>Dear Dave,</p>
<p>Thank a lot for your reply, i was toying with the idea of decoding 
the data packet earlier and once again i am approaching it as it has 
become a necessity. I have understood what you have explained in the 
above post and would like to thank you for explaining it in such detail.</p>
<p>Considerin’g the above the data dump, you have clearly explained what
 18DAF130 refers to and also about “DB” . Clearly there are several 
notations which i need to be aware of if i have to understand the lines 
of data. are their any literature where one could read through the 
different sets of identifiers.</p>
<p>18DA10F1 X | 8 | 30 00 00 00 00 00 00 00 |        384</p>
<p>18DA10F1 refer to 18DA being the standard identifier and what does 10
 refers to? F1 refers to the tester present.  whereas 30 refer to length
 of the data am i right ?</p>
<p>Also can you please elaborate what exactly you meant by the following
 ” this message was just a response from some module on the bus to the 
tester in response to its original tester present message(not included 
in your data dump).”</p>
<p>Thank you<br>
Warm Regards<br>
Akshay</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-odd thread-alt depth-1 highlander-comment" id="li-comment-13349">
		<div id="comment-13349">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/d91a0d9e9b07b48b694a4c19711cba88.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-d91a0d9e9b07b48b694a4c19711cba88-1" width="40" height="40">			<cite class="fn">Akshay</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-13349">2015/02/16 at 05:47</a></div>

		<div class="comment-body"><p>Thank you for the reply sir, The reason i
 asked you is that i am trying to understand the data dump. i have gone 
through few notes and pdf’s on the net and with respect to CANBUS they 
have mentioned<br>
Arbitration Data , CRC,ACK etc i am just starting to get my head around it, but there is  no success. </p>
<p>Also the packet data that i have collected, how do i identify what they correspond to?<br>
For example : I have my throttle wide open and i am seeing bits of data 
streaming across my screen and i would like to identify which among 
those streams of data does my vehicle RPM correspond to ?</p>
<p>Now sir please tell me is this the right way decipher the data dump or is their any other way ??</p>
<p>and what does the Bit 8 refer to in the following </p>
<p>18DAF160 X | 8 | 02 7E 00 55 55 55 55 55 | 797</p>
<p>Last thing is Sir could you suggest me some literature that has an in
 depth explanation of CANBUS protocols and other K line , K-L line 
protocols and also how to reverse engineer the data dump?? </p>
<p>Thank you<br>
With Regards<br>
Akshay</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=13349#respond" data-commentid="13349" data-postid="1419" data-belowelement="comment-13349" data-respondelement="respond" data-replyto="Reply to Akshay" aria-label="Reply to Akshay">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor odd alt depth-2 highlander-comment" id="li-comment-13369">
		<div id="comment-13369">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-25" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-13369">2015/02/18 at 21:10</a></div>

		<div class="comment-body"><p>Right, so what you are looking at is just
 the frame identifier (18DAF160) and the payload (02 7E 00 55 55 55 55 
55), CRC, ACK and other framing stuff shows up at a lower level and you 
don’t really care. What you need to do is figure out a way of understand
 the meaning of the data, and how to do it is up to you. What I did was 
taking one frame id at a time, observe how the data changed and try to 
correlate with the event in the car (from the video recording). That’s 
what this post is about.</p>
<p>The “8” digit is probably the DLC, which is a just fancy name for the size of the payload (8 bytes).</p>
<p>I don’t really have any in-depth literature on CANBUS, the protocol 
is not that complicated to understand, especially if you only care about
 application level stuff (i.e. you are not writing a driver or 
implementing a controller or a circuit board). For how to reverse it… up
 to you, this post contains a description of my process already…</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=13369#respond" data-commentid="13369" data-postid="1419" data-belowelement="comment-13369" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-even depth-1 highlander-comment" id="li-comment-13522">
		<div id="comment-13522">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/0a01ec5250adee8238506af65d5ce3c7.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-0a01ec5250adee8238506af65d5ce3c7-0" width="40" height="40">			<cite class="fn">Sam</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-13522">2015/03/05 at 06:01</a></div>

		<div class="comment-body"><p>Thank you for sharing this great knowledge!</p>
<p>I have question sir.<br>
I’m using c# for my project (reading &amp; writing data to serial port; OBDII).<br>
How can I disable/hide certain pids from reading?</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=13522#respond" data-commentid="13522" data-postid="1419" data-belowelement="comment-13522" data-respondelement="respond" data-replyto="Reply to Sam" aria-label="Reply to Sam">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor odd alt depth-2 highlander-comment" id="li-comment-13537">
		<div id="comment-13537">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-26" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-13537">2015/03/06 at 00:31</a></div>

		<div class="comment-body"><p>Hey Sam, that depends on the interface 
and driver you are using, it may not even expose any filtering API. That
 said if you are connected to a computer and the interface can handle 
the full traffic you can filter those in software. Acceptance filters 
and mailboxes allows to use a fast bus with slow microcontrollers, but 
for a general purpose computer that’s unnecessary.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=13537#respond" data-commentid="13537" data-postid="1419" data-belowelement="comment-13537" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-odd thread-alt depth-1 highlander-comment" id="li-comment-13957">
		<div id="comment-13957">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/picture_003.jpeg" class="avatar avatar-40" width="40" height="40">			<cite class="fn"><a href="http://www.facebook.com/100001472121713" rel="external nofollow ugc" class="url">Sarthak Jain</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-13957">2015/04/06 at 20:30</a></div>

		<div class="comment-body"><p>Hi, I am not able to reply on the above thread.</p>
<p>But here we are. As I told you, I used an USB2CAN converter. As soon 
as I connected this to the OBD-II port without actually powering it, I 
saw an unusual change in the dashboard lights and data. The cable which I
 used is OBD-II to DB-9 cable which you also suggested in your blog.<br>
I tried various baud rates – 500, 250, 50 kbps and also set the 
listen-only mode on, but as soon as tried the “candump” command, I did 
not get anything.</p>
<p>Can it be a problem of device itself?</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=13957#respond" data-commentid="13957" data-postid="1419" data-belowelement="comment-13957" data-respondelement="respond" data-replyto="Reply to Sarthak Jain" aria-label="Reply to Sarthak Jain">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor odd alt depth-2 highlander-comment" id="li-comment-13968">
		<div id="comment-13968">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-27" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-13968">2015/04/07 at 04:58</a></div>

		<div class="comment-body"><p>Right, so, the fact the both that cable 
and the CAN interface have a DE9 connector does not mean that they are 
meant to be plugged together. In fact they are not, that cable (<a href="https://www.sparkfun.com/products/10087" rel="nofollow ugc">https://www.sparkfun.com/products/10087</a>) is using some pinout commonly found in OBD scanners (I think..), but the 8-devices converter (<a href="http://www.8devices.com/media/files/usb2can.pdf" rel="nofollow ugc">http://www.8devices.com/media/files/usb2can.pdf</a>) is using the standardized CiA D-sub pinout (<a href="https://www.phoenixcontact.com/assets/downloads_ed/global/web_dwl_technical_info/CANopen.pdf" rel="nofollow ugc">https://www.phoenixcontact.com/assets/downloads_ed/global/web_dwl_technical_info/CANopen.pdf</a> page 9), which is what you expect in automation devices.</p>
<p>You should cut the end of the cable and rewire it (which is what I 
did as well, I had a custom connector in my USB interface). What you did
 shorted some random signal together, hence the error lights on the 
dashboard. It probably did not blow anything but be careful with that, 
as far as I remember the OBD connector has a +12V line straight from the
 battery, which is probably  limited by a 10A fuse or something. That’s 
potentially lethal to any non protected signal transceiver. :-)</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=13968#respond" data-commentid="13968" data-postid="1419" data-belowelement="comment-13968" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment even depth-3 highlander-comment" id="li-comment-13977">
		<div id="comment-13977">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/picture_003.jpeg" class="avatar avatar-40" width="40" height="40">			<cite class="fn"><a href="http://www.facebook.com/100001472121713" rel="external nofollow ugc" class="url">Sarthak Jain</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-13977">2015/04/07 at 11:51</a></div>

		<div class="comment-body"><p>Yes, you are absolutely right. The pin connections do not match.</p>
<p>Basically, I have to connect these pins CAN-H (6-4), CAN-L(14-3), GND(5-5) of DB-9 and USB2CAN respectively.</p>
<p>Since I also test on OBD-II port, is there a way so that without 
cutting the DB-9 connector, I can connect these through wires. I know I 
am not good in hardware connections. :P</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
	<li class="comment odd alt depth-3 highlander-comment" id="li-comment-13978">
		<div id="comment-13978">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/picture_003.jpeg" class="avatar avatar-40" width="40" height="40">			<cite class="fn"><a href="http://www.facebook.com/100001472121713" rel="external nofollow ugc" class="url">Sarthak Jain</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-13978">2015/04/07 at 12:59</a></div>

		<div class="comment-body"><p>Oh I am sorry for my wrong pin connections which I mentioned in my earlier post. Now I got the right one.<br>
But is there any you can suggest me to connect the pins of DB-9 and USB2CAN respectively without cutting DB-9 ?</p>
<p>Thank you.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-3 highlander-comment" id="li-comment-13997">
		<div id="comment-13997">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-28" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-13997">2015/04/08 at 05:30</a></div>

		<div class="comment-body"><p>Well if you don’t want to cut the 
connector you could make an adapter… I guess you could splice an serial 
extension cable. Just match the CANH, CANL and (signal) ground pins.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1 highlander-comment" id="li-comment-13992">
		<div id="comment-13992">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/8892d47c8160275265776c6830b23193.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-8892d47c8160275265776c6830b23193-0" width="40" height="40">			<cite class="fn"><a href="http://gravatar.com/toyssan1" rel="external nofollow ugc" class="url">treadlite</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-13992">2015/04/07 at 22:26</a></div>

		<div class="comment-body"><p>I have been working on a similar project 
and I have been using the STM32F.  I have this working with the 105 
series, and 407 series.  I am working on an OBD2 simulator and was able 
to get it working with very little code at least for proof of concept.</p>
<p>My goal is to have a fully open source OBD2 simulator with all 
protocols.  CAN was pretty easy using the MCP2551 chips,  but now I need
 to develop the others, specifically 9141 LIN protocol.</p>
<p>I am using the SN65HVDA195-Q1 lin transiever, which I have also 
succsesfuly got working on my own LIN network.  Next goal is to get it 
working with the 5 baud init then switch to the 10500, but I have run 
into a problem with time.</p>
<p>Would anyone be interested in working on the ISO 9141 OBD protocol?</p>
<p>BTW, I have been using the STM32F discovery boards.  They use the STM32F407 and they are only $15 from digikey.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=13992#respond" data-commentid="13992" data-postid="1419" data-belowelement="comment-13992" data-respondelement="respond" data-replyto="Reply to treadlite" aria-label="Reply to treadlite">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2 highlander-comment" id="li-comment-13999">
		<div id="comment-13999">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-29" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-13999">2015/04/08 at 05:38</a></div>

		<div class="comment-body"><p>Is it an open source project? Link the code! :-) Why do you care about ISO 9141? It’s basically gone in new cars anyway…</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=13999#respond" data-commentid="13999" data-postid="1419" data-belowelement="comment-13999" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-toyssan1 odd alt depth-3 highlander-comment" id="li-comment-14008">
		<div id="comment-14008">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/8892d47c8160275265776c6830b23193.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-8892d47c8160275265776c6830b23193-1" width="40" height="40">			<cite class="fn">toyssan1</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-14008">2015/04/08 at 17:58</a></div>

		<div class="comment-body"><p>I will create a git repo and link it here
 in the next few days.  It is very minimal code though, but helping 
others with a jumping off point would be great…I myself am not much of a
 developer.</p>
<p>Still a lot of cars on the road that are not CAN and will be for quite some time.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-odd thread-alt depth-1 highlander-comment" id="li-comment-14054">
		<div id="comment-14054">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/3d8f672a2abaf8e0fa0be51217db2642.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-3d8f672a2abaf8e0fa0be51217db2642-0" width="40" height="40">			<cite class="fn">Mirsat Murutoglu</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-14054">2015/04/11 at 17:00</a></div>

		<div class="comment-body"><p>Hi,</p>
<p>Thanks for your assistance to let us know more about CAN. I have used
 a phyton sniffer and arduino can-bus shiled to analyse the data. Im 
trying to figure out how aircon works. I have found all the related 
CAN-BUS ids and datas for the aircon. When i send them back it doesn’t 
care my data it keeps sending its own data. I used this way to lock 
unlock the doors, open the windows, move the seats, lights and so on. i 
used the aircon id and  data for same brand car but different model it 
worked. I wonder that it maybe LIN-BUS or something else? here is my id 
and sample data for fan level and temperature:<br>
CAN ID: 856, data: 0, 0, 0, 0, 21, 21, 153, 17<br>
CAN ID: 856, data: 0, 0, 0, 0, 21, 21, 153, 34<br>
CAN ID: 856, data: 0, 0, 0, 0, 21, 21, 153, 51</p>
<p>17,34 and 51 are for fan level and 21 is for temperature<br>
The car is 2015 Model.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=14054#respond" data-commentid="14054" data-postid="1419" data-belowelement="comment-14054" data-respondelement="respond" data-replyto="Reply to Mirsat Murutoglu" aria-label="Reply to Mirsat Murutoglu">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor odd alt depth-2 highlander-comment" id="li-comment-14079">
		<div id="comment-14079">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-30" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-14079">2015/04/12 at 23:18</a></div>

		<div class="comment-body"><p>Hi Mirsat, no idea how to help you, CAN 
connected ECU typically works by sending the data on the bus 
periodically, so the one you are injecting is probably being immediately
 overwritten by the original one. It may work if the data is not 
periodic, so it may be that the same frame is used in different way in 
different versions of the ECU (maybe in one version is periodic and some
 other is not).</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=14079#respond" data-commentid="14079" data-postid="1419" data-belowelement="comment-14079" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-even depth-1 highlander-comment" id="li-comment-14083">
		<div id="comment-14083">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/3d8f672a2abaf8e0fa0be51217db2642.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-3d8f672a2abaf8e0fa0be51217db2642-1" width="40" height="40">			<cite class="fn">Mirsat Murutoglu</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-14083">2015/04/13 at 07:03</a></div>

		<div class="comment-body"><p>Actually both cars send the same data and
 same id periodically but one is responding my data other one is keep 
sending its own data and do its way. Even i send my data more than the 
original one.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=14083#respond" data-commentid="14083" data-postid="1419" data-belowelement="comment-14083" data-respondelement="respond" data-replyto="Reply to Mirsat Murutoglu" aria-label="Reply to Mirsat Murutoglu">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor odd alt depth-2 highlander-comment" id="li-comment-14099">
		<div id="comment-14099">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-31" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-14099">2015/04/14 at 20:12</a></div>

		<div class="comment-body"><p>That’s awkward… no idea what’s going on there.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=14099#respond" data-commentid="14099" data-postid="1419" data-belowelement="comment-14099" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment even depth-3 highlander-comment" id="li-comment-14108">
		<div id="comment-14108">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/3d8f672a2abaf8e0fa0be51217db2642.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-3d8f672a2abaf8e0fa0be51217db2642-2" width="40" height="40">			<cite class="fn">Mirsat Murutoglu</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-14108">2015/04/15 at 09:14</a></div>

		<div class="comment-body"><p>Yepp thats what i am trying to do ,I will let you know if i do it. Thanks</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="li-comment-14179">
		<div id="comment-14179">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/picture_004.jpeg" class="avatar avatar-40" width="40" height="40">			<cite class="fn"><a href="http://www.facebook.com/100001472121713" rel="external nofollow ugc" class="url">Sarthak Jain</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-14179">2015/04/21 at 05:28</a></div>

		<div class="comment-body"><p>Hey,</p>
<p>I was able to get the data from the car via USB2CAN converter.</p>
<p>‘candump’ is working fine but when I use ‘cansend’ in a while loop, it is showing an error – “write:no buffer space”.</p>
<p>Can you comment on this?</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=14179#respond" data-commentid="14179" data-postid="1419" data-belowelement="comment-14179" data-respondelement="respond" data-replyto="Reply to Sarthak Jain" aria-label="Reply to Sarthak Jain">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2 highlander-comment" id="li-comment-14200">
		<div id="comment-14200">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-32" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-14200">2015/04/23 at 18:26</a></div>

		<div class="comment-body"><p>That happens if no devices on the bus are
 acknowledging a frame in the tx queue. Are you transmitting on the car 
bus or on a loopback interface?</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=14200#respond" data-commentid="14200" data-postid="1419" data-belowelement="comment-14200" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1 highlander-comment" id="li-comment-14206">
		<div id="comment-14206">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/picture_004.jpeg" class="avatar avatar-40" width="40" height="40">			<cite class="fn"><a href="http://www.facebook.com/100001472121713" rel="external nofollow ugc" class="url">Sarthak Jain</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-14206">2015/04/24 at 14:01</a></div>

		<div class="comment-body"><p>Yes, I am transmitting on the can bus itself.</p>
<p>I actually first recorded some packets responsible for some action. 
And then I replayed the same packet but reducing the ID by 8.<br>
For ex – If the packet is ‘3E8 F5’, then I will send ‘3E0 F5’ because 
when a controller transmits some packets, it does it by adding 8 to its 
identifier. So the actual ID in the previous case is not ‘3E8’ but 
‘3E0’.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=14206#respond" data-commentid="14206" data-postid="1419" data-belowelement="comment-14206" data-respondelement="respond" data-replyto="Reply to Sarthak Jain" aria-label="Reply to Sarthak Jain">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2 highlander-comment" id="li-comment-14231">
		<div id="comment-14231">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-33" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-14231">2015/04/26 at 14:30</a></div>

		<div class="comment-body"><p>Ok, in that case it may be that none of the nodes in the bus are acknowledging that frame ID.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=14231#respond" data-commentid="14231" data-postid="1419" data-belowelement="comment-14231" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="li-comment-14992">
		<div id="comment-14992">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/58e5b642022a7428edc71ee3f18d0524.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-58e5b642022a7428edc71ee3f18d0524-0" width="40" height="40">			<cite class="fn">Chris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-14992">2015/07/17 at 16:01</a></div>

		<div class="comment-body"><p>Hi.</p>
<p>My friend is trying to build a device (rasberry pi) that will act as a
 go-between for two different cam buses that run at different speed.  He
 simply wants to pass the cambus data from one to the other, with 
possibly some translation of the codes inbetween.  Is this easily 
possible or do you know of any code or device that will do it?<br>
Thanks!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=14992#respond" data-commentid="14992" data-postid="1419" data-belowelement="comment-14992" data-respondelement="respond" data-replyto="Reply to Chris" aria-label="Reply to Chris">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment even depth-2 highlander-comment" id="li-comment-14993">
		<div id="comment-14993">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/58e5b642022a7428edc71ee3f18d0524.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-58e5b642022a7428edc71ee3f18d0524-1" width="40" height="40">			<cite class="fn">Chris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-14993">2015/07/17 at 16:02</a></div>

		<div class="comment-body"><p>Canbus, not cambus!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=14993#respond" data-commentid="14993" data-postid="1419" data-belowelement="comment-14993" data-respondelement="respond" data-replyto="Reply to Chris" aria-label="Reply to Chris">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor odd alt depth-2 highlander-comment" id="li-comment-14998">
		<div id="comment-14998">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-34" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-14998">2015/07/17 at 19:38</a></div>

		<div class="comment-body"><p>Hey Chris, I think that cars with 
multiple bus commonly include that functionality in some node. You want 
to make sure to not overrun on the slow bus write queue.</p>
<p>I would suggest you to avoid using a rPI for this, unless you can 
connect a CAN interface that can handle the two busses at full speed. 
It’s tempting to use an SPI controller (the MCP2515 is very common), but
 that has terrible performances on highly loaded fast busses, and you 
will end up with problem such as RX buffer underruns and out-of-order 
frames. You should look into SoCs with two embedded controllers, the 
AM335x used in the BeagleBone Black with an appropriate cape may be ok –
 but whatever design you take make sure to load test it.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=14998#respond" data-commentid="14998" data-postid="1419" data-belowelement="comment-14998" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment even depth-3 highlander-comment" id="li-comment-14999">
		<div id="comment-14999">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/58e5b642022a7428edc71ee3f18d0524.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-58e5b642022a7428edc71ee3f18d0524-2" width="40" height="40">			<cite class="fn">Chris</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-14999">2015/07/17 at 22:57</a></div>

		<div class="comment-body"><p>Thanks for that info fabio.</p>
<p>He says he’s bought a can-bus shield for the pi that can support two canbus inputs.</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment byuser comment-author-toyssan1 odd alt depth-2 highlander-comment" id="li-comment-19169">
		<div id="comment-19169">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/8892d47c8160275265776c6830b23193.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-8892d47c8160275265776c6830b23193-2" width="40" height="40">			<cite class="fn">treadlite</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-19169">2016/07/12 at 02:22</a></div>

		<div class="comment-body"><p>Yes, you can do this.  I have actually 
built hardware specifically for this purpose using stm32 processors.  I 
added Bluetooth, wifi and some on board memory  in order to make it 
configurable without re-coding</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=19169#respond" data-commentid="19169" data-postid="1419" data-belowelement="comment-19169" data-respondelement="respond" data-replyto="Reply to treadlite" aria-label="Reply to treadlite">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-even depth-1 highlander-comment" id="li-comment-15116">
		<div id="comment-15116">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/02aee08881b9b76fad56400ab2ad78ff.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-02aee08881b9b76fad56400ab2ad78ff-0" width="40" height="40">			<cite class="fn">andrea canestrari</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-15116">2015/07/24 at 11:50</a></div>

		<div class="comment-body"><p>Hi Fabio, we are practically working with
 the same project I have two raspberry b + with the card pican, works 
can send messages and read them to each other with instructions and 
cansend candump, but are raw hexadecimal values.</p>
<p>my problem is to create a code for raspian to show me just a 
parameter for example, this implementation will have to be installed in a
 vehicle and would like to show to the screen for example, only the 
position of the accelerator pedal, I looked at your project and what I 
would do too I but of raspberry, you are able to create this? You have 
resources where I can read up.</p>
<p>grazie per quello che hai postato fino ad ora è stato veramente utile chiaro e puntuale.</p>
<p>a presto</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=15116#respond" data-commentid="15116" data-postid="1419" data-belowelement="comment-15116" data-respondelement="respond" data-replyto="Reply to andrea canestrari" aria-label="Reply to andrea canestrari">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor odd alt depth-2 highlander-comment" id="li-comment-15260">
		<div id="comment-15260">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-35" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-15260">2015/08/05 at 20:47</a></div>

		<div class="comment-body"><p>Hey Andrea, the code I posted as an 
example does something similar and should build fine on any 
architecture… You may use that as a starting point. :-)</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=15260#respond" data-commentid="15260" data-postid="1419" data-belowelement="comment-15260" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-odd thread-alt depth-1 highlander-comment" id="li-comment-18507">
		<div id="comment-18507">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/01d78393eac95f400738a59e087b6b4b.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-01d78393eac95f400738a59e087b6b4b-0" width="40" height="40">			<cite class="fn">Daksh Vasistha</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-18507">2016/03/21 at 03:58</a></div>

		<div class="comment-body"><p>Great Work, one question, can we also see acknowledgement information in the logs?<br>
Like when ECU sends negative ACK or positive ACK to sender after receiving packet.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=18507#respond" data-commentid="18507" data-postid="1419" data-belowelement="comment-18507" data-respondelement="respond" data-replyto="Reply to Daksh Vasistha" aria-label="Reply to Daksh Vasistha">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor odd alt depth-2 highlander-comment" id="li-comment-18554">
		<div id="comment-18554">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-36" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-18554">2016/03/25 at 00:30</a></div>

		<div class="comment-body"><p>Hey Daksh, sort of. First, there’s no 
such thing as a negative ACK as far as I’m aware of: once a frame is on 
the wire it either gets ACKed from at least one of the other nodes or 
not (see the note about ACK slot in the frame format I posted).</p>
<p>ACKs in CANBUS are weird, depending on how transmitter and receiver 
nodes are configured you may have different things happening:<br>
– the receiver ACKs anything that matches the acceptance filter unless 
it’s in listen-only mode. I don’t know if any CAN controller can go into
 listen-only mode and expose whether a frame has been ACKed by some 
other node or not, but the MCP2515, the SJA1000 and socketcan itself 
does not seem to support this.<br>
– if the transmitter is sending in one-shot mode, it’s just going to put
 the frame on the wire and stop regardless of the fact that any other 
node acknowledged or not.<br>
– if the transmitter is in normal mode and no other node ACKs a frame, 
the frame gets re-sent indefinitely (you can see this happening on a 
listen-only node).</p>
<p>Either way, to get the information on what’s going on with the ACKs 
on the bus I think you may need to use a logic analyzer that supports 
CANBUS decoding, so that you can tap into a live bus and see if anything
 is transmitting dominant bits on the ACK slot.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=18554#respond" data-commentid="18554" data-postid="1419" data-belowelement="comment-18554" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-even depth-1 highlander-comment" id="li-comment-18654">
		<div id="comment-18654">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/49314ada5ce97e95929c7d04fcf04ae3.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-49314ada5ce97e95929c7d04fcf04ae3-0" width="40" height="40">			<cite class="fn">xavier M</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-18654">2016/03/30 at 01:40</a></div>

		<div class="comment-body"><p>Hi Fabio,</p>
<p>Is it possible to run this c program on my i.mx6 board? How would I 
compile the code and run it on my embedded device? I’m very new to linux
 and just need a point in the right direction.</p>
<p>Thanks</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=18654#respond" data-commentid="18654" data-postid="1419" data-belowelement="comment-18654" data-respondelement="respond" data-replyto="Reply to xavier M" aria-label="Reply to xavier M">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor odd alt depth-2 highlander-comment" id="li-comment-18678">
		<div id="comment-18678">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-37" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-18678">2016/03/31 at 22:30</a></div>

		<div class="comment-body"><p>Hey Xavier, yeah totally, as you can see 
from the code this has very few dependencies. Basically you need the 
compiler (native or cross), the kernel headers for the userspace (that’s
 needed for the various #include &lt;linux/…&gt;), and the ncurses 
libraries and headers (for the #include &lt;curses.h&gt;. For the 
former, from how I’ve set up the makefile you need to have 
ncurses5-config in the PATH).</p>
<p>If you have everything give it a “make” and it should build. If you 
are cross compiling make sure to specify the cross compiler, something 
like “CC=arm-linux-gnueabi-gcc make”.</p>
<p>Cheers!<br>
Fabio</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=18678#respond" data-commentid="18678" data-postid="1419" data-belowelement="comment-18678" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-odd thread-alt depth-1 highlander-comment" id="li-comment-19165">
		<div id="comment-19165">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/851a570e1c6ea73b599b6a1a87b675f7.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-851a570e1c6ea73b599b6a1a87b675f7-0" width="40" height="40">			<cite class="fn"><a href="http://gravatar.com/dkowalsky7" rel="external nofollow ugc" class="url">Daniel Kowalsky</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-19165">2016/07/11 at 23:04</a></div>

		<div class="comment-body"><p>First off this is an awesome post. I have
 been putting this method to work on a few cars at home. I am doing an 
experiment with a VW E-Golf and I need the % charge of the battery, 
which is unfortunately not available through OBD2.</p>
<p>I have been successfully in decoding some CAN data on other cars, 
however on the E-Golf, only one pid is returned every couple of second. I
 thought it could be and error frame (only because I had not seen any of
 these yet). The values of the frame stay the same and are 20 01 00 00 
00 00 00 80. I tried hitting buttons and driving and they didn’t change.
 I tried to print just the error frames using the 0~0 on socketcan and 
still nothing.</p>
<p>Is it possible that I need to access another CANBUS on the car? Or 
does this seem odd to you as well. I would think (from what I have seen 
and read) that there should be more than one pid on the system. I had 
set the bitrate to 500,000 and thought maybe I had that setting wrong. I
 tried the other standard rates 10k,20k,100k,125k,250k,800k,1000k and 
they all print nothing. A VW manual for the BUS system stated that 500k 
was used for high speed data rates.</p>
<p>If you could shed any light on the matter, it would be greatly appreciated.</p>
<p>Best,<br>
Dan</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=19165#respond" data-commentid="19165" data-postid="1419" data-belowelement="comment-19165" data-respondelement="respond" data-replyto="Reply to Daniel Kowalsky" aria-label="Reply to Daniel Kowalsky">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor odd alt depth-2 highlander-comment" id="li-comment-19168">
		<div id="comment-19168">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-38" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-19168">2016/07/12 at 02:07</a></div>

		<div class="comment-body"><p>Hey Dan, that’s a nice modern car packed 
with electronics… I would not be surprised if the CAN on the OBD 
connector is for OBD only and there are one or two other dedicated 
busses for high speed critical stuff. I’ve actually read of other cars 
with this setup (some Volvo). If you want to be sure you can check the 
signal with a scope but since you are getting something reasonable it 
may be indeed all that is in that bus.</p>
<p>The charge status and other information should be sent to the central
 dashboard somehow. I would start by taking that off the console and 
look for a twisted pair on the data connector on its back. Then you can 
either figure if that also ends on the OBD port in some of the vendor 
specific pins, or just splice a tap from there and start looking for 
your number.</p>
<p>Good luck with that! Can’t wait to hear the progress. :-)</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=19168#respond" data-commentid="19168" data-postid="1419" data-belowelement="comment-19168" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-dkowalsky7 even depth-3 highlander-comment" id="li-comment-19172">
		<div id="comment-19172">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/851a570e1c6ea73b599b6a1a87b675f7.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-851a570e1c6ea73b599b6a1a87b675f7-1" width="40" height="40">			<cite class="fn"><a href="http://dkowalsky7.wordpress.com/" rel="external nofollow ugc" class="url">dkowalsky7</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-19172">2016/07/12 at 05:14</a></div>

		<div class="comment-body"><p>I think your 100% right this guy was 
saying something similar about the bus connected to the obd2 only being 
used to send information. He used the back of the radio, not sure if 
this will work from me, but it can display similar information as the 
dash. I cannot go around splicing wires because the car is lease so if i
 can use a harness to splice wires, I think i will be safer. I 
appreciate the reply I will post with the results!</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
	<li class="comment byuser comment-author-dkowalsky7 odd alt depth-3 highlander-comment" id="li-comment-19173">
		<div id="comment-19173">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/851a570e1c6ea73b599b6a1a87b675f7.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-851a570e1c6ea73b599b6a1a87b675f7-2" width="40" height="40">			<cite class="fn"><a href="http://dkowalsky7.wordpress.com/" rel="external nofollow ugc" class="url">dkowalsky7</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-19173">2016/07/12 at 05:15</a></div>

		<div class="comment-body"><p><a href="http://chadgibbons.com/2013/12/29/hacking-the-jeep-interior-can-bus/comment-page-2/#comment-43746" rel="nofollow ugc">http://chadgibbons.com/2013/12/29/hacking-the-jeep-interior-can-bus/comment-page-2/#comment-43746</a></p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment byuser comment-author-kurtdaveting even thread-even depth-1 highlander-comment" id="li-comment-19274">
		<div id="comment-19274">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/ad16af586130dc83f74e9c973e6bfc92.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-ad16af586130dc83f74e9c973e6bfc92-0" width="40" height="40">			<cite class="fn"><a href="http://coolkidkurt.wordpress.com/" rel="external nofollow ugc" class="url">kurt</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-19274">2016/08/28 at 10:40</a></div>

		<div class="comment-body"><p>Currently I’ve been trying to reprogram 
my instrument cluster for information display changes.My current project
 is on a Toyota Corolla 2014. Current information display have the 
following options available to the user:</p>
<p>Average Fuel Consumption<br>
Cruising Range until empty<br>
Trip Elapsed Time<br>
Average Speed<br>
Realtime Fuel Consuption<br>
Setting (for brightness etc)<br>
The display cluster is controlled by a single button for switching 
displays. My project consists of changing ( or possibly ) adding a menu.
 For the displays that is subject to change, I want to replace the 
Average Speed display to Current Speed. Also, if possible, I want to add
 a menu for displaying Engine Load and Voltage Meter.</p>
<p>How can I reprogram the instrument cluster? Can i do it via OBD2? 
Also, what tools do i need? Any feedback would be greatly appreciated. 
Thank you.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=19274#respond" data-commentid="19274" data-postid="1419" data-belowelement="comment-19274" data-respondelement="respond" data-replyto="Reply to kurt" aria-label="Reply to kurt">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor odd alt depth-2 highlander-comment" id="li-comment-19275">
		<div id="comment-19275">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-39" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-19275">2016/08/28 at 16:21</a></div>

		<div class="comment-body"><p>Hey Kurt, hard to say if and how that can
 be done. Sounds like you need to identify the device controlling the 
menu, dump the firmware, and hack it or rewrite it from scratch to add 
what you need. A good starting point may be to take the instrument 
cluster apart and reverse engineer it… assuming that it’s not just a 
dumb display and the actual data is generated from the car radio or some
 other ECU.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=19275#respond" data-commentid="19275" data-postid="1419" data-belowelement="comment-19275" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment even thread-odd thread-alt depth-1 highlander-comment" id="li-comment-19604">
		<div id="comment-19604">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/cde9d51eb04a453905b091975848016d.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-cde9d51eb04a453905b091975848016d-0" width="40" height="40">			<cite class="fn">San</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-19604">2017/01/05 at 11:20</a></div>

		<div class="comment-body"><p>Ciao Fabio,<br>
complimenti per l’articolo. Un bel lavoro da parte tua e molto 
interessante. Sto facendo varie ricerche per poter fare il dump del 
firmware della mia auto (Fiat Tipo 2016) che ha come sistema uConnect 
(basato su qnx). Hai mai provato su questa auto? Qualche dritta hw/sw da
 utilizzare per poter fare il dump ed un possibile reverse engineering? 
L’auto in questione ovviamente ha OBD2, porta USB e BT.<br>
Grazie.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=19604#respond" data-commentid="19604" data-postid="1419" data-belowelement="comment-19604" data-respondelement="respond" data-replyto="Reply to San" aria-label="Reply to San">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor odd alt depth-2 highlander-comment" id="li-comment-19615">
		<div id="comment-19615">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-40" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-19615">2017/01/07 at 21:55</a></div>

		<div class="comment-body"><p>Ciao! Nessuna esperienza diretta ma da 
quanto so i comandi per accedere al firmware vanno sbloccati in qualche 
modo… challange authentication e altri meccanismi. Ti consiglio di 
guardare questo talk registrato al CCC qualche settimana fa, parla 
esattamente di dump firmware e memoria via CAN: <a href="https://media.ccc.de/v/33c3-7904-software_defined_emissions#video" rel="nofollow ugc">https://media.ccc.de/v/33c3-7904-software_defined_emissions#video</a> :-)</p>
<p>TL;DR in english: this is about accessing the ECU firmware via 
CANBUS, there are some cool details about that in this lecture from 
33C3: <a href="https://media.ccc.de/v/33c3-7904-software_defined_emissions#video" rel="nofollow ugc">https://media.ccc.de/v/33c3-7904-software_defined_emissions#video</a></p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=19615#respond" data-commentid="19615" data-postid="1419" data-belowelement="comment-19615" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment even depth-3 highlander-comment" id="li-comment-19619">
		<div id="comment-19619">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/cde9d51eb04a453905b091975848016d.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-cde9d51eb04a453905b091975848016d-1" width="40" height="40">			<cite class="fn">san</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-19619">2017/01/09 at 09:08</a></div>

		<div class="comment-body"><p>Hi Fabio,<br>
Thanks for reply. I will inform to you about my research.</p>
<p>Best Regards,<br>
San</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1 highlander-comment" id="li-comment-19964">
		<div id="comment-19964">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/da19e019aa6d6fb72ee05078babbcf72.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-da19e019aa6d6fb72ee05078babbcf72-0" width="40" height="40">			<cite class="fn">lalli</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-19964">2017/04/12 at 14:25</a></div>

		<div class="comment-body"><p>In my project, I need to read CAN data 
and place that data onto another tool which is developed under Linux. As
 of my research I came across that Linux kernel supports socket CAN 
stack. Is it possible to read/write CAN data using Socket CAN stack and 
place that data on to the tool that is developed under Linux?</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=19964#respond" data-commentid="19964" data-postid="1419" data-belowelement="comment-19964" data-respondelement="respond" data-replyto="Reply to lalli" aria-label="Reply to lalli">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2 highlander-comment" id="li-comment-19996">
		<div id="comment-19996">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-41" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-19996">2017/04/19 at 18:40</a></div>

		<div class="comment-body"><p>Hi! I guess it is as long as you have an API for that tool to inject the data. Is it a public? Just curious of what that is. :-)</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=19996#respond" data-commentid="19996" data-postid="1419" data-belowelement="comment-19996" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment byuser comment-author-manu144x odd alt thread-odd thread-alt depth-1 highlander-comment" id="li-comment-20463">
		<div id="comment-20463">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/c434e8c158924e6d6763eb091221af91.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-c434e8c158924e6d6763eb091221af91-0" width="40" height="40">			<cite class="fn"><a href="http://www.kloampa.net/" rel="external nofollow ugc" class="url">manu144x</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-20463">2017/06/06 at 19:08</a></div>

		<div class="comment-body"><p>I got inspired by your project, studied around and finally got to purchase a USB2CAN interface (<a href="http://shop.8devices.com/index.php?route=product/product&amp;product_id=54" rel="nofollow ugc">http://shop.8devices.com/index.php?route=product/product&amp;product_id=54</a>)
 and a an OBD to DB9 cable however as soon as I initialize the 
interface, everything goes crazy in the car. I get every possible error,
 and usually after I take the interface out and restart the car all is 
good.</p>
<p>My car is a Peugeot 508, and I found out it’s using 11bit 500kbps CAN
 protocol. I assume I am doing something wrong? The interface supports 
up to 1Mbit buses, and everybody was praising it. I wanted to use it to 
capture information, and mostly just learn since it’s also a hybrid liek
 your toyota :)</p>
<p>If you have any hints or things I should try, let me know. Thank you.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=20463#respond" data-commentid="20463" data-postid="1419" data-belowelement="comment-20463" data-respondelement="respond" data-replyto="Reply to manu144x" aria-label="Reply to manu144x">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2 highlander-comment" id="li-comment-20480">
		<div id="comment-20480">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-42" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-20480">2017/06/08 at 23:08</a></div>

		<div class="comment-body"><p>Hi! I would start by verifying that the 
cable is wired correctly for the device. From what I remember the 
OBD-DB9 wiring on common cables was different from the DB9 CANBUS wiring
 commonly used in industrial applications (which is surely the one for 
the 8devices adapter). I’ve always used a custom cable for my tests 
(terminated on a 8P8C actually). If you are confident that the wiring is
 correct, make sure to put the interface in listen-only mode. That way 
even if you get the wrong bitrate, it should not make noise on the bus. 
Keep us posted!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=20480#respond" data-commentid="20480" data-postid="1419" data-belowelement="comment-20480" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-manu144x odd alt depth-3 highlander-comment" id="li-comment-20538">
		<div id="comment-20538">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/c434e8c158924e6d6763eb091221af91.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-c434e8c158924e6d6763eb091221af91-1" width="40" height="40">			<cite class="fn"><a href="http://www.kloampa.net/" rel="external nofollow ugc" class="url">manu144x</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-20538">2017/06/17 at 15:41</a></div>

		<div class="comment-body"><p>Well you were right, that’s what I suspected too, that the cable is wrong, and I ordered a different one.</p>
<p>Now works perfectly, I initialized it and works, I can see the entire bus :)</p>
<p>Now I don’t know what bus is exposed on the OBD port, I do know it 
runs at 500kbps. Mostly I want to enter the comfort bus and learn it, 
but of course, the big dissapointment now will be identifying the 
packets.</p>
<p>I found a very interesting provider, they claim to sell CAN packet 
databases for different brands, I will see if I can get something, even 
if I have to buy it, I don’t mind, I want to build a better navigator.</p>
<p>Here is the site btw: <a href="https://www.beijer.com/en/services-solutions/can-solutions/the-beijer-can-database/" rel="nofollow ugc">https://www.beijer.com/en/services-solutions/can-solutions/the-beijer-can-database/</a></p>
<p>Of course if you know a place I could find something, unfortunately 
since it’s a french care I am aware I may have to learn french :)</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-3 highlander-comment" id="li-comment-20547">
		<div id="comment-20547">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-43" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-20547">2017/06/18 at 18:10</a></div>

		<div class="comment-body"><p>Hey well done! 500kbps is fairly fast, 
the bus is probably not going too far, but who knows… The list on that 
website is pretty interesting, gives you some motivation to identify all
 of those by yourself. I’m not aware of any public database 
unfortunately… bug good luck with the “french for automotive” lessons if
 you find some! :-)</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1 highlander-comment" id="li-comment-20537">
		<div id="comment-20537">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/f248cf3c1869a023587fada421787b0f.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-f248cf3c1869a023587fada421787b0f-0" width="40" height="40">			<cite class="fn">Paolo</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-20537">2017/06/17 at 15:05</a></div>

		<div class="comment-body"><p>Hello, Any chance to control internal 
devices such as window or lights in a new Fiat 500 through the canbus ? I
 made this on a BMW.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=20537#respond" data-commentid="20537" data-postid="1419" data-belowelement="comment-20537" data-respondelement="respond" data-replyto="Reply to Paolo" aria-label="Reply to Paolo">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2 highlander-comment" id="li-comment-20546">
		<div id="comment-20546">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-44" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-20546">2017/06/18 at 18:05</a></div>

		<div class="comment-body"><p>No idea without trying… I played a bit 
with this on a Fiat Bravo, the lights signals were on the bus they may 
be there only for showing up on the dashboard and not for controlling 
the actual light. Keep us posted if you do some test!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=20546#respond" data-commentid="20546" data-postid="1419" data-belowelement="comment-20546" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="li-comment-20559">
		<div id="comment-20559">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/95528cbbc1a28cc5673e1ed978f99761.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-95528cbbc1a28cc5673e1ed978f99761-0" width="40" height="40">			<cite class="fn">George</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-20559">2017/06/21 at 14:37</a></div>

		<div class="comment-body"><p>Hi there, great job at experimenting with the Yaris.<br>
I have a question though; I have a spare instrument cluster (the 
electronic one just like yours since I changed to the analogue cluster 
in my 2007 yaris), and I want to find a way to drive the cluster, by 
information from racing simulators on PC. I have seen videos doing that 
with an arduino but with German vehicles’ clusters. I was lucky enough 
to stumble upon your video with the exact same instrument cluster as 
mine.<br>
Do you by any chance have any idea on how to tackle this? I want the 
RPM, speed and other data synced with the game’s on screen speed RPM 
etc.</p>
<p>How possible do you think it is with this particular cluster?</p>
<p>Cheers from Greece, George.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=20559#respond" data-commentid="20559" data-postid="1419" data-belowelement="comment-20559" data-respondelement="respond" data-replyto="Reply to George" aria-label="Reply to George">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2 highlander-comment" id="li-comment-20623">
		<div id="comment-20623">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-45" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-20623">2017/07/02 at 20:24</a></div>

		<div class="comment-body"><p>Hi George! Yeah it’s definitely doable, I
 did an external custom gear indicator and shiftlight myself for LFS 
many years ago. You need to figure how to power up and inject the data 
on the real display, so get a power supply, a CANBUS interface, and try 
putting some valid speed and rpm frame on the bus (you have the format 
from my software). If you can get that working you need to find the 
documentation for external display for your racing simulator and just 
glue the two together. For LFS it was a simple UDP based interface, you 
tell the game where to send the data to and your application would get 
periodic status updates, look for OutGauge in <a href="https://en.lfsmanual.net/wiki/InSim.txt" rel="nofollow ugc">https://en.lfsmanual.net/wiki/InSim.txt</a>. Any other game, I’ve no idea. :-) Keep us posted!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=20623#respond" data-commentid="20623" data-postid="1419" data-belowelement="comment-20623" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-even depth-1 highlander-comment" id="li-comment-20822">
		<div id="comment-20822">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/ad726c8f95e3c44087f0430d1ef9427b.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-ad726c8f95e3c44087f0430d1ef9427b-0" width="40" height="40">			<cite class="fn">J. Zegers</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-20822">2017/08/09 at 14:21</a></div>

		<div class="comment-body"><p>Hi,</p>
<p>I am trying to find a way to control the blinker (turn indicator 
light) of a Toyota Prius (2009). Does anyone know if this a signal on 
the vehicle’s CAN bus?<br>
I heard from someone that this signal is not on the CAN bus, but I cannot find anything about this on the internet.</p>
<p>I hope someone can give me some more information on this. Thanks in advance!</p>
<p>Kind regards,<br>
J. Zegers</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=20822#respond" data-commentid="20822" data-postid="1419" data-belowelement="comment-20822" data-respondelement="respond" data-replyto="Reply to J. Zegers" aria-label="Reply to J. Zegers">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2 highlander-comment" id="li-comment-20841">
		<div id="comment-20841">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-46" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-20841">2017/08/14 at 22:13</a></div>

		<div class="comment-body"><p>Hi! Hard to say… if you can dump the 
traffic you should turn the turn indicator on and see if you can find 
some bit on some frame somewhere that toggles with the control or with 
the light. You may also try look for some service manual for the 
instrument cluster and figure if there is a dedicated wiring for it. If 
that’s the case, there’s probably no signal on the bus.</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=20841#respond" data-commentid="20841" data-postid="1419" data-belowelement="comment-20841" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="li-comment-21343">
		<div id="comment-21343">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/32d9072fc222c85a7f0b3d9eef210964.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-32d9072fc222c85a7f0b3d9eef210964-0" width="40" height="40">			<cite class="fn">Kevin Buckham</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-21343">2017/10/26 at 00:18</a></div>

		<div class="comment-body"><p>Would you be willing to share one of your
 CAN dumps?  I’m trying to hack the electrical power steering from a 
similar Toyota into my car and I’m curious to see if I can convince the 
power steering ECU that is talking to a car by just playing some data 
back.   With a little hacking I should be able to modify the wheelspeed 
CAN messages and maybe (hopefully) have the steering assist change.</p>
<p>The motor I’ll be using is from a 2007 Yaris, but I’m still missing the Yaris steering control ECU (should be acquired shortly).</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=21343#respond" data-commentid="21343" data-postid="1419" data-belowelement="comment-21343" data-respondelement="respond" data-replyto="Reply to Kevin Buckham" aria-label="Reply to Kevin Buckham">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment byuser comment-author-fabiobaltieri bypostauthor even depth-2 highlander-comment" id="li-comment-21349">
		<div id="comment-21349">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/9316867f55badf12db1d3da5ee59e93d.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-9316867f55badf12db1d3da5ee59e93d-47" width="40" height="40">			<cite class="fn"><a href="https://fabiobaltieri.wordpress.com/" rel="external nofollow ugc" class="url">fabiobaltieri</a></cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-21349">2017/10/26 at 22:42</a></div>

		<div class="comment-body"><p>Hey Kevin, unfortunately I never 
committed the dumps from that demo and they are long gone, and I also 
don’t have the car anymore.</p>
<p>You should be able to simulate some frame from the source code though… maybe that’s enough.</p>
<p>Good luck!</p>
</div>

		<div class="reply">
			<a rel="nofollow" class="comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/?replytocom=21349#respond" data-commentid="21349" data-postid="1419" data-belowelement="comment-21349" data-respondelement="respond" data-replyto="Reply to fabiobaltieri" aria-label="Reply to fabiobaltieri">Reply</a>		</div>
	</div>

	<ul class="children">
	<li class="comment odd alt depth-3 highlander-comment" id="li-comment-21353">
		<div id="comment-21353">
		<div class="comment-author vcard">
			<img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/32d9072fc222c85a7f0b3d9eef210964.png" class="avatar avatar-40 grav-hashed grav-hijack" id="grav-32d9072fc222c85a7f0b3d9eef210964-1" width="40" height="40">			<cite class="fn">Kevin Buckham</cite> <span class="says">says:</span>		</div>
		
		<div class="comment-meta commentmetadata"><a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#comment-21353">2017/10/27 at 17:30</a></div>

		<div class="comment-body"><p>No problem, thanks for responding!  I’ll see if I can find a car to borrow for a bit.  :)</p>
</div>

		<div class="reply">
					</div>
	</div>

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	</ol>


	<div id="respond" class="comment-respond js">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://fabiobaltieri.com/wp-comments-post.php" method="post" id="commentform" class="comment-form"><input type="hidden" id="highlander_comment_nonce" name="highlander_comment_nonce" value="501cb0bc8a"><input type="hidden" name="_wp_http_referer" value="/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/">
<input type="hidden" name="hc_post_as" id="hc_post_as" value="guest">

<div class="comment-form-field comment-textarea">
	
	<div id="comment-form-comment" class="active"><textarea aria-hidden="true" tabindex="-1" style="position: absolute; inset: -999px auto auto 0px; border: 0px none; padding: 0px; box-sizing: content-box; overflow-wrap: break-word; height: 0px !important; min-height: 0px !important; overflow: hidden; transition: none 0s ease 0s; font-family: Arial, Helvetica, Tahoma, Verdana, sans-serif; font-size: 14px; font-weight: 400; font-style: normal; letter-spacing: 0px; text-transform: none; text-decoration: rgba(0, 0, 0, 0.7); word-spacing: 0px; text-indent: 0px; line-height: normal; width: 608px;" class="autosizejs ">Enter your comment here...</textarea><textarea id="comment" name="comment" title="Enter your comment here..." placeholder="Enter your comment here..." style="height: 36px; overflow: hidden; overflow-wrap: break-word; resize: none;">Enter your comment here...</textarea></div>
</div>

<div id="comment-form-identity" style="display: none;">
	<div id="comment-form-nascar">
		<p>Fill in your details below or click an icon to log in:</p>
		<ul>
			<li class="selected" style="display:none;">
				<a href="#comment-form-guest" id="postas-guest" class="nascar-signin-link" title="Login via Guest">
									</a>
			</li>
			<li>
				<a href="#comment-form-load-service:WordPress.com" id="postas-wordpress" class="nascar-signin-link" title="Login via WordPress.com">
					<svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24"><rect x="0" fill="none" width="24" height="24"></rect><g><path fill="#0087be" d="M12.158 12.786l-2.698 7.84c.806.236 1.657.365 2.54.365 1.047 0 2.05-.18 2.986-.51-.024-.037-.046-.078-.065-.123l-2.762-7.57zM3.008 12c0 3.56 2.07 6.634 5.068 8.092L3.788 8.342c-.5 1.117-.78 2.354-.78 3.658zm15.06-.454c0-1.112-.398-1.88-.74-2.48-.456-.74-.883-1.368-.883-2.11 0-.825.627-1.595 1.51-1.595.04 0 .078.006.116.008-1.598-1.464-3.73-2.36-6.07-2.36-3.14 0-5.904 1.613-7.512 4.053.21.008.41.012.58.012.94 0 2.395-.114 2.395-.114.484-.028.54.684.057.74 0 0-.487.058-1.03.086l3.275 9.74 1.968-5.902-1.4-3.838c-.485-.028-.944-.085-.944-.085-.486-.03-.43-.77.056-.742 0 0 1.484.114 2.368.114.94 0 2.397-.114 2.397-.114.486-.028.543.684.058.74 0 0-.488.058-1.03.086l3.25 9.665.897-2.997c.456-1.17.684-2.137.684-2.907zm1.82-3.86c.04.286.06.593.06.924 0 .912-.17 1.938-.683 3.22l-2.746 7.94c2.672-1.558 4.47-4.454 4.47-7.77 0-1.564-.4-3.033-1.1-4.314zM12 22C6.486 22 2 17.514 2 12S6.486 2 12 2s10 4.486 10 10-4.486 10-10 10z"></path></g></svg>				</a>
			</li>
			<li>
				<a href="#comment-form-load-service:Twitter" id="postas-twitter" class="nascar-signin-link" title="Login via Twitter">
					<svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24"><rect x="0" fill="none" width="24" height="24"></rect><g><path fill="#1DA1F2" d="M22.23 5.924c-.736.326-1.527.547-2.357.646.847-.508 1.498-1.312 1.804-2.27-.793.47-1.67.812-2.606.996C18.325 4.498 17.258 4 16.078 4c-2.266 0-4.103 1.837-4.103 4.103 0 .322.036.635.106.935-3.41-.17-6.433-1.804-8.457-4.287-.353.607-.556 1.312-.556 2.064 0 1.424.724 2.68 1.825 3.415-.673-.022-1.305-.207-1.86-.514v.052c0 1.988 1.415 3.647 3.293 4.023-.344.095-.707.145-1.08.145-.265 0-.522-.026-.773-.074.522 1.63 2.038 2.817 3.833 2.85-1.404 1.1-3.174 1.757-5.096 1.757-.332 0-.66-.02-.98-.057 1.816 1.164 3.973 1.843 6.29 1.843 7.547 0 11.675-6.252 11.675-11.675 0-.178-.004-.355-.012-.53.802-.578 1.497-1.3 2.047-2.124z"></path></g></svg>				</a>
			</li>
			<li>
				<a href="#comment-form-load-service:Facebook" id="postas-facebook" class="nascar-signin-link" title="Login via Facebook">
					<svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24"><rect x="0" fill="none" width="24" height="24"></rect><g><path fill="#3B5998" d="M20.007 3H3.993C3.445 3 3 3.445 3 3.993v16.013c0 .55.445.994.993.994h8.62v-6.97H10.27V11.31h2.346V9.31c0-2.325 1.42-3.59 3.494-3.59.993 0 1.847.073 2.096.106v2.43h-1.438c-1.128 0-1.346.537-1.346 1.324v1.734h2.69l-.35 2.717h-2.34V21h4.587c.548 0 .993-.445.993-.993V3.993c0-.548-.445-.993-.993-.993z"></path></g></svg>				</a>
			</li>
		</ul>
	</div>

	<div id="comment-form-guest" class="comment-form-service selected">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
<a href="https://gravatar.com/site/signup/" target="_blank">				<img src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/ad516503a11cd5ca435acc9bb6523536.png" alt="Gravatar" class="no-grav grav-hashed grav-hijack" id="grav-ad516503a11cd5ca435acc9bb6523536-0" width="25">
</a>			</div>

				<div class="comment-form-fields">
				<div class="comment-form-field comment-form-email">
					<label for="email">Email <span class="required">(required)</span> <span class="nopublish">(Address never made public)</span></label>
					<div class="comment-form-input"><input id="email" name="email" type="email"></div>
				</div>
				<div class="comment-form-field comment-form-author">
					<label for="author">Name <span class="required">(required)</span></label>
					<div class="comment-form-input"><input id="author" name="author" type="text"></div>
				</div>
				<div class="comment-form-field comment-form-url">
					<label for="url">Website</label>
					<div class="comment-form-input"><input id="url" name="url" type="url"></div>
				</div>
			</div>
			
		</div>
	</div>

	<div id="comment-form-wordpress" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/ad516503a11cd5ca435acc9bb6523536.png" alt="WordPress.com Logo" class="no-grav grav-hashed grav-hijack" id="grav-ad516503a11cd5ca435acc9bb6523536-1" width="25">
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="wp_avatar" id="wordpress-avatar" class="comment-meta-wordpress" value="">
				<input type="hidden" name="wp_user_id" id="wordpress-user_id" class="comment-meta-wordpress" value="">
				<input type="hidden" name="wp_access_token" id="wordpress-access_token" class="comment-meta-wordpress" value="">
						<p class="comment-form-posting-as pa-wordpress">
			<strong></strong>
			You are commenting using your WordPress.com account.			<span class="comment-form-log-out">
				(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'wordpress' );">Log&nbsp;Out</a>&nbsp;/&nbsp;
				<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)
			</span>
			<span class="pa-icon"><svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24"><rect x="0" fill="none" width="24" height="24"></rect><g><path fill="#0087be" d="M12.158 12.786l-2.698 7.84c.806.236 1.657.365 2.54.365 1.047 0 2.05-.18 2.986-.51-.024-.037-.046-.078-.065-.123l-2.762-7.57zM3.008 12c0 3.56 2.07 6.634 5.068 8.092L3.788 8.342c-.5 1.117-.78 2.354-.78 3.658zm15.06-.454c0-1.112-.398-1.88-.74-2.48-.456-.74-.883-1.368-.883-2.11 0-.825.627-1.595 1.51-1.595.04 0 .078.006.116.008-1.598-1.464-3.73-2.36-6.07-2.36-3.14 0-5.904 1.613-7.512 4.053.21.008.41.012.58.012.94 0 2.395-.114 2.395-.114.484-.028.54.684.057.74 0 0-.487.058-1.03.086l3.275 9.74 1.968-5.902-1.4-3.838c-.485-.028-.944-.085-.944-.085-.486-.03-.43-.77.056-.742 0 0 1.484.114 2.368.114.94 0 2.397-.114 2.397-.114.486-.028.543.684.058.74 0 0-.488.058-1.03.086l3.25 9.665.897-2.997c.456-1.17.684-2.137.684-2.907zm1.82-3.86c.04.286.06.593.06.924 0 .912-.17 1.938-.683 3.22l-2.746 7.94c2.672-1.558 4.47-4.454 4.47-7.77 0-1.564-.4-3.033-1.1-4.314zM12 22C6.486 22 2 17.514 2 12S6.486 2 12 2s10 4.486 10 10-4.486 10-10 10z"></path></g></svg></span>
		</p>
					</div>
	
		</div>
	</div>

	<div id="comment-form-googleplus" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/ad516503a11cd5ca435acc9bb6523536.png" alt="Google photo" class="no-grav grav-hashed grav-hijack" id="grav-ad516503a11cd5ca435acc9bb6523536-2" width="25">
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="googleplus_avatar" id="googleplus-avatar" class="comment-meta-googleplus" value="">
				<input type="hidden" name="googleplus_user_id" id="googleplus-user_id" class="comment-meta-googleplus" value="">
				<input type="hidden" name="googleplus_access_token" id="googleplus-access_token" class="comment-meta-googleplus" value="">
						<p class="comment-form-posting-as pa-googleplus">
			<strong></strong>
			You are commenting using your Google account.			<span class="comment-form-log-out">
				(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'googleplus' );">Log&nbsp;Out</a>&nbsp;/&nbsp;
				<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)
			</span>
			<span class="pa-icon"><svg xmlns="http://www.w3.org/2000/svg" role="presentation" x="0px" y="0px" viewBox="0 0 60 60"><path fill="#519bf7" d="M56.3,30c0,-1.6 -0.2,-3.4 -0.6,-5h-3.1H42.2H30v10.6h14.8C44,39.3 42,42 39.1,43.9l8.8,6.8C53,46 56.3,39 56.3,30z"></path><path fill="#3db366" d="M30,57.5c6.7,0 13.1,-2.4 17.9,-6.8l-8.8,-6.8c-2.5,1.6 -5.6,2.4 -9.1,2.4c-7.2,0 -13.3,-4.7 -15.4,-11.2l-9.3,7.1C9.8,51.3 19.1,57.5 30,57.5z"></path><path fill="#fdc600" d="M5.3,42.2l9.3,-7.1c-0.5,-1.6 -0.8,-3.3 -0.8,-5.1s0.3,-3.5 0.8,-5.1l-9.3,-7.1C3.5,21.5 2.5,25.6 2.5,30S3.5,38.5 5.3,42.2z"></path><path fill="#f15b44" d="M40.1,17.4l8,-8C43.3,5.1 37,2.5 30,2.5C19.1,2.5 9.8,8.7 5.3,17.8l9.3,7.1c2.1,-6.5 8.2,-11.1 15.4,-11.1C33.9,13.7 37.4,15.1 40.1,17.4z"></path></svg></span>
		</p>
					</div>
	
		</div>
	</div>

	<div id="comment-form-twitter" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/ad516503a11cd5ca435acc9bb6523536.png" alt="Twitter picture" class="no-grav grav-hashed grav-hijack" id="grav-ad516503a11cd5ca435acc9bb6523536-3" width="25">
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="twitter_avatar" id="twitter-avatar" class="comment-meta-twitter" value="">
				<input type="hidden" name="twitter_user_id" id="twitter-user_id" class="comment-meta-twitter" value="">
				<input type="hidden" name="twitter_access_token" id="twitter-access_token" class="comment-meta-twitter" value="">
						<p class="comment-form-posting-as pa-twitter">
			<strong></strong>
			You are commenting using your Twitter account.			<span class="comment-form-log-out">
				(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'twitter' );">Log&nbsp;Out</a>&nbsp;/&nbsp;
				<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)
			</span>
			<span class="pa-icon"><svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24"><rect x="0" fill="none" width="24" height="24"></rect><g><path fill="#1DA1F2" d="M22.23 5.924c-.736.326-1.527.547-2.357.646.847-.508 1.498-1.312 1.804-2.27-.793.47-1.67.812-2.606.996C18.325 4.498 17.258 4 16.078 4c-2.266 0-4.103 1.837-4.103 4.103 0 .322.036.635.106.935-3.41-.17-6.433-1.804-8.457-4.287-.353.607-.556 1.312-.556 2.064 0 1.424.724 2.68 1.825 3.415-.673-.022-1.305-.207-1.86-.514v.052c0 1.988 1.415 3.647 3.293 4.023-.344.095-.707.145-1.08.145-.265 0-.522-.026-.773-.074.522 1.63 2.038 2.817 3.833 2.85-1.404 1.1-3.174 1.757-5.096 1.757-.332 0-.66-.02-.98-.057 1.816 1.164 3.973 1.843 6.29 1.843 7.547 0 11.675-6.252 11.675-11.675 0-.178-.004-.355-.012-.53.802-.578 1.497-1.3 2.047-2.124z"></path></g></svg></span>
		</p>
					</div>
	
		</div>
	</div>

	<div id="comment-form-facebook" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="" alt="Facebook photo" class="no-grav" width="25">
			</div>

				<div class="comment-form-fields">
				<input type="hidden" name="fb_avatar" id="facebook-avatar" class="comment-meta-facebook" value="">
				<input type="hidden" name="fb_user_id" id="facebook-user_id" class="comment-meta-facebook" value="">
				<input type="hidden" name="fb_access_token" id="facebook-access_token" class="comment-meta-facebook" value="">
						<p class="comment-form-posting-as pa-facebook">
			<strong></strong>
			You are commenting using your Facebook account.			<span class="comment-form-log-out">
				(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'facebook' );">Log&nbsp;Out</a>&nbsp;/&nbsp;
				<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)
			</span>
			<span class="pa-icon"><svg xmlns="http://www.w3.org/2000/svg" role="presentation" viewBox="0 0 24 24"><rect x="0" fill="none" width="24" height="24"></rect><g><path fill="#3B5998" d="M20.007 3H3.993C3.445 3 3 3.445 3 3.993v16.013c0 .55.445.994.993.994h8.62v-6.97H10.27V11.31h2.346V9.31c0-2.325 1.42-3.59 3.494-3.59.993 0 1.847.073 2.096.106v2.43h-1.438c-1.128 0-1.346.537-1.346 1.324v1.734h2.69l-.35 2.717h-2.34V21h4.587c.548 0 .993-.445.993-.993V3.993c0-.548-.445-.993-.993-.993z"></path></g></svg></span>
		</p>
					</div>
	
		</div>
	</div>


	<div id="comment-form-load-service" class="comment-form-service">
		<div class="comment-form-posting-as-cancel"><a href="javascript:HighlanderComments.cancelExternalWindow();">Cancel</a></div>
		<p>Connecting to %s</p>
	</div>

</div>

<script type="text/javascript">
var highlander_expando_javascript = function () {

	function hide( sel ) {
		var el = document.querySelector( sel );
		if ( el ) {
			el.style.setProperty( 'display', 'none' );
		}
	}

	function show( sel ) {
		var el = document.querySelector( sel );
		if ( el ) {
			el.style.removeProperty( 'display' );
		}
	}

	var input = document.createElement( 'input' );
	var comment = document.querySelector( '#comment' );

	if ( input && comment && 'placeholder' in input ) {
		var label = document.querySelector( '.comment-textarea label' );
		if ( label ) {
			var text = label.textContent;
			label.parentNode.removeChild( label );
			comment.setAttribute( 'placeholder', text );
		}
	}

	// Expando Mode: start small, then auto-resize on first click + text length
	hide( '#comment-form-identity' );
	hide( '#comment-form-subscribe' );
	hide( '#commentform .form-submit' );

	if ( comment ) {
		comment.style.height = '10px';

		var handler = function () {
			comment.style.height = HighlanderComments.initialHeight + 'px';
			show( '#comment-form-identity' );
			show( '#comment-form-subscribe' );
			show( '#commentform .form-submit' );
			HighlanderComments.resizeCallback();

			comment.removeEventListener( 'focus', handler );
		};

		comment.addEventListener( 'focus', handler );
	}
}

if ( document.readyState !== 'loading' ) {
	highlander_expando_javascript();
} else {
	if ( typeof window.jQuery === 'function' ) {
		// Use jQuery's `ready` if available.
		// This solves some scheduling issues between this script and the main highlander script.
		jQuery( document ).ready( highlander_expando_javascript );
	} else {
		// If not available, add a vanilla event listener.
		document.addEventListener( 'DOMContentLoaded', highlander_expando_javascript );
	}
}

</script>

<div id="comment-form-subscribe" style="display: none;">
	<p class="comment-subscription-form"><input type="checkbox" name="subscribe" id="subscribe" value="subscribe" style="width: auto;"> <label class="subscribe-label" id="subscribe-label" for="subscribe" style="display: inline;">Notify me of new comments via email.</label></p><p class="post-subscription-form"><input type="checkbox" name="subscribe_blog" id="subscribe_blog" value="subscribe" style="width: auto;"> <label class="subscribe-label" id="subscribe-blog-label" for="subscribe_blog" style="display: inline;">Notify me of new posts via email.</label></p></div>




<p class="form-submit wp-block-button" style="display: none;"><input name="submit" type="submit" id="comment-submit" class="submit wp-block-button__link" value="Post Comment"> <input type="hidden" name="comment_post_ID" value="1419" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="855cb3451b"></p>
<input type="hidden" name="genseq" value="1635466656">
<p style="display: none !important;"><label>Δ<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_1" name="ak_js" value="1635483327938"><script>document.getElementById( "ak_js_1" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>	</div><!-- #respond -->
	<div style="clear: both"></div>
</div><!-- #comments -->
	</div>

<div id="sidebar">
			<div id="atatags-262211713-617b3da028741"></div>
			
			<script>
				__ATA.cmd.push(function() {
					__ATA.initDynamicSlot({
						id: 'atatags-262211713-617b3da028741',
						location: 140,
						formFactor: '003',
						label: {
							text: 'Advertisements',
						},
						creative: {
							reportAd: {
								text: 'Report this ad',
							},
							privacySettings: {
								text: 'Privacy',
								
							}
						}
					});
				});
			</script>
	<div id="search-2" class="widget widget_search"><form role="search" method="get" id="searchform" class="searchform" action="https://fabiobaltieri.com/">
				<div>
					<label class="screen-reader-text" for="s">Search for:</label>
					<input type="text" name="s" id="s">
					<input type="submit" id="searchsubmit" value="Search">
				</div>
			</form></div><div id="categories-3" class="widget widget_categories"><h4>Categories</h4>
			<ul>
					<li class="cat-item cat-item-38819914"><a href="https://fabiobaltieri.com/category/avr-2/">AVR</a> (11)
</li>
	<li class="cat-item cat-item-79"><a href="https://fabiobaltieri.com/category/hardware/">Hardware</a> (23)
</li>
	<li class="cat-item cat-item-34922710"><a href="https://fabiobaltieri.com/category/linux-2/">Linux</a> (14)
</li>
	<li class="cat-item cat-item-7426"><a href="https://fabiobaltieri.com/category/networking/">Networking</a> (15)
</li>
			</ul>

			</div>
		<div id="recent-posts-3" class="widget widget_recent_entries">
		<h4>Recent Posts</h4>
		<ul>
											<li>
					<a href="https://fabiobaltieri.com/2019/09/21/design-analysis-of-a-petzl-actik-core-headlamp/">Design Analysis of a Petzl ACTIK CORE&nbsp;Headlamp</a>
									</li>
											<li>
					<a href="https://fabiobaltieri.com/2014/06/22/lna/">LNA for RTL Based SDR&nbsp;Receivers</a>
									</li>
											<li>
					<a href="https://fabiobaltieri.com/2014/06/15/sensor-breakout/">Breakout Board for Wireless Devices Using the Nordic&nbsp;nRF24L01+</a>
									</li>
											<li>
					<a href="https://fabiobaltieri.com/2013/12/29/power-over-ethernet-flashlight/">Power over Ethernet&nbsp;Flashlight</a>
									</li>
											<li>
					<a href="https://fabiobaltieri.com/2013/11/18/halogen-led/">LED Light Replacement for AC Halogen&nbsp;Lamps</a>
									</li>
											<li>
					<a href="https://fabiobaltieri.com/2013/07/23/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan/" aria-current="page">Hacking into a Vehicle CAN bus (Toyothack and&nbsp;SocketCAN)</a>
									</li>
											<li>
					<a href="https://fabiobaltieri.com/2013/07/10/inside-a-hantek-dso-2090-usb-oscilloscope/">Inside a Hantek DSO-2090 USB&nbsp;Oscilloscope</a>
									</li>
											<li>
					<a href="https://fabiobaltieri.com/2013/05/26/usb-to-100base-fx-optical-fiber-network-card/">USB to 100BASE-FX Optical Fiber Network&nbsp;Card</a>
									</li>
											<li>
					<a href="https://fabiobaltieri.com/2013/03/22/power-manager/">Power Manager: Soft Power Control of USB and Low Voltage&nbsp;Devices</a>
									</li>
											<li>
					<a href="https://fabiobaltieri.com/2013/02/14/hp-wi-fi-direct-mouse-on-linux/">HP Wi-Fi Direct Mouse on&nbsp;Linux</a>
									</li>
					</ul>

		</div><div id="linkcat-1356" class="widget widget_links"><h4>Blogroll</h4>
	<ul class="xoxo blogroll">
<li><a href="http://www.davideccher.com/" title="David Eccher, Photos and iPhone Apps." target="_blank">David Eccher</a></li>
<li><a href="http://www.youtube.com/user/thebrabus">ElectroYou Vlog (Italian)</a></li>
<li><a href="http://www.mariaplaias.com/" title="Maria Plaias Photography">Maria Plaias Photography</a></li>
<li><a href="http://www.sandrobernardinellophotography.it/" title="Sandro Bernardinello Photography – Photoblog">Sandro Bernardinello Photography</a></li>
<li><a href="https://www.facebook.com/theladyingreen">The Lady in Green</a></li>

	</ul>
</div>
<div id="linkcat-62844121" class="widget widget_links"><h4>Me, but somewhere else</h4>
	<ul class="xoxo blogroll">
<li><a href="http://github.com/fabiobaltieri" title="Fabio Baltieri – GitHub">GitHub</a></li>
<li><a href="http://it.linkedin.com/in/fabiobaltieri">LinkedIn</a></li>

	</ul>
</div>
<div id="text-2" class="widget widget_text"><h4>License</h4>			<div class="textwidget"><a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/"><img alt="Creative Commons License" style="border-width:0;" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/88x31.webp"></a>

<br>
<br>

<small>Unless otherwise stated, this work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike 3.0 License</a>.</small></div>
		</div>			<div id="atatags-262211713-617b3da02a01d"></div>
			
			<script>
				__ATA.cmd.push(function() {
					__ATA.initDynamicSlot({
						id: 'atatags-262211713-617b3da02a01d',
						location: 140,
						formFactor: '003',
						label: {
							text: 'Advertisements',
						},
						creative: {
							reportAd: {
								text: 'Report this ad',
							},
							privacySettings: {
								text: 'Privacy',
								
							}
						}
					});
				});
			</script>
</div>
</div>


<div id="footer">
	<div class="footerleft">
		<p><a href="https://wordpress.com/?ref=footer_website" rel="nofollow">Create a free website or blog at WordPress.com.</a></p>
    </div>
    <div class="footerright">
	        </div>
</div>

</div>

<!--  -->
<script src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/gprofiles.js" id="grofiles-cards-js"></script>
<script id="wpgroho-js-extra">
var WPGroHo = {"my_hash":""};
</script>
<script crossorigin="anonymous" type="text/javascript" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/wpgroho.js"></script>

	<script>
		// Initialize and attach hovercards to all gravatars
		( function() {
			function init() {
				if ( typeof Gravatar === 'undefined' ) {
					return;
				}

				if ( typeof Gravatar.init !== 'function' ) {
					return;
				}

				Gravatar.profile_cb = function ( hash, id ) {
					WPGroHo.syncProfileData( hash, id );
				};

				Gravatar.my_hash = WPGroHo.my_hash;
				Gravatar.init( 'body', '#wp-admin-bar-my-account' );
			}

			if ( document.readyState !== 'loading' ) {
				init();
			} else {
				document.addEventListener( 'DOMContentLoaded', init );
			}
		} )();
	</script>

		<div style="display:none">
	<div class="grofile-hash-map-987f5d113a7febaefc63f44c2dec28c3">
	</div>
	<div class="grofile-hash-map-fdf2e3488a4dced3545eaa3d2bb5bf79">
	</div>
	<div class="grofile-hash-map-9316867f55badf12db1d3da5ee59e93d">
	</div>
	<div class="grofile-hash-map-dc63801b2623d9536ebd914d2c8c0303">
	</div>
	<div class="grofile-hash-map-dc63801b2623d9536ebd914d2c8c0303">
	</div>
	<div class="grofile-hash-map-b85633fd663b6632cd367194b913b039">
	</div>
	<div class="grofile-hash-map-8c71610a4ea707eac74c88900a5192d6">
	</div>
	<div class="grofile-hash-map-9a8607456a3fdc3935d9a9ac28d1109f">
	</div>
	<div class="grofile-hash-map-279ca63896e5b8b7cdea19fea55424c5">
	</div>
	<div class="grofile-hash-map-2b094ee9d5a4e7c3f600ceac72caafb0">
	</div>
	<div class="grofile-hash-map-53b5891397ddda04ffd8ee491bd3bc33">
	</div>
	<div class="grofile-hash-map-fcc6cfe36a974ba59beaff244ada564d">
	</div>
	<div class="grofile-hash-map-ef816d9ad1d42ffe83554a54d3de888b">
	</div>
	<div class="grofile-hash-map-1ba6286e0632c0a8c6c0dccb373ca6e0">
	</div>
	<div class="grofile-hash-map-fe6cc3ecc9797820432120337aa416ae">
	</div>
	<div class="grofile-hash-map-4a84c9084bcff51d334878a2ca363362">
	</div>
	<div class="grofile-hash-map-a1aa9b8ec2852869b5d15419902c3048">
	</div>
	<div class="grofile-hash-map-0a1bde5fa75da899b1ebe56139c58c21">
	</div>
	<div class="grofile-hash-map-d085147dcf7abd5263798ae3f0b938f5">
	</div>
	<div class="grofile-hash-map-b70da50706a8c3cffba65bc53324058f">
	</div>
	<div class="grofile-hash-map-53b5891397ddda04ffd8ee491bd3bc33">
	</div>
	<div class="grofile-hash-map-d91a0d9e9b07b48b694a4c19711cba88">
	</div>
	<div class="grofile-hash-map-413431c238662735db83694b4fca0d7d">
	</div>
	<div class="grofile-hash-map-50f473e275ccb39a36b223b654f9ca4f">
	</div>
	<div class="grofile-hash-map-0a01ec5250adee8238506af65d5ce3c7">
	</div>
	<div class="grofile-hash-map-8892d47c8160275265776c6830b23193">
	</div>
	<div class="grofile-hash-map-8892d47c8160275265776c6830b23193">
	</div>
	<div class="grofile-hash-map-3d8f672a2abaf8e0fa0be51217db2642">
	</div>
	<div class="grofile-hash-map-58e5b642022a7428edc71ee3f18d0524">
	</div>
	<div class="grofile-hash-map-02aee08881b9b76fad56400ab2ad78ff">
	</div>
	<div class="grofile-hash-map-01d78393eac95f400738a59e087b6b4b">
	</div>
	<div class="grofile-hash-map-49314ada5ce97e95929c7d04fcf04ae3">
	</div>
	<div class="grofile-hash-map-851a570e1c6ea73b599b6a1a87b675f7">
	</div>
	<div class="grofile-hash-map-851a570e1c6ea73b599b6a1a87b675f7">
	</div>
	<div class="grofile-hash-map-ad16af586130dc83f74e9c973e6bfc92">
	</div>
	<div class="grofile-hash-map-cde9d51eb04a453905b091975848016d">
	</div>
	<div class="grofile-hash-map-da19e019aa6d6fb72ee05078babbcf72">
	</div>
	<div class="grofile-hash-map-c434e8c158924e6d6763eb091221af91">
	</div>
	<div class="grofile-hash-map-f248cf3c1869a023587fada421787b0f">
	</div>
	<div class="grofile-hash-map-95528cbbc1a28cc5673e1ed978f99761">
	</div>
	<div class="grofile-hash-map-ad726c8f95e3c44087f0430d1ef9427b">
	</div>
	<div class="grofile-hash-map-32d9072fc222c85a7f0b3d9eef210964">
	</div>
	</div>
<script id="highlander-comments-js-extra">
var HighlanderComments = {"loggingInText":"Logging In\u2026","submittingText":"Posting Comment\u2026","postCommentText":"Post Comment","connectingToText":"Connecting to %s","commentingAsText":"%1$s: You are commenting using your %2$s account.","logoutText":"Log Out","loginText":"Log In","connectURL":"https:\/\/fabiobaltieri.wordpress.com\/public.api\/connect\/?action=request&domain=fabiobaltieri.com","logoutURL":"https:\/\/fabiobaltieri.wordpress.com\/wp-login.php?action=logout&_wpnonce=f667bb24aa","homeURL":"https:\/\/fabiobaltieri.com\/","postID":"1419","gravDefault":"identicon","enterACommentError":"Please enter a comment","enterEmailError":"Please enter your email address here","invalidEmailError":"Invalid email address","enterAuthorError":"Please enter your name here","gravatarFromEmail":"This picture will show whenever you leave a comment. Click to customize it.","logInToExternalAccount":"Log in to use details from one of these accounts.","change":"Change","changeAccount":"Change Account","comment_registration":"","userIsLoggedIn":"","isJetpack":"","text_direction":"ltr"};
</script>
<script crossorigin="anonymous" type="text/javascript" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/a_003.js"></script>
			<script type="text/javascript">
			( function( $ ) {
				$( document.body ).on( 'post-load', function () {
					if ( typeof __ATA.insertInlineAds === 'function' ) {
						__ATA.insertInlineAds();
					}
				} );
			} )( jQuery );
			</script><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-dark-grayscale"><feColorMatrix type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 0 0 0 1 0 "></feColorMatrix><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0 0.49803921568627"></feFuncR><feFuncG type="table" tableValues="0 0.49803921568627"></feFuncG><feFuncB type="table" tableValues="0 0.49803921568627"></feFuncB></feComponentTransfer></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-grayscale"><feColorMatrix type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 0 0 0 1 0 "></feColorMatrix><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0 1"></feFuncR><feFuncG type="table" tableValues="0 1"></feFuncG><feFuncB type="table" tableValues="0 1"></feFuncB></feComponentTransfer></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-purple-yellow"><feColorMatrix type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 0 0 0 1 0 "></feColorMatrix><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0.54901960784314 0.98823529411765"></feFuncR><feFuncG type="table" tableValues="0 1"></feFuncG><feFuncB type="table" tableValues="0.71764705882353 0.25490196078431"></feFuncB></feComponentTransfer></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-blue-red"><feColorMatrix type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 0 0 0 1 0 "></feColorMatrix><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0 1"></feFuncR><feFuncG type="table" tableValues="0 0.27843137254902"></feFuncG><feFuncB type="table" tableValues="0.5921568627451 0.27843137254902"></feFuncB></feComponentTransfer></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-midnight"><feColorMatrix type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 0 0 0 1 0 "></feColorMatrix><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0 0"></feFuncR><feFuncG type="table" tableValues="0 0.64705882352941"></feFuncG><feFuncB type="table" tableValues="0 1"></feFuncB></feComponentTransfer></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-magenta-yellow"><feColorMatrix type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 0 0 0 1 0 "></feColorMatrix><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0.78039215686275 1"></feFuncR><feFuncG type="table" tableValues="0 0.94901960784314"></feFuncG><feFuncB type="table" tableValues="0.35294117647059 0.47058823529412"></feFuncB></feComponentTransfer></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-purple-green"><feColorMatrix type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 0 0 0 1 0 "></feColorMatrix><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0.65098039215686 0.40392156862745"></feFuncR><feFuncG type="table" tableValues="0 1"></feFuncG><feFuncB type="table" tableValues="0.44705882352941 0.4"></feFuncB></feComponentTransfer></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-blue-orange"><feColorMatrix type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 0 0 0 1 0 "></feColorMatrix><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0.098039215686275 1"></feFuncR><feFuncG type="table" tableValues="0 0.66274509803922"></feFuncG><feFuncB type="table" tableValues="0.84705882352941 0.41960784313725"></feFuncB></feComponentTransfer></filter></defs></svg>
<script>
window.addEventListener( "load", function( event ) {
	var link = document.createElement( "link" );
	link.href = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.css?v=20210915";
	link.type = "text/css";
	link.rel = "stylesheet";
	document.head.appendChild( link );

	var script = document.createElement( "script" );
	script.src = "https://s0.wp.com/wp-content/mu-plugins/actionbar/actionbar.js?v=20211021";
	script.defer = true;
	document.body.appendChild( script );
} );
</script>

	
	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/fabiobaltieri.com\/2013\/07\/23\/hacking-into-a-vehicle-can-bus-toyothack-and-socketcan\/":1419};
	</script>
				<script crossorigin="anonymous" type="text/javascript" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/a_004.js"></script>
<script type="text/javascript">
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "https://s0.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.head.appendChild( corecss );
		var themecssurl = "https://s0.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?m=1363304414h&amp;ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		document.head.appendChild( themecss );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();

	// Infinite scroll support
	if ( typeof( jQuery ) !== 'undefined' ) {
		jQuery( function( $ ) {
			$( document.body ).on( 'post-load', function() {
				SyntaxHighlighter.highlight();
			} );
		} );
	}
</script>
<script id="sharing-js-js-extra">
var sharing_js_options = {"lang":"en","counts":"1","is_stats_active":"1"};
</script>
<script async="true" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/a"></script><script crossorigin="anonymous" type="text/javascript" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/a.js"></script>
<script type="text/javascript">
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-twitter' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-twitter' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
						return false;
					}
				} );
			} )();
var windowOpen;
			( function () {
				function matches( el, sel ) {
					return !! (
						el.matches && el.matches( sel ) ||
						el.msMatchesSelector && el.msMatchesSelector( sel )
					);
				}

				document.body.addEventListener( 'click', function ( event ) {
					if ( ! event.target ) {
						return;
					}

					var el;
					if ( matches( event.target, 'a.share-facebook' ) ) {
						el = event.target;
					} else if ( event.target.parentNode && matches( event.target.parentNode, 'a.share-facebook' ) ) {
						el = event.target.parentNode;
					}

					if ( el ) {
						event.preventDefault();

						// If there's another sharing window open, close it.
						if ( typeof windowOpen !== 'undefined' ) {
							windowOpen.close();
						}
						windowOpen = window.open( el.getAttribute( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
						return false;
					}
				} );
			} )();
</script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script>	<iframe src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/master.html" scrolling="no" id="likes-master" name="likes-master" style="display:none;"></iframe>
	<div id="likes-other-gravatars">
		<div class="likes-text">
			<span>%d</span> bloggers like this:		</div>
		<ul class="wpl-avatars sd-like-gravatars"></ul>
	</div>
	
		<script src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/w.js" defer="defer"></script> <script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'26221171','blog_tz':'1','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'26221171','v':'wpcom','tz':'1','user_id':'0','post':'1419','subd':'fabiobaltieri'}]);
_stq.push(['extra', {'crypt':'UE5tW3cvZGQtW1JXcy0rJW1Kd3duRXpHcVIyMT9QMy4/dDRDNjNPQVFoc1d4V28uZ0ZEZGt2Ri9QVW5OaV9PLlZWMmpIVEUleDZ3RXdRN3F3b1Q9bWQlSS5DLm1xLUo9WUJ6VTI2Jmxsal18cFRISHFLRlo5MGVET1RtSUZaOTF6UW0yYlJIWUZLa0NnTUMtWDh2L20rZi1+X2dQdjUuMzI9WThMblpScFQ9R0E2WGNSUFExJXMzeUoxMTFMNndkNk58UDZtYy9aMiZyOXFWeWpbVHQsJT9Y'}]);
_stq.push([ 'clickTrackerInit', '26221171', '1419' ]);
	</script>
<noscript><img src="https://pixel.wp.com/b.gif?v=noscript" style="height:1px;width:1px;overflow:hidden;position:absolute;bottom:1px;" alt="" /></noscript>
<script>
if ( 'object' === typeof wpcom_mobile_user_agent_info ) {

	wpcom_mobile_user_agent_info.init();
	var mobileStatsQueryString = "";
	
	if( false !== wpcom_mobile_user_agent_info.matchedPlatformName )
		mobileStatsQueryString += "&x_" + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
	
	if( false !== wpcom_mobile_user_agent_info.matchedUserAgentName )
		mobileStatsQueryString += "&x_" + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
	
	if( wpcom_mobile_user_agent_info.isIPad() )
		mobileStatsQueryString += "&x_" + 'ipad_views' + '=' + 'views';

	if( "" != mobileStatsQueryString ) {
		new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
	}
	
}
</script>

<iframe src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/a.html" style="display: none;"></iframe><iframe style="display: none;" scrolling="no" id="wpcom_remote_login_key" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/remote-login.html"></iframe><script src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/actionbar.js" defer="defer"></script><div id="actionbar" class="actnbr-pub-enterprise actnbr-has-follow actnbr-hidden"><ul><li class="actnbr-btn actnbr-hidden"> 				<a class="actnbr-action actnbr-actn-follow" href=""><svg class="gridicon gridicon__follow" height="24px" width="24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M23 16v2h-3v3h-2v-3h-3v-2h3v-3h2v3h3zM20 2v9h-4v3h-3v4H4c-1.1 0-2-.9-2-2V2h18zM8 13v-1H4v1h4zm3-3H4v1h7v-1zm0-2H4v1h7V8zm7-4H4v2h14V4z"></path></g></svg><span>Follow</span></a><a class="actnbr-action actnbr-actn-following no-display" href=""><svg class="gridicon gridicon__following" height="24px" width="24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M23 13.482L15.508 21 12 17.4l1.412-1.388 2.106 2.188 6.094-6.094L23 13.482zm-7.455 1.862L20 10.89V2H2v14c0 1.1.9 2 2 2h4.538l4.913-4.832 2.095 2.176zM8 13H4v-1h4v1zm3-2H4v-1h7v1zm0-2H4V8h7v1zm7-3H4V4h14v2z"></path></g></svg><span>Following</span></a> 				<div class="actnbr-popover tip tip-top-left actnbr-notice" id="follow-bubble"> 					<div class="tip-arrow"></div> 					<div class="tip-inner actnbr-follow-bubble"> 				<ul> 					<li class="actnbr-sitename actnbr-hidden"><a href="https://fabiobaltieri.com/"><img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/wpcom-gray-white.png" class="avatar avatar-50" width="50" height="50"> fabiobaltieri</a></li> 					<form> 					<li class="actnbr-login-nudge actnbr-hidden"><div>Already have a WordPress.com account? <a href="https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Ffabiobaltieri.com%252F2013%252F07%252F23%252Fhacking-into-a-vehicle-can-bus-toyothack-and-socketcan%252F">Log in now.</a></div></li> 				</form></ul> 			</div> 				</div> 					</li><li class="actnbr-ellipsis actnbr-hidden"> 				<svg class="gridicon gridicon__ellipsis" height="24" width="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><circle cx="5" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="12" cy="12" r="2"></circle></g></svg> 				<div class="actnbr-popover tip tip-top-left actnbr-more"> 				<div class="tip-arrow"></div> 				<div class="tip-inner"> 					<ul> 						<li class="actnbr-sitename actnbr-hidden"><a href="https://fabiobaltieri.com/"><img alt="" src="Hacking%20into%20a%20Vehicle%20CAN%20bus%20(Toyothack%20and%20SocketCAN)%20|%20fabiobaltieri_files/wpcom-gray-white.png" class="avatar avatar-50" width="50" height="50"> fabiobaltieri</a></li> 					<li class="actnbr-folded-customize actnbr-hidden"><a href="https://fabiobaltieri.wordpress.com/wp-admin/customize.php?url=https%3A%2F%2Ffabiobaltieri.wordpress.com%2F2013%2F07%2F23%2Fhacking-into-a-vehicle-can-bus-toyothack-and-socketcan%2F"><svg class="gridicon gridicon__customize" height="20px" width="20px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M2 6c0-1.505.78-3.08 2-4 0 .845.69 2 2 2 1.657 0 3 1.343 3 3 0 .386-.08.752-.212 1.09.74.594 1.476 1.19 2.19 1.81L8.9 11.98c-.62-.716-1.214-1.454-1.807-2.192C6.753 9.92 6.387 10 6 10c-2.21 0-4-1.79-4-4zm12.152 6.848l1.34-1.34c.607.304 1.283.492 2.008.492 2.485 0 4.5-2.015 4.5-4.5 0-.725-.188-1.4-.493-2.007L18 9l-2-2 3.507-3.507C18.9 3.188 18.225 3 17.5 3 15.015 3 13 5.015 13 7.5c0 .725.188 1.4.493 2.007L3 20l2 2 6.848-6.848c1.885 1.928 3.874 3.753 5.977 5.45l1.425 1.148 1.5-1.5-1.15-1.425c-1.695-2.103-3.52-4.092-5.448-5.977z" data-reactid=".2.1.1:0.1b.0"></path></g></svg><span>Customize<span></span></span></a></li> 						<li class="actnbr-folded-follow actnbr-hidden"><a class="actnbr-action actnbr-actn-follow" href=""><svg class="gridicon gridicon__follow" height="24px" width="24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M23 16v2h-3v3h-2v-3h-3v-2h3v-3h2v3h3zM20 2v9h-4v3h-3v4H4c-1.1 0-2-.9-2-2V2h18zM8 13v-1H4v1h4zm3-3H4v1h7v-1zm0-2H4v1h7V8zm7-4H4v2h14V4z"></path></g></svg><span>Follow</span></a><a class="actnbr-action actnbr-actn-following no-display" href=""><svg class="gridicon gridicon__following" height="24px" width="24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><g><path d="M23 13.482L15.508 21 12 17.4l1.412-1.388 2.106 2.188 6.094-6.094L23 13.482zm-7.455 1.862L20 10.89V2H2v14c0 1.1.9 2 2 2h4.538l4.913-4.832 2.095 2.176zM8 13H4v-1h4v1zm3-2H4v-1h7v1zm0-2H4V8h7v1zm7-3H4V4h14v2z"></path></g></svg><span>Following</span></a></li> 					<li class="actnbr-signup actnbr-hidden"><a href="https://wordpress.com/start/">Sign up</a></li> 						<li class="actnbr-login actnbr-hidden"><a href="https://wordpress.com/log-in?redirect_to=https%3A%2F%2Fr-login.wordpress.com%2Fremote-login.php%3Faction%3Dlink%26back%3Dhttps%253A%252F%252Ffabiobaltieri.com%252F2013%252F07%252F23%252Fhacking-into-a-vehicle-can-bus-toyothack-and-socketcan%252F">Log in</a></li> 						 						<li class="actnbr-shortlink actnbr-hidden"><a href="https://wp.me/p1M1k7-mT">Copy shortlink</a></li> 						<li class="flb-report actnbr-hidden"><a href="http://en.wordpress.com/abuse/">Report this content</a></li> 						 						 						<li class="actnbr-subs actnbr-hidden"><a href="https://subscribe.wordpress.com/">Manage subscriptions</a></li> 						<li class="actnbr-fold actnbr-hidden"><a href="">Collapse this bar</a></li> 						</ul> 					</div> 					</div> 				</li> 				</ul></div></body></html>