goog.provide("jive.event.attendance.allAttendees");goog.provide("jive.event.attendance.attendee");goog.provide("jive.event.attendance.attendees");goog.provide("jive.event.attendance.attendeesList");goog.provide("jive.event.attendance.attendeesSmall");goog.provide("jive.event.attendance.display");goog.provide("jive.event.attendance.displaySmall");goog.provide("jive.event.attendance.displayUserRow");goog.provide("jive.event.attendance.renderUserRows");goog.provide("jive.event.attendance.renderUserTable");
goog.provide("jive.event.attendance.rsvpButton");goog.provide("jive.event.attendance.userLink");goog.require("soy");goog.require("soydata");goog.require("soy.StringBuilder");goog.require("jive.shared.displayutil.avatar");goog.require("jive.shared.displayutil.userDisplayNameLink");
jive.event.attendance.display=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div id="event-rsvp">');jive.event.attendance.rsvpButton(opt_data.event.attendance,output);jive.event.attendance.attendees(soy.$$augmentMap(opt_data.event.attendance,{maxAttendees:opt_data.event.maxAttendees,currentUserID:opt_data.currentUserID}),output);output.append("</div>");return opt_sb?"":output.toString()};
jive.event.attendance.displaySmall=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.event.attendance.rsvpButton(opt_data.event.attendance,output);jive.event.attendance.attendeesSmall(soy.$$augmentMap(opt_data.event.attendance,{maxAttendees:opt_data.event.maxAttendees}),output);return opt_sb?"":output.toString()};
jive.event.attendance.rsvpButton=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="jive-event-rsvp">',!opt_data.ended?opt_data.canAttend||opt_data.response==opt_data.yesStatus?opt_data.response==0?'<a class="j-btn-global'+(!opt_data.canAttend||opt_data.ended?" j-btn-global-disabled":"")+'" id="event-rsvp-link" href="#">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("event.invite.response.text"),[]))+"</a>":'<span class="jive-event-rsvp-status">'+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("event.invite.response."+opt_data.response+".text")),[]))+' <a id="event-rsvp-link" class="event-rsvp-change-link" href="#">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("event.invite.change.link"),[]))+"</a></span>":'<div id="jive-event-norsvp" '+(opt_data.rsvpRejected?'class="jive-event-rsvp-error"':'class="jive-event-rsvp j-btn-global j-btn-global-disabled"')+">"+(opt_data.anonymous?"<p><a href=\"login.jspa\" onclick=\"e14SetCookie('e14EventReg', 'register', 0, 15); e14SetCookie('e14EventRegURL', window.location.href, 0, 15); $j('#navLogin').trigger('click'); return false;\">"+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("event.attendance.logged_out.text"),[]))+"</a></p>":opt_data.containerAllowsAttendance==false&&opt_data.canJoinGroupToContribute?'<p><a class="jive-link-joinSocialGroup" href="#">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("event.attendance.join.text"),[]))+"</a></p>":opt_data.containerAllowsAttendance==false&&!opt_data.cannotAttendReason?"<p>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("event.attendance.readonly.text"),[]))+
"</p>":(opt_data.cannotAttendReason?"<p>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(opt_data.cannotAttendReason),[]))+"</p>":"")+'<p id="jive-event-norsvp-reason">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("event.attendance.cannotattend.text"),[]))+"</p>")+"</div>":'<div id="jive-event-norsvp"><p>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("event.attendance.ended.text"),[]))+"</p></div>",'</div><div class="jive-event-rsvp-choices j-menu j-quick-menu j-menu-selectable" id="event-rsvp-choices" style="display:none"><ul class="j-icon-list"><li class="jive-event-rsvp',
opt_data.response==opt_data.yesStatus?"-selected j-item-selected":"",'"><a id="event-rsvp-yes" class="jive-event-rsvp-choice" href="#">',opt_data.response==opt_data.yesStatus?'<span class="jive-icon-glyph icon-checkmark3 selected-icon"></span>':"",'<span class="lnk">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("event.attendee.status.yes.label"),[])),'</span></a></li><li class="jive-event-rsvp',opt_data.response==opt_data.noStatus?"-selected j-item-selected":"",'"><a id="event-rsvp-no" class="jive-event-rsvp-choice" href="#">',
opt_data.response==opt_data.noStatus?'<span class="jive-icon-glyph icon-checkmark3 selected-icon"></span>':"",'<span class="lnk">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("event.attendee.status.no.label"),[])),'</span></a></li><li class="jive-event-rsvp',opt_data.response==opt_data.maybeStatus?"-selected j-item-selected":"",'"><a id="event-rsvp-maybe" class="jive-event-rsvp-choice" href="#">',opt_data.response==opt_data.maybeStatus?'<span class="jive-icon-glyph icon-checkmark3 selected-icon"></span>':
"",'<span class="lnk">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("event.attendee.status.maybe.label"),[])),"</span></a></li></ul></div>");return opt_sb?"":output.toString()};
jive.event.attendance.attendeesSmall=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="jive-event-attendees-summary"><ul class="jive-event-values"><li><h4>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("event.attendees.attending.title.colon"),[])),"</h4><span>",soy.$$escapeHtml(opt_data.yesAttendees.count),opt_data.capped?" "+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.of"),[]))+" "+soy.$$escapeHtml(opt_data.maxAttendees):"","</span></li></ul></div>");
return opt_sb?"":output.toString()};
jive.event.attendance.attendees=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div id="jive-event-attendees-container" class="jive-event-attendees">');jive.event.attendance.attendeesList(soy.$$augmentMap(opt_data.yesAttendees,{type:"attending",currentUserID:opt_data.currentUserID,displayCap:opt_data.capped,maxAttendees:opt_data.maxAttendees,status:opt_data.yesStatus}),output);jive.event.attendance.attendeesList(soy.$$augmentMap(opt_data.noAttendees,{type:"notattending",
currentUserID:opt_data.currentUserID,displayCap:false,status:opt_data.noStatus}),output);jive.event.attendance.attendeesList(soy.$$augmentMap(opt_data.maybeAttendees,{type:"tentative",currentUserID:opt_data.currentUserID,displayCap:false,status:opt_data.maybeStatus}),output);if(opt_data.canAttend)jive.event.attendance.attendeesList(soy.$$augmentMap(opt_data.unansweredInvitees,{type:"awaiting",currentUserID:opt_data.currentUserID,displayCap:false,status:0}),output);output.append("</div>");return opt_sb?
"":output.toString()};
jive.event.attendance.attendeesList=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="jive-event-attendee-list-container" id="event-attendees-',soy.$$escapeHtml(opt_data.type),'"><h2>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("event.attendees."+opt_data.type+".title")),[]))," ",opt_data.displayCap?"("+soy.$$escapeHtml(opt_data.count)+" "+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.of"),[]))+" "+soy.$$escapeHtml(opt_data.maxAttendees)+
")":opt_data.count>0?"("+soy.$$escapeHtml(opt_data.count)+")":""," ",opt_data.moreAvailable?'<a class="see-all-'+soy.$$escapeHtml(opt_data.type)+'-attendees-link" data_type="'+soy.$$escapeHtml(opt_data.type)+'" data_status="'+soy.$$escapeHtml(opt_data.status)+'" href="#">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("event.attendees.see_all.link"),[]))+"</a>":"",'</h2><ul class="jive-event-attendee-list',opt_data.count==0?"-empty":"",' j-rc4 clearfix">');if(opt_data.count>0){var userList178=
opt_data.users;var userListLen178=userList178.length;for(var userIndex178=0;userIndex178<userListLen178;userIndex178++){var userData178=userList178[userIndex178];jive.event.attendance.attendee({user:userData178,currentUserID:opt_data.currentUserID},output)}}else output.append('<li class="jive-event-attendee-none">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("event.attendees."+opt_data.type+".none.text")),[])),"</li>");output.append("</ul></div>");return opt_sb?"":output.toString()};
jive.event.attendance.attendee=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<li class="jive-event-attendee clearfix"><div>');jive.shared.displayutil.avatar(soy.$$augmentMap(opt_data.user,{size:26,visible:opt_data.user.jive.visible,anonymous:false,hideLink:false,enabled:opt_data.user.jive.enabled,username:opt_data.user.jive.username}),output);jive.event.attendance.userLink(opt_data,output);output.append("</div></li>");return opt_sb?"":output.toString()};
jive.event.attendance.allAttendees=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="jive-modal j-people-list-modal" id="jive-event-attendees-modal" data-you-id="',soy.$$escapeHtml(opt_data.youID),'"><header><h2 class="jive-modal-title">',soy.$$escapeHtml(opt_data.attendees.totalResults)," ",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("event.attendees."+opt_data.status+".title")),[])),'</h2></header><a class="j-modal-close-top jive-close close" href="#">',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close"),[])),' <span class="j-close-icon j-ui-elem"></span></a><section id="modal-attendees-container" class="jive-modal-content clearfix">');jive.event.attendance.renderUserTable(soy.$$augmentMap(opt_data,{currentUserID:opt_data.youID,users:opt_data.attendees}),output);output.append("</section></div>");return opt_sb?"":output.toString()};
jive.event.attendance.renderUserTable=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<table id="modal-attendees" class="attendees-list"><tbody>');jive.event.attendance.renderUserRows(opt_data,output);output.append("</tbody></table>");return opt_sb?"":output.toString()};
jive.event.attendance.renderUserRows=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;var userList218=opt_data.users.list;var userListLen218=userList218.length;for(var userIndex218=0;userIndex218<userListLen218;userIndex218++){var userData218=userList218[userIndex218];jive.event.attendance.displayUserRow({user:userData218,currentUserID:opt_data.currentUserID},output)}return opt_sb?"":output.toString()};
jive.event.attendance.displayUserRow=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<tr><td class="j-td-avatar">');jive.shared.displayutil.avatar(soy.$$augmentMap(opt_data.user,{size:35,visible:opt_data.user.jive.visible,anonymous:false,hideLink:false,enabled:opt_data.user.jive.enabled,username:opt_data.user.jive.username}),output);output.append('</td><td class="j-td-name">');jive.event.attendance.userLink(opt_data,output);output.append("</td></tr>");return opt_sb?
"":output.toString()};
jive.event.attendance.userLink=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.currentUserID==opt_data.user.id)output.append('<a class="jive-username-link" href="',soy.$$escapeHtml(opt_data.user.resources.html.ref),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("event.attendee.you"),[])),"</a>");else jive.shared.displayutil.userDisplayNameLink(soy.$$augmentMap(opt_data.user,{visible:true,username:opt_data.user.jive.username,anonymous:false,displayName:opt_data.user.displayName}),
output);return opt_sb?"":output.toString()};
;
goog.provide("jive.event.calendar.display");goog.provide("jive.event.calendar.large");goog.provide("jive.event.calendar.main");goog.provide("jive.event.calendar.moveConfirmation");goog.provide("jive.event.calendar.place");goog.provide("jive.event.calendar.profile");goog.provide("jive.event.calendar.profileCalendarLink");goog.provide("jive.event.calendar.resizeConfirmation");goog.provide("jive.event.calendar.small");goog.require("soy");goog.require("soydata");goog.require("soy.StringBuilder");goog.require("jive.people.profile.decorator");
goog.require("jive.people.profile.header");goog.require("jive.place.head");goog.require("jive.place.header");goog.require("jive.shared.soy.resourceInlineJs");jive.event.calendar.display=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.size=="LARGE")jive.event.calendar.large(opt_data,output);else jive.event.calendar.small(opt_data,output);return opt_sb?"":output.toString()};
jive.event.calendar.profile=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.event.calendar.large({userID:opt_data.userID,recursive:false,monthDayFormat:opt_data.monthDayFormat,canCreateEvents:opt_data.canCreateEvents,display24hrClock:opt_data.display24hrClock,monthYearFormat:opt_data.monthYearFormat},output);return opt_sb?"":output.toString()};
jive.event.calendar.small=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.shared.soy.resourceInlineJs({code:"$j(document).ready(function() {$j.ajax({url: 'get-monthly-events-list.jspa', data: {container: '"+soy.$$escapeHtml(opt_data.containerID)+"', containerType: '"+soy.$$escapeHtml(opt_data.containerType)+"', recursive: '"+soy.$$escapeHtml(opt_data.recursive)+"'}, success: function(data) {$j('#event-list-"+soy.$$escapeHtml(opt_data.widgetID)+"').html(data);}});});"},output);
output.append('<div id="event-list-',soy.$$escapeHtml(opt_data.widgetID),'"></div>');return opt_sb?"":output.toString()};
jive.event.calendar.large=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<link rel="stylesheet" type="text/css" href="',soy.$$escapeHtml(jive.soy.func.resourceUrl(window._jive_base_url,"/9.0.5.998b920/","//files1.element14.com/community","plugins/event-type-plugin/resources/styles/fullcalendar.css")),'" />');jive.shared.soy.resourceInlineJs({code:"$j(document).ready(function() {var calendar = new jive.EventCalendarApp.Main({"+(opt_data.userID?"userID: "+soy.$$escapeHtml(opt_data.userID)+
",":"containerID: "+soy.$$escapeHtml(opt_data.containerID)+", containerType: "+soy.$$escapeHtml(opt_data.containerType)+",")+"recursive: "+soy.$$escapeHtml(opt_data.recursive)+", monthDayFormat: '"+soy.$$escapeHtml(opt_data.monthDayFormat)+"', canCreateEvents: "+soy.$$escapeHtml(opt_data.canCreateEvents)+", display24hrClock: "+soy.$$escapeHtml(opt_data.display24hrClock)+", monthYearFormat : '"+soy.$$escapeHtml(opt_data.monthYearFormat)+"', i18n: {buttons: {prevText: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.buttons.prev.text"),
[]))+"', nextText: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.buttons.next.text"),[]))+"', today: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.buttons.today.text"),[]))+"', month: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.buttons.month.text"),[]))+"', week: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.buttons.week.text"),[]))+"', day: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.buttons.day.text"),
[]))+"'}, tags: {all_day: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.tags.all_day.text"),[]))+"'}, months: {january: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.months.january.text"),[]))+"', february: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.months.february.text"),[]))+"', march: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.months.march.text"),[]))+"', april: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.months.april.text"),
[]))+"', may: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.months.may.text"),[]))+"', june: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.months.june.text"),[]))+"', july: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.months.july.text"),[]))+"', august: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.months.august.text"),[]))+"', september: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.months.september.text"),
[]))+"', october: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.months.october.text"),[]))+"', november: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.months.november.text"),[]))+"', december: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.months.december.text"),[]))+"'}, monthsShort: {january: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.months.short.january.text"),[]))+"', february: '"+
soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.months.short.february.text"),[]))+"', march: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.months.short.march.text"),[]))+"', april: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.months.short.april.text"),[]))+"', may: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.months.short.may.text"),[]))+"', june: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.months.short.june.text"),
[]))+"', july: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.months.short.july.text"),[]))+"', august: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.months.short.august.text"),[]))+"', september: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.months.short.september.text"),[]))+"', october: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.months.short.october.text"),[]))+"', november: '"+
soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.months.short.november.text"),[]))+"', december: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.months.short.december.text"),[]))+"'}, days: {sunday: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.days.sunday.text"),[]))+"', monday: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.days.monday.text"),[]))+"', tuesday: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.days.tuesday.text"),
[]))+"', wednesday: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.days.wednesday.text"),[]))+"', thursday: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.days.thursday.text"),[]))+"', friday: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.days.friday.text"),[]))+"', saturday: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.days.saturday.text"),[]))+"'}, daysShort: {sunday: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.days.short.sunday.text"),
[]))+"', monday: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.days.short.monday.text"),[]))+"', tuesday: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.days.short.tuesday.text"),[]))+"', wednesday: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.days.short.wednesday.text"),[]))+"', thursday: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.days.short.thursday.text"),[]))+"', friday: '"+
soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.days.short.friday.text"),[]))+"', saturday: '"+soy.$$escapeJsString(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.days.short.saturday.text"),[]))+"'}}});});"},output);output.append('<div id="event-calendar"></div>');return opt_sb?"":output.toString()};
jive.event.calendar.moveConfirmation=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="jive-modal j-modal" id="event-calendar-confirm"><header><h2>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.confirm_reschedule.title"),[])),'</h2></header><section class="jive-modal-content clearfix"><p>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.confirm_reschedule.text"),[])),'<p><ul><li><a id="event-calendar-confirm-fullday" class="close" href="#">',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.confirm_reschedule.fullday.link"),[])),'</a></li><li><a id="event-calendar-confirm-asis" class="close" href="#">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.confirm_reschedule.asis.link"),[])),'</a></li><li><a id="event-calendar-confirm-cancel" class="close" href="#">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.cancel"),[])),"</a></li></ul></section></div>");return opt_sb?"":output.toString()};
jive.event.calendar.resizeConfirmation=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="jive-modal j-modal" id="event-calendar-confirm"><header><h2>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.confirm_resize.title"),[])),'</h2></header><section class="jive-modal-content clearfix"><p>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.confirm_resize.text"),[])),'<p><ul><li><a id="event-calendar-confirm-continue" class="close" href="#">',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.yes"),[])),'</a></li><li><a id="event-calendar-confirm-cancel" class="close" href="#">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.no"),[])),"</a></li></ul></section></div>");return opt_sb?"":output.toString()};
jive.event.calendar.place=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<head>");jive.place.head(soy.$$augmentMap(opt_data,{initEditLink:false}),output);output.append('</head><body class="j-body-place">');jive.place.header(opt_data,output);output.append('<div class="j-layout j-layout-l j-contained j-contained-tabs j-contained-tabs-place j-rc4 clearfix"><div class="j-column-wrap-l"><div class="j-column j-column-l">');jive.event.calendar.large(opt_data,output);output.append("</div></div></div></body>");
return opt_sb?"":output.toString()};
jive.event.calendar.profileCalendarLink=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<a href="',soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/profile-calendar.jspa")),"?userID=",soy.$$escapeHtml(opt_data.userID),'" id="navCalendar" class="j-refind-btn" title="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("profile.tab.calendar"),[])),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("profile.tab.calendar"),[])),"</a>");
return opt_sb?"":output.toString()};jive.event.calendar.main=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;var param250=new soy.StringBuilder;jive.people.profile.header(opt_data,param250);jive.event.calendar.profile(opt_data.calendarViewBean,param250);jive.people.profile.decorator(soy.$$augmentMap(opt_data,{bodyClass:"",bodyContent:param250.toString()}),output);return opt_sb?"":output.toString()};
;
goog.provide("jive.invite.jsInit");
jive.invite.jsInit=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<script>$j(function(){$j('",soy.$$escapeJsString(opt_data.trigger),"').one('click.inviteApp', function() {require(['apps/invitation/main'], function(InviteMain) {window['inviteApp'] = new InviteMain(",soy.$$escapeJsValue(opt_data.container_id),', "',soy.$$escapeJsString(opt_data.container_type),"\", true, '",soy.$$escapeJsString(opt_data.trigger),"', '",opt_data.trackingID?soy.$$escapeJsString(opt_data.trackingID):
"","' );});}); if (",opt_data.showNow?"true":"false",") {$j('",soy.$$escapeJsString(opt_data.trigger),"').click();}});<\/script>");return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.backgroundImage");
jive.integration.backgroundImage=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<style class="headerStyle js-headerStyle">.j-body-place #jive-body .j-page-header {',opt_data.bgType&&opt_data.bgType!="custom"?(opt_data.bgPresetImageUrl!="none"?'background-image: url("'+soy.$$escapeHtml(jive.soy.func.resourceUrl(window._jive_base_url,"/9.0.5.998b920/","//files1.element14.com/community",opt_data.bgPresetImageUrl))+'");':"background-image:none;")+(opt_data.bgColor?"background-color: "+
(opt_data.bgColor=="transparent"?" transparent ":" "+(opt_data.bgColor.indexOf("#")!=-1?" "+soy.$$escapeHtml(opt_data.bgColor)+" ":" #"+soy.$$escapeHtml(opt_data.bgColor)+" ")+"  ")+";":""):(opt_data.bgCustomImageUrl&&opt_data.bgCustomImageUrl!="none"?'background-image : url("'+soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.bgCustomImageUrl))+'");':"background-image: none;")+"background-color: "+(opt_data.bgColor&&opt_data.bgColor!="null"&&opt_data.bgColor!="transparent"?
"  "+(opt_data.bgColor.indexOf("#")!=-1?" "+soy.$$escapeHtml(opt_data.bgColor)+" ":" #"+soy.$$escapeHtml(opt_data.bgColor)+" ")+" ":" transparent")+";",opt_data.bgRepeat!="cover"&&opt_data.bgRepeat!="null"?"background-repeat: "+soy.$$escapeHtml(opt_data.bgRepeat)+"; background-size: auto;":"background-size:cover;",opt_data.bgPosition!="null"?"background-position: "+soy.$$escapeHtml(opt_data.bgPosition)+";":"","}",opt_data.textColor!=null?".j-placeHeaderInner, .j-placeTitle a.j-placeName {color: "+
(opt_data.textColor.indexOf("#")!=-1?" "+soy.$$escapeHtml(opt_data.textColor)+" ":" #"+soy.$$escapeHtml(opt_data.textColor))+";}":".j-placeHeaderInner, .j-placeTitle a.j-placeName {color: #fff;}","</style>");return opt_sb?"":output.toString()};
;
function toggleVCardActionButtons(){var a=$j("#vcard-modal-prompt").find(":checked");if(a.length>0){$j("#vcard-download-button").prop("disabled",false);$j("#vcard-email-button").prop("disabled",false)}else{$j("#vcard-download-button").prop("disabled",true);$j("#vcard-email-button").prop("disabled",true)}}function downloadVCard(b){var a=constructVCardURL(b);if(a&&a.length>0){document.location.href=a}else{alert("You must select at least one content type.");return false}return false}function emailSingleVCard(a,b){$j("#vcard-modal-prompt").find(":checked").prop("checked",false);a.prop("checked",true);emailVCard(b);return false}function emailVCard(c){var a=constructVCardURL(c);if(a&&a.length>0){try{$j("#vcard-modal-results").load(a,null,function(){$j("#vcard-modal-prompt").hide();$j("#vcard-modal-results").show()})}catch(b){$j("#vcard-modal-prompt").hide();$j("#vcard-modal-results").html("There was an unexpected error.<br><br>"+b);$j("#vcard-modal-results").show()}}else{alert("You must select at least one content type.")}return false}function constructVCardURL(b){var d=$j("#vcard-modal-prompt").find(":checked");if(d.length>0){var a=b;for(var c=0;c<d.length;c++){a=a+((a.indexOf("?")>-1)?"&":"?")+"objectTypes="+d[c].value}return a}else{return""}};
;
define("apps/tile/responsive_tile",["jquery"],function(e){var a=600;var b=e(".j-place-column, .j-news-tile-column");var d=_.throttle(function(){b.each(function(f,g){var h=e(g);if(h.innerWidth()<a){h.addClass("j-column-responsive")}else{h.removeClass("j-column-responsive")}})},60);var c=function(){b=e(".j-place-column");d()};d();e(window).resize(function(){d()});return c});
;
jive.namespace("MicroBlogging");define("apps/microblogging/views/attachment_view",["jquery","apps/shared/views/abstract_view"],function(b,a){jive.MicroBlogging.AttachmentView=a.extend(function(c,d){this.init=function(e){d.init.call(this,e);this.$imageContainer=null;this.isCreateForm=e.isCreateForm||true;this.resizeHandlerRegistered=false};c.getSoyTemplate=function(e){return jive.statusinput.attachments.renderAttachment(e)};c.getSoyTemplateAttachments=function(e){return jive.statusinput.attachments.renderAttachments(e)};c.renderAttachments=function(f,g){var e=this.getContent();e.append(this.getSoyTemplateAttachments($j.extend({removable:this.isCreateForm},f)));if(this.isCreateForm){e.show();if($j.isFunction(g)){g()}}else{e.css("opacity","1").show()}e=null};c.renderAttachment=function(f){var e=this.getContent().find("li.j-attached-loading");e.before(this.getSoyTemplate($j.extend({removable:this.isCreateForm},f)));e=null};c.registerResizeHandler=function(){if(!this.resizeHandlerRegistered){var e=this;$j(window).resize((function(){var f;return function(){var g=$j(window).width();if(f&&g!==f){e.resize()}f=g}})());this.resizeHandlerRegistered=true}};this.postRender=function(){d.postRender.call(this);var g=this.getContent();this.registerResizeHandler();var f=g.find("ul.j-attached-items"),e=this;g.find("a.j-attachment-arrow").unbind();g.find("a.j-attachment-arrow").mousedown(function(){try{e.scrollHandler($j(this),f)}catch(h){console.log(h)}}).mouseup(function(){f.stop();return false}).click(function(){return false})};this.add=function(g,h){var e=this,i=h.meta,f=this.getContent(),l=this.getAttachmentContainer(),k=Array.isArray(i)?i[0]:i;k.properties=_.object(k.properties.entry.map(function(m){return[m.key,m.value]}));$j.extend(k,{originalURL:g});if(l.length>0){this.renderAttachment({attachment:k});e.postRender()}else{this.renderAttachments({attachments:i})}f.find("ul.j-attached-items li:not(.j-attached-loading):last .j-remove-attachment:not(.j-close)").click(function(){e.removeImage(k.id);return false});var j=l.find(".js-attached-link .j-details .j-title").attr("href");if(f.find("ul.j-attached-items li:not(.j-attached-loading):last .j-remove-attachment").length==0||j){l.find(".j-remove-attachment").on("click",function(){e.emitP("removeImage",k.id).addCallback(function(){e.removeAttachment(k.id)}).addErrback(function(){console.log("error removing attachment with id "+k.id)});return false})}f.find("li.js-attached-link .j-thumbnails .no-thumb").click(function(){e.emitP("removeThumbnail",k.id).addCallback(function(){e.getContent().find(".j-thumbnails").remove()}).addErrback(function(){console.log("error removing thumbnail with id "+k.id)});return false});f.find("li.js-attached-link .j-thumbnails .left").click(function(){e.previewLeft();return false});f.find("li.js-attached-link .j-thumbnails .right").click(function(){e.previewRight();return false});e.hideLoadingNotification();this.resize();this.scrollHandler(f.find("a.j-attachment-arrow-right"),f.find("ul.j-attached-items"));i=null;f=null;l=null};this.getAttachmentContainer=function(){return this.getContent().find("ul.j-attached-items")};this.getAttachmentCount=function(){return this.getAttachmentContainer().children("li:visible:not('.j-attached-loading')").size()};this.getAttachmentIDs=function(){var e=this.getAttachmentContainer();return e.children("li:visible:not('.j-attached-loading')").map(function(){return parseInt(this.id)})};this.removeImage=function(f){var e=this,g=this.getContent().parent().find(".jive-js-statusinput");e.emitP("removeImage",f).addCallback(function(){g.off("change.checkLinks keyup.checkLinks blur.checkLinks");e.removeAttachment(f)}).addErrback(function(){console.log("error removing attachment with id "+f)})};this.showLoadingNotification=function(f){var i=new b.Deferred();var e=this,f=f||{},g=f.spinnerSize?f.spinnerSize:"small",h=this.getContent().find("li.j-attached-loading");if(h.length==0){this.renderAttachments({entry:{meta:[]}},function(){h=e.getContent().find("li.j-attached-loading");h.addClass(f.listItemClass).show();e.showSpinner({size:g,showLabel:false,context:h});i.resolve()})}else{h.addClass(f.listItemClass);h.show();this.showSpinner({size:g,showLabel:false,context:h});i.resolve()}h=null;return i};this.hideLoadingNotification=function(){var e=this.getContent().find("li.j-attached-loading");e.attr("class","j-attached-loading");this.hideSpinner();e.hide();if(e.length&&e.siblings("li:not(.j-attached-loading)").size()==0){this.reset()}e=null};this.reset=function(){this.getContent().html("").hide().find("li.j-attached-loading").hide();this.metaData=[]};this.removeAttachment=function(f){var e=$j("#"+f);if(e.size()>0&&e.siblings("li:not(.j-attached-loading)").size()==0){this.reset()}e.remove();if(this.metaData){this.metaData=this.metaData.filter(function(g){return f!==g.id})}e=null};this.removeAllAttachments=function(){var f=this;var e=this.getAttachmentIDs();for(var h=0,g=e.length;h<g;h++){f.removeImage(e[h])}e=null};this.hide=function(){this.hideAllMenus();this.getContent().hide()};this.resize=function(){var f=0,e=this.getContent();e.find("li.j-attached-image, li.j-attached-video").each(function(){f+=$j(this).outerWidth()});var g=this.getAttachmentScrollDim();if(g.containerWidth<g.attachmentsWidth){this.showArrows()}else{this.hideArrows()}if(e.find("li.js-attached-link").length==0){e.find("ul.j-attached-items").css("width",g.attachmentsWidth+"px")}};this.scrollHandler=function(g,f){var h,k=g.outerWidth()*2,j=this.getAttachmentScrollDim(),i=j.attachmentsWidth-j.containerWidth,e=parseInt(f.css("left"));if(isNaN(e)){e=0}if(g.hasClass("j-attachment-arrow-right")&&i>0){h=e+(i+k);f.stop().animate({left:(-i-k)},h*5,"linear")}else{if(i>0){h=e*-1;f.stop().animate({left:0},h*5,"linear")}}};c.getAttachmentScrollDim=function(){var e=this.getContent();var f={containerWidth:e.width(),attachmentsWidth:0};e.find("li.j-attached-image, li.j-attached-video").each(function(){f.attachmentsWidth+=$j(this).outerWidth()});e=null;return f};c.showArrows=function(){var e=this.getContent();e.find("a.j-attachment-arrow").css("display","block");e.find("ul.j-attached-items").css("margin-left","20px");e=null};c.hideArrows=function(){var e=this.getContent();e.find("a.j-attachment-arrow").hide();e.find("li.j-attached-image, li.j-attached-video").first().css("margin-left","0px");e=null};c.previewLeft=function(){var f=this.getContent(),g=f.find("ul.j-thumbnails-viewport"),e=g.find("li.selected");e.next().addClass("selected");e.removeClass("selected").appendTo(g)};c.previewRight=function(){var e=this.getContent(),f=e.find("ul.j-thumbnails-viewport");f.find("li.selected").removeClass("selected");f.find("li.j-thumbnail:last").addClass("selected").prependTo(f)}});jive.MicroBlogging.AttachmentView.views={};return jive.MicroBlogging.AttachmentView});
;
goog.provide("jive.shared.soy.getCountTextByType");
jive.shared.soy.getCountTextByType=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;switch(opt_data.type){case "reply":output.append(opt_data.count==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.replycount.singular"),[opt_data.count])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.replycount.plural"),[opt_data.count])));break;case "like":output.append(opt_data.count==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.likecount.singular"),[opt_data.count])):
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.likecount.plural"),[opt_data.count])));break;case "showlikescount":output.append(opt_data.count==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.showlikecount.singular"),[opt_data.count])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.showlikecount.plural"),[opt_data.count])));break;case "bookmark":output.append(opt_data.count==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.bookmarkcount.singular"),
[opt_data.count])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.bookmarkcount.plural"),[opt_data.count])));break;case "showbookmarkscount":output.append(opt_data.count==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.showbookmarkcount.singular"),[opt_data.count])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.showbookmarkcount.plural"),[opt_data.count])));break;case "follow":output.append(opt_data.count==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.followercount.singular"),
[opt_data.count])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.followercount.plural"),[opt_data.count])));break;case "showfollowcount":output.append(opt_data.count==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.showfollowercount.singular"),[opt_data.count])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.showfollowercount.plural"),[opt_data.count])));break;case "membership":output.append(opt_data.count==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.membercount.singular"),
[opt_data.count])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.membercount.plural"),[opt_data.count])));break;case "externalContributorsMembership":output.append(opt_data.count==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.membercount.externalcontributors.singular"),[opt_data.count])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.membercount.externalcontributors.plural"),[opt_data.count])));break;case "showmembercount":output.append(opt_data.count==
1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.showmembercount.singular"),[opt_data.count])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.showmembercount.plural"),[opt_data.count])));break;case "connections":output.append(opt_data.bidirectionalGraph?opt_data.count==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.friendcount.singular"),[opt_data.count])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.friendcount.plural"),
[opt_data.count])):opt_data.count==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.followingcount.singular"),[opt_data.count])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.followingcount.plural"),[opt_data.count])));break;case "showconnectioncount":output.append(opt_data.bidirectionalGraph?opt_data.count==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.showfriendcount.singular"),[opt_data.count])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.showfriendcount.plural"),
[opt_data.count])):opt_data.count==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.showfollowingcount.singular"),[opt_data.count])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.showfollowingcount.plural"),[opt_data.count])));break;case "showsubspacecount":output.append(opt_data.count==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.showsubspacecount.singular"),[opt_data.count])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.showsubspacecount.plural"),
[opt_data.count])));break;case "expertise":output.append(opt_data.count==1?"Endorsement":soy.$$escapeHtml(opt_data.count)+" Endorsements");break;case "commentcount":output.append(opt_data.count==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.comments.singular"),[opt_data.count])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.comments.plural"),[opt_data.count])));break;case "same_question":output.append(opt_data.count==0?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("acclaim.modal.same_question.count.zero"),
[opt_data.count])):opt_data.count==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("acclaim.modal.same_question.count.singular"),[opt_data.count])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("acclaim.modal.same_question.count.plural"),[opt_data.count])));break;case "items":output.append(opt_data.count==0?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.items.parens.count.zero"),[opt_data.count])):opt_data.count==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.items.parens.count.singular"),
[opt_data.count])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.items.parens.count.plural"),[opt_data.count])));break;default:output.append(opt_data.count==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.followingcount.singular"),[opt_data.count])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.followingcount.plural"),[opt_data.count])))}return opt_sb?"":output.toString()};
;
goog.provide("jive.shared.file.fileTypeIconClass");
jive.shared.file.fileTypeIconClass=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("jive-icon-",soy.$$escapeHtml(opt_data.size?opt_data.size:"big")," ");switch(String(opt_data.extension).toLowerCase()){case "doc":case "docx":case "odt":case "fodt":case "ott":case "sxw":case "stw":case "sdw":case "sgl":case "rtf":case "wpd":case "wps":output.append(" jive-icon-doctype-document");break;case "pdf":output.append(" jive-icon-doctype-acrobat");break;case "zip":case "tar":case "tgz":case "gz":case "bz2":case "rar":case "dmg":case "7z":case "ace":output.append(" jive-icon-doctype-compressed");
break;case "jpg":case "jpeg":case "png":case "gif":case "bmp":case "svg":case "exif":case "ico":case "psd":case "pdd":case "psb":case "tiff":case "tif":case "raw":case "xcf":output.append(" jive-icon-doctype-image");break;case "pps":case "ppt":case "pptx":case "pptm":case "potx":case "potm":case "pot":case "ppsx":case "ppsm":case "ppam":case "ppa":case "pptx":case "odp":case "key":output.append(" jive-icon-doctype-presentation");break;case "xls":case "xlk":case "xlsb":case "xlsm":case "xlsx":case "xlt":case "xltm":case "xlw":case "ods":case "ots":case "sdc":case "stc":case "sxc":case "csv":output.append(" jive-icon-doctype-spreadsheet");
break;case "txt":output.append(" jive-icon-doctype-text");break;case "avi":case "mov":case "3gp":case "asf":case "flv":case "mpg":case "mpeg":case "mpe":case "mp4":case "m1v":case "m2v":case "fla":case "m4v":case "mkv":case "swf":case "wmv":case "ogv":case "ogx":output.append(" jive-icon-doctype-video");break;default:output.append(" ",opt_data.defaultIcon?soy.$$escapeHtml(opt_data.defaultIcon):"jive-icon-doctype-generic")}return opt_sb?"":output.toString()};
;
goog.provide("jive.shared.displayutil.icon");
jive.shared.displayutil.icon=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.type=="url")output.append('<span aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.externalUrl"),[])),'" role=img class="jive-icon-',soy.$$escapeHtml(opt_data.size),' jive-icon-external-site"></span>');else if(opt_data.type=="favorite")output.append('<span aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.bookmark"),[])),'" role="img" class="jive-icon-',
soy.$$escapeHtml(opt_data.size),' jive-icon-bookmark"></span>');else if(opt_data.type=="post")output.append('<span aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.blogPost"),[])),'" role="img" class="jive-icon-',soy.$$escapeHtml(opt_data.size),' jive-icon-blog"></span>');else if(opt_data.type=="update")output.append('<span aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.status"),[])),'" role="img" class="jive-icon-',soy.$$escapeHtml(opt_data.size),
' jive-icon-status"></span>');else if(opt_data.type=="dm")output.append('<span aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.message"),[])),'" role="img" class="jive-icon-',soy.$$escapeHtml(opt_data.size),' jive-icon-direct-message"></span>');else if(opt_data.type=="comment")output.append(opt_data.rootType?opt_data.rootType=="post"?'<span aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.comment"),[]))+'" role="img" class="jive-icon-'+soy.$$escapeHtml(opt_data.size)+
' jive-icon-blog-comment"></span>':opt_data.rootType=="update"?'<span aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.comment"),[]))+'" role="img" class="jive-icon-'+soy.$$escapeHtml(opt_data.size)+' jive-icon-status-comment"></span>':opt_data.rootType=="entry"||opt_data.rootType=="file"?'<span aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.comment"),[]))+'" role="img" class="jive-icon-'+soy.$$escapeHtml(opt_data.size)+' jive-icon-comment"></span>':
opt_data.rootType=="dm"?'<span aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.comment"),[]))+'" role="img" class="jive-icon-'+soy.$$escapeHtml(opt_data.size)+' jive-icon-direct-message"></span>':opt_data.rootType!="comment"?'<span aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.comment"),[]))+'" role="img" class="jive-icon-'+soy.$$escapeHtml(opt_data.size)+" jive-icon-"+soy.$$escapeHtml(opt_data.rootType)+'-comment"></span>':"":opt_data.parentContent&&
opt_data.parentContent.type?opt_data.parentContent.type=="post"?'<span aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.comment"),[]))+'" role="img" class="jive-icon-'+soy.$$escapeHtml(opt_data.size)+' jive-icon-blog-comment"></span>':opt_data.parentContent.type=="update"?'<span aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.comment"),[]))+'" role="img" class="jive-icon-'+soy.$$escapeHtml(opt_data.size)+' jive-icon-status-comment"></span>':opt_data.parentContent.type==
"entry"?'<span aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.comment"),[]))+'" role="img" class="jive-icon-'+soy.$$escapeHtml(opt_data.size)+' jive-icon-comment"></span>':opt_data.parentContent.type=="dm"?'<span aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.comment"),[]))+'" role="img" class="jive-icon-'+soy.$$escapeHtml(opt_data.size)+' jive-icon-direct-message"></span>':opt_data.parentContent.type!="comment"?'<span aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.comment"),
[]))+'" role="img" class="jive-icon-'+soy.$$escapeHtml(opt_data.size)+" jive-icon-"+soy.$$escapeHtml(opt_data.parentContent.type)+'-comment"></span>':"":'<span aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.comment"),[]))+'" role="img" class="jive-icon-'+soy.$$escapeHtml(opt_data.size)+' jive-icon-comment"></span>');else if(opt_data.type=="discussion"||opt_data.type=="message")output.append(opt_data.answer?'<span aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.discussion"),
[]))+'" role="img" class="jive-icon-'+soy.$$escapeHtml(opt_data.size)+' jive-icon-discussion-correct"></span>':opt_data.helpful?'<span aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.discussion"),[]))+'" role="img" class="jive-icon-'+soy.$$escapeHtml(opt_data.size)+' jive-icon-discussion-helpful"></span>':opt_data.question?'<span aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.discussion"),[]))+'" role="img" class="jive-icon-'+soy.$$escapeHtml(opt_data.size)+
' jive-icon-discussion-question"></span>':'<span aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.discussion"),[]))+'" role="img" class="jive-icon-'+soy.$$escapeHtml(opt_data.size)+' jive-icon-discussion"></span>');else if(opt_data.type=="file"){output.append('<span aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.uploaded_file"),[])),'" class="');if(opt_data.iconCss)output.append("jive-icon-",soy.$$escapeHtml(opt_data.size)," ",soy.$$escapeHtml(opt_data.iconCss));
else jive.shared.file.fileTypeIconClass({extension:opt_data.extension,size:opt_data.size,defaultIcon:"jive-icon-document-upload"},output);output.append('"></span>')}else if(opt_data.type=="person"&&opt_data.jive)if(opt_data.size=="sml")jive.shared.displayutil.avatar(soy.$$augmentMap(opt_data,{username:opt_data.jive.username,size:12,enabled:true,visible:true}),output);else if(opt_data.size=="med")jive.shared.displayutil.avatar(soy.$$augmentMap(opt_data,{username:opt_data.jive.username,size:16,enabled:true,
visible:true}),output);else if(opt_data.size=="big")jive.shared.displayutil.avatar(soy.$$augmentMap(opt_data,{username:opt_data.jive.username,size:25,enabled:true,visible:true}),output);else jive.shared.displayutil.avatar(soy.$$augmentMap(opt_data,{username:opt_data.jive.username,size:opt_data.size,enabled:true,visible:true}),output);else if(opt_data.type=="userregistration")output.append('<span aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.profile"),[])),'" role="img" class="jive-icon-med jive-icon-profile"></span>');
else if(opt_data.type=="extStreamActivity")output.append('<img aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tse.objecttype.name"),[])),'" role="img" class="jive-icon-',soy.$$escapeHtml(opt_data.size),'" alt="" src="',soy.$$escapeHtml(opt_data.productIcon),'"></img>');else if(opt_data.type=="interaction"||opt_data.type=="collaboration")output.append('<span aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.comment"),[])),'" role="img" class="jive-icon-',
soy.$$escapeHtml(opt_data.size),' jive-icon-direct-message"></span>');else if(opt_data.type=="profileimage")output.append('<span aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("people.profileimage.name"),[])),'" role="img" class="jive-icon-',soy.$$escapeHtml(opt_data.size),' jive-icon-photo"></span>');else if(opt_data.type=="106642994"||opt_data.type=="photoAlbum")output.append('<span aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("global.access.content.type."+
opt_data.type)),[])),'" role="img" class="jive-icon-',soy.$$escapeHtml(opt_data.size),' jive-icon-doctype-image"></span>');else if(opt_data.type)output.append('<span aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("global.access.content.type."+opt_data.type)),[])),'" role="img" class="jive-icon-',soy.$$escapeHtml(opt_data.size)," jive-icon-",soy.$$escapeHtml(opt_data.type),'"></span>');return opt_sb?"":output.toString()};
;
goog.provide("jive.tags.autocomplete.tagInput");
jive.tags.autocomplete.tagInput=function(opt_data,opt_sb){opt_data=opt_data||{};var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-tags"><ul><li class="j-tag-icon j-tag-input jive-icon-glyph icon-tag1 font-color-meta-light" role="presentation"></li><li class="js-tag-entry j-tag-entry"><input type="text" id="input_tags" data-is-not-create-field="',opt_data.isNotCreateField?soy.$$escapeHtml(opt_data.isNotCreateField):"false",'" data-hide-prepopulated-tags="',opt_data.hidePrepopulatedTags?
soy.$$escapeHtml(opt_data.hidePrepopulatedTags):"false",'" data-hide-suggestions-on-init="',opt_data.hideSuggestionsOnInit?soy.$$escapeHtml(opt_data.hideSuggestionsOnInit):"false",'" data-is-skill="',opt_data.isSkill?soy.$$escapeHtml(opt_data.isSkill):"false",'" data-focus-on-load="',opt_data.focusOnLoad?soy.$$escapeHtml(opt_data.focusOnLoad):"false",'" placeholder="',opt_data.placeholder?soy.$$escapeHtml(opt_data.placeholder):"",'" class=" js-tag-input',opt_data.identifier?" "+soy.$$escapeHtml(opt_data.identifier):
"",'" value="" autocomplete="off" role="combobox" aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tags.aria.label"),[])),'" aria-labelledby="input_tags" aria-expanded="false"/></li></ul></div><input type="hidden" class="js-hidden-tag-input" name="tags" value="',soy.$$filterNoAutoescape(opt_data.tags?opt_data.tags.replace(new RegExp('"',"g"),"&quot;"):""),'"/>');return opt_sb?"":output.toString()};
;
define("jive/fresh_action_queue",["jquery"],function(a){return function b(h){var d=[],i=[],c=[];if(typeof h==="undefined"){h=500}function f(o,n){var l=new a.Deferred();var m=g(d.length,n);d.push(o);i.push(new Date());c.push(n);function k(){if(e(o,n)){o.then(function(){l.resolve.apply(l,arguments)},function(){l.reject.apply(l,arguments)})}}o.then(k,k,function(){l.notify.apply(l,arguments)});if(h&&m){j(m.promise,m.time,m.group)}return l.promise()}function j(o,n,m){var l=new Date();var k=l-n;setTimeout(e.bind(null,o,m),Math.max(h-k,0))}function e(o,n){var p=d.lastIndexOf(o);var l=g(p,n);var k=d.length;var m;if(p>-1){if(l){d=d.slice(l.index+1);i=i.slice(l.index+1);c=c.slice(l.index+1)}m=k-d.length;d.splice(p-m,1);i.splice(p-m,1);c.splice(p-m,1);return o}}function g(m,l){for(var k=m-1;k>=0;k-=1){if(typeof l==="undefined"||c[k]!==l){return{index:k,promise:d[k],time:i[k],group:c[k]}}}}return{push:f}}});
;
(function(d){var f={typeAheadOptions:{keystrokeWait:400},popoverOptions:{focusPopover:false,onClose:d.noop,addClass:"j-autocomplete",setRole:"listbox"},processResults:h,parseSearchString:h,displayResults:l,displayEmptySearch:false,closeOnBlur:true,minChars:2,clearButton:d()};function h(m){return m}function l(n,m){d(n).popover(m);return m}function c(n,m){var o=this;n=d.extend(true,{},f,n);n.input=m;n.popoverOptions.context=m;var q=n.popoverOptions.onClose;n.popoverOptions.onClose=function(){m.trigger("closed");return q()};n.popoverOptions.returnPopover=true;if(!n.queryFunc){if(!n.querySource||!n.querySource.get){console.log("Error: missing querySource.get in options, and no queryFunc supplied",n)}n.queryFunc=function p(){return n.querySource.get.call(n.querySource,arguments)}}if(!n.template){console.log("Error: missing template in options",n)}this.options=n;m.prop("autocomplete","off").attr("aria-autocomplete","list").attr("aria-haspopup","true");if(!m.is("[role=combobox]")){m.attr("role","combobox")}this.lastSearchString=null;this.currentPopover=null;this.queue=new g();n.input.typeAhead(n.typeAheadOptions).on("keystroke.suggestBox",function(){o.showPopover();o.updateClearButton()}).on("focusWaitFinished.suggestBox",function(){o.showPopover()}).on("close.suggestBox",d.proxy(o.destroyPopover,o)).on("tabChanged.suggestBox",function(){o.currentPopover.reposition()}).on("otherClick.suggestBox",function(){jive.conc.nextTick(function(){o.currentPopover.reposition()})});if(n.closeOnBlur){n.input.on("blurWaitFinished.suggestBox",function(r){n.input.trigger("close")})}if(n.clearButton.length){d(n.clearButton).on("click.suggestBox",function(){n.input.val("");n.input.trigger("keystroke")});this.updateClearButton()}}c.prototype.updateClearButton=function k(){if(this.options.clearButton.length){if(this.options.input.val()){this.options.clearButton.show()}else{this.options.clearButton.hide()}}};c.prototype.displaySuggestions=function a(q){var n=d.extend({},this.options.popoverOptions);this.destroyPopover();if(!this.options.input.is(":visible")){return}n=this.options.displayResults(q,n,this.currentPopover);this.currentPopover=n;var p=this.currentPopover.popOver;if(!p.is("[role=listbox]")&&p.find("[role=listbox]").length===0){console.log("Warning: adding role 'listbox' to results container");p.attr("role","listbox")}var o=this.options.input.data("typeAhead");var m=o.getSelectable();if(m.length>0&&m.select("option, [role=option]").length===0&&m.parent("[role=option]").length===0){console.log("Warning: selectable elements are not options");m.attr("role","option")}o.setSuggestElement(p)};c.prototype.showPopover=function e(){var o=this,n=this.options;var m=n.parseSearchString(n.input.val());if(m==null||m.length<n.minChars){m="";if(!n.displayEmptySearch){return}}if(this.lastSearchString!=null&&this.lastSearchString==m){if(this.isPopoverShowing()){return}}this.lastSearchString=m;this.queue.push(n.queryFunc(m)).then(function(r){if(r&&r.trim){r=r.trim()}var s=n.processResults(r,n.input.data("typeAhead"),m);if(!s){o.destroyPopover()}else{var q=n.template(s);if(q&&q.length){o.displaySuggestions(q)}else{o.destroyPopover();console.log("suggestion html empty for results",r,s)}}},function p(){console.log("failed suggestBox query for '"+m+"'",arguments)})};c.prototype.destroyPopover=function j(m){if(this.currentPopover&&this.currentPopover.closeFunc){this.currentPopover.closeFunc()}this.currentPopover=null;if(m&&m.type==="close"){this.lastSearchString=null;m.stopPropagation()}};c.prototype.isPopoverShowing=function b(){return this.currentPopover!=null};c.prototype.teardown=function i(){var m=this.options.input;this.destroyPopover();m.data("typeAhead").teardown();m.off(".suggestBox");m.removeData("suggestBox");this.options.clearButton.off(".suggestBox")};d.fn.suggestBox=function(m){return this.each(function(){var n=d(this);if(!n.data("suggestBox")){n.data("suggestBox",new c(m,n))}})};var g;require(["jive/fresh_action_queue"],function(m){g=m})})(jQuery);
;
define("apps/shared/views/tab_view",function(){jive.TabView=function(e,m){jive.conc.observable(this);m=m||{};var j=m.activeClass||"jive-body-tabcurrent",a=m.tabSelector||".jive-body-tab",d=m.nameFromTab||function(n){return(n.attr("id")||"").replace(/-tab$/,"")},h=this;function l(){return $j(e).find(a)}function c(){return l().filter(function(){return $j(this).hasClass(j)})}function g(){return d(l().filter(function(){return $j(this).hasClass(j)}))}function f(n){l().each(function(){var p=$j(this),o=d(p);p.toggleClass(j,o==n)});l().each(function(){var q=$j(this),p=d(q),o=$j('[id="'+p+'"]');if(p==n){o.show()}else{o.hide()}})}function k(n){h.emit("tabSwitch",n,c())}function i(n){f(n);k(n)}function b(o,p){var n=l().filter(function(){return d($j(this))==o});n.toggle(!!p)}this.switchTo=i;this.setVisibility=b;this.activeTabName=g;this.activeTab=c;$j(document).ready(function(){$j(e).delegate(a,"click",function(p){var o=$j(this),n=d(o);i(n);p.preventDefault()});if(!l().hasClass(j)){l().first().trigger("click")}})};return jive.TabView});
;
jive.namespace("Tags");define("apps/tags/model/tag_input_model",["jquery","underscore"],function(c,b){var e=",";jive.Tags.TagInputModel=jive.oo.Class.extend(function(f){jive.conc.observable(this);f.init=function(g){this.element=g.element};this.deleteTag=function(g){var h=this.getTags();if(!b.contains(h,g)){return}a(this.element,b.without(h,g))};this.addTag=function(g){var h=this.getTags();if(b.contains(h,g)||g.length==0){this.emit("tags.duplicate",g);return false}h.push(g);a(this.element,h);return true};this.getTags=function(){return d(this.element.val().split(e))}});function a(g,f){g.val(d(f).join(e))}function d(f){return b.without(b.map(f,function(g){return g.trim()}),"")}return jive.Tags.TagInputModel});
;
jive.namespace("Tags");define("apps/tags/model/tag_service",["apps/shared/models/rest_service"],function(a){jive.Tags.TagService=a.extend(function(b,d){b.resourceType="tag";var c={};b.init=function(e){d.init.call(this,e);this.RESOURCE_ENDPOINT=jive.rest.url("/tags/cloud");this.defaultParams=e};this.findAll=function(k){k=jQuery.extend({},this.defaultParams,k||{});var f=k.max,e={},g=this.cacheKey(k),i=c[g],j=new jive.conc.Promise(),h=this;if(i){j.emitSuccess(i)}else{Object.keys(k).forEach(function(l){if(l!="max"){e[l]=k[l]}});this.get(f,e).addCallback(function(m){var l=m.contentTagCloudBean;c[g]=l;j.emitSuccess(l)}).addErrback(function(){j.emitError.apply(j,arguments)})}return j};b.cacheKey=function(e){return Object.keys(e).sort().map(function(f){return f+"="+JSON.stringify(e[f])}).join("&")}});return jive.Tags.TagService});
;
jive.namespace("Tags");define("apps/tags/model/tag_suggestions",["apps/shared/models/rest_service"],function(a){jive.Tags.TagSuggestions=a.extend(function(b,c){b.resourceType="tag";b.init=function(d){c.init.call(this,d);this.RESOURCE_ENDPOINT=jive.rest.url("/tags/search")};this.get=function(e,d){return this.commonAjaxRequest(new jive.conc.Promise(),"get",{data:$j.extend({query:encodeURIComponent(e)+"*"},d||{}),url:this.RESOURCE_ENDPOINT})}});return jive.Tags.TagSuggestions});
;
goog.provide("jive.tags.autocomplete.tagCloud");
jive.tags.autocomplete.tagCloud=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="jive-modal j-modal jive-modal-medium" role="dialog" aria-modal="true" aria-labelledby="jive-tags-modal-label" aria-describedby="jive-tags-modal-description"><header id="jive-tags-modal-label"><h2>',opt_data.placeName?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tags.top_tags_in"),[opt_data.maxCount,opt_data.placeName])):opt_data.skillList?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.filter.tag.top_skills_in_this_place"),
[opt_data.maxCount])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.filter.tag.top_tags_in_this_place"),[opt_data.maxCount])),'</h2></header><a href="#" class="j-modal-close-top close" aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close.modal"),[])),'" title="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close.modal"),[])),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close"),[])),' <span class="j-close-icon j-ui-elem" role="img"></span></a><section class="jive-modal-content j-modal-content-text clearfix">');
if(opt_data.availableTags.length>0){output.append('<p id="jive-tags-modal-description">',opt_data.skillList?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.filter.tag.skills_cloud_tip"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.filter.tag.cloud_tip"),[])),'</p><ul class="jive-tagcloud-list">');var tagList27=opt_data.availableTags;var tagListLen27=tagList27.length;for(var tagIndex27=0;tagIndex27<tagListLen27;tagIndex27++){var tagData27=tagList27[tagIndex27];output.append('<li class="js-tag jive-tagset-popularity',
soy.$$escapeHtml(tagData27.bucket),opt_data.selectedTags.indexOf(tagData27.renderedTag)>-1?" js-selected":"",'" data-value="',soy.$$escapeHtml(tagData27.renderedTag),'"><a href="#" role="checkbox" aria-checked="',soy.$$escapeHtml(opt_data.selectedTags.indexOf(tagData27.renderedTag)>-1),'" title="',tagData27.count!=1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tags.used_n_times.tooltip"),[tagData27.count])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tags.used_1_time.tooltip"),
[])),'" aria-label="',soy.$$escapeHtml(tagData27.renderedTag),'">',soy.$$escapeHtml(tagData27.renderedTag),"</a></li> ")}output.append('</ul><button class="close j-btn-callout" aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.done"),[])),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.done"),[])),"</button>")}else output.append("<p>",opt_data.skillList?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.filter.tag.no_skills"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.filter.tag.no_popular_tags"),
[])),"</p>");output.append("</section></div>");return opt_sb?"":output.toString()};
;
jive.namespace("Tags");define("apps/tags/view/tag_cloud",["jquery","soy!jive.tags.autocomplete.tagCloud"],function(b,a){jive.Tags.TagCloud=jive.AbstractView.extend(function(c){c.init=function(f,g){var e=this;e.isPeopleTagCloud=g;var d=b(f).closest(".j-form");if(0===d.length){d=b(f).parent()}d.on("click",".js-open-tag-cloud",function(h){e.emit("cloud");jive.Accessibility.pushFocus(b(this));h.preventDefault()})};this.show=function(g,e,f){var h=new jive.conc.Promise(),d=this;this.showSpinner();g.addCallback(function(i){d.hideSpinner();d.render({availableTags:i,selectedTags:e,maxCount:f,skillList:d.isPeopleTagCloud});d.content.lightbox_me({destroyOnClose:true,onClose:function(){h.emitSuccess(d.getTags())}})});return h};this.render=function(d){this.content=b(a(d));this.content.find(".js-tag a").click(function(f){var e=b(this).closest(".js-tag").toggleClass("js-selected").find("a");e.attr("aria-checked",!(e.attr("aria-checked")==="true"));f.preventDefault()})};c.getTags=function(){return this.content.find(".js-selected").toArray().map(function(d){return b(d).data("value")})}});return jive.Tags.TagCloud});
;
goog.provide("jive.tags.autocomplete.tagBadge");jive.tags.autocomplete.tagBadge=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<li class='js-tag j-tag j-btn-global'><span class='js-tag-text j-tag-text' >",soy.$$filterNoAutoescape(opt_data.tag),'</span><span class=\'remove\' role="presentation" aria-hidden="true">,</span></li>');return opt_sb?"":output.toString()};
;
jive.namespace("Tags");define("apps/tags/view/tag_badges",["jquery","soy!jive.tags.autocomplete.tagBadge"],function(b,a){jive.Tags.TagBadges=jive.oo.Class.extend(function(c){jive.conc.observable(this);c.init=function(e){var d=this;d.element=b(e);b(window).resize(_.bind(d.resizeBadges,d))};this.addBadge=function(d,i,h){var f=this,j=this.element.find(".js-tag-entry"),g=d.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),k=f.findExistingBadge(d),e;if(k){if(h){f.hilightBadge(k)}}else{if(!h||!_.contains(i,d)){e=b(a({tag:g}));j.before(e);this.resizeBadges()}}};this.removeBadge=function(d){d.remove()};this.blurBadge=function(){this.element.find(".js-tag.selected").removeClass("selected")};this.focusBadge=function(){this.element.find(".js-tag-entry").prev(".js-tag").addClass("selected")};this.findExistingBadge=function(d){var e=this.element.find(".j-tag"),f=d.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return(_.reduce(e,function(g,h){if(g&&g.length){return g}if(b(h).find(".js-tag-text").html().toLowerCase()==f){return b(h)}return g},false))};this.getTagsFromBadges=function(){return _.map(this.element.find(".j-tag"),function(d){return b(d).find(".js-tag-text").text()})};this.clear=function(){this.element.find(".js-tag").remove()};c.hilightBadge=function(d){d.addClass("selected")};c.resizeBadges=function(){this.element.find(".js-tag-text").css("max-width",(this.element.width()-30)+"px")}});return jive.Tags.TagBadges});
;
goog.provide("jive.tags.autocomplete.tagListItem");
jive.tags.autocomplete.tagListItem=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<li class="js-suggestion" role="option" aria-label="',opt_data.create?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.create.colon"),[]))+" ":"",soy.$$escapeHtml(opt_data.tag),'"><a href="#" data-value="',soy.$$escapeHtml(opt_data.tag),'" class="quick ',opt_data.create?"j-createTag":"",'">',opt_data.create?'<span class="font-color-normal">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.create.colon"),
[]))+" </span>":"",'<span class="jive-icon-tag jive-icon-med"></span><span class="lnk">',soy.$$escapeHtml(opt_data.tag),"</span></a></li>");return opt_sb?"":output.toString()};
;
goog.provide("jive.tags.autocomplete.tagList");
jive.tags.autocomplete.tagList=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<ul class="js-suggestions j-autocomplete-results" ',opt_data.id?'id="'+opt_data.id+'"':""," ",opt_data.hidden?'style="display:none"':"",' role="listbox" aria-labelledby="js-tags-suggestions-header">');if(opt_data.query)jive.tags.autocomplete.tagListItem({tag:opt_data.query,create:true},output);var tagList20=opt_data.tags;var tagListLen20=tagList20.length;if(tagListLen20>0)for(var tagIndex20=
0;tagIndex20<tagListLen20;tagIndex20++){var tagData20=tagList20[tagIndex20];jive.tags.autocomplete.tagListItem({tag:tagData20},output)}else output.append(!opt_data.query?'<li class="font-color-meta" role="alert"><p class="j-empty">'+(opt_data.skill?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("skills.search.empty"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tags.search.empty"),[])))+"</p></li>":"");output.append("</ul>");return opt_sb?"":output.toString()};
;
goog.provide("jive.tags.autocomplete.completions");jive.tags.autocomplete.completions=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="js-tags-completions j-tags-suggestions j-menu j-quick-menu">');jive.tags.autocomplete.tagList(soy.$$augmentMap(opt_data,{id:"tag-completions"}),output);output.append("</div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.tags.autocomplete.popularTags");
jive.tags.autocomplete.popularTags=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="js-tags-suggestions j-tags-suggestions j-menu j-quick-menu" role="application"><p id="js-tags-suggestions-header" class="j-autocomplete-prompt j-pop-desc">',opt_data.skill?soy.$$filterNoAutoescape(jive.i18n.i18nText(jive.i18n.getMsg("browse.filter.tag.typeahead.skills"),[]))+' <span class="j-508-label"> '+soy.$$filterNoAutoescape(jive.i18n.i18nText(jive.i18n.getMsg("browse.filter.tag.typeahead.close"),[]))+
" </span>":soy.$$filterNoAutoescape(jive.i18n.i18nText(jive.i18n.getMsg("browse.filter.tag.typeahead"),[]))+' <span class="j-508-label"> '+soy.$$filterNoAutoescape(jive.i18n.i18nText(jive.i18n.getMsg("browse.filter.tag.typeahead.close"),[]))+" </span>",'</p><div class="j-autocomplete-nav clearfix"><nav class="j-tab-nav"><ul class="j-tabbar"><li id="popular-tags-tab" aria-live="polite" data-tab-id=\'popular-tags\' class="',!opt_data.active||opt_data.active=="popular-tags"?"j-active active":"",' js-tab"><a href="#" style="border:none;"class="j-ui-elem">',
opt_data.skill?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.filter.tag.popular_skills"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.filter.tag.popular_tags"),[])),"</a></li>",opt_data.yourTags&&opt_data.yourTags.length>0?'<li id="your-tags-tab" aria-live="polite" data-tab-id=\'your-tags\' class="'+(opt_data.active=="your-tags"?"active":"")+' js-tab"><a href="#" style="border:none;" class="j-ui-elem">'+(opt_data.skill?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.filter.tag.your_skills"),
[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.filter.tag.your_tags"),[])))+"</a></li>":"","</ul></nav></div>");jive.tags.autocomplete.tagList({tags:opt_data.popularTags,id:"popular-tags",hidden:opt_data.active&&opt_data.active!="popular-tags",skill:opt_data.skill},output);if(opt_data.yourTags&&opt_data.yourTags.length>0)jive.tags.autocomplete.tagList({tags:opt_data.yourTags,id:"your-tags",hidden:opt_data.active!="your-tags",skill:opt_data.skill},output);output.append("</div>");
return opt_sb?"":output.toString()};
;
jive.namespace("Tags");define("apps/tags/tags_controller",["jquery","underscore","apps/shared/views/tab_view","apps/tags/model/tag_input_model","apps/tags/model/tag_service","apps/tags/model/tag_suggestions","apps/tags/view/tag_cloud","apps/tags/view/tag_badges","soy!jive.tags.autocomplete.completions","soy!jive.tags.autocomplete.popularTags"],function(h,m,n,f,c,i,b,k,g,d){var a=",",l=55,e=100,j=/[^,]+$/;jive.Tags.Controller=jive.oo.Class.extend(function(q){jive.conc.observable(this);q.init=function(x,v){v=h.extend({},v);var u=this,z={max:10,containerType:v.containerType||17,containerID:v.containerID||1};v=v||{};if(v.objectTypes&&v.objectTypes.length>0){z.taggableTypes=v.objectTypes}if(v.addClass&&v.addClass.length>0){u.element.addClass(v.addClass)}u.element=h(x);u.singleTagInput=v.singleTagInput;if(v.frameId&&v.hiddenElement){var w=h("#"+v.frameId);w.contents().find("#input_tags").addClass("frameId-"+v.frameId);u.hiddenElement=w.contents().find(v.hiddenElement)}else{u.hiddenElement=u.element.closest(".j-form").find(".js-hidden-tag-input")}u.initialTags=u.hiddenElement.val().split(a);u.isSkills=u.element.data("isSkill");u.badgeElement=u.element.closest(".j-form").find(".j-tags");u.isNotCreateField=u.element.data("isNotCreateField");u.hidePrepopulatedTags=u.element.data("hidePrepopulatedTags");u.hideSuggestionsOnInit=u.element.data("hideSuggestionsOnInit");u.focusOnLoad=u.element.data("focusOnLoad");u.suggestions=new i();u.tagService=new c(z);u.tagBadges=new k(u.badgeElement);u.tagModel=new f({element:u.hiddenElement});u.tagCloud=new b(x,(this.element.closest(".j-browse-people").length>0));u.tagService.suppressGenericErrorMessages();u.userID=_jive_current_user.ID||"-1";if(this.userID!="-1"){this.yourTagParams={filterUserID:u.userID}}function y(B){function C(F){if(F){return F.map(function(G){return G.renderedTag})}return[]}function D(F){return m.chain(F).filter(function(G){return G.found}).pluck("name").value()}function A(F,I){var G=m.find(F,function(J){return !J.found}),H=m.isUndefined(G)&&m.some(F,function(J){return J.name==I});u.currentQueryIsProfane=false;if(H){return undefined}else{if(!m.isUndefined(G)){u.currentQueryIsProfane=G;return G.name}else{return I}}}if(typeof B=="string"&&B.trim().length){return u.suggestions.get(B.trim()).then(function(F){if(m.isUndefined(F)||m.isUndefined(F.tagSearchResult)){return{tags:[],query:B}}else{return{tags:D(F.tagSearchResult),query:A(F.tagSearchResult,B)}}})}var E={popularTags:u.tagService.findAll()};if(u.yourTagParams){E.yourTags=u.tagService.findAll(u.yourTagParams)}if(B&&B.length){E.yourTags=u.tagService.findAll({tags:B})}return jive.conc.synchronize(E).then(function(F){return{popularTags:C(F.popularTags),yourTags:C(F.yourTags)}})}u.element.suggestBox({displayEmptySearch:true,queryFunc:y,template:this.templateSwitcher,processResults:function(B,A,C){if(B.tags){if(u.isNotCreateField){B.query=undefined}B.tags=B.tags.unique()}else{var D=A.getActiveTab();if(D.length>0){B.active=D.data("tabId")}}if(u.isSkills){B.skill=true}return B},displayResults:function(B,A){if(u.element.val()!=""&&(!u.hideSuggestionsOnInit||u.startedTyping)&&!(u.isNotCreateField&&h(B).find(".j-empty").length>0)){m.extend(A,{context:u.element,container:h("#j-expertise-modal"),addClass:"j-tag-autocomplete j-autocomplete",align:"left",arrowOffset:15});var C=h(B).popover(A);new n(C,{activeClass:"j-active active",tabSelector:".js-tab"});return A}}}).on("selectionChosen",this.onTagSelected.bind(u)).on("keydown",this.onKeydown.bind(u)).on("keyup",this.onKeyup.bind(u)).on("paste",function(){jive.conc.nextTick(o.bind(u,u.element));h(this).one("change",u.onChange.bind(u))}).focus(this.controllerHasFocus.bind(u,true,u)).on("blur blurWaitFinished",this.controllerHasFocus.bind(u,false,u)).on("tags.resizeInput",u.resizeInput.bind(u,u.element)).click(function(A){A.stopPropagation()});if(v.focusOnLoad){u.element.focus()}if(jive.onLoadEventComplete){this.createInitialTags()}else{h(window).on("load",this.createInitialTags.bind(u))}h(window).on("resize",u.resizeInput.bind(u,u.element));this.hiddenElement.on("change",this.createInitialTags.bind(u));this.element.parents(".j-tags").on("click",".remove",this.onClickRemoveBadge.bind(this)).on("click",function(){x.focus()});this.tagCloud.addListener("cloud",function(){var A=u.tagModel.getTags(),C={max:200},B=u.tagService.findAll(C);u.tagCloud.show(B,A,200).addCallback(function(D){if(A.join(a)!=D.join(a)){u.insertTags(D.join(a))}})});this.tagModel.addListener("tags.duplicate",function(A){var B=u.tagBadges.findExistingBadge(A);if(!B){u.emit("tags.duplicate",A)}});this.tagService.findAll();this.tagService.findAll(this.yourTagParams)};this.getElement=function(){return this.element};this.populate=function(){this.createInitialTags()};this.getTagsFromBadges=function(){return this.tagBadges.getTagsFromBadges()};this.getInputVal=function(){return this.element.val()};this.clear=function(){this.tagBadges.clear();this.clearInput(this.element)};this.insertTags=function(w,x){var u=this,v=m.isArray(w)?w:String(w).split(a);$j.each(v,function(A,y){var z=u.sanitizeTag(y);if(z.length==0){return}u.tagBadges.addBadge(z,u.tagModel.getTags(),x);if(u.tagModel.addTag(z)&&x){u.emitTagChange("add",z)}});this.resizeInput(this.element);if(u.singleTagInput){this.element.hide()}};this.teardown=function(){var u=this.element.data("suggestBox");this.element.off("selectionChosen").off("keydown").off("keyup").off("paste").off("focus").off("click").off("blur").off("blurWaitFinish");this.element.parents(".j-tags").off("click");this.tagModel.removeListener("tags.duplicate");this.hiddenElement.off("change");if(u){u.teardown()}};q.createInitialTags=function(){var u;if(this.hiddenElement.length!=0){this.resizeInput(this.element);if(!this.hidePrepopulatedTags){u=this.tagModel.getTags();if(!u||0==u.length){return}this.insertTags(u,false)}if(this.focusOnLoad&&h("#jive-tagform-search").length){this.element.focus()}}};q.controllerHasFocus=function(v,u){var w=h(".j-tags");u.focused=v;w.addClass(v?"focus":"blur");w.removeClass(v?"blur":"focus");if(!v){u.tagBadges.blurBadge()}};q.clearInput=function(u){u.val("");u.trigger("close.suggestBox")};q.resizeInput=function(z){var u=11,v=this.element.closest("form").find(".j-tags").width(),y=m.reduce(this.element.closest("form").find(".j-tags li"),function(B,A){var E=h(A),C=h(A).outerWidth(true);if(E.hasClass("js-tag-entry")){return B}else{var D=B+C;if(D+e+u>=v){return 0}else{return B+C}}},0),x=Math.floor((v-y)-u),w=x<e?e:x;z.hide();z.width(w);z.show()};q.sanitizeTag=function(u){if(this.currentQueryIsProfane){u=this.currentQueryIsProfane.name}return u.trim().replace(/\s+/g," ").toLowerCase()};q.removeTagByBadge=function(v){var u=v.find(".js-tag-text").text();this.tagBadges.removeBadge(v);this.tagModel.deleteTag(u);this.emitTagChange("remove",u);if(this.singleTagInput){this.element.show();this.element.focus()}};q.emitTagChange=function(v,u){this.emit("tags.change",this.tagModel.getTags());this.emit("tags."+v,u)};q.onKeyup=function(w){var u=this.element.val();var v=this;if(u.length>1&&u[u.length-1]===","){this.clearInput(this.element);this.insertTags(u,true);v.element.focus()}};q.onKeydown=function(w){var u=this.element.val(),v=this;v.startedTyping=true;if(w.which&&s(w)&&u.length>0){this.clearInput(this.element);this.insertTags(u,true);if(!h.keyIs("tab",w.which)){w.preventDefault();jive.conc.nextTick(function(){v.element.focus()})}}else{if(w.which&&r(w,u)){var x=h(".js-tag.selected");if(x.length!=0){this.removeTagByBadge(x);this.element.focus()}else{this.tagBadges.focusBadge()}w.preventDefault();this.clearInput(this.element)}else{if(w.which&&t(w,u)){w.preventDefault()}else{if(p(w)){w.preventDefault()}else{this.tagBadges.blurBadge()}}}}};q.onChange=function(){var u=this.element.val();this.insertTags(u,true)};q.onClickRemoveBadge=function(v){var u=h(v.target).parent();this.removeTagByBadge(u)};q.onTagSelected=function(y,v,x){var u=x.find("a").data("value");this.insertTags(u,true);this.clearInput(this.element);var w=this;jive.conc.nextTick(function(){w.element.focus()})};q.templateSwitcher=function(u){if(u.tags){return g(u)}return d(u)};function t(v,u){return(u.length>=l&&!(h.keyIs("backspace",v.which)||v.metaKey))}function s(u){return(h.keyIs("enter",u.which))}function r(v,u){return(h.keyIs("backspace",v.which)&&u=="")}function p(u){return u.key==="/"}function o(v){var u=v.val().replace(/\//g,"");v.val(u);if(u.length>=l){v.val(u.substring(0,l))}}});return jive.Tags.Controller});
;
define("apps/shared/views/menu_view",["channel!app"],function(a){jive.MenuView=jive.AbstractView.extend(function(b){var c=jQuery;b.init=function(f,g,e){var d=this;this.template=typeof f=="function"?f:function(){return f};this.$control=c(g);this.$control.on("vclick",function(j){var i,h=c(this);if(h.data("menu")){h.data("menu").trigger("close")}else{i=d.template();i.popover(c.extend({context:h,onLoad:function(){a.trigger("menu:rendered")},onClose:function(){h.removeData("menu");d.emit("close")}},e||{}));h.data("menu",i);d.emit("open")}j.preventDefault()})};this.close=function(){this.$control.each(function(){var d=c(this);if(d.data("menu")){d.data("menu").trigger("close")}})}});return jive.MenuView});
;
goog.provide("jive.theme.widget.colorInput");
jive.theme.widget.colorInput=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<span class="j-color-widget j-js-housing',opt_data.inline?" inline":"",'">',opt_data.labelText?'<label for="'+soy.$$escapeHtml(opt_data.id)+'" class="j-basic-label">'+soy.$$escapeHtml(opt_data.labelText)+"</label>":"",'<span class="j-field-spec">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("theming.menu.hex"),[])),'</span><input id="',soy.$$escapeHtml(opt_data.id),'" class="j-color-input j-js-color-input" name="',
opt_data.name?soy.$$escapeHtml(opt_data.name):soy.$$escapeHtml(opt_data.id),'" type="text" size="6" maxlength="6" autocomplete="off"',opt_data.value?' value="'+soy.$$escapeHtml(opt_data.value)+'"':"",'data-widget-type="color" data-can-be-transparent="',opt_data.canBeTransparent?"true":"false",'"><span class="j-color-display j-js-color-display" data-for="',opt_data.name?soy.$$escapeHtml(opt_data.name):soy.$$escapeHtml(opt_data.id),'"',opt_data.value?' style="background-color: #'+soy.$$escapeHtml(opt_data.value)+
';"':"","></span>",!opt_data.ignoreColorInfo?'<span class="j-color-info j-js-color-info j-supplemental"></span>':"","</span>");return opt_sb?"":output.toString()};
;
goog.provide("jive.theme.widget.fileDefault");
jive.theme.widget.fileDefault=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-default js-default"><input type="file" name="',soy.$$escapeHtml(opt_data.name),'" id="',soy.$$escapeHtml(opt_data.name),'" aria-labelledby="',soy.$$escapeHtml(opt_data.name),'-label"',opt_data.accept?' accept="'+soy.$$escapeHtml(opt_data.accept)+'"':"",'><p class="j-supplemental"><span class="jive-icon-med jive-icon-warn"></span>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("staticFiles.upload.warning.text"),
[])),"</p></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.theme.widget.fileUploading");
jive.theme.widget.fileUploading=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-uploading"><span class="jive-icon-med jive-icon-doctype-image"></span><img class="j-uploading js-uploading" src="',soy.$$escapeHtml(jive.soy.func.resourceUrl(window._jive_base_url,"/9.0.5.998b920/","//files1.element14.com/community","/images/j-loader-large-wht.gif")),'" height="15" width="60" alt="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("theming.widget.file.uploading"),[])),
'"></div>');return opt_sb?"":output.toString()};
;
goog.provide("jive.theme.widget.fileComplete");
jive.theme.widget.fileComplete=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<span class="j-complete"><span class="jive-icon-med jive-icon-doctype-image"></span><span class="filename js-filename">',soy.$$escapeHtml(opt_data.filename),"</span>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("theming.widget.file.change"),["changeImage"])),opt_data.removable?" "+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("theming.widget.file.remove"),["removeImage"])):
"","</span>");return opt_sb?"":output.toString()};
;
goog.provide("jive.theme.widget.file");jive.theme.widget.file=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-file-upload js-file-upload clearfix',opt_data.filename?" j-complete":" j-default",'">');jive.theme.widget.fileDefault(opt_data,output);jive.theme.widget.fileUploading(null,output);jive.theme.widget.fileComplete(opt_data,output);output.append("</div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.theme.widget.backgroundRepeatWidget");
jive.theme.widget.backgroundRepeatWidget=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<h5 class="j-basic-label">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("theming.widget.background_repeat"),[])),'</h5><ul class="button-list clearfix">');var defaulted__soy6=["repeat-x","repeat-y","no-repeat"].indexOf(opt_data.value)==-1;output.append('<li class="button-list-item first"><label for="',soy.$$escapeHtml(opt_data.name),'BgRepeatRepeat"',defaulted__soy6?
' class="checked"':"",opt_data.attachKeyValue?' data-key="'+soy.$$escapeHtml(opt_data.name)+'" data-value="repeat"':"",'><span class="repeat"></span>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("theming.widget.background_repeat.repeat"),[])),'<input id="',soy.$$escapeHtml(opt_data.name),'BgRepeatRepeat" class="j-508-label" type="radio" name="',soy.$$escapeHtml(opt_data.name),'BgRepeat" value="repeat"',defaulted__soy6?" checked":"",' /></label></li><li class="button-list-item"><label for="',
soy.$$escapeHtml(opt_data.name),'BgRepeatRepeatX"',opt_data.value=="repeat-x"?' class="checked"':"",opt_data.attachKeyValue?' data-key="'+soy.$$escapeHtml(opt_data.name)+'" data-value="repeat-x"':"",'><span class="repeat-x"></span>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("theming.widget.background_repeat.repeat_x"),[])),'<input id="',soy.$$escapeHtml(opt_data.name),'BgRepeatRepeatX" class="j-508-label" type="radio" name="',soy.$$escapeHtml(opt_data.name),'BgRepeat" value="repeat-x"',
opt_data.value=="repeat-x"?" checked":"",' /></label></li><li class="button-list-item"><label for="',soy.$$escapeHtml(opt_data.name),'BgRepeatRepeatY"',opt_data.value=="repeat-y"?' class="checked"':"",opt_data.attachKeyValue?' data-key="'+soy.$$escapeHtml(opt_data.name)+'" data-value="repeat-y"':"",'><span class="repeat-y"></span>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("theming.widget.background_repeat.repeat_y"),[])),'<input id="',soy.$$escapeHtml(opt_data.name),'BgRepeatRepeatY" class="j-508-label" type="radio" name="',
soy.$$escapeHtml(opt_data.name),'BgRepeat" value="repeat-y"',opt_data.value=="repeat-y"?" checked":"",' /></label></li><li class="button-list-item last"><label for="',soy.$$escapeHtml(opt_data.name),'BgRepeatNoRepeat"',opt_data.value=="no-repeat"?' class="checked"':"",opt_data.attachKeyValue?' data-key="'+soy.$$escapeHtml(opt_data.name)+'" data-value="no-repeat"':"",'><span class="no-repeat"></span>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("theming.widget.background_repeat.no_repeat"),
[])),'<input id="',soy.$$escapeHtml(opt_data.name),'BgRepeatNoRepeat" class="j-508-label" type="radio" name="',soy.$$escapeHtml(opt_data.name),'BgRepeat" value="no-repeat"',opt_data.value=="no-repeat"?" checked":""," /></label></li></ul>");return opt_sb?"":output.toString()};
;
goog.provide("jive.place.bgheader.customBackgrounds");
jive.place.bgheader.customBackgrounds=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-row">');jive.theme.widget.colorInput({id:"bannerBgColor",name:"bgColor",canBeTransparent:true,inline:true,labelText:jive.i18n.i18nText(jive.i18n.getMsg("place.manage.banner.bg_color_label"),[]),value:opt_data.bgColor},output);jive.theme.widget.colorInput({id:"bannerTextColor",name:"textColor",inline:true,labelText:jive.i18n.i18nText(jive.i18n.getMsg("place.manage.banner.text_color_label"),[]),
value:opt_data.textColor},output);output.append('<p class="j-supplemental">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.manage.banner.accepts_hex"),[])),'</p></div><form class="j-row" action="" method="post" enctype="multipart/form-data"><h5 class="j-basic-label"><label id="j-static-file-upload-label">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("theming.widget.background_image"),[])),"</label></h5>");jive.theme.widget.file({accept:"image/*",filename:opt_data.bgCustomImageName,
name:"j-static-file-upload",removable:true},output);output.append('</form><div class="j-row"><div class="backgroundRepeat">');jive.theme.widget.backgroundRepeatWidget({name:"bgRepeat",value:opt_data.bgRepeat,attachKeyValue:true},output);output.append('</div></div><a class="js-reset" href="#">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.manage.banner.reset"),[])),"</a>");return opt_sb?"":output.toString()};
;
goog.provide("jive.place.bgheader.presetBackgrounds");
jive.place.bgheader.presetBackgrounds=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<ul>");var imageList4=opt_data.availableDefaultBannerImages;var imageListLen4=imageList4.length;if(imageListLen4>0)for(var imageIndex4=0;imageIndex4<imageListLen4;imageIndex4++){var imageData4=imageList4[imageIndex4];output.append('<li><a href="#" aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.manage.editbg.popup.image.label"),[])),'" ',imageData4.location?
'data-key="bgPresetImageUrl" data-value="'+soy.$$escapeHtml(imageData4.location)+'"':"",'data-header-settings=\'{"bgPresetImageUrl":"',soy.$$escapeHtml(imageData4.location),'", "bgRepeat":"',soy.$$escapeHtml(imageData4.bgRepeat),'", "textColor":"',soy.$$escapeHtml(imageData4.textColor),'", "bgColor":"',soy.$$escapeHtml(imageData4.bgColor),'", "bgPosition":"',soy.$$escapeHtml(imageData4.bgPosition),'"}\' style="',imageData4.bgColor?"background-color: #"+soy.$$escapeHtml(imageData4.bgColor)+";":"",
" ",imageData4.location?"background-image: url('"+soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,imageData4.location))+"');":"",imageData4.bgRepeat?"background-repeat:"+soy.$$escapeHtml(imageData4.bgRepeat)+";":"",imageData4.bgPosition?"background-position: "+soy.$$escapeHtml(imageData4.bgPosition)+";":""," ",imageData4.textColor?"color: #"+soy.$$escapeHtml(imageData4.textColor):"",'">',imageData4.thumbnailLocation?'<img src="'+soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,
imageData4.thumbnailLocation))+'" alt="'+soy.$$escapeHtml(imageData4.ID)+'" class="jive-place-background-image js-preset-bg-image"> ':"","</a></li>")}else output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.manage.banner.no.presets"),[])));output.append("</ul>");return opt_sb?"":output.toString()};
;
goog.provide("jive.place.bgheader.backgroundMenu");
jive.place.bgheader.backgroundMenu=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-menu j-quick-menu j-background-submenu"><div class="j-pop-desc">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.manage.banner.select"),[])),'</div><div><nav class="j-tab-nav"><ul class="j-tabbar">',opt_data.isStaticResourcesEnabled?"<li"+(opt_data.bgType=="custom"?'  class="active"':"")+'><a class="userpicker-page-link j-ui-elem" href="#" data-toggle="tab" data-target="#j-custom-header-background" data-key="bgType" data-value="custom">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.manage.banner.custom"),
[]))+"</a></li>":"","<li",opt_data.bgType!="custom"?'  class="active"':"",'><a class="userpicker-page-link" href="#" data-toggle="tab" data-target="#j-preset-header-background" data-key="bgType" data-value="preset">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.manage.banner.preset"),[])),'</a></li></ul></nav><div class="j-submenu-body">');if(opt_data.isStaticResourcesEnabled){output.append('<section id="j-custom-header-background" class="j-tab-body',opt_data.bgType=="custom"?" active":
"",'">');jive.place.bgheader.customBackgrounds(opt_data,output);output.append("</section>")}output.append('<section id="j-preset-header-background" class="j-tab-body j-preset',opt_data.bgType!="custom"?" active":"",'">');jive.place.bgheader.presetBackgrounds(opt_data,output);output.append('</section></div></div><div class="j-themeClose j-rc4 j-rc-none-top"><button class="j-btn-callout j-done-theming close">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.manage.editbg.popup.close.button.label"),
[])),"</button></div></div>");return opt_sb?"":output.toString()};
;
define("url",["jquery","underscore","application/config"],function(f,e,d){function c(h,i){if(h&&typeof h!=="string"){throw new TypeError("Expected String, got object")}var g=f.isPlainObject(i)&&!f.isEmptyObject(i)?"?"+f.param(i):"";return(h||"").replace(/^\/?/,"")+g}var b={absoluteBaseUrl:function(h,i){var g=d.absoluteBaseUrl;g=g.lastIndexOf("/")==g.length-1?g:g+"/";return g+c(h,i)},appsUrl:function(h,g,i){g=g||"v1";return b.v2Url()+["apps",g,c(h,i)].join("/")},adminUrl:function(g,h){return b.baseUrl("admin/"+c(g,h))},baseUrl:function(g,h){return a(d.baseUrl)+c(g,h)},resourceUrl:function(g,h){return d.resourceUrl+c(g,h)},cssUrl:function(g,h){if(g&&document.querySelector('[dir="rtl"]')){g=g.replace(".css",".rtl.css")}return d.cssUrl+c(g,h)},secureUrl:function(g,h){return"https"+b.absoluteBaseUrl(g,h).replace(/^[^:]+/,"")},themeUrl:function(g,h){return d.themeUrl+c(g,h)},v2Url:function(g,h){return b.baseUrl("__services/v2/rest/")+c(g,h)},v3Url:function(g,h){return b.baseUrl("api/core/v3/")+c(g,h)}};function a(g){return g&&g.replace(/\/?$/,"/")}return b});
;
define("apps/static_files/static_file_controller",["jquery","lib/jiverscripts/src/oo/class","apps/shared/models/core_deferred","soy!jive.shared.file.fileTypeIconClass"],function(d,a,c,b){if(!jive.staticFileController||!jive.staticFileController.singleton){var e=a.extend(function(f){this.init=function(){var g=this;d(document).on("click",".js-static-file-control",function(j){j.preventDefault();var i=d(this),k=i.data("containertype")||(jive.global&&jive.global.containerType),h=i.data("containerid")||(jive.global&&jive.global.containerID);g.createModal(k,h)})};this.createModal=function(j,h){var g=this;var i=function(k){return k.jive.corev3.places.get({entityDescriptor:[j,h]})};c.runQuery(i).then(function(k){if(k.list){g.placeObj=k.list[0]}else{g.placeObj=k[0]}var l=d.Deferred().done(function(m){g.files=m;g.parseFileExtensions();require(["apps/static_files/static_file_modal"],function(n){g.modalView=new n({placeObj:g.placeObj,staticFiles:g.files,containerType:j});g.addModalListeners()})});g.getFileList(g.placeObj,l)})};this.getFileList=function(h,i){var g=this,j=h.getStatics();j.execute(function(k){if(k.error){i.reject()}else{var o=k.list;var n=[];for(var m=0;m<o.length;m++){var l=o[m];var p=decodeURI(l.filename).split("+").join(" ");l.filename=p;if(/^\./.exec(p)){continue}n.push(l)}g.files=n;g.parseFileExtensions();i.resolve(g.files)}})};this.addModalListeners=function(){var g=this;g.modalView.addListener("fileAdded",function(h){g.getFileList(g.placeObj,h)}).addListener("deleteFile",function(h,i){d.each(g.files,function(j,l){if(l.id==h){var k=l.destroy();k.execute(function(m){if(!m.error){g.getFileList(g.placeObj,i)}});return false}})})};this.parseFileExtensions=function(){var g=this;d.each(g.files,function(j,k){var h=k.filename;k.fileExtension=h.split(".").pop().toLowerCase();k.iconClass=b({extension:k.fileExtension,size:"med"})})}});jive.staticFileController={};jive.staticFileController.singleton=new e()}});
;
goog.provide("jive.socialgroups.soy.joinConfirmation");
jive.socialgroups.soy.joinConfirmation=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.pendingApproval?"<div>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.join.apprvl.info"),[]))+"</div>":opt_data.banned?"<div>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.banned_member.msg"),[]))+"</div>":"<div>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.join.confirm"),[]))+"</div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.socialgroups.soy.leaveGroup");
jive.socialgroups.soy.leaveGroup=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="jive-modal jive-modal-medium" id="jive-modal-leave-group"><header>',opt_data.pendingApproval?'<h2 class="jive-modal-title jive-modal-title-leave-group">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.join.cancel.colon"),[]))+" "+soy.$$escapeHtml(opt_data.groupName)+"</h2>":'<h2 class="jive-modal-title jive-modal-title-leave-group">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.leave.title"),
[]))+" "+soy.$$escapeHtml(opt_data.groupName)+"</h2>",'</header><label class="j-508-label" id="close-modal-508">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close.modal"),[])),'</label><a href="#" class="j-modal-close-top close" aria-labelledby="close-modal-508" title="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close.modal"),[])),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close"),[])),'  <span class="j-close-icon  j-ui-elem"></span></a><\!-- Manage categories listing --\><section class="jive-modal-content j-modal-content-text jive-modal-leave-group clearfix">',
opt_data.canLeaveSocialGroup?(opt_data.pendingApproval?"<h3>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.leave.canceljoin"),[opt_data.groupName]))+"</h3>"+(opt_data.requiresApproval?"<p>"+soy.$$escapeHtml(opt_data.leaveI18n)+"</p>":""):"<h3>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.leave.confirm"),[opt_data.groupName]))+"</h3>"+(opt_data.requiresApproval?"<p>"+soy.$$escapeHtml(opt_data.leaveI18n)+"</p>":"")+"<p>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.leave.follow.remove"),
[]))+"</p>")+'<div class="jive-form-buttons"><button type="button" class="j-btn-callout" id="group-leave-submit">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.leave.accept"),[]))+'</button><button type="button" class="jive-modal-close close">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.cancel"),[]))+"</button></div>":opt_data.onlyOneOwner?"<p>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.leave.onlyowner"),[]))+"</p><p>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.leave.onlyowner.info"),
[]))+'</p><div class="jive-form-buttons"><button type="button" class="jive-modal-close close">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.cancel"),[]))+"</button></div>":soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.leave.already.gone"),[])),"</section></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.socialgroups.soy.leaveConfirmation");jive.socialgroups.soy.leaveConfirmation=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.pendingApproval?"<div>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.cancel.message"),[]))+"</div>":"<div>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.leave.message"),[]))+"</div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.socialgroups.soy.renderError");
jive.socialgroups.soy.renderError=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;switch(opt_data.code){case 4026:output.append("<p>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.join.notallowed"),[])),"</p>");break;case 4008:output.append("<p>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.not.found"),[])),"</p>");break;default:if(opt_data.message)output.append("<p>",soy.$$escapeHtml(opt_data.message),"</p>");else jive.error.rest.soy.errorFinding(opt_data,
output)}return opt_sb?"":output.toString()};
;
jive.namespace("MembershipApp");jive.MembershipApp.MembershipView=jive.oo.Class.extend(function(a){var b="browse",d="landing";jive.conc.observable(this);this.init=function(g,i,f){var e=this;this.joinContainer=g;this.leaveContainer=i;this.options=f||{};var h="objectID" in f?d:b;this.isPage=function(j){return h===j};$j(document).ready(function(){if(e.isPage(d)){$j(document).delegate(e.joinContainer,"click",function(j){e.joinGroup($j(this));j.preventDefault()});$j(document).delegate(e.leaveContainer,"click",function(j){e.displayLeaveGroupModal($j(this));j.preventDefault()})}else{$j("body").on("click",".sgroup-join, .sgroup-leave",function(k){k.preventDefault();var j=$j(this);if(j.is(".sgroup-join")){e.joinGroup(j)}else{e.displayLeaveGroupModal(j)}})}})};this.joinGroup=function(f){var e=this;var g=e.determineObjectID(f);e.emitP("join",g).addCallback(function(h){var i=$j.noop;if(e.isPage(d)){if(!h.banned){$j(e.leaveContainer).show();$j(e.joinContainer).hide()}i=function(){if(window.location.href.match(/\?(.*&)?qstep=(\d+)/)&&h.memberToContribute){window.location=c(1)}else{if(e.options.redirectOnJoin){window.location=e.options.redirectOnJoin}else{window.location.reload()}}}}else{$j(f).closest(".j-thumb-back, .j-td-follow-action").find("a.sgroup-leave").show();$j(f).hide()}e.displayMessage(jive.socialgroups.soy.joinConfirmation(h),i);$j("#jive-link-socialgroup-startFollowing").hide();$j("#jive-link-socialgroup-following").show()}).addErrback(function(i,h){console.log("got error message: "+i+" code: "+h);e.displayError(i,h)})};this.displayLeaveGroupModal=function(f){var e=this;var g=e.determineObjectID(f);e.emitP("prepareLeave",g).addCallback(function(j){var h=$j(jive.socialgroups.soy.leaveGroup(j));$j("body").append(h);var i=$j("body").find("#jive-modal-leave-group");i.lightbox_me({closeSelector:".jive-modal-close, .close",destroyOnClose:true});i.find("#group-leave-submit").click(function(){e.leaveGroup(f,j);i.trigger("close")})}).addErrback(function(i,h){e.displayError(i,h)})};this.leaveGroup=function(f,g){var e=this;var h=e.determineObjectID(f);e.emitP("leave",h).addCallback(function(){var i=$j.noop;if(e.isPage(d)){$j(e.joinContainer).show();$j(e.leaveContainer).hide();$j("#jive-link-socialgroup-following").hide();$j("#jive-link-socialgroup-startFollowing").show();i=function(){if(!g.visibleAfterLeaving){window.location=jive.app.url({path:"/groups"})}else{if(g.memberToContribute){window.location=c(-1)}}}}else{$j(f).closest(".j-thumb-back, .j-td-follow-action").find("a.sgroup-join").show();$j(f).hide()}e.displayMessage(jive.socialgroups.soy.leaveConfirmation(g),i)}).addErrback(function(j,i){e.displayError(j,i)})};this.displayMessage=function(e,f){$j("<p />").html(e).message({style:"success",dismissCallback:f||$j.noop})};this.displayError=function(g,f){var e=jive.socialgroups.soy.renderError({message:g,code:f,href:window.location.href});$j(e).message({style:"error",showClose:true})};this.determineObjectID=function(e){var f=this.options.objectID||e.attr("data-objectid")||0;return parseInt(f,10)};function c(e){return window.location.href.replace(/\?(.*&)?qstep=(\d+)/,function(h,f,i){var g=parseInt(i)+e;return"?"+f+"qstep="+g})}this.tearDown=function(){var e=this;if(e.isPage(d)){$j(e.joinContainer).off("click");$j(e.leaveContainer).off("click")}else{$j(".sgroup-join").off("click");$j(".sgroup-leave").off("click")}}});define("apps/socialgroup/membership/views/membership_view",function(){return jive.MembershipApp.MembershipView});
;
jive.namespace("MembershipApp");define("apps/socialgroup/membership/models/membership_source",["apps/shared/models/rest_service"],function(a){jive.MembershipApp.MembershipSource=a.extend(function(b){b.resourceType="socialgroup";this.save=function(e){var f=new jive.conc.Promise(),d=this;var c=$j.deparam.querystring().fromQ;$j.ajax({type:"POST",url:this.RESOURCE_ENDPOINT+"/"+e.objectID+"/members",dataType:"json",data:c,contentType:"application/json; charset=utf-8",success:function(g,i,h){f.emitSuccess(g)},error:function(i,k,j){try{var h=$j.parseJSON(i.responseText);if(h&&h.error&&h.error.message){f.emitError(h.error.message,h.error.code)}}catch(g){f.emitError(null,i&&i.status)}}});return f};this.get=function(e){var f=new jive.conc.Promise(),d=this;var c={};c[this.resourceType]=e;$j.ajax({type:"GET",url:this.RESOURCE_ENDPOINT+"/"+e.objectID+"/memberInfo",dataType:"json",success:function(g,i,h){f.emitSuccess(g)},error:function(i,k,j){try{var h=$j.parseJSON(i.responseText);if(h&&h.error&&h.error.message){f.emitError(h.error.message,h.error.code)}}catch(g){f.emitError(null,i&&i.status)}}});return f};this.destroy=function(c){var d=new jive.conc.Promise();$j.ajax({type:"DELETE",url:this.RESOURCE_ENDPOINT+"/"+c.objectID+"/members",success:function(){d.emitSuccess()},error:function(g){try{var f=$j.parseJSON(g.responseText);if(f&&f.error&&f.error.message){d.emitError(f.error.message,f.error.code)}}catch(e){d.emitError(null,g&&g.status)}}});return d}});return jive.MembershipApp.MembershipSource});
;
jive.namespace("MembershipApp");define("apps/socialgroup/membership/main",function(){jive.MembershipApp.Main=jive.oo.Class.extend(function(a){this.init=function(c){var b=this;this.membershipSource=new jive.MembershipApp.MembershipSource(c);this.membershipView=new jive.MembershipApp.MembershipView("#jive-link-joinSocialGroup,.jive-link-joinSocialGroup","#jive-link-leaveSocialGroup,.jive-link-leaveSocialGroup",c);this.membershipView.addListener("join",function(e,d){b.membershipSource.save({objectID:e}).addCallback(function(f){d.emitSuccess(f);jive.switchboard.emit("sgroup.member.join",f)}).addErrback(function(g,f){console.log("got a err in main.js");d.emitError(g,f)})}).addListener("leave",function(e,d){b.membershipSource.destroy({objectID:e}).addCallback(function(){jive.switchboard.emit("sgroup.member.leave",e);d.emitSuccess()}).addErrback(function(g,f){console.log("got a err in main.js");d.emitError(g,f)})}).addListener("prepareLeave",function(e,d){b.membershipSource.get({objectID:e}).addCallback(function(f){d.emitSuccess(f)}).addErrback(function(g,f){console.log("got a err in main.js");d.emitError(g,f)})})};this.tearDown=function(){this.membershipView.removeListener("join").removeListener("leave").removeListener("prepareLeave").tearDown()}});return jive.MembershipApp.Main});
;
if(!jive.share){jive.share=(function(){var a;require(["jive/dispatcher"],function(b){b.listen("share",function(c){require(["apps/share/main"],function(d){a=a||new d();a.showModal(c.objectId,c.objectType,c.relationshipId)})})});return{}})()};
;
goog.provide("jive.soy.email_notification.common");jive.soy.email_notification.common=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<a href="#" rel="nofollow"><span class="jive-icon-glyph icon-envelope"></span>',soy.$$escapeHtml(opt_data.message),"</a>");return opt_sb?"":output.toString()};
;
goog.provide("jive.soy.email_notification.commonInSocialButton");jive.soy.email_notification.commonInSocialButton=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<a href="#" class="j-social-button j-rc5 j-button-toggle-email-notifications j-ui-elem"><span class="j-ui-elem"><span class="jive-icon-glyph icon-envelope"></span>',soy.$$escapeHtml(opt_data.message),"</span></a>");return opt_sb?"":output.toString()};
;
goog.provide("jive.soy.email_notification.stop");
jive.soy.email_notification.stop=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;switch(opt_data.type){case "common":jive.soy.email_notification.common({message:soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("thread.stop_watch.link"),[]))},output);break;case "socialButton":jive.soy.email_notification.commonInSocialButton({message:soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("thread.stop_watch.link"),[]))},output);break}return opt_sb?"":output.toString()};
;
goog.provide("jive.soy.email_notification.start");
jive.soy.email_notification.start=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;switch(opt_data.type){case "common":jive.soy.email_notification.common({message:soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("thread.start_watch.link"),[]))},output);break;case "socialButton":jive.soy.email_notification.commonInSocialButton({message:soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("thread.start_watch.link"),[]))},output);break}return opt_sb?"":output.toString()};
;
goog.provide("jive.soy.email_notification.message");
jive.soy.email_notification.message=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;switch(opt_data.type){case "watch":output.append(opt_data.isUser?"<p>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.watchuser.start"),[]))+"</p>":"<p>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.watch.start"),[]))+"</p>");break;case "unwatch":output.append(opt_data.isUser?"<p>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.watchuser.stop"),[]))+"</p>":
"<p>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.watch.stop"),[]))+"</p>");break}return opt_sb?"":output.toString()};
;
jive.namespace("EmailNotification");define("apps/email_notification/model/source",["apps/shared/models/rest_service"],function(a){jive.EmailNotification.Source=a.extend(function(b){b.resourceType="emailwatches";b.pluralizedResourceType=b.resourceType;b.resourceType="emailwatches";this.watch=function(e,c){var d=this.RESOURCE_ENDPOINT+"/watch/"+c+"/"+e;return this.commonAjaxRequest(new jive.conc.Promise(),"POST",{url:d})};this.unwatch=function(e,c){var d=this.RESOURCE_ENDPOINT+"/unwatch/"+c+"/"+e;return this.commonAjaxRequest(new jive.conc.Promise(),"POST",{url:d})}});return jive.EmailNotification.Source});
;
jive.namespace("EmailNotification");jive.EmailNotification.Main=function(e,d,b){var a=new jive.EmailNotification.Source(),c={watch:{newId:"jive-link-thread-unwatch",save:a.watch.bind(a),view:jive.soy.email_notification.stop},unwatch:{newId:"jive-link-thread-watch",save:a.unwatch.bind(a),view:jive.soy.email_notification.start}};$j("#jive-link-thread-watch, #jive-link-thread-unwatch").delegate("a","click",function(g){g.preventDefault();var h=$j(this).closest("#jive-link-thread-watch, #jive-link-thread-unwatch"),f=h.attr("id").split("-").pop();c[f].save(e,d).addCallback(function(){h.attr("id",c[f].newId).html(c[f].view({type:h.attr("data-type")||"common"}));$j(jive.soy.email_notification.message({type:f,isUser:!!b})).message({style:"success"})})})};define("apps/email_notification/main",function(){return jive.EmailNotification.Main});
;
jive.namespace("Modalizer");jive.Modalizer.ModalView=jive.AbstractView.extend(function(a){var c=jQuery,b=jive.Modalizer;a.init=function(h){var e=this,f,g={};if(h.width&&h.width.match(/^(narrow|medium|wide)$/i)){f="jive-modal-"+h.width}else{if(h.width){g.width=h.width}else{f="jive-modal-medium"}}this.width=f;this.styles=g;this.opts=h;var d=function(j){var i=c(this).attr("href")||c(this).find("a:first").attr("href");if(i){e.modalize(i)}else{alert("No valid URL found to modalize")}j.preventDefault()};c(document).ready(function(){if(h.triggers){c.each(h.triggers,function(){c(""+this).click(d)})}if(h.liveTriggers){c.each(h.liveTriggers,function(){c("body").on("click",""+this,d)})}})};this.modalize=function(f,e){var d=this,h=this.width,j=this.styles,i=this.opts,g=i.classes?i.classes:"";d.emitP("launch",f).addCallback(function(p){var o=c("<div/>",{"class":g+" jive-modal j-modal"+(h?" "+h:""),id:"js-modalized"}).css(j);var n=d.separateScripts(p);var m=d.shiv(n[0]);var k=n[1];var l=!c.browser.msie||parseInt(c.browser.version,10)>8;l&&o.html(m);o.lightbox_me({destroyOnClose:true,closeFocusSelector:e?e:(i.triggers?i.triggers.join(", "):i.liveTriggers.join(", ")),onClose:i.onClose,onLoad:function(){if(!l){o.html(m);k()}}});if(l){k()}})}});define("apps/modalizer/views/modal_view",function(){return jive.Modalizer.ModalView});
;
jive.namespace("Modalizer");jive.Modalizer.ModalSource=jive.oo.Class.extend(function(a){a.init=function(b){this.method=b.method?b.method:"GET"};this.getConfirmation=function(b,d){var c=this;$j.ajax({url:b,type:c.method,dataType:"html",success:function(e){d(e)},error:function(e){require(["jquery","soy!jive.error.rest.soy.errorFinding"],function(g,f){g(f({href:window.location})).message({style:"error"})})}})}});define("apps/modalizer/models/modal_source",function(){return jive.Modalizer.ModalSource});
;
jive.namespace("Modalizer");jive.Modalizer.Main=jive.oo.Class.extend(function(a){a.init=function(c){var b=this;this.modalView=new jive.Modalizer.ModalView(c);this.modalSource=jive.Modalizer.ModalSource(c);this.modalView.addListener("launch",function(d,e){b.modalSource.getConfirmation(d,function(f){e.emitSuccess(f)})})};this.modalize=function(c,b){this.modalView.modalize(c,b)}});define("apps/modalizer/main",function(){return jive.Modalizer.Main});
;
define("apps/theme/lib/inputs",["jquery","underscore"],function(e,c){function b(h){return/^#?(([a-f\d]){3}){1,2}$/i.test(h||"")}function g(i,h,j){return !isNaN(j)&&j>=i&&j<=h}function a(h){var i=e(h);return c.has(i.data(),"lastValue")?i.data("lastValue"):i.prop("defaultValue")}function d(){var j=e(this),h=b(this.value),i=h!==b(a(this));j.data("lastValue",this.value);if(i||h){j.trigger(h?"matched":"unmatched")}}function f(){var n=e(this),l=n.data(),k=c.has(l,"min")?l.min:-Infinity,h=c.has(l,"max")?l.max:Infinity,i=g(k,h,this.value),j=parseInt(a(this),10),m=i!==g(k,h,j);n.data("lastValue",isNaN(this.value)?this.value:parseInt(this.value,10));if(m||i){n.trigger(i?"matched":"unmatched")}}return{inRange:g,isHex:b,previousValue:a,onInput:function(h){if("color"===h){return d}else{if("number"===h){return f}else{return e.noop}}}}});
;
define("apps/places/models/place_images_model",["jquery","underscore","jive/promise_util","apps/shared/models/core_deferred"],function(d,a,c,b){function e(f){return/(bmp|gif|jpg|jpeg|png)$/i.test(f)}return function(h,g){var f;this.packageFile=function(i){if(!i){return c.failure("name_empty")}else{if(!e(i)){return c.failure("invalid_extension")}else{i=i.split(/\\|\//g).pop();var k=i.split(".").pop(),j=i.split(".").shift();return b.runQuery(f.getStatics()).then(function(n){var l=a.pluck(n,"filename"),m=0;while(l.indexOf(i)>-1){i=j+"-"+m+++"."+k}return{filename:i}})}}};this.handleUploadResponse=function(i){return function(k,l){var j=JSON.parse(k.body.innerHTML);isError=a.has(j,"error");j.filename=a.unescape(j.filename);if(l==="success"&&!isError){i.resolve(j)}else{if(isError){i.reject("upload_failure",j.error)}else{i.reject("unknown_error",k,l)}}}};b.getObject(h,g).done(function(i){f=i})}});
;
define("apps/places/manage/views/header_settings",["jquery","underscore","apps/theme/lib/inputs","soy!jive.place.bgheader.backgroundMenu","soy!jive.integration.backgroundImage"],function(g,f,d,c,e){function b(h){if(!d.isHex(h)){return""}return h.substring(0,1)==="#"?h:"#"+h}function a(h){return b(h).replace("#","")}return function(j,i,k){var h=g(j);this.reset=function(){h.removeData("headerSettings").data("headerSettings");return this.renderPreview()};this.set=function(m,n){var o=h.data("headerSettings");if(m==="bgColor"||m==="textColor"){var l=b(n);o[m]=l===""?"transparent":l;if(typeof(o.bgCustomImageUrl)=="undefined"){o.bgCustomImageName="none";o.bgCustomImageUrl="none"}}else{if(m==="customBgImage"){o.bgCustomImageName=n.name;o.bgCustomImageUrl=n.url}else{o[m]=n}}return this.renderPreview()};this.renderMenu=function(){var l=g.extend({},h.data("headerSettings"));return g(c({bgColor:a(l.bgColor),bgCustomImageName:l.bgCustomImageName,bgRepeat:l.bgRepeat,bgPosition:l.bgPosition,bgType:l.bgType,textColor:a(l.textColor),isStaticResourcesEnabled:i,availableDefaultBannerImages:k}))};this.renderPreview=function(){g("style.js-headerStyle").remove();g("body").append(e(h.data().headerSettings));return this}}});
;
goog.provide("jive.place.fileForm");
jive.place.fileForm=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<form style="display: none;" action="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/api/core/v3/places/"+opt_data.placeId+"/statics"+"?fields=resources,filename"))),'" method="post" enctype="multipart/form-data"><input type="hidden" name="jive.token.name" value="jive.static.files.token"><input type="hidden" name="jive.static.files.token" value=""></form>');return opt_sb?
"":output.toString()};
;
goog.provide("jive.place.errorMessage");jive.place.errorMessage=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<p>",opt_data.errorCode=="invalid_extension"?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.manage.banner.error.invalid_extension"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.manage.banner.error.unknown_error"),[])),"</p>");return opt_sb?"":output.toString()};
;
define("apps/theme/lib/plugins/single_file_upload",["jquery"],function(b){var d="singleFileUpload";function a(f){var e=b.Deferred();setTimeout(e.resolve,f);return e.promise()}function c(f,e){this.element=b(f);this.options=b.extend({},b.fn[d].defaults,e);this.filename="";this.fileInput=this.element.find(":file").eq(0).clone();this.element.on("click."+d,'[data-action="changeImage"], [data-action="removeImage"]',this.reset.bind(this))}c.prototype.reset=function(g){this.element.not(".j-default").removeClass("j-uploading j-complete").addClass("j-default").find(":file").remove().end().find(".js-default").append(this.fileInput.clone());var f=this.element;return a(0).then(function(){if(g){f.trigger(b(g.target).data("action"))}})};c.prototype.startUpload=function(){this.element.filter(".j-default").toggleClass("j-default j-uploading");return a(1000)};c.prototype.complete=function(f){var e=this;if(f){this.setFilename(f)}this.element.filter(".j-uploading").find(":file").each(function(){if(e.options.autoname&&this.value){e.setFilename(this.value)}}).end().toggleClass("j-uploading j-complete");return a(300)};c.prototype.setFilename=function(e){this.filename=e;this.element.find(".js-filename").text(this.filename);return this};b.fn.singleFileUpload=function(){return this.each(function(){var e=b(this);if(!e.data(d)){e.data(d,new c(this))}})};b.fn[d].Constructor=c;b.fn[d].defaults={autoname:false};return c});
;
define("apps/places/manage/views/header_background",["jquery","underscore","jive/util","apps/theme/lib/inputs","apps/places/models/place_images_model","apps/places/manage/views/header_settings","soy!jive.place.fileForm","soy!jive.place.errorMessage","apps/theme/lib/plugins/single_file_upload"],function(g,e,h,a,c,b,d,f){return function(n,r,p){var j=g("#place-background-image"),l=new b(j,r,p),o=new c(jive.global.containerType,jive.global.containerID),i=l.renderMenu(),s=i.find(".js-file-upload").on("change",":file",m).singleFileUpload().data("singleFileUpload");function m(){if(this.value){o.packageFile(this.value).then(q).then(function(t){l.set("bgType","custom").set("customBgImage",{name:t.filename,url:t.resources.html.ref});i.data("uploadForm").remove();s.complete(t.filename)},k)}}function q(w){var u=g.Deferred(),v=g.Deferred(),t=g.Deferred(),x=i.find(":file");setTimeout(v.resolve,1500);g.when(u,v,s.startUpload()).then(t.resolve,t.reject);h.securedForm(d({placeId:jive.global.containerBrowseId})).then(function(z){x.remove().prependTo(z);i.data("uploadForm",z);var y=1;z.appendTo("body").ajaxSubmit({dataType:"xml",data:{json:"{'filename':'"+e.escape(w.filename)+"','internal':true,'status':"+y+"}"},success:o.handleUploadResponse(u),error:o.handleUploadResponse(u)})});return t.promise()}function k(u,t){if(u==="upload_failure"){g("<p />").text(t.message).message({style:"warn"});console.debug(i.find(":file"));console.warn("Upload error (code: upload_failure, status: "+t.status+")",t)}else{g(f({errorCode:u})).message({style:"warn"});if(u!=="invalid_extension"){console.error("An unknown error occurred.",u);console.debug(arguments)}}s.reset()}i.on("click",".js-reset",function(t){t.preventDefault();l.reset().renderPreview();i.trigger("close")});i.on("removeImage",function(){l.set("customBgImage","none").renderPreview()});i.find(".j-js-color-input").on("input",a.onInput("color")).on("matched unmatched",function(w){var t=w.type==="matched"?"#"+this.value:"transparent",u=g(this).attr("name"),v=t;g(this).siblings(".j-js-color-display").css("backgroundColor",t).each(function(){l.set(u,v)})});i.on("click","[data-key]",function(v){v.preventDefault();var u=g(this).data("key");if(u==="bgPresetImageUrl"){l.set("bgType","custom");var t=g(this).data("value").substring(g(this).data("value").lastIndexOf("/")+1);l.set("bgCustomImageName",t);l.set("bgCustomImageUrl",g(this).data("value"));return}else{l.set(u,g(this).data("value"))}if(u==="bgRepeat"){v.preventDefault();g(this).closest(".button-list").find("label.checked").removeClass("checked").end().end().addClass("checked")}});i.on("click","[data-header-settings]",function(u){u.preventDefault();var t=this.getAttribute("data-header-settings");e.each(JSON.parse(t),function(x,v,w){l.set(v,x)})});i.popover({closeOtherPopovers:true,context:n})}});
;
goog.provide("jive.nav.menu.create.quick");
jive.nav.menu.create.quick=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="jive-modal jive-modal-quickcreate" aria-modal="true" role="dialog" aria-labelledby="jive-modal-quickcreate-label">');jive.shared.displayutil.a11yBoundary({type:"dialog"},output);output.append('<header class="j-modal-header" id="jive-modal-quickcreate-label"><h2 class="js-title">',soy.$$escapeHtml(opt_data.title),'</h2></header><a href="#" class="j-modal-close-top close" aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close.modal"),
[])),'" title="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close.modal"),[])),'"',opt_data.bootstrapCompatability?' data-dismiss="modal"':"",">",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close"),[])),'  <span class="jive-icon-glyph icon-close-med" role="img"></span></a><section class="jive-modal-content">',soy.$$filterNoAutoescape(opt_data.body),"</section>");jive.shared.displayutil.a11yBoundary({type:"dialog",isEnd:true},output);output.append("</div>");return opt_sb?
"":output.toString()};
;
goog.provide("jive.places.modal.modalLoading");
jive.places.modal.modalLoading=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<p class="font-color-meta-light j-modal-loading"><img src="',soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/images/jive-icon-working-16x16.gif")),'" alt="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("customize.loading"),[])),'" /> ',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("customize.loading"),[])),"</p>");return opt_sb?"":output.toString()};
;
jive.namespace("places.Manage");define("apps/places/manage/views/abstract_controls",["jquery","apps/shared/views/abstract_view","soy!jive.places.modal.modalLoading"],function(b,a,c){jive.places.Manage.AbstractControls=a.extend(function(d){d.modalContent=jive.oo._abstract;d.modal=jive.oo._abstract;d.activationLink=jive.oo._abstract;d.reloadOnClose=true;d.init=function(){var e=this;b(document).ready(function(){var f=b(e.modalContent),g=b(e.modal);b(e.activationLink).click(function(h){var i=b(this).data("object-id");e.activate(i,this,h);h.preventDefault()})})};d.activate=function(k,i,j){var f=this,g=b(f.modalContent),h=b(f.modal);this.onActivate(j,b(i));this.showSpinner();this.emitP("load",k,null).addCallback(function(n){var m=f.separateScripts(n),l=m[0],e=m[1];g.html(f.shiv(l));h.trigger("resize");e();f.hideSpinner();f.emit("load.after",{$modal:h})});h.lightbox_me({onClose:function(){if(f.reloadOnClose){window.location.reload()}return false}});b("#j-place-manage-container").trigger("close")};d.onActivate=function(f,e){};d.createSpinner=function(){b(this.modalContent).html(c())};d.destroySpinner=function(){}});return jive.places.Manage.AbstractControls});
;
define("apps/places/manage/views/custom_controls",["jquery","apps/places/manage/views/abstract_controls"],function(a,b){return b.extend(function(c){c.modalContent="";c.modal="";c.activationLink=".jive-link-manage-custom";c.reloadOnClose=false;c.init=function(){var d=this;a(document).ready(function(){a(d.activationLink).click(function(g){var h=null;var f=a(this).attr("href");if(f!=null&&f.indexOf("http")!=0&&f.indexOf("/")!=0){f="/"+f}d.onActivate(g,a(this));d.showSpinner();d.emitP("load",h,f).addCallback(function(l){var j=d.separateScripts(l),i=j[0],e=j[1],m=(i.match(/data-title\s*=\s*['"]([^'"]+)['"]/)||[])[1]||"";var k=jive.nav.menu.create.quick({title:m,body:i});a(k).lightbox_me({destroyOnClose:true,onClose:function(){if(d.reloadOnClose){window.location.reload()}return false}});e();d.hideSpinner()});a("#j-place-manage-container").trigger("close");g.preventDefault()})})}})});
;
define("apps/places/manage/main",["jquery","apps/places/manage/views/header_background","apps/places/manage/views/custom_controls","jive/dispatcher"],function(d,a,c,b){return jive.oo.Class.extend(function(e){e.init=function(g,h){var f=this;this.objectType=g.objectType;this.objectID=g.id;this.membershipSupported=g.membershipSupported;this.canArchive=g.canArchive;this.placeI18nKeyPrefix=g.placeI18nKeyPrefix;this.objectURL=g.objectURL;this.parentID=g.parentID;this.parentType=g.parentType;this.placeName=g.name;this.canCreateByEmail=g.canCreateByEmail;this.canManageAnnouncements=h.canManageAnnouncements;this.canManageCategories=h.canManageCategories;this.canMoveContainer=h.canMoveContainer;this.canManageContainer=h.canManageContainer;this.i18n=h.i18n;this.staticResourcesEnabled=h.staticResourcesEnabled;this.availableDefaultBannerImages=h.availableDefaultBannerImages;if(this.canCreateByEmail){require(["apps/places/manage/views/author_by_email_controls"],function(i){window.launchAuthorByEmailModal=function(){var j=new i();j.addListener("load",f.modalLoader("/author-by-email.jspa",{view:"place",containerType:f.objectType,container:f.objectID}))}})}if(this.canManageCategories){require(["apps/places/manage/views/category_controls"],function(i){f.categoryControls=new i();f.categoryControls.addListener("load",f.modalLoader("/manage-category.jspa"))})}if(this.canArchive){require(["apps/places/manage/views/archive_controls"],function(i){f.archiveControls=new i();f.archiveControls.addListener("load",f.modalLoader("/archive-project.jspa"))})}if(this.canMoveContainer){require(["apps/movecontent/main"],function(i){f.jiveMoveContent=new i({objectType:f.objectType,objectID:f.objectID,objectUrl:f.objectURL,isContainer:true,containerID:f.parentID,containerType:f.parentType,searchPlaceholderKey:jive.i18n.jsGetMsg("place.picker.move.search.project")})})}if(this.canManageContainer){this.deleteControls=new jive.Modalizer.Main({liveTriggers:["#jive-place-link-manage-delete"],width:"narrow"})}this.jiveFollow=new jive.FollowApp.Main({objectType:containerType,objectID:containerID,featureName:g.placeI18nKeyPrefix,i18n:this.i18n});if(this.membershipSupported){this.jiveMembership=new jive.MembershipApp.Main({objectID:containerID})}f.customControls=new c();f.customControls.addListener("load",this.modalLoader(""));b.listen("showPlaceBackgroundMenu",function(j){var i=new a(d(this),j.staticResourcesEnabled,j.availableDefaultBannerImages)}.curry(this));d(function(){f.menuView=new jive.MenuView(function(){return d("#j-place-manage-container")},"#jive-place-link-manage",{darkPopover:true,destroyOnClose:false,hoverSelection:true});d("#j-place-manage-container").click(function(i){f.menuView.close()}).on("close",function(){d(this).find(".j-selected").removeClass("j-selected")});new jive.EmailNotification.Main(g.id,g.objectType)})};e.modalLoader=function(g,h){var f=this;return function(m,j,l){var k=d.extend({containerType:f.objectType,container:f.objectID},h);if(typeof l=="undefined"){l=m;m=null}if(m){k.editID=m}if(!g&&j){g=j}var i=$j.deparam.querystring(g);if(i.hasOwnProperty("container")&&i.hasOwnProperty("containerType")){delete k.containerType;delete k.container}d.get(jive.app.url({path:g}),k,function(n){l.emitSuccess(n)})}}})});
;
goog.provide("jive.place.head");
jive.place.head=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;var availableDefaultBannerImages__soy3=opt_data.editPlaceForm.availableDefaultBannerImages;jive.shared.soy.resourceInlineJs({code:"require(['apps/places/actions/main', 'apps/places/manage/main', 'apps/modalizer/main'], function(Actions, Manage, Modalizer) {var manage = new Manage("+soy.$$filterNoAutoescape(JSON.stringify(opt_data.place).replace(/</g,"\\u003C").replace(/>/g,"\\u003E").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,
"\\u2029"))+", {canManageAnnouncements: "+(opt_data.canManageAnnouncements?"true":"false")+", canCreateByEmail: "+(opt_data.canCreateByEmail?"true":"false")+", canManageCategories: "+(opt_data.canManageCategories?"true":"false")+", canMoveContainer: "+(opt_data.canMoveContainer?"true":"false")+", canManageContainer: "+(opt_data.canManageContainer?"true":"false")+", i18n: "+soy.$$filterNoAutoescape(JSON.stringify(function(){var map={};var pairs=[["startFollowing",jive.i18n.i18nText(jive.i18n.getMsg(opt_data.place.placeI18nKeyPrefix+
".startFollow.desc"),[])],["stopFollowing",jive.i18n.i18nText(jive.i18n.getMsg(opt_data.place.placeI18nKeyPrefix+".stopFollow.desc"),[])],["followError",jive.i18n.i18nText(jive.i18n.getMsg("global.follow.error"),[])]];for(var i=0;i<pairs.length;i+=1)map[pairs[i][0]]=pairs[i][1];return map}()).replace(/</g,"\\u003C").replace(/>/g,"\\u003E").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029"))+", staticResourcesEnabled : "+soy.$$escapeHtml(opt_data.staticResourcesEnabled)+", availableDefaultBannerImages: "+
soy.$$filterNoAutoescape(JSON.stringify(availableDefaultBannerImages__soy3).replace(/</g,"\\u003C").replace(/>/g,"\\u003E").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029"))+"}); new Actions("+soy.$$filterNoAutoescape(JSON.stringify(opt_data.place).replace(/</g,"\\u003C").replace(/>/g,"\\u003E").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029"))+"); new Modalizer({liveTriggers:['#jive-place-link-about'], width: 'wide', classes: 'j-pop j-place-about-info'});});"},output);jive.invite.jsInit({container_id:opt_data.place.id,
container_type:opt_data.place.objectType,showNow:opt_data.showInviter,trigger:"#jive-place-link-actions-invite",trackingID:""},output);output.append('<link rel="stylesheet" href="',soy.$$escapeHtml(jive.soy.func.resourceUrl(window._jive_base_url,"/9.0.5.998b920/","//files1.element14.com/community","/styles/jive-customization-controls.css")),'" type="text/css" media="all" /><link rel="stylesheet" href="',soy.$$escapeHtml(jive.soy.func.resourceUrl(window._jive_base_url,"/9.0.5.998b920/","//files1.element14.com/community",
"/styles/jive-places.css")),'" type="text/css" media="all" /><div id="place-background-image"',opt_data.headerSettings!=null?'data-header-settings="'+soy.$$escapeHtml(JSON.stringify(opt_data.headerSettings).replace(/</g,"\\u003C").replace(/>/g,"\\u003E").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029"))+'"':"",">");if(opt_data.headerSettings!=null)jive.integration.backgroundImage(opt_data.headerSettings,output);output.append("</div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.shared.soy.actionLink");
jive.shared.soy.actionLink=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;var name__soy3=new soy.StringBuilder(opt_data.label?soy.$$escapeHtml(opt_data.label):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(opt_data.nameKey),[])));name__soy3=name__soy3.toString();output.append("<a ",opt_data.id?'id="'+soy.$$escapeHtml(opt_data.id)+'"':"",' href="',soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.url,opt_data.urlParams)),'" class="',opt_data.linkCss?
soy.$$escapeHtml(opt_data.linkCss):"",opt_data.activeTab?" j-ui-elem":"",'"',opt_data.urlParams&&opt_data.urlParams.contentType?'data-content-type="'+soy.$$escapeHtml(opt_data.urlParams.contentType)+'"':"",opt_data.urlParams&&opt_data.urlParams.containerType?'data-container-type="'+soy.$$escapeHtml(opt_data.urlParams.containerType)+'"':"",opt_data.ariaDisabled?' aria-disabled="true"':"",opt_data.target?' target="'+soy.$$escapeHtml(opt_data.target)+'"':"",">",!opt_data.hideIcon?'<span class="'+(opt_data.iconCss?
soy.$$escapeHtml(opt_data.iconCss):"")+" jive-icon-"+(opt_data.iconSize?soy.$$escapeHtml(opt_data.iconSize):"med")+'">'+(opt_data.icon?'<img alt="" src="'+soy.$$escapeHtml(opt_data.icon)+'"/>':"")+"</span>":"",'<span class="lnk">',soy.$$filterNoAutoescape(name__soy3),"</span>",opt_data.includeCounter?' <span class="j-js-newCount j-rc5" style="display:none">'+(opt_data.count?soy.$$escapeHtml(opt_data.count):"0")+"</span>":"","</a>");return opt_sb?"":output.toString()};
;
goog.provide("jive.announcements.buildEditLinkByIds");
jive.announcements.buildEditLinkByIds=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<a href="',opt_data.containerType&&opt_data.containerId?soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/edit-announcements.jspa?announcementId="+opt_data.announcementId+"&containerType="+opt_data.containerType+"&containerID="+opt_data.containerId))):soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/edit-announcements.jspa?announcementId="+
opt_data.announcementId))),'" class="js-editLink">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("announcement.manage.edit.title"),[])),'<span class="j-508-label">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.announcement"),[]))," ",soy.$$escapeHtml(opt_data.announcementSubject),"</span></a>");return opt_sb?"":output.toString()};
;
jive.namespace("AnnouncementsAction");jive.AnnouncementsAction.ActionView=jive.AbstractView.extend(function(a){var b=jQuery;this.init=function(d){var c=this;$j(".announcement-expire").bind("click",function(f){var g=$j(this).attr("data-object-id");c.emitP("expire",g).addCallback(function(e){window.location.reload()})});$j(".announcement-remove").bind("click",function(f){var g=$j(this).attr("data-object-id");c.emitP("remove",g).addCallback(function(e){window.location.reload()})});$j(".announcement-dismiss").bind("click",function(f){var g=$j(this).attr("data-object-id");$j("#jive-body-announcements-dismiss-"+g).fadeIn(3000,function(){c.emitP("dismiss",g).addCallback(function(e){window.location.reload()})});$j(".jive-alert-userRemove-message").hide();$j("#jive-body-announcements-expire-"+g).hide();$j("#jive-body-announcements-delete-"+g).hide()})}});define("apps/announcements/action/views/announcement_action_view",function(){return jive.AnnouncementsAction.ActionView});
;
jive.namespace("Announcements");define("apps/announcements/announcement_service",["apps/shared/models/rest_service"],function(a){jive.Announcements.Source=a.extend(function(b,c){b.resourceType="announcement";this.init=function(d){c.init.call(this);this.suppressGenericErrorMessages()};this.expire=function(d){return this.commonAjaxRequest(new jive.conc.Promise(),"POST",{url:this.RESOURCE_ENDPOINT+"/expire/"+d})};this.dismiss=function(d){return this.commonAjaxRequest(new jive.conc.Promise(),"POST",{url:this.RESOURCE_ENDPOINT+"/dismiss/"+d})};this.showGenericSaveError=function(){this.displayError(this.errorSaving())};this.findAll=function(d){return c.findAll.call(this,jQuery.extend({nonce:(new Date()).getTime()},d))}});return jive.Announcements.Source});
;
jive.namespace("AnnouncementsAction");jive.AnnouncementsAction.Main=jive.oo.Class.extend(function(a){this.init=function(c){var b=this;b.view=new jive.AnnouncementsAction.ActionView(c);b.source=new jive.Announcements.Source();b.view.addListener("expire",function(e,d){b.source.expire(e).addCallback(function(){d.emitSuccess()})});b.view.addListener("remove",function(e,d){b.source.destroy(e).addCallback(function(){d.emitSuccess()})});b.view.addListener("dismiss",function(e,d){b.source.dismiss(e).addCallback(function(){d.emitSuccess()})})}});define("apps/announcements/action/main",function(){return jive.AnnouncementsAction.Main});
;
goog.provide("jive.announcements.list");
jive.announcements.list=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.announcements&&opt_data.announcements.length>0){output.append('<div id="jive-alert" role="marquee" class="clearfix ',opt_data.announcements.length>1?"j-multi-announcements":"",'">');jive.shared.soy.resourceInlineJs({code:"$j(document).ready( function() {var jiveAnnouncementsAction = new jive.AnnouncementsAction.Main();});"},output);var annList13=opt_data.announcements;var annListLen13=annList13.length;
for(var annIndex13=0;annIndex13<annListLen13;annIndex13++){var annData13=annList13[annIndex13];output.append('<span id="j-announcement-',soy.$$escapeHtmlAttribute(annIndex13+1),'" class="j-508-label">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("anncmt.announcement.gtitle"),[]))," ",soy.$$escapeHtml(annIndex13+1)," ",soy.$$filterNoAutoescape(annData13.subject),'</span><div class="jive-alert-type jive-alert-announcement" id="jive-alert-',soy.$$escapeHtmlAttribute(annIndex13+1),'" aria-labelledby="j-announcement-',
soy.$$escapeHtmlAttribute(annIndex13+1),'" tabindex="0"',!(annIndex13==0)?'style="display: none;"':"",'><div class="jive-alert-header"><h5 class="jive-alert-title"><span class="jive-alert-label jive-alert-announcement-label"><span class="jive-icon-med jive-icon-announcement"></span>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("anncmt.announcement.gtitle.colon"),[])),'</span><span class="jive-alert-title-text">',annData13.subjectURI?'<a href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(annData13.subjectURI))+
'">':"",soy.$$filterNoAutoescape(annData13.subject),annData13.subjectURI?"</a>":"",'</span></h5><ul><li class="jive-alert-details-show" id="jive-alert-details-show-',soy.$$escapeHtmlAttribute(annIndex13+1),'"><a href="#" onclick="showAlertContent(); return false;" class="font-color-meta-light">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.show_details"),[])),'</a></li><li class="jive-alert-details-hide" id="jive-alert-details-hide-',soy.$$escapeHtmlAttribute(annIndex13+1),'" style="display: none;"><a href="#" onclick="hideAlertContent(); return false;" class="font-color-meta-light">',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.hide_details"),[])),'</a></li></ul></div><div class="jive-alert-content" id="jive-alert-content-',soy.$$escapeHtmlAttribute(annIndex13+1),'" style="display: none;"><div id="jive-announcements-links-',soy.$$escapeHtmlAttribute(annData13.id),'" class="jive-alert-details font-color-meta">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("jivemacro.announcement.by_author.w_date"),[annData13.user.displayName,annData13.creationDate?_jive_moment(parseFloat(annData13.creationDate)?
parseFloat(annData13.creationDate):annData13.creationDate).add(_jive_timezoneoffset*60*60*1E3).lang(_jive_locale.toLowerCase().replace("_","-")).format("LL"):""])),"<span>");if(annData13.canEdit){jive.announcements.buildEditLinkByIds(soy.$$augmentMap(opt_data,{announcementId:annData13.id,announcementSubject:annData13.subject}),output);output.append(!annData13.expired?'<a href="#" onclick="$j(\'#jive-body-announcements-expire-'+soy.$$escapeHtmlAttribute(soy.$$escapeJsString(annData13.id))+"').show(); $j('#jive-body-announcements-delete-"+
soy.$$escapeHtmlAttribute(soy.$$escapeJsString(annData13.id))+"').hide(); $j('#jive-body-announcements-dismiss-"+soy.$$escapeHtmlAttribute(soy.$$escapeJsString(annData13.id))+"').hide(); return false;\">"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.expire"),[]))+"</a>":"",'<a href="#" onclick="$j(\'#jive-body-announcements-delete-',soy.$$escapeHtmlAttribute(soy.$$escapeJsString(annData13.id)),"').show(); $j('#jive-body-announcements-expire-",soy.$$escapeHtmlAttribute(soy.$$escapeJsString(annData13.id)),
"').hide(); $j('#jive-body-announcements-dismiss-",soy.$$escapeHtmlAttribute(soy.$$escapeJsString(annData13.id)),"').hide(); return false;\">",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.delete"),[])),"</a>")}output.append("</span></div>",annData13.image?'<img src="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(annData13.image))+'?width=150&height=90" class="j-announcement-overview-image" title="'+soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("anncmt.overview.image.text"),
[]))+'" alt="'+soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("anncmt.overview.image.text"),[]))+'" />':"",soy.$$filterNoAutoescape(annData13.body),'<div class="jive-body-announcements-confirm" id="jive-body-announcements-expire-',soy.$$escapeHtmlAttribute(annData13.id),'" style="display: none;"><p>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("announcement.confirm.expiration.text"),[])),'</p><form><input type="button" name="delete" value="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("anncmt.expire_announcemt.button"),
[])),'" class="announcement-expire" data-object-id="',soy.$$escapeHtmlAttribute(annData13.id),'"/><input type="button" name="cancel" value="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("global.cancel"),[])),'" onclick="$j(\'#jive-body-announcements-expire-',soy.$$escapeHtmlAttribute(soy.$$escapeJsString(annData13.id)),'\').hide();return false;"/></form></div><div class="jive-body-announcements-confirm" id="jive-body-announcements-delete-',soy.$$escapeHtmlAttribute(annData13.id),
'" style="display: none;"><p>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("jivemacro.confirmDelAncmnt.text"),[])),'</p><form><input type="button" name="delete" value="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("anncmt.del_announcement.button"),[])),'" class="announcement-remove" data-object-id="',soy.$$escapeHtmlAttribute(annData13.id),'"/><input type="button" name="cancel" value="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("global.cancel"),[])),
'" onclick="$j(\'#jive-body-announcements-delete-',soy.$$escapeHtmlAttribute(soy.$$escapeJsString(annData13.id)),"').hide();return false;\"/></form></div>",opt_data.showDismiss?'<div class="jive-alert-userRemove clearfix"><div class="jive-alert-userRemove-message"><a href="#" class="announcement-dismiss" data-object-id="'+soy.$$escapeHtmlAttribute(annData13.id)+'">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("anncmt.dismiss_announcemt.button"),[]))+'</a><span class="font-color-meta">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("anncmt.dismiss_announcemt.text"),
[]))+'</span></div><div class="jive-body-announcements-confirm" id="jive-body-announcements-dismiss-'+soy.$$escapeHtmlAttribute(annData13.id)+'" style="display: none;"><p>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("jivemacro.confirmDismissAncmnt.msg"),[]))+"</p></div></div>":"","</div></div>")}if(opt_data.announcements.length>1){output.append('<span id="jive-alert-counter"><span id="j-anncmt-previous-label" class="j-508-label" aria-hidden="true">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("anncmt.previous.text"),
[])),'</span><a href="#" id="j-anncmt-previous" class="j-anncmt-control font-color-normal" title="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("anncmt.previous.text"),[])),'" aria-labelledby="j-anncmt-previous-label"><span class="jive-icon-glyph icon-arrow-left2"></span></a><span class="j-508-label">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("anncmt.count.text"),[])),'</span><span id="jive-alert-counter-display" class="font-color-meta-light"></span><span id="j-anncmt-next-label" class="j-508-label" aria-hidden="true">',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("anncmt.next.text"),[])),'</span><a href="#" id="j-anncmt-next" class="j-anncmt-control font-color-normal" title="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("anncmt.next.text"),[])),'" aria-labelledby="j-anncmt-next-label"><span class="jive-icon-glyph icon-arrow-right2"></span></a></span>');jive.shared.soy.resourceInlineJs({code:"if(alertCycle) {window.clearInterval(alertCycle);}var alertCycle = window.setInterval(cycleAlerts, 15000); var pauseCycle = false; var currentAlert = 1; var alertCount = "+
soy.$$escapeHtml(opt_data.announcements.length)+"; function shiftAlert(increment) {var newIndex = currentAlert+increment; if (newIndex>alertCount) {newIndex = 1;}else if (newIndex < 1) {newIndex = alertCount;}showAlert(newIndex); $j('#jive-alert-' + newIndex).focus();}function cycleAlerts() {if (!pauseCycle) {currentAlert++; if (currentAlert > alertCount) {currentAlert = 1;}showAlert(currentAlert);}}function showAlert(index) {$j('.jive-alert-type').hide(); $j('#jive-alert-' + index).show(); $j('.jive-alert-count').removeClass('jive-alert-count-active'); $j('#jive-alert-count-' + index).addClass('jive-alert-count-active'); currentAlert = index; $j(\"#jive-alert-counter-display\").text(currentAlert+\"/\"+alertCount);}function chooseAlert(index) {clearInterval(alertCycle); showAlert(index);}function showAlertContent() {clearInterval(alertCycle); $j('.jive-alert-details-show').hide(); $j('.jive-alert-details-hide').show(); $j('.jive-alert-details-hide a').focus(); $j('.jive-alert-content').show();}function hideAlertContent() {clearInterval(alertCycle); $j('.jive-alert-details-hide').hide(); $j('.jive-alert-details-show').show(); $j('.jive-alert-details-show a').focus(); $j('.jive-alert-content').hide();}$j(function() {$j('#jive-alert').off(); $j('#jive-alert').on('mouseover', function(e) { pauseCycle = true; }); $j('#jive-alert').on('mouseout', function(e) { pauseCycle = false; }); $j('#j-anncmt-previous').off(); $j('#j-anncmt-previous').on('click', function(e) { shiftAlert(-1); } ); $j('#j-anncmt-previous').on('keyup', function(e) { if (e.keyCode == 13) shiftAlert(-1); } ); $j('#j-anncmt-next').off(); $j('#j-anncmt-next').on('click', function(e) { shiftAlert(1); } ); $j('#j-anncmt-next').on('keyup', function(e) { if (e.keyCode == 13) shiftAlert(1); } ); showAlert(1);});"},
output)}else jive.shared.soy.resourceInlineJs({code:"function showAlertContent() {$j('#jive-alert-details-show-1').hide(); $j('#jive-alert-details-hide-1').show(); $j('#jive-alert-details-hide-1 a').focus(); $j('#jive-alert-content-1').show();}function hideAlertContent() {$j('#jive-alert-details-hide-1').hide(); $j('#jive-alert-details-show-1').show(); $j('#jive-alert-details-show-1 a').focus(); $j('#jive-alert-content-1').hide();}"},output);output.append("</div>")}return opt_sb?"":output.toString()};
;
goog.provide("jive.shared.displayutil.containerDisplayNameLink");
jive.shared.displayutil.containerDisplayNameLink=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<a href="',soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.container.jiveObjectURL)),'" class="font-color-meta j-container ',!opt_data.hideTooltip?" jivecontainerTT-hover-container":"",'" data-objectId="',soy.$$escapeHtml(opt_data.container.id),'" data-objectType="',soy.$$escapeHtml(opt_data.container.type),'">',opt_data.container.typeSocialGroup?
soy.$$filterNoAutoescape(opt_data.container.name):opt_data.container.typeUserContainer&&opt_data.container.typeWallEntry?soy.$$filterNoAutoescape(jive.i18n.i18nText(jive.i18n.getMsg("activity.in_user_container2.we"),[opt_data.container.userDisplayName])):opt_data.container.typeUserContainer?soy.$$filterNoAutoescape(opt_data.container.userDisplayName):soy.$$filterNoAutoescape(opt_data.container.name),"</a>");return opt_sb?"":output.toString()};
;
goog.provide("jive.movecontent.successMessage");
jive.movecontent.successMessage=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="jive-success-box" aria-live="polite" aria-atomic="true"><div><span class="jive-icon-med jive-icon-check"></span>');var param8=new soy.StringBuilder;jive.shared.displayutil.containerDisplayNameLink({container:opt_data.prevContainer},param8);var param11=new soy.StringBuilder;jive.shared.displayutil.containerDisplayNameLink(opt_data,param11);jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("content.mv.success"),
arg0:soy.$$escapeHtml(opt_data.contentTypeName),arg1:param8.toString(),arg2:param11.toString(),noAutoEscape:"true"},output);output.append("</div></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.shared.breadcrumb.breadcrumbIntroText");
jive.shared.breadcrumb.breadcrumbIntroText=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.hasRelationships)jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml(jive.i18n.getMinKey(opt_data.messageKey)),arg0:'<a href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.containerUrl))+'"><span class="'+soy.$$escapeHtmlAttribute(opt_data.containerCss)+'"></span>'+soy.$$escapeHtml(opt_data.containerName)+"</a>",noAutoEscape:true},output);else jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml(jive.i18n.getMinKey(opt_data.messageKey)),
arg0:opt_data.browseFromRootSpace?'<a href="'+(opt_data.browseFilter?soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.browseFilter)):"")+'">':'<a href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.containerUrl))+(opt_data.browseFilter?soy.$$escapeHtmlAttribute(opt_data.browseFilter):"")+'">',arg1:"</a>",arg2:'<a href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.containerUrl))+'"><span class="'+soy.$$escapeHtmlAttribute(opt_data.containerCss)+'"></span>'+
soy.$$escapeHtml(opt_data.containerName)+"</a>",noAutoEscape:true},output);return opt_sb?"":output.toString()};
;
goog.provide("jive.shared.breadcrumb.contextPopover");
jive.shared.breadcrumb.contextPopover=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div id="js-place-parents-container" class="j-pop-main j-menu j-quick-menu j-breadcrumb-popover" style="display: none"><ul class="j-icon-list"><li><a href="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/places"))),'" class="noIcon"><span class="lnk">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.breadcrumb.place.link"),[])),
"</span></a>");if(opt_data.parents.length>0){var parentList10=opt_data.parents;var parentListLen10=parentList10.length;for(var parentIndex10=0;parentIndex10<parentListLen10;parentIndex10++){var parentData10=parentList10[parentIndex10];output.append("<ul><li>",parentData10.viewableByUser?'<a href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,parentData10.objectURL)))+'"><span class="jive-icon-med '+soy.$$escapeHtmlAttribute(parentData10.iconCssClass)+
'"></span><span class="lnk">'+soy.$$escapeHtml(parentData10.name)+"</span></a>":'<span><span class="jive-icon-med '+soy.$$escapeHtmlAttribute(parentData10.iconCssClass)+'"></span>'+soy.$$escapeHtml(parentData10.name)+"</span>",'<span class="jive-icon-glyph icon-angle-down jive-breadcrumb-arrow"></span>')}}output.append('<ul><li><a href="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.place.objectURL))),'" class="last-child"><span class="jive-icon-med ',
soy.$$escapeHtmlAttribute(opt_data.place.iconCssClass),'"></span><span class="lnk">',soy.$$escapeHtml(opt_data.place.name),"</span></a></li></ul>");if(opt_data.parents.length>0){var parentList38=opt_data.parents;var parentListLen38=parentList38.length;for(var parentIndex38=0;parentIndex38<parentListLen38;parentIndex38++){var parentData38=parentList38[parentIndex38];output.append("</li></ul>")}}output.append("</li></ul></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.shared.breadcrumb.placeLinkPopover");jive.shared.breadcrumb.placeLinkPopover=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<span id="js-place-linked-content-container-placeholder"></span><div id="js-place-linked-content-container" class="j-pop-main j-place-linked-content-container js-place-linked-content-container" style="display: none"></div>');return opt_sb?"":output.toString()};
;
goog.provide("jive.shared.breadcrumb.placeLinkBreadcrumb");
jive.shared.breadcrumb.placeLinkBreadcrumb=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.placeLinkCount&&opt_data.placeLinkCount>0&&opt_data.linkedContentType&&opt_data.linkedContentID){output.append(opt_data.legacy?(opt_data.place||opt_data.parents?" "+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.pipe"),[]))+" ":"")+'<a href="#" class="js-place-linked-content-link">'+(opt_data.placeLinkCount==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("contentPlaceRel.browse.breadcrumb.legacy.one.related"),
[opt_data.placeLinkCount])):opt_data.placeLinkCount==2?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("contentPlaceRel.browse.breadcrumb.legacy.two.related"),[opt_data.placeLinkCount])):opt_data.placeLinkCount==3?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("contentPlaceRel.browse.breadcrumb.legacy.three.related"),[opt_data.placeLinkCount])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("contentPlaceRel.browse.breadcrumb.legacy.many.related"),[opt_data.placeLinkCount])))+"</a>":
opt_data.userContainer?"<span>"+(opt_data.linkedContentType!=38?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.pipe"),[])):"")+' <a href="#" class="js-place-linked-content-link">'+(opt_data.placeLinkCount==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("contentPlaceRel.browse.breadcrumb.usercontainer.one.related"),[opt_data.placeLinkCount])):opt_data.placeLinkCount==2?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("contentPlaceRel.browse.breadcrumb.usercontainer.two.related"),
[opt_data.placeLinkCount])):opt_data.placeLinkCount==3?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("contentPlaceRel.browse.breadcrumb.usercontainer.three.related"),[opt_data.placeLinkCount])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("contentPlaceRel.browse.breadcrumb.usercontainer.many.related"),[opt_data.placeLinkCount])))+"</a>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.period"),[]))+"</span>":"<span> "+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("contentPlaceRel.browse.breadcrumb.and"),
[]))+' <a href="#" class="js-place-linked-content-link">'+(opt_data.placeLinkCount==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("contentPlaceRel.browse.breadcrumb.one.related"),[opt_data.placeLinkCount])):opt_data.placeLinkCount==2?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("contentPlaceRel.browse.breadcrumb.two.related"),[opt_data.placeLinkCount])):opt_data.placeLinkCount==3?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("contentPlaceRel.browse.breadcrumb.three.related"),
[opt_data.placeLinkCount])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("contentPlaceRel.browse.breadcrumb.many.related"),[opt_data.placeLinkCount])))+"</a></span>");if(opt_data.renderPopoverContainer)jive.shared.breadcrumb.placeLinkPopover(null,output)}return opt_sb?"":output.toString()};
;
goog.provide("jive.shared.breadcrumb.placeLinkBreadcrumbContainer");
jive.shared.breadcrumb.placeLinkBreadcrumbContainer=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<span id="js-place-link-breadcrumb" data-place-link-count="',opt_data.placeLinkCount?soy.$$escapeHtmlAttribute(opt_data.placeLinkCount):"0",'"',opt_data.linkedContentID?'data-linked-content-id="'+soy.$$escapeHtmlAttribute(opt_data.linkedContentID)+'"':"",opt_data.linkedContentType?'data-linked-content-type="'+soy.$$escapeHtmlAttribute(opt_data.linkedContentType)+'"':
"",opt_data.userContainer?'data-is-usercontainer="'+soy.$$escapeHtmlAttribute(opt_data.userContainer)+'"':"",opt_data.legacy?'data-legacy="'+soy.$$escapeHtmlAttribute(opt_data.legacy)+'"':"",opt_data.place?'data-place="true"':"",opt_data.parents?'data-parents="true"':"",">");jive.shared.breadcrumb.placeLinkBreadcrumb({placeLinkCount:opt_data.placeLinkCount,linkedContentID:opt_data.linkedContentID,linkedContentType:opt_data.linkedContentType,userContainer:opt_data.userContainer,legacy:opt_data.legacy,
place:opt_data.place,parents:opt_data.parents,renderPopoverContainer:true},output);output.append("</span>");return opt_sb?"":output.toString()};
;
goog.provide("jive.shared.breadcrumb.placeLinkPopoverResults");
jive.shared.breadcrumb.placeLinkPopoverResults=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<ul class="j-icon-list">');if(opt_data.places.length>0){var placeList6=opt_data.places;var placeListLen6=placeList6.length;for(var placeIndex6=0;placeIndex6<placeListLen6;placeIndex6++){var placeData6=placeList6[placeIndex6];output.append('<li class="j-shared-place-link">',placeData6.name?'<a href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,placeData6.resources.html.ref)))+
'" class="j-shared-place js-shared-place-link"><span class="jive-icon-big '+soy.$$escapeHtmlAttribute(placeData6.iconCss)+' js-place-link-popover-icon"></span><span class="lnk js-place-link-popover-name">'+soy.$$escapeHtml(placeData6.name)+"</span></a>":"<span>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("contentPlaceRel.browse.breadcrumb.noaccess.placeName"),[]))+"</span>",placeData6.canDeletePlaceRelationship?'<a href="#" class="js-remove-rel-confirm j-remove-share font-color-meta" title="'+
soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("contentPlaceRel.browse.breadcrumb.remove.link"),[]))+'"'+soy.$$filterHtmlAttributes(jive.i18n.i18nText(jive.i18n.getMsg("contentPlaceRel.browse.breadcrumb.remove.link"),[]))+' data-relationship-id="'+soy.$$escapeHtmlAttribute(placeData6.contentPlaceRelationshipID)+'"><span>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("contentPlaceRel.browse.breadcrumb.remove.link"),[]))+"</span></a>":"","</li>")}if(opt_data.placeLinkCount-opt_data.places.length>
0)switch(opt_data.placeLinkCount-opt_data.places.length){case 0:break;case 1:output.append("<li><span>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("contentPlaceRel.browse.breadcrumb.noaccess.one"),[opt_data.placeLinkCount-opt_data.places.length])),"</span></li>");break;case 2:output.append("<li><span>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("contentPlaceRel.browse.breadcrumb.noaccess.two"),[opt_data.placeLinkCount-opt_data.places.length])),"</span></li>");break;case 3:output.append("<li><span>",
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("contentPlaceRel.browse.breadcrumb.noaccess.three"),[opt_data.placeLinkCount-opt_data.places.length])),"</span></li>");break;default:output.append("<li>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("contentPlaceRel.browse.breadcrumb.noaccess.many"),[opt_data.placeLinkCount-opt_data.places.length])),"</li>")}}else output.append("<li>",opt_data.placeLinkCount==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("contentPlaceRel.browse.breadcrumb.noresults.singular"),
[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("contentPlaceRel.browse.breadcrumb.noresults"),[])),"</li>");output.append("</ul>");return opt_sb?"":output.toString()};
;
if(!jive.contentplace_relationship){jive.contentplace_relationship=(function(){var a;require(["jive/dispatcher"],function(b){b.listen("deleteContentPlaceRel",function(c){require(["apps/contentplace_relationship/main"],function(d){a=a||new d();a.deleteRelationship(c)})});b.listen("deleteContentPlaceRelBreadcrumb",function(c){require(["apps/contentplace_relationship/main"],function(d){a=a||new d();a.deleteRelationship(c,function(){})})})});return{}})()};
;
goog.provide("jive.shared.breadcrumb.placeLinkRemoveConfirm");
jive.shared.breadcrumb.placeLinkRemoveConfirm=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-remove-share-confirm">',opt_data.placeLink&&opt_data.placeIconCss&&opt_data.placeName?"<p>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("contentPlaceRel.browse.breadcrumb.remove.confirm.place"),[]))+'&nbsp;</p><p class="clearfix"><a href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.placeLink))+'"><span class="jive-icon-med '+soy.$$escapeHtmlAttribute(opt_data.placeIconCss)+
'"></span>'+soy.$$escapeHtml(opt_data.placeName)+"</a>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.question_mark"),[]))+"</p>":"<p>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("contentPlaceRel.browse.breadcrumb.remove.confirm"),[]))+"</p>",'<a href="#" class="js-remove-rel j-remove-rel-confirm j-btn-global" data-relationship-id="',soy.$$escapeHtmlAttribute(opt_data.relationshipID),'" data-command="deleteContentPlaceRelBreadcrumb" >',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("contentPlaceRel.browse.breadcrumb.remove.confirm.yes"),
[])),'</a><a href="#" class="js-remove-rel-cancel j-remove-rel-confirm close j-btn-global">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("contentPlaceRel.browse.breadcrumb.remove.confirm.no"),[])),"</a></div>");return opt_sb?"":output.toString()};
;
define("breadcrumb",["jquery","apps/shared/models/core_deferred","apps/shared/controllers/localexchange","soy!jive.shared.breadcrumb.placeLinkPopoverResults","soy!jive.shared.breadcrumb.placeLinkBreadcrumb","soy!jive.shared.breadcrumb.placeLinkRemoveConfirm","soy!jive.shared.breadcrumb.breadcrumbIntroText","soy!jive.shared.displayutil.a11yBoundary"],function(f,b,e,d,h,g,a,c){f(function(){f("#js-place-parents-link").on("click",function(n){n.preventDefault();f("#js-place-parents-container").popover({context:f(this),darkPopover:true,destroyOnClose:false,hoverSelection:true})});function i(){f("#js-place-link-breadcrumb").off("click","a.js-place-linked-content-link")}function m(){f("#js-place-link-breadcrumb").on("click","a.js-place-linked-content-link",function(s){s.preventDefault();var p=f("#js-place-linked-content-container");var r=f("#js-place-link-breadcrumb");var q=r.attr("data-linked-content-type");var o=r.attr("data-linked-content-id");var n=f(this);b.getObject(q,o).then(function(u){var t={contentID:""+u.contentID};return b.runQuery(function(v){return v.jive.corev3.places.getPlacesRelatedToContentCount(t)})}).then(function(t){var u=t.content.count;if(u>0){p.empty();p.popover({context:n,darkPopover:true,destroyOnClose:false,hoverSelection:true,onLoad:function(){k(p,f("#js-place-link-breadcrumb"),u)},onClose:function(){p.empty()}})}if(u!=parseInt(r.attr("data-place-link-count"))){j(u,false)}})})}m();function k(p,s,n){var r=s||f("#js-place-link-breadcrumb");var q=r.attr("data-linked-content-type");var o=r.attr("data-linked-content-id");b.getObject(q,o).then(function(u){var t={contentID:""+u.contentID};return b.runQuery(function(v){return v.jive.corev3.places.getPlacesRelatedToContent(t)})}).then(b.slurp).then(function(w){var u=p.children("span");if(u.length==0){var x=c({type:"menu"});var t=c({type:"menu",isEnd:true});p.prepend(x).append(t);u=p.children("span")}var v={places:w,placeLinkCount:n};if(u.length>0){f(u[0]).after(d(v))}l(p)},function(){console.log("retrieving related places failed")})}function l(n){n.find("a.js-remove-rel-confirm").on("click",function(v){var o=f(v.target);if(!o.is("a")){o=o.closest("a")}var p=o.attr("data-relationship-id");var s=o.closest("li").find("a.js-shared-place-link");var u;var t;var r;if(s&&s.length>0){u=s.attr("href");t=s.children("span.js-place-link-popover-icon").attr("class");r=s.children("span.js-place-link-popover-name").text()}var q={relationshipID:p,placeLink:u,placeIconCss:t,placeName:r};n.html(g(q));f("#js-place-link-breadcrumb").on("click","#js-place-linked-content-container a.js-remove-rel-cancel",function(){f("#js-place-linked-content-container-placeholder").click()})})}function j(A,z){var t=f("#js-place-link-breadcrumb");var r=t&&t.length>0;if(r){var v=parseInt(t.attr("data-place-link-count"));var n=parseInt(t.attr("data-linked-content-id"));var q=parseInt(t.attr("data-linked-content-type"));if(typeof v=="number"&&typeof n=="number"&&typeof q=="number"){var B="true"===t.attr("data-is-usercontainer");var s="true"===t.attr("data-legacy");var y="true"===t.attr("data-place");var x="true"===t.attr("data-parents");var u={placeLinkCount:A,linkedContentID:n,linkedContentType:q,userContainer:B,legacy:s,place:y,parents:x,renderPopoverContainer:(v==0)};var p;if(v>0){p=f("#js-place-linked-content-container")}t.attr("data-place-link-count",A);i();t=t.html(h(u));m();if(z){if(v>0){p.empty()}if(A>0){k(p,t,A)}else{p.closest("div.js-pop").remove()}}if(!s&&!B&&(v==0&&A>0||A==0&&v>0)){var w=f("#js-breadcrumb-intro");var o={messageKey:A>0?w.attr("data-has-content-rel-intro-key"):w.attr("data-no-content-rel-intro-key"),hasRelationships:A>0,containerName:w.attr("data-container-display-name"),containerUrl:w.attr("data-container-url-with-context"),containerCss:w.attr("data-container-icon-css"),browseFilter:w.attr("data-content-browse-filter"),browseFromRootSpace:q==18};w.html(a(o))}}else{location.reload()}}else{location.reload()}}e.addListener("content.place.relationship.delete",function(){var p=f("#js-place-link-breadcrumb");var o=p.attr("data-linked-content-type");var n=p.attr("data-linked-content-id");b.getObject(o,n).then(function(r){var q={contentID:""+r.contentID};return b.runQuery(function(s){return s.jive.corev3.places.getPlacesRelatedToContentCount(q)})}).then(function(q){var r=q.content.count;j(r,true)})});e.addListener("content.place.relationship.share.added",function(n,o){b.getObject(n,o).then(function(q){var p={contentID:""+q.contentID};return b.runQuery(function(r){return r.jive.corev3.places.getPlacesRelatedToContentCount(p)})}).then(function(p){var q=p.content.count;j(q,false)})})})});
;
goog.provide("jive.shared.breadcrumb.contextMenu");
jive.shared.breadcrumb.contextMenu=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.place&&!opt_data.userContainer){output.append(' <a  href="#" id="js-place-parents-link" class="j-nav-more jive-icon-glyph icon-angle-down" title="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("browse.breadcrumb.button.label"),[])),'" aria-label="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("browse.breadcrumb.button.label"),[])),'"></a>');jive.shared.breadcrumb.contextPopover(opt_data,
output)}jive.shared.breadcrumb.placeLinkBreadcrumbContainer(opt_data,output);return opt_sb?"":output.toString()};
;
goog.provide("jive.shared.breadcrumb.legacyBreadcrumbs");
jive.shared.breadcrumb.legacyBreadcrumbs=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div id="jive-breadcrumb"><span>');if(opt_data.place){output.append(opt_data.showHomeURL?(opt_data.fullHomeURL?'<a href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.homeURL))+'">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.home"),[]))+"</a>":'<a href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/")))+
soy.$$escapeHtmlAttribute(opt_data.homeURL)+'">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.home"),[]))+"</a>")+(opt_data.separator?" "+soy.$$filterNoAutoescape(opt_data.separator)+" ":""):"",!opt_data.userContainer?"<a "+(!opt_data.link&&opt_data.parents.length==0?'class="jive-breadcrumb-last"':"")+'href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/places")))+'">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.breadcrumb.place.link"),
[]))+"</a>":"<a "+(!opt_data.link&&opt_data.parents.length==0?'class="jive-breadcrumb-last"':"")+'href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/people")))+'">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.breadcrumb.people.link"),[]))+"</a>",opt_data.separator?" "+soy.$$filterNoAutoescape(opt_data.separator)+" ":"");if(opt_data.parents.length>0){var parentList57=opt_data.parents;var parentListLen57=parentList57.length;
for(var parentIndex57=0;parentIndex57<parentListLen57;parentIndex57++){var parentData57=parentList57[parentIndex57];output.append(parentData57.viewableByUser?"<a "+(!opt_data.link&&parentIndex57==parentListLen57-1?'class="jive-breadcrumb-last"':"")+' href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,parentData57.objectURL)))+'">'+soy.$$escapeHtml(parentData57.name)+"</a>":"<span class='jive-breadcrumb-unauthorized"+(!opt_data.link&&parentIndex57==
parentListLen57-1?" jive-breadcrumb-last":"")+"' title='"+soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("community.list.spaces.unauthorized.tooltip"),[]))+"'>"+soy.$$escapeHtml(parentData57.name)+"</span>",opt_data.separator&&!(parentIndex57==parentListLen57-1&&opt_data.placeHeader)?" "+soy.$$filterNoAutoescape(opt_data.separator)+" ":"",!opt_data.placeHeader&&parentIndex57==parentListLen57-1?'<a href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,
opt_data.place.objectURL)))+'">'+soy.$$escapeHtml(opt_data.place.name)+"</a>":"")}}else output.append(!opt_data.placeHeader?'<a href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.place.objectURL)))+'">'+soy.$$escapeHtml(opt_data.place.name)+"</a>":"");output.append(opt_data.link?(opt_data.separator?" "+soy.$$filterNoAutoescape(opt_data.separator)+" ":"")+soy.$$filterNoAutoescape(opt_data.link):"")}jive.shared.breadcrumb.placeLinkBreadcrumbContainer({placeLinkCount:opt_data.placeLinkCount,
linkedContentID:opt_data.linkedContentID,linkedContentType:opt_data.linkedContentType,legacy:true,place:opt_data.place,parents:opt_data.parents,userContainer:opt_data.userContainer},output);output.append("</span></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.shared.breadcrumb.placeHeaderLegacyBreadcrumbs");jive.shared.breadcrumb.placeHeaderLegacyBreadcrumbs=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.shared.breadcrumb.legacyBreadcrumbs(soy.$$augmentMap(opt_data,{placeHeader:true}),output);return opt_sb?"":output.toString()};
;
goog.provide("jive.soy.share.control");
jive.soy.share.control=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<a href="#" class="',opt_data.type=="text"?"share-link j-meta-control lnk ":opt_data.type=="largeButton"?"j-social-action ":"",opt_data.classes?soy.$$escapeHtmlAttribute(opt_data.classes):"",'" title="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("share.link.title"),[])),'" data-command="share" data-object-type="',soy.$$escapeHtmlAttribute(opt_data.objectType),'" data-object-id="',
soy.$$escapeHtmlAttribute(opt_data.objectId),'"',opt_data.contentPlaceRelInfo?'data-relationship-id="'+soy.$$escapeHtmlAttribute(opt_data.contentPlaceRelInfo.relationshipID)+'"':"",">",opt_data.icon?"<span"+(opt_data.type=="smallButton"?' class="j-ui-elem"':"")+'><span class="jive-icon-glyph icon-share2"></span>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.link"),[]))+"</span>":soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.link"),[])),"</a>");return opt_sb?"":output.toString()};
;
goog.provide("jive.place.legacyBreadcrumbs");jive.place.legacyBreadcrumbs=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.legacyBreadcrumb)jive.shared.breadcrumb.placeHeaderLegacyBreadcrumbs(opt_data.breadcrumbBean,output);return opt_sb?"":output.toString()};
;
goog.provide("jive.place.actionsLink");
jive.place.actionsLink=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.placeActionsLink&&opt_data.placeActionsLink.visible?opt_data.suppressTabs?'<div id="'+soy.$$escapeHtmlAttribute(opt_data.placeActionsLink.id)+'-tab"><a '+(opt_data.placeActionsLink.id?'id="'+soy.$$escapeHtmlAttribute(opt_data.placeActionsLink.id)+'"':"")+' href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.placeActionsLink.url,
opt_data.placeActionsLink.urlParams)))+'" class="j-place-button j-ui-elem font-color-white"><span class="j-ui-elem">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(opt_data.placeActionsLink.nameKey),[]))+'<span class="j-nav-more jive-icon-glyph icon-arrow-down2"></span></span></a></div>':opt_data.isButton?'<div id="'+soy.$$escapeHtmlAttribute(opt_data.placeActionsLink.id)+'-tab"><a '+(opt_data.placeActionsLink.id?'id="'+soy.$$escapeHtmlAttribute(opt_data.placeActionsLink.id)+'"':"")+' href="'+
soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.placeActionsLink.url,opt_data.placeActionsLink.urlParams)))+'" class="j-social-button j-rc5 j-button-join j-ui-elem">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(opt_data.placeActionsLink.nameKey),[]))+'<span class="j-nav-more jive-icon-glyph icon-arrow-down2"></span></a></div>':'<li id="'+soy.$$escapeHtmlAttribute(opt_data.placeActionsLink.id)+'-tab"><a '+(opt_data.ariaDisabled?
' aria-disabled="true"':"")+" "+(opt_data.placeActionsLink.id?'id="'+soy.$$escapeHtmlAttribute(opt_data.placeActionsLink.id)+'"':"")+' href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.placeActionsLink.url,opt_data.placeActionsLink.urlParams)))+'">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(opt_data.placeActionsLink.nameKey),[]))+'<span class="j-nav-more jive-icon-glyph icon-arrow-down2"></span></a></li>':"");return opt_sb?
"":output.toString()};
;
goog.provide("jive.place.manageLink");
jive.place.manageLink=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.placeManageLink&&opt_data.placeManageLink.visible?opt_data.suppressTabs?'<div id="'+soy.$$escapeHtmlAttribute(opt_data.placeManageLink.id)+'-tab"><a '+(opt_data.placeManageLink.id?'id="'+soy.$$escapeHtmlAttribute(opt_data.placeManageLink.id)+'"':"")+' href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.placeManageLink.url,
opt_data.placeManageLink.urlParams)))+'" class="j-place-button j-ui-elem"><span class="j-ui-elem font-color-white">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(opt_data.placeManageLink.nameKey),[]))+'<span class="j-nav-more jive-icon-glyph icon-arrow-down2"></span></span></a></div>':opt_data.isButton?'<div id="'+soy.$$escapeHtmlAttribute(opt_data.placeManageLink.id)+'-tab"><a '+(opt_data.placeManageLink.id?'id="'+soy.$$escapeHtmlAttribute(opt_data.placeManageLink.id)+'"':"")+' href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,
opt_data.placeManageLink.url,opt_data.placeManageLink.urlParams)))+'" class="j-social-button j-rc5 j-button-join j-ui-elem">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(opt_data.placeManageLink.nameKey),[]))+'<span class="j-nav-more jive-icon-glyph icon-arrow-down2"></span></a></div>':'<li id="'+soy.$$escapeHtmlAttribute(opt_data.placeManageLink.id)+'-tab"><a '+(opt_data.placeManageLink.id?'id="'+soy.$$escapeHtmlAttribute(opt_data.placeManageLink.id)+'"':"")+' href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,
opt_data.placeManageLink.url,opt_data.placeManageLink.urlParams)))+'"'+(opt_data.ariaDisabled?' aria-disabled="true"':"")+">"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(opt_data.placeManageLink.nameKey),[]))+'<span class="j-nav-more jive-icon-glyph icon-arrow-down2"></span></a></li>':"");return opt_sb?"":output.toString()};
;
goog.provide("jive.place._appActionIcon");
jive.place._appActionIcon=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;switch(opt_data.icon){case "edit":output.append('<span class="jive-icon-glyph icon-edit"></span>');break;case "manage":output.append('<span class="jive-icon-glyph icon-gear"></span>');break;case "move":output.append('<span class="jive-icon-glyph icon-move2"></span>');break;case "add":output.append('<span class="jive-icon-glyph icon-plus-circle2"></span>');break;case "delete":output.append('<span class="jive-icon-glyph icon-minus-circle2"></span>');break;
case "download":output.append('<span class="jive-icon-glyph icon-download"></span>');break;case "flag":output.append('<span class="jive-icon-glyph icon-flag"></span>');break;case "graph":output.append('<span class="jive-icon-glyph icon-stats-up"></span>');break;case "link":output.append('<span class="jive-icon-glyph icon-link"></span>');break;case "create":output.append('<span class="jive-icon-glyph icon-pencil2"></span>');break;default:output.append('<span class="jive-icon-med jive-icon-blank"><img alt="" src="',
soy.$$escapeHtml(opt_data.icon),'" height="16" width="16" /></span>')}return opt_sb?"":output.toString()};
;
goog.provide("jive.place.appActionLink");
jive.place.appActionLink=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<li>");if(opt_data.windowSpec||!opt_data.actionUrl){output.append('<a href="#" rel="nofollow" class="app-action" data-action-id="',soy.$$escapeHtmlAttribute(opt_data.id),'" data-app-url="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.appURL)),'" data-app-uuid="',soy.$$escapeHtmlAttribute(opt_data.appUUID),'" data-app-instance-uuid="',soy.$$escapeHtmlAttribute(opt_data.appInstanceUUID),'" data-name="os-action-link" data-selection-type="',
soy.$$escapeHtmlAttribute(opt_data.templateView.coreAPIType),'" data-label="',soy.$$escapeHtmlAttribute(opt_data.label),'" data-selection-id="',opt_data.templateView.contextObject?soy.$$escapeHtmlAttribute(opt_data.templateView.contextObject.id):"",'" data-action-url="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.actionUrl)),'" data-action-window-spec="',soy.$$escapeHtmlAttribute(opt_data.windowSpec),'" data-view="',opt_data.view?soy.$$escapeHtmlAttribute(opt_data.view):"",'"',opt_data.actionOrigin?
' data-action-origin-enum="'+soy.$$escapeHtmlAttribute(opt_data.actionOrigin)+'"':"",opt_data.tooltip?'title="'+soy.$$escapeHtmlAttribute(opt_data.tooltip)+'"':"",">");jive.place._appActionIcon(opt_data,output);output.append('<span class="lnk">',soy.$$escapeHtml(opt_data.label),"</span></a>")}else{output.append('<a href="',soy.$$escapeHtml(opt_data.actionUrl),'" data-action-id="',soy.$$escapeHtmlAttribute(opt_data.id),'" data-app-url="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.appURL)),
'" data-app-uuid="',soy.$$escapeHtmlAttribute(opt_data.appUUID),'" data-app-instance-uuid="',soy.$$escapeHtmlAttribute(opt_data.appInstanceUUID),'" data-name="os-action-link" data-selection-type="',soy.$$escapeHtmlAttribute(opt_data.templateView.coreAPIType),'" data-label="',soy.$$escapeHtmlAttribute(opt_data.label),'" data-selection-id="',opt_data.templateView.contextObject?soy.$$escapeHtmlAttribute(opt_data.templateView.contextObject.id):"",'" data-action-url="',soy.$$escapeHtml(opt_data.actionUrl),
'"',opt_data.actionOrigin?' data-action-origin-enum="'+soy.$$escapeHtmlAttribute(opt_data.actionOrigin)+'"':"",opt_data.tooltip?'title="'+soy.$$escapeHtmlAttribute(opt_data.tooltip)+'"':'title="'+soy.$$escapeHtmlAttribute(opt_data.label)+'"',">");jive.place._appActionIcon(opt_data,output);output.append('<span class="lnk">',soy.$$escapeHtml(opt_data.label),"</span></a>")}output.append("</li>");return opt_sb?"":output.toString()};
;
goog.provide("jive.place.placeMainNavMenuItem");
jive.place.placeMainNavMenuItem=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.item.visible)if(opt_data.item.nameKey=="place.places.link.space"||opt_data.item.nameKey=="place.places.link.space.subspaces"||opt_data.item.nameKey=="place.places.link.sgroup"){var label__soy7=new soy.StringBuilder(soy.$$escapeHtml(jive.i18n.jsGetMsg(opt_data.item.nameKey,false)));label__soy7=label__soy7.toString();jive.shared.soy.actionLink(soy.$$augmentMap(opt_data.item,{hideIcon:true,
activeTab:opt_data.item.id==opt_data.placeTab,label:label__soy7}),output)}else jive.shared.soy.actionLink(soy.$$augmentMap(opt_data.item,{hideIcon:true,activeTab:opt_data.item.id==opt_data.placeTab}),output);return opt_sb?"":output.toString()};
;
goog.provide("jive.place.placeMainNavMenuPopover");
jive.place.placeMainNavMenuPopover=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<ul class="j-ppExtras-list">');var itemList4=opt_data.menuItems;var itemListLen4=itemList4.length;for(var itemIndex4=0;itemIndex4<itemListLen4;itemIndex4++){var itemData4=itemList4[itemIndex4];output.append("<li ",itemData4.id==opt_data.placeTab?'class="j-tab-selected active"':"",">");jive.place.placeMainNavMenuItem({item:itemData4,placeTab:opt_data.placeTab},output);output.append('<span class="jive-icon-glyph icon-checkmark3 currentPage"></span></li>')}output.append("</ul>");
return opt_sb?"":output.toString()};
;
jive.namespace("places.Nav");define("apps/places/nav/main",["jquery"],function(a){jive.places.Nav.Main=jive.oo.Class.extend(function(b){this.init=function(d){var c=this;c.menuData=d.menuData;c.placeTab=d.placeTab};this.postRender=function(){var c=this;var d=0;c.$upMenu=a("#j-placeMainNav");c.$downMenu=a("#j-pp-main-nav-menu-pop");c.$menuItems=c.$upMenu.find("li");c.$moreBtn=a("#place-main-nav-more");c.$moreBtn.off().on("click",c.showDownMenu.bind(c));c.$menuItems.each(function(){d+=a(this).outerWidth(true);a(this).data("width",d)});c.moreWidth=c.$moreBtn.outerWidth();a(window).resize(c.handleResize.bind(c))};this.showDownMenu=function(g){var c=this;var f=a(g.target);var d=_.reduce(c.$menuItems.not(":visible"),function(h,i){var j=""+a(i).data("id");var e=_.find(c.menuData,function(k){return k.id===j});h.push(e);return h},[]);c.$downMenu.html(jive.place.placeMainNavMenuPopover({menuItems:d,placeTab:c.placeTab}));c.$downMenu.popover({context:f,destroyOnClose:false,putBack:true});g.preventDefault()};this.handleResize=function(){var c=this,d=c.$upMenu.outerWidth(true);c.$menuItems.not(c.$moreBtn).each(function(){var e=a(this).data("width");if(e>d-c.moreWidth){a(this).hide();c.$moreBtn.show()}else{a(this).show();c.$moreBtn.hide()}})}});return jive.places.Nav.Main});
;
goog.provide("jive.place.header");
jive.place.header=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<header class="j-page-header">',opt_data.canManageContainer?'<a href="#" class="j-place-editBg font-color-white" data-command="showPlaceBackgroundMenu" data-menu-id="backgroundMenu" title="'+soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("place.manage.editbg.link"),[]))+'" data-orientation="below"><span class="jive-icon-big jive-icon-editPlaceBg"></span><span class="lnk">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.manage.editbg.link"),
[]))+"</span></a>":"",'<div class="j-placeHdImg">',opt_data.imageURL?'<div class="placeImg" style="background-image: url(\''+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.imageURL)))+'\');"></div><img src="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.imageURL)))+'" alt="" border="0" class="placeImg">':"","</div>",!opt_data.place.partner&&opt_data.place.visibleToPartner?
'<span class="j-browse-external-access"> <em>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("partner.browse.ext_access.header"),[]))+"</em></span>":"",'<div class="j-placeHeaderWrap"><div class="j-placeHeaderInner',!opt_data.legacyBreadcrumb?!opt_data.place.displayParent?" noParent":" showParent":"",'">');jive.place.legacyBreadcrumbs(opt_data,output);output.append('<h1 class="j-placeTitle"><a href="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,
opt_data.place.objectURL))),'" class="font-color-white j-placeName">',opt_data.place.archived?'<span class="font-color-white j-place-archived">['+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.archived"),[]))+"]</span> ":"",soy.$$escapeHtml(opt_data.place.name),"</a>");if(!opt_data.legacyBreadcrumb)if(opt_data.place.displayParent){output.append('<span class="j-page-header-parent">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.in"),[])),' <a href="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,
opt_data.place.parentUrl))),'" class="j-parentPlaceName">',soy.$$escapeHtml(opt_data.place.parentName),"</a>");jive.shared.breadcrumb.contextMenu(opt_data.breadcrumbBean,output);output.append("</span>")}else jive.shared.breadcrumb.contextMenu(opt_data.breadcrumbBean,output);output.append('</h1><div id="j-place-header-actions" class="j-placeHdActions" data-ann="',soy.$$escapeHtmlAttribute(JSON.stringify(opt_data.announcements).replace(/</g,"\\u003C").replace(/>/g,"\\u003E").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,
"\\u2029")),'">');if(!opt_data.place.guest){output.append('<div class="j-js-follow-controls" data-location="content-page" data-streamsassoc="',soy.$$escapeHtmlAttribute(opt_data.place.streamsAssociatedCount),'" aria-live="polite" aria-atomic="true"><a href="#" class="j-place-button font-color-white j-button-follow notlast" id="jive-link-',soy.$$escapeHtmlAttribute(opt_data.place.placeI18nKeyPrefix),'-startFollowing" ',opt_data.place.followed?'style="display: none;"':"",">",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey(opt_data.place.placeI18nKeyPrefix+
".startFollow.link")),[])),' <span class="jive-icon-glyph icon-pulse j-instreamicon"></span></a><a href="#" class="j-place-button font-color-white j-button-following notlast" id="jive-link-',soy.$$escapeHtmlAttribute(opt_data.place.placeI18nKeyPrefix),'-following" ',!opt_data.place.followed?'style="display: none;"':"",">");jive.people.profile.followingAssociatedStreamCount({count:opt_data.place.streamsAssociatedCount,renderLocation:"content-page"},output);output.append("</a></div>",opt_data.place.membershipSupported?
'<a href="#" class="j-place-button font-color-white j-button-join" id="jive-link-joinSocialGroup" '+(!opt_data.place.canJoinPlace?'style="display: none;"':"")+">"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.join.link"),[]))+'</a><a href="#" class="j-place-button font-color-white j-button-leave" id="jive-link-leaveSocialGroup" '+(!opt_data.place.canLeavePlace?'style="display: none;"':"")+">"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.leave.link"),[]))+"</a>":"");
if(opt_data.suppressTabs){jive.place.actionsLink({suppressTabs:opt_data.suppressTabs,isButton:true,placeActionsLink:opt_data.placeActionsLink},output);jive.place.manageLink({suppressTabs:opt_data.suppressTabs,isButton:true,placeManageLink:opt_data.placeManageLink},output)}}output.append('</div></div></div><div class="j-placeNavWrap"><\!-- BEGIN browse place tabs --\>');if(!opt_data.suppressTabs){jive.shared.soy.resourceInlineJs({code:"$j(function() {require(['apps/places/nav/main'], function(PlacesNavMain) {var placeNav = new PlacesNavMain({menuData: "+
soy.$$filterNoAutoescape(JSON.stringify(opt_data.placeTabLinks).replace(/</g,"\\u003C").replace(/>/g,"\\u003E").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029"))+", placeTab: '"+soy.$$escapeHtml(opt_data.place.tab)+"'}); placeNav.postRender();});});"},output);output.append('<nav id="j-placeNav" class="j-placeNav clearfix" role="navigation" aria-label="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("place.subnav.label"),[])),'"><div class="j-placeNavBg"></div><a id="mobile-place-menu" href="#"><span>',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("responsive.more"),[])),'</span></a><ul id="j-placeMainNav" class="j-placeMainNav j-placeLinks">');var itemList127=opt_data.placeTabLinks;var itemListLen127=itemList127.length;for(var itemIndex127=0;itemIndex127<itemListLen127;itemIndex127++){var itemData127=itemList127[itemIndex127];if(itemData127.visible){output.append('<li id="',soy.$$escapeHtmlAttribute(itemData127.id),'-tab" data-id="',soy.$$escapeHtmlAttribute(itemData127.id),'"',itemData127.id==
opt_data.place.tab?' class="j-tab-selected active j-ui-elem"':"",">");jive.shared.soy.actionLink(soy.$$augmentMap(itemData127,{hideIcon:true,activeTab:itemData127.id==opt_data.place.tab}),output);output.append("</li>")}}output.append('<li href="#" id="place-main-nav-more" class="j-place-main-nav-more"><a href="#"><span class="lnk">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.more"),[])),'</span><span class="j-nav-more jive-icon-glyph icon-arrow-down2"></span></a></li></ul><ul id="j-placeActions" class="j-placeActions j-placeLinks">');
jive.place.actionsLink({suppressTabs:false,isButton:false,placeActionsLink:opt_data.placeActionsLink},output);output.append('<li><a id="jive-place-link-about" class="j-placeAboutLink" href="about-place.jspa?containerID=',soy.$$escapeUri(opt_data.place.id),"&containerType=",soy.$$escapeUri(opt_data.place.objectType),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.about.link"),[])),"</a></li>");if(opt_data.sharingEnabled){output.append("<li>");jive.soy.share.control({objectId:opt_data.place.id,
objectType:opt_data.place.objectType,type:"text",icon:false,classes:"j-button-share"},output);output.append("</li>")}if(!opt_data.suppressTabs)jive.place.manageLink({suppressTabs:false,isButton:false,placeManageLink:opt_data.placeManageLink},output);output.append('</ul></nav><div id="j-pp-main-nav-menu-pop" class="j-quick-menu j-menu" style="display:none;"></div><script>(function() {var $upMenu = $j(\'#j-placeMainNav\'), $menuItems = $upMenu.find(\'li\'), $moreBtn = $j(\'#place-main-nav-more\'), upMenuWidth = $upMenu.outerWidth(true), createMenuItemsTotalWidth = 0; $menuItems.each(function() {createMenuItemsTotalWidth += $j(this).outerWidth(true); $j(this).data("width", createMenuItemsTotalWidth);}); var moreWidth = $moreBtn.outerWidth(); $menuItems.not($moreBtn).each(function() {var width = $j(this).data("width"); if (width > upMenuWidth - moreWidth) {$j(this).hide(); $moreBtn.show();} else {$j(this).show(); $moreBtn.hide();}});})();<\/script>')}output.append("</div></header>");
jive.announcements.list({announcements:opt_data.announcements,showDismiss:false},output);if(opt_data.moveData)jive.movecontent.successMessage(opt_data.moveData,output);output.append("<\!-- Display guest tip if unauthenticated --\>");if(opt_data.place.guest){output.append('<div class="j-guest-tip jive-info-box j-rc5">');if(opt_data.accountCreationEnabled){jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("browse.guesttip.place."+opt_data.place.placeI18nKeyPrefix),arg0:'<a id="jive-guest-link-auth" href="'+
soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/login.jspa")))+'">',arg1:"</a>",noAutoEscape:"true"},output);output.append("&nbsp;");if(opt_data.validationEnabled)jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("browse.guesttip.joinnow"),arg0:'<a href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/login.jspa?registerOnly=true")))+'">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.guesttip.join"),
[]))+"</a>",noAutoEscape:"true"},output);else jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("browse.guesttip.joinnow"),arg0:'<a id="jive-guest-link-reg" href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/create-account.jspa")))+'">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.guesttip.join"),[]))+"</a>",noAutoEscape:"true"},output)}else jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("browse.guesttip.place."+
opt_data.place.placeI18nKeyPrefix),arg0:'<a id="jive-guest-link-auth" href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/login.jspa")))+'"></a>',arg1:"</a>",noAutoEscape:"true"},output);output.append("</div>")}output.append('<\!-- END browse place tabs --\><div id="j-place-actions-container" class="j-quick-menu j-choose-type j-small-view j-menu" style="display: none">');var sectionList239=opt_data.placeActionsMenu.sections;var sectionListLen239=
sectionList239.length;for(var sectionIndex239=0;sectionIndex239<sectionListLen239;sectionIndex239++){var sectionData239=sectionList239[sectionIndex239];if(sectionData239.visible){output.append('<strong class="j-menu-quick-sectionlabel font-color-meta-light">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey(sectionData239.headingI18nKey)),[])),'</strong><ul class="j-place-actions-links j-icon-list">');var itemList245=sectionData239.links;var itemListLen245=itemList245.length;
for(var itemIndex245=0;itemIndex245<itemListLen245;itemIndex245++){var itemData245=itemList245[itemIndex245];if(itemData245.visible)if(itemData245.appAction!=true){output.append("<li>");jive.shared.soy.actionLink(soy.$$augmentMap(itemData245,{iconSize:"med"}),output);output.append("</li>")}else jive.place.appActionLink(soy.$$augmentMap(itemData245,{templateView:opt_data.templateView}),output)}output.append("</ul>")}}output.append('</div><div id="j-place-manage-container" class="j-menu" style="display: none"><ul class="j-place-manage-links">');
var itemList261=opt_data.placeManageLinks;var itemListLen261=itemList261.length;for(var itemIndex261=0;itemIndex261<itemListLen261;itemIndex261++){var itemData261=itemList261[itemIndex261];if(itemData261.visible){output.append("<li>");jive.shared.soy.actionLink(soy.$$augmentMap(itemData261,{hideIcon:true}),output);output.append("</li>")}}output.append("</ul></div>",opt_data.place.canCreateByEmail?'<div class="jive-modal jive-modal-medium jive-author-by-email-modal" id="jive-author-by-email-modal"><header><h2>'+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("author.by.email.modal.title"),[]))+'</h2></header><a href="#" class="j-modal-close-top close">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("author.by.email.modal.close"),[]))+' <span class="j-close-icon j-ui-elem" role="img"></span></a><div class="jive-modal-content" id="vcard-modal"></div></div>':"",opt_data.canManageAnnouncements?'<div class="jive-modal" id="jive-modal-announcements"><header><h2 class="jive-modal-title jive-modal-title-manage-announcements">'+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("announcement.manage.title"),[]))+'</h2><h2 class="jive-modal-title jive-modal-title-add-announcement" style="display: none">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("announcement.manage.add.title"),[]))+'</h2><h2 class="jive-modal-title jive-modal-title-edit-announcement" style="display: none">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("announcement.manage.edit.title"),[]))+'</h2></header><a href="#" class="j-modal-close-top close">'+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close"),[]))+'  <span class="jive-icon-glyph icon-close-med" role="img"></span></a><div id="announcements-modal"></div></div>':"",opt_data.canManageCategories?'<div class="jive-modal jive-modal-wide" id="jive-modal-categories"><header><h2 class="jive-modal-title jive-modal-title-manage-categories">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("category.manage.title"),[]))+'</h2><h2 class="jive-modal-title jive-modal-title-add-category" style="display: none">'+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("category.manage.add.title"),[]))+'</h2><h2 class="jive-modal-title jive-modal-title-edit-category" style="display: none">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("category.manage.edit.title"),[]))+'</h2></header><a href="#" class="j-modal-close-top close">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close"),[]))+'  <span class="jive-icon-glyph icon-close-med" role="img"></span></a><div id="categories-modal"></div></div>':
"",opt_data.place.canArchive?'<\!-- BEGIN archive panel --\><div class="jive-modal" id="jive-modal-archive-project"><header><h2 class="jive-modal-title jive-modal-title-unarchive-project">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("project.unarchive.title"),[]))+'</h2><h2 class="jive-modal-title jive-modal-title-archive-project">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("project.archive.title"),[]))+'</h2></header><section id="archive-modal" class="jive-modal-content jive-modal-archive-project clearfix"></section></div><\!-- END archive panel --\>':
"");return opt_sb?"":output.toString()};
;
/*
 * Copyright (C) 1999-2015 Jive Software. All rights reserved.
 *
 * This software is the proprietary information of Jive Software. Use is subject to license terms.
 */
jive.namespace('EventCalendarApp');

jive.EventCalendarApp.CalendarSource = jive.RestService.extend(function(protect) {
    
    
    this.save = function(eventID, data) {
        var promise = new jive.conc.Promise(),
            source = this;
        
        $j.ajax({
            url: jive.rest.url('/calendar/' + eventID),
            type: 'PUT',
            dataType: 'json',
            data: data,
            success: function() {
                promise.emitSuccess();
            },
            error: source.errorCallback(promise),
            timeout: 30000
        });
        
        return promise;
    };
});
;
goog.provide("jive.event.calendar.moveConfirmation");
jive.event.calendar.moveConfirmation=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="jive-modal j-modal" id="event-calendar-confirm"><header><h2>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.confirm_reschedule.title"),[])),'</h2></header><section class="jive-modal-content clearfix"><p>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.confirm_reschedule.text"),[])),'<p><ul><li><a id="event-calendar-confirm-fullday" class="close" href="#">',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.confirm_reschedule.fullday.link"),[])),'</a></li><li><a id="event-calendar-confirm-asis" class="close" href="#">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.confirm_reschedule.asis.link"),[])),'</a></li><li><a id="event-calendar-confirm-cancel" class="close" href="#">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.cancel"),[])),"</a></li></ul></section></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.event.calendar.resizeConfirmation");
jive.event.calendar.resizeConfirmation=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="jive-modal j-modal" id="event-calendar-confirm"><header><h2>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.confirm_resize.title"),[])),'</h2></header><section class="jive-modal-content clearfix"><p>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("event.calendar.confirm_resize.text"),[])),'<p><ul><li><a id="event-calendar-confirm-continue" class="close" href="#">',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.yes"),[])),'</a></li><li><a id="event-calendar-confirm-cancel" class="close" href="#">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.no"),[])),"</a></li></ul></section></div>");return opt_sb?"":output.toString()};
;
/*
 * Copyright (C) 1999-2015 Jive Software. All rights reserved.
 *
 * This software is the proprietary information of Jive Software. Use is subject to license terms.
 */

/*!

 * FullCalendar v2.9.1
 * Docs & License: http://arshaw.com/fullcalendar/
 * (c) 2016 Adam Shaw
 */

(function(factory) {
    if (typeof define === 'function' && define.amd) {
        define([ 'jquery', 'moment' ], factory);
    }
    else if (typeof exports === 'object') { // Node/CommonJS
        module.exports = factory(require('jquery'), require('moment'));
    }
    else {
        factory(jQuery, moment);
    }
})(function($, moment) {

    ;;

    var FC = $.fullCalendar = {
        version: "<%= meta.version %>",
        internalApiVersion: 5
    };
    var fcViews = FC.views = {};


    $.fn.fullCalendar = function(options) {
        var args = Array.prototype.slice.call(arguments, 1); // for a possible method call
        var res = this; // what this function will return (this jQuery object by default)

        this.each(function(i, _element) { // loop each DOM element involved
            var element = $(_element);
            var calendar = element.data('fullCalendar'); // get the existing calendar object (if any)
            var singleRes; // the returned value of this single method call

            // a method call
            if (typeof options === 'string') {
                if (calendar && $.isFunction(calendar[options])) {
                    singleRes = calendar[options].apply(calendar, args);
                    if (!i) {
                        res = singleRes; // record the first method call result
                    }
                    if (options === 'destroy') { // for the destroy method, must remove Calendar object data
                        element.removeData('fullCalendar');
                    }
                }
            }
            // a new calendar initialization
            else if (!calendar) { // don't initialize twice
                calendar = new Calendar(element, options);
                element.data('fullCalendar', calendar);
                calendar.render();
            }
        });

        return res;
    };


    var complexOptions = [ // names of options that are objects whose properties should be combined
        'header',
        'buttonText',
        'buttonIcons',
        'themeButtonIcons'
    ];


// Merges an array of option objects into a single object
    function mergeOptions(optionObjs) {
        return mergeProps(optionObjs, complexOptions);
    }


// Given options specified for the calendar's constructor, massages any legacy options into a non-legacy form.
// Converts View-Option-Hashes into the View-Specific-Options format.
    function massageOverrides(input) {
        var overrides = { views: input.views || {} }; // the output. ensure a `views` hash
        var subObj;

        // iterate through all option override properties (except `views`)
        $.each(input, function(name, val) {
            if (name != 'views') {

                // could the value be a legacy View-Option-Hash?
                if (
                    $.isPlainObject(val) &&
                    !/(time|duration|interval)$/i.test(name) && // exclude duration options. might be given as objects
                    $.inArray(name, complexOptions) == -1 // complex options aren't allowed to be View-Option-Hashes
                ) {
                    subObj = null;

                    // iterate through the properties of this possible View-Option-Hash value
                    $.each(val, function(subName, subVal) {

                        // is the property targeting a view?
                        if (/^(month|week|day|default|basic(Week|Day)?|agenda(Week|Day)?)$/.test(subName)) {
                            if (!overrides.views[subName]) { // ensure the view-target entry exists
                                overrides.views[subName] = {};
                            }
                            overrides.views[subName][name] = subVal; // record the value in the `views` object
                        }
                        else { // a non-View-Option-Hash property
                            if (!subObj) {
                                subObj = {};
                            }
                            subObj[subName] = subVal; // accumulate these unrelated values for later
                        }
                    });

                    if (subObj) { // non-View-Option-Hash properties? transfer them as-is
                        overrides[name] = subObj;
                    }
                }
                else {
                    overrides[name] = val; // transfer normal options as-is
                }
            }
        });

        return overrides;
    }

    ;;

// exports
    FC.intersectRanges = intersectRanges;
    FC.applyAll = applyAll;
    FC.debounce = debounce;
    FC.isInt = isInt;
    FC.htmlEscape = htmlEscape;
    FC.cssToStr = cssToStr;
    FC.proxy = proxy;
    FC.capitaliseFirstLetter = capitaliseFirstLetter;


    /* FullCalendar-specific DOM Utilities
     ----------------------------------------------------------------------------------------------------------------------*/


// Given the scrollbar widths of some other container, create borders/margins on rowEls in order to match the left
// and right space that was offset by the scrollbars. A 1-pixel border first, then margin beyond that.
    function compensateScroll(rowEls, scrollbarWidths) {
        if (scrollbarWidths.left) {
            rowEls.css({
                'border-left-width': 1,
                'margin-left': scrollbarWidths.left - 1
            });
        }
        if (scrollbarWidths.right) {
            rowEls.css({
                'border-right-width': 1,
                'margin-right': scrollbarWidths.right - 1
            });
        }
    }


// Undoes compensateScroll and restores all borders/margins
    function uncompensateScroll(rowEls) {
        rowEls.css({
            'margin-left': '',
            'margin-right': '',
            'border-left-width': '',
            'border-right-width': ''
        });
    }


// Make the mouse cursor express that an event is not allowed in the current area
    function disableCursor() {
        $('body').addClass('fc-not-allowed');
    }


// Returns the mouse cursor to its original look
    function enableCursor() {
        $('body').removeClass('fc-not-allowed');
    }


// Given a total available height to fill, have `els` (essentially child rows) expand to accomodate.
// By default, all elements that are shorter than the recommended height are expanded uniformly, not considering
// any other els that are already too tall. if `shouldRedistribute` is on, it considers these tall rows and
// reduces the available height.
    function distributeHeight(els, availableHeight, shouldRedistribute) {

        // *FLOORING NOTE*: we floor in certain places because zoom can give inaccurate floating-point dimensions,
        // and it is better to be shorter than taller, to avoid creating unnecessary scrollbars.

        var minOffset1 = Math.floor(availableHeight / els.length); // for non-last element
        var minOffset2 = Math.floor(availableHeight - minOffset1 * (els.length - 1)); // for last element *FLOORING NOTE*
        var flexEls = []; // elements that are allowed to expand. array of DOM nodes
        var flexOffsets = []; // amount of vertical space it takes up
        var flexHeights = []; // actual css height
        var usedHeight = 0;

        undistributeHeight(els); // give all elements their natural height

        // find elements that are below the recommended height (expandable).
        // important to query for heights in a single first pass (to avoid reflow oscillation).
        els.each(function(i, el) {
            var minOffset = i === els.length - 1 ? minOffset2 : minOffset1;
            var naturalOffset = $(el).outerHeight(true);

            if (naturalOffset < minOffset) {
                flexEls.push(el);
                flexOffsets.push(naturalOffset);
                flexHeights.push($(el).height());
            }
            else {
                // this element stretches past recommended height (non-expandable). mark the space as occupied.
                usedHeight += naturalOffset;
            }
        });

        // readjust the recommended height to only consider the height available to non-maxed-out rows.
        if (shouldRedistribute) {
            availableHeight -= usedHeight;
            minOffset1 = Math.floor(availableHeight / flexEls.length);
            minOffset2 = Math.floor(availableHeight - minOffset1 * (flexEls.length - 1)); // *FLOORING NOTE*
        }

        // assign heights to all expandable elements
        $(flexEls).each(function(i, el) {
            var minOffset = i === flexEls.length - 1 ? minOffset2 : minOffset1;
            var naturalOffset = flexOffsets[i];
            var naturalHeight = flexHeights[i];
            var newHeight = minOffset - (naturalOffset - naturalHeight); // subtract the margin/padding

            if (naturalOffset < minOffset) { // we check this again because redistribution might have changed things
                $(el).height(newHeight);
            }
        });
    }


// Undoes distrubuteHeight, restoring all els to their natural height
    function undistributeHeight(els) {
        els.height('');
    }


// Given `els`, a jQuery set of <td> cells, find the cell with the largest natural width and set the widths of all the
// cells to be that width.
// PREREQUISITE: if you want a cell to take up width, it needs to have a single inner element w/ display:inline
    function matchCellWidths(els) {
        var maxInnerWidth = 0;

        els.find('> span').each(function(i, innerEl) {
            var innerWidth = $(innerEl).outerWidth();
            if (innerWidth > maxInnerWidth) {
                maxInnerWidth = innerWidth;
            }
        });

        maxInnerWidth++; // sometimes not accurate of width the text needs to stay on one line. insurance

        els.width(maxInnerWidth);

        return maxInnerWidth;
    }


// Given one element that resides inside another,
// Subtracts the height of the inner element from the outer element.
    function subtractInnerElHeight(outerEl, innerEl) {
        var both = outerEl.add(innerEl);
        var diff;

        // effin' IE8/9/10/11 sometimes returns 0 for dimensions. this weird hack was the only thing that worked
        both.css({
            position: 'relative', // cause a reflow, which will force fresh dimension recalculation
            left: -1 // ensure reflow in case the el was already relative. negative is less likely to cause new scroll
        });
        diff = outerEl.outerHeight() - innerEl.outerHeight(); // grab the dimensions
        both.css({ position: '', left: '' }); // undo hack

        return diff;
    }


    /* Element Geom Utilities
     ----------------------------------------------------------------------------------------------------------------------*/

    FC.getOuterRect = getOuterRect;
    FC.getClientRect = getClientRect;
    FC.getContentRect = getContentRect;
    FC.getScrollbarWidths = getScrollbarWidths;


// borrowed from https://github.com/jquery/jquery-ui/blob/1.11.0/ui/core.js#L51
    function getScrollParent(el) {
        var position = el.css('position'),
            scrollParent = el.parents().filter(function() {
                var parent = $(this);
                return (/(auto|scroll)/).test(
                    parent.css('overflow') + parent.css('overflow-y') + parent.css('overflow-x')
                );
            }).eq(0);

        return position === 'fixed' || !scrollParent.length ? $(el[0].ownerDocument || document) : scrollParent;
    }


// Queries the outer bounding area of a jQuery element.
// Returns a rectangle with absolute coordinates: left, right (exclusive), top, bottom (exclusive).
// Origin is optional.
    function getOuterRect(el, origin) {
        var offset = el.offset();
        var left = offset.left - (origin ? origin.left : 0);
        var top = offset.top - (origin ? origin.top : 0);

        return {
            left: left,
            right: left + el.outerWidth(),
            top: top,
            bottom: top + el.outerHeight()
        };
    }


// Queries the area within the margin/border/scrollbars of a jQuery element. Does not go within the padding.
// Returns a rectangle with absolute coordinates: left, right (exclusive), top, bottom (exclusive).
// Origin is optional.
// NOTE: should use clientLeft/clientTop, but very unreliable cross-browser.
    function getClientRect(el, origin) {
        var offset = el.offset();
        var scrollbarWidths = getScrollbarWidths(el);
        var left = offset.left + getCssFloat(el, 'border-left-width') + scrollbarWidths.left - (origin ? origin.left : 0);
        var top = offset.top + getCssFloat(el, 'border-top-width') + scrollbarWidths.top - (origin ? origin.top : 0);

        return {
            left: left,
            right: left + el[0].clientWidth, // clientWidth includes padding but NOT scrollbars
            top: top,
            bottom: top + el[0].clientHeight // clientHeight includes padding but NOT scrollbars
        };
    }


// Queries the area within the margin/border/padding of a jQuery element. Assumed not to have scrollbars.
// Returns a rectangle with absolute coordinates: left, right (exclusive), top, bottom (exclusive).
// Origin is optional.
    function getContentRect(el, origin) {
        var offset = el.offset(); // just outside of border, margin not included
        var left = offset.left + getCssFloat(el, 'border-left-width') + getCssFloat(el, 'padding-left') -
            (origin ? origin.left : 0);
        var top = offset.top + getCssFloat(el, 'border-top-width') + getCssFloat(el, 'padding-top') -
            (origin ? origin.top : 0);

        return {
            left: left,
            right: left + el.width(),
            top: top,
            bottom: top + el.height()
        };
    }


// Returns the computed left/right/top/bottom scrollbar widths for the given jQuery element.
// NOTE: should use clientLeft/clientTop, but very unreliable cross-browser.
    function getScrollbarWidths(el) {
        var leftRightWidth = el.innerWidth() - el[0].clientWidth; // the paddings cancel out, leaving the scrollbars
        var widths = {
            left: 0,
            right: 0,
            top: 0,
            bottom: el.innerHeight() - el[0].clientHeight // the paddings cancel out, leaving the bottom scrollbar
        };

        if (getIsLeftRtlScrollbars() && el.css('direction') == 'rtl') { // is the scrollbar on the left side?
            widths.left = leftRightWidth;
        }
        else {
            widths.right = leftRightWidth;
        }

        return widths;
    }


// Logic for determining if, when the element is right-to-left, the scrollbar appears on the left side

    var _isLeftRtlScrollbars = null;

    function getIsLeftRtlScrollbars() { // responsible for caching the computation
        if (_isLeftRtlScrollbars === null) {
            _isLeftRtlScrollbars = computeIsLeftRtlScrollbars();
        }
        return _isLeftRtlScrollbars;
    }

    function computeIsLeftRtlScrollbars() { // creates an offscreen test element, then removes it
        var el = $('<div><div/></div>')
            .css({
                position: 'absolute',
                top: -1000,
                left: 0,
                border: 0,
                padding: 0,
                overflow: 'scroll',
                direction: 'rtl'
            })
            .appendTo('body');
        var innerEl = el.children();
        var res = innerEl.offset().left > el.offset().left; // is the inner div shifted to accommodate a left scrollbar?
        el.remove();
        return res;
    }


// Retrieves a jQuery element's computed CSS value as a floating-point number.
// If the queried value is non-numeric (ex: IE can return "medium" for border width), will just return zero.
    function getCssFloat(el, prop) {
        return parseFloat(el.css(prop)) || 0;
    }


    /* Mouse / Touch Utilities
     ----------------------------------------------------------------------------------------------------------------------*/

    FC.preventDefault = preventDefault;


// Returns a boolean whether this was a left mouse click and no ctrl key (which means right click on Mac)
    function isPrimaryMouseButton(ev) {
        return ev.which == 1 && !ev.ctrlKey;
    }


    function getEvX(ev) {
        if (ev.pageX !== undefined) {
            return ev.pageX;
        }
        var touches = ev.originalEvent.touches;
        if (touches) {
            return touches[0].pageX;
        }
    }


    function getEvY(ev) {
        if (ev.pageY !== undefined) {
            return ev.pageY;
        }
        var touches = ev.originalEvent.touches;
        if (touches) {
            return touches[0].pageY;
        }
    }


    function getEvIsTouch(ev) {
        return /^touch/.test(ev.type);
    }


    function preventSelection(el) {
        el.addClass('fc-unselectable')
            .on('selectstart', preventDefault);
    }


// Stops a mouse/touch event from doing it's native browser action
    function preventDefault(ev) {
        ev.preventDefault();
    }


// attach a handler to get called when ANY scroll action happens on the page.
// this was impossible to do with normal on/off because 'scroll' doesn't bubble.
// http://stackoverflow.com/a/32954565/96342
// returns `true` on success.
    function bindAnyScroll(handler) {
        if (window.addEventListener) {
            window.addEventListener('scroll', handler, true); // useCapture=true
            return true;
        }
        return false;
    }


// undoes bindAnyScroll. must pass in the original function.
// returns `true` on success.
    function unbindAnyScroll(handler) {
        if (window.removeEventListener) {
            window.removeEventListener('scroll', handler, true); // useCapture=true
            return true;
        }
        return false;
    }


    /* General Geometry Utils
     ----------------------------------------------------------------------------------------------------------------------*/

    FC.intersectRects = intersectRects;

// Returns a new rectangle that is the intersection of the two rectangles. If they don't intersect, returns false
    function intersectRects(rect1, rect2) {
        var res = {
            left: Math.max(rect1.left, rect2.left),
            right: Math.min(rect1.right, rect2.right),
            top: Math.max(rect1.top, rect2.top),
            bottom: Math.min(rect1.bottom, rect2.bottom)
        };

        if (res.left < res.right && res.top < res.bottom) {
            return res;
        }
        return false;
    }


// Returns a new point that will have been moved to reside within the given rectangle
    function constrainPoint(point, rect) {
        return {
            left: Math.min(Math.max(point.left, rect.left), rect.right),
            top: Math.min(Math.max(point.top, rect.top), rect.bottom)
        };
    }


// Returns a point that is the center of the given rectangle
    function getRectCenter(rect) {
        return {
            left: (rect.left + rect.right) / 2,
            top: (rect.top + rect.bottom) / 2
        };
    }


// Subtracts point2's coordinates from point1's coordinates, returning a delta
    function diffPoints(point1, point2) {
        return {
            left: point1.left - point2.left,
            top: point1.top - point2.top
        };
    }


    /* Object Ordering by Field
     ----------------------------------------------------------------------------------------------------------------------*/

    FC.parseFieldSpecs = parseFieldSpecs;
    FC.compareByFieldSpecs = compareByFieldSpecs;
    FC.compareByFieldSpec = compareByFieldSpec;
    FC.flexibleCompare = flexibleCompare;


    function parseFieldSpecs(input) {
        var specs = [];
        var tokens = [];
        var i, token;

        if (typeof input === 'string') {
            tokens = input.split(/\s*,\s*/);
        }
        else if (typeof input === 'function') {
            tokens = [ input ];
        }
        else if ($.isArray(input)) {
            tokens = input;
        }

        for (i = 0; i < tokens.length; i++) {
            token = tokens[i];

            if (typeof token === 'string') {
                specs.push(
                    token.charAt(0) == '-' ?
                        { field: token.substring(1), order: -1 } :
                        { field: token, order: 1 }
                );
            }
            else if (typeof token === 'function') {
                specs.push({ func: token });
            }
        }

        return specs;
    }


    function compareByFieldSpecs(obj1, obj2, fieldSpecs) {
        var i;
        var cmp;

        for (i = 0; i < fieldSpecs.length; i++) {
            cmp = compareByFieldSpec(obj1, obj2, fieldSpecs[i]);
            if (cmp) {
                return cmp;
            }
        }

        return 0;
    }


    function compareByFieldSpec(obj1, obj2, fieldSpec) {
        if (fieldSpec.func) {
            return fieldSpec.func(obj1, obj2);
        }
        return flexibleCompare(obj1[fieldSpec.field], obj2[fieldSpec.field]) *
            (fieldSpec.order || 1);
    }


    function flexibleCompare(a, b) {
        if (!a && !b) {
            return 0;
        }
        if (b == null) {
            return -1;
        }
        if (a == null) {
            return 1;
        }
        if ($.type(a) === 'string' || $.type(b) === 'string') {
            return String(a).localeCompare(String(b));
        }
        return a - b;
    }


    /* FullCalendar-specific Misc Utilities
     ----------------------------------------------------------------------------------------------------------------------*/


// Computes the intersection of the two ranges. Returns undefined if no intersection.
// Expects all dates to be normalized to the same timezone beforehand.
// TODO: move to date section?
    function intersectRanges(subjectRange, constraintRange) {
        var subjectStart = subjectRange.start;
        var subjectEnd = subjectRange.end;
        var constraintStart = constraintRange.start;
        var constraintEnd = constraintRange.end;
        var segStart, segEnd;
        var isStart, isEnd;

        if (subjectEnd > constraintStart && subjectStart < constraintEnd) { // in bounds at all?

            if (subjectStart >= constraintStart) {
                segStart = subjectStart.clone();
                isStart = true;
            }
            else {
                segStart = constraintStart.clone();
                isStart =  false;
            }

            if (subjectEnd <= constraintEnd) {
                segEnd = subjectEnd.clone();
                isEnd = true;
            }
            else {
                segEnd = constraintEnd.clone();
                isEnd = false;
            }

            return {
                start: segStart,
                end: segEnd,
                isStart: isStart,
                isEnd: isEnd
            };
        }
    }


    /* Date Utilities
     ----------------------------------------------------------------------------------------------------------------------*/

    FC.computeIntervalUnit = computeIntervalUnit;
    FC.divideRangeByDuration = divideRangeByDuration;
    FC.divideDurationByDuration = divideDurationByDuration;
    FC.multiplyDuration = multiplyDuration;
    FC.durationHasTime = durationHasTime;

    var dayIDs = [ 'sun', 'mon', 'tue', 'wed', 'thu', 'fri', 'sat' ];
    var intervalUnits = [ 'year', 'month', 'week', 'day', 'hour', 'minute', 'second', 'millisecond' ];


// Diffs the two moments into a Duration where full-days are recorded first, then the remaining time.
// Moments will have their timezones normalized.
    function diffDayTime(a, b) {
        return moment.duration({
            days: a.clone().stripTime().diff(b.clone().stripTime(), 'days'),
            ms: a.time() - b.time() // time-of-day from day start. disregards timezone
        });
    }


// Diffs the two moments via their start-of-day (regardless of timezone). Produces whole-day durations.
    function diffDay(a, b) {
        return moment.duration({
            days: a.clone().stripTime().diff(b.clone().stripTime(), 'days')
        });
    }


// Diffs two moments, producing a duration, made of a whole-unit-increment of the given unit. Uses rounding.
    function diffByUnit(a, b, unit) {
        return moment.duration(
            Math.round(a.diff(b, unit, true)), // returnFloat=true
            unit
        );
    }


// Computes the unit name of the largest whole-unit period of time.
// For example, 48 hours will be "days" whereas 49 hours will be "hours".
// Accepts start/end, a range object, or an original duration object.
    function computeIntervalUnit(start, end) {
        var i, unit;
        var val;

        for (i = 0; i < intervalUnits.length; i++) {
            unit = intervalUnits[i];
            val = computeRangeAs(unit, start, end);

            if (val >= 1 && isInt(val)) {
                break;
            }
        }

        return unit; // will be "milliseconds" if nothing else matches
    }


// Computes the number of units (like "hours") in the given range.
// Range can be a {start,end} object, separate start/end args, or a Duration.
// Results are based on Moment's .as() and .diff() methods, so results can depend on internal handling
// of month-diffing logic (which tends to vary from version to version).
    function computeRangeAs(unit, start, end) {

        if (end != null) { // given start, end
            return end.diff(start, unit, true);
        }
        else if (moment.isDuration(start)) { // given duration
            return start.as(unit);
        }
        else { // given { start, end } range object
            return start.end.diff(start.start, unit, true);
        }
    }


// Intelligently divides a range (specified by a start/end params) by a duration
    function divideRangeByDuration(start, end, dur) {
        var months;

        if (durationHasTime(dur)) {
            return (end - start) / dur;
        }
        months = dur.asMonths();
        if (Math.abs(months) >= 1 && isInt(months)) {
            return end.diff(start, 'months', true) / months;
        }
        return end.diff(start, 'days', true) / dur.asDays();
    }


// Intelligently divides one duration by another
    function divideDurationByDuration(dur1, dur2) {
        var months1, months2;

        if (durationHasTime(dur1) || durationHasTime(dur2)) {
            return dur1 / dur2;
        }
        months1 = dur1.asMonths();
        months2 = dur2.asMonths();
        if (
            Math.abs(months1) >= 1 && isInt(months1) &&
            Math.abs(months2) >= 1 && isInt(months2)
        ) {
            return months1 / months2;
        }
        return dur1.asDays() / dur2.asDays();
    }


// Intelligently multiplies a duration by a number
    function multiplyDuration(dur, n) {
        var months;

        if (durationHasTime(dur)) {
            return moment.duration(dur * n);
        }
        months = dur.asMonths();
        if (Math.abs(months) >= 1 && isInt(months)) {
            return moment.duration({ months: months * n });
        }
        return moment.duration({ days: dur.asDays() * n });
    }


// Returns a boolean about whether the given duration has any time parts (hours/minutes/seconds/ms)
    function durationHasTime(dur) {
        return Boolean(dur.hours() || dur.minutes() || dur.seconds() || dur.milliseconds());
    }


    function isNativeDate(input) {
        return  Object.prototype.toString.call(input) === '[object Date]' || input instanceof Date;
    }


// Returns a boolean about whether the given input is a time string, like "06:40:00" or "06:00"
    function isTimeString(str) {
        return /^\d+\:\d+(?:\:\d+\.?(?:\d{3})?)?$/.test(str);
    }


    /* Logging and Debug
     ----------------------------------------------------------------------------------------------------------------------*/

    FC.log = function() {
        var console = window.console;

        if (console && console.log) {
            return console.log.apply(console, arguments);
        }
    };

    FC.warn = function() {
        var console = window.console;

        if (console && console.warn) {
            return console.warn.apply(console, arguments);
        }
        else {
            return FC.log.apply(FC, arguments);
        }
    };


    /* General Utilities
     ----------------------------------------------------------------------------------------------------------------------*/

    var hasOwnPropMethod = {}.hasOwnProperty;


// Merges an array of objects into a single object.
// The second argument allows for an array of property names who's object values will be merged together.
    function mergeProps(propObjs, complexProps) {
        var dest = {};
        var i, name;
        var complexObjs;
        var j, val;
        var props;

        if (complexProps) {
            for (i = 0; i < complexProps.length; i++) {
                name = complexProps[i];
                complexObjs = [];

                // collect the trailing object values, stopping when a non-object is discovered
                for (j = propObjs.length - 1; j >= 0; j--) {
                    val = propObjs[j][name];

                    if (typeof val === 'object') {
                        complexObjs.unshift(val);
                    }
                    else if (val !== undefined) {
                        dest[name] = val; // if there were no objects, this value will be used
                        break;
                    }
                }

                // if the trailing values were objects, use the merged value
                if (complexObjs.length) {
                    dest[name] = mergeProps(complexObjs);
                }
            }
        }

        // copy values into the destination, going from last to first
        for (i = propObjs.length - 1; i >= 0; i--) {
            props = propObjs[i];

            for (name in props) {
                if (!(name in dest)) { // if already assigned by previous props or complex props, don't reassign
                    dest[name] = props[name];
                }
            }
        }

        return dest;
    }


// Create an object that has the given prototype. Just like Object.create
    function createObject(proto) {
        var f = function() {};
        f.prototype = proto;
        return new f();
    }


    function copyOwnProps(src, dest) {
        for (var name in src) {
            if (hasOwnProp(src, name)) {
                dest[name] = src[name];
            }
        }
    }


// Copies over certain methods with the same names as Object.prototype methods. Overcomes an IE<=8 bug:
// https://developer.mozilla.org/en-US/docs/ECMAScript_DontEnum_attribute#JScript_DontEnum_Bug
    function copyNativeMethods(src, dest) {
        var names = [ 'constructor', 'toString', 'valueOf' ];
        var i, name;

        for (i = 0; i < names.length; i++) {
            name = names[i];

            if (src[name] !== Object.prototype[name]) {
                dest[name] = src[name];
            }
        }
    }


    function hasOwnProp(obj, name) {
        return hasOwnPropMethod.call(obj, name);
    }


// Is the given value a non-object non-function value?
    function isAtomic(val) {
        return /undefined|null|boolean|number|string/.test($.type(val));
    }


    function applyAll(functions, thisObj, args) {
        if ($.isFunction(functions)) {
            functions = [ functions ];
        }
        if (functions) {
            var i;
            var ret;
            for (i=0; i<functions.length; i++) {
                ret = functions[i].apply(thisObj, args) || ret;
            }
            return ret;
        }
    }


    function firstDefined() {
        for (var i=0; i<arguments.length; i++) {
            if (arguments[i] !== undefined) {
                return arguments[i];
            }
        }
    }


    function htmlEscape(s) {
        return (s + '').replace(/&/g, '&amp;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;')
            .replace(/'/g, '&#039;')
            .replace(/"/g, '&quot;')
            .replace(/\n/g, '<br />');
    }


    function stripHtmlEntities(text) {
        return text.replace(/&.*?;/g, '');
    }


// Given a hash of CSS properties, returns a string of CSS.
// Uses property names as-is (no camel-case conversion). Will not make statements for null/undefined values.
    function cssToStr(cssProps) {
        var statements = [];

        $.each(cssProps, function(name, val) {
            if (val != null) {
                statements.push(name + ':' + val);
            }
        });

        return statements.join(';');
    }


    function capitaliseFirstLetter(str) {
        return str.charAt(0).toUpperCase() + str.slice(1);
    }


    function compareNumbers(a, b) { // for .sort()
        return a - b;
    }


    function isInt(n) {
        return n % 1 === 0;
    }


// Returns a method bound to the given object context.
// Just like one of the jQuery.proxy signatures, but without the undesired behavior of treating the same method with
// different contexts as identical when binding/unbinding events.
    function proxy(obj, methodName) {
        var method = obj[methodName];

        return function() {
            return method.apply(obj, arguments);
        };
    }


// Returns a function, that, as long as it continues to be invoked, will not
// be triggered. The function will be called after it stops being called for
// N milliseconds. If `immediate` is passed, trigger the function on the
// leading edge, instead of the trailing.
// https://github.com/jashkenas/underscore/blob/1.6.0/underscore.js#L714
    function debounce(func, wait, immediate) {
        var timeout, args, context, timestamp, result;

        var later = function() {
            var last = +new Date() - timestamp;
            if (last < wait) {
                timeout = setTimeout(later, wait - last);
            }
            else {
                timeout = null;
                if (!immediate) {
                    result = func.apply(context, args);
                    context = args = null;
                }
            }
        };

        return function() {
            context = this;
            args = arguments;
            timestamp = +new Date();
            var callNow = immediate && !timeout;
            if (!timeout) {
                timeout = setTimeout(later, wait);
            }
            if (callNow) {
                result = func.apply(context, args);
                context = args = null;
            }
            return result;
        };
    }


// HACK around jQuery's now A+ promises: execute callback synchronously if already resolved.
// thenFunc shouldn't accept args.
// similar to whenResources in Scheduler plugin.
    function syncThen(promise, thenFunc) {
        // not a promise, or an already-resolved promise?
        if (!promise || !promise.then || promise.state() === 'resolved') {
            return $.when(thenFunc()); // resolve immediately
        }
        else if (thenFunc) {
            return promise.then(thenFunc);
        }
    }

    ;;

    var ambigDateOfMonthRegex = /^\s*\d{4}-\d\d$/;
    var ambigTimeOrZoneRegex =
        /^\s*\d{4}-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?)?$/;
    var newMomentProto = moment.fn; // where we will attach our new methods
    var oldMomentProto = $.extend({}, newMomentProto); // copy of original moment methods
    var allowValueOptimization;
    var setUTCValues; // function defined below
    var setLocalValues; // function defined below


// Creating
// -------------------------------------------------------------------------------------------------

// Creates a new moment, similar to the vanilla moment(...) constructor, but with
// extra features (ambiguous time, enhanced formatting). When given an existing moment,
// it will function as a clone (and retain the zone of the moment). Anything else will
// result in a moment in the local zone.
    FC.moment = function() {
        return makeMoment(arguments);
    };

// Sames as FC.moment, but forces the resulting moment to be in the UTC timezone.
    FC.moment.utc = function() {
        var mom = makeMoment(arguments, true);

        // Force it into UTC because makeMoment doesn't guarantee it
        // (if given a pre-existing moment for example)
        if (mom.hasTime()) { // don't give ambiguously-timed moments a UTC zone
            mom.utc();
        }

        return mom;
    };

// Same as FC.moment, but when given an ISO8601 string, the timezone offset is preserved.
// ISO8601 strings with no timezone offset will become ambiguously zoned.
    FC.moment.parseZone = function() {
        return makeMoment(arguments, true, true);
    };

// Builds an enhanced moment from args. When given an existing moment, it clones. When given a
// native Date, or called with no arguments (the current time), the resulting moment will be local.
// Anything else needs to be "parsed" (a string or an array), and will be affected by:
//    parseAsUTC - if there is no zone information, should we parse the input in UTC?
//    parseZone - if there is zone information, should we force the zone of the moment?
    function makeMoment(args, parseAsUTC, parseZone) {
        var input = args[0];
        var isSingleString = args.length == 1 && typeof input === 'string';
        var isAmbigTime;
        var isAmbigZone;
        var ambigMatch;
        var mom;

        if (moment.isMoment(input)) {
            mom = moment.apply(null, args); // clone it
            transferAmbigs(input, mom); // the ambig flags weren't transfered with the clone
        }
        else if (isNativeDate(input) || input === undefined) {
            mom = moment.apply(null, args); // will be local
        }
        else { // "parsing" is required
            isAmbigTime = false;
            isAmbigZone = false;

            if (isSingleString) {
                if (ambigDateOfMonthRegex.test(input)) {
                    // accept strings like '2014-05', but convert to the first of the month
                    input += '-01';
                    args = [ input ]; // for when we pass it on to moment's constructor
                    isAmbigTime = true;
                    isAmbigZone = true;
                }
                else if ((ambigMatch = ambigTimeOrZoneRegex.exec(input))) {
                    isAmbigTime = !ambigMatch[5]; // no time part?
                    isAmbigZone = true;
                }
            }
            else if ($.isArray(input)) {
                // arrays have no timezone information, so assume ambiguous zone
                isAmbigZone = true;
            }
            // otherwise, probably a string with a format

            if (parseAsUTC || isAmbigTime) {
                mom = moment.utc.apply(moment, args);
            }
            else {
                mom = moment.apply(null, args);
            }

            if (isAmbigTime) {
                mom._ambigTime = true;
                mom._ambigZone = true; // ambiguous time always means ambiguous zone
            }
            else if (parseZone) { // let's record the inputted zone somehow
                if (isAmbigZone) {
                    mom._ambigZone = true;
                }
                else if (isSingleString) {
                    if (mom.utcOffset) {
                        mom.utcOffset(input); // if not a valid zone, will assign UTC
                    }
                    else {
                        mom.zone(input); // for moment-pre-2.9
                    }
                }
            }
        }

        mom._fullCalendar = true; // flag for extended functionality

        return mom;
    }


// A clone method that works with the flags related to our enhanced functionality.
// In the future, use moment.momentProperties
    newMomentProto.clone = function() {
        var mom = oldMomentProto.clone.apply(this, arguments);

        // these flags weren't transfered with the clone
        transferAmbigs(this, mom);
        if (this._fullCalendar) {
            mom._fullCalendar = true;
        }

        return mom;
    };


// Week Number
// -------------------------------------------------------------------------------------------------


// Returns the week number, considering the locale's custom week number calcuation
// `weeks` is an alias for `week`
    newMomentProto.week = newMomentProto.weeks = function(input) {
        var weekCalc = (this._locale || this._lang) // works pre-moment-2.8
            ._fullCalendar_weekCalc;

        if (input == null && typeof weekCalc === 'function') { // custom function only works for getter
            return weekCalc(this);
        }
        else if (weekCalc === 'ISO') {
            return oldMomentProto.isoWeek.apply(this, arguments); // ISO getter/setter
        }

        return oldMomentProto.week.apply(this, arguments); // local getter/setter
    };


// Time-of-day
// -------------------------------------------------------------------------------------------------

// GETTER
// Returns a Duration with the hours/minutes/seconds/ms values of the moment.
// If the moment has an ambiguous time, a duration of 00:00 will be returned.
//
// SETTER
// You can supply a Duration, a Moment, or a Duration-like argument.
// When setting the time, and the moment has an ambiguous time, it then becomes unambiguous.
    newMomentProto.time = function(time) {

        // Fallback to the original method (if there is one) if this moment wasn't created via FullCalendar.
        // `time` is a generic enough method name where this precaution is necessary to avoid collisions w/ other plugins.
        if (!this._fullCalendar) {
            return oldMomentProto.time.apply(this, arguments);
        }

        if (time == null) { // getter
            return moment.duration({
                hours: this.hours(),
                minutes: this.minutes(),
                seconds: this.seconds(),
                milliseconds: this.milliseconds()
            });
        }
        else { // setter

            this._ambigTime = false; // mark that the moment now has a time

            if (!moment.isDuration(time) && !moment.isMoment(time)) {
                time = moment.duration(time);
            }

            // The day value should cause overflow (so 24 hours becomes 00:00:00 of next day).
            // Only for Duration times, not Moment times.
            var dayHours = 0;
            if (moment.isDuration(time)) {
                dayHours = Math.floor(time.asDays()) * 24;
            }

            // We need to set the individual fields.
            // Can't use startOf('day') then add duration. In case of DST at start of day.
            return this.hours(dayHours + time.hours())
                .minutes(time.minutes())
                .seconds(time.seconds())
                .milliseconds(time.milliseconds());
        }
    };

// Converts the moment to UTC, stripping out its time-of-day and timezone offset,
// but preserving its YMD. A moment with a stripped time will display no time
// nor timezone offset when .format() is called.
    newMomentProto.stripTime = function() {
        var a;

        if (!this._ambigTime) {

            // get the values before any conversion happens
            a = this.toArray(); // array of y/m/d/h/m/s/ms

            // TODO: use keepLocalTime in the future
            this.utc(); // set the internal UTC flag (will clear the ambig flags)
            setUTCValues(this, a.slice(0, 3)); // set the year/month/date. time will be zero

            // Mark the time as ambiguous. This needs to happen after the .utc() call, which might call .utcOffset(),
            // which clears all ambig flags. Same with setUTCValues with moment-timezone.
            this._ambigTime = true;
            this._ambigZone = true; // if ambiguous time, also ambiguous timezone offset
        }

        return this; // for chaining
    };

// Returns if the moment has a non-ambiguous time (boolean)
    newMomentProto.hasTime = function() {
        return !this._ambigTime;
    };


// Timezone
// -------------------------------------------------------------------------------------------------

// Converts the moment to UTC, stripping out its timezone offset, but preserving its
// YMD and time-of-day. A moment with a stripped timezone offset will display no
// timezone offset when .format() is called.
// TODO: look into Moment's keepLocalTime functionality
    newMomentProto.stripZone = function() {
        var a, wasAmbigTime;

        if (!this._ambigZone) {

            // get the values before any conversion happens
            a = this.toArray(); // array of y/m/d/h/m/s/ms
            wasAmbigTime = this._ambigTime;

            this.utc(); // set the internal UTC flag (might clear the ambig flags, depending on Moment internals)
            setUTCValues(this, a); // will set the year/month/date/hours/minutes/seconds/ms

            // the above call to .utc()/.utcOffset() unfortunately might clear the ambig flags, so restore
            this._ambigTime = wasAmbigTime || false;

            // Mark the zone as ambiguous. This needs to happen after the .utc() call, which might call .utcOffset(),
            // which clears the ambig flags. Same with setUTCValues with moment-timezone.
            this._ambigZone = true;
        }

        return this; // for chaining
    };

// Returns of the moment has a non-ambiguous timezone offset (boolean)
    newMomentProto.hasZone = function() {
        return !this._ambigZone;
    };


// this method implicitly marks a zone
    newMomentProto.local = function() {
        var a = this.toArray(); // year,month,date,hours,minutes,seconds,ms as an array
        var wasAmbigZone = this._ambigZone;

        oldMomentProto.local.apply(this, arguments);

        // ensure non-ambiguous
        // this probably already happened via local() -> utcOffset(), but don't rely on Moment's internals
        this._ambigTime = false;
        this._ambigZone = false;

        if (wasAmbigZone) {
            // If the moment was ambiguously zoned, the date fields were stored as UTC.
            // We want to preserve these, but in local time.
            // TODO: look into Moment's keepLocalTime functionality
            setLocalValues(this, a);
        }

        return this; // for chaining
    };


// implicitly marks a zone
    newMomentProto.utc = function() {
        oldMomentProto.utc.apply(this, arguments);

        // ensure non-ambiguous
        // this probably already happened via utc() -> utcOffset(), but don't rely on Moment's internals
        this._ambigTime = false;
        this._ambigZone = false;

        return this;
    };


// methods for arbitrarily manipulating timezone offset.
// should clear time/zone ambiguity when called.
    $.each([
        'zone', // only in moment-pre-2.9. deprecated afterwards
        'utcOffset'
    ], function(i, name) {
        if (oldMomentProto[name]) { // original method exists?

            // this method implicitly marks a zone (will probably get called upon .utc() and .local())
            newMomentProto[name] = function(tzo) {

                if (tzo != null) { // setter
                    // these assignments needs to happen before the original zone method is called.
                    // I forget why, something to do with a browser crash.
                    this._ambigTime = false;
                    this._ambigZone = false;
                }

                return oldMomentProto[name].apply(this, arguments);
            };
        }
    });


// Formatting
// -------------------------------------------------------------------------------------------------

    newMomentProto.format = function() {
        if (this._fullCalendar && arguments[0]) { // an enhanced moment? and a format string provided?
            return formatDate(this, arguments[0]); // our extended formatting
        }
        if (this._ambigTime) {
            return oldMomentFormat(this, 'YYYY-MM-DD');
        }
        if (this._ambigZone) {
            return oldMomentFormat(this, 'YYYY-MM-DD[T]HH:mm:ss');
        }
        return oldMomentProto.format.apply(this, arguments);
    };

    newMomentProto.toISOString = function() {
        if (this._ambigTime) {
            return oldMomentFormat(this, 'YYYY-MM-DD');
        }
        if (this._ambigZone) {
            return oldMomentFormat(this, 'YYYY-MM-DD[T]HH:mm:ss');
        }
        return oldMomentProto.toISOString.apply(this, arguments);
    };


// Querying
// -------------------------------------------------------------------------------------------------

// Is the moment within the specified range? `end` is exclusive.
// FYI, this method is not a standard Moment method, so always do our enhanced logic.
    newMomentProto.isWithin = function(start, end) {
        var a = commonlyAmbiguate([ this, start, end ]);
        return a[0] >= a[1] && a[0] < a[2];
    };

// When isSame is called with units, timezone ambiguity is normalized before the comparison happens.
// If no units specified, the two moments must be identically the same, with matching ambig flags.
    newMomentProto.isSame = function(input, units) {
        var a;

        // only do custom logic if this is an enhanced moment
        if (!this._fullCalendar) {
            return oldMomentProto.isSame.apply(this, arguments);
        }

        if (units) {
            a = commonlyAmbiguate([ this, input ], true); // normalize timezones but don't erase times
            return oldMomentProto.isSame.call(a[0], a[1], units);
        }
        else {
            input = FC.moment.parseZone(input); // normalize input
            return oldMomentProto.isSame.call(this, input) &&
                Boolean(this._ambigTime) === Boolean(input._ambigTime) &&
                Boolean(this._ambigZone) === Boolean(input._ambigZone);
        }
    };

// Make these query methods work with ambiguous moments
    $.each([
        'isBefore',
        'isAfter'
    ], function(i, methodName) {
        newMomentProto[methodName] = function(input, units) {
            var a;

            // only do custom logic if this is an enhanced moment
            if (!this._fullCalendar) {
                return oldMomentProto[methodName].apply(this, arguments);
            }

            a = commonlyAmbiguate([ this, input ]);
            return oldMomentProto[methodName].call(a[0], a[1], units);
        };
    });


// Misc Internals
// -------------------------------------------------------------------------------------------------

// given an array of moment-like inputs, return a parallel array w/ moments similarly ambiguated.
// for example, of one moment has ambig time, but not others, all moments will have their time stripped.
// set `preserveTime` to `true` to keep times, but only normalize zone ambiguity.
// returns the original moments if no modifications are necessary.
    function commonlyAmbiguate(inputs, preserveTime) {
        var anyAmbigTime = false;
        var anyAmbigZone = false;
        var len = inputs.length;
        var moms = [];
        var i, mom;

        // parse inputs into real moments and query their ambig flags
        for (i = 0; i < len; i++) {
            mom = inputs[i];
            if (!moment.isMoment(mom)) {
                mom = FC.moment.parseZone(mom);
            }
            anyAmbigTime = anyAmbigTime || mom._ambigTime;
            anyAmbigZone = anyAmbigZone || mom._ambigZone;
            moms.push(mom);
        }

        // strip each moment down to lowest common ambiguity
        // use clones to avoid modifying the original moments
        for (i = 0; i < len; i++) {
            mom = moms[i];
            if (!preserveTime && anyAmbigTime && !mom._ambigTime) {
                moms[i] = mom.clone().stripTime();
            }
            else if (anyAmbigZone && !mom._ambigZone) {
                moms[i] = mom.clone().stripZone();
            }
        }

        return moms;
    }

// Transfers all the flags related to ambiguous time/zone from the `src` moment to the `dest` moment
// TODO: look into moment.momentProperties for this.
    function transferAmbigs(src, dest) {
        if (src._ambigTime) {
            dest._ambigTime = true;
        }
        else if (dest._ambigTime) {
            dest._ambigTime = false;
        }

        if (src._ambigZone) {
            dest._ambigZone = true;
        }
        else if (dest._ambigZone) {
            dest._ambigZone = false;
        }
    }


// Sets the year/month/date/etc values of the moment from the given array.
// Inefficient because it calls each individual setter.
    function setMomentValues(mom, a) {
        mom.year(a[0] || 0)
            .month(a[1] || 0)
            .date(a[2] || 0)
            .hours(a[3] || 0)
            .minutes(a[4] || 0)
            .seconds(a[5] || 0)
            .milliseconds(a[6] || 0);
    }

// Can we set the moment's internal date directly?
    allowValueOptimization = '_d' in moment() && 'updateOffset' in moment;

// Utility function. Accepts a moment and an array of the UTC year/month/date/etc values to set.
// Assumes the given moment is already in UTC mode.
    setUTCValues = allowValueOptimization ? function(mom, a) {
        // simlate what moment's accessors do
        mom._d.setTime(Date.UTC.apply(Date, a));
        moment.updateOffset(mom, false); // keepTime=false
    } : setMomentValues;

// Utility function. Accepts a moment and an array of the local year/month/date/etc values to set.
// Assumes the given moment is already in local mode.
    setLocalValues = allowValueOptimization ? function(mom, a) {
        // simlate what moment's accessors do
        mom._d.setTime(+new Date( // FYI, there is now way to apply an array of args to a constructor
            a[0] || 0,
            a[1] || 0,
            a[2] || 0,
            a[3] || 0,
            a[4] || 0,
            a[5] || 0,
            a[6] || 0
        ));
        moment.updateOffset(mom, false); // keepTime=false
    } : setMomentValues;

    ;;

// Single Date Formatting
// -------------------------------------------------------------------------------------------------


// call this if you want Moment's original format method to be used
    function oldMomentFormat(mom, formatStr) {
        return oldMomentProto.format.call(mom, formatStr); // oldMomentProto defined in moment-ext.js
    }


// Formats `date` with a Moment formatting string, but allow our non-zero areas and
// additional token.
    function formatDate(date, formatStr) {
        return formatDateWithChunks(date, getFormatStringChunks(formatStr));
    }


    function formatDateWithChunks(date, chunks) {
        var s = '';
        var i;

        for (i=0; i<chunks.length; i++) {
            s += formatDateWithChunk(date, chunks[i]);
        }

        return s;
    }


// addition formatting tokens we want recognized
    var tokenOverrides = {
        t: function(date) { // "a" or "p"
            return oldMomentFormat(date, 'a').charAt(0);
        },
        T: function(date) { // "A" or "P"
            return oldMomentFormat(date, 'A').charAt(0);
        }
    };


    function formatDateWithChunk(date, chunk) {
        var token;
        var maybeStr;

        if (typeof chunk === 'string') { // a literal string
            return chunk;
        }
        else if ((token = chunk.token)) { // a token, like "YYYY"
            if (tokenOverrides[token]) {
                return tokenOverrides[token](date); // use our custom token
            }
            return oldMomentFormat(date, token);
        }
        else if (chunk.maybe) { // a grouping of other chunks that must be non-zero
            maybeStr = formatDateWithChunks(date, chunk.maybe);
            if (maybeStr.match(/[1-9]/)) {
                return maybeStr;
            }
        }

        return '';
    }


// Date Range Formatting
// -------------------------------------------------------------------------------------------------
// TODO: make it work with timezone offset

// Using a formatting string meant for a single date, generate a range string, like
// "Sep 2 - 9 2013", that intelligently inserts a separator where the dates differ.
// If the dates are the same as far as the format string is concerned, just return a single
// rendering of one date, without any separator.
    function formatRange(date1, date2, formatStr, separator, isRTL) {
        var localeData;

        date1 = FC.moment.parseZone(date1);
        date2 = FC.moment.parseZone(date2);

        localeData = (date1.localeData || date1.lang).call(date1); // works with moment-pre-2.8

        // Expand localized format strings, like "LL" -> "MMMM D YYYY"
        formatStr = localeData.longDateFormat(formatStr) || formatStr;
        // BTW, this is not important for `formatDate` because it is impossible to put custom tokens
        // or non-zero areas in Moment's localized format strings.

        separator = separator || ' - ';

        return formatRangeWithChunks(
            date1,
            date2,
            getFormatStringChunks(formatStr),
            separator,
            isRTL
        );
    }
    FC.formatRange = formatRange; // expose


    function formatRangeWithChunks(date1, date2, chunks, separator, isRTL) {
        var unzonedDate1 = date1.clone().stripZone(); // for formatSimilarChunk
        var unzonedDate2 = date2.clone().stripZone(); // "
        var chunkStr; // the rendering of the chunk
        var leftI;
        var leftStr = '';
        var rightI;
        var rightStr = '';
        var middleI;
        var middleStr1 = '';
        var middleStr2 = '';
        var middleStr = '';

        // Start at the leftmost side of the formatting string and continue until you hit a token
        // that is not the same between dates.
        for (leftI=0; leftI<chunks.length; leftI++) {
            chunkStr = formatSimilarChunk(date1, date2, unzonedDate1, unzonedDate2, chunks[leftI]);
            if (chunkStr === false) {
                break;
            }
            leftStr += chunkStr;
        }

        // Similarly, start at the rightmost side of the formatting string and move left
        for (rightI=chunks.length-1; rightI>leftI; rightI--) {
            chunkStr = formatSimilarChunk(date1, date2, unzonedDate1, unzonedDate2,  chunks[rightI]);
            if (chunkStr === false) {
                break;
            }
            rightStr = chunkStr + rightStr;
        }

        // The area in the middle is different for both of the dates.
        // Collect them distinctly so we can jam them together later.
        for (middleI=leftI; middleI<=rightI; middleI++) {
            middleStr1 += formatDateWithChunk(date1, chunks[middleI]);
            middleStr2 += formatDateWithChunk(date2, chunks[middleI]);
        }

        if (middleStr1 || middleStr2) {
            if (isRTL) {
                middleStr = middleStr2 + separator + middleStr1;
            }
            else {
                middleStr = middleStr1 + separator + middleStr2;
            }
        }

        return leftStr + middleStr + rightStr;
    }


    var similarUnitMap = {
        Y: 'year',
        M: 'month',
        D: 'day', // day of month
        d: 'day', // day of week
        // prevents a separator between anything time-related...
        A: 'second', // AM/PM
        a: 'second', // am/pm
        T: 'second', // A/P
        t: 'second', // a/p
        H: 'second', // hour (24)
        h: 'second', // hour (12)
        m: 'second', // minute
        s: 'second' // second
    };
// TODO: week maybe?


// Given a formatting chunk, and given that both dates are similar in the regard the
// formatting chunk is concerned, format date1 against `chunk`. Otherwise, return `false`.
    function formatSimilarChunk(date1, date2, unzonedDate1, unzonedDate2, chunk) {
        var token;
        var unit;

        if (typeof chunk === 'string') { // a literal string
            return chunk;
        }
        else if ((token = chunk.token)) {
            unit = similarUnitMap[token.charAt(0)];

            // are the dates the same for this unit of measurement?
            // use the unzoned dates for this calculation because unreliable when near DST (bug #2396)
            if (unit && unzonedDate1.isSame(unzonedDate2, unit)) {
                return oldMomentFormat(date1, token); // would be the same if we used `date2`
                // BTW, don't support custom tokens
            }
        }

        return false; // the chunk is NOT the same for the two dates
        // BTW, don't support splitting on non-zero areas
    }


// Chunking Utils
// -------------------------------------------------------------------------------------------------


    var formatStringChunkCache = {};


    function getFormatStringChunks(formatStr) {
        if (formatStr in formatStringChunkCache) {
            return formatStringChunkCache[formatStr];
        }
        return (formatStringChunkCache[formatStr] = chunkFormatString(formatStr));
    }


// Break the formatting string into an array of chunks
    function chunkFormatString(formatStr) {
        var chunks = [];
        var chunker = /\[([^\]]*)\]|\(([^\)]*)\)|(LTS|LT|(\w)\4*o?)|([^\w\[\(]+)/g; // TODO: more descrimination
        var match;

        while ((match = chunker.exec(formatStr))) {
            if (match[1]) { // a literal string inside [ ... ]
                chunks.push(match[1]);
            }
            else if (match[2]) { // non-zero formatting inside ( ... )
                chunks.push({ maybe: chunkFormatString(match[2]) });
            }
            else if (match[3]) { // a formatting token
                chunks.push({ token: match[3] });
            }
            else if (match[5]) { // an unenclosed literal string
                chunks.push(match[5]);
            }
        }

        return chunks;
    }

    ;;

    FC.Class = Class; // export

// Class that all other classes will inherit from
    function Class() { }


// Called on a class to create a subclass.
// Last argument contains instance methods. Any argument before the last are considered mixins.
    Class.extend = function() {
        var len = arguments.length;
        var i;
        var members;

        for (i = 0; i < len; i++) {
            members = arguments[i];
            if (i < len - 1) { // not the last argument?
                mixIntoClass(this, members);
            }
        }

        return extendClass(this, members || {}); // members will be undefined if no arguments
    };


// Adds new member variables/methods to the class's prototype.
// Can be called with another class, or a plain object hash containing new members.
    Class.mixin = function(members) {
        mixIntoClass(this, members);
    };


    function extendClass(superClass, members) {
        var subClass;

        // ensure a constructor for the subclass, forwarding all arguments to the super-constructor if it doesn't exist
        if (hasOwnProp(members, 'constructor')) {
            subClass = members.constructor;
        }
        if (typeof subClass !== 'function') {
            subClass = members.constructor = function() {
                superClass.apply(this, arguments);
            };
        }

        // build the base prototype for the subclass, which is an new object chained to the superclass's prototype
        subClass.prototype = createObject(superClass.prototype);

        // copy each member variable/method onto the the subclass's prototype
        copyOwnProps(members, subClass.prototype);
        copyNativeMethods(members, subClass.prototype); // hack for IE8

        // copy over all class variables/methods to the subclass, such as `extend` and `mixin`
        copyOwnProps(superClass, subClass);

        return subClass;
    }


    function mixIntoClass(theClass, members) {
        copyOwnProps(members, theClass.prototype); // TODO: copyNativeMethods?
    }
    ;;

    var EmitterMixin = FC.EmitterMixin = {

        // jQuery-ification via $(this) allows a non-DOM object to have
        // the same event handling capabilities (including namespaces).


        on: function(types, handler) {

            // handlers are always called with an "event" object as their first param.
            // sneak the `this` context and arguments into the extra parameter object
            // and forward them on to the original handler.
            var intercept = function(ev, extra) {
                return handler.apply(
                    extra.context || this,
                    extra.args || []
                );
            };

            // mimick jQuery's internal "proxy" system (risky, I know)
            // causing all functions with the same .guid to appear to be the same.
            // https://github.com/jquery/jquery/blob/2.2.4/src/core.js#L448
            // this is needed for calling .off with the original non-intercept handler.
            if (!handler.guid) {
                handler.guid = $.guid++;
            }
            intercept.guid = handler.guid;

            $(this).on(types, intercept);

            return this; // for chaining
        },


        off: function(types, handler) {
            $(this).off(types, handler);

            return this; // for chaining
        },


        trigger: function(types) {
            var args = Array.prototype.slice.call(arguments, 1); // arguments after the first

            // pass in "extra" info to the intercept
            $(this).triggerHandler(types, { args: args });

            return this; // for chaining
        },


        triggerWith: function(types, context, args) {

            // `triggerHandler` is less reliant on the DOM compared to `trigger`.
            // pass in "extra" info to the intercept.
            $(this).triggerHandler(types, { context: context, args: args });

            return this; // for chaining
        }

    };

    ;;

    /*
     Utility methods for easily listening to events on another object,
     and more importantly, easily unlistening from them.
     */
    var ListenerMixin = FC.ListenerMixin = (function() {
        var guid = 0;
        var ListenerMixin = {

            listenerId: null,

            /*
             Given an `other` object that has on/off methods, bind the given `callback` to an event by the given name.
             The `callback` will be called with the `this` context of the object that .listenTo is being called on.
             Can be called:
             .listenTo(other, eventName, callback)
             OR
             .listenTo(other, {
             eventName1: callback1,
             eventName2: callback2
             })
             */
            listenTo: function(other, arg, callback) {
                if (typeof arg === 'object') { // given dictionary of callbacks
                    for (var eventName in arg) {
                        if (arg.hasOwnProperty(eventName)) {
                            this.listenTo(other, eventName, arg[eventName]);
                        }
                    }
                }
                else if (typeof arg === 'string') {
                    other.on(
                        arg + '.' + this.getListenerNamespace(), // use event namespacing to identify this object
                        $.proxy(callback, this) // always use `this` context
                        // the usually-undesired jQuery guid behavior doesn't matter,
                        // because we always unbind via namespace
                    );
                }
            },

            /*
             Causes the current object to stop listening to events on the `other` object.
             `eventName` is optional. If omitted, will stop listening to ALL events on `other`.
             */
            stopListeningTo: function(other, eventName) {
                other.off((eventName || '') + '.' + this.getListenerNamespace());
            },

            /*
             Returns a string, unique to this object, to be used for event namespacing
             */
            getListenerNamespace: function() {
                if (this.listenerId == null) {
                    this.listenerId = guid++;
                }
                return '_listener' + this.listenerId;
            }

        };
        return ListenerMixin;
    })();
    ;;

// simple class for toggle a `isIgnoringMouse` flag on delay
// initMouseIgnoring must first be called, with a millisecond delay setting.
    var MouseIgnorerMixin = {

        isIgnoringMouse: false, // bool
        delayUnignoreMouse: null, // method


        initMouseIgnoring: function(delay) {
            this.delayUnignoreMouse = debounce(proxy(this, 'unignoreMouse'), delay || 1000);
        },


        // temporarily ignore mouse actions on segments
        tempIgnoreMouse: function() {
            this.isIgnoringMouse = true;
            this.delayUnignoreMouse();
        },


        // delayUnignoreMouse eventually calls this
        unignoreMouse: function() {
            this.isIgnoringMouse = false;
        }

    };

    ;;

    /* A rectangular panel that is absolutely positioned over other content
     ------------------------------------------------------------------------------------------------------------------------
     Options:
     - className (string)
     - content (HTML string or jQuery element set)
     - parentEl
     - top
     - left
     - right (the x coord of where the right edge should be. not a "CSS" right)
     - autoHide (boolean)
     - show (callback)
     - hide (callback)
     */

    var Popover = Class.extend(ListenerMixin, {

        isHidden: true,
        options: null,
        el: null, // the container element for the popover. generated by this object
        margin: 10, // the space required between the popover and the edges of the scroll container


        constructor: function(options) {
            this.options = options || {};
        },


        // Shows the popover on the specified position. Renders it if not already
        show: function() {
            if (this.isHidden) {
                if (!this.el) {
                    this.render();
                }
                this.el.show();
                this.position();
                this.isHidden = false;
                this.trigger('show');
            }
        },


        // Hides the popover, through CSS, but does not remove it from the DOM
        hide: function() {
            if (!this.isHidden) {
                this.el.hide();
                this.isHidden = true;
                this.trigger('hide');
            }
        },


        // Creates `this.el` and renders content inside of it
        render: function() {
            var _this = this;
            var options = this.options;

            this.el = $('<div class="fc-popover"/>')
                .addClass(options.className || '')
                .css({
                    // position initially to the top left to avoid creating scrollbars
                    top: 0,
                    left: 0
                })
                .append(options.content)
                .appendTo(options.parentEl);

            // when a click happens on anything inside with a 'fc-close' className, hide the popover
            this.el.on('click', '.fc-close', function() {
                _this.hide();
            });

            if (options.autoHide) {
                this.listenTo($(document), 'mousedown', this.documentMousedown);
            }
        },


        // Triggered when the user clicks *anywhere* in the document, for the autoHide feature
        documentMousedown: function(ev) {
            // only hide the popover if the click happened outside the popover
            if (this.el && !$(ev.target).closest(this.el).length) {
                this.hide();
            }
        },


        // Hides and unregisters any handlers
        removeElement: function() {
            this.hide();

            if (this.el) {
                this.el.remove();
                this.el = null;
            }

            this.stopListeningTo($(document), 'mousedown');
        },


        // Positions the popover optimally, using the top/left/right options
        position: function() {
            var options = this.options;
            var origin = this.el.offsetParent().offset();
            var width = this.el.outerWidth();
            var height = this.el.outerHeight();
            var windowEl = $(window);
            var viewportEl = getScrollParent(this.el);
            var viewportTop;
            var viewportLeft;
            var viewportOffset;
            var top; // the "position" (not "offset") values for the popover
            var left; //

            // compute top and left
            top = options.top || 0;
            if (options.left !== undefined) {
                left = options.left;
            }
            else if (options.right !== undefined) {
                left = options.right - width; // derive the left value from the right value
            }
            else {
                left = 0;
            }

            if (viewportEl.is(window) || viewportEl.is(document)) { // normalize getScrollParent's result
                viewportEl = windowEl;
                viewportTop = 0; // the window is always at the top left
                viewportLeft = 0; // (and .offset() won't work if called here)
            }
            else {
                viewportOffset = viewportEl.offset();
                viewportTop = viewportOffset.top;
                viewportLeft = viewportOffset.left;
            }

            // if the window is scrolled, it causes the visible area to be further down
            viewportTop += windowEl.scrollTop();
            viewportLeft += windowEl.scrollLeft();

            // constrain to the view port. if constrained by two edges, give precedence to top/left
            if (options.viewportConstrain !== false) {
                top = Math.min(top, viewportTop + viewportEl.outerHeight() - height - this.margin);
                top = Math.max(top, viewportTop + this.margin);
                left = Math.min(left, viewportLeft + viewportEl.outerWidth() - width - this.margin);
                left = Math.max(left, viewportLeft + this.margin);
            }

            this.el.css({
                top: top - origin.top,
                left: left - origin.left
            });
        },


        // Triggers a callback. Calls a function in the option hash of the same name.
        // Arguments beyond the first `name` are forwarded on.
        // TODO: better code reuse for this. Repeat code
        trigger: function(name) {
            if (this.options[name]) {
                this.options[name].apply(this, Array.prototype.slice.call(arguments, 1));
            }
        }

    });

    ;;

    /*
     A cache for the left/right/top/bottom/width/height values for one or more elements.
     Works with both offset (from topleft document) and position (from offsetParent).

     options:
     - els
     - isHorizontal
     - isVertical
     */
    var CoordCache = FC.CoordCache = Class.extend({

        els: null, // jQuery set (assumed to be siblings)
        forcedOffsetParentEl: null, // options can override the natural offsetParent
        origin: null, // {left,top} position of offsetParent of els
        boundingRect: null, // constrain cordinates to this rectangle. {left,right,top,bottom} or null
        isHorizontal: false, // whether to query for left/right/width
        isVertical: false, // whether to query for top/bottom/height

        // arrays of coordinates (offsets from topleft of document)
        lefts: null,
        rights: null,
        tops: null,
        bottoms: null,


        constructor: function(options) {
            this.els = $(options.els);
            this.isHorizontal = options.isHorizontal;
            this.isVertical = options.isVertical;
            this.forcedOffsetParentEl = options.offsetParent ? $(options.offsetParent) : null;
        },


        // Queries the els for coordinates and stores them.
        // Call this method before using and of the get* methods below.
        build: function() {
            var offsetParentEl = this.forcedOffsetParentEl || this.els.eq(0).offsetParent();

            this.origin = offsetParentEl.offset();
            this.boundingRect = this.queryBoundingRect();

            if (this.isHorizontal) {
                this.buildElHorizontals();
            }
            if (this.isVertical) {
                this.buildElVerticals();
            }
        },


        // Destroys all internal data about coordinates, freeing memory
        clear: function() {
            this.origin = null;
            this.boundingRect = null;
            this.lefts = null;
            this.rights = null;
            this.tops = null;
            this.bottoms = null;
        },


        // When called, if coord caches aren't built, builds them
        ensureBuilt: function() {
            if (!this.origin) {
                this.build();
            }
        },


        // Populates the left/right internal coordinate arrays
        buildElHorizontals: function() {
            var lefts = [];
            var rights = [];

            this.els.each(function(i, node) {
                var el = $(node);
                var left = el.offset().left;
                var width = el.outerWidth();

                lefts.push(left);
                rights.push(left + width);
            });

            this.lefts = lefts;
            this.rights = rights;
        },


        // Populates the top/bottom internal coordinate arrays
        buildElVerticals: function() {
            var tops = [];
            var bottoms = [];

            this.els.each(function(i, node) {
                var el = $(node);
                var top = el.offset().top;
                var height = el.outerHeight();

                tops.push(top);
                bottoms.push(top + height);
            });

            this.tops = tops;
            this.bottoms = bottoms;
        },


        // Given a left offset (from document left), returns the index of the el that it horizontally intersects.
        // If no intersection is made, returns undefined.
        getHorizontalIndex: function(leftOffset) {
            this.ensureBuilt();

            var lefts = this.lefts;
            var rights = this.rights;
            var len = lefts.length;
            var i;

            for (i = 0; i < len; i++) {
                if (leftOffset >= lefts[i] && leftOffset < rights[i]) {
                    return i;
                }
            }
        },


        // Given a top offset (from document top), returns the index of the el that it vertically intersects.
        // If no intersection is made, returns undefined.
        getVerticalIndex: function(topOffset) {
            this.ensureBuilt();

            var tops = this.tops;
            var bottoms = this.bottoms;
            var len = tops.length;
            var i;

            for (i = 0; i < len; i++) {
                if (topOffset >= tops[i] && topOffset < bottoms[i]) {
                    return i;
                }
            }
        },


        // Gets the left offset (from document left) of the element at the given index
        getLeftOffset: function(leftIndex) {
            this.ensureBuilt();
            return this.lefts[leftIndex];
        },


        // Gets the left position (from offsetParent left) of the element at the given index
        getLeftPosition: function(leftIndex) {
            this.ensureBuilt();
            return this.lefts[leftIndex] - this.origin.left;
        },


        // Gets the right offset (from document left) of the element at the given index.
        // This value is NOT relative to the document's right edge, like the CSS concept of "right" would be.
        getRightOffset: function(leftIndex) {
            this.ensureBuilt();
            return this.rights[leftIndex];
        },


        // Gets the right position (from offsetParent left) of the element at the given index.
        // This value is NOT relative to the offsetParent's right edge, like the CSS concept of "right" would be.
        getRightPosition: function(leftIndex) {
            this.ensureBuilt();
            return this.rights[leftIndex] - this.origin.left;
        },


        // Gets the width of the element at the given index
        getWidth: function(leftIndex) {
            this.ensureBuilt();
            return this.rights[leftIndex] - this.lefts[leftIndex];
        },


        // Gets the top offset (from document top) of the element at the given index
        getTopOffset: function(topIndex) {
            this.ensureBuilt();
            return this.tops[topIndex];
        },


        // Gets the top position (from offsetParent top) of the element at the given position
        getTopPosition: function(topIndex) {
            this.ensureBuilt();
            return this.tops[topIndex] - this.origin.top;
        },

        // Gets the bottom offset (from the document top) of the element at the given index.
        // This value is NOT relative to the offsetParent's bottom edge, like the CSS concept of "bottom" would be.
        getBottomOffset: function(topIndex) {
            this.ensureBuilt();
            return this.bottoms[topIndex];
        },


        // Gets the bottom position (from the offsetParent top) of the element at the given index.
        // This value is NOT relative to the offsetParent's bottom edge, like the CSS concept of "bottom" would be.
        getBottomPosition: function(topIndex) {
            this.ensureBuilt();
            return this.bottoms[topIndex] - this.origin.top;
        },


        // Gets the height of the element at the given index
        getHeight: function(topIndex) {
            this.ensureBuilt();
            return this.bottoms[topIndex] - this.tops[topIndex];
        },


        // Bounding Rect
        // TODO: decouple this from CoordCache

        // Compute and return what the elements' bounding rectangle is, from the user's perspective.
        // Right now, only returns a rectangle if constrained by an overflow:scroll element.
        queryBoundingRect: function() {
            var scrollParentEl = getScrollParent(this.els.eq(0));

            if (!scrollParentEl.is(document)) {
                return getClientRect(scrollParentEl);
            }
        },

        isPointInBounds: function(leftOffset, topOffset) {
            return this.isLeftInBounds(leftOffset) && this.isTopInBounds(topOffset);
        },

        isLeftInBounds: function(leftOffset) {
            return !this.boundingRect || (leftOffset >= this.boundingRect.left && leftOffset < this.boundingRect.right);
        },

        isTopInBounds: function(topOffset) {
            return !this.boundingRect || (topOffset >= this.boundingRect.top && topOffset < this.boundingRect.bottom);
        }

    });

    ;;

    /* Tracks a drag's mouse movement, firing various handlers
     ----------------------------------------------------------------------------------------------------------------------*/
// TODO: use Emitter

    var DragListener = FC.DragListener = Class.extend(ListenerMixin, MouseIgnorerMixin, {

        options: null,

        // for IE8 bug-fighting behavior
        subjectEl: null,
        subjectHref: null,

        // coordinates of the initial mousedown
        originX: null,
        originY: null,

        // the wrapping element that scrolls, or MIGHT scroll if there's overflow.
        // TODO: do this for wrappers that have overflow:hidden as well.
        scrollEl: null,

        isInteracting: false,
        isDistanceSurpassed: false,
        isDelayEnded: false,
        isDragging: false,
        isTouch: false,

        delay: null,
        delayTimeoutId: null,
        minDistance: null,

        handleTouchScrollProxy: null, // calls handleTouchScroll, always bound to `this`


        constructor: function(options) {
            this.options = options || {};
            this.handleTouchScrollProxy = proxy(this, 'handleTouchScroll');
            this.initMouseIgnoring(500);
        },


        // Interaction (high-level)
        // -----------------------------------------------------------------------------------------------------------------


        startInteraction: function(ev, extraOptions) {
            var isTouch = getEvIsTouch(ev);

            if (ev.type === 'mousedown') {
                if (this.isIgnoringMouse) {
                    return;
                }
                else if (!isPrimaryMouseButton(ev)) {
                    return;
                }
                else {
                    ev.preventDefault(); // prevents native selection in most browsers
                }
            }

            if (!this.isInteracting) {

                // process options
                extraOptions = extraOptions || {};
                this.delay = firstDefined(extraOptions.delay, this.options.delay, 0);
                this.minDistance = firstDefined(extraOptions.distance, this.options.distance, 0);
                this.subjectEl = this.options.subjectEl;

                this.isInteracting = true;
                this.isTouch = isTouch;
                this.isDelayEnded = false;
                this.isDistanceSurpassed = false;

                this.originX = getEvX(ev);
                this.originY = getEvY(ev);
                this.scrollEl = getScrollParent($(ev.target));

                this.bindHandlers();
                this.initAutoScroll();
                this.handleInteractionStart(ev);
                this.startDelay(ev);

                if (!this.minDistance) {
                    this.handleDistanceSurpassed(ev);
                }
            }
        },


        handleInteractionStart: function(ev) {
            this.trigger('interactionStart', ev);
        },


        endInteraction: function(ev, isCancelled) {
            if (this.isInteracting) {
                this.endDrag(ev);

                if (this.delayTimeoutId) {
                    clearTimeout(this.delayTimeoutId);
                    this.delayTimeoutId = null;
                }

                this.destroyAutoScroll();
                this.unbindHandlers();

                this.isInteracting = false;
                this.handleInteractionEnd(ev, isCancelled);

                // a touchstart+touchend on the same element will result in the following addition simulated events:
                // mouseover + mouseout + click
                // let's ignore these bogus events
                if (this.isTouch) {
                    this.tempIgnoreMouse();
                }
            }
        },


        handleInteractionEnd: function(ev, isCancelled) {
            this.trigger('interactionEnd', ev, isCancelled || false);
        },


        // Binding To DOM
        // -----------------------------------------------------------------------------------------------------------------


        bindHandlers: function() {
            var _this = this;
            var touchStartIgnores = 1;

            if (this.isTouch) {
                this.listenTo($(document), {
                    touchmove: this.handleTouchMove,
                    touchend: this.endInteraction,
                    touchcancel: this.endInteraction,

                    // Sometimes touchend doesn't fire
                    // (can't figure out why. touchcancel doesn't fire either. has to do with scrolling?)
                    // If another touchstart happens, we know it's bogus, so cancel the drag.
                    // touchend will continue to be broken until user does a shorttap/scroll, but this is best we can do.
                    touchstart: function(ev) {
                        if (touchStartIgnores) { // bindHandlers is called from within a touchstart,
                            touchStartIgnores--; // and we don't want this to fire immediately, so ignore.
                        }
                        else {
                            _this.endInteraction(ev, true); // isCancelled=true
                        }
                    }
                });

                // listen to ALL scroll actions on the page
                if (
                    !bindAnyScroll(this.handleTouchScrollProxy) && // hopefully this works and short-circuits the rest
                    this.scrollEl // otherwise, attach a single handler to this
                ) {
                    this.listenTo(this.scrollEl, 'scroll', this.handleTouchScroll);
                }
            }
            else {
                this.listenTo($(document), {
                    mousemove: this.handleMouseMove,
                    mouseup: this.endInteraction
                });
            }

            this.listenTo($(document), {
                selectstart: preventDefault, // don't allow selection while dragging
                contextmenu: preventDefault // long taps would open menu on Chrome dev tools
            });
        },


        unbindHandlers: function() {
            this.stopListeningTo($(document));

            // unbind scroll listening
            unbindAnyScroll(this.handleTouchScrollProxy);
            if (this.scrollEl) {
                this.stopListeningTo(this.scrollEl, 'scroll');
            }
        },


        // Drag (high-level)
        // -----------------------------------------------------------------------------------------------------------------


        // extraOptions ignored if drag already started
        startDrag: function(ev, extraOptions) {
            this.startInteraction(ev, extraOptions); // ensure interaction began

            if (!this.isDragging) {
                this.isDragging = true;
                this.handleDragStart(ev);
            }
        },


        handleDragStart: function(ev) {
            this.trigger('dragStart', ev);
            this.initHrefHack();
        },


        handleMove: function(ev) {
            var dx = getEvX(ev) - this.originX;
            var dy = getEvY(ev) - this.originY;
            var minDistance = this.minDistance;
            var distanceSq; // current distance from the origin, squared

            if (!this.isDistanceSurpassed) {
                distanceSq = dx * dx + dy * dy;
                if (distanceSq >= minDistance * minDistance) { // use pythagorean theorem
                    this.handleDistanceSurpassed(ev);
                }
            }

            if (this.isDragging) {
                this.handleDrag(dx, dy, ev);
            }
        },


        // Called while the mouse is being moved and when we know a legitimate drag is taking place
        handleDrag: function(dx, dy, ev) {
            this.trigger('drag', dx, dy, ev);
            this.updateAutoScroll(ev); // will possibly cause scrolling
        },


        endDrag: function(ev) {
            if (this.isDragging) {
                this.isDragging = false;
                this.handleDragEnd(ev);
            }
        },


        handleDragEnd: function(ev) {
            this.trigger('dragEnd', ev);
            this.destroyHrefHack();
        },


        // Delay
        // -----------------------------------------------------------------------------------------------------------------


        startDelay: function(initialEv) {
            var _this = this;

            if (this.delay) {
                this.delayTimeoutId = setTimeout(function() {
                    _this.handleDelayEnd(initialEv);
                }, this.delay);
            }
            else {
                this.handleDelayEnd(initialEv);
            }
        },


        handleDelayEnd: function(initialEv) {
            this.isDelayEnded = true;

            if (this.isDistanceSurpassed) {
                this.startDrag(initialEv);
            }
        },


        // Distance
        // -----------------------------------------------------------------------------------------------------------------


        handleDistanceSurpassed: function(ev) {
            this.isDistanceSurpassed = true;

            if (this.isDelayEnded) {
                this.startDrag(ev);
            }
        },


        // Mouse / Touch
        // -----------------------------------------------------------------------------------------------------------------


        handleTouchMove: function(ev) {
            // prevent inertia and touchmove-scrolling while dragging
            if (this.isDragging) {
                ev.preventDefault();
            }

            this.handleMove(ev);
        },


        handleMouseMove: function(ev) {
            this.handleMove(ev);
        },


        // Scrolling (unrelated to auto-scroll)
        // -----------------------------------------------------------------------------------------------------------------


        handleTouchScroll: function(ev) {
            // if the drag is being initiated by touch, but a scroll happens before
            // the drag-initiating delay is over, cancel the drag
            if (!this.isDragging) {
                this.endInteraction(ev, true); // isCancelled=true
            }
        },


        // <A> HREF Hack
        // -----------------------------------------------------------------------------------------------------------------


        initHrefHack: function() {
            var subjectEl = this.subjectEl;

            // remove a mousedown'd <a>'s href so it is not visited (IE8 bug)
            if ((this.subjectHref = subjectEl ? subjectEl.attr('href') : null)) {
                subjectEl.removeAttr('href');
            }
        },


        destroyHrefHack: function() {
            var subjectEl = this.subjectEl;
            var subjectHref = this.subjectHref;

            // restore a mousedown'd <a>'s href (for IE8 bug)
            setTimeout(function() { // must be outside of the click's execution
                if (subjectHref) {
                    subjectEl.attr('href', subjectHref);
                }
            }, 0);
        },


        // Utils
        // -----------------------------------------------------------------------------------------------------------------


        // Triggers a callback. Calls a function in the option hash of the same name.
        // Arguments beyond the first `name` are forwarded on.
        trigger: function(name) {
            if (this.options[name]) {
                this.options[name].apply(this, Array.prototype.slice.call(arguments, 1));
            }
            // makes _methods callable by event name. TODO: kill this
            if (this['_' + name]) {
                this['_' + name].apply(this, Array.prototype.slice.call(arguments, 1));
            }
        }


    });

    ;;
    /*
     this.scrollEl is set in DragListener
     */
    DragListener.mixin({

        isAutoScroll: false,

        scrollBounds: null, // { top, bottom, left, right }
        scrollTopVel: null, // pixels per second
        scrollLeftVel: null, // pixels per second
        scrollIntervalId: null, // ID of setTimeout for scrolling animation loop

        // defaults
        scrollSensitivity: 30, // pixels from edge for scrolling to start
        scrollSpeed: 200, // pixels per second, at maximum speed
        scrollIntervalMs: 50, // millisecond wait between scroll increment


        initAutoScroll: function() {
            var scrollEl = this.scrollEl;

            this.isAutoScroll =
                this.options.scroll &&
                scrollEl &&
                !scrollEl.is(window) &&
                !scrollEl.is(document);

            if (this.isAutoScroll) {
                // debounce makes sure rapid calls don't happen
                this.listenTo(scrollEl, 'scroll', debounce(this.handleDebouncedScroll, 100));
            }
        },


        destroyAutoScroll: function() {
            this.endAutoScroll(); // kill any animation loop

            // remove the scroll handler if there is a scrollEl
            if (this.isAutoScroll) {
                this.stopListeningTo(this.scrollEl, 'scroll'); // will probably get removed by unbindHandlers too :(
            }
        },


        // Computes and stores the bounding rectangle of scrollEl
        computeScrollBounds: function() {
            if (this.isAutoScroll) {
                this.scrollBounds = getOuterRect(this.scrollEl);
                // TODO: use getClientRect in future. but prevents auto scrolling when on top of scrollbars
            }
        },


        // Called when the dragging is in progress and scrolling should be updated
        updateAutoScroll: function(ev) {
            var sensitivity = this.scrollSensitivity;
            var bounds = this.scrollBounds;
            var topCloseness, bottomCloseness;
            var leftCloseness, rightCloseness;
            var topVel = 0;
            var leftVel = 0;

            if (bounds) { // only scroll if scrollEl exists

                // compute closeness to edges. valid range is from 0.0 - 1.0
                topCloseness = (sensitivity - (getEvY(ev) - bounds.top)) / sensitivity;
                bottomCloseness = (sensitivity - (bounds.bottom - getEvY(ev))) / sensitivity;
                leftCloseness = (sensitivity - (getEvX(ev) - bounds.left)) / sensitivity;
                rightCloseness = (sensitivity - (bounds.right - getEvX(ev))) / sensitivity;

                // translate vertical closeness into velocity.
                // mouse must be completely in bounds for velocity to happen.
                if (topCloseness >= 0 && topCloseness <= 1) {
                    topVel = topCloseness * this.scrollSpeed * -1; // negative. for scrolling up
                }
                else if (bottomCloseness >= 0 && bottomCloseness <= 1) {
                    topVel = bottomCloseness * this.scrollSpeed;
                }

                // translate horizontal closeness into velocity
                if (leftCloseness >= 0 && leftCloseness <= 1) {
                    leftVel = leftCloseness * this.scrollSpeed * -1; // negative. for scrolling left
                }
                else if (rightCloseness >= 0 && rightCloseness <= 1) {
                    leftVel = rightCloseness * this.scrollSpeed;
                }
            }

            this.setScrollVel(topVel, leftVel);
        },


        // Sets the speed-of-scrolling for the scrollEl
        setScrollVel: function(topVel, leftVel) {

            this.scrollTopVel = topVel;
            this.scrollLeftVel = leftVel;

            this.constrainScrollVel(); // massages into realistic values

            // if there is non-zero velocity, and an animation loop hasn't already started, then START
            if ((this.scrollTopVel || this.scrollLeftVel) && !this.scrollIntervalId) {
                this.scrollIntervalId = setInterval(
                    proxy(this, 'scrollIntervalFunc'), // scope to `this`
                    this.scrollIntervalMs
                );
            }
        },


        // Forces scrollTopVel and scrollLeftVel to be zero if scrolling has already gone all the way
        constrainScrollVel: function() {
            var el = this.scrollEl;

            if (this.scrollTopVel < 0) { // scrolling up?
                if (el.scrollTop() <= 0) { // already scrolled all the way up?
                    this.scrollTopVel = 0;
                }
            }
            else if (this.scrollTopVel > 0) { // scrolling down?
                if (el.scrollTop() + el[0].clientHeight >= el[0].scrollHeight) { // already scrolled all the way down?
                    this.scrollTopVel = 0;
                }
            }

            if (this.scrollLeftVel < 0) { // scrolling left?
                if (el.scrollLeft() <= 0) { // already scrolled all the left?
                    this.scrollLeftVel = 0;
                }
            }
            else if (this.scrollLeftVel > 0) { // scrolling right?
                if (el.scrollLeft() + el[0].clientWidth >= el[0].scrollWidth) { // already scrolled all the way right?
                    this.scrollLeftVel = 0;
                }
            }
        },


        // This function gets called during every iteration of the scrolling animation loop
        scrollIntervalFunc: function() {
            var el = this.scrollEl;
            var frac = this.scrollIntervalMs / 1000; // considering animation frequency, what the vel should be mult'd by

            // change the value of scrollEl's scroll
            if (this.scrollTopVel) {
                el.scrollTop(el.scrollTop() + this.scrollTopVel * frac);
            }
            if (this.scrollLeftVel) {
                el.scrollLeft(el.scrollLeft() + this.scrollLeftVel * frac);
            }

            this.constrainScrollVel(); // since the scroll values changed, recompute the velocities

            // if scrolled all the way, which causes the vels to be zero, stop the animation loop
            if (!this.scrollTopVel && !this.scrollLeftVel) {
                this.endAutoScroll();
            }
        },


        // Kills any existing scrolling animation loop
        endAutoScroll: function() {
            if (this.scrollIntervalId) {
                clearInterval(this.scrollIntervalId);
                this.scrollIntervalId = null;

                this.handleScrollEnd();
            }
        },


        // Get called when the scrollEl is scrolled (NOTE: this is delayed via debounce)
        handleDebouncedScroll: function() {
            // recompute all coordinates, but *only* if this is *not* part of our scrolling animation
            if (!this.scrollIntervalId) {
                this.handleScrollEnd();
            }
        },


        // Called when scrolling has stopped, whether through auto scroll, or the user scrolling
        handleScrollEnd: function() {
        }

    });
    ;;

    /* Tracks mouse movements over a component and raises events about which hit the mouse is over.
     ------------------------------------------------------------------------------------------------------------------------
     options:
     - subjectEl
     - subjectCenter
     */

    var HitDragListener = DragListener.extend({

        component: null, // converts coordinates to hits
        // methods: prepareHits, releaseHits, queryHit

        origHit: null, // the hit the mouse was over when listening started
        hit: null, // the hit the mouse is over
        coordAdjust: null, // delta that will be added to the mouse coordinates when computing collisions


        constructor: function(component, options) {
            DragListener.call(this, options); // call the super-constructor

            this.component = component;
        },


        // Called when drag listening starts (but a real drag has not necessarily began).
        // ev might be undefined if dragging was started manually.
        handleInteractionStart: function(ev) {
            var subjectEl = this.subjectEl;
            var subjectRect;
            var origPoint;
            var point;

            this.computeCoords();

            if (ev) {
                origPoint = { left: getEvX(ev), top: getEvY(ev) };
                point = origPoint;

                // constrain the point to bounds of the element being dragged
                if (subjectEl) {
                    subjectRect = getOuterRect(subjectEl); // used for centering as well
                    point = constrainPoint(point, subjectRect);
                }

                this.origHit = this.queryHit(point.left, point.top);

                // treat the center of the subject as the collision point?
                if (subjectEl && this.options.subjectCenter) {

                    // only consider the area the subject overlaps the hit. best for large subjects.
                    // TODO: skip this if hit didn't supply left/right/top/bottom
                    if (this.origHit) {
                        subjectRect = intersectRects(this.origHit, subjectRect) ||
                            subjectRect; // in case there is no intersection
                    }

                    point = getRectCenter(subjectRect);
                }

                this.coordAdjust = diffPoints(point, origPoint); // point - origPoint
            }
            else {
                this.origHit = null;
                this.coordAdjust = null;
            }

            // call the super-method. do it after origHit has been computed
            DragListener.prototype.handleInteractionStart.apply(this, arguments);
        },


        // Recomputes the drag-critical positions of elements
        computeCoords: function() {
            this.component.prepareHits();
            this.computeScrollBounds(); // why is this here??????
        },


        // Called when the actual drag has started
        handleDragStart: function(ev) {
            var hit;

            DragListener.prototype.handleDragStart.apply(this, arguments); // call the super-method

            // might be different from this.origHit if the min-distance is large
            hit = this.queryHit(getEvX(ev), getEvY(ev));

            // report the initial hit the mouse is over
            // especially important if no min-distance and drag starts immediately
            if (hit) {
                this.handleHitOver(hit);
            }
        },


        // Called when the drag moves
        handleDrag: function(dx, dy, ev) {
            var hit;

            DragListener.prototype.handleDrag.apply(this, arguments); // call the super-method

            hit = this.queryHit(getEvX(ev), getEvY(ev));

            if (!isHitsEqual(hit, this.hit)) { // a different hit than before?
                if (this.hit) {
                    this.handleHitOut();
                }
                if (hit) {
                    this.handleHitOver(hit);
                }
            }
        },


        // Called when dragging has been stopped
        handleDragEnd: function() {
            this.handleHitDone();
            DragListener.prototype.handleDragEnd.apply(this, arguments); // call the super-method
        },


        // Called when a the mouse has just moved over a new hit
        handleHitOver: function(hit) {
            var isOrig = isHitsEqual(hit, this.origHit);

            this.hit = hit;

            this.trigger('hitOver', this.hit, isOrig, this.origHit);
        },


        // Called when the mouse has just moved out of a hit
        handleHitOut: function() {
            if (this.hit) {
                this.trigger('hitOut', this.hit);
                this.handleHitDone();
                this.hit = null;
            }
        },


        // Called after a hitOut. Also called before a dragStop
        handleHitDone: function() {
            if (this.hit) {
                this.trigger('hitDone', this.hit);
            }
        },


        // Called when the interaction ends, whether there was a real drag or not
        handleInteractionEnd: function() {
            DragListener.prototype.handleInteractionEnd.apply(this, arguments); // call the super-method

            this.origHit = null;
            this.hit = null;

            this.component.releaseHits();
        },


        // Called when scrolling has stopped, whether through auto scroll, or the user scrolling
        handleScrollEnd: function() {
            DragListener.prototype.handleScrollEnd.apply(this, arguments); // call the super-method

            this.computeCoords(); // hits' absolute positions will be in new places. recompute
        },


        // Gets the hit underneath the coordinates for the given mouse event
        queryHit: function(left, top) {

            if (this.coordAdjust) {
                left += this.coordAdjust.left;
                top += this.coordAdjust.top;
            }

            return this.component.queryHit(left, top);
        }

    });


// Returns `true` if the hits are identically equal. `false` otherwise. Must be from the same component.
// Two null values will be considered equal, as two "out of the component" states are the same.
    function isHitsEqual(hit0, hit1) {

        if (!hit0 && !hit1) {
            return true;
        }

        if (hit0 && hit1) {
            return hit0.component === hit1.component &&
                isHitPropsWithin(hit0, hit1) &&
                isHitPropsWithin(hit1, hit0); // ensures all props are identical
        }

        return false;
    }


// Returns true if all of subHit's non-standard properties are within superHit
    function isHitPropsWithin(subHit, superHit) {
        for (var propName in subHit) {
            if (!/^(component|left|right|top|bottom)$/.test(propName)) {
                if (subHit[propName] !== superHit[propName]) {
                    return false;
                }
            }
        }
        return true;
    }

    ;;

    /* Creates a clone of an element and lets it track the mouse as it moves
     ----------------------------------------------------------------------------------------------------------------------*/

    var MouseFollower = Class.extend(ListenerMixin, {

        options: null,

        sourceEl: null, // the element that will be cloned and made to look like it is dragging
        el: null, // the clone of `sourceEl` that will track the mouse
        parentEl: null, // the element that `el` (the clone) will be attached to

        // the initial position of el, relative to the offset parent. made to match the initial offset of sourceEl
        top0: null,
        left0: null,

        // the absolute coordinates of the initiating touch/mouse action
        y0: null,
        x0: null,

        // the number of pixels the mouse has moved from its initial position
        topDelta: null,
        leftDelta: null,

        isFollowing: false,
        isHidden: false,
        isAnimating: false, // doing the revert animation?

        constructor: function(sourceEl, options) {
            this.options = options = options || {};
            this.sourceEl = sourceEl;
            this.parentEl = options.parentEl ? $(options.parentEl) : sourceEl.parent(); // default to sourceEl's parent
        },


        // Causes the element to start following the mouse
        start: function(ev) {
            if (!this.isFollowing) {
                this.isFollowing = true;

                this.y0 = getEvY(ev);
                this.x0 = getEvX(ev);
                this.topDelta = 0;
                this.leftDelta = 0;

                if (!this.isHidden) {
                    this.updatePosition();
                }

                if (getEvIsTouch(ev)) {
                    this.listenTo($(document), 'touchmove', this.handleMove);
                }
                else {
                    this.listenTo($(document), 'mousemove', this.handleMove);
                }
            }
        },


        // Causes the element to stop following the mouse. If shouldRevert is true, will animate back to original position.
        // `callback` gets invoked when the animation is complete. If no animation, it is invoked immediately.
        stop: function(shouldRevert, callback) {
            var _this = this;
            var revertDuration = this.options.revertDuration;

            function complete() { // might be called by .animate(), which might change `this` context
                _this.isAnimating = false;
                _this.removeElement();

                _this.top0 = _this.left0 = null; // reset state for future updatePosition calls

                if (callback) {
                    callback();
                }
            }

            if (this.isFollowing && !this.isAnimating) { // disallow more than one stop animation at a time
                this.isFollowing = false;

                this.stopListeningTo($(document));

                if (shouldRevert && revertDuration && !this.isHidden) { // do a revert animation?
                    this.isAnimating = true;
                    this.el.animate({
                        top: this.top0,
                        left: this.left0
                    }, {
                        duration: revertDuration,
                        complete: complete
                    });
                }
                else {
                    complete();
                }
            }
        },


        // Gets the tracking element. Create it if necessary
        getEl: function() {
            var el = this.el;

            if (!el) {
                this.sourceEl.width(); // hack to force IE8 to compute correct bounding box
                el = this.el = this.sourceEl.clone()
                    .addClass(this.options.additionalClass || '')
                    .css({
                        position: 'absolute',
                        visibility: '', // in case original element was hidden (commonly through hideEvents())
                        display: this.isHidden ? 'none' : '', // for when initially hidden
                        margin: 0,
                        right: 'auto', // erase and set width instead
                        bottom: 'auto', // erase and set height instead
                        width: this.sourceEl.width(), // explicit height in case there was a 'right' value
                        height: this.sourceEl.height(), // explicit width in case there was a 'bottom' value
                        opacity: this.options.opacity || '',
                        zIndex: this.options.zIndex
                    });

                // we don't want long taps or any mouse interaction causing selection/menus.
                // would use preventSelection(), but that prevents selectstart, causing problems.
                el.addClass('fc-unselectable');

                el.appendTo(this.parentEl);
            }

            return el;
        },


        // Removes the tracking element if it has already been created
        removeElement: function() {
            if (this.el) {
                this.el.remove();
                this.el = null;
            }
        },


        // Update the CSS position of the tracking element
        updatePosition: function() {
            var sourceOffset;
            var origin;

            this.getEl(); // ensure this.el

            // make sure origin info was computed
            if (this.top0 === null) {
                this.sourceEl.width(); // hack to force IE8 to compute correct bounding box
                sourceOffset = this.sourceEl.offset();
                origin = this.el.offsetParent().offset();
                this.top0 = sourceOffset.top - origin.top;
                this.left0 = sourceOffset.left - origin.left;
            }

            this.el.css({
                top: this.top0 + this.topDelta,
                left: this.left0 + this.leftDelta
            });
        },


        // Gets called when the user moves the mouse
        handleMove: function(ev) {
            this.topDelta = getEvY(ev) - this.y0;
            this.leftDelta = getEvX(ev) - this.x0;

            if (!this.isHidden) {
                this.updatePosition();
            }
        },


        // Temporarily makes the tracking element invisible. Can be called before following starts
        hide: function() {
            if (!this.isHidden) {
                this.isHidden = true;
                if (this.el) {
                    this.el.hide();
                }
            }
        },


        // Show the tracking element after it has been temporarily hidden
        show: function() {
            if (this.isHidden) {
                this.isHidden = false;
                this.updatePosition();
                this.getEl().show();
            }
        }

    });

    ;;

    /* An abstract class comprised of a "grid" of areas that each represent a specific datetime
     ----------------------------------------------------------------------------------------------------------------------*/

    var Grid = FC.Grid = Class.extend(ListenerMixin, MouseIgnorerMixin, {

        view: null, // a View object
        isRTL: null, // shortcut to the view's isRTL option

        start: null,
        end: null,

        el: null, // the containing element
        elsByFill: null, // a hash of jQuery element sets used for rendering each fill. Keyed by fill name.

        // derived from options
        eventTimeFormat: null,
        displayEventTime: null,
        displayEventEnd: null,

        minResizeDuration: null, // TODO: hack. set by subclasses. minumum event resize duration

        // if defined, holds the unit identified (ex: "year" or "month") that determines the level of granularity
        // of the date areas. if not defined, assumes to be day and time granularity.
        // TODO: port isTimeScale into same system?
        largeUnit: null,

        dayDragListener: null,
        segDragListener: null,
        segResizeListener: null,
        externalDragListener: null,


        constructor: function(view) {
            this.view = view;
            this.isRTL = view.opt('isRTL');
            this.elsByFill = {};

            this.dayDragListener = this.buildDayDragListener();
            this.initMouseIgnoring();
        },


        /* Options
         ------------------------------------------------------------------------------------------------------------------*/


        // Generates the format string used for event time text, if not explicitly defined by 'timeFormat'
        computeEventTimeFormat: function() {
            return this.view.opt('smallTimeFormat');
        },


        // Determines whether events should have their end times displayed, if not explicitly defined by 'displayEventTime'.
        // Only applies to non-all-day events.
        computeDisplayEventTime: function() {
            return true;
        },


        // Determines whether events should have their end times displayed, if not explicitly defined by 'displayEventEnd'
        computeDisplayEventEnd: function() {
            return true;
        },


        /* Dates
         ------------------------------------------------------------------------------------------------------------------*/


        // Tells the grid about what period of time to display.
        // Any date-related internal data should be generated.
        setRange: function(range) {
            this.start = range.start.clone();
            this.end = range.end.clone();

            this.rangeUpdated();
            this.processRangeOptions();
        },


        // Called when internal variables that rely on the range should be updated
        rangeUpdated: function() {
        },


        // Updates values that rely on options and also relate to range
        processRangeOptions: function() {
            var view = this.view;
            var displayEventTime;
            var displayEventEnd;

            this.eventTimeFormat =
                view.opt('eventTimeFormat') ||
                view.opt('timeFormat') || // deprecated
                this.computeEventTimeFormat();

            displayEventTime = view.opt('displayEventTime');
            if (displayEventTime == null) {
                displayEventTime = this.computeDisplayEventTime(); // might be based off of range
            }

            displayEventEnd = view.opt('displayEventEnd');
            if (displayEventEnd == null) {
                displayEventEnd = this.computeDisplayEventEnd(); // might be based off of range
            }

            this.displayEventTime = displayEventTime;
            this.displayEventEnd = displayEventEnd;
        },


        // Converts a span (has unzoned start/end and any other grid-specific location information)
        // into an array of segments (pieces of events whose format is decided by the grid).
        spanToSegs: function(span) {
            // subclasses must implement
        },


        // Diffs the two dates, returning a duration, based on granularity of the grid
        // TODO: port isTimeScale into this system?
        diffDates: function(a, b) {
            if (this.largeUnit) {
                return diffByUnit(a, b, this.largeUnit);
            }
            else {
                return diffDayTime(a, b);
            }
        },


        /* Hit Area
         ------------------------------------------------------------------------------------------------------------------*/


        // Called before one or more queryHit calls might happen. Should prepare any cached coordinates for queryHit
        prepareHits: function() {
        },


        // Called when queryHit calls have subsided. Good place to clear any coordinate caches.
        releaseHits: function() {
        },


        // Given coordinates from the topleft of the document, return data about the date-related area underneath.
        // Can return an object with arbitrary properties (although top/right/left/bottom are encouraged).
        // Must have a `grid` property, a reference to this current grid. TODO: avoid this
        // The returned object will be processed by getHitSpan and getHitEl.
        queryHit: function(leftOffset, topOffset) {
        },


        // Given position-level information about a date-related area within the grid,
        // should return an object with at least a start/end date. Can provide other information as well.
        getHitSpan: function(hit) {
        },


        // Given position-level information about a date-related area within the grid,
        // should return a jQuery element that best represents it. passed to dayClick callback.
        getHitEl: function(hit) {
        },


        /* Rendering
         ------------------------------------------------------------------------------------------------------------------*/


        // Sets the container element that the grid should render inside of.
        // Does other DOM-related initializations.
        setElement: function(el) {
            this.el = el;
            preventSelection(el);

            this.bindDayHandler('touchstart', this.dayTouchStart);
            this.bindDayHandler('mousedown', this.dayMousedown);

            // attach event-element-related handlers. in Grid.events
            // same garbage collection note as above.
            this.bindSegHandlers();

            this.bindGlobalHandlers();
        },


        bindDayHandler: function(name, handler) {
            var _this = this;

            // attach a handler to the grid's root element.
            // jQuery will take care of unregistering them when removeElement gets called.
            this.el.on(name, function(ev) {
                if (
                    !$(ev.target).is('.fc-event-container *, .fc-more') // not an an event element, or "more.." link
                ) {
                    return handler.call(_this, ev);
                }
            });
        },


        // Removes the grid's container element from the DOM. Undoes any other DOM-related attachments.
        // DOES NOT remove any content beforehand (doesn't clear events or call unrenderDates), unlike View
        removeElement: function() {
            this.unbindGlobalHandlers();
            this.clearDragListeners();

            this.el.remove();

            // NOTE: we don't null-out this.el for the same reasons we don't do it within View::removeElement
        },


        // Renders the basic structure of grid view before any content is rendered
        renderSkeleton: function() {
            // subclasses should implement
        },


        // Renders the grid's date-related content (like areas that represent days/times).
        // Assumes setRange has already been called and the skeleton has already been rendered.
        renderDates: function() {
            // subclasses should implement
        },


        // Unrenders the grid's date-related content
        unrenderDates: function() {
            // subclasses should implement
        },


        /* Handlers
         ------------------------------------------------------------------------------------------------------------------*/


        // Binds DOM handlers to elements that reside outside the grid, such as the document
        bindGlobalHandlers: function() {
            this.listenTo($(document), {
                dragstart: this.externalDragStart, // jqui
                sortstart: this.externalDragStart // jqui
            });
        },


        // Unbinds DOM handlers from elements that reside outside the grid
        unbindGlobalHandlers: function() {
            this.stopListeningTo($(document));
        },


        // Process a mousedown on an element that represents a day. For day clicking and selecting.
        dayMousedown: function(ev) {
            if (!this.isIgnoringMouse) {
                this.dayDragListener.startInteraction(ev, {
                    //distance: 5, // needs more work if we want dayClick to fire correctly
                });
            }
        },


        dayTouchStart: function(ev) {
            var view = this.view;

            // HACK to prevent a user's clickaway for unselecting a range or an event
            // from causing a dayClick.
            if (view.isSelected || view.selectedEvent) {
                this.tempIgnoreMouse();
            }

            this.dayDragListener.startInteraction(ev, {
                delay: this.view.opt('longPressDelay')
            });
        },


        // Creates a listener that tracks the user's drag across day elements.
        // For day clicking and selecting.
        buildDayDragListener: function() {
            var _this = this;
            var view = this.view;
            var isSelectable = view.opt('selectable');
            var dayClickHit; // null if invalid dayClick
            var selectionSpan; // null if invalid selection

            // this listener tracks a mousedown on a day element, and a subsequent drag.
            // if the drag ends on the same day, it is a 'dayClick'.
            // if 'selectable' is enabled, this listener also detects selections.
            var dragListener = new HitDragListener(this, {
                scroll: view.opt('dragScroll'),
                interactionStart: function() {
                    dayClickHit = dragListener.origHit; // for dayClick, where no dragging happens
                    selectionSpan = null;
                },
                dragStart: function() {
                    view.unselect(); // since we could be rendering a new selection, we want to clear any old one
                },
                hitOver: function(hit, isOrig, origHit) {
                    if (origHit) { // click needs to have started on a hit

                        // if user dragged to another cell at any point, it can no longer be a dayClick
                        if (!isOrig) {
                            dayClickHit = null;
                        }

                        if (isSelectable) {
                            selectionSpan = _this.computeSelection(
                                _this.getHitSpan(origHit),
                                _this.getHitSpan(hit)
                            );
                            if (selectionSpan) {
                                _this.renderSelection(selectionSpan);
                            }
                            else if (selectionSpan === false) {
                                disableCursor();
                            }
                        }
                    }
                },
                hitOut: function() { // called before mouse moves to a different hit OR moved out of all hits
                    dayClickHit = null;
                    selectionSpan = null;
                    _this.unrenderSelection();
                },
                hitDone: function() { // called after a hitOut OR before a dragEnd
                    enableCursor();
                },
                interactionEnd: function(ev, isCancelled) {
                    if (!isCancelled) {
                        if (
                            dayClickHit &&
                            !_this.isIgnoringMouse // see hack in dayTouchStart
                        ) {
                            view.triggerDayClick(
                                _this.getHitSpan(dayClickHit),
                                _this.getHitEl(dayClickHit),
                                ev
                            );
                        }
                        if (selectionSpan) {
                            // the selection will already have been rendered. just report it
                            view.reportSelection(selectionSpan, ev);
                        }
                    }
                }
            });

            return dragListener;
        },


        // Kills all in-progress dragging.
        // Useful for when public API methods that result in re-rendering are invoked during a drag.
        // Also useful for when touch devices misbehave and don't fire their touchend.
        clearDragListeners: function() {
            this.dayDragListener.endInteraction();

            if (this.segDragListener) {
                this.segDragListener.endInteraction(); // will clear this.segDragListener
            }
            if (this.segResizeListener) {
                this.segResizeListener.endInteraction(); // will clear this.segResizeListener
            }
            if (this.externalDragListener) {
                this.externalDragListener.endInteraction(); // will clear this.externalDragListener
            }
        },


        /* Event Helper
         ------------------------------------------------------------------------------------------------------------------*/
        // TODO: should probably move this to Grid.events, like we did event dragging / resizing


        // Renders a mock event at the given event location, which contains zoned start/end properties.
        // Returns all mock event elements.
        renderEventLocationHelper: function(eventLocation, sourceSeg) {
            var fakeEvent = this.fabricateHelperEvent(eventLocation, sourceSeg);

            return this.renderHelper(fakeEvent, sourceSeg); // do the actual rendering
        },


        // Builds a fake event given zoned event date properties and a segment is should be inspired from.
        // The range's end can be null, in which case the mock event that is rendered will have a null end time.
        // `sourceSeg` is the internal segment object involved in the drag. If null, something external is dragging.
        fabricateHelperEvent: function(eventLocation, sourceSeg) {
            var fakeEvent = sourceSeg ? createObject(sourceSeg.event) : {}; // mask the original event object if possible

            fakeEvent.start = eventLocation.start.clone();
            fakeEvent.end = eventLocation.end ? eventLocation.end.clone() : null;
            fakeEvent.allDay = null; // force it to be freshly computed by normalizeEventDates
            this.view.calendar.normalizeEventDates(fakeEvent);

            // this extra className will be useful for differentiating real events from mock events in CSS
            fakeEvent.className = (fakeEvent.className || []).concat('fc-helper');

            // if something external is being dragged in, don't render a resizer
            if (!sourceSeg) {
                fakeEvent.editable = false;
            }

            return fakeEvent;
        },


        // Renders a mock event. Given zoned event date properties.
        // Must return all mock event elements.
        renderHelper: function(eventLocation, sourceSeg) {
            // subclasses must implement
        },


        // Unrenders a mock event
        unrenderHelper: function() {
            // subclasses must implement
        },


        /* Selection
         ------------------------------------------------------------------------------------------------------------------*/


        // Renders a visual indication of a selection. Will highlight by default but can be overridden by subclasses.
        // Given a span (unzoned start/end and other misc data)
        renderSelection: function(span) {
            this.renderHighlight(span);
        },


        // Unrenders any visual indications of a selection. Will unrender a highlight by default.
        unrenderSelection: function() {
            this.unrenderHighlight();
        },


        // Given the first and last date-spans of a selection, returns another date-span object.
        // Subclasses can override and provide additional data in the span object. Will be passed to renderSelection().
        // Will return false if the selection is invalid and this should be indicated to the user.
        // Will return null/undefined if a selection invalid but no error should be reported.
        computeSelection: function(span0, span1) {
            var span = this.computeSelectionSpan(span0, span1);

            if (span && !this.view.calendar.isSelectionSpanAllowed(span)) {
                return false;
            }

            return span;
        },


        // Given two spans, must return the combination of the two.
        // TODO: do this separation of concerns (combining VS validation) for event dnd/resize too.
        computeSelectionSpan: function(span0, span1) {
            var dates = [ span0.start, span0.end, span1.start, span1.end ];

            dates.sort(compareNumbers); // sorts chronologically. works with Moments

            return { start: dates[0].clone(), end: dates[3].clone() };
        },


        /* Highlight
         ------------------------------------------------------------------------------------------------------------------*/


        // Renders an emphasis on the given date range. Given a span (unzoned start/end and other misc data)
        renderHighlight: function(span) {
            this.renderFill('highlight', this.spanToSegs(span));
        },


        // Unrenders the emphasis on a date range
        unrenderHighlight: function() {
            this.unrenderFill('highlight');
        },


        // Generates an array of classNames for rendering the highlight. Used by the fill system.
        highlightSegClasses: function() {
            return [ 'fc-highlight' ];
        },


        /* Business Hours
         ------------------------------------------------------------------------------------------------------------------*/


        renderBusinessHours: function() {
        },


        unrenderBusinessHours: function() {
        },


        /* Now Indicator
         ------------------------------------------------------------------------------------------------------------------*/


        getNowIndicatorUnit: function() {
        },


        renderNowIndicator: function(date) {
        },


        unrenderNowIndicator: function() {
        },


        /* Fill System (highlight, background events, business hours)
         --------------------------------------------------------------------------------------------------------------------
         TODO: remove this system. like we did in TimeGrid
         */


        // Renders a set of rectangles over the given segments of time.
        // MUST RETURN a subset of segs, the segs that were actually rendered.
        // Responsible for populating this.elsByFill. TODO: better API for expressing this requirement
        renderFill: function(type, segs) {
            // subclasses must implement
        },


        // Unrenders a specific type of fill that is currently rendered on the grid
        unrenderFill: function(type) {
            var el = this.elsByFill[type];

            if (el) {
                el.remove();
                delete this.elsByFill[type];
            }
        },


        // Renders and assigns an `el` property for each fill segment. Generic enough to work with different types.
        // Only returns segments that successfully rendered.
        // To be harnessed by renderFill (implemented by subclasses).
        // Analagous to renderFgSegEls.
        renderFillSegEls: function(type, segs) {
            var _this = this;
            var segElMethod = this[type + 'SegEl'];
            var html = '';
            var renderedSegs = [];
            var i;

            if (segs.length) {

                // build a large concatenation of segment HTML
                for (i = 0; i < segs.length; i++) {
                    html += this.fillSegHtml(type, segs[i]);
                }

                // Grab individual elements from the combined HTML string. Use each as the default rendering.
                // Then, compute the 'el' for each segment.
                $(html).each(function(i, node) {
                    var seg = segs[i];
                    var el = $(node);

                    // allow custom filter methods per-type
                    if (segElMethod) {
                        el = segElMethod.call(_this, seg, el);
                    }

                    if (el) { // custom filters did not cancel the render
                        el = $(el); // allow custom filter to return raw DOM node

                        // correct element type? (would be bad if a non-TD were inserted into a table for example)
                        if (el.is(_this.fillSegTag)) {
                            seg.el = el;
                            renderedSegs.push(seg);
                        }
                    }
                });
            }

            return renderedSegs;
        },


        fillSegTag: 'div', // subclasses can override


        // Builds the HTML needed for one fill segment. Generic enough to work with different types.
        fillSegHtml: function(type, seg) {

            // custom hooks per-type
            var classesMethod = this[type + 'SegClasses'];
            var cssMethod = this[type + 'SegCss'];

            var classes = classesMethod ? classesMethod.call(this, seg) : [];
            var css = cssToStr(cssMethod ? cssMethod.call(this, seg) : {});

            return '<' + this.fillSegTag +
                (classes.length ? ' class="' + classes.join(' ') + '"' : '') +
                (css ? ' style="' + css + '"' : '') +
                ' />';
        },



        /* Generic rendering utilities for subclasses
         ------------------------------------------------------------------------------------------------------------------*/


        // Computes HTML classNames for a single-day element
        getDayClasses: function(date) {
            var view = this.view;
            var today = view.calendar.getNow();
            var classes = [ 'fc-' + dayIDs[date.day()] ];

            if (
                view.intervalDuration.as('months') == 1 &&
                date.month() != view.intervalStart.month()
            ) {
                classes.push('fc-other-month');
            }

            if (date.isSame(today, 'day')) {
                classes.push(
                    'fc-today',
                    view.highlightStateClass
                );
            }
            else if (date < today) {
                classes.push('fc-past');
            }
            else {
                classes.push('fc-future');
            }

            return classes;
        }

    });

    ;;

    /* Event-rendering and event-interaction methods for the abstract Grid class
     ----------------------------------------------------------------------------------------------------------------------*/

    Grid.mixin({

        mousedOverSeg: null, // the segment object the user's mouse is over. null if over nothing
        isDraggingSeg: false, // is a segment being dragged? boolean
        isResizingSeg: false, // is a segment being resized? boolean
        isDraggingExternal: false, // jqui-dragging an external element? boolean
        segs: null, // the *event* segments currently rendered in the grid. TODO: rename to `eventSegs`


        // Renders the given events onto the grid
        renderEvents: function(events) {
            var bgEvents = [];
            var fgEvents = [];
            var i;

            for (i = 0; i < events.length; i++) {
                (isBgEvent(events[i]) ? bgEvents : fgEvents).push(events[i]);
            }

            this.segs = [].concat( // record all segs
                this.renderBgEvents(bgEvents),
                this.renderFgEvents(fgEvents)
            );
        },


        renderBgEvents: function(events) {
            var segs = this.eventsToSegs(events);

            // renderBgSegs might return a subset of segs, segs that were actually rendered
            return this.renderBgSegs(segs) || segs;
        },


        renderFgEvents: function(events) {
            var segs = this.eventsToSegs(events);

            // renderFgSegs might return a subset of segs, segs that were actually rendered
            return this.renderFgSegs(segs) || segs;
        },


        // Unrenders all events currently rendered on the grid
        unrenderEvents: function() {
            this.handleSegMouseout(); // trigger an eventMouseout if user's mouse is over an event
            this.clearDragListeners();

            this.unrenderFgSegs();
            this.unrenderBgSegs();

            this.segs = null;
        },


        // Retrieves all rendered segment objects currently rendered on the grid
        getEventSegs: function() {
            return this.segs || [];
        },


        /* Foreground Segment Rendering
         ------------------------------------------------------------------------------------------------------------------*/


        // Renders foreground event segments onto the grid. May return a subset of segs that were rendered.
        renderFgSegs: function(segs) {
            // subclasses must implement
        },


        // Unrenders all currently rendered foreground segments
        unrenderFgSegs: function() {
            // subclasses must implement
        },


        // Renders and assigns an `el` property for each foreground event segment.
        // Only returns segments that successfully rendered.
        // A utility that subclasses may use.
        renderFgSegEls: function(segs, disableResizing) {
            var view = this.view;
            var html = '';
            var renderedSegs = [];
            var i;

            if (segs.length) { // don't build an empty html string

                // build a large concatenation of event segment HTML
                for (i = 0; i < segs.length; i++) {
                    html += this.fgSegHtml(segs[i], disableResizing);
                }

                // Grab individual elements from the combined HTML string. Use each as the default rendering.
                // Then, compute the 'el' for each segment. An el might be null if the eventRender callback returned false.
                $(html).each(function(i, node) {
                    var seg = segs[i];
                    var el = view.resolveEventEl(seg.event, $(node));

                    if (el) {
                        el.data('fc-seg', seg); // used by handlers
                        seg.el = el;
                        renderedSegs.push(seg);
                    }
                });
            }

            return renderedSegs;
        },


        // Generates the HTML for the default rendering of a foreground event segment. Used by renderFgSegEls()
        fgSegHtml: function(seg, disableResizing) {
            // subclasses should implement
        },


        /* Background Segment Rendering
         ------------------------------------------------------------------------------------------------------------------*/


        // Renders the given background event segments onto the grid.
        // Returns a subset of the segs that were actually rendered.
        renderBgSegs: function(segs) {
            return this.renderFill('bgEvent', segs);
        },


        // Unrenders all the currently rendered background event segments
        unrenderBgSegs: function() {
            this.unrenderFill('bgEvent');
        },


        // Renders a background event element, given the default rendering. Called by the fill system.
        bgEventSegEl: function(seg, el) {
            return this.view.resolveEventEl(seg.event, el); // will filter through eventRender
        },


        // Generates an array of classNames to be used for the default rendering of a background event.
        // Called by fillSegHtml.
        bgEventSegClasses: function(seg) {
            var event = seg.event;
            var source = event.source || {};

            return [ 'fc-bgevent' ].concat(
                event.className,
                source.className || []
            );
        },


        // Generates a semicolon-separated CSS string to be used for the default rendering of a background event.
        // Called by fillSegHtml.
        bgEventSegCss: function(seg) {
            return {
                'background-color': this.getSegSkinCss(seg)['background-color']
            };
        },


        // Generates an array of classNames to be used for the rendering business hours overlay. Called by the fill system.
        // Called by fillSegHtml.
        businessHoursSegClasses: function(seg) {
            return [ 'fc-nonbusiness', 'fc-bgevent' ];
        },


        /* Business Hours
         ------------------------------------------------------------------------------------------------------------------*/


        // Compute business hour segs for the grid's current date range.
        // Caller must ask if whole-day business hours are needed.
        buildBusinessHourSegs: function(wholeDay) {
            var events = this.view.calendar.getCurrentBusinessHourEvents(wholeDay);

            // HACK. Eventually refactor business hours "events" system.
            // If no events are given, but businessHours is activated, this means the entire visible range should be
            // marked as *not* business-hours, via inverse-background rendering.
            if (
                !events.length &&
                this.view.calendar.options.businessHours // don't access view option. doesn't update with dynamic options
            ) {
                events = [
                    $.extend({}, BUSINESS_HOUR_EVENT_DEFAULTS, {
                        start: this.view.end, // guaranteed out-of-range
                        end: this.view.end,   // "
                        dow: null
                    })
                ];
            }

            return this.eventsToSegs(events);
        },


        /* Handlers
         ------------------------------------------------------------------------------------------------------------------*/


        // Attaches event-element-related handlers for *all* rendered event segments of the view.
        bindSegHandlers: function() {
            this.bindSegHandlersToEl(this.el);
        },


        // Attaches event-element-related handlers to an arbitrary container element. leverages bubbling.
        bindSegHandlersToEl: function(el) {
            this.bindSegHandlerToEl(el, 'touchstart', this.handleSegTouchStart);
            this.bindSegHandlerToEl(el, 'touchend', this.handleSegTouchEnd);
            this.bindSegHandlerToEl(el, 'mouseenter', this.handleSegMouseover);
            this.bindSegHandlerToEl(el, 'mouseleave', this.handleSegMouseout);
            this.bindSegHandlerToEl(el, 'mousedown', this.handleSegMousedown);
            this.bindSegHandlerToEl(el, 'click', this.handleSegClick);
        },


        // Executes a handler for any a user-interaction on a segment.
        // Handler gets called with (seg, ev), and with the `this` context of the Grid
        bindSegHandlerToEl: function(el, name, handler) {
            var _this = this;

            el.on(name, '.fc-event-container > *', function(ev) {
                var seg = $(this).data('fc-seg'); // grab segment data. put there by View::renderEvents

                // only call the handlers if there is not a drag/resize in progress
                if (seg && !_this.isDraggingSeg && !_this.isResizingSeg) {
                    return handler.call(_this, seg, ev); // context will be the Grid
                }
            });
        },


        handleSegClick: function(seg, ev) {
            return this.view.trigger('eventClick', seg.el[0], seg.event, ev); // can return `false` to cancel
        },


        // Updates internal state and triggers handlers for when an event element is moused over
        handleSegMouseover: function(seg, ev) {
            if (
                !this.isIgnoringMouse &&
                !this.mousedOverSeg
            ) {
                this.mousedOverSeg = seg;
                seg.el.addClass('fc-allow-mouse-resize');
                this.view.trigger('eventMouseover', seg.el[0], seg.event, ev);
            }
        },


        // Updates internal state and triggers handlers for when an event element is moused out.
        // Can be given no arguments, in which case it will mouseout the segment that was previously moused over.
        handleSegMouseout: function(seg, ev) {
            ev = ev || {}; // if given no args, make a mock mouse event

            if (this.mousedOverSeg) {
                seg = seg || this.mousedOverSeg; // if given no args, use the currently moused-over segment
                this.mousedOverSeg = null;
                seg.el.removeClass('fc-allow-mouse-resize');
                this.view.trigger('eventMouseout', seg.el[0], seg.event, ev);
            }
        },


        handleSegMousedown: function(seg, ev) {
            var isResizing = this.startSegResize(seg, ev, { distance: 5 });

            if (!isResizing && this.view.isEventDraggable(seg.event)) {
                this.buildSegDragListener(seg)
                    .startInteraction(ev, {
                        distance: 5
                    });
            }
        },


        handleSegTouchStart: function(seg, ev) {
            var view = this.view;
            var event = seg.event;
            var isSelected = view.isEventSelected(event);
            var isDraggable = view.isEventDraggable(event);
            var isResizable = view.isEventResizable(event);
            var isResizing = false;
            var dragListener;

            if (isSelected && isResizable) {
                // only allow resizing of the event is selected
                isResizing = this.startSegResize(seg, ev);
            }

            if (!isResizing && (isDraggable || isResizable)) { // allowed to be selected?

                dragListener = isDraggable ?
                    this.buildSegDragListener(seg) :
                    this.buildSegSelectListener(seg); // seg isn't draggable, but still needs to be selected

                dragListener.startInteraction(ev, { // won't start if already started
                    delay: isSelected ? 0 : this.view.opt('longPressDelay') // do delay if not already selected
                });
            }

            // a long tap simulates a mouseover. ignore this bogus mouseover.
            this.tempIgnoreMouse();
        },


        handleSegTouchEnd: function(seg, ev) {
            // touchstart+touchend = click, which simulates a mouseover.
            // ignore this bogus mouseover.
            this.tempIgnoreMouse();
        },


        // returns boolean whether resizing actually started or not.
        // assumes the seg allows resizing.
        // `dragOptions` are optional.
        startSegResize: function(seg, ev, dragOptions) {
            if ($(ev.target).is('.fc-resizer')) {
                this.buildSegResizeListener(seg, $(ev.target).is('.fc-start-resizer'))
                    .startInteraction(ev, dragOptions);
                return true;
            }
            return false;
        },



        /* Event Dragging
         ------------------------------------------------------------------------------------------------------------------*/


        // Builds a listener that will track user-dragging on an event segment.
        // Generic enough to work with any type of Grid.
        // Has side effect of setting/unsetting `segDragListener`
        buildSegDragListener: function(seg) {
            var _this = this;
            var view = this.view;
            var calendar = view.calendar;
            var el = seg.el;
            var event = seg.event;
            var isDragging;
            var mouseFollower; // A clone of the original element that will move with the mouse
            var dropLocation; // zoned event date properties

            if (this.segDragListener) {
                return this.segDragListener;
            }

            // Tracks mouse movement over the *view's* coordinate map. Allows dragging and dropping between subcomponents
            // of the view.
            var dragListener = this.segDragListener = new HitDragListener(view, {
                scroll: view.opt('dragScroll'),
                subjectEl: el,
                subjectCenter: true,
                interactionStart: function(ev) {
                    seg.component = _this; // for renderDrag
                    isDragging = false;
                    mouseFollower = new MouseFollower(seg.el, {
                        additionalClass: 'fc-dragging',
                        parentEl: view.el,
                        opacity: dragListener.isTouch ? null : view.opt('dragOpacity'),
                        revertDuration: view.opt('dragRevertDuration'),
                        zIndex: 2 // one above the .fc-view
                    });
                    mouseFollower.hide(); // don't show until we know this is a real drag
                    mouseFollower.start(ev);
                },
                dragStart: function(ev) {
                    if (dragListener.isTouch && !view.isEventSelected(event)) {
                        // if not previously selected, will fire after a delay. then, select the event
                        view.selectEvent(event);
                    }
                    isDragging = true;
                    _this.handleSegMouseout(seg, ev); // ensure a mouseout on the manipulated event has been reported
                    _this.segDragStart(seg, ev);
                    view.hideEvent(event); // hide all event segments. our mouseFollower will take over
                },
                hitOver: function(hit, isOrig, origHit) {
                    var dragHelperEls;

                    // starting hit could be forced (DayGrid.limit)
                    if (seg.hit) {
                        origHit = seg.hit;
                    }

                    // since we are querying the parent view, might not belong to this grid
                    dropLocation = _this.computeEventDrop(
                        origHit.component.getHitSpan(origHit),
                        hit.component.getHitSpan(hit),
                        event
                    );

                    if (dropLocation && !calendar.isEventSpanAllowed(_this.eventToSpan(dropLocation), event)) {
                        disableCursor();
                        dropLocation = null;
                    }

                    // if a valid drop location, have the subclass render a visual indication
                    if (dropLocation && (dragHelperEls = view.renderDrag(dropLocation, seg))) {

                        dragHelperEls.addClass('fc-dragging');
                        if (!dragListener.isTouch) {
                            _this.applyDragOpacity(dragHelperEls);
                        }

                        mouseFollower.hide(); // if the subclass is already using a mock event "helper", hide our own
                    }
                    else {
                        mouseFollower.show(); // otherwise, have the helper follow the mouse (no snapping)
                    }

                    if (isOrig) {
                        dropLocation = null; // needs to have moved hits to be a valid drop
                    }
                },
                hitOut: function() { // called before mouse moves to a different hit OR moved out of all hits
                    view.unrenderDrag(); // unrender whatever was done in renderDrag
                    mouseFollower.show(); // show in case we are moving out of all hits
                    dropLocation = null;
                },
                hitDone: function() { // Called after a hitOut OR before a dragEnd
                    enableCursor();
                },
                interactionEnd: function(ev) {
                    delete seg.component; // prevent side effects

                    // do revert animation if hasn't changed. calls a callback when finished (whether animation or not)
                    mouseFollower.stop(!dropLocation, function() {
                        if (isDragging) {
                            view.unrenderDrag();
                            view.showEvent(event);
                            _this.segDragStop(seg, ev);
                        }
                        if (dropLocation) {
                            view.reportEventDrop(event, dropLocation, this.largeUnit, el, ev);
                        }
                    });
                    _this.segDragListener = null;
                }
            });

            return dragListener;
        },


        // seg isn't draggable, but let's use a generic DragListener
        // simply for the delay, so it can be selected.
        // Has side effect of setting/unsetting `segDragListener`
        buildSegSelectListener: function(seg) {
            var _this = this;
            var view = this.view;
            var event = seg.event;

            if (this.segDragListener) {
                return this.segDragListener;
            }

            var dragListener = this.segDragListener = new DragListener({
                dragStart: function(ev) {
                    if (dragListener.isTouch && !view.isEventSelected(event)) {
                        // if not previously selected, will fire after a delay. then, select the event
                        view.selectEvent(event);
                    }
                },
                interactionEnd: function(ev) {
                    _this.segDragListener = null;
                }
            });

            return dragListener;
        },


        // Called before event segment dragging starts
        segDragStart: function(seg, ev) {
            this.isDraggingSeg = true;
            this.view.trigger('eventDragStart', seg.el[0], seg.event, ev, {}); // last argument is jqui dummy
        },


        // Called after event segment dragging stops
        segDragStop: function(seg, ev) {
            this.isDraggingSeg = false;
            this.view.trigger('eventDragStop', seg.el[0], seg.event, ev, {}); // last argument is jqui dummy
        },


        // Given the spans an event drag began, and the span event was dropped, calculates the new zoned start/end/allDay
        // values for the event. Subclasses may override and set additional properties to be used by renderDrag.
        // A falsy returned value indicates an invalid drop.
        // DOES NOT consider overlap/constraint.
        computeEventDrop: function(startSpan, endSpan, event) {
            var calendar = this.view.calendar;
            var dragStart = startSpan.start;
            var dragEnd = endSpan.start;
            var delta;
            var dropLocation; // zoned event date properties

            if (dragStart.hasTime() === dragEnd.hasTime()) {
                delta = this.diffDates(dragEnd, dragStart);

                // if an all-day event was in a timed area and it was dragged to a different time,
                // guarantee an end and adjust start/end to have times
                if (event.allDay && durationHasTime(delta)) {
                    dropLocation = {
                        start: event.start.clone(),
                        end: calendar.getEventEnd(event), // will be an ambig day
                        allDay: false // for normalizeEventTimes
                    };
                    calendar.normalizeEventTimes(dropLocation);
                }
                // othewise, work off existing values
                else {
                    dropLocation = {
                        start: event.start.clone(),
                        end: event.end ? event.end.clone() : null,
                        allDay: event.allDay // keep it the same
                    };
                }

                dropLocation.start.add(delta);
                if (dropLocation.end) {
                    dropLocation.end.add(delta);
                }
            }
            else {
                // if switching from day <-> timed, start should be reset to the dropped date, and the end cleared
                dropLocation = {
                    start: dragEnd.clone(),
                    end: null, // end should be cleared
                    allDay: !dragEnd.hasTime()
                };
            }

            return dropLocation;
        },


        // Utility for apply dragOpacity to a jQuery set
        applyDragOpacity: function(els) {
            var opacity = this.view.opt('dragOpacity');

            if (opacity != null) {
                els.each(function(i, node) {
                    // Don't use jQuery (will set an IE filter), do it the old fashioned way.
                    // In IE8, a helper element will disappears if there's a filter.
                    node.style.opacity = opacity;
                });
            }
        },


        /* External Element Dragging
         ------------------------------------------------------------------------------------------------------------------*/


        // Called when a jQuery UI drag is initiated anywhere in the DOM
        externalDragStart: function(ev, ui) {
            var view = this.view;
            var el;
            var accept;

            if (view.opt('droppable')) { // only listen if this setting is on
                el = $((ui ? ui.item : null) || ev.target);

                // Test that the dragged element passes the dropAccept selector or filter function.
                // FYI, the default is "*" (matches all)
                accept = view.opt('dropAccept');
                if ($.isFunction(accept) ? accept.call(el[0], el) : el.is(accept)) {
                    if (!this.isDraggingExternal) { // prevent double-listening if fired twice
                        this.listenToExternalDrag(el, ev, ui);
                    }
                }
            }
        },


        // Called when a jQuery UI drag starts and it needs to be monitored for dropping
        listenToExternalDrag: function(el, ev, ui) {
            var _this = this;
            var calendar = this.view.calendar;
            var meta = getDraggedElMeta(el); // extra data about event drop, including possible event to create
            var dropLocation; // a null value signals an unsuccessful drag

            // listener that tracks mouse movement over date-associated pixel regions
            var dragListener = _this.externalDragListener = new HitDragListener(this, {
                interactionStart: function() {
                    _this.isDraggingExternal = true;
                },
                hitOver: function(hit) {
                    dropLocation = _this.computeExternalDrop(
                        hit.component.getHitSpan(hit), // since we are querying the parent view, might not belong to this grid
                        meta
                    );

                    if ( // invalid hit?
                    dropLocation &&
                    !calendar.isExternalSpanAllowed(_this.eventToSpan(dropLocation), dropLocation, meta.eventProps)
                    ) {
                        disableCursor();
                        dropLocation = null;
                    }

                    if (dropLocation) {
                        _this.renderDrag(dropLocation); // called without a seg parameter
                    }
                },
                hitOut: function() {
                    dropLocation = null; // signal unsuccessful
                },
                hitDone: function() { // Called after a hitOut OR before a dragEnd
                    enableCursor();
                    _this.unrenderDrag();
                },
                interactionEnd: function(ev) {
                    if (dropLocation) { // element was dropped on a valid hit
                        _this.view.reportExternalDrop(meta, dropLocation, el, ev, ui);
                    }
                    _this.isDraggingExternal = false;
                    _this.externalDragListener = null;
                }
            });

            dragListener.startDrag(ev); // start listening immediately
        },


        // Given a hit to be dropped upon, and misc data associated with the jqui drag (guaranteed to be a plain object),
        // returns the zoned start/end dates for the event that would result from the hypothetical drop. end might be null.
        // Returning a null value signals an invalid drop hit.
        // DOES NOT consider overlap/constraint.
        computeExternalDrop: function(span, meta) {
            var calendar = this.view.calendar;
            var dropLocation = {
                start: calendar.applyTimezone(span.start), // simulate a zoned event start date
                end: null
            };

            // if dropped on an all-day span, and element's metadata specified a time, set it
            if (meta.startTime && !dropLocation.start.hasTime()) {
                dropLocation.start.time(meta.startTime);
            }

            if (meta.duration) {
                dropLocation.end = dropLocation.start.clone().add(meta.duration);
            }

            return dropLocation;
        },



        /* Drag Rendering (for both events and an external elements)
         ------------------------------------------------------------------------------------------------------------------*/


        // Renders a visual indication of an event or external element being dragged.
        // `dropLocation` contains hypothetical start/end/allDay values the event would have if dropped. end can be null.
        // `seg` is the internal segment object that is being dragged. If dragging an external element, `seg` is null.
        // A truthy returned value indicates this method has rendered a helper element.
        // Must return elements used for any mock events.
        renderDrag: function(dropLocation, seg) {
            // subclasses must implement
        },


        // Unrenders a visual indication of an event or external element being dragged
        unrenderDrag: function() {
            // subclasses must implement
        },


        /* Resizing
         ------------------------------------------------------------------------------------------------------------------*/


        // Creates a listener that tracks the user as they resize an event segment.
        // Generic enough to work with any type of Grid.
        buildSegResizeListener: function(seg, isStart) {
            var _this = this;
            var view = this.view;
            var calendar = view.calendar;
            var el = seg.el;
            var event = seg.event;
            var eventEnd = calendar.getEventEnd(event);
            var isDragging;
            var resizeLocation; // zoned event date properties. falsy if invalid resize

            // Tracks mouse movement over the *grid's* coordinate map
            var dragListener = this.segResizeListener = new HitDragListener(this, {
                scroll: view.opt('dragScroll'),
                subjectEl: el,
                interactionStart: function() {
                    isDragging = false;
                },
                dragStart: function(ev) {
                    isDragging = true;
                    _this.handleSegMouseout(seg, ev); // ensure a mouseout on the manipulated event has been reported
                    _this.segResizeStart(seg, ev);
                },
                hitOver: function(hit, isOrig, origHit) {
                    var origHitSpan = _this.getHitSpan(origHit);
                    var hitSpan = _this.getHitSpan(hit);

                    resizeLocation = isStart ?
                        _this.computeEventStartResize(origHitSpan, hitSpan, event) :
                        _this.computeEventEndResize(origHitSpan, hitSpan, event);

                    if (resizeLocation) {
                        if (!calendar.isEventSpanAllowed(_this.eventToSpan(resizeLocation), event)) {
                            disableCursor();
                            resizeLocation = null;
                        }
                        // no change? (TODO: how does this work with timezones?)
                        else if (resizeLocation.start.isSame(event.start) && resizeLocation.end.isSame(eventEnd)) {
                            resizeLocation = null;
                        }
                    }

                    if (resizeLocation) {
                        view.hideEvent(event);
                        _this.renderEventResize(resizeLocation, seg);
                    }
                },
                hitOut: function() { // called before mouse moves to a different hit OR moved out of all hits
                    resizeLocation = null;
                },
                hitDone: function() { // resets the rendering to show the original event
                    _this.unrenderEventResize();
                    view.showEvent(event);
                    enableCursor();
                },
                interactionEnd: function(ev) {
                    if (isDragging) {
                        _this.segResizeStop(seg, ev);
                    }
                    if (resizeLocation) { // valid date to resize to?
                        view.reportEventResize(event, resizeLocation, this.largeUnit, el, ev);
                    }
                    _this.segResizeListener = null;
                }
            });

            return dragListener;
        },


        // Called before event segment resizing starts
        segResizeStart: function(seg, ev) {
            this.isResizingSeg = true;
            this.view.trigger('eventResizeStart', seg.el[0], seg.event, ev, {}); // last argument is jqui dummy
        },


        // Called after event segment resizing stops
        segResizeStop: function(seg, ev) {
            this.isResizingSeg = false;
            this.view.trigger('eventResizeStop', seg.el[0], seg.event, ev, {}); // last argument is jqui dummy
        },


        // Returns new date-information for an event segment being resized from its start
        computeEventStartResize: function(startSpan, endSpan, event) {
            return this.computeEventResize('start', startSpan, endSpan, event);
        },


        // Returns new date-information for an event segment being resized from its end
        computeEventEndResize: function(startSpan, endSpan, event) {
            return this.computeEventResize('end', startSpan, endSpan, event);
        },


        // Returns new zoned date information for an event segment being resized from its start OR end
        // `type` is either 'start' or 'end'.
        // DOES NOT consider overlap/constraint.
        computeEventResize: function(type, startSpan, endSpan, event) {
            var calendar = this.view.calendar;
            var delta = this.diffDates(endSpan[type], startSpan[type]);
            var resizeLocation; // zoned event date properties
            var defaultDuration;

            // build original values to work from, guaranteeing a start and end
            resizeLocation = {
                start: event.start.clone(),
                end: calendar.getEventEnd(event),
                allDay: event.allDay
            };

            // if an all-day event was in a timed area and was resized to a time, adjust start/end to have times
            if (resizeLocation.allDay && durationHasTime(delta)) {
                resizeLocation.allDay = false;
                calendar.normalizeEventTimes(resizeLocation);
            }

            resizeLocation[type].add(delta); // apply delta to start or end

            // if the event was compressed too small, find a new reasonable duration for it
            if (!resizeLocation.start.isBefore(resizeLocation.end)) {

                defaultDuration =
                    this.minResizeDuration || // TODO: hack
                    (event.allDay ?
                        calendar.defaultAllDayEventDuration :
                        calendar.defaultTimedEventDuration);

                if (type == 'start') { // resizing the start?
                    resizeLocation.start = resizeLocation.end.clone().subtract(defaultDuration);
                }
                else { // resizing the end?
                    resizeLocation.end = resizeLocation.start.clone().add(defaultDuration);
                }
            }

            return resizeLocation;
        },


        // Renders a visual indication of an event being resized.
        // `range` has the updated dates of the event. `seg` is the original segment object involved in the drag.
        // Must return elements used for any mock events.
        renderEventResize: function(range, seg) {
            // subclasses must implement
        },


        // Unrenders a visual indication of an event being resized.
        unrenderEventResize: function() {
            // subclasses must implement
        },


        /* Rendering Utils
         ------------------------------------------------------------------------------------------------------------------*/


        // Compute the text that should be displayed on an event's element.
        // `range` can be the Event object itself, or something range-like, with at least a `start`.
        // If event times are disabled, or the event has no time, will return a blank string.
        // If not specified, formatStr will default to the eventTimeFormat setting,
        // and displayEnd will default to the displayEventEnd setting.
        getEventTimeText: function(range, formatStr, displayEnd) {

            if (formatStr == null) {
                formatStr = this.eventTimeFormat;
            }

            if (displayEnd == null) {
                displayEnd = this.displayEventEnd;
            }

            if (this.displayEventTime && range.start.hasTime()) {
                if (displayEnd && range.end) {
                    return this.view.formatRange(range, formatStr);
                }
                else {
                    return range.start.format(formatStr);
                }
            }

            return '';
        },


        // Generic utility for generating the HTML classNames for an event segment's element
        getSegClasses: function(seg, isDraggable, isResizable) {
            var view = this.view;
            var event = seg.event;
            var classes = [
                'fc-event',
                seg.isStart ? 'fc-start' : 'fc-not-start',
                seg.isEnd ? 'fc-end' : 'fc-not-end'
            ].concat(
                event.className,
                event.source ? event.source.className : []
            );

            if (isDraggable) {
                classes.push('fc-draggable');
            }
            if (isResizable) {
                classes.push('fc-resizable');
            }

            // event is currently selected? attach a className.
            if (view.isEventSelected(event)) {
                classes.push('fc-selected');
            }

            return classes;
        },


        // Utility for generating event skin-related CSS properties
        getSegSkinCss: function(seg) {
            var event = seg.event;
            var view = this.view;
            var source = event.source || {};
            var eventColor = event.color;
            var sourceColor = source.color;
            var optionColor = view.opt('eventColor');

            return {
                'background-color':
                event.backgroundColor ||
                eventColor ||
                source.backgroundColor ||
                sourceColor ||
                view.opt('eventBackgroundColor') ||
                optionColor,
                'border-color':
                event.borderColor ||
                eventColor ||
                source.borderColor ||
                sourceColor ||
                view.opt('eventBorderColor') ||
                optionColor,
                color:
                event.textColor ||
                source.textColor ||
                view.opt('eventTextColor')
            };
        },


        /* Converting events -> eventRange -> eventSpan -> eventSegs
         ------------------------------------------------------------------------------------------------------------------*/


        // Generates an array of segments for the given single event
        // Can accept an event "location" as well (which only has start/end and no allDay)
        eventToSegs: function(event) {
            return this.eventsToSegs([ event ]);
        },


        eventToSpan: function(event) {
            return this.eventToSpans(event)[0];
        },


        // Generates spans (always unzoned) for the given event.
        // Does not do any inverting for inverse-background events.
        // Can accept an event "location" as well (which only has start/end and no allDay)
        eventToSpans: function(event) {
            var range = this.eventToRange(event);
            return this.eventRangeToSpans(range, event);
        },



        // Converts an array of event objects into an array of event segment objects.
        // A custom `segSliceFunc` may be given for arbitrarily slicing up events.
        // Doesn't guarantee an order for the resulting array.
        eventsToSegs: function(allEvents, segSliceFunc) {
            var _this = this;
            var eventsById = groupEventsById(allEvents);
            var segs = [];

            $.each(eventsById, function(id, events) {
                var ranges = [];
                var i;

                for (i = 0; i < events.length; i++) {
                    ranges.push(_this.eventToRange(events[i]));
                }

                // inverse-background events (utilize only the first event in calculations)
                if (isInverseBgEvent(events[0])) {
                    ranges = _this.invertRanges(ranges);

                    for (i = 0; i < ranges.length; i++) {
                        segs.push.apply(segs, // append to
                            _this.eventRangeToSegs(ranges[i], events[0], segSliceFunc));
                    }
                }
                // normal event ranges
                else {
                    for (i = 0; i < ranges.length; i++) {
                        segs.push.apply(segs, // append to
                            _this.eventRangeToSegs(ranges[i], events[i], segSliceFunc));
                    }
                }
            });

            return segs;
        },


        // Generates the unzoned start/end dates an event appears to occupy
        // Can accept an event "location" as well (which only has start/end and no allDay)
        eventToRange: function(event) {
            return {
                start: event.start.clone().stripZone(),
                end: (
                    event.end ?
                        event.end.clone() :
                        // derive the end from the start and allDay. compute allDay if necessary
                        this.view.calendar.getDefaultEventEnd(
                            event.allDay != null ?
                                event.allDay :
                                !event.start.hasTime(),
                            event.start
                        )
                ).stripZone()
            };
        },


        // Given an event's range (unzoned start/end), and the event itself,
        // slice into segments (using the segSliceFunc function if specified)
        eventRangeToSegs: function(range, event, segSliceFunc) {
            var spans = this.eventRangeToSpans(range, event);
            var segs = [];
            var i;

            for (i = 0; i < spans.length; i++) {
                segs.push.apply(segs, // append to
                    this.eventSpanToSegs(spans[i], event, segSliceFunc));
            }

            return segs;
        },


        // Given an event's unzoned date range, return an array of "span" objects.
        // Subclasses can override.
        eventRangeToSpans: function(range, event) {
            return [ $.extend({}, range) ]; // copy into a single-item array
        },


        // Given an event's span (unzoned start/end and other misc data), and the event itself,
        // slices into segments and attaches event-derived properties to them.
        eventSpanToSegs: function(span, event, segSliceFunc) {
            var segs = segSliceFunc ? segSliceFunc(span) : this.spanToSegs(span);
            var i, seg;

            for (i = 0; i < segs.length; i++) {
                seg = segs[i];
                seg.event = event;
                seg.eventStartMS = +span.start; // TODO: not the best name after making spans unzoned
                seg.eventDurationMS = span.end - span.start;
            }

            return segs;
        },


        // Produces a new array of range objects that will cover all the time NOT covered by the given ranges.
        // SIDE EFFECT: will mutate the given array and will use its date references.
        invertRanges: function(ranges) {
            var view = this.view;
            var viewStart = view.start.clone(); // need a copy
            var viewEnd = view.end.clone(); // need a copy
            var inverseRanges = [];
            var start = viewStart; // the end of the previous range. the start of the new range
            var i, range;

            // ranges need to be in order. required for our date-walking algorithm
            ranges.sort(compareRanges);

            for (i = 0; i < ranges.length; i++) {
                range = ranges[i];

                // add the span of time before the event (if there is any)
                if (range.start > start) { // compare millisecond time (skip any ambig logic)
                    inverseRanges.push({
                        start: start,
                        end: range.start
                    });
                }

                start = range.end;
            }

            // add the span of time after the last event (if there is any)
            if (start < viewEnd) { // compare millisecond time (skip any ambig logic)
                inverseRanges.push({
                    start: start,
                    end: viewEnd
                });
            }

            return inverseRanges;
        },


        sortEventSegs: function(segs) {
            segs.sort(proxy(this, 'compareEventSegs'));
        },


        // A cmp function for determining which segments should take visual priority
        compareEventSegs: function(seg1, seg2) {
            return seg1.eventStartMS - seg2.eventStartMS || // earlier events go first
                seg2.eventDurationMS - seg1.eventDurationMS || // tie? longer events go first
                seg2.event.allDay - seg1.event.allDay || // tie? put all-day events first (booleans cast to 0/1)
                compareByFieldSpecs(seg1.event, seg2.event, this.view.eventOrderSpecs);
        }

    });


    /* Utilities
     ----------------------------------------------------------------------------------------------------------------------*/


    function isBgEvent(event) { // returns true if background OR inverse-background
        var rendering = getEventRendering(event);
        return rendering === 'background' || rendering === 'inverse-background';
    }
    FC.isBgEvent = isBgEvent; // export


    function isInverseBgEvent(event) {
        return getEventRendering(event) === 'inverse-background';
    }


    function getEventRendering(event) {
        return firstDefined((event.source || {}).rendering, event.rendering);
    }


    function groupEventsById(events) {
        var eventsById = {};
        var i, event;

        for (i = 0; i < events.length; i++) {
            event = events[i];
            (eventsById[event._id] || (eventsById[event._id] = [])).push(event);
        }

        return eventsById;
    }


// A cmp function for determining which non-inverted "ranges" (see above) happen earlier
    function compareRanges(range1, range2) {
        return range1.start - range2.start; // earlier ranges go first
    }


    /* External-Dragging-Element Data
     ----------------------------------------------------------------------------------------------------------------------*/

// Require all HTML5 data-* attributes used by FullCalendar to have this prefix.
// A value of '' will query attributes like data-event. A value of 'fc' will query attributes like data-fc-event.
    FC.dataAttrPrefix = '';

// Given a jQuery element that might represent a dragged FullCalendar event, returns an intermediate data structure
// to be used for Event Object creation.
// A defined `.eventProps`, even when empty, indicates that an event should be created.
    function getDraggedElMeta(el) {
        var prefix = FC.dataAttrPrefix;
        var eventProps; // properties for creating the event, not related to date/time
        var startTime; // a Duration
        var duration;
        var stick;

        if (prefix) { prefix += '-'; }
        eventProps = el.data(prefix + 'event') || null;

        if (eventProps) {
            if (typeof eventProps === 'object') {
                eventProps = $.extend({}, eventProps); // make a copy
            }
            else { // something like 1 or true. still signal event creation
                eventProps = {};
            }

            // pluck special-cased date/time properties
            startTime = eventProps.start;
            if (startTime == null) { startTime = eventProps.time; } // accept 'time' as well
            duration = eventProps.duration;
            stick = eventProps.stick;
            delete eventProps.start;
            delete eventProps.time;
            delete eventProps.duration;
            delete eventProps.stick;
        }

        // fallback to standalone attribute values for each of the date/time properties
        if (startTime == null) { startTime = el.data(prefix + 'start'); }
        if (startTime == null) { startTime = el.data(prefix + 'time'); } // accept 'time' as well
        if (duration == null) { duration = el.data(prefix + 'duration'); }
        if (stick == null) { stick = el.data(prefix + 'stick'); }

        // massage into correct data types
        startTime = startTime != null ? moment.duration(startTime) : null;
        duration = duration != null ? moment.duration(duration) : null;
        stick = Boolean(stick);

        return { eventProps: eventProps, startTime: startTime, duration: duration, stick: stick };
    }


    ;;

    /*
     A set of rendering and date-related methods for a visual component comprised of one or more rows of day columns.
     Prerequisite: the object being mixed into needs to be a *Grid*
     */
    var DayTableMixin = FC.DayTableMixin = {

        breakOnWeeks: false, // should create a new row for each week?
        dayDates: null, // whole-day dates for each column. left to right
        dayIndices: null, // for each day from start, the offset
        daysPerRow: null,
        rowCnt: null,
        colCnt: null,
        colHeadFormat: null,


        // Populates internal variables used for date calculation and rendering
        updateDayTable: function() {
            var view = this.view;
            var date = this.start.clone();
            var dayIndex = -1;
            var dayIndices = [];
            var dayDates = [];
            var daysPerRow;
            var firstDay;
            var rowCnt;

            while (date.isBefore(this.end)) { // loop each day from start to end
                if (view.isHiddenDay(date)) {
                    dayIndices.push(dayIndex + 0.5); // mark that it's between indices
                }
                else {
                    dayIndex++;
                    dayIndices.push(dayIndex);
                    dayDates.push(date.clone());
                }
                date.add(1, 'days');
            }

            if (this.breakOnWeeks) {
                // count columns until the day-of-week repeats
                firstDay = dayDates[0].day();
                for (daysPerRow = 1; daysPerRow < dayDates.length; daysPerRow++) {
                    if (dayDates[daysPerRow].day() == firstDay) {
                        break;
                    }
                }
                rowCnt = Math.ceil(dayDates.length / daysPerRow);
            }
            else {
                rowCnt = 1;
                daysPerRow = dayDates.length;
            }

            this.dayDates = dayDates;
            this.dayIndices = dayIndices;
            this.daysPerRow = daysPerRow;
            this.rowCnt = rowCnt;

            this.updateDayTableCols();
        },


        // Computes and assigned the colCnt property and updates any options that may be computed from it
        updateDayTableCols: function() {
            this.colCnt = this.computeColCnt();
            this.colHeadFormat = this.view.opt('columnFormat') || this.computeColHeadFormat();
        },


        // Determines how many columns there should be in the table
        computeColCnt: function() {
            return this.daysPerRow;
        },


        // Computes the ambiguously-timed moment for the given cell
        getCellDate: function(row, col) {
            return this.dayDates[
                this.getCellDayIndex(row, col)
                ].clone();
        },


        // Computes the ambiguously-timed date range for the given cell
        getCellRange: function(row, col) {
            var start = this.getCellDate(row, col);
            var end = start.clone().add(1, 'days');

            return { start: start, end: end };
        },


        // Returns the number of day cells, chronologically, from the first of the grid (0-based)
        getCellDayIndex: function(row, col) {
            return row * this.daysPerRow + this.getColDayIndex(col);
        },


        // Returns the numner of day cells, chronologically, from the first cell in *any given row*
        getColDayIndex: function(col) {
            if (this.isRTL) {
                return this.colCnt - 1 - col;
            }
            else {
                return col;
            }
        },


        // Given a date, returns its chronolocial cell-index from the first cell of the grid.
        // If the date lies between cells (because of hiddenDays), returns a floating-point value between offsets.
        // If before the first offset, returns a negative number.
        // If after the last offset, returns an offset past the last cell offset.
        // Only works for *start* dates of cells. Will not work for exclusive end dates for cells.
        getDateDayIndex: function(date) {
            var dayIndices = this.dayIndices;
            var dayOffset = date.diff(this.start, 'days');

            if (dayOffset < 0) {
                return dayIndices[0] - 1;
            }
            else if (dayOffset >= dayIndices.length) {
                return dayIndices[dayIndices.length - 1] + 1;
            }
            else {
                return dayIndices[dayOffset];
            }
        },


        /* Options
         ------------------------------------------------------------------------------------------------------------------*/


        // Computes a default column header formatting string if `colFormat` is not explicitly defined
        computeColHeadFormat: function() {
            // if more than one week row, or if there are a lot of columns with not much space,
            // put just the day numbers will be in each cell
            if (this.rowCnt > 1 || this.colCnt > 10) {
                return 'ddd'; // "Sat"
            }
            // multiple days, so full single date string WON'T be in title text
            else if (this.colCnt > 1) {
                return this.view.opt('dayOfMonthFormat'); // "Sat 12/10"
            }
            // single day, so full single date string will probably be in title text
            else {
                return 'dddd'; // "Saturday"
            }
        },


        /* Slicing
         ------------------------------------------------------------------------------------------------------------------*/


        // Slices up a date range into a segment for every week-row it intersects with
        sliceRangeByRow: function(range) {
            var daysPerRow = this.daysPerRow;
            var normalRange = this.view.computeDayRange(range); // make whole-day range, considering nextDayThreshold
            var rangeFirst = this.getDateDayIndex(normalRange.start); // inclusive first index
            var rangeLast = this.getDateDayIndex(normalRange.end.clone().subtract(1, 'days')); // inclusive last index
            var segs = [];
            var row;
            var rowFirst, rowLast; // inclusive day-index range for current row
            var segFirst, segLast; // inclusive day-index range for segment

            for (row = 0; row < this.rowCnt; row++) {
                rowFirst = row * daysPerRow;
                rowLast = rowFirst + daysPerRow - 1;

                // intersect segment's offset range with the row's
                segFirst = Math.max(rangeFirst, rowFirst);
                segLast = Math.min(rangeLast, rowLast);

                // deal with in-between indices
                segFirst = Math.ceil(segFirst); // in-between starts round to next cell
                segLast = Math.floor(segLast); // in-between ends round to prev cell

                if (segFirst <= segLast) { // was there any intersection with the current row?
                    segs.push({
                        row: row,

                        // normalize to start of row
                        firstRowDayIndex: segFirst - rowFirst,
                        lastRowDayIndex: segLast - rowFirst,

                        // must be matching integers to be the segment's start/end
                        isStart: segFirst === rangeFirst,
                        isEnd: segLast === rangeLast
                    });
                }
            }

            return segs;
        },


        // Slices up a date range into a segment for every day-cell it intersects with.
        // TODO: make more DRY with sliceRangeByRow somehow.
        sliceRangeByDay: function(range) {
            var daysPerRow = this.daysPerRow;
            var normalRange = this.view.computeDayRange(range); // make whole-day range, considering nextDayThreshold
            var rangeFirst = this.getDateDayIndex(normalRange.start); // inclusive first index
            var rangeLast = this.getDateDayIndex(normalRange.end.clone().subtract(1, 'days')); // inclusive last index
            var segs = [];
            var row;
            var rowFirst, rowLast; // inclusive day-index range for current row
            var i;
            var segFirst, segLast; // inclusive day-index range for segment

            for (row = 0; row < this.rowCnt; row++) {
                rowFirst = row * daysPerRow;
                rowLast = rowFirst + daysPerRow - 1;

                for (i = rowFirst; i <= rowLast; i++) {

                    // intersect segment's offset range with the row's
                    segFirst = Math.max(rangeFirst, i);
                    segLast = Math.min(rangeLast, i);

                    // deal with in-between indices
                    segFirst = Math.ceil(segFirst); // in-between starts round to next cell
                    segLast = Math.floor(segLast); // in-between ends round to prev cell

                    if (segFirst <= segLast) { // was there any intersection with the current row?
                        segs.push({
                            row: row,

                            // normalize to start of row
                            firstRowDayIndex: segFirst - rowFirst,
                            lastRowDayIndex: segLast - rowFirst,

                            // must be matching integers to be the segment's start/end
                            isStart: segFirst === rangeFirst,
                            isEnd: segLast === rangeLast
                        });
                    }
                }
            }

            return segs;
        },


        /* Header Rendering
         ------------------------------------------------------------------------------------------------------------------*/


        renderHeadHtml: function() {
            var view = this.view;

            return '' +
                '<div class="fc-row ' + view.widgetHeaderClass + '">' +
                '<table>' +
                '<thead>' +
                this.renderHeadTrHtml() +
                '</thead>' +
                '</table>' +
                '</div>';
        },


        renderHeadIntroHtml: function() {
            return this.renderIntroHtml(); // fall back to generic
        },


        renderHeadTrHtml: function() {
            return '' +
                '<tr>' +
                (this.isRTL ? '' : this.renderHeadIntroHtml()) +
                this.renderHeadDateCellsHtml() +
                (this.isRTL ? this.renderHeadIntroHtml() : '') +
                '</tr>';
        },


        renderHeadDateCellsHtml: function() {
            var htmls = [];
            var col, date;

            for (col = 0; col < this.colCnt; col++) {
                date = this.getCellDate(0, col);
                htmls.push(this.renderHeadDateCellHtml(date));
            }

            return htmls.join('');
        },


        // TODO: when internalApiVersion, accept an object for HTML attributes
        // (colspan should be no different)
        renderHeadDateCellHtml: function(date, colspan, otherAttrs) {
            var view = this.view;

            return '' +
                '<th class="fc-day-header ' + view.widgetHeaderClass + ' fc-' + dayIDs[date.day()] + '"' +
                (this.rowCnt == 1 ?
                    ' data-date="' + date.format('YYYY-MM-DD') + '"' :
                    '') +
                (colspan > 1 ?
                    ' colspan="' + colspan + '"' :
                    '') +
                (otherAttrs ?
                    ' ' + otherAttrs :
                    '') +
                '>' +
                htmlEscape(date.format(this.colHeadFormat)) +
                '</th>';
        },


        /* Background Rendering
         ------------------------------------------------------------------------------------------------------------------*/


        renderBgTrHtml: function(row) {
            return '' +
                '<tr>' +
                (this.isRTL ? '' : this.renderBgIntroHtml(row)) +
                this.renderBgCellsHtml(row) +
                (this.isRTL ? this.renderBgIntroHtml(row) : '') +
                '</tr>';
        },


        renderBgIntroHtml: function(row) {
            return this.renderIntroHtml(); // fall back to generic
        },


        renderBgCellsHtml: function(row) {
            var htmls = [];
            var col, date;

            for (col = 0; col < this.colCnt; col++) {
                date = this.getCellDate(row, col);
                htmls.push(this.renderBgCellHtml(date));
            }

            return htmls.join('');
        },


        renderBgCellHtml: function(date, otherAttrs) {
            var view = this.view;
            var classes = this.getDayClasses(date);

            classes.unshift('fc-day', view.widgetContentClass);

            return '<td class="' + classes.join(' ') + '"' +
                ' data-date="' + date.format('YYYY-MM-DD') + '"' + // if date has a time, won't format it
                (otherAttrs ?
                    ' ' + otherAttrs :
                    '') +
                '></td>';
        },


        /* Generic
         ------------------------------------------------------------------------------------------------------------------*/


        // Generates the default HTML intro for any row. User classes should override
        renderIntroHtml: function() {
        },


        // TODO: a generic method for dealing with <tr>, RTL, intro
        // when increment internalApiVersion
        // wrapTr (scheduler)


        /* Utils
         ------------------------------------------------------------------------------------------------------------------*/


        // Applies the generic "intro" and "outro" HTML to the given cells.
        // Intro means the leftmost cell when the calendar is LTR and the rightmost cell when RTL. Vice-versa for outro.
        bookendCells: function(trEl) {
            var introHtml = this.renderIntroHtml();

            if (introHtml) {
                if (this.isRTL) {
                    trEl.append(introHtml);
                }
                else {
                    trEl.prepend(introHtml);
                }
            }
        }

    };

    ;;

    /* A component that renders a grid of whole-days that runs horizontally. There can be multiple rows, one per week.
     ----------------------------------------------------------------------------------------------------------------------*/

    var DayGrid = FC.DayGrid = Grid.extend(DayTableMixin, {

        numbersVisible: false, // should render a row for day/week numbers? set by outside view. TODO: make internal
        bottomCoordPadding: 0, // hack for extending the hit area for the last row of the coordinate grid

        rowEls: null, // set of fake row elements
        cellEls: null, // set of whole-day elements comprising the row's background
        helperEls: null, // set of cell skeleton elements for rendering the mock event "helper"

        rowCoordCache: null,
        colCoordCache: null,


        // Renders the rows and columns into the component's `this.el`, which should already be assigned.
        // isRigid determins whether the individual rows should ignore the contents and be a constant height.
        // Relies on the view's colCnt and rowCnt. In the future, this component should probably be self-sufficient.
        renderDates: function(isRigid) {
            var view = this.view;
            var rowCnt = this.rowCnt;
            var colCnt = this.colCnt;
            var html = '';
            var row;
            var col;

            for (row = 0; row < rowCnt; row++) {
                html += this.renderDayRowHtml(row, isRigid);
            }
            this.el.html(html);

            this.rowEls = this.el.find('.fc-row');
            this.cellEls = this.el.find('.fc-day');

            this.rowCoordCache = new CoordCache({
                els: this.rowEls,
                isVertical: true
            });
            this.colCoordCache = new CoordCache({
                els: this.cellEls.slice(0, this.colCnt), // only the first row
                isHorizontal: true
            });

            // trigger dayRender with each cell's element
            for (row = 0; row < rowCnt; row++) {
                for (col = 0; col < colCnt; col++) {
                    view.trigger(
                        'dayRender',
                        null,
                        this.getCellDate(row, col),
                        this.getCellEl(row, col)
                    );
                }
            }
        },


        unrenderDates: function() {
            this.removeSegPopover();
        },


        renderBusinessHours: function() {
            var segs = this.buildBusinessHourSegs(true); // wholeDay=true
            this.renderFill('businessHours', segs, 'bgevent');
        },


        unrenderBusinessHours: function() {
            this.unrenderFill('businessHours');
        },


        // Generates the HTML for a single row, which is a div that wraps a table.
        // `row` is the row number.
        renderDayRowHtml: function(row, isRigid) {
            var view = this.view;
            var classes = [ 'fc-row', 'fc-week', view.widgetContentClass ];

            if (isRigid) {
                classes.push('fc-rigid');
            }

            return '' +
                '<div class="' + classes.join(' ') + '">' +
                '<div class="fc-bg">' +
                '<table>' +
                this.renderBgTrHtml(row) +
                '</table>' +
                '</div>' +
                '<div class="fc-content-skeleton">' +
                '<table>' +
                (this.numbersVisible ?
                        '<thead>' +
                        this.renderNumberTrHtml(row) +
                        '</thead>' :
                        ''
                ) +
                '</table>' +
                '</div>' +
                '</div>';
        },


        /* Grid Number Rendering
         ------------------------------------------------------------------------------------------------------------------*/


        renderNumberTrHtml: function(row) {
            return '' +
                '<tr>' +
                (this.isRTL ? '' : this.renderNumberIntroHtml(row)) +
                this.renderNumberCellsHtml(row) +
                (this.isRTL ? this.renderNumberIntroHtml(row) : '') +
                '</tr>';
        },


        renderNumberIntroHtml: function(row) {
            return this.renderIntroHtml();
        },


        renderNumberCellsHtml: function(row) {
            var htmls = [];
            var col, date;

            for (col = 0; col < this.colCnt; col++) {
                date = this.getCellDate(row, col);
                htmls.push(this.renderNumberCellHtml(date));
            }

            return htmls.join('');
        },


        // Generates the HTML for the <td>s of the "number" row in the DayGrid's content skeleton.
        // The number row will only exist if either day numbers or week numbers are turned on.
        renderNumberCellHtml: function(date) {
            var classes;

            if (!this.view.dayNumbersVisible) { // if there are week numbers but not day numbers
                return '<td/>'; //  will create an empty space above events :(
            }

            classes = this.getDayClasses(date);
            classes.unshift('fc-day-number');

            return '' +
                '<td class="' + classes.join(' ') + '" data-date="' + date.format() + '">' +
                date.date() +
                '</td>';
        },


        /* Options
         ------------------------------------------------------------------------------------------------------------------*/


        // Computes a default event time formatting string if `timeFormat` is not explicitly defined
        computeEventTimeFormat: function() {
            return this.view.opt('extraSmallTimeFormat'); // like "6p" or "6:30p"
        },


        // Computes a default `displayEventEnd` value if one is not expliclty defined
        computeDisplayEventEnd: function() {
            return this.colCnt == 1; // we'll likely have space if there's only one day
        },


        /* Dates
         ------------------------------------------------------------------------------------------------------------------*/


        rangeUpdated: function() {
            this.updateDayTable();
        },


        // Slices up the given span (unzoned start/end with other misc data) into an array of segments
        spanToSegs: function(span) {
            var segs = this.sliceRangeByRow(span);
            var i, seg;

            for (i = 0; i < segs.length; i++) {
                seg = segs[i];
                if (this.isRTL) {
                    seg.leftCol = this.daysPerRow - 1 - seg.lastRowDayIndex;
                    seg.rightCol = this.daysPerRow - 1 - seg.firstRowDayIndex;
                }
                else {
                    seg.leftCol = seg.firstRowDayIndex;
                    seg.rightCol = seg.lastRowDayIndex;
                }
            }

            return segs;
        },


        /* Hit System
         ------------------------------------------------------------------------------------------------------------------*/


        prepareHits: function() {
            this.colCoordCache.build();
            this.rowCoordCache.build();
            this.rowCoordCache.bottoms[this.rowCnt - 1] += this.bottomCoordPadding; // hack
        },


        releaseHits: function() {
            this.colCoordCache.clear();
            this.rowCoordCache.clear();
        },


        queryHit: function(leftOffset, topOffset) {
            if (this.colCoordCache.isLeftInBounds(leftOffset) && this.rowCoordCache.isTopInBounds(topOffset)) {
                var col = this.colCoordCache.getHorizontalIndex(leftOffset);
                var row = this.rowCoordCache.getVerticalIndex(topOffset);

                if (row != null && col != null) {
                    return this.getCellHit(row, col);
                }
            }
        },


        getHitSpan: function(hit) {
            return this.getCellRange(hit.row, hit.col);
        },


        getHitEl: function(hit) {
            return this.getCellEl(hit.row, hit.col);
        },


        /* Cell System
         ------------------------------------------------------------------------------------------------------------------*/
        // FYI: the first column is the leftmost column, regardless of date


        getCellHit: function(row, col) {
            return {
                row: row,
                col: col,
                component: this, // needed unfortunately :(
                left: this.colCoordCache.getLeftOffset(col),
                right: this.colCoordCache.getRightOffset(col),
                top: this.rowCoordCache.getTopOffset(row),
                bottom: this.rowCoordCache.getBottomOffset(row)
            };
        },


        getCellEl: function(row, col) {
            return this.cellEls.eq(row * this.colCnt + col);
        },


        /* Event Drag Visualization
         ------------------------------------------------------------------------------------------------------------------*/
        // TODO: move to DayGrid.event, similar to what we did with Grid's drag methods


        // Renders a visual indication of an event or external element being dragged.
        // `eventLocation` has zoned start and end (optional)
        renderDrag: function(eventLocation, seg) {

            // always render a highlight underneath
            this.renderHighlight(this.eventToSpan(eventLocation));

            // if a segment from the same calendar but another component is being dragged, render a helper event
            if (seg && seg.component !== this) {
                return this.renderEventLocationHelper(eventLocation, seg); // returns mock event elements
            }
        },


        // Unrenders any visual indication of a hovering event
        unrenderDrag: function() {
            this.unrenderHighlight();
            this.unrenderHelper();
        },


        /* Event Resize Visualization
         ------------------------------------------------------------------------------------------------------------------*/


        // Renders a visual indication of an event being resized
        renderEventResize: function(eventLocation, seg) {
            this.renderHighlight(this.eventToSpan(eventLocation));
            return this.renderEventLocationHelper(eventLocation, seg); // returns mock event elements
        },


        // Unrenders a visual indication of an event being resized
        unrenderEventResize: function() {
            this.unrenderHighlight();
            this.unrenderHelper();
        },


        /* Event Helper
         ------------------------------------------------------------------------------------------------------------------*/


        // Renders a mock "helper" event. `sourceSeg` is the associated internal segment object. It can be null.
        renderHelper: function(event, sourceSeg) {
            var helperNodes = [];
            var segs = this.eventToSegs(event);
            var rowStructs;

            segs = this.renderFgSegEls(segs); // assigns each seg's el and returns a subset of segs that were rendered
            rowStructs = this.renderSegRows(segs);

            // inject each new event skeleton into each associated row
            this.rowEls.each(function(row, rowNode) {
                var rowEl = $(rowNode); // the .fc-row
                var skeletonEl = $('<div class="fc-helper-skeleton"><table/></div>'); // will be absolutely positioned
                var skeletonTop;

                // If there is an original segment, match the top position. Otherwise, put it at the row's top level
                if (sourceSeg && sourceSeg.row === row) {
                    skeletonTop = sourceSeg.el.position().top;
                }
                else {
                    skeletonTop = rowEl.find('.fc-content-skeleton tbody').position().top;
                }

                skeletonEl.css('top', skeletonTop)
                    .find('table')
                    .append(rowStructs[row].tbodyEl);

                rowEl.append(skeletonEl);
                helperNodes.push(skeletonEl[0]);
            });

            return ( // must return the elements rendered
                this.helperEls = $(helperNodes) // array -> jQuery set
            );
        },


        // Unrenders any visual indication of a mock helper event
        unrenderHelper: function() {
            if (this.helperEls) {
                this.helperEls.remove();
                this.helperEls = null;
            }
        },


        /* Fill System (highlight, background events, business hours)
         ------------------------------------------------------------------------------------------------------------------*/


        fillSegTag: 'td', // override the default tag name


        // Renders a set of rectangles over the given segments of days.
        // Only returns segments that successfully rendered.
        renderFill: function(type, segs, className) {
            var nodes = [];
            var i, seg;
            var skeletonEl;

            segs = this.renderFillSegEls(type, segs); // assignes `.el` to each seg. returns successfully rendered segs

            for (i = 0; i < segs.length; i++) {
                seg = segs[i];
                skeletonEl = this.renderFillRow(type, seg, className);
                this.rowEls.eq(seg.row).append(skeletonEl);
                nodes.push(skeletonEl[0]);
            }

            this.elsByFill[type] = $(nodes);

            return segs;
        },


        // Generates the HTML needed for one row of a fill. Requires the seg's el to be rendered.
        renderFillRow: function(type, seg, className) {
            var colCnt = this.colCnt;
            var startCol = seg.leftCol;
            var endCol = seg.rightCol + 1;
            var skeletonEl;
            var trEl;

            className = className || type.toLowerCase();

            skeletonEl = $(
                '<div class="fc-' + className + '-skeleton">' +
                '<table><tr/></table>' +
                '</div>'
            );
            trEl = skeletonEl.find('tr');

            if (startCol > 0) {
                trEl.append('<td colspan="' + startCol + '"/>');
            }

            trEl.append(
                seg.el.attr('colspan', endCol - startCol)
            );

            if (endCol < colCnt) {
                trEl.append('<td colspan="' + (colCnt - endCol) + '"/>');
            }

            this.bookendCells(trEl);

            return skeletonEl;
        }

    });

    ;;

    /* Event-rendering methods for the DayGrid class
     ----------------------------------------------------------------------------------------------------------------------*/

    DayGrid.mixin({

        rowStructs: null, // an array of objects, each holding information about a row's foreground event-rendering


        // Unrenders all events currently rendered on the grid
        unrenderEvents: function() {
            this.removeSegPopover(); // removes the "more.." events popover
            Grid.prototype.unrenderEvents.apply(this, arguments); // calls the super-method
        },


        // Retrieves all rendered segment objects currently rendered on the grid
        getEventSegs: function() {
            return Grid.prototype.getEventSegs.call(this) // get the segments from the super-method
                .concat(this.popoverSegs || []); // append the segments from the "more..." popover
        },


        // Renders the given background event segments onto the grid
        renderBgSegs: function(segs) {

            // don't render timed background events
            var allDaySegs = $.grep(segs, function(seg) {
                return seg.event.allDay;
            });

            return Grid.prototype.renderBgSegs.call(this, allDaySegs); // call the super-method
        },


        // Renders the given foreground event segments onto the grid
        renderFgSegs: function(segs) {
            var rowStructs;

            // render an `.el` on each seg
            // returns a subset of the segs. segs that were actually rendered
            segs = this.renderFgSegEls(segs);

            rowStructs = this.rowStructs = this.renderSegRows(segs);

            // append to each row's content skeleton
            this.rowEls.each(function(i, rowNode) {
                $(rowNode).find('.fc-content-skeleton > table').append(
                    rowStructs[i].tbodyEl
                );
            });

            return segs; // return only the segs that were actually rendered
        },


        // Unrenders all currently rendered foreground event segments
        unrenderFgSegs: function() {
            var rowStructs = this.rowStructs || [];
            var rowStruct;

            while ((rowStruct = rowStructs.pop())) {
                rowStruct.tbodyEl.remove();
            }

            this.rowStructs = null;
        },


        // Uses the given events array to generate <tbody> elements that should be appended to each row's content skeleton.
        // Returns an array of rowStruct objects (see the bottom of `renderSegRow`).
        // PRECONDITION: each segment shoud already have a rendered and assigned `.el`
        renderSegRows: function(segs) {
            var rowStructs = [];
            var segRows;
            var row;

            segRows = this.groupSegRows(segs); // group into nested arrays

            // iterate each row of segment groupings
            for (row = 0; row < segRows.length; row++) {
                rowStructs.push(
                    this.renderSegRow(row, segRows[row])
                );
            }

            return rowStructs;
        },


        // Builds the HTML to be used for the default element for an individual segment
        fgSegHtml: function(seg, disableResizing) {
            var view = this.view;
            var event = seg.event;
            var isDraggable = view.isEventDraggable(event);
            var isResizableFromStart = !disableResizing && event.allDay &&
                seg.isStart && view.isEventResizableFromStart(event);
            var isResizableFromEnd = !disableResizing && event.allDay &&
                seg.isEnd && view.isEventResizableFromEnd(event);
            var classes = this.getSegClasses(seg, isDraggable, isResizableFromStart || isResizableFromEnd);
            var skinCss = cssToStr(this.getSegSkinCss(seg));
            var timeHtml = '';
            var timeText;
            var titleHtml;

            classes.unshift('fc-day-grid-event', 'fc-h-event');

            // Only display a timed events time if it is the starting segment
            if (seg.isStart) {
                timeText = this.getEventTimeText(event);
                if (timeText) {
                    timeHtml = '<span class="fc-time">' + htmlEscape(timeText) + '</span>';
                }
            }

            titleHtml =
                '<span class="fc-title">' +
                (htmlEscape(event.title || '') || '&nbsp;') + // we always want one line of height
                '</span>';

            return '<a class="' + classes.join(' ') + '"' +
                (event.url ?
                        ' href="' + htmlEscape(event.url) + '"' :
                        ''
                ) +
                (skinCss ?
                        ' style="' + skinCss + '"' :
                        ''
                ) +
                '>' +
                '<div class="fc-content">' +
                (this.isRTL ?
                        titleHtml + ' ' + timeHtml : // put a natural space in between
                        timeHtml + ' ' + titleHtml   //
                ) +
                '</div>' +
                (isResizableFromStart ?
                        '<div class="fc-resizer fc-start-resizer" />' :
                        ''
                ) +
                (isResizableFromEnd ?
                        '<div class="fc-resizer fc-end-resizer" />' :
                        ''
                ) +
                '</a>';
        },


        // Given a row # and an array of segments all in the same row, render a <tbody> element, a skeleton that contains
        // the segments. Returns object with a bunch of internal data about how the render was calculated.
        // NOTE: modifies rowSegs
        renderSegRow: function(row, rowSegs) {
            var colCnt = this.colCnt;
            var segLevels = this.buildSegLevels(rowSegs); // group into sub-arrays of levels
            var levelCnt = Math.max(1, segLevels.length); // ensure at least one level
            var tbody = $('<tbody/>');
            var segMatrix = []; // lookup for which segments are rendered into which level+col cells
            var cellMatrix = []; // lookup for all <td> elements of the level+col matrix
            var loneCellMatrix = []; // lookup for <td> elements that only take up a single column
            var i, levelSegs;
            var col;
            var tr;
            var j, seg;
            var td;

            // populates empty cells from the current column (`col`) to `endCol`
            function emptyCellsUntil(endCol) {
                while (col < endCol) {
                    // try to grab a cell from the level above and extend its rowspan. otherwise, create a fresh cell
                    td = (loneCellMatrix[i - 1] || [])[col];
                    if (td) {
                        td.attr(
                            'rowspan',
                            parseInt(td.attr('rowspan') || 1, 10) + 1
                        );
                    }
                    else {
                        td = $('<td/>');
                        tr.append(td);
                    }
                    cellMatrix[i][col] = td;
                    loneCellMatrix[i][col] = td;
                    col++;
                }
            }

            for (i = 0; i < levelCnt; i++) { // iterate through all levels
                levelSegs = segLevels[i];
                col = 0;
                tr = $('<tr/>');

                segMatrix.push([]);
                cellMatrix.push([]);
                loneCellMatrix.push([]);

                // levelCnt might be 1 even though there are no actual levels. protect against this.
                // this single empty row is useful for styling.
                if (levelSegs) {
                    for (j = 0; j < levelSegs.length; j++) { // iterate through segments in level
                        seg = levelSegs[j];

                        emptyCellsUntil(seg.leftCol);

                        // create a container that occupies or more columns. append the event element.
                        td = $('<td class="fc-event-container"/>').append(seg.el);
                        if (seg.leftCol != seg.rightCol) {
                            td.attr('colspan', seg.rightCol - seg.leftCol + 1);
                        }
                        else { // a single-column segment
                            loneCellMatrix[i][col] = td;
                        }

                        while (col <= seg.rightCol) {
                            cellMatrix[i][col] = td;
                            segMatrix[i][col] = seg;
                            col++;
                        }

                        tr.append(td);
                    }
                }

                emptyCellsUntil(colCnt); // finish off the row
                this.bookendCells(tr);
                tbody.append(tr);
            }

            return { // a "rowStruct"
                row: row, // the row number
                tbodyEl: tbody,
                cellMatrix: cellMatrix,
                segMatrix: segMatrix,
                segLevels: segLevels,
                segs: rowSegs
            };
        },


        // Stacks a flat array of segments, which are all assumed to be in the same row, into subarrays of vertical levels.
        // NOTE: modifies segs
        buildSegLevels: function(segs) {
            var levels = [];
            var i, seg;
            var j;

            // Give preference to elements with certain criteria, so they have
            // a chance to be closer to the top.
            this.sortEventSegs(segs);

            for (i = 0; i < segs.length; i++) {
                seg = segs[i];

                // loop through levels, starting with the topmost, until the segment doesn't collide with other segments
                for (j = 0; j < levels.length; j++) {
                    if (!isDaySegCollision(seg, levels[j])) {
                        break;
                    }
                }
                // `j` now holds the desired subrow index
                seg.level = j;

                // create new level array if needed and append segment
                (levels[j] || (levels[j] = [])).push(seg);
            }

            // order segments left-to-right. very important if calendar is RTL
            for (j = 0; j < levels.length; j++) {
                levels[j].sort(compareDaySegCols);
            }

            return levels;
        },


        // Given a flat array of segments, return an array of sub-arrays, grouped by each segment's row
        groupSegRows: function(segs) {
            var segRows = [];
            var i;

            for (i = 0; i < this.rowCnt; i++) {
                segRows.push([]);
            }

            for (i = 0; i < segs.length; i++) {
                segRows[segs[i].row].push(segs[i]);
            }

            return segRows;
        }

    });


// Computes whether two segments' columns collide. They are assumed to be in the same row.
    function isDaySegCollision(seg, otherSegs) {
        var i, otherSeg;

        for (i = 0; i < otherSegs.length; i++) {
            otherSeg = otherSegs[i];

            if (
                otherSeg.leftCol <= seg.rightCol &&
                otherSeg.rightCol >= seg.leftCol
            ) {
                return true;
            }
        }

        return false;
    }


// A cmp function for determining the leftmost event
    function compareDaySegCols(a, b) {
        return a.leftCol - b.leftCol;
    }

    ;;

    /* Methods relate to limiting the number events for a given day on a DayGrid
     ----------------------------------------------------------------------------------------------------------------------*/
// NOTE: all the segs being passed around in here are foreground segs

    DayGrid.mixin({

        segPopover: null, // the Popover that holds events that can't fit in a cell. null when not visible
        popoverSegs: null, // an array of segment objects that the segPopover holds. null when not visible


        removeSegPopover: function() {
            if (this.segPopover) {
                this.segPopover.hide(); // in handler, will call segPopover's removeElement
            }
        },


        // Limits the number of "levels" (vertically stacking layers of events) for each row of the grid.
        // `levelLimit` can be false (don't limit), a number, or true (should be computed).
        limitRows: function(levelLimit) {
            var rowStructs = this.rowStructs || [];
            var row; // row #
            var rowLevelLimit;

            for (row = 0; row < rowStructs.length; row++) {
                this.unlimitRow(row);

                if (!levelLimit) {
                    rowLevelLimit = false;
                }
                else if (typeof levelLimit === 'number') {
                    rowLevelLimit = levelLimit;
                }
                else {
                    rowLevelLimit = this.computeRowLevelLimit(row);
                }

                if (rowLevelLimit !== false) {
                    this.limitRow(row, rowLevelLimit);
                }
            }
        },


        // Computes the number of levels a row will accomodate without going outside its bounds.
        // Assumes the row is "rigid" (maintains a constant height regardless of what is inside).
        // `row` is the row number.
        computeRowLevelLimit: function(row) {
            var rowEl = this.rowEls.eq(row); // the containing "fake" row div
            var rowHeight = rowEl.height(); // TODO: cache somehow?
            var trEls = this.rowStructs[row].tbodyEl.children();
            var i, trEl;
            var trHeight;

            function iterInnerHeights(i, childNode) {
                trHeight = Math.max(trHeight, $(childNode).outerHeight());
            }

            // Reveal one level <tr> at a time and stop when we find one out of bounds
            for (i = 0; i < trEls.length; i++) {
                trEl = trEls.eq(i).removeClass('fc-limited'); // reset to original state (reveal)

                // with rowspans>1 and IE8, trEl.outerHeight() would return the height of the largest cell,
                // so instead, find the tallest inner content element.
                trHeight = 0;
                trEl.find('> td > :first-child').each(iterInnerHeights);

                if (trEl.position().top + trHeight > rowHeight) {
                    return i;
                }
            }

            return false; // should not limit at all
        },


        // Limits the given grid row to the maximum number of levels and injects "more" links if necessary.
        // `row` is the row number.
        // `levelLimit` is a number for the maximum (inclusive) number of levels allowed.
        limitRow: function(row, levelLimit) {
            var _this = this;
            var rowStruct = this.rowStructs[row];
            var moreNodes = []; // array of "more" <a> links and <td> DOM nodes
            var col = 0; // col #, left-to-right (not chronologically)
            var levelSegs; // array of segment objects in the last allowable level, ordered left-to-right
            var cellMatrix; // a matrix (by level, then column) of all <td> jQuery elements in the row
            var limitedNodes; // array of temporarily hidden level <tr> and segment <td> DOM nodes
            var i, seg;
            var segsBelow; // array of segment objects below `seg` in the current `col`
            var totalSegsBelow; // total number of segments below `seg` in any of the columns `seg` occupies
            var colSegsBelow; // array of segment arrays, below seg, one for each column (offset from segs's first column)
            var td, rowspan;
            var segMoreNodes; // array of "more" <td> cells that will stand-in for the current seg's cell
            var j;
            var moreTd, moreWrap, moreLink;

            // Iterates through empty level cells and places "more" links inside if need be
            function emptyCellsUntil(endCol) { // goes from current `col` to `endCol`
                while (col < endCol) {
                    segsBelow = _this.getCellSegs(row, col, levelLimit);
                    if (segsBelow.length) {
                        td = cellMatrix[levelLimit - 1][col];
                        moreLink = _this.renderMoreLink(row, col, segsBelow);
                        moreWrap = $('<div/>').append(moreLink);
                        td.append(moreWrap);
                        moreNodes.push(moreWrap[0]);
                    }
                    col++;
                }
            }

            if (levelLimit && levelLimit < rowStruct.segLevels.length) { // is it actually over the limit?
                levelSegs = rowStruct.segLevels[levelLimit - 1];
                cellMatrix = rowStruct.cellMatrix;

                limitedNodes = rowStruct.tbodyEl.children().slice(levelLimit) // get level <tr> elements past the limit
                    .addClass('fc-limited').get(); // hide elements and get a simple DOM-nodes array

                // iterate though segments in the last allowable level
                for (i = 0; i < levelSegs.length; i++) {
                    seg = levelSegs[i];
                    emptyCellsUntil(seg.leftCol); // process empty cells before the segment

                    // determine *all* segments below `seg` that occupy the same columns
                    colSegsBelow = [];
                    totalSegsBelow = 0;
                    while (col <= seg.rightCol) {
                        segsBelow = this.getCellSegs(row, col, levelLimit);
                        colSegsBelow.push(segsBelow);
                        totalSegsBelow += segsBelow.length;
                        col++;
                    }

                    if (totalSegsBelow) { // do we need to replace this segment with one or many "more" links?
                        td = cellMatrix[levelLimit - 1][seg.leftCol]; // the segment's parent cell
                        rowspan = td.attr('rowspan') || 1;
                        segMoreNodes = [];

                        // make a replacement <td> for each column the segment occupies. will be one for each colspan
                        for (j = 0; j < colSegsBelow.length; j++) {
                            moreTd = $('<td class="fc-more-cell"/>').attr('rowspan', rowspan);
                            segsBelow = colSegsBelow[j];
                            moreLink = this.renderMoreLink(
                                row,
                                seg.leftCol + j,
                                [ seg ].concat(segsBelow) // count seg as hidden too
                            );
                            moreWrap = $('<div/>').append(moreLink);
                            moreTd.append(moreWrap);
                            segMoreNodes.push(moreTd[0]);
                            moreNodes.push(moreTd[0]);
                        }

                        td.addClass('fc-limited').after($(segMoreNodes)); // hide original <td> and inject replacements
                        limitedNodes.push(td[0]);
                    }
                }

                emptyCellsUntil(this.colCnt); // finish off the level
                rowStruct.moreEls = $(moreNodes); // for easy undoing later
                rowStruct.limitedEls = $(limitedNodes); // for easy undoing later
            }
        },


        // Reveals all levels and removes all "more"-related elements for a grid's row.
        // `row` is a row number.
        unlimitRow: function(row) {
            var rowStruct = this.rowStructs[row];

            if (rowStruct.moreEls) {
                rowStruct.moreEls.remove();
                rowStruct.moreEls = null;
            }

            if (rowStruct.limitedEls) {
                rowStruct.limitedEls.removeClass('fc-limited');
                rowStruct.limitedEls = null;
            }
        },


        // Renders an <a> element that represents hidden event element for a cell.
        // Responsible for attaching click handler as well.
        renderMoreLink: function(row, col, hiddenSegs) {
            var _this = this;
            var view = this.view;

            return $('<a class="fc-more"/>')
                .text(
                    this.getMoreLinkText(hiddenSegs.length)
                )
                .on('click', function(ev) {
                    var clickOption = view.opt('eventLimitClick');
                    var date = _this.getCellDate(row, col);
                    var moreEl = $(this);
                    var dayEl = _this.getCellEl(row, col);
                    var allSegs = _this.getCellSegs(row, col);

                    // rescope the segments to be within the cell's date
                    var reslicedAllSegs = _this.resliceDaySegs(allSegs, date);
                    var reslicedHiddenSegs = _this.resliceDaySegs(hiddenSegs, date);

                    if (typeof clickOption === 'function') {
                        // the returned value can be an atomic option
                        clickOption = view.trigger('eventLimitClick', null, {
                            date: date,
                            dayEl: dayEl,
                            moreEl: moreEl,
                            segs: reslicedAllSegs,
                            hiddenSegs: reslicedHiddenSegs
                        }, ev);
                    }

                    if (clickOption === 'popover') {
                        _this.showSegPopover(row, col, moreEl, reslicedAllSegs);
                    }
                    else if (typeof clickOption === 'string') { // a view name
                        view.calendar.zoomTo(date, clickOption);
                    }
                });
        },


        // Reveals the popover that displays all events within a cell
        showSegPopover: function(row, col, moreLink, segs) {
            var _this = this;
            var view = this.view;
            var moreWrap = moreLink.parent(); // the <div> wrapper around the <a>
            var topEl; // the element we want to match the top coordinate of
            var options;

            if (this.rowCnt == 1) {
                topEl = view.el; // will cause the popover to cover any sort of header
            }
            else {
                topEl = this.rowEls.eq(row); // will align with top of row
            }

            options = {
                className: 'fc-more-popover',
                content: this.renderSegPopoverContent(row, col, segs),
                parentEl: this.view.el, // attach to root of view. guarantees outside of scrollbars.
                top: topEl.offset().top,
                autoHide: true, // when the user clicks elsewhere, hide the popover
                viewportConstrain: view.opt('popoverViewportConstrain'),
                hide: function() {
                    // kill everything when the popover is hidden
                    _this.segPopover.removeElement();
                    _this.segPopover = null;
                    _this.popoverSegs = null;
                }
            };

            // Determine horizontal coordinate.
            // We use the moreWrap instead of the <td> to avoid border confusion.
            if (this.isRTL) {
                options.right = moreWrap.offset().left + moreWrap.outerWidth() + 1; // +1 to be over cell border
            }
            else {
                options.left = moreWrap.offset().left - 1; // -1 to be over cell border
            }

            this.segPopover = new Popover(options);
            this.segPopover.show();

            // the popover doesn't live within the grid's container element, and thus won't get the event
            // delegated-handlers for free. attach event-related handlers to the popover.
            this.bindSegHandlersToEl(this.segPopover.el);
        },


        // Builds the inner DOM contents of the segment popover
        renderSegPopoverContent: function(row, col, segs) {
            var view = this.view;
            var isTheme = view.opt('theme');
            var title = this.getCellDate(row, col).format(view.opt('dayPopoverFormat'));
            var content = $(
                '<div class="fc-header ' + view.widgetHeaderClass + '">' +
                '<span class="fc-close ' +
                (isTheme ? 'ui-icon ui-icon-closethick' : 'fc-icon fc-icon-x') +
                '"></span>' +
                '<span class="fc-title">' +
                htmlEscape(title) +
                '</span>' +
                '<div class="fc-clear"/>' +
                '</div>' +
                '<div class="fc-body ' + view.widgetContentClass + '">' +
                '<div class="fc-event-container"></div>' +
                '</div>'
            );
            var segContainer = content.find('.fc-event-container');
            var i;

            // render each seg's `el` and only return the visible segs
            segs = this.renderFgSegEls(segs, true); // disableResizing=true
            this.popoverSegs = segs;

            for (i = 0; i < segs.length; i++) {

                // because segments in the popover are not part of a grid coordinate system, provide a hint to any
                // grids that want to do drag-n-drop about which cell it came from
                this.prepareHits();
                segs[i].hit = this.getCellHit(row, col);
                this.releaseHits();

                segContainer.append(segs[i].el);
            }

            return content;
        },


        // Given the events within an array of segment objects, reslice them to be in a single day
        resliceDaySegs: function(segs, dayDate) {

            // build an array of the original events
            var events = $.map(segs, function(seg) {
                return seg.event;
            });

            var dayStart = dayDate.clone();
            var dayEnd = dayStart.clone().add(1, 'days');
            var dayRange = { start: dayStart, end: dayEnd };

            // slice the events with a custom slicing function
            segs = this.eventsToSegs(
                events,
                function(range) {
                    var seg = intersectRanges(range, dayRange); // undefind if no intersection
                    return seg ? [ seg ] : []; // must return an array of segments
                }
            );

            // force an order because eventsToSegs doesn't guarantee one
            this.sortEventSegs(segs);

            return segs;
        },


        // Generates the text that should be inside a "more" link, given the number of events it represents
        getMoreLinkText: function(num) {
            var opt = this.view.opt('eventLimitText');

            if (typeof opt === 'function') {
                return opt(num);
            }
            else {
                return '+' + num + ' ' + opt;
            }
        },


        // Returns segments within a given cell.
        // If `startLevel` is specified, returns only events including and below that level. Otherwise returns all segs.
        getCellSegs: function(row, col, startLevel) {
            var segMatrix = this.rowStructs[row].segMatrix;
            var level = startLevel || 0;
            var segs = [];
            var seg;

            while (level < segMatrix.length) {
                seg = segMatrix[level][col];
                if (seg) {
                    segs.push(seg);
                }
                level++;
            }

            return segs;
        }

    });

    ;;

    /* A component that renders one or more columns of vertical time slots
     ----------------------------------------------------------------------------------------------------------------------*/
// We mixin DayTable, even though there is only a single row of days

    var TimeGrid = FC.TimeGrid = Grid.extend(DayTableMixin, {

        slotDuration: null, // duration of a "slot", a distinct time segment on given day, visualized by lines
        snapDuration: null, // granularity of time for dragging and selecting
        snapsPerSlot: null,
        minTime: null, // Duration object that denotes the first visible time of any given day
        maxTime: null, // Duration object that denotes the exclusive visible end time of any given day
        labelFormat: null, // formatting string for times running along vertical axis
        labelInterval: null, // duration of how often a label should be displayed for a slot

        colEls: null, // cells elements in the day-row background
        slatContainerEl: null, // div that wraps all the slat rows
        slatEls: null, // elements running horizontally across all columns
        nowIndicatorEls: null,

        colCoordCache: null,
        slatCoordCache: null,


        constructor: function() {
            Grid.apply(this, arguments); // call the super-constructor

            this.processOptions();
        },


        // Renders the time grid into `this.el`, which should already be assigned.
        // Relies on the view's colCnt. In the future, this component should probably be self-sufficient.
        renderDates: function() {
            this.el.html(this.renderHtml());
            this.colEls = this.el.find('.fc-day');
            this.slatContainerEl = this.el.find('.fc-slats');
            this.slatEls = this.slatContainerEl.find('tr');

            this.colCoordCache = new CoordCache({
                els: this.colEls,
                isHorizontal: true
            });
            this.slatCoordCache = new CoordCache({
                els: this.slatEls,
                isVertical: true
            });

            this.renderContentSkeleton();
        },


        // Renders the basic HTML skeleton for the grid
        renderHtml: function() {
            return '' +
                '<div class="fc-bg">' +
                '<table>' +
                this.renderBgTrHtml(0) + // row=0
                '</table>' +
                '</div>' +
                '<div class="fc-slats">' +
                '<table>' +
                this.renderSlatRowHtml() +
                '</table>' +
                '</div>';
        },


        // Generates the HTML for the horizontal "slats" that run width-wise. Has a time axis on a side. Depends on RTL.
        renderSlatRowHtml: function() {
            var view = this.view;
            var isRTL = this.isRTL;
            var html = '';
            var slotTime = moment.duration(+this.minTime); // wish there was .clone() for durations
            var slotDate; // will be on the view's first day, but we only care about its time
            var isLabeled;
            var axisHtml;

            // Calculate the time for each slot
            while (slotTime < this.maxTime) {
                slotDate = this.start.clone().time(slotTime);
                isLabeled = isInt(divideDurationByDuration(slotTime, this.labelInterval));

                axisHtml =
                    '<td class="fc-axis fc-time ' + view.widgetContentClass + '" ' + view.axisStyleAttr() + '>' +
                    (isLabeled ?
                            '<span>' + // for matchCellWidths
                            htmlEscape(slotDate.format(this.labelFormat)) +
                            '</span>' :
                            ''
                    ) +
                    '</td>';

                html +=
                    '<tr data-time="' + slotDate.format('HH:mm:ss') + '"' +
                    (isLabeled ? '' : ' class="fc-minor"') +
                    '>' +
                    (!isRTL ? axisHtml : '') +
                    '<td class="' + view.widgetContentClass + '"/>' +
                    (isRTL ? axisHtml : '') +
                    "</tr>";

                slotTime.add(this.slotDuration);
            }

            return html;
        },


        /* Options
         ------------------------------------------------------------------------------------------------------------------*/


        // Parses various options into properties of this object
        processOptions: function() {
            var view = this.view;
            var slotDuration = view.opt('slotDuration');
            var snapDuration = view.opt('snapDuration');
            var input;

            slotDuration = moment.duration(slotDuration);
            snapDuration = snapDuration ? moment.duration(snapDuration) : slotDuration;

            this.slotDuration = slotDuration;
            this.snapDuration = snapDuration;
            this.snapsPerSlot = slotDuration / snapDuration; // TODO: ensure an integer multiple?

            this.minResizeDuration = snapDuration; // hack

            this.minTime = moment.duration(view.opt('minTime'));
            this.maxTime = moment.duration(view.opt('maxTime'));

            // might be an array value (for TimelineView).
            // if so, getting the most granular entry (the last one probably).
            input = view.opt('slotLabelFormat');
            if ($.isArray(input)) {
                input = input[input.length - 1];
            }

            this.labelFormat =
                input ||
                view.opt('axisFormat') || // deprecated
                view.opt('smallTimeFormat'); // the computed default

            input = view.opt('slotLabelInterval');
            this.labelInterval = input ?
                moment.duration(input) :
                this.computeLabelInterval(slotDuration);
        },


        // Computes an automatic value for slotLabelInterval
        computeLabelInterval: function(slotDuration) {
            var i;
            var labelInterval;
            var slotsPerLabel;

            // find the smallest stock label interval that results in more than one slots-per-label
            for (i = AGENDA_STOCK_SUB_DURATIONS.length - 1; i >= 0; i--) {
                labelInterval = moment.duration(AGENDA_STOCK_SUB_DURATIONS[i]);
                slotsPerLabel = divideDurationByDuration(labelInterval, slotDuration);
                if (isInt(slotsPerLabel) && slotsPerLabel > 1) {
                    return labelInterval;
                }
            }

            return moment.duration(slotDuration); // fall back. clone
        },


        // Computes a default event time formatting string if `timeFormat` is not explicitly defined
        computeEventTimeFormat: function() {
            return this.view.opt('noMeridiemTimeFormat'); // like "6:30" (no AM/PM)
        },


        // Computes a default `displayEventEnd` value if one is not expliclty defined
        computeDisplayEventEnd: function() {
            return true;
        },


        /* Hit System
         ------------------------------------------------------------------------------------------------------------------*/


        prepareHits: function() {
            this.colCoordCache.build();
            this.slatCoordCache.build();
        },


        releaseHits: function() {
            this.colCoordCache.clear();
            // NOTE: don't clear slatCoordCache because we rely on it for computeTimeTop
        },


        queryHit: function(leftOffset, topOffset) {
            var snapsPerSlot = this.snapsPerSlot;
            var colCoordCache = this.colCoordCache;
            var slatCoordCache = this.slatCoordCache;

            if (colCoordCache.isLeftInBounds(leftOffset) && slatCoordCache.isTopInBounds(topOffset)) {
                var colIndex = colCoordCache.getHorizontalIndex(leftOffset);
                var slatIndex = slatCoordCache.getVerticalIndex(topOffset);

                if (colIndex != null && slatIndex != null) {
                    var slatTop = slatCoordCache.getTopOffset(slatIndex);
                    var slatHeight = slatCoordCache.getHeight(slatIndex);
                    var partial = (topOffset - slatTop) / slatHeight; // floating point number between 0 and 1
                    var localSnapIndex = Math.floor(partial * snapsPerSlot); // the snap # relative to start of slat
                    var snapIndex = slatIndex * snapsPerSlot + localSnapIndex;
                    var snapTop = slatTop + (localSnapIndex / snapsPerSlot) * slatHeight;
                    var snapBottom = slatTop + ((localSnapIndex + 1) / snapsPerSlot) * slatHeight;

                    return {
                        col: colIndex,
                        snap: snapIndex,
                        component: this, // needed unfortunately :(
                        left: colCoordCache.getLeftOffset(colIndex),
                        right: colCoordCache.getRightOffset(colIndex),
                        top: snapTop,
                        bottom: snapBottom
                    };
                }
            }
        },


        getHitSpan: function(hit) {
            var start = this.getCellDate(0, hit.col); // row=0
            var time = this.computeSnapTime(hit.snap); // pass in the snap-index
            var end;

            start.time(time);
            end = start.clone().add(this.snapDuration);

            return { start: start, end: end };
        },


        getHitEl: function(hit) {
            return this.colEls.eq(hit.col);
        },


        /* Dates
         ------------------------------------------------------------------------------------------------------------------*/


        rangeUpdated: function() {
            this.updateDayTable();
        },


        // Given a row number of the grid, representing a "snap", returns a time (Duration) from its start-of-day
        computeSnapTime: function(snapIndex) {
            return moment.duration(this.minTime + this.snapDuration * snapIndex);
        },


        // Slices up the given span (unzoned start/end with other misc data) into an array of segments
        spanToSegs: function(span) {
            var segs = this.sliceRangeByTimes(span);
            var i;

            for (i = 0; i < segs.length; i++) {
                if (this.isRTL) {
                    segs[i].col = this.daysPerRow - 1 - segs[i].dayIndex;
                }
                else {
                    segs[i].col = segs[i].dayIndex;
                }
            }

            return segs;
        },


        sliceRangeByTimes: function(range) {
            var segs = [];
            var seg;
            var dayIndex;
            var dayDate;
            var dayRange;

            for (dayIndex = 0; dayIndex < this.daysPerRow; dayIndex++) {
                dayDate = this.dayDates[dayIndex].clone(); // TODO: better API for this?
                dayRange = {
                    start: dayDate.clone().time(this.minTime),
                    end: dayDate.clone().time(this.maxTime)
                };
                seg = intersectRanges(range, dayRange); // both will be ambig timezone
                if (seg) {
                    seg.dayIndex = dayIndex;
                    segs.push(seg);
                }
            }

            return segs;
        },


        /* Coordinates
         ------------------------------------------------------------------------------------------------------------------*/


        updateSize: function(isResize) { // NOT a standard Grid method
            this.slatCoordCache.build();

            if (isResize) {
                this.updateSegVerticals(
                    [].concat(this.fgSegs || [], this.bgSegs || [], this.businessSegs || [])
                );
            }
        },


        getTotalSlatHeight: function() {
            return this.slatContainerEl.outerHeight();
        },


        // Computes the top coordinate, relative to the bounds of the grid, of the given date.
        // A `startOfDayDate` must be given for avoiding ambiguity over how to treat midnight.
        computeDateTop: function(date, startOfDayDate) {
            return this.computeTimeTop(
                moment.duration(
                    date - startOfDayDate.clone().stripTime()
                )
            );
        },


        // Computes the top coordinate, relative to the bounds of the grid, of the given time (a Duration).
        computeTimeTop: function(time) {
            var len = this.slatEls.length;
            var slatCoverage = (time - this.minTime) / this.slotDuration; // floating-point value of # of slots covered
            var slatIndex;
            var slatRemainder;

            // compute a floating-point number for how many slats should be progressed through.
            // from 0 to number of slats (inclusive)
            // constrained because minTime/maxTime might be customized.
            slatCoverage = Math.max(0, slatCoverage);
            slatCoverage = Math.min(len, slatCoverage);

            // an integer index of the furthest whole slat
            // from 0 to number slats (*exclusive*, so len-1)
            slatIndex = Math.floor(slatCoverage);
            slatIndex = Math.min(slatIndex, len - 1);

            // how much further through the slatIndex slat (from 0.0-1.0) must be covered in addition.
            // could be 1.0 if slatCoverage is covering *all* the slots
            slatRemainder = slatCoverage - slatIndex;

            return this.slatCoordCache.getTopPosition(slatIndex) +
                this.slatCoordCache.getHeight(slatIndex) * slatRemainder;
        },



        /* Event Drag Visualization
         ------------------------------------------------------------------------------------------------------------------*/


        // Renders a visual indication of an event being dragged over the specified date(s).
        // A returned value of `true` signals that a mock "helper" event has been rendered.
        renderDrag: function(eventLocation, seg) {

            if (seg) { // if there is event information for this drag, render a helper event

                // returns mock event elements
                // signal that a helper has been rendered
                return this.renderEventLocationHelper(eventLocation, seg);
            }
            else {
                // otherwise, just render a highlight
                this.renderHighlight(this.eventToSpan(eventLocation));
            }
        },


        // Unrenders any visual indication of an event being dragged
        unrenderDrag: function() {
            this.unrenderHelper();
            this.unrenderHighlight();
        },


        /* Event Resize Visualization
         ------------------------------------------------------------------------------------------------------------------*/


        // Renders a visual indication of an event being resized
        renderEventResize: function(eventLocation, seg) {
            return this.renderEventLocationHelper(eventLocation, seg); // returns mock event elements
        },


        // Unrenders any visual indication of an event being resized
        unrenderEventResize: function() {
            this.unrenderHelper();
        },


        /* Event Helper
         ------------------------------------------------------------------------------------------------------------------*/


        // Renders a mock "helper" event. `sourceSeg` is the original segment object and might be null (an external drag)
        renderHelper: function(event, sourceSeg) {
            return this.renderHelperSegs(this.eventToSegs(event), sourceSeg); // returns mock event elements
        },


        // Unrenders any mock helper event
        unrenderHelper: function() {
            this.unrenderHelperSegs();
        },


        /* Business Hours
         ------------------------------------------------------------------------------------------------------------------*/


        renderBusinessHours: function() {
            this.renderBusinessSegs(
                this.buildBusinessHourSegs()
            );
        },


        unrenderBusinessHours: function() {
            this.unrenderBusinessSegs();
        },


        /* Now Indicator
         ------------------------------------------------------------------------------------------------------------------*/


        getNowIndicatorUnit: function() {
            return 'minute'; // will refresh on the minute
        },


        renderNowIndicator: function(date) {
            // seg system might be overkill, but it handles scenario where line needs to be rendered
            //  more than once because of columns with the same date (resources columns for example)
            var segs = this.spanToSegs({ start: date, end: date });
            var top = this.computeDateTop(date, date);
            var nodes = [];
            var i;

            // render lines within the columns
            for (i = 0; i < segs.length; i++) {
                nodes.push($('<div class="fc-now-indicator fc-now-indicator-line"></div>')
                    .css('top', top)
                    .appendTo(this.colContainerEls.eq(segs[i].col))[0]);
            }

            // render an arrow over the axis
            if (segs.length > 0) { // is the current time in view?
                nodes.push($('<div class="fc-now-indicator fc-now-indicator-arrow"></div>')
                    .css('top', top)
                    .appendTo(this.el.find('.fc-content-skeleton'))[0]);
            }

            this.nowIndicatorEls = $(nodes);
        },


        unrenderNowIndicator: function() {
            if (this.nowIndicatorEls) {
                this.nowIndicatorEls.remove();
                this.nowIndicatorEls = null;
            }
        },


        /* Selection
         ------------------------------------------------------------------------------------------------------------------*/


        // Renders a visual indication of a selection. Overrides the default, which was to simply render a highlight.
        renderSelection: function(span) {
            if (this.view.opt('selectHelper')) { // this setting signals that a mock helper event should be rendered

                // normally acceps an eventLocation, span has a start/end, which is good enough
                this.renderEventLocationHelper(span);
            }
            else {
                this.renderHighlight(span);
            }
        },


        // Unrenders any visual indication of a selection
        unrenderSelection: function() {
            this.unrenderHelper();
            this.unrenderHighlight();
        },


        /* Highlight
         ------------------------------------------------------------------------------------------------------------------*/


        renderHighlight: function(span) {
            this.renderHighlightSegs(this.spanToSegs(span));
        },


        unrenderHighlight: function() {
            this.unrenderHighlightSegs();
        }

    });

    ;;

    /* Methods for rendering SEGMENTS, pieces of content that live on the view
     ( this file is no longer just for events )
     ----------------------------------------------------------------------------------------------------------------------*/

    TimeGrid.mixin({

        colContainerEls: null, // containers for each column

        // inner-containers for each column where different types of segs live
        fgContainerEls: null,
        bgContainerEls: null,
        helperContainerEls: null,
        highlightContainerEls: null,
        businessContainerEls: null,

        // arrays of different types of displayed segments
        fgSegs: null,
        bgSegs: null,
        helperSegs: null,
        highlightSegs: null,
        businessSegs: null,


        // Renders the DOM that the view's content will live in
        renderContentSkeleton: function() {
            var cellHtml = '';
            var i;
            var skeletonEl;

            for (i = 0; i < this.colCnt; i++) {
                cellHtml +=
                    '<td>' +
                    '<div class="fc-content-col">' +
                    '<div class="fc-event-container fc-helper-container"></div>' +
                    '<div class="fc-event-container"></div>' +
                    '<div class="fc-highlight-container"></div>' +
                    '<div class="fc-bgevent-container"></div>' +
                    '<div class="fc-business-container"></div>' +
                    '</div>' +
                    '</td>';
            }

            skeletonEl = $(
                '<div class="fc-content-skeleton">' +
                '<table>' +
                '<tr>' + cellHtml + '</tr>' +
                '</table>' +
                '</div>'
            );

            this.colContainerEls = skeletonEl.find('.fc-content-col');
            this.helperContainerEls = skeletonEl.find('.fc-helper-container');
            this.fgContainerEls = skeletonEl.find('.fc-event-container:not(.fc-helper-container)');
            this.bgContainerEls = skeletonEl.find('.fc-bgevent-container');
            this.highlightContainerEls = skeletonEl.find('.fc-highlight-container');
            this.businessContainerEls = skeletonEl.find('.fc-business-container');

            this.bookendCells(skeletonEl.find('tr')); // TODO: do this on string level
            this.el.append(skeletonEl);
        },


        /* Foreground Events
         ------------------------------------------------------------------------------------------------------------------*/


        renderFgSegs: function(segs) {
            segs = this.renderFgSegsIntoContainers(segs, this.fgContainerEls);
            this.fgSegs = segs;
            return segs; // needed for Grid::renderEvents
        },


        unrenderFgSegs: function() {
            this.unrenderNamedSegs('fgSegs');
        },


        /* Foreground Helper Events
         ------------------------------------------------------------------------------------------------------------------*/


        renderHelperSegs: function(segs, sourceSeg) {
            var helperEls = [];
            var i, seg;
            var sourceEl;

            segs = this.renderFgSegsIntoContainers(segs, this.helperContainerEls);

            // Try to make the segment that is in the same row as sourceSeg look the same
            for (i = 0; i < segs.length; i++) {
                seg = segs[i];
                if (sourceSeg && sourceSeg.col === seg.col) {
                    sourceEl = sourceSeg.el;
                    seg.el.css({
                        left: sourceEl.css('left'),
                        right: sourceEl.css('right'),
                        'margin-left': sourceEl.css('margin-left'),
                        'margin-right': sourceEl.css('margin-right')
                    });
                }
                helperEls.push(seg.el[0]);
            }

            this.helperSegs = segs;

            return $(helperEls); // must return rendered helpers
        },


        unrenderHelperSegs: function() {
            this.unrenderNamedSegs('helperSegs');
        },


        /* Background Events
         ------------------------------------------------------------------------------------------------------------------*/


        renderBgSegs: function(segs) {
            segs = this.renderFillSegEls('bgEvent', segs); // TODO: old fill system
            this.updateSegVerticals(segs);
            this.attachSegsByCol(this.groupSegsByCol(segs), this.bgContainerEls);
            this.bgSegs = segs;
            return segs; // needed for Grid::renderEvents
        },


        unrenderBgSegs: function() {
            this.unrenderNamedSegs('bgSegs');
        },


        /* Highlight
         ------------------------------------------------------------------------------------------------------------------*/


        renderHighlightSegs: function(segs) {
            segs = this.renderFillSegEls('highlight', segs); // TODO: old fill system
            this.updateSegVerticals(segs);
            this.attachSegsByCol(this.groupSegsByCol(segs), this.highlightContainerEls);
            this.highlightSegs = segs;
        },


        unrenderHighlightSegs: function() {
            this.unrenderNamedSegs('highlightSegs');
        },


        /* Business Hours
         ------------------------------------------------------------------------------------------------------------------*/


        renderBusinessSegs: function(segs) {
            segs = this.renderFillSegEls('businessHours', segs); // TODO: old fill system
            this.updateSegVerticals(segs);
            this.attachSegsByCol(this.groupSegsByCol(segs), this.businessContainerEls);
            this.businessSegs = segs;
        },


        unrenderBusinessSegs: function() {
            this.unrenderNamedSegs('businessSegs');
        },


        /* Seg Rendering Utils
         ------------------------------------------------------------------------------------------------------------------*/


        // Given a flat array of segments, return an array of sub-arrays, grouped by each segment's col
        groupSegsByCol: function(segs) {
            var segsByCol = [];
            var i;

            for (i = 0; i < this.colCnt; i++) {
                segsByCol.push([]);
            }

            for (i = 0; i < segs.length; i++) {
                segsByCol[segs[i].col].push(segs[i]);
            }

            return segsByCol;
        },


        // Given segments grouped by column, insert the segments' elements into a parallel array of container
        // elements, each living within a column.
        attachSegsByCol: function(segsByCol, containerEls) {
            var col;
            var segs;
            var i;

            for (col = 0; col < this.colCnt; col++) { // iterate each column grouping
                segs = segsByCol[col];

                for (i = 0; i < segs.length; i++) {
                    containerEls.eq(col).append(segs[i].el);
                }
            }
        },


        // Given the name of a property of `this` object, assumed to be an array of segments,
        // loops through each segment and removes from DOM. Will null-out the property afterwards.
        unrenderNamedSegs: function(propName) {
            var segs = this[propName];
            var i;

            if (segs) {
                for (i = 0; i < segs.length; i++) {
                    segs[i].el.remove();
                }
                this[propName] = null;
            }
        },



        /* Foreground Event Rendering Utils
         ------------------------------------------------------------------------------------------------------------------*/


        // Given an array of foreground segments, render a DOM element for each, computes position,
        // and attaches to the column inner-container elements.
        renderFgSegsIntoContainers: function(segs, containerEls) {
            var segsByCol;
            var col;

            segs = this.renderFgSegEls(segs); // will call fgSegHtml
            segsByCol = this.groupSegsByCol(segs);

            for (col = 0; col < this.colCnt; col++) {
                this.updateFgSegCoords(segsByCol[col]);
            }

            this.attachSegsByCol(segsByCol, containerEls);

            return segs;
        },


        // Renders the HTML for a single event segment's default rendering
        fgSegHtml: function(seg, disableResizing) {
            var view = this.view;
            var event = seg.event;
            var isDraggable = view.isEventDraggable(event);
            var isResizableFromStart = !disableResizing && seg.isStart && view.isEventResizableFromStart(event);
            var isResizableFromEnd = !disableResizing && seg.isEnd && view.isEventResizableFromEnd(event);
            var classes = this.getSegClasses(seg, isDraggable, isResizableFromStart || isResizableFromEnd);
            var skinCss = cssToStr(this.getSegSkinCss(seg));
            var timeText;
            var fullTimeText; // more verbose time text. for the print stylesheet
            var startTimeText; // just the start time text

            classes.unshift('fc-time-grid-event', 'fc-v-event');

            if (view.isMultiDayEvent(event)) { // if the event appears to span more than one day...
                // Don't display time text on segments that run entirely through a day.
                // That would appear as midnight-midnight and would look dumb.
                // Otherwise, display the time text for the *segment's* times (like 6pm-midnight or midnight-10am)
                if (seg.isStart || seg.isEnd) {
                    timeText = this.getEventTimeText(seg);
                    fullTimeText = this.getEventTimeText(seg, 'LT');
                    startTimeText = this.getEventTimeText(seg, null, false); // displayEnd=false
                }
            } else {
                // Display the normal time text for the *event's* times
                timeText = this.getEventTimeText(event);
                fullTimeText = this.getEventTimeText(event, 'LT');
                startTimeText = this.getEventTimeText(event, null, false); // displayEnd=false
            }

            return '<a class="' + classes.join(' ') + '"' +
                (event.url ?
                        ' href="' + htmlEscape(event.url) + '"' :
                        ''
                ) +
                (skinCss ?
                        ' style="' + skinCss + '"' :
                        ''
                ) +
                '>' +
                '<div class="fc-content">' +
                (timeText ?
                        '<div class="fc-time"' +
                        ' data-start="' + htmlEscape(startTimeText) + '"' +
                        ' data-full="' + htmlEscape(fullTimeText) + '"' +
                        '>' +
                        '<span>' + htmlEscape(timeText) + '</span>' +
                        '</div>' :
                        ''
                ) +
                (event.title ?
                        '<div class="fc-title">' +
                        htmlEscape(event.title) +
                        '</div>' :
                        ''
                ) +
                '</div>' +
                '<div class="fc-bg"/>' +
                /* TODO: write CSS for this
                 (isResizableFromStart ?
                 '<div class="fc-resizer fc-start-resizer" />' :
                 ''
                 ) +
                 */
                (isResizableFromEnd ?
                        '<div class="fc-resizer fc-end-resizer" />' :
                        ''
                ) +
                '</a>';
        },


        /* Seg Position Utils
         ------------------------------------------------------------------------------------------------------------------*/


        // Refreshes the CSS top/bottom coordinates for each segment element.
        // Works when called after initial render, after a window resize/zoom for example.
        updateSegVerticals: function(segs) {
            this.computeSegVerticals(segs);
            this.assignSegVerticals(segs);
        },


        // For each segment in an array, computes and assigns its top and bottom properties
        computeSegVerticals: function(segs) {
            var i, seg;

            for (i = 0; i < segs.length; i++) {
                seg = segs[i];
                seg.top = this.computeDateTop(seg.start, seg.start);
                seg.bottom = this.computeDateTop(seg.end, seg.start);
            }
        },


        // Given segments that already have their top/bottom properties computed, applies those values to
        // the segments' elements.
        assignSegVerticals: function(segs) {
            var i, seg;

            for (i = 0; i < segs.length; i++) {
                seg = segs[i];
                seg.el.css(this.generateSegVerticalCss(seg));
            }
        },


        // Generates an object with CSS properties for the top/bottom coordinates of a segment element
        generateSegVerticalCss: function(seg) {
            return {
                top: seg.top,
                bottom: -seg.bottom // flipped because needs to be space beyond bottom edge of event container
            };
        },


        /* Foreground Event Positioning Utils
         ------------------------------------------------------------------------------------------------------------------*/


        // Given segments that are assumed to all live in the *same column*,
        // compute their verical/horizontal coordinates and assign to their elements.
        updateFgSegCoords: function(segs) {
            this.computeSegVerticals(segs); // horizontals relies on this
            this.computeFgSegHorizontals(segs); // compute horizontal coordinates, z-index's, and reorder the array
            this.assignSegVerticals(segs);
            this.assignFgSegHorizontals(segs);
        },


        // Given an array of segments that are all in the same column, sets the backwardCoord and forwardCoord on each.
        // NOTE: Also reorders the given array by date!
        computeFgSegHorizontals: function(segs) {
            var levels;
            var level0;
            var i;

            this.sortEventSegs(segs); // order by certain criteria
            levels = buildSlotSegLevels(segs);
            computeForwardSlotSegs(levels);

            if ((level0 = levels[0])) {

                for (i = 0; i < level0.length; i++) {
                    computeSlotSegPressures(level0[i]);
                }

                for (i = 0; i < level0.length; i++) {
                    this.computeFgSegForwardBack(level0[i], 0, 0);
                }
            }
        },


        // Calculate seg.forwardCoord and seg.backwardCoord for the segment, where both values range
        // from 0 to 1. If the calendar is left-to-right, the seg.backwardCoord maps to "left" and
        // seg.forwardCoord maps to "right" (via percentage). Vice-versa if the calendar is right-to-left.
        //
        // The segment might be part of a "series", which means consecutive segments with the same pressure
        // who's width is unknown until an edge has been hit. `seriesBackwardPressure` is the number of
        // segments behind this one in the current series, and `seriesBackwardCoord` is the starting
        // coordinate of the first segment in the series.
        computeFgSegForwardBack: function(seg, seriesBackwardPressure, seriesBackwardCoord) {
            var forwardSegs = seg.forwardSegs;
            var i;

            if (seg.forwardCoord === undefined) { // not already computed

                if (!forwardSegs.length) {

                    // if there are no forward segments, this segment should butt up against the edge
                    seg.forwardCoord = 1;
                }
                else {

                    // sort highest pressure first
                    this.sortForwardSegs(forwardSegs);

                    // this segment's forwardCoord will be calculated from the backwardCoord of the
                    // highest-pressure forward segment.
                    this.computeFgSegForwardBack(forwardSegs[0], seriesBackwardPressure + 1, seriesBackwardCoord);
                    seg.forwardCoord = forwardSegs[0].backwardCoord;
                }

                // calculate the backwardCoord from the forwardCoord. consider the series
                seg.backwardCoord = seg.forwardCoord -
                    (seg.forwardCoord - seriesBackwardCoord) / // available width for series
                    (seriesBackwardPressure + 1); // # of segments in the series

                // use this segment's coordinates to computed the coordinates of the less-pressurized
                // forward segments
                for (i=0; i<forwardSegs.length; i++) {
                    this.computeFgSegForwardBack(forwardSegs[i], 0, seg.forwardCoord);
                }
            }
        },


        sortForwardSegs: function(forwardSegs) {
            forwardSegs.sort(proxy(this, 'compareForwardSegs'));
        },


        // A cmp function for determining which forward segment to rely on more when computing coordinates.
        compareForwardSegs: function(seg1, seg2) {
            // put higher-pressure first
            return seg2.forwardPressure - seg1.forwardPressure ||
                // put segments that are closer to initial edge first (and favor ones with no coords yet)
                (seg1.backwardCoord || 0) - (seg2.backwardCoord || 0) ||
                // do normal sorting...
                this.compareEventSegs(seg1, seg2);
        },


        // Given foreground event segments that have already had their position coordinates computed,
        // assigns position-related CSS values to their elements.
        assignFgSegHorizontals: function(segs) {
            var i, seg;

            for (i = 0; i < segs.length; i++) {
                seg = segs[i];
                seg.el.css(this.generateFgSegHorizontalCss(seg));

                // if the height is short, add a className for alternate styling
                if (seg.bottom - seg.top < 30) {
                    seg.el.addClass('fc-short');
                }
            }
        },


        // Generates an object with CSS properties/values that should be applied to an event segment element.
        // Contains important positioning-related properties that should be applied to any event element, customized or not.
        generateFgSegHorizontalCss: function(seg) {
            var shouldOverlap = this.view.opt('slotEventOverlap');
            var backwardCoord = seg.backwardCoord; // the left side if LTR. the right side if RTL. floating-point
            var forwardCoord = seg.forwardCoord; // the right side if LTR. the left side if RTL. floating-point
            var props = this.generateSegVerticalCss(seg); // get top/bottom first
            var left; // amount of space from left edge, a fraction of the total width
            var right; // amount of space from right edge, a fraction of the total width

            if (shouldOverlap) {
                // double the width, but don't go beyond the maximum forward coordinate (1.0)
                forwardCoord = Math.min(1, backwardCoord + (forwardCoord - backwardCoord) * 2);
            }

            if (this.isRTL) {
                left = 1 - forwardCoord;
                right = backwardCoord;
            }
            else {
                left = backwardCoord;
                right = 1 - forwardCoord;
            }

            props.zIndex = seg.level + 1; // convert from 0-base to 1-based
            props.left = left * 100 + '%';
            props.right = right * 100 + '%';

            if (shouldOverlap && seg.forwardPressure) {
                // add padding to the edge so that forward stacked events don't cover the resizer's icon
                props[this.isRTL ? 'marginLeft' : 'marginRight'] = 10 * 2; // 10 is a guesstimate of the icon's width
            }

            return props;
        }

    });


// Builds an array of segments "levels". The first level will be the leftmost tier of segments if the calendar is
// left-to-right, or the rightmost if the calendar is right-to-left. Assumes the segments are already ordered by date.
    function buildSlotSegLevels(segs) {
        var levels = [];
        var i, seg;
        var j;

        for (i=0; i<segs.length; i++) {
            seg = segs[i];

            // go through all the levels and stop on the first level where there are no collisions
            for (j=0; j<levels.length; j++) {
                if (!computeSlotSegCollisions(seg, levels[j]).length) {
                    break;
                }
            }

            seg.level = j;

            (levels[j] || (levels[j] = [])).push(seg);
        }

        return levels;
    }


// For every segment, figure out the other segments that are in subsequent
// levels that also occupy the same vertical space. Accumulate in seg.forwardSegs
    function computeForwardSlotSegs(levels) {
        var i, level;
        var j, seg;
        var k;

        for (i=0; i<levels.length; i++) {
            level = levels[i];

            for (j=0; j<level.length; j++) {
                seg = level[j];

                seg.forwardSegs = [];
                for (k=i+1; k<levels.length; k++) {
                    computeSlotSegCollisions(seg, levels[k], seg.forwardSegs);
                }
            }
        }
    }


// Figure out which path forward (via seg.forwardSegs) results in the longest path until
// the furthest edge is reached. The number of segments in this path will be seg.forwardPressure
    function computeSlotSegPressures(seg) {
        var forwardSegs = seg.forwardSegs;
        var forwardPressure = 0;
        var i, forwardSeg;

        if (seg.forwardPressure === undefined) { // not already computed

            for (i=0; i<forwardSegs.length; i++) {
                forwardSeg = forwardSegs[i];

                // figure out the child's maximum forward path
                computeSlotSegPressures(forwardSeg);

                // either use the existing maximum, or use the child's forward pressure
                // plus one (for the forwardSeg itself)
                forwardPressure = Math.max(
                    forwardPressure,
                    1 + forwardSeg.forwardPressure
                );
            }

            seg.forwardPressure = forwardPressure;
        }
    }


// Find all the segments in `otherSegs` that vertically collide with `seg`.
// Append into an optionally-supplied `results` array and return.
    function computeSlotSegCollisions(seg, otherSegs, results) {
        results = results || [];

        for (var i=0; i<otherSegs.length; i++) {
            if (isSlotSegCollision(seg, otherSegs[i])) {
                results.push(otherSegs[i]);
            }
        }

        return results;
    }


// Do these segments occupy the same vertical space?
    function isSlotSegCollision(seg1, seg2) {
        return seg1.bottom > seg2.top && seg1.top < seg2.bottom;
    }

    ;;

    /* An abstract class from which other views inherit from
     ----------------------------------------------------------------------------------------------------------------------*/

    var View = FC.View = Class.extend(EmitterMixin, ListenerMixin, {

        type: null, // subclass' view name (string)
        name: null, // deprecated. use `type` instead
        title: null, // the text that will be displayed in the header's title

        calendar: null, // owner Calendar object
        options: null, // hash containing all options. already merged with view-specific-options
        el: null, // the view's containing element. set by Calendar

        displaying: null, // a promise representing the state of rendering. null if no render requested
        isSkeletonRendered: false,
        isEventsRendered: false,

        // range the view is actually displaying (moments)
        start: null,
        end: null, // exclusive

        // range the view is formally responsible for (moments)
        // may be different from start/end. for example, a month view might have 1st-31st, excluding padded dates
        intervalStart: null,
        intervalEnd: null, // exclusive
        intervalDuration: null,
        intervalUnit: null, // name of largest unit being displayed, like "month" or "week"

        isRTL: false,
        isSelected: false, // boolean whether a range of time is user-selected or not
        selectedEvent: null,

        eventOrderSpecs: null, // criteria for ordering events when they have same date/time

        // classNames styled by jqui themes
        widgetHeaderClass: null,
        widgetContentClass: null,
        highlightStateClass: null,

        // for date utils, computed from options
        nextDayThreshold: null,
        isHiddenDayHash: null,

        // now indicator
        isNowIndicatorRendered: null,
        initialNowDate: null, // result first getNow call
        initialNowQueriedMs: null, // ms time the getNow was called
        nowIndicatorTimeoutID: null, // for refresh timing of now indicator
        nowIndicatorIntervalID: null, // "


        constructor: function(calendar, type, options, intervalDuration) {

            this.calendar = calendar;
            this.type = this.name = type; // .name is deprecated
            this.options = options;
            this.intervalDuration = intervalDuration || moment.duration(1, 'day');

            this.nextDayThreshold = moment.duration(this.opt('nextDayThreshold'));
            this.initThemingProps();
            this.initHiddenDays();
            this.isRTL = this.opt('isRTL');

            this.eventOrderSpecs = parseFieldSpecs(this.opt('eventOrder'));

            this.initialize();
        },


        // A good place for subclasses to initialize member variables
        initialize: function() {
            // subclasses can implement
        },


        // Retrieves an option with the given name
        opt: function(name) {
            return this.options[name];
        },


        // Triggers handlers that are view-related. Modifies args before passing to calendar.
        trigger: function(name, thisObj) { // arguments beyond thisObj are passed along
            var calendar = this.calendar;

            return calendar.trigger.apply(
                calendar,
                [name, thisObj || this].concat(
                    Array.prototype.slice.call(arguments, 2), // arguments beyond thisObj
                    [ this ] // always make the last argument a reference to the view. TODO: deprecate
                )
            );
        },


        /* Dates
         ------------------------------------------------------------------------------------------------------------------*/


        // Updates all internal dates to center around the given current unzoned date.
        setDate: function(date) {
            this.setRange(this.computeRange(date));
        },


        // Updates all internal dates for displaying the given unzoned range.
        setRange: function(range) {
            $.extend(this, range); // assigns every property to this object's member variables
            this.updateTitle();
        },


        // Given a single current unzoned date, produce information about what range to display.
        // Subclasses can override. Must return all properties.
        computeRange: function(date) {
            var intervalUnit = computeIntervalUnit(this.intervalDuration);
            var intervalStart = date.clone().startOf(intervalUnit);
            var intervalEnd = intervalStart.clone().add(this.intervalDuration);
            var start, end;

            // normalize the range's time-ambiguity
            if (/year|month|week|day/.test(intervalUnit)) { // whole-days?
                intervalStart.stripTime();
                intervalEnd.stripTime();
            }
            else { // needs to have a time?
                if (!intervalStart.hasTime()) {
                    intervalStart = this.calendar.time(0); // give 00:00 time
                }
                if (!intervalEnd.hasTime()) {
                    intervalEnd = this.calendar.time(0); // give 00:00 time
                }
            }

            start = intervalStart.clone();
            start = this.skipHiddenDays(start);
            end = intervalEnd.clone();
            end = this.skipHiddenDays(end, -1, true); // exclusively move backwards

            return {
                intervalUnit: intervalUnit,
                intervalStart: intervalStart,
                intervalEnd: intervalEnd,
                start: start,
                end: end
            };
        },


        // Computes the new date when the user hits the prev button, given the current date
        computePrevDate: function(date) {
            return this.massageCurrentDate(
                date.clone().startOf(this.intervalUnit).subtract(this.intervalDuration), -1
            );
        },


        // Computes the new date when the user hits the next button, given the current date
        computeNextDate: function(date) {
            return this.massageCurrentDate(
                date.clone().startOf(this.intervalUnit).add(this.intervalDuration)
            );
        },


        // Given an arbitrarily calculated current date of the calendar, returns a date that is ensured to be completely
        // visible. `direction` is optional and indicates which direction the current date was being
        // incremented or decremented (1 or -1).
        massageCurrentDate: function(date, direction) {
            if (this.intervalDuration.as('days') <= 1) { // if the view displays a single day or smaller
                if (this.isHiddenDay(date)) {
                    date = this.skipHiddenDays(date, direction);
                    date.startOf('day');
                }
            }

            return date;
        },


        /* Title and Date Formatting
         ------------------------------------------------------------------------------------------------------------------*/


        // Sets the view's title property to the most updated computed value
        updateTitle: function() {
            this.title = this.computeTitle();
        },


        // Computes what the title at the top of the calendar should be for this view
        computeTitle: function() {
            return this.formatRange(
                {
                    // in case intervalStart/End has a time, make sure timezone is correct
                    start: this.calendar.applyTimezone(this.intervalStart),
                    end: this.calendar.applyTimezone(this.intervalEnd)
                },
                this.opt('titleFormat') || this.computeTitleFormat(),
                this.opt('titleRangeSeparator')
            );
        },


        // Generates the format string that should be used to generate the title for the current date range.
        // Attempts to compute the most appropriate format if not explicitly specified with `titleFormat`.
        computeTitleFormat: function() {
            if (this.intervalUnit == 'year') {
                return 'YYYY';
            }
            else if (this.intervalUnit == 'month') {
                return this.opt('monthYearFormat'); // like "September 2014"
            }
            else if (this.intervalDuration.as('days') > 1) {
                return 'll'; // multi-day range. shorter, like "Sep 9 - 10 2014"
            }
            else {
                return 'LL'; // one day. longer, like "September 9 2014"
            }
        },


        // Utility for formatting a range. Accepts a range object, formatting string, and optional separator.
        // Displays all-day ranges naturally, with an inclusive end. Takes the current isRTL into account.
        // The timezones of the dates within `range` will be respected.
        formatRange: function(range, formatStr, separator) {
            var end = range.end;

            if (!end.hasTime()) { // all-day?
                end = end.clone().subtract(1); // convert to inclusive. last ms of previous day
            }

            return formatRange(range.start, end, formatStr, separator, this.opt('isRTL'));
        },


        /* Rendering
         ------------------------------------------------------------------------------------------------------------------*/


        // Sets the container element that the view should render inside of.
        // Does other DOM-related initializations.
        setElement: function(el) {
            this.el = el;
            this.bindGlobalHandlers();
        },


        // Removes the view's container element from the DOM, clearing any content beforehand.
        // Undoes any other DOM-related attachments.
        removeElement: function() {
            this.clear(); // clears all content

            // clean up the skeleton
            if (this.isSkeletonRendered) {
                this.unrenderSkeleton();
                this.isSkeletonRendered = false;
            }

            this.unbindGlobalHandlers();

            this.el.remove();

            // NOTE: don't null-out this.el in case the View was destroyed within an API callback.
            // We don't null-out the View's other jQuery element references upon destroy,
            //  so we shouldn't kill this.el either.
        },


        // Does everything necessary to display the view centered around the given unzoned date.
        // Does every type of rendering EXCEPT rendering events.
        // Is asychronous and returns a promise.
        display: function(date, explicitScrollState) {
            var _this = this;
            var prevScrollState = null;

            if (explicitScrollState != null && this.displaying) { // don't need prevScrollState if explicitScrollState
                prevScrollState = this.queryScroll();
            }

            this.calendar.freezeContentHeight();

            return syncThen(this.clear(), function() { // clear the content first
                return (
                    _this.displaying =
                        syncThen(_this.displayView(date), function() { // displayView might return a promise

                            // caller of display() wants a specific scroll state?
                            if (explicitScrollState != null) {
                                // we make an assumption that this is NOT the initial render,
                                // and thus don't need forceScroll (is inconveniently asynchronous)
                                _this.setScroll(explicitScrollState);
                            }
                            else {
                                _this.forceScroll(_this.computeInitialScroll(prevScrollState));
                            }

                            _this.calendar.unfreezeContentHeight();
                            _this.triggerRender();
                        })
                );
            });
        },


        // Does everything necessary to clear the content of the view.
        // Clears dates and events. Does not clear the skeleton.
        // Is asychronous and returns a promise.
        clear: function() {
            var _this = this;
            var displaying = this.displaying;

            if (displaying) { // previously displayed, or in the process of being displayed?
                return syncThen(displaying, function() { // wait for the display to finish
                    _this.displaying = null;
                    _this.clearEvents();
                    return _this.clearView(); // might return a promise. chain it
                });
            }
            else {
                return $.when(); // an immediately-resolved promise
            }
        },


        // Displays the view's non-event content, such as date-related content or anything required by events.
        // Renders the view's non-content skeleton if necessary.
        // Can be asynchronous and return a promise.
        displayView: function(date) {
            if (!this.isSkeletonRendered) {
                this.renderSkeleton();
                this.isSkeletonRendered = true;
            }
            if (date) {
                this.setDate(date);
            }
            if (this.render) {
                this.render(); // TODO: deprecate
            }
            this.renderDates();
            this.updateSize();
            this.renderBusinessHours(); // might need coordinates, so should go after updateSize()
            this.startNowIndicator();
        },


        // Unrenders the view content that was rendered in displayView.
        // Can be asynchronous and return a promise.
        clearView: function() {
            this.unselect();
            this.stopNowIndicator();
            this.triggerUnrender();
            this.unrenderBusinessHours();
            this.unrenderDates();
            if (this.destroy) {
                this.destroy(); // TODO: deprecate
            }
        },


        // Renders the basic structure of the view before any content is rendered
        renderSkeleton: function() {
            // subclasses should implement
        },


        // Unrenders the basic structure of the view
        unrenderSkeleton: function() {
            // subclasses should implement
        },


        // Renders the view's date-related content.
        // Assumes setRange has already been called and the skeleton has already been rendered.
        renderDates: function() {
            // subclasses should implement
        },


        // Unrenders the view's date-related content
        unrenderDates: function() {
            // subclasses should override
        },


        // Signals that the view's content has been rendered
        triggerRender: function() {
            this.trigger('viewRender', this, this, this.el);
        },


        // Signals that the view's content is about to be unrendered
        triggerUnrender: function() {
            this.trigger('viewDestroy', this, this, this.el);
        },


        // Binds DOM handlers to elements that reside outside the view container, such as the document
        bindGlobalHandlers: function() {
            this.listenTo($(document), 'mousedown', this.handleDocumentMousedown);
            this.listenTo($(document), 'touchstart', this.processUnselect);
        },


        // Unbinds DOM handlers from elements that reside outside the view container
        unbindGlobalHandlers: function() {
            this.stopListeningTo($(document));
        },


        // Initializes internal variables related to theming
        initThemingProps: function() {
            var tm = this.opt('theme') ? 'ui' : 'fc';

            this.widgetHeaderClass = tm + '-widget-header';
            this.widgetContentClass = tm + '-widget-content';
            this.highlightStateClass = tm + '-state-highlight';
        },


        /* Business Hours
         ------------------------------------------------------------------------------------------------------------------*/


        // Renders business-hours onto the view. Assumes updateSize has already been called.
        renderBusinessHours: function() {
            // subclasses should implement
        },


        // Unrenders previously-rendered business-hours
        unrenderBusinessHours: function() {
            // subclasses should implement
        },


        /* Now Indicator
         ------------------------------------------------------------------------------------------------------------------*/


        // Immediately render the current time indicator and begins re-rendering it at an interval,
        // which is defined by this.getNowIndicatorUnit().
        // TODO: somehow do this for the current whole day's background too
        startNowIndicator: function() {
            var _this = this;
            var unit;
            var update;
            var delay; // ms wait value

            if (this.opt('nowIndicator')) {
                unit = this.getNowIndicatorUnit();
                if (unit) {
                    update = proxy(this, 'updateNowIndicator'); // bind to `this`

                    this.initialNowDate = this.calendar.getNow();
                    this.initialNowQueriedMs = +new Date();
                    this.renderNowIndicator(this.initialNowDate);
                    this.isNowIndicatorRendered = true;

                    // wait until the beginning of the next interval
                    delay = this.initialNowDate.clone().startOf(unit).add(1, unit) - this.initialNowDate;
                    this.nowIndicatorTimeoutID = setTimeout(function() {
                        _this.nowIndicatorTimeoutID = null;
                        update();
                        delay = +moment.duration(1, unit);
                        delay = Math.max(100, delay); // prevent too frequent
                        _this.nowIndicatorIntervalID = setInterval(update, delay); // update every interval
                    }, delay);
                }
            }
        },


        // rerenders the now indicator, computing the new current time from the amount of time that has passed
        // since the initial getNow call.
        updateNowIndicator: function() {
            if (this.isNowIndicatorRendered) {
                this.unrenderNowIndicator();
                this.renderNowIndicator(
                    this.initialNowDate.clone().add(new Date() - this.initialNowQueriedMs) // add ms
                );
            }
        },


        // Immediately unrenders the view's current time indicator and stops any re-rendering timers.
        // Won't cause side effects if indicator isn't rendered.
        stopNowIndicator: function() {
            if (this.isNowIndicatorRendered) {

                if (this.nowIndicatorTimeoutID) {
                    clearTimeout(this.nowIndicatorTimeoutID);
                    this.nowIndicatorTimeoutID = null;
                }
                if (this.nowIndicatorIntervalID) {
                    clearTimeout(this.nowIndicatorIntervalID);
                    this.nowIndicatorIntervalID = null;
                }

                this.unrenderNowIndicator();
                this.isNowIndicatorRendered = false;
            }
        },


        // Returns a string unit, like 'second' or 'minute' that defined how often the current time indicator
        // should be refreshed. If something falsy is returned, no time indicator is rendered at all.
        getNowIndicatorUnit: function() {
            // subclasses should implement
        },


        // Renders a current time indicator at the given datetime
        renderNowIndicator: function(date) {
            // subclasses should implement
        },


        // Undoes the rendering actions from renderNowIndicator
        unrenderNowIndicator: function() {
            // subclasses should implement
        },


        /* Dimensions
         ------------------------------------------------------------------------------------------------------------------*/


        // Refreshes anything dependant upon sizing of the container element of the grid
        updateSize: function(isResize) {
            var scrollState;

            if (isResize) {
                scrollState = this.queryScroll();
            }

            this.updateHeight(isResize);
            this.updateWidth(isResize);
            this.updateNowIndicator();

            if (isResize) {
                this.setScroll(scrollState);
            }
        },


        // Refreshes the horizontal dimensions of the calendar
        updateWidth: function(isResize) {
            // subclasses should implement
        },


        // Refreshes the vertical dimensions of the calendar
        updateHeight: function(isResize) {
            var calendar = this.calendar; // we poll the calendar for height information

            this.setHeight(
                calendar.getSuggestedViewHeight(),
                calendar.isHeightAuto()
            );
        },


        // Updates the vertical dimensions of the calendar to the specified height.
        // if `isAuto` is set to true, height becomes merely a suggestion and the view should use its "natural" height.
        setHeight: function(height, isAuto) {
            // subclasses should implement
        },


        /* Scroller
         ------------------------------------------------------------------------------------------------------------------*/


        // Computes the initial pre-configured scroll state prior to allowing the user to change it.
        // Given the scroll state from the previous rendering. If first time rendering, given null.
        computeInitialScroll: function(previousScrollState) {
            return 0;
        },


        // Retrieves the view's current natural scroll state. Can return an arbitrary format.
        queryScroll: function() {
            // subclasses must implement
        },


        // Sets the view's scroll state. Will accept the same format computeInitialScroll and queryScroll produce.
        setScroll: function(scrollState) {
            // subclasses must implement
        },


        // Sets the scroll state, making sure to overcome any predefined scroll value the browser has in mind
        forceScroll: function(scrollState) {
            var _this = this;

            this.setScroll(scrollState);
            setTimeout(function() {
                _this.setScroll(scrollState);
            }, 0);
        },


        /* Event Elements / Segments
         ------------------------------------------------------------------------------------------------------------------*/


        // Does everything necessary to display the given events onto the current view
        displayEvents: function(events) {
            var scrollState = this.queryScroll();

            this.clearEvents();
            this.renderEvents(events);
            this.isEventsRendered = true;
            this.setScroll(scrollState);
            this.triggerEventRender();
        },


        // Does everything necessary to clear the view's currently-rendered events
        clearEvents: function() {
            var scrollState;

            if (this.isEventsRendered) {

                // TODO: optimize: if we know this is part of a displayEvents call, don't queryScroll/setScroll
                scrollState = this.queryScroll();

                this.triggerEventUnrender();
                if (this.destroyEvents) {
                    this.destroyEvents(); // TODO: deprecate
                }
                this.unrenderEvents();
                this.setScroll(scrollState);
                this.isEventsRendered = false;
            }
        },


        // Renders the events onto the view.
        renderEvents: function(events) {
            // subclasses should implement
        },


        // Removes event elements from the view.
        unrenderEvents: function() {
            // subclasses should implement
        },


        // Signals that all events have been rendered
        triggerEventRender: function() {
            this.renderedEventSegEach(function(seg) {
                this.trigger('eventAfterRender', seg.event, seg.event, seg.el);
            });
            this.trigger('eventAfterAllRender');
        },


        // Signals that all event elements are about to be removed
        triggerEventUnrender: function() {
            this.renderedEventSegEach(function(seg) {
                this.trigger('eventDestroy', seg.event, seg.event, seg.el);
            });
        },


        // Given an event and the default element used for rendering, returns the element that should actually be used.
        // Basically runs events and elements through the eventRender hook.
        resolveEventEl: function(event, el) {
            var custom = this.trigger('eventRender', event, event, el);

            if (custom === false) { // means don't render at all
                el = null;
            }
            else if (custom && custom !== true) {
                el = $(custom);
            }

            return el;
        },


        // Hides all rendered event segments linked to the given event
        showEvent: function(event) {
            this.renderedEventSegEach(function(seg) {
                seg.el.css('visibility', '');
            }, event);
        },


        // Shows all rendered event segments linked to the given event
        hideEvent: function(event) {
            this.renderedEventSegEach(function(seg) {
                seg.el.css('visibility', 'hidden');
            }, event);
        },


        // Iterates through event segments that have been rendered (have an el). Goes through all by default.
        // If the optional `event` argument is specified, only iterates through segments linked to that event.
        // The `this` value of the callback function will be the view.
        renderedEventSegEach: function(func, event) {
            var segs = this.getEventSegs();
            var i;

            for (i = 0; i < segs.length; i++) {
                if (!event || segs[i].event._id === event._id) {
                    if (segs[i].el) {
                        func.call(this, segs[i]);
                    }
                }
            }
        },


        // Retrieves all the rendered segment objects for the view
        getEventSegs: function() {
            // subclasses must implement
            return [];
        },


        /* Event Drag-n-Drop
         ------------------------------------------------------------------------------------------------------------------*/


        // Computes if the given event is allowed to be dragged by the user
        isEventDraggable: function(event) {
            var source = event.source || {};

            return firstDefined(
                event.startEditable,
                source.startEditable,
                this.opt('eventStartEditable'),
                event.editable,
                source.editable,
                this.opt('editable')
            );
        },


        // Must be called when an event in the view is dropped onto new location.
        // `dropLocation` is an object that contains the new zoned start/end/allDay values for the event.
        reportEventDrop: function(event, dropLocation, largeUnit, el, ev) {
            var calendar = this.calendar;
            var mutateResult = calendar.mutateEvent(event, dropLocation, largeUnit);
            var undoFunc = function() {
                mutateResult.undo();
                calendar.reportEventChange();
            };

            this.triggerEventDrop(event, mutateResult.dateDelta, undoFunc, el, ev);
            calendar.reportEventChange(); // will rerender events
        },


        // Triggers event-drop handlers that have subscribed via the API
        triggerEventDrop: function(event, dateDelta, undoFunc, el, ev) {
            this.trigger('eventDrop', el[0], event, dateDelta, undoFunc, ev, {}); // {} = jqui dummy
        },


        /* External Element Drag-n-Drop
         ------------------------------------------------------------------------------------------------------------------*/


        // Must be called when an external element, via jQuery UI, has been dropped onto the calendar.
        // `meta` is the parsed data that has been embedded into the dragging event.
        // `dropLocation` is an object that contains the new zoned start/end/allDay values for the event.
        reportExternalDrop: function(meta, dropLocation, el, ev, ui) {
            var eventProps = meta.eventProps;
            var eventInput;
            var event;

            // Try to build an event object and render it. TODO: decouple the two
            if (eventProps) {
                eventInput = $.extend({}, eventProps, dropLocation);
                event = this.calendar.renderEvent(eventInput, meta.stick)[0]; // renderEvent returns an array
            }

            this.triggerExternalDrop(event, dropLocation, el, ev, ui);
        },


        // Triggers external-drop handlers that have subscribed via the API
        triggerExternalDrop: function(event, dropLocation, el, ev, ui) {

            // trigger 'drop' regardless of whether element represents an event
            this.trigger('drop', el[0], dropLocation.start, ev, ui);

            if (event) {
                this.trigger('eventReceive', null, event); // signal an external event landed
            }
        },


        /* Drag-n-Drop Rendering (for both events and external elements)
         ------------------------------------------------------------------------------------------------------------------*/


        // Renders a visual indication of a event or external-element drag over the given drop zone.
        // If an external-element, seg will be `null`.
        // Must return elements used for any mock events.
        renderDrag: function(dropLocation, seg) {
            // subclasses must implement
        },


        // Unrenders a visual indication of an event or external-element being dragged.
        unrenderDrag: function() {
            // subclasses must implement
        },


        /* Event Resizing
         ------------------------------------------------------------------------------------------------------------------*/


        // Computes if the given event is allowed to be resized from its starting edge
        isEventResizableFromStart: function(event) {
            return this.opt('eventResizableFromStart') && this.isEventResizable(event);
        },


        // Computes if the given event is allowed to be resized from its ending edge
        isEventResizableFromEnd: function(event) {
            return this.isEventResizable(event);
        },


        // Computes if the given event is allowed to be resized by the user at all
        isEventResizable: function(event) {
            var source = event.source || {};

            return firstDefined(
                event.durationEditable,
                source.durationEditable,
                this.opt('eventDurationEditable'),
                event.editable,
                source.editable,
                this.opt('editable')
            );
        },


        // Must be called when an event in the view has been resized to a new length
        reportEventResize: function(event, resizeLocation, largeUnit, el, ev) {
            var calendar = this.calendar;
            var mutateResult = calendar.mutateEvent(event, resizeLocation, largeUnit);
            var undoFunc = function() {
                mutateResult.undo();
                calendar.reportEventChange();
            };

            this.triggerEventResize(event, mutateResult.durationDelta, undoFunc, el, ev);
            calendar.reportEventChange(); // will rerender events
        },


        // Triggers event-resize handlers that have subscribed via the API
        triggerEventResize: function(event, durationDelta, undoFunc, el, ev) {
            this.trigger('eventResize', el[0], event, durationDelta, undoFunc, ev, {}); // {} = jqui dummy
        },


        /* Selection (time range)
         ------------------------------------------------------------------------------------------------------------------*/


        // Selects a date span on the view. `start` and `end` are both Moments.
        // `ev` is the native mouse event that begin the interaction.
        select: function(span, ev) {
            this.unselect(ev);
            this.renderSelection(span);
            this.reportSelection(span, ev);
        },


        // Renders a visual indication of the selection
        renderSelection: function(span) {
            // subclasses should implement
        },


        // Called when a new selection is made. Updates internal state and triggers handlers.
        reportSelection: function(span, ev) {
            this.isSelected = true;
            this.triggerSelect(span, ev);
        },


        // Triggers handlers to 'select'
        triggerSelect: function(span, ev) {
            this.trigger(
                'select',
                null,
                this.calendar.applyTimezone(span.start), // convert to calendar's tz for external API
                this.calendar.applyTimezone(span.end), // "
                ev
            );
        },


        // Undoes a selection. updates in the internal state and triggers handlers.
        // `ev` is the native mouse event that began the interaction.
        unselect: function(ev) {
            if (this.isSelected) {
                this.isSelected = false;
                if (this.destroySelection) {
                    this.destroySelection(); // TODO: deprecate
                }
                this.unrenderSelection();
                this.trigger('unselect', null, ev);
            }
        },


        // Unrenders a visual indication of selection
        unrenderSelection: function() {
            // subclasses should implement
        },


        /* Event Selection
         ------------------------------------------------------------------------------------------------------------------*/


        selectEvent: function(event) {
            if (!this.selectedEvent || this.selectedEvent !== event) {
                this.unselectEvent();
                this.renderedEventSegEach(function(seg) {
                    seg.el.addClass('fc-selected');
                }, event);
                this.selectedEvent = event;
            }
        },


        unselectEvent: function() {
            if (this.selectedEvent) {
                this.renderedEventSegEach(function(seg) {
                    seg.el.removeClass('fc-selected');
                }, this.selectedEvent);
                this.selectedEvent = null;
            }
        },


        isEventSelected: function(event) {
            // event references might change on refetchEvents(), while selectedEvent doesn't,
            // so compare IDs
            return this.selectedEvent && this.selectedEvent._id === event._id;
        },


        /* Mouse / Touch Unselecting (time range & event unselection)
         ------------------------------------------------------------------------------------------------------------------*/
        // TODO: move consistently to down/start or up/end?
        // TODO: don't kill previous selection if touch scrolling


        handleDocumentMousedown: function(ev) {
            if (isPrimaryMouseButton(ev)) {
                this.processUnselect(ev);
            }
        },


        processUnselect: function(ev) {
            this.processRangeUnselect(ev);
            this.processEventUnselect(ev);
        },


        processRangeUnselect: function(ev) {
            var ignore;

            // is there a time-range selection?
            if (this.isSelected && this.opt('unselectAuto')) {
                // only unselect if the clicked element is not identical to or inside of an 'unselectCancel' element
                ignore = this.opt('unselectCancel');
                if (!ignore || !$(ev.target).closest(ignore).length) {
                    this.unselect(ev);
                }
            }
        },


        processEventUnselect: function(ev) {
            if (this.selectedEvent) {
                if (!$(ev.target).closest('.fc-selected').length) {
                    this.unselectEvent();
                }
            }
        },


        /* Day Click
         ------------------------------------------------------------------------------------------------------------------*/


        // Triggers handlers to 'dayClick'
        // Span has start/end of the clicked area. Only the start is useful.
        triggerDayClick: function(span, dayEl, ev) {
            this.trigger(
                'dayClick',
                dayEl,
                this.calendar.applyTimezone(span.start), // convert to calendar's timezone for external API
                ev
            );
        },


        /* Date Utils
         ------------------------------------------------------------------------------------------------------------------*/


        // Initializes internal variables related to calculating hidden days-of-week
        initHiddenDays: function() {
            var hiddenDays = this.opt('hiddenDays') || []; // array of day-of-week indices that are hidden
            var isHiddenDayHash = []; // is the day-of-week hidden? (hash with day-of-week-index -> bool)
            var dayCnt = 0;
            var i;

            if (this.opt('weekends') === false) {
                hiddenDays.push(0, 6); // 0=sunday, 6=saturday
            }

            for (i = 0; i < 7; i++) {
                if (
                    !(isHiddenDayHash[i] = $.inArray(i, hiddenDays) !== -1)
                ) {
                    dayCnt++;
                }
            }

            if (!dayCnt) {
                throw 'invalid hiddenDays'; // all days were hidden? bad.
            }

            this.isHiddenDayHash = isHiddenDayHash;
        },


        // Is the current day hidden?
        // `day` is a day-of-week index (0-6), or a Moment
        isHiddenDay: function(day) {
            if (moment.isMoment(day)) {
                day = day.day();
            }
            return this.isHiddenDayHash[day];
        },


        // Incrementing the current day until it is no longer a hidden day, returning a copy.
        // If the initial value of `date` is not a hidden day, don't do anything.
        // Pass `isExclusive` as `true` if you are dealing with an end date.
        // `inc` defaults to `1` (increment one day forward each time)
        skipHiddenDays: function(date, inc, isExclusive) {
            var out = date.clone();
            inc = inc || 1;
            while (
                this.isHiddenDayHash[(out.day() + (isExclusive ? inc : 0) + 7) % 7]
                ) {
                out.add(inc, 'days');
            }
            return out;
        },


        // Returns the date range of the full days the given range visually appears to occupy.
        // Returns a new range object.
        computeDayRange: function(range) {
            var startDay = range.start.clone().stripTime(); // the beginning of the day the range starts
            var end = range.end;
            var endDay = null;
            var endTimeMS;

            if (end) {
                endDay = end.clone().stripTime(); // the beginning of the day the range exclusively ends
                endTimeMS = +end.time(); // # of milliseconds into `endDay`

                // If the end time is actually inclusively part of the next day and is equal to or
                // beyond the next day threshold, adjust the end to be the exclusive end of `endDay`.
                // Otherwise, leaving it as inclusive will cause it to exclude `endDay`.
                if (endTimeMS && endTimeMS >= this.nextDayThreshold) {
                    endDay.add(1, 'days');
                }
            }

            // If no end was specified, or if it is within `startDay` but not past nextDayThreshold,
            // assign the default duration of one day.
            if (!end || endDay <= startDay) {
                endDay = startDay.clone().add(1, 'days');
            }

            return { start: startDay, end: endDay };
        },


        // Does the given event visually appear to occupy more than one day?
        isMultiDayEvent: function(event) {
            var range = this.computeDayRange(event); // event is range-ish

            return range.end.diff(range.start, 'days') > 1;
        }

    });

    ;;

    /*
     Embodies a div that has potential scrollbars
     */
    var Scroller = FC.Scroller = Class.extend({

        el: null, // the guaranteed outer element
        scrollEl: null, // the element with the scrollbars
        overflowX: null,
        overflowY: null,


        constructor: function(options) {
            options = options || {};
            this.overflowX = options.overflowX || options.overflow || 'auto';
            this.overflowY = options.overflowY || options.overflow || 'auto';
        },


        render: function() {
            this.el = this.renderEl();
            this.applyOverflow();
        },


        renderEl: function() {
            return (this.scrollEl = $('<div class="fc-scroller"></div>'));
        },


        // sets to natural height, unlocks overflow
        clear: function() {
            this.setHeight('auto');
            this.applyOverflow();
        },


        destroy: function() {
            this.el.remove();
        },


        // Overflow
        // -----------------------------------------------------------------------------------------------------------------


        applyOverflow: function() {
            this.scrollEl.css({
                'overflow-x': this.overflowX,
                'overflow-y': this.overflowY
            });
        },


        // Causes any 'auto' overflow values to resolves to 'scroll' or 'hidden'.
        // Useful for preserving scrollbar widths regardless of future resizes.
        // Can pass in scrollbarWidths for optimization.
        lockOverflow: function(scrollbarWidths) {
            var overflowX = this.overflowX;
            var overflowY = this.overflowY;

            scrollbarWidths = scrollbarWidths || this.getScrollbarWidths();

            if (overflowX === 'auto') {
                overflowX = (
                    scrollbarWidths.top || scrollbarWidths.bottom || // horizontal scrollbars?
                    // OR scrolling pane with massless scrollbars?
                    this.scrollEl[0].scrollWidth - 1 > this.scrollEl[0].clientWidth
                    // subtract 1 because of IE off-by-one issue
                ) ? 'scroll' : 'hidden';
            }

            if (overflowY === 'auto') {
                overflowY = (
                    scrollbarWidths.left || scrollbarWidths.right || // vertical scrollbars?
                    // OR scrolling pane with massless scrollbars?
                    this.scrollEl[0].scrollHeight - 1 > this.scrollEl[0].clientHeight
                    // subtract 1 because of IE off-by-one issue
                ) ? 'scroll' : 'hidden';
            }

            this.scrollEl.css({ 'overflow-x': overflowX, 'overflow-y': overflowY });
        },


        // Getters / Setters
        // -----------------------------------------------------------------------------------------------------------------


        setHeight: function(height) {
            this.scrollEl.height(height);
        },


        getScrollTop: function() {
            return this.scrollEl.scrollTop();
        },


        setScrollTop: function(top) {
            this.scrollEl.scrollTop(top);
        },


        getClientWidth: function() {
            return this.scrollEl[0].clientWidth;
        },


        getClientHeight: function() {
            return this.scrollEl[0].clientHeight;
        },


        getScrollbarWidths: function() {
            return getScrollbarWidths(this.scrollEl);
        }

    });

    ;;

    var Calendar = FC.Calendar = Class.extend({

        dirDefaults: null, // option defaults related to LTR or RTL
        langDefaults: null, // option defaults related to current locale
        overrides: null, // option overrides given to the fullCalendar constructor
        dynamicOverrides: null, // options set with dynamic setter method. higher precedence than view overrides.
        options: null, // all defaults combined with overrides
        viewSpecCache: null, // cache of view definitions
        view: null, // current View object
        header: null,
        loadingLevel: 0, // number of simultaneous loading tasks


        // a lot of this class' OOP logic is scoped within this constructor function,
        // but in the future, write individual methods on the prototype.
        constructor: Calendar_constructor,


        // Subclasses can override this for initialization logic after the constructor has been called
        initialize: function() {
        },


        // Computes the flattened options hash for the calendar and assigns to `this.options`.
        // Assumes this.overrides and this.dynamicOverrides have already been initialized.
        populateOptionsHash: function() {
            var lang, langDefaults;
            var isRTL, dirDefaults;

            lang = firstDefined( // explicit lang option given?
                this.dynamicOverrides.lang,
                this.overrides.lang
            );
            langDefaults = langOptionHash[lang];
            if (!langDefaults) { // explicit lang option not given or invalid?
                lang = Calendar.defaults.lang;
                langDefaults = langOptionHash[lang] || {};
            }

            isRTL = firstDefined( // based on options computed so far, is direction RTL?
                this.dynamicOverrides.isRTL,
                this.overrides.isRTL,
                langDefaults.isRTL,
                Calendar.defaults.isRTL
            );
            dirDefaults = isRTL ? Calendar.rtlDefaults : {};

            this.dirDefaults = dirDefaults;
            this.langDefaults = langDefaults;
            this.options = mergeOptions([ // merge defaults and overrides. lowest to highest precedence
                Calendar.defaults, // global defaults
                dirDefaults,
                langDefaults,
                this.overrides,
                this.dynamicOverrides
            ]);
            populateInstanceComputableOptions(this.options); // fill in gaps with computed options
        },


        // Gets information about how to create a view. Will use a cache.
        getViewSpec: function(viewType) {
            var cache = this.viewSpecCache;

            return cache[viewType] || (cache[viewType] = this.buildViewSpec(viewType));
        },


        // Given a duration singular unit, like "week" or "day", finds a matching view spec.
        // Preference is given to views that have corresponding buttons.
        getUnitViewSpec: function(unit) {
            var viewTypes;
            var i;
            var spec;

            if ($.inArray(unit, intervalUnits) != -1) {

                // put views that have buttons first. there will be duplicates, but oh well
                viewTypes = this.header.getViewsWithButtons();
                $.each(FC.views, function(viewType) { // all views
                    viewTypes.push(viewType);
                });

                for (i = 0; i < viewTypes.length; i++) {
                    spec = this.getViewSpec(viewTypes[i]);
                    if (spec) {
                        if (spec.singleUnit == unit) {
                            return spec;
                        }
                    }
                }
            }
        },


        // Builds an object with information on how to create a given view
        buildViewSpec: function(requestedViewType) {
            var viewOverrides = this.overrides.views || {};
            var specChain = []; // for the view. lowest to highest priority
            var defaultsChain = []; // for the view. lowest to highest priority
            var overridesChain = []; // for the view. lowest to highest priority
            var viewType = requestedViewType;
            var spec; // for the view
            var overrides; // for the view
            var duration;
            var unit;

            // iterate from the specific view definition to a more general one until we hit an actual View class
            while (viewType) {
                spec = fcViews[viewType];
                overrides = viewOverrides[viewType];
                viewType = null; // clear. might repopulate for another iteration

                if (typeof spec === 'function') { // TODO: deprecate
                    spec = { 'class': spec };
                }

                if (spec) {
                    specChain.unshift(spec);
                    defaultsChain.unshift(spec.defaults || {});
                    duration = duration || spec.duration;
                    viewType = viewType || spec.type;
                }

                if (overrides) {
                    overridesChain.unshift(overrides); // view-specific option hashes have options at zero-level
                    duration = duration || overrides.duration;
                    viewType = viewType || overrides.type;
                }
            }

            spec = mergeProps(specChain);
            spec.type = requestedViewType;
            if (!spec['class']) {
                return false;
            }

            if (duration) {
                duration = moment.duration(duration);
                if (duration.valueOf()) { // valid?
                    spec.duration = duration;
                    unit = computeIntervalUnit(duration);

                    // view is a single-unit duration, like "week" or "day"
                    // incorporate options for this. lowest priority
                    if (duration.as(unit) === 1) {
                        spec.singleUnit = unit;
                        overridesChain.unshift(viewOverrides[unit] || {});
                    }
                }
            }

            spec.defaults = mergeOptions(defaultsChain);
            spec.overrides = mergeOptions(overridesChain);

            this.buildViewSpecOptions(spec);
            this.buildViewSpecButtonText(spec, requestedViewType);

            return spec;
        },


        // Builds and assigns a view spec's options object from its already-assigned defaults and overrides
        buildViewSpecOptions: function(spec) {
            spec.options = mergeOptions([ // lowest to highest priority
                Calendar.defaults, // global defaults
                spec.defaults, // view's defaults (from ViewSubclass.defaults)
                this.dirDefaults,
                this.langDefaults, // locale and dir take precedence over view's defaults!
                this.overrides, // calendar's overrides (options given to constructor)
                spec.overrides, // view's overrides (view-specific options)
                this.dynamicOverrides // dynamically set via setter. highest precedence
            ]);
            populateInstanceComputableOptions(spec.options);
        },


        // Computes and assigns a view spec's buttonText-related options
        buildViewSpecButtonText: function(spec, requestedViewType) {

            // given an options object with a possible `buttonText` hash, lookup the buttonText for the
            // requested view, falling back to a generic unit entry like "week" or "day"
            function queryButtonText(options) {
                var buttonText = options.buttonText || {};
                return buttonText[requestedViewType] ||
                    (spec.singleUnit ? buttonText[spec.singleUnit] : null);
            }

            // highest to lowest priority
            spec.buttonTextOverride =
                queryButtonText(this.dynamicOverrides) ||
                queryButtonText(this.overrides) || // constructor-specified buttonText lookup hash takes precedence
                spec.overrides.buttonText; // `buttonText` for view-specific options is a string

            // highest to lowest priority. mirrors buildViewSpecOptions
            spec.buttonTextDefault =
                queryButtonText(this.langDefaults) ||
                queryButtonText(this.dirDefaults) ||
                spec.defaults.buttonText || // a single string. from ViewSubclass.defaults
                queryButtonText(Calendar.defaults) ||
                (spec.duration ? this.humanizeDuration(spec.duration) : null) || // like "3 days"
                requestedViewType; // fall back to given view name
        },


        // Given a view name for a custom view or a standard view, creates a ready-to-go View object
        instantiateView: function(viewType) {
            var spec = this.getViewSpec(viewType);

            return new spec['class'](this, viewType, spec.options, spec.duration);
        },


        // Returns a boolean about whether the view is okay to instantiate at some point
        isValidViewType: function(viewType) {
            return Boolean(this.getViewSpec(viewType));
        },


        // Should be called when any type of async data fetching begins
        pushLoading: function() {
            if (!(this.loadingLevel++)) {
                this.trigger('loading', null, true, this.view);
            }
        },


        // Should be called when any type of async data fetching completes
        popLoading: function() {
            if (!(--this.loadingLevel)) {
                this.trigger('loading', null, false, this.view);
            }
        },


        // Given arguments to the select method in the API, returns a span (unzoned start/end and other info)
        buildSelectSpan: function(zonedStartInput, zonedEndInput) {
            var start = this.moment(zonedStartInput).stripZone();
            var end;

            if (zonedEndInput) {
                end = this.moment(zonedEndInput).stripZone();
            }
            else if (start.hasTime()) {
                end = start.clone().add(this.defaultTimedEventDuration);
            }
            else {
                end = start.clone().add(this.defaultAllDayEventDuration);
            }

            return { start: start, end: end };
        }

    });


    Calendar.mixin(EmitterMixin);


    function Calendar_constructor(element, overrides) {
        var t = this;


        // Exports
        // -----------------------------------------------------------------------------------

        t.render = render;
        t.destroy = destroy;
        t.refetchEvents = refetchEvents;
        t.refetchEventSources = refetchEventSources;
        t.reportEvents = reportEvents;
        t.reportEventChange = reportEventChange;
        t.rerenderEvents = renderEvents; // `renderEvents` serves as a rerender. an API method
        t.changeView = renderView; // `renderView` will switch to another view
        t.select = select;
        t.unselect = unselect;
        t.prev = prev;
        t.next = next;
        t.prevYear = prevYear;
        t.nextYear = nextYear;
        t.today = today;
        t.gotoDate = gotoDate;
        t.incrementDate = incrementDate;
        t.zoomTo = zoomTo;
        t.getDate = getDate;
        t.getCalendar = getCalendar;
        t.getView = getView;
        t.option = option; // getter/setter method
        t.trigger = trigger;


        // Options
        // -----------------------------------------------------------------------------------

        t.dynamicOverrides = {};
        t.viewSpecCache = {};
        t.optionHandlers = {}; // for Calendar.options.js

        // convert legacy options into non-legacy ones.
        // in the future, when this is removed, don't use `overrides` reference. make a copy.
        t.overrides = massageOverrides(overrides || {});

        t.populateOptionsHash(); // sets this.options



        // Language-data Internals
        // -----------------------------------------------------------------------------------
        // Apply overrides to the current language's data

        var localeData;

        // Called immediately, and when any of the options change.
        // Happens before any internal objects rebuild or rerender, because this is very core.
        t.bindOptions([
            'lang', 'monthNames', 'monthNamesShort', 'dayNames', 'dayNamesShort', 'firstDay', 'weekNumberCalculation'
        ], function(lang, monthNames, monthNamesShort, dayNames, dayNamesShort, firstDay, weekNumberCalculation) {

            localeData = createObject( // make a cheap copy
                getMomentLocaleData(lang) // will fall back to en
            );

            if (monthNames) {
                localeData._months = monthNames;
            }
            if (monthNamesShort) {
                localeData._monthsShort = monthNamesShort;
            }
            if (dayNames) {
                localeData._weekdays = dayNames;
            }
            if (dayNamesShort) {
                localeData._weekdaysShort = dayNamesShort;
            }
            if (firstDay != null) {
                var _week = createObject(localeData._week); // _week: { dow: # }
                _week.dow = firstDay;
                localeData._week = _week;
            }

            if (weekNumberCalculation === 'iso') {
                weekNumberCalculation = 'ISO'; // normalize
            }
            if ( // whitelist certain kinds of input
            weekNumberCalculation === 'ISO' ||
            weekNumberCalculation === 'local' ||
            typeof weekNumberCalculation === 'function'
            ) {
                localeData._fullCalendar_weekCalc = weekNumberCalculation; // moment-ext will know what to do with it
            }

            // If the internal current date object already exists, move to new locale.
            // We do NOT need to do this technique for event dates, because this happens when converting to "segments".
            if (date) {
                localizeMoment(date); // sets to localeData
            }
        });



        // Calendar-specific Date Utilities
        // -----------------------------------------------------------------------------------


        t.defaultAllDayEventDuration = moment.duration(t.options.defaultAllDayEventDuration);
        t.defaultTimedEventDuration = moment.duration(t.options.defaultTimedEventDuration);


        // Builds a moment using the settings of the current calendar: timezone and language.
        // Accepts anything the vanilla moment() constructor accepts.
        t.moment = function() {
            var mom;

            if (t.options.timezone === 'local') {
                mom = FC.moment.apply(null, arguments);

                // Force the moment to be local, because FC.moment doesn't guarantee it.
                if (mom.hasTime()) { // don't give ambiguously-timed moments a local zone
                    mom.local();
                }
            }
            else if (t.options.timezone === 'UTC') {
                mom = FC.moment.utc.apply(null, arguments); // process as UTC
            }
            else {
                mom = FC.moment.parseZone.apply(null, arguments); // let the input decide the zone
            }

            localizeMoment(mom);

            return mom;
        };


        // Updates the given moment's locale settings to the current calendar locale settings.
        function localizeMoment(mom) {
            if ('_locale' in mom) { // moment 2.8 and above
                mom._locale = localeData;
            }
            else { // pre-moment-2.8
                mom._lang = localeData;
            }
        }


        // Returns a boolean about whether or not the calendar knows how to calculate
        // the timezone offset of arbitrary dates in the current timezone.
        t.getIsAmbigTimezone = function() {
            return t.options.timezone !== 'local' && t.options.timezone !== 'UTC';
        };


        // Returns a copy of the given date in the current timezone. Has no effect on dates without times.
        t.applyTimezone = function(date) {
            if (!date.hasTime()) {
                return date.clone();
            }

            var zonedDate = t.moment(date.toArray());
            var timeAdjust = date.time() - zonedDate.time();
            var adjustedZonedDate;

            // Safari sometimes has problems with this coersion when near DST. Adjust if necessary. (bug #2396)
            if (timeAdjust) { // is the time result different than expected?
                adjustedZonedDate = zonedDate.clone().add(timeAdjust); // add milliseconds
                if (date.time() - adjustedZonedDate.time() === 0) { // does it match perfectly now?
                    zonedDate = adjustedZonedDate;
                }
            }

            return zonedDate;
        };


        // Returns a moment for the current date, as defined by the client's computer or from the `now` option.
        // Will return an moment with an ambiguous timezone.
        t.getNow = function() {
            var now = t.options.now;
            if (typeof now === 'function') {
                now = now();
            }
            return t.moment(now).stripZone();
        };


        // Get an event's normalized end date. If not present, calculate it from the defaults.
        t.getEventEnd = function(event) {
            if (event.end) {
                return event.end.clone();
            }
            else {
                return t.getDefaultEventEnd(event.allDay, event.start);
            }
        };


        // Given an event's allDay status and start date, return what its fallback end date should be.
        // TODO: rename to computeDefaultEventEnd
        t.getDefaultEventEnd = function(allDay, zonedStart) {
            var end = zonedStart.clone();

            if (allDay) {
                end.stripTime().add(t.defaultAllDayEventDuration);
            }
            else {
                end.add(t.defaultTimedEventDuration);
            }

            if (t.getIsAmbigTimezone()) {
                end.stripZone(); // we don't know what the tzo should be
            }

            return end;
        };


        // Produces a human-readable string for the given duration.
        // Side-effect: changes the locale of the given duration.
        t.humanizeDuration = function(duration) {
            return (duration.locale || duration.lang).call(duration, t.options.lang) // works moment-pre-2.8
                .humanize();
        };



        // Imports
        // -----------------------------------------------------------------------------------


        EventManager.call(t);
        var isFetchNeeded = t.isFetchNeeded;
        var fetchEvents = t.fetchEvents;
        var fetchEventSources = t.fetchEventSources;



        // Locals
        // -----------------------------------------------------------------------------------


        var _element = element[0];
        var header;
        var content;
        var tm; // for making theme classes
        var currentView; // NOTE: keep this in sync with this.view
        var viewsByType = {}; // holds all instantiated view instances, current or not
        var suggestedViewHeight;
        var windowResizeProxy; // wraps the windowResize function
        var ignoreWindowResize = 0;
        var events = [];
        var date; // unzoned



        // Main Rendering
        // -----------------------------------------------------------------------------------


        // compute the initial ambig-timezone date
        if (t.options.defaultDate != null) {
            date = t.moment(t.options.defaultDate).stripZone();
        }
        else {
            date = t.getNow(); // getNow already returns unzoned
        }


        function render() {
            if (!content) {
                initialRender();
            }
            else if (elementVisible()) {
                // mainly for the public API
                calcSize();
                renderView();
            }
        }


        function initialRender() {
            element.addClass('fc');

            // called immediately, and upon option change
            t.bindOption('theme', function(theme) {
                tm = theme ? 'ui' : 'fc'; // affects a larger scope
                element.toggleClass('ui-widget', theme);
                element.toggleClass('fc-unthemed', !theme);
            });

            // called immediately, and upon option change.
            // HACK: lang often affects isRTL, so we explicitly listen to that too.
            t.bindOptions([ 'isRTL', 'lang' ], function(isRTL) {
                element.toggleClass('fc-ltr', !isRTL);
                element.toggleClass('fc-rtl', isRTL);
            });

            content = $("<div class='fc-view-container'/>").prependTo(element);

            header = t.header = new Header(t);
            renderHeader();

            renderView(t.options.defaultView);

            if (t.options.handleWindowResize) {
                windowResizeProxy = debounce(windowResize, t.options.windowResizeDelay); // prevents rapid calls
                $(window).resize(windowResizeProxy);
            }
        }


        // can be called repeatedly and Header will rerender
        function renderHeader() {
            header.render();
            if (header.el) {
                element.prepend(header.el);
            }
        }


        function destroy() {

            if (currentView) {
                currentView.removeElement();

                // NOTE: don't null-out currentView/t.view in case API methods are called after destroy.
                // It is still the "current" view, just not rendered.
            }

            header.removeElement();
            content.remove();
            element.removeClass('fc fc-ltr fc-rtl fc-unthemed ui-widget');

            if (windowResizeProxy) {
                $(window).unbind('resize', windowResizeProxy);
            }
        }


        function elementVisible() {
            return element.is(':visible');
        }



        // View Rendering
        // -----------------------------------------------------------------------------------


        // Renders a view because of a date change, view-type change, or for the first time.
        // If not given a viewType, keep the current view but render different dates.
        // Accepts an optional scroll state to restore to.
        function renderView(viewType, explicitScrollState) {
            ignoreWindowResize++;

            // if viewType is changing, remove the old view's rendering
            if (currentView && viewType && currentView.type !== viewType) {
                freezeContentHeight(); // prevent a scroll jump when view element is removed
                clearView();
            }

            // if viewType changed, or the view was never created, create a fresh view
            if (!currentView && viewType) {
                currentView = t.view =
                    viewsByType[viewType] ||
                    (viewsByType[viewType] = t.instantiateView(viewType));

                currentView.setElement(
                    $("<div class='fc-view fc-" + viewType + "-view' />").appendTo(content)
                );
                header.activateButton(viewType);
            }

            if (currentView) {

                // in case the view should render a period of time that is completely hidden
                date = currentView.massageCurrentDate(date);

                // render or rerender the view
                if (
                    !currentView.displaying ||
                    !date.isWithin(currentView.intervalStart, currentView.intervalEnd) // implicit date window change
                ) {
                    if (elementVisible()) {

                        currentView.display(date, explicitScrollState); // will call freezeContentHeight
                        unfreezeContentHeight(); // immediately unfreeze regardless of whether display is async

                        // need to do this after View::render, so dates are calculated
                        updateHeaderTitle();
                        updateTodayButton();

                        getAndRenderEvents();
                    }
                }
            }

            unfreezeContentHeight(); // undo any lone freezeContentHeight calls
            ignoreWindowResize--;
        }


        // Unrenders the current view and reflects this change in the Header.
        // Unregsiters the `currentView`, but does not remove from viewByType hash.
        function clearView() {
            header.deactivateButton(currentView.type);
            currentView.removeElement();
            currentView = t.view = null;
        }


        // Destroys the view, including the view object. Then, re-instantiates it and renders it.
        // Maintains the same scroll state.
        // TODO: maintain any other user-manipulated state.
        function reinitView() {
            ignoreWindowResize++;
            freezeContentHeight();

            var viewType = currentView.type;
            var scrollState = currentView.queryScroll();
            clearView();
            renderView(viewType, scrollState);

            unfreezeContentHeight();
            ignoreWindowResize--;
        }



        // Resizing
        // -----------------------------------------------------------------------------------


        t.getSuggestedViewHeight = function() {
            if (suggestedViewHeight === undefined) {
                calcSize();
            }
            return suggestedViewHeight;
        };


        t.isHeightAuto = function() {
            return t.options.contentHeight === 'auto' || t.options.height === 'auto';
        };


        function updateSize(shouldRecalc) {
            if (elementVisible()) {

                if (shouldRecalc) {
                    _calcSize();
                }

                ignoreWindowResize++;
                currentView.updateSize(true); // isResize=true. will poll getSuggestedViewHeight() and isHeightAuto()
                ignoreWindowResize--;

                return true; // signal success
            }
        }


        function calcSize() {
            if (elementVisible()) {
                _calcSize();
            }
        }


        function _calcSize() { // assumes elementVisible
            var contentHeightInput = t.options.contentHeight;
            var heightInput = t.options.height;

            if (typeof contentHeightInput === 'number') { // exists and not 'auto'
                suggestedViewHeight = contentHeightInput;
            }
            else if (typeof contentHeightInput === 'function') { // exists and is a function
                suggestedViewHeight = contentHeightInput();
            }
            else if (typeof heightInput === 'number') { // exists and not 'auto'
                suggestedViewHeight = heightInput - queryHeaderHeight();
            }
            else if (typeof heightInput === 'function') { // exists and is a function
                suggestedViewHeight = heightInput() - queryHeaderHeight();
            }
            else if (heightInput === 'parent') { // set to height of parent element
                suggestedViewHeight = element.parent().height() - queryHeaderHeight();
            }
            else {
                suggestedViewHeight = Math.round(content.width() / Math.max(t.options.aspectRatio, .5));
            }
        }


        function queryHeaderHeight() {
            return header.el ? header.el.outerHeight(true) : 0; // includes margin
        }


        function windowResize(ev) {
            if (
                !ignoreWindowResize &&
                ev.target === window && // so we don't process jqui "resize" events that have bubbled up
                currentView.start // view has already been rendered
            ) {
                if (updateSize(true)) {
                    currentView.trigger('windowResize', _element);
                }
            }
        }



        /* Event Fetching/Rendering
         -----------------------------------------------------------------------------*/
        // TODO: going forward, most of this stuff should be directly handled by the view


        function refetchEvents() { // can be called as an API method
            fetchAndRenderEvents();
        }


        // TODO: move this into EventManager?
        function refetchEventSources(matchInputs) {
            fetchEventSources(t.getEventSourcesByMatchArray(matchInputs));
        }


        function renderEvents() { // destroys old events if previously rendered
            if (elementVisible()) {
                freezeContentHeight();
                currentView.displayEvents(events);
                unfreezeContentHeight();
            }
        }


        function getAndRenderEvents() {
            if (!t.options.lazyFetching || isFetchNeeded(currentView.start, currentView.end)) {
                fetchAndRenderEvents();
            }
            else {
                renderEvents();
            }
        }


        function fetchAndRenderEvents() {
            fetchEvents(currentView.start, currentView.end);
            // ... will call reportEvents
            // ... which will call renderEvents
        }


        // called when event data arrives
        function reportEvents(_events) {
            events = _events;
            renderEvents();
        }


        // called when a single event's data has been changed
        function reportEventChange() {
            renderEvents();
        }



        /* Header Updating
         -----------------------------------------------------------------------------*/


        function updateHeaderTitle() {
            header.updateTitle(currentView.title);
        }


        function updateTodayButton() {
            var now = t.getNow();
            if (now.isWithin(currentView.intervalStart, currentView.intervalEnd)) {
                header.disableButton('today');
            }
            else {
                header.enableButton('today');
            }
        }



        /* Selection
         -----------------------------------------------------------------------------*/


        // this public method receives start/end dates in any format, with any timezone
        function select(zonedStartInput, zonedEndInput) {
            currentView.select(
                t.buildSelectSpan.apply(t, arguments)
            );
        }


        function unselect() { // safe to be called before renderView
            if (currentView) {
                currentView.unselect();
            }
        }



        /* Date
         -----------------------------------------------------------------------------*/


        function prev() {
            date = currentView.computePrevDate(date);
            renderView();
        }


        function next() {
            date = currentView.computeNextDate(date);
            renderView();
        }


        function prevYear() {
            date.add(-1, 'years');
            renderView();
        }


        function nextYear() {
            date.add(1, 'years');
            renderView();
        }


        function today() {
            date = t.getNow();
            renderView();
        }


        function gotoDate(zonedDateInput) {
            date = t.moment(zonedDateInput).stripZone();
            renderView();
        }


        function incrementDate(delta) {
            date.add(moment.duration(delta));
            renderView();
        }


        // Forces navigation to a view for the given date.
        // `viewType` can be a specific view name or a generic one like "week" or "day".
        function zoomTo(newDate, viewType) {
            var spec;

            viewType = viewType || 'day'; // day is default zoom
            spec = t.getViewSpec(viewType) || t.getUnitViewSpec(viewType);

            date = newDate.clone();
            renderView(spec ? spec.type : null);
        }


        // for external API
        function getDate() {
            return t.applyTimezone(date); // infuse the calendar's timezone
        }



        /* Height "Freezing"
         -----------------------------------------------------------------------------*/
        // TODO: move this into the view

        t.freezeContentHeight = freezeContentHeight;
        t.unfreezeContentHeight = unfreezeContentHeight;


        function freezeContentHeight() {
            content.css({
                width: '100%',
                height: content.height(),
                overflow: 'hidden'
            });
        }


        function unfreezeContentHeight() {
            content.css({
                width: '',
                height: '',
                overflow: ''
            });
        }



        /* Misc
         -----------------------------------------------------------------------------*/


        function getCalendar() {
            return t;
        }


        function getView() {
            return currentView;
        }


        function option(name, value) {
            var newOptionHash;

            if (typeof name === 'string') {
                if (value === undefined) { // getter
                    return t.options[name];
                }
                else { // setter for individual option
                    newOptionHash = {};
                    newOptionHash[name] = value;
                    setOptions(newOptionHash);
                }
            }
            else if (typeof name === 'object') { // compound setter with object input
                setOptions(name);
            }
        }


        function setOptions(newOptionHash) {
            var optionCnt = 0;
            var optionName;

            for (optionName in newOptionHash) {
                t.dynamicOverrides[optionName] = newOptionHash[optionName];
            }

            t.viewSpecCache = {}; // the dynamic override invalidates the options in this cache, so just clear it
            t.populateOptionsHash(); // this.options needs to be recomputed after the dynamic override

            // trigger handlers after this.options has been updated
            for (optionName in newOptionHash) {
                t.triggerOptionHandlers(optionName); // recall bindOption/bindOptions
                optionCnt++;
            }

            // special-case handling of single option change.
            // if only one option change, `optionName` will be its name.
            if (optionCnt === 1) {
                if (optionName === 'height' || optionName === 'contentHeight' || optionName === 'aspectRatio') {
                    updateSize(true); // true = allow recalculation of height
                    return;
                }
                else if (optionName === 'defaultDate') {
                    return; // can't change date this way. use gotoDate instead
                }
                else if (optionName === 'businessHours') {
                    if (currentView) {
                        currentView.unrenderBusinessHours();
                        currentView.renderBusinessHours();
                    }
                    return;
                }
                else if (optionName === 'timezone') {
                    t.rezoneArrayEventSources();
                    refetchEvents();
                    return;
                }
            }

            // catch-all. rerender the header and rebuild/rerender the current view
            renderHeader();
            viewsByType = {}; // even non-current views will be affected by this option change. do before rerender
            reinitView();
        }


        function trigger(name, thisObj) { // overrides the Emitter's trigger method :(
            var args = Array.prototype.slice.call(arguments, 2);

            thisObj = thisObj || _element;
            this.triggerWith(name, thisObj, args); // Emitter's method

            if (t.options[name]) {
                return t.options[name].apply(thisObj, args);
            }
        }

        t.initialize();
    }

    ;;
    /*
     Options binding/triggering system.
     */
    Calendar.mixin({

        // A map of option names to arrays of handler objects. Initialized to {} in Calendar.
        // Format for a handler object:
        // {
        //   func // callback function to be called upon change
        //   names // option names whose values should be given to func
        // }
        optionHandlers: null,

        // Calls handlerFunc immediately, and when the given option has changed.
        // handlerFunc will be given the option value.
        bindOption: function(optionName, handlerFunc) {
            this.bindOptions([ optionName ], handlerFunc);
        },

        // Calls handlerFunc immediately, and when any of the given options change.
        // handlerFunc will be given each option value as ordered function arguments.
        bindOptions: function(optionNames, handlerFunc) {
            var handlerObj = { func: handlerFunc, names: optionNames };
            var i;

            for (i = 0; i < optionNames.length; i++) {
                this.registerOptionHandlerObj(optionNames[i], handlerObj);
            }

            this.triggerOptionHandlerObj(handlerObj);
        },

        // Puts the given handler object into the internal hash
        registerOptionHandlerObj: function(optionName, handlerObj) {
            (this.optionHandlers[optionName] || (this.optionHandlers[optionName] = []))
                .push(handlerObj);
        },

        // Reports that the given option has changed, and calls all appropriate handlers.
        triggerOptionHandlers: function(optionName) {
            var handlerObjs = this.optionHandlers[optionName] || [];
            var i;

            for (i = 0; i < handlerObjs.length; i++) {
                this.triggerOptionHandlerObj(handlerObjs[i]);
            }
        },

        // Calls the callback for a specific handler object, passing in the appropriate arguments.
        triggerOptionHandlerObj: function(handlerObj) {
            var optionNames = handlerObj.names;
            var optionValues = [];
            var i;

            for (i = 0; i < optionNames.length; i++) {
                optionValues.push(this.options[optionNames[i]]);
            }

            handlerObj.func.apply(this, optionValues); // maintain the Calendar's `this` context
        }

    });

    ;;

    Calendar.defaults = {

        titleRangeSeparator: ' \u2013 ', // en dash
        monthYearFormat: 'MMMM YYYY', // required for en. other languages rely on datepicker computable option

        defaultTimedEventDuration: '02:00:00',
        defaultAllDayEventDuration: { days: 1 },
        forceEventDuration: false,
        nextDayThreshold: '09:00:00', // 9am

        // display
        defaultView: 'month',
        aspectRatio: 1.35,
        header: {
            left: 'title',
            center: '',
            right: 'today prev,next'
        },
        weekends: true,
        weekNumbers: false,

        weekNumberTitle: 'W',
        weekNumberCalculation: 'local',

        //editable: false,

        //nowIndicator: false,

        scrollTime: '06:00:00',

        // event ajax
        lazyFetching: true,
        startParam: 'start',
        endParam: 'end',
        timezoneParam: 'timezone',

        timezone: false,

        //allDayDefault: undefined,

        // locale
        isRTL: false,
        buttonText: {
            prev: "prev",
            next: "next",
            prevYear: "prev year",
            nextYear: "next year",
            year: 'year', // TODO: locale files need to specify this
            today: 'today',
            month: 'month',
            week: 'week',
            day: 'day'
        },

        buttonIcons: {
            prev: 'left-single-arrow',
            next: 'right-single-arrow',
            prevYear: 'left-double-arrow',
            nextYear: 'right-double-arrow'
        },

        // jquery-ui theming
        theme: false,
        themeButtonIcons: {
            prev: 'circle-triangle-w',
            next: 'circle-triangle-e',
            prevYear: 'seek-prev',
            nextYear: 'seek-next'
        },

        //eventResizableFromStart: false,
        dragOpacity: .75,
        dragRevertDuration: 500,
        dragScroll: true,

        //selectable: false,
        unselectAuto: true,

        dropAccept: '*',

        eventOrder: 'title',

        eventLimit: false,
        eventLimitText: 'more',
        eventLimitClick: 'popover',
        dayPopoverFormat: 'LL',

        handleWindowResize: true,
        windowResizeDelay: 100, // milliseconds before an updateSize happens

        longPressDelay: 1000

    };


    Calendar.englishDefaults = { // used by lang.js
        dayPopoverFormat: 'dddd, MMMM D'
    };


    Calendar.rtlDefaults = { // right-to-left defaults
        header: { // TODO: smarter solution (first/center/last ?)
            left: 'next,prev today',
            center: '',
            right: 'title'
        },
        buttonIcons: {
            prev: 'right-single-arrow',
            next: 'left-single-arrow',
            prevYear: 'right-double-arrow',
            nextYear: 'left-double-arrow'
        },
        themeButtonIcons: {
            prev: 'circle-triangle-e',
            next: 'circle-triangle-w',
            nextYear: 'seek-prev',
            prevYear: 'seek-next'
        }
    };

    ;;

    var langOptionHash = FC.langs = {}; // initialize and expose


// TODO: document the structure and ordering of a FullCalendar lang file
// TODO: rename everything "lang" to "locale", like what the moment project did


// Initialize jQuery UI datepicker translations while using some of the translations
// Will set this as the default language for datepicker.
    FC.datepickerLang = function(langCode, dpLangCode, dpOptions) {

        // get the FullCalendar internal option hash for this language. create if necessary
        var fcOptions = langOptionHash[langCode] || (langOptionHash[langCode] = {});

        // transfer some simple options from datepicker to fc
        fcOptions.isRTL = dpOptions.isRTL;
        fcOptions.weekNumberTitle = dpOptions.weekHeader;

        // compute some more complex options from datepicker
        $.each(dpComputableOptions, function(name, func) {
            fcOptions[name] = func(dpOptions);
        });

        // is jQuery UI Datepicker is on the page?
        if ($.datepicker) {

            // Register the language data.
            // FullCalendar and MomentJS use language codes like "pt-br" but Datepicker
            // does it like "pt-BR" or if it doesn't have the language, maybe just "pt".
            // Make an alias so the language can be referenced either way.
            $.datepicker.regional[dpLangCode] =
                $.datepicker.regional[langCode] = // alias
                    dpOptions;

            // Alias 'en' to the default language data. Do this every time.
            $.datepicker.regional.en = $.datepicker.regional[''];

            // Set as Datepicker's global defaults.
            $.datepicker.setDefaults(dpOptions);
        }
    };


// Sets FullCalendar-specific translations. Will set the language as the global default.
    FC.lang = function(langCode, newFcOptions) {
        var fcOptions;
        var momOptions;

        // get the FullCalendar internal option hash for this language. create if necessary
        fcOptions = langOptionHash[langCode] || (langOptionHash[langCode] = {});

        // provided new options for this language? merge them in
        if (newFcOptions) {
            fcOptions = langOptionHash[langCode] = mergeOptions([ fcOptions, newFcOptions ]);
        }

        // compute language options that weren't defined.
        // always do this. newFcOptions can be undefined when initializing from i18n file,
        // so no way to tell if this is an initialization or a default-setting.
        momOptions = getMomentLocaleData(langCode); // will fall back to en
        $.each(momComputableOptions, function(name, func) {
            if (fcOptions[name] == null) {
                fcOptions[name] = func(momOptions, fcOptions);
            }
        });

        // set it as the default language for FullCalendar
        Calendar.defaults.lang = langCode;
    };


// NOTE: can't guarantee any of these computations will run because not every language has datepicker
// configs, so make sure there are English fallbacks for these in the defaults file.
    var dpComputableOptions = {

        buttonText: function(dpOptions) {
            return {
                // the translations sometimes wrongly contain HTML entities
                prev: stripHtmlEntities(dpOptions.prevText),
                next: stripHtmlEntities(dpOptions.nextText),
                today: stripHtmlEntities(dpOptions.currentText)
            };
        },

        // Produces format strings like "MMMM YYYY" -> "September 2014"
        monthYearFormat: function(dpOptions) {
            return dpOptions.showMonthAfterYear ?
                'YYYY[' + dpOptions.yearSuffix + '] MMMM' :
                'MMMM YYYY[' + dpOptions.yearSuffix + ']';
        }

    };

    var momComputableOptions = {

        // Produces format strings like "ddd M/D" -> "Fri 9/15"
        dayOfMonthFormat: function(momOptions, fcOptions) {
            var format = momOptions.longDateFormat('l'); // for the format like "M/D/YYYY"

            // strip the year off the edge, as well as other misc non-whitespace chars
            format = format.replace(/^Y+[^\w\s]*|[^\w\s]*Y+$/g, '');

            if (fcOptions.isRTL) {
                format += ' ddd'; // for RTL, add day-of-week to end
            }
            else {
                format = 'ddd ' + format; // for LTR, add day-of-week to beginning
            }
            return format;
        },

        // Produces format strings like "h:mma" -> "6:00pm"
        mediumTimeFormat: function(momOptions) { // can't be called `timeFormat` because collides with option
            return momOptions.longDateFormat('LT')
                .replace(/\s*a$/i, 'a'); // convert AM/PM/am/pm to lowercase. remove any spaces beforehand
        },

        // Produces format strings like "h(:mm)a" -> "6pm" / "6:30pm"
        smallTimeFormat: function(momOptions) {
            return momOptions.longDateFormat('LT')
                .replace(':mm', '(:mm)')
                .replace(/(\Wmm)$/, '($1)') // like above, but for foreign langs
                .replace(/\s*a$/i, 'a'); // convert AM/PM/am/pm to lowercase. remove any spaces beforehand
        },

        // Produces format strings like "h(:mm)t" -> "6p" / "6:30p"
        extraSmallTimeFormat: function(momOptions) {
            return momOptions.longDateFormat('LT')
                .replace(':mm', '(:mm)')
                .replace(/(\Wmm)$/, '($1)') // like above, but for foreign langs
                .replace(/\s*a$/i, 't'); // convert to AM/PM/am/pm to lowercase one-letter. remove any spaces beforehand
        },

        // Produces format strings like "ha" / "H" -> "6pm" / "18"
        hourFormat: function(momOptions) {
            return momOptions.longDateFormat('LT')
                .replace(':mm', '')
                .replace(/(\Wmm)$/, '') // like above, but for foreign langs
                .replace(/\s*a$/i, 'a'); // convert AM/PM/am/pm to lowercase. remove any spaces beforehand
        },

        // Produces format strings like "h:mm" -> "6:30" (with no AM/PM)
        noMeridiemTimeFormat: function(momOptions) {
            return momOptions.longDateFormat('LT')
                .replace(/\s*a$/i, ''); // remove trailing AM/PM
        }

    };


// options that should be computed off live calendar options (considers override options)
// TODO: best place for this? related to lang?
// TODO: flipping text based on isRTL is a bad idea because the CSS `direction` might want to handle it
    var instanceComputableOptions = {

        // Produces format strings for results like "Mo 16"
        smallDayDateFormat: function(options) {
            return options.isRTL ?
                'D dd' :
                'dd D';
        },

        // Produces format strings for results like "Wk 5"
        weekFormat: function(options) {
            return options.isRTL ?
                'w[ ' + options.weekNumberTitle + ']' :
                '[' + options.weekNumberTitle + ' ]w';
        },

        // Produces format strings for results like "Wk5"
        smallWeekFormat: function(options) {
            return options.isRTL ?
                'w[' + options.weekNumberTitle + ']' :
                '[' + options.weekNumberTitle + ']w';
        }

    };

    function populateInstanceComputableOptions(options) {
        $.each(instanceComputableOptions, function(name, func) {
            if (options[name] == null) {
                options[name] = func(options);
            }
        });
    }


// Returns moment's internal locale data. If doesn't exist, returns English.
// Works with moment-pre-2.8
    function getMomentLocaleData(langCode) {
        var func = moment.localeData || moment.langData;
        return func.call(moment, langCode) ||
            func.call(moment, 'en'); // the newer localData could return null, so fall back to en
    }


// Initialize English by forcing computation of moment-derived options.
// Also, sets it as the default.
    FC.lang('en', Calendar.englishDefaults);

    ;;

    /* Top toolbar area with buttons and title
     ----------------------------------------------------------------------------------------------------------------------*/
// TODO: rename all header-related things to "toolbar"

    function Header(calendar) {
        var t = this;

        // exports
        t.render = render;
        t.removeElement = removeElement;
        t.updateTitle = updateTitle;
        t.activateButton = activateButton;
        t.deactivateButton = deactivateButton;
        t.disableButton = disableButton;
        t.enableButton = enableButton;
        t.getViewsWithButtons = getViewsWithButtons;
        t.el = null; // mirrors local `el`

        // locals
        var el;
        var viewsWithButtons = [];
        var tm;


        // can be called repeatedly and will rerender
        function render() {
            var options = calendar.options;
            var sections = options.header;

            tm = options.theme ? 'ui' : 'fc';

            if (sections) {
                if (!el) {
                    el = this.el = $("<div class='fc-toolbar'/>");
                }
                else {
                    el.empty();
                }
                el.append(renderSection('left'))
                    .append(renderSection('right'))
                    .append(renderSection('center'))
                    .append('<div class="fc-clear"/>');
            }
            else {
                removeElement();
            }
        }


        function removeElement() {
            if (el) {
                el.remove();
                el = t.el = null;
            }
        }


        function renderSection(position) {
            var sectionEl = $('<div class="fc-' + position + '"/>');
            var options = calendar.options;
            var buttonStr = options.header[position];

            if (buttonStr) {
                $.each(buttonStr.split(' '), function(i) {
                    var groupChildren = $();
                    var isOnlyButtons = true;
                    var groupEl;

                    $.each(this.split(','), function(j, buttonName) {
                        var customButtonProps;
                        var viewSpec;
                        var buttonClick;
                        var overrideText; // text explicitly set by calendar's constructor options. overcomes icons
                        var defaultText;
                        var themeIcon;
                        var normalIcon;
                        var innerHtml;
                        var classes;
                        var button; // the element

                        if (buttonName == 'title') {
                            groupChildren = groupChildren.add($('<h2>&nbsp;</h2>')); // we always want it to take up height
                            isOnlyButtons = false;
                        }
                        else {
                            if ((customButtonProps = (options.customButtons || {})[buttonName])) {
                                buttonClick = function(ev) {
                                    if (customButtonProps.click) {
                                        customButtonProps.click.call(button[0], ev);
                                    }
                                };
                                overrideText = ''; // icons will override text
                                defaultText = customButtonProps.text;
                            }
                            else if ((viewSpec = calendar.getViewSpec(buttonName))) {
                                buttonClick = function() {
                                    calendar.changeView(buttonName);
                                };
                                viewsWithButtons.push(buttonName);
                                overrideText = viewSpec.buttonTextOverride;
                                defaultText = viewSpec.buttonTextDefault;
                            }
                            else if (calendar[buttonName]) { // a calendar method
                                buttonClick = function() {
                                    calendar[buttonName]();
                                };
                                overrideText = (calendar.overrides.buttonText || {})[buttonName];
                                defaultText = options.buttonText[buttonName]; // everything else is considered default
                            }

                            if (buttonClick) {

                                themeIcon =
                                    customButtonProps ?
                                        customButtonProps.themeIcon :
                                        options.themeButtonIcons[buttonName];

                                normalIcon =
                                    customButtonProps ?
                                        customButtonProps.icon :
                                        options.buttonIcons[buttonName];

                                if (overrideText) {
                                    innerHtml = htmlEscape(overrideText);
                                }
                                else if (themeIcon && options.theme) {
                                    innerHtml = "<span class='ui-icon ui-icon-" + themeIcon + "'></span>";
                                }
                                else if (normalIcon && !options.theme) {
                                    innerHtml = "<span class='fc-icon fc-icon-" + normalIcon + "'></span>";
                                }
                                else {
                                    innerHtml = htmlEscape(defaultText);
                                }

                                classes = [
                                    'fc-' + buttonName + '-button',
                                    tm + '-button',
                                    tm + '-state-default'
                                ];

                                button = $( // type="button" so that it doesn't submit a form
                                    '<button type="button" class="' + classes.join(' ') + '">' +
                                    innerHtml +
                                    '</button>'
                                )
                                    .click(function(ev) {
                                        // don't process clicks for disabled buttons
                                        if (!button.hasClass(tm + '-state-disabled')) {

                                            buttonClick(ev);

                                            // after the click action, if the button becomes the "active" tab, or disabled,
                                            // it should never have a hover class, so remove it now.
                                            if (
                                                button.hasClass(tm + '-state-active') ||
                                                button.hasClass(tm + '-state-disabled')
                                            ) {
                                                button.removeClass(tm + '-state-hover');
                                            }
                                        }
                                    })
                                    .mousedown(function() {
                                        // the *down* effect (mouse pressed in).
                                        // only on buttons that are not the "active" tab, or disabled
                                        button
                                            .not('.' + tm + '-state-active')
                                            .not('.' + tm + '-state-disabled')
                                            .addClass(tm + '-state-down');
                                    })
                                    .mouseup(function() {
                                        // undo the *down* effect
                                        button.removeClass(tm + '-state-down');
                                    })
                                    .hover(
                                        function() {
                                            // the *hover* effect.
                                            // only on buttons that are not the "active" tab, or disabled
                                            button
                                                .not('.' + tm + '-state-active')
                                                .not('.' + tm + '-state-disabled')
                                                .addClass(tm + '-state-hover');
                                        },
                                        function() {
                                            // undo the *hover* effect
                                            button
                                                .removeClass(tm + '-state-hover')
                                                .removeClass(tm + '-state-down'); // if mouseleave happens before mouseup
                                        }
                                    );

                                groupChildren = groupChildren.add(button);
                            }
                        }
                    });

                    if (isOnlyButtons) {
                        groupChildren
                            .first().addClass(tm + '-corner-left').end()
                            .last().addClass(tm + '-corner-right').end();
                        if (groupChildren.length === 2){
                            groupChildren
                                .first().attr('aria-label', options.buttonText.prevText).end()
                                .last().attr('aria-label', options.buttonText.nextText).end();
                        }
                    }

                    if (groupChildren.length > 1) {
                        groupEl = $('<div/>');
                        if (isOnlyButtons) {
                            groupEl.addClass('fc-button-group');
                        }
                        groupEl.append(groupChildren);
                        sectionEl.append(groupEl);
                    }
                    else {
                        sectionEl.append(groupChildren); // 1 or 0 children
                    }
                });
            }

            return sectionEl;
        }


        function updateTitle(text) {
            if (el) {
                el.find('h2').text(text);
            }
        }


        function activateButton(buttonName) {
            if (el) {
                el.find('.fc-' + buttonName + '-button')
                    .addClass(tm + '-state-active').attr('tabindex','-1');
            }
        }


        function deactivateButton(buttonName) {
            if (el) {
                el.find('.fc-' + buttonName + '-button')
                    .removeClass(tm + '-state-active').attr('tabindex','0');
            }
        }


        function disableButton(buttonName) {
            if (el) {
                el.find('.fc-' + buttonName + '-button')
                    .prop('disabled', true)
                    .addClass(tm + '-state-disabled');
            }
        }


        function enableButton(buttonName) {
            if (el) {
                el.find('.fc-' + buttonName + '-button')
                    .prop('disabled', false)
                    .removeClass(tm + '-state-disabled');
            }
        }


        function getViewsWithButtons() {
            return viewsWithButtons;
        }

    }

    ;;

    FC.sourceNormalizers = [];
    FC.sourceFetchers = [];

    var ajaxDefaults = {
        dataType: 'json',
        cache: false
    };

    var eventGUID = 1;


    function EventManager() { // assumed to be a calendar
        var t = this;


        // exports
        t.isFetchNeeded = isFetchNeeded;
        t.fetchEvents = fetchEvents;
        t.fetchEventSources = fetchEventSources;
        t.getEventSources = getEventSources;
        t.getEventSourceById = getEventSourceById;
        t.getEventSourcesByMatchArray = getEventSourcesByMatchArray;
        t.getEventSourcesByMatch = getEventSourcesByMatch;
        t.addEventSource = addEventSource;
        t.removeEventSource = removeEventSource;
        t.removeEventSources = removeEventSources;
        t.updateEvent = updateEvent;
        t.renderEvent = renderEvent;
        t.removeEvents = removeEvents;
        t.clientEvents = clientEvents;
        t.mutateEvent = mutateEvent;
        t.normalizeEventDates = normalizeEventDates;
        t.normalizeEventTimes = normalizeEventTimes;


        // imports
        var reportEvents = t.reportEvents;


        // locals
        var stickySource = { events: [] };
        var sources = [ stickySource ];
        var rangeStart, rangeEnd;
        var pendingSourceCnt = 0; // outstanding fetch requests, max one per source
        var cache = []; // holds events that have already been expanded


        $.each(
            (t.options.events ? [ t.options.events ] : []).concat(t.options.eventSources || []),
            function(i, sourceInput) {
                var source = buildEventSource(sourceInput);
                if (source) {
                    sources.push(source);
                }
            }
        );



        /* Fetching
         -----------------------------------------------------------------------------*/


        // start and end are assumed to be unzoned
        function isFetchNeeded(start, end) {
            return !rangeStart || // nothing has been fetched yet?
                start < rangeStart || end > rangeEnd; // is part of the new range outside of the old range?
        }


        function fetchEvents(start, end) {
            rangeStart = start;
            rangeEnd = end;
            fetchEventSources(sources, 'reset');
        }


        // expects an array of event source objects (the originals, not copies)
        // `specialFetchType` is an optimization parameter that affects purging of the event cache.
        function fetchEventSources(specificSources, specialFetchType) {
            var i, source;

            if (specialFetchType === 'reset') {
                cache = [];
            }
            else if (specialFetchType !== 'add') {
                cache = excludeEventsBySources(cache, specificSources);
            }

            for (i = 0; i < specificSources.length; i++) {
                source = specificSources[i];

                // already-pending sources have already been accounted for in pendingSourceCnt
                if (source._status !== 'pending') {
                    pendingSourceCnt++;
                }

                source._fetchId = (source._fetchId || 0) + 1;
                source._status = 'pending';
            }

            for (i = 0; i < specificSources.length; i++) {
                source = specificSources[i];

                tryFetchEventSource(source, source._fetchId);
            }
        }


        // fetches an event source and processes its result ONLY if it is still the current fetch.
        // caller is responsible for incrementing pendingSourceCnt first.
        function tryFetchEventSource(source, fetchId) {
            _fetchEventSource(source, function(eventInputs) {
                var isArraySource = $.isArray(source.events);
                var i, eventInput;
                var abstractEvent;

                if (
                    // is this the source's most recent fetch?
                // if not, rely on an upcoming fetch of this source to decrement pendingSourceCnt
                fetchId === source._fetchId &&
                // event source no longer valid?
                source._status !== 'rejected'
                ) {
                    source._status = 'resolved';

                    if (eventInputs) {
                        for (i = 0; i < eventInputs.length; i++) {
                            eventInput = eventInputs[i];

                            if (isArraySource) { // array sources have already been convert to Event Objects
                                abstractEvent = eventInput;
                            }
                            else {
                                abstractEvent = buildEventFromInput(eventInput, source);
                            }

                            if (abstractEvent) { // not false (an invalid event)
                                cache.push.apply(
                                    cache,
                                    expandEvent(abstractEvent) // add individual expanded events to the cache
                                );
                            }
                        }
                    }

                    decrementPendingSourceCnt();
                }
            });
        }


        function rejectEventSource(source) {
            var wasPending = source._status === 'pending';

            source._status = 'rejected';

            if (wasPending) {
                decrementPendingSourceCnt();
            }
        }


        function decrementPendingSourceCnt() {
            pendingSourceCnt--;
            if (!pendingSourceCnt) {
                reportEvents(cache);
            }
        }


        function _fetchEventSource(source, callback) {
            var i;
            var fetchers = FC.sourceFetchers;
            var res;

            for (i=0; i<fetchers.length; i++) {
                res = fetchers[i].call(
                    t, // this, the Calendar object
                    source,
                    rangeStart.clone(),
                    rangeEnd.clone(),
                    t.options.timezone,
                    callback
                );

                if (res === true) {
                    // the fetcher is in charge. made its own async request
                    return;
                }
                else if (typeof res == 'object') {
                    // the fetcher returned a new source. process it
                    _fetchEventSource(res, callback);
                    return;
                }
            }

            var events = source.events;
            if (events) {
                if ($.isFunction(events)) {
                    t.pushLoading();
                    events.call(
                        t, // this, the Calendar object
                        rangeStart.clone(),
                        rangeEnd.clone(),
                        t.options.timezone,
                        function(events) {
                            callback(events);
                            t.popLoading();
                        }
                    );
                }
                else if ($.isArray(events)) {
                    callback(events);
                }
                else {
                    callback();
                }
            }else{
                var url = source.url;
                if (url) {
                    var success = source.success;
                    var error = source.error;
                    var complete = source.complete;

                    // retrieve any outbound GET/POST $.ajax data from the options
                    var customData;
                    if ($.isFunction(source.data)) {
                        // supplied as a function that returns a key/value object
                        customData = source.data();
                    }
                    else {
                        // supplied as a straight key/value object
                        customData = source.data;
                    }

                    // use a copy of the custom data so we can modify the parameters
                    // and not affect the passed-in object.
                    var data = $.extend({}, customData || {});

                    var startParam = firstDefined(source.startParam, t.options.startParam);
                    var endParam = firstDefined(source.endParam, t.options.endParam);
                    var timezoneParam = firstDefined(source.timezoneParam, t.options.timezoneParam);

                    if (startParam) {
                        data[startParam] = rangeStart.format();
                    }
                    if (endParam) {
                        data[endParam] = rangeEnd.format();
                    }
                    if (t.options.timezone && t.options.timezone != 'local') {
                        data[timezoneParam] = t.options.timezone;
                    }

                    t.pushLoading();
                    $.ajax($.extend({}, ajaxDefaults, source, {
                        data: data,
                        success: function(events) {
                            events = events || [];
                            var res = applyAll(success, this, arguments);
                            if ($.isArray(res)) {
                                events = res;
                            }
                            callback(events);
                        },
                        error: function() {
                            applyAll(error, this, arguments);
                            callback();
                        },
                        complete: function() {
                            applyAll(complete, this, arguments);
                            t.popLoading();
                        }
                    }));
                }else{
                    callback();
                }
            }
        }



        /* Sources
         -----------------------------------------------------------------------------*/


        function addEventSource(sourceInput) {
            var source = buildEventSource(sourceInput);
            if (source) {
                sources.push(source);
                fetchEventSources([ source ], 'add'); // will eventually call reportEvents
            }
        }


        function buildEventSource(sourceInput) { // will return undefined if invalid source
            var normalizers = FC.sourceNormalizers;
            var source;
            var i;

            if ($.isFunction(sourceInput) || $.isArray(sourceInput)) {
                source = { events: sourceInput };
            }
            else if (typeof sourceInput === 'string') {
                source = { url: sourceInput };
            }
            else if (typeof sourceInput === 'object') {
                source = $.extend({}, sourceInput); // shallow copy
            }

            if (source) {

                // TODO: repeat code, same code for event classNames
                if (source.className) {
                    if (typeof source.className === 'string') {
                        source.className = source.className.split(/\s+/);
                    }
                    // otherwise, assumed to be an array
                }
                else {
                    source.className = [];
                }

                // for array sources, we convert to standard Event Objects up front
                if ($.isArray(source.events)) {
                    source.origArray = source.events; // for removeEventSource
                    source.events = $.map(source.events, function(eventInput) {
                        return buildEventFromInput(eventInput, source);
                    });
                }

                for (i=0; i<normalizers.length; i++) {
                    normalizers[i].call(t, source);
                }

                return source;
            }
        }


        function removeEventSource(matchInput) {
            removeSpecificEventSources(
                getEventSourcesByMatch(matchInput)
            );
        }


        // if called with no arguments, removes all.
        function removeEventSources(matchInputs) {
            if (matchInputs == null) {
                removeSpecificEventSources(sources, true); // isAll=true
            }
            else {
                removeSpecificEventSources(
                    getEventSourcesByMatchArray(matchInputs)
                );
            }
        }


        function removeSpecificEventSources(targetSources, isAll) {
            var i;

            // cancel pending requests
            for (i = 0; i < targetSources.length; i++) {
                rejectEventSource(targetSources[i]);
            }

            if (isAll) { // an optimization
                sources = [];
                cache = [];
            }
            else {
                // remove from persisted source list
                sources = $.grep(sources, function(source) {
                    for (i = 0; i < targetSources.length; i++) {
                        if (source === targetSources[i]) {
                            return false; // exclude
                        }
                    }
                    return true; // include
                });

                cache = excludeEventsBySources(cache, targetSources);
            }

            reportEvents(cache);
        }


        function getEventSources() {
            return sources.slice(1); // returns a shallow copy of sources with stickySource removed
        }


        function getEventSourceById(id) {
            return $.grep(sources, function(source) {
                return source.id && source.id === id;
            })[0];
        }


        // like getEventSourcesByMatch, but accepts multple match criteria (like multiple IDs)
        function getEventSourcesByMatchArray(matchInputs) {

            // coerce into an array
            if (!matchInputs) {
                matchInputs = [];
            }
            else if (!$.isArray(matchInputs)) {
                matchInputs = [ matchInputs ];
            }

            var matchingSources = [];
            var i;

            // resolve raw inputs to real event source objects
            for (i = 0; i < matchInputs.length; i++) {
                matchingSources.push.apply( // append
                    matchingSources,
                    getEventSourcesByMatch(matchInputs[i])
                );
            }

            return matchingSources;
        }


        // matchInput can either by a real event source object, an ID, or the function/URL for the source.
        // returns an array of matching source objects.
        function getEventSourcesByMatch(matchInput) {
            var i, source;

            // given an proper event source object
            for (i = 0; i < sources.length; i++) {
                source = sources[i];
                if (source === matchInput) {
                    return [ source ];
                }
            }

            // an ID match
            source = getEventSourceById(matchInput);
            if (source) {
                return [ source ];
            }

            return $.grep(sources, function(source) {
                return isSourcesEquivalent(matchInput, source);
            });
        }


        function isSourcesEquivalent(source1, source2) {
            return source1 && source2 && getSourcePrimitive(source1) == getSourcePrimitive(source2);
        }


        function getSourcePrimitive(source) {
            return (
                    (typeof source === 'object') ? // a normalized event source?
                        (source.origArray || source.googleCalendarId || source.url || source.events) : // get the primitive
                        null
                ) ||
                source; // the given argument *is* the primitive
        }


        // util
        // returns a filtered array without events that are part of any of the given sources
        function excludeEventsBySources(specificEvents, specificSources) {
            return $.grep(specificEvents, function(event) {
                for (var i = 0; i < specificSources.length; i++) {
                    if (event.source === specificSources[i]) {
                        return false; // exclude
                    }
                }
                return true; // keep
            });
        }



        /* Manipulation
         -----------------------------------------------------------------------------*/


        // Only ever called from the externally-facing API
        function updateEvent(event) {

            // massage start/end values, even if date string values
            event.start = t.moment(event.start);
            if (event.end) {
                event.end = t.moment(event.end);
            }
            else {
                event.end = null;
            }

            mutateEvent(event, getMiscEventProps(event)); // will handle start/end/allDay normalization
            reportEvents(cache); // reports event modifications (so we can redraw)
        }


        // Returns a hash of misc event properties that should be copied over to related events.
        function getMiscEventProps(event) {
            var props = {};

            $.each(event, function(name, val) {
                if (isMiscEventPropName(name)) {
                    if (val !== undefined && isAtomic(val)) { // a defined non-object
                        props[name] = val;
                    }
                }
            });

            return props;
        }

        // non-date-related, non-id-related, non-secret
        function isMiscEventPropName(name) {
            return !/^_|^(id|allDay|start|end)$/.test(name);
        }


        // returns the expanded events that were created
        function renderEvent(eventInput, stick) {
            var abstractEvent = buildEventFromInput(eventInput);
            var events;
            var i, event;

            if (abstractEvent) { // not false (a valid input)
                events = expandEvent(abstractEvent);

                for (i = 0; i < events.length; i++) {
                    event = events[i];

                    if (!event.source) {
                        if (stick) {
                            stickySource.events.push(event);
                            event.source = stickySource;
                        }
                        cache.push(event);
                    }
                }

                reportEvents(cache);

                return events;
            }

            return [];
        }


        function removeEvents(filter) {
            var eventID;
            var i;

            if (filter == null) { // null or undefined. remove all events
                filter = function() { return true; }; // will always match
            }
            else if (!$.isFunction(filter)) { // an event ID
                eventID = filter + '';
                filter = function(event) {
                    return event._id == eventID;
                };
            }

            // Purge event(s) from our local cache
            cache = $.grep(cache, filter, true); // inverse=true

            // Remove events from array sources.
            // This works because they have been converted to official Event Objects up front.
            // (and as a result, event._id has been calculated).
            for (i=0; i<sources.length; i++) {
                if ($.isArray(sources[i].events)) {
                    sources[i].events = $.grep(sources[i].events, filter, true);
                }
            }

            reportEvents(cache);
        }


        function clientEvents(filter) {
            if ($.isFunction(filter)) {
                return $.grep(cache, filter);
            }
            else if (filter != null) { // not null, not undefined. an event ID
                filter += '';
                return $.grep(cache, function(e) {
                    return e._id == filter;
                });
            }
            return cache; // else, return all
        }


        // Makes sure all array event sources have their internal event objects
        // converted over to the Calendar's current timezone.
        t.rezoneArrayEventSources = function() {
            var i;
            var events;
            var j;

            for (i = 0; i < sources.length; i++) {
                events = sources[i].events;
                if ($.isArray(events)) {

                    for (j = 0; j < events.length; j++) {
                        rezoneEventDates(events[j]);
                    }
                }
            }
        };

        function rezoneEventDates(event) {
            event.start = t.moment(event.start);
            if (event.end) {
                event.end = t.moment(event.end);
            }
            backupEventDates(event);
        }


        /* Event Normalization
         -----------------------------------------------------------------------------*/


        // Given a raw object with key/value properties, returns an "abstract" Event object.
        // An "abstract" event is an event that, if recurring, will not have been expanded yet.
        // Will return `false` when input is invalid.
        // `source` is optional
        function buildEventFromInput(input, source) {
            var out = {};
            var start, end;
            var allDay;

            if (t.options.eventDataTransform) {
                input = t.options.eventDataTransform(input);
            }
            if (source && source.eventDataTransform) {
                input = source.eventDataTransform(input);
            }

            // Copy all properties over to the resulting object.
            // The special-case properties will be copied over afterwards.
            $.extend(out, input);

            if (source) {
                out.source = source;
            }

            out._id = input._id || (input.id === undefined ? '_fc' + eventGUID++ : input.id + '');

            if (input.className) {
                if (typeof input.className == 'string') {
                    out.className = input.className.split(/\s+/);
                }
                else { // assumed to be an array
                    out.className = input.className;
                }
            }
            else {
                out.className = [];
            }

            start = input.start || input.date; // "date" is an alias for "start"
            end = input.end;

            // parse as a time (Duration) if applicable
            if (isTimeString(start)) {
                start = moment.duration(start);
            }
            if (isTimeString(end)) {
                end = moment.duration(end);
            }

            if (input.dow || moment.isDuration(start) || moment.isDuration(end)) {

                // the event is "abstract" (recurring) so don't calculate exact start/end dates just yet
                out.start = start ? moment.duration(start) : null; // will be a Duration or null
                out.end = end ? moment.duration(end) : null; // will be a Duration or null
                out._recurring = true; // our internal marker
            }
            else {

                if (start) {
                    start = t.moment(start);
                    if (!start.isValid()) {
                        return false;
                    }
                }

                if (end) {
                    end = t.moment(end);
                    if (!end.isValid()) {
                        end = null; // let defaults take over
                    }
                }

                allDay = input.allDay;
                if (allDay === undefined) { // still undefined? fallback to default
                    allDay = firstDefined(
                        source ? source.allDayDefault : undefined,
                        t.options.allDayDefault
                    );
                    // still undefined? normalizeEventDates will calculate it
                }

                assignDatesToEvent(start, end, allDay, out);
            }

            t.normalizeEvent(out); // hook for external use. a prototype method

            return out;
        }
        t.buildEventFromInput = buildEventFromInput;


        // Normalizes and assigns the given dates to the given partially-formed event object.
        // NOTE: mutates the given start/end moments. does not make a copy.
        function assignDatesToEvent(start, end, allDay, event) {
            event.start = start;
            event.end = end;
            event.allDay = allDay;
            normalizeEventDates(event);
            backupEventDates(event);
        }


        // Ensures proper values for allDay/start/end. Accepts an Event object, or a plain object with event-ish properties.
        // NOTE: Will modify the given object.
        function normalizeEventDates(eventProps) {

            normalizeEventTimes(eventProps);

            if (eventProps.end && !eventProps.end.isAfter(eventProps.start)) {
                eventProps.end = null;
            }

            if (!eventProps.end) {
                if (t.options.forceEventDuration) {
                    eventProps.end = t.getDefaultEventEnd(eventProps.allDay, eventProps.start);
                }
                else {
                    eventProps.end = null;
                }
            }
        }


        // Ensures the allDay property exists and the timeliness of the start/end dates are consistent
        function normalizeEventTimes(eventProps) {
            if (eventProps.allDay == null) {
                eventProps.allDay = !(eventProps.start.hasTime() || (eventProps.end && eventProps.end.hasTime()));
            }

            if (eventProps.allDay) {
                eventProps.start.stripTime();
                if (eventProps.end) {
                    // TODO: consider nextDayThreshold here? If so, will require a lot of testing and adjustment
                    eventProps.end.stripTime();
                }
            }
            else {
                if (!eventProps.start.hasTime()) {
                    eventProps.start = t.applyTimezone(eventProps.start.time(0)); // will assign a 00:00 time
                }
                if (eventProps.end && !eventProps.end.hasTime()) {
                    eventProps.end = t.applyTimezone(eventProps.end.time(0)); // will assign a 00:00 time
                }
            }
        }


        // If the given event is a recurring event, break it down into an array of individual instances.
        // If not a recurring event, return an array with the single original event.
        // If given a falsy input (probably because of a failed buildEventFromInput call), returns an empty array.
        // HACK: can override the recurring window by providing custom rangeStart/rangeEnd (for businessHours).
        function expandEvent(abstractEvent, _rangeStart, _rangeEnd) {
            var events = [];
            var dowHash;
            var dow;
            var i;
            var date;
            var startTime, endTime;
            var start, end;
            var event;

            _rangeStart = _rangeStart || rangeStart;
            _rangeEnd = _rangeEnd || rangeEnd;

            if (abstractEvent) {
                if (abstractEvent._recurring) {

                    // make a boolean hash as to whether the event occurs on each day-of-week
                    if ((dow = abstractEvent.dow)) {
                        dowHash = {};
                        for (i = 0; i < dow.length; i++) {
                            dowHash[dow[i]] = true;
                        }
                    }

                    // iterate through every day in the current range
                    date = _rangeStart.clone().stripTime(); // holds the date of the current day
                    while (date.isBefore(_rangeEnd)) {

                        if (!dowHash || dowHash[date.day()]) { // if everyday, or this particular day-of-week

                            startTime = abstractEvent.start; // the stored start and end properties are times (Durations)
                            endTime = abstractEvent.end; // "
                            start = date.clone();
                            end = null;

                            if (startTime) {
                                start = start.time(startTime);
                            }
                            if (endTime) {
                                end = date.clone().time(endTime);
                            }

                            event = $.extend({}, abstractEvent); // make a copy of the original
                            assignDatesToEvent(
                                start, end,
                                !startTime && !endTime, // allDay?
                                event
                            );
                            events.push(event);
                        }

                        date.add(1, 'days');
                    }
                }
                else {
                    events.push(abstractEvent); // return the original event. will be a one-item array
                }
            }

            return events;
        }
        t.expandEvent = expandEvent;



        /* Event Modification Math
         -----------------------------------------------------------------------------------------*/


        // Modifies an event and all related events by applying the given properties.
        // Special date-diffing logic is used for manipulation of dates.
        // If `props` does not contain start/end dates, the updated values are assumed to be the event's current start/end.
        // All date comparisons are done against the event's pristine _start and _end dates.
        // Returns an object with delta information and a function to undo all operations.
        // For making computations in a granularity greater than day/time, specify largeUnit.
        // NOTE: The given `newProps` might be mutated for normalization purposes.
        function mutateEvent(event, newProps, largeUnit) {
            var miscProps = {};
            var oldProps;
            var clearEnd;
            var startDelta;
            var endDelta;
            var durationDelta;
            var undoFunc;

            // diffs the dates in the appropriate way, returning a duration
            function diffDates(date1, date0) { // date1 - date0
                if (largeUnit) {
                    return diffByUnit(date1, date0, largeUnit);
                }
                else if (newProps.allDay) {
                    return diffDay(date1, date0);
                }
                else {
                    return diffDayTime(date1, date0);
                }
            }

            newProps = newProps || {};

            // normalize new date-related properties
            if (!newProps.start) {
                newProps.start = event.start.clone();
            }
            if (newProps.end === undefined) {
                newProps.end = event.end ? event.end.clone() : null;
            }
            if (newProps.allDay == null) { // is null or undefined?
                newProps.allDay = event.allDay;
            }
            normalizeEventDates(newProps);

            // create normalized versions of the original props to compare against
            // need a real end value, for diffing
            oldProps = {
                start: event._start.clone(),
                end: event._end ? event._end.clone() : t.getDefaultEventEnd(event._allDay, event._start),
                allDay: newProps.allDay // normalize the dates in the same regard as the new properties
            };
            normalizeEventDates(oldProps);

            // need to clear the end date if explicitly changed to null
            clearEnd = event._end !== null && newProps.end === null;

            // compute the delta for moving the start date
            startDelta = diffDates(newProps.start, oldProps.start);

            // compute the delta for moving the end date
            if (newProps.end) {
                endDelta = diffDates(newProps.end, oldProps.end);
                durationDelta = endDelta.subtract(startDelta);
            }
            else {
                durationDelta = null;
            }

            // gather all non-date-related properties
            $.each(newProps, function(name, val) {
                if (isMiscEventPropName(name)) {
                    if (val !== undefined) {
                        miscProps[name] = val;
                    }
                }
            });

            // apply the operations to the event and all related events
            undoFunc = mutateEvents(
                clientEvents(event._id), // get events with this ID
                clearEnd,
                newProps.allDay,
                startDelta,
                durationDelta,
                miscProps
            );

            return {
                dateDelta: startDelta,
                durationDelta: durationDelta,
                undo: undoFunc
            };
        }


        // Modifies an array of events in the following ways (operations are in order):
        // - clear the event's `end`
        // - convert the event to allDay
        // - add `dateDelta` to the start and end
        // - add `durationDelta` to the event's duration
        // - assign `miscProps` to the event
        //
        // Returns a function that can be called to undo all the operations.
        //
        // TODO: don't use so many closures. possible memory issues when lots of events with same ID.
        //
        function mutateEvents(events, clearEnd, allDay, dateDelta, durationDelta, miscProps) {
            var isAmbigTimezone = t.getIsAmbigTimezone();
            var undoFunctions = [];

            // normalize zero-length deltas to be null
            if (dateDelta && !dateDelta.valueOf()) { dateDelta = null; }
            if (durationDelta && !durationDelta.valueOf()) { durationDelta = null; }

            $.each(events, function(i, event) {
                var oldProps;
                var newProps;

                // build an object holding all the old values, both date-related and misc.
                // for the undo function.
                oldProps = {
                    start: event.start.clone(),
                    end: event.end ? event.end.clone() : null,
                    allDay: event.allDay
                };
                $.each(miscProps, function(name) {
                    oldProps[name] = event[name];
                });

                // new date-related properties. work off the original date snapshot.
                // ok to use references because they will be thrown away when backupEventDates is called.
                newProps = {
                    start: event._start,
                    end: event._end,
                    allDay: allDay // normalize the dates in the same regard as the new properties
                };
                normalizeEventDates(newProps); // massages start/end/allDay

                // strip or ensure the end date
                if (clearEnd) {
                    newProps.end = null;
                }
                else if (durationDelta && !newProps.end) { // the duration translation requires an end date
                    newProps.end = t.getDefaultEventEnd(newProps.allDay, newProps.start);
                }

                if (dateDelta) {
                    newProps.start.add(dateDelta);
                    if (newProps.end) {
                        newProps.end.add(dateDelta);
                    }
                }

                if (durationDelta) {
                    newProps.end.add(durationDelta); // end already ensured above
                }

                // if the dates have changed, and we know it is impossible to recompute the
                // timezone offsets, strip the zone.
                if (
                    isAmbigTimezone &&
                    !newProps.allDay &&
                    (dateDelta || durationDelta)
                ) {
                    newProps.start.stripZone();
                    if (newProps.end) {
                        newProps.end.stripZone();
                    }
                }

                $.extend(event, miscProps, newProps); // copy over misc props, then date-related props
                backupEventDates(event); // regenerate internal _start/_end/_allDay

                undoFunctions.push(function() {
                    $.extend(event, oldProps);
                    backupEventDates(event); // regenerate internal _start/_end/_allDay
                });
            });

            return function() {
                for (var i = 0; i < undoFunctions.length; i++) {
                    undoFunctions[i]();
                }
            };
        }


        /* Overlapping / Constraining
         -----------------------------------------------------------------------------------------*/

        t.isEventSpanAllowed = isEventSpanAllowed;
        t.isExternalSpanAllowed = isExternalSpanAllowed;
        t.isSelectionSpanAllowed = isSelectionSpanAllowed;


        // Determines if the given event can be relocated to the given span (unzoned start/end with other misc data)
        function isEventSpanAllowed(span, event) {
            var source = event.source || {};
            var constraint = firstDefined(
                event.constraint,
                source.constraint,
                t.options.eventConstraint
            );
            var overlap = firstDefined(
                event.overlap,
                source.overlap,
                t.options.eventOverlap
            );
            return isSpanAllowed(span, constraint, overlap, event);
        }


        // Determines if an external event can be relocated to the given span (unzoned start/end with other misc data)
        function isExternalSpanAllowed(eventSpan, eventLocation, eventProps) {
            var eventInput;
            var event;

            // note: very similar logic is in View's reportExternalDrop
            if (eventProps) {
                eventInput = $.extend({}, eventProps, eventLocation);
                event = expandEvent(buildEventFromInput(eventInput))[0];
            }

            if (event) {
                return isEventSpanAllowed(eventSpan, event);
            }
            else { // treat it as a selection

                return isSelectionSpanAllowed(eventSpan);
            }
        }


        // Determines the given span (unzoned start/end with other misc data) can be selected.
        function isSelectionSpanAllowed(span) {
            return isSpanAllowed(span, t.options.selectConstraint, t.options.selectOverlap);
        }


        // Returns true if the given span (caused by an event drop/resize or a selection) is allowed to exist
        // according to the constraint/overlap settings.
        // `event` is not required if checking a selection.
        function isSpanAllowed(span, constraint, overlap, event) {
            var constraintEvents;
            var anyContainment;
            var peerEvents;
            var i, peerEvent;
            var peerOverlap;

            // the range must be fully contained by at least one of produced constraint events
            if (constraint != null) {

                // not treated as an event! intermediate data structure
                // TODO: use ranges in the future
                constraintEvents = constraintToEvents(constraint);

                anyContainment = false;
                for (i = 0; i < constraintEvents.length; i++) {
                    if (t.spanContainsSpan(constraintEvents[i], span)) {
                        anyContainment = true;
                        break;
                    }
                }

                if (!anyContainment) {
                    return false;
                }
            }

            peerEvents = t.getPeerEvents(span, event);

            for (i = 0; i < peerEvents.length; i++)  {
                peerEvent = peerEvents[i];

                // there needs to be an actual intersection before disallowing anything
                if (eventIntersectsRange(peerEvent, span)) {

                    // evaluate overlap for the given range and short-circuit if necessary
                    if (overlap === false) {
                        return false;
                    }
                    // if the event's overlap is a test function, pass the peer event in question as the first param
                    else if (typeof overlap === 'function' && !overlap(peerEvent, event)) {
                        return false;
                    }

                    // if we are computing if the given range is allowable for an event, consider the other event's
                    // EventObject-specific or Source-specific `overlap` property
                    if (event) {
                        peerOverlap = firstDefined(
                            peerEvent.overlap,
                            (peerEvent.source || {}).overlap
                            // we already considered the global `eventOverlap`
                        );
                        if (peerOverlap === false) {
                            return false;
                        }
                        // if the peer event's overlap is a test function, pass the subject event as the first param
                        if (typeof peerOverlap === 'function' && !peerOverlap(event, peerEvent)) {
                            return false;
                        }
                    }
                }
            }

            return true;
        }


        // Given an event input from the API, produces an array of event objects. Possible event inputs:
        // 'businessHours'
        // An event ID (number or string)
        // An object with specific start/end dates or a recurring event (like what businessHours accepts)
        function constraintToEvents(constraintInput) {

            if (constraintInput === 'businessHours') {
                return t.getCurrentBusinessHourEvents();
            }

            if (typeof constraintInput === 'object') {
                return expandEvent(buildEventFromInput(constraintInput));
            }

            return clientEvents(constraintInput); // probably an ID
        }


        // Does the event's date range intersect with the given range?
        // start/end already assumed to have stripped zones :(
        function eventIntersectsRange(event, range) {
            var eventStart = event.start.clone().stripZone();
            var eventEnd = t.getEventEnd(event).stripZone();

            return range.start < eventEnd && range.end > eventStart;
        }


        t.getEventCache = function() {
            return cache;
        };

    }


// hook for external libs to manipulate event properties upon creation.
// should manipulate the event in-place.
    Calendar.prototype.normalizeEvent = function(event) {
    };


// Does the given span (start, end, and other location information)
// fully contain the other?
    Calendar.prototype.spanContainsSpan = function(outerSpan, innerSpan) {
        var eventStart = outerSpan.start.clone().stripZone();
        var eventEnd = this.getEventEnd(outerSpan).stripZone();

        return innerSpan.start >= eventStart && innerSpan.end <= eventEnd;
    };


// Returns a list of events that the given event should be compared against when being considered for a move to
// the specified span. Attached to the Calendar's prototype because EventManager is a mixin for a Calendar.
    Calendar.prototype.getPeerEvents = function(span, event) {
        var cache = this.getEventCache();
        var peerEvents = [];
        var i, otherEvent;

        for (i = 0; i < cache.length; i++) {
            otherEvent = cache[i];
            if (
                !event ||
                event._id !== otherEvent._id // don't compare the event to itself or other related [repeating] events
            ) {
                peerEvents.push(otherEvent);
            }
        }

        return peerEvents;
    };


// updates the "backup" properties, which are preserved in order to compute diffs later on.
    function backupEventDates(event) {
        event._allDay = event.allDay;
        event._start = event.start.clone();
        event._end = event.end ? event.end.clone() : null;
    }


    /* Business Hours
     -----------------------------------------------------------------------------------------*/

    var BUSINESS_HOUR_EVENT_DEFAULTS = {
        id: '_fcBusinessHours', // will relate events from different calls to expandEvent
        start: '09:00',
        end: '17:00',
        dow: [ 1, 2, 3, 4, 5 ], // monday - friday
        rendering: 'inverse-background'
        // classNames are defined in businessHoursSegClasses
    };

// Return events objects for business hours within the current view.
// Abuse of our event system :(
    Calendar.prototype.getCurrentBusinessHourEvents = function(wholeDay) {
        return this.computeBusinessHourEvents(wholeDay, this.options.businessHours);
    };

// Given a raw input value from options, return events objects for business hours within the current view.
    Calendar.prototype.computeBusinessHourEvents = function(wholeDay, input) {
        if (input === true) {
            return this.expandBusinessHourEvents(wholeDay, [ {} ]);
        }
        else if ($.isPlainObject(input)) {
            return this.expandBusinessHourEvents(wholeDay, [ input ]);
        }
        else if ($.isArray(input)) {
            return this.expandBusinessHourEvents(wholeDay, input, true);
        }
        else {
            return [];
        }
    };

// inputs expected to be an array of objects.
// if ignoreNoDow is true, will ignore entries that don't specify a day-of-week (dow) key.
    Calendar.prototype.expandBusinessHourEvents = function(wholeDay, inputs, ignoreNoDow) {
        var view = this.getView();
        var events = [];
        var i, input;

        for (i = 0; i < inputs.length; i++) {
            input = inputs[i];

            if (ignoreNoDow && !input.dow) {
                continue;
            }

            // give defaults. will make a copy
            input = $.extend({}, BUSINESS_HOUR_EVENT_DEFAULTS, input);

            // if a whole-day series is requested, clear the start/end times
            if (wholeDay) {
                input.start = null;
                input.end = null;
            }

            events.push.apply(events, // append
                this.expandEvent(
                    this.buildEventFromInput(input),
                    view.start,
                    view.end
                )
            );
        }

        return events;
    };

    ;;

    /* An abstract class for the "basic" views, as well as month view. Renders one or more rows of day cells.
     ----------------------------------------------------------------------------------------------------------------------*/
// It is a manager for a DayGrid subcomponent, which does most of the heavy lifting.
// It is responsible for managing width/height.

    var BasicView = FC.BasicView = View.extend({

        scroller: null,

        dayGridClass: DayGrid, // class the dayGrid will be instantiated from (overridable by subclasses)
        dayGrid: null, // the main subcomponent that does most of the heavy lifting

        dayNumbersVisible: false, // display day numbers on each day cell?
        weekNumbersVisible: false, // display week numbers along the side?

        weekNumberWidth: null, // width of all the week-number cells running down the side

        headContainerEl: null, // div that hold's the dayGrid's rendered date header
        headRowEl: null, // the fake row element of the day-of-week header


        initialize: function() {
            this.dayGrid = this.instantiateDayGrid();

            this.scroller = new Scroller({
                overflowX: 'hidden',
                overflowY: 'auto'
            });
        },


        // Generates the DayGrid object this view needs. Draws from this.dayGridClass
        instantiateDayGrid: function() {
            // generate a subclass on the fly with BasicView-specific behavior
            // TODO: cache this subclass
            var subclass = this.dayGridClass.extend(basicDayGridMethods);

            return new subclass(this);
        },


        // Sets the display range and computes all necessary dates
        setRange: function(range) {
            View.prototype.setRange.call(this, range); // call the super-method

            this.dayGrid.breakOnWeeks = /year|month|week/.test(this.intervalUnit); // do before setRange
            this.dayGrid.setRange(range);
        },


        // Compute the value to feed into setRange. Overrides superclass.
        computeRange: function(date) {
            var range = View.prototype.computeRange.call(this, date); // get value from the super-method

            // year and month views should be aligned with weeks. this is already done for week
            if (/year|month/.test(range.intervalUnit)) {
                range.start.startOf('week');
                range.start = this.skipHiddenDays(range.start);

                // make end-of-week if not already
                if (range.end.weekday()) {
                    range.end.add(1, 'week').startOf('week');
                    range.end = this.skipHiddenDays(range.end, -1, true); // exclusively move backwards
                }
            }

            return range;
        },


        // Renders the view into `this.el`, which should already be assigned
        renderDates: function() {

            this.dayNumbersVisible = this.dayGrid.rowCnt > 1; // TODO: make grid responsible
            this.weekNumbersVisible = this.opt('weekNumbers');
            this.dayGrid.numbersVisible = this.dayNumbersVisible || this.weekNumbersVisible;

            this.el.addClass('fc-basic-view').html(this.renderSkeletonHtml());
            this.renderHead();

            this.scroller.render();
            var dayGridContainerEl = this.scroller.el.addClass('fc-day-grid-container');
            var dayGridEl = $('<div class="fc-day-grid" />').appendTo(dayGridContainerEl);
            this.el.find('.fc-body > tr > td').append(dayGridContainerEl);

            this.dayGrid.setElement(dayGridEl);
            this.dayGrid.renderDates(this.hasRigidRows());
        },


        // render the day-of-week headers
        renderHead: function() {
            this.headContainerEl =
                this.el.find('.fc-head-container')
                    .html(this.dayGrid.renderHeadHtml());
            this.headRowEl = this.headContainerEl.find('.fc-row');
        },


        // Unrenders the content of the view. Since we haven't separated skeleton rendering from date rendering,
        // always completely kill the dayGrid's rendering.
        unrenderDates: function() {
            this.dayGrid.unrenderDates();
            this.dayGrid.removeElement();
            this.scroller.destroy();
        },


        renderBusinessHours: function() {
            this.dayGrid.renderBusinessHours();
        },


        unrenderBusinessHours: function() {
            this.dayGrid.unrenderBusinessHours();
        },


        // Builds the HTML skeleton for the view.
        // The day-grid component will render inside of a container defined by this HTML.
        renderSkeletonHtml: function() {
            return '' +
                '<table>' +
                '<thead class="fc-head">' +
                '<tr>' +
                '<td class="fc-head-container ' + this.widgetHeaderClass + '"></td>' +
                '</tr>' +
                '</thead>' +
                '<tbody class="fc-body">' +
                '<tr>' +
                '<td class="' + this.widgetContentClass + '"></td>' +
                '</tr>' +
                '</tbody>' +
                '</table>';
        },


        // Generates an HTML attribute string for setting the width of the week number column, if it is known
        weekNumberStyleAttr: function() {
            if (this.weekNumberWidth !== null) {
                return 'style="width:' + this.weekNumberWidth + 'px"';
            }
            return '';
        },


        // Determines whether each row should have a constant height
        hasRigidRows: function() {
            var eventLimit = this.opt('eventLimit');
            return eventLimit && typeof eventLimit !== 'number';
        },


        /* Dimensions
         ------------------------------------------------------------------------------------------------------------------*/


        // Refreshes the horizontal dimensions of the view
        updateWidth: function() {
            if (this.weekNumbersVisible) {
                // Make sure all week number cells running down the side have the same width.
                // Record the width for cells created later.
                this.weekNumberWidth = matchCellWidths(
                    this.el.find('.fc-week-number')
                );
            }
        },


        // Adjusts the vertical dimensions of the view to the specified values
        setHeight: function(totalHeight, isAuto) {
            var eventLimit = this.opt('eventLimit');
            var scrollerHeight;
            var scrollbarWidths;

            // reset all heights to be natural
            this.scroller.clear();
            uncompensateScroll(this.headRowEl);

            this.dayGrid.removeSegPopover(); // kill the "more" popover if displayed

            // is the event limit a constant level number?
            if (eventLimit && typeof eventLimit === 'number') {
                this.dayGrid.limitRows(eventLimit); // limit the levels first so the height can redistribute after
            }

            // distribute the height to the rows
            // (totalHeight is a "recommended" value if isAuto)
            scrollerHeight = this.computeScrollerHeight(totalHeight);
            this.setGridHeight(scrollerHeight, isAuto);

            // is the event limit dynamically calculated?
            if (eventLimit && typeof eventLimit !== 'number') {
                this.dayGrid.limitRows(eventLimit); // limit the levels after the grid's row heights have been set
            }

            if (!isAuto) { // should we force dimensions of the scroll container?

                this.scroller.setHeight(scrollerHeight);
                scrollbarWidths = this.scroller.getScrollbarWidths();

                if (scrollbarWidths.left || scrollbarWidths.right) { // using scrollbars?

                    compensateScroll(this.headRowEl, scrollbarWidths);

                    // doing the scrollbar compensation might have created text overflow which created more height. redo
                    scrollerHeight = this.computeScrollerHeight(totalHeight);
                    this.scroller.setHeight(scrollerHeight);
                }

                // guarantees the same scrollbar widths
                this.scroller.lockOverflow(scrollbarWidths);
            }
        },


        // given a desired total height of the view, returns what the height of the scroller should be
        computeScrollerHeight: function(totalHeight) {
            return totalHeight -
                subtractInnerElHeight(this.el, this.scroller.el); // everything that's NOT the scroller
        },


        // Sets the height of just the DayGrid component in this view
        setGridHeight: function(height, isAuto) {
            if (isAuto) {
                undistributeHeight(this.dayGrid.rowEls); // let the rows be their natural height with no expanding
            }
            else {
                distributeHeight(this.dayGrid.rowEls, height, true); // true = compensate for height-hogging rows
            }
        },


        /* Scroll
         ------------------------------------------------------------------------------------------------------------------*/


        queryScroll: function() {
            return this.scroller.getScrollTop();
        },


        setScroll: function(top) {
            this.scroller.setScrollTop(top);
        },


        /* Hit Areas
         ------------------------------------------------------------------------------------------------------------------*/
        // forward all hit-related method calls to dayGrid


        prepareHits: function() {
            this.dayGrid.prepareHits();
        },


        releaseHits: function() {
            this.dayGrid.releaseHits();
        },


        queryHit: function(left, top) {
            return this.dayGrid.queryHit(left, top);
        },


        getHitSpan: function(hit) {
            return this.dayGrid.getHitSpan(hit);
        },


        getHitEl: function(hit) {
            return this.dayGrid.getHitEl(hit);
        },


        /* Events
         ------------------------------------------------------------------------------------------------------------------*/


        // Renders the given events onto the view and populates the segments array
        renderEvents: function(events) {
            this.dayGrid.renderEvents(events);

            this.updateHeight(); // must compensate for events that overflow the row
        },


        // Retrieves all segment objects that are rendered in the view
        getEventSegs: function() {
            return this.dayGrid.getEventSegs();
        },


        // Unrenders all event elements and clears internal segment data
        unrenderEvents: function() {
            this.dayGrid.unrenderEvents();

            // we DON'T need to call updateHeight() because:
            // A) a renderEvents() call always happens after this, which will eventually call updateHeight()
            // B) in IE8, this causes a flash whenever events are rerendered
        },


        /* Dragging (for both events and external elements)
         ------------------------------------------------------------------------------------------------------------------*/


        // A returned value of `true` signals that a mock "helper" event has been rendered.
        renderDrag: function(dropLocation, seg) {
            return this.dayGrid.renderDrag(dropLocation, seg);
        },


        unrenderDrag: function() {
            this.dayGrid.unrenderDrag();
        },


        /* Selection
         ------------------------------------------------------------------------------------------------------------------*/


        // Renders a visual indication of a selection
        renderSelection: function(span) {
            this.dayGrid.renderSelection(span);
        },


        // Unrenders a visual indications of a selection
        unrenderSelection: function() {
            this.dayGrid.unrenderSelection();
        }

    });


// Methods that will customize the rendering behavior of the BasicView's dayGrid
    var basicDayGridMethods = {


        // Generates the HTML that will go before the day-of week header cells
        renderHeadIntroHtml: function() {
            var view = this.view;

            if (view.weekNumbersVisible) {
                return '' +
                    '<th class="fc-week-number ' + view.widgetHeaderClass + '" ' + view.weekNumberStyleAttr() + '>' +
                    '<span>' + // needed for matchCellWidths
                    htmlEscape(view.opt('weekNumberTitle')) +
                    '</span>' +
                    '</th>';
            }

            return '';
        },


        // Generates the HTML that will go before content-skeleton cells that display the day/week numbers
        renderNumberIntroHtml: function(row) {
            var view = this.view;

            if (view.weekNumbersVisible) {
                return '' +
                    '<td class="fc-week-number" ' + view.weekNumberStyleAttr() + '>' +
                    '<span>' + // needed for matchCellWidths
                    this.getCellDate(row, 0).format('w') +
                    '</span>' +
                    '</td>';
            }

            return '';
        },


        // Generates the HTML that goes before the day bg cells for each day-row
        renderBgIntroHtml: function() {
            var view = this.view;

            if (view.weekNumbersVisible) {
                return '<td class="fc-week-number ' + view.widgetContentClass + '" ' +
                    view.weekNumberStyleAttr() + '></td>';
            }

            return '';
        },


        // Generates the HTML that goes before every other type of row generated by DayGrid.
        // Affects helper-skeleton and highlight-skeleton rows.
        renderIntroHtml: function() {
            var view = this.view;

            if (view.weekNumbersVisible) {
                return '<td class="fc-week-number" ' + view.weekNumberStyleAttr() + '></td>';
            }

            return '';
        }

    };

    ;;

    /* A month view with day cells running in rows (one-per-week) and columns
     ----------------------------------------------------------------------------------------------------------------------*/

    var MonthView = FC.MonthView = BasicView.extend({

        // Produces information about what range to display
        computeRange: function(date) {
            var range = BasicView.prototype.computeRange.call(this, date); // get value from super-method
            var rowCnt;

            // ensure 6 weeks
            if (this.isFixedWeeks()) {
                rowCnt = Math.ceil(range.end.diff(range.start, 'weeks', true)); // could be partial weeks due to hiddenDays
                range.end.add(6 - rowCnt, 'weeks');
            }

            return range;
        },


        // Overrides the default BasicView behavior to have special multi-week auto-height logic
        setGridHeight: function(height, isAuto) {

            isAuto = isAuto || this.opt('weekMode') === 'variable'; // LEGACY: weekMode is deprecated

            // if auto, make the height of each row the height that it would be if there were 6 weeks
            if (isAuto) {
                height *= this.rowCnt / 6;
            }

            distributeHeight(this.dayGrid.rowEls, height, !isAuto); // if auto, don't compensate for height-hogging rows
        },


        isFixedWeeks: function() {
            var weekMode = this.opt('weekMode'); // LEGACY: weekMode is deprecated
            if (weekMode) {
                return weekMode === 'fixed'; // if any other type of weekMode, assume NOT fixed
            }

            return this.opt('fixedWeekCount');
        }

    });

    ;;

    fcViews.basic = {
        'class': BasicView
    };

    fcViews.basicDay = {
        type: 'basic',
        duration: { days: 1 }
    };

    fcViews.basicWeek = {
        type: 'basic',
        duration: { weeks: 1 }
    };

    fcViews.month = {
        'class': MonthView,
        duration: { months: 1 }, // important for prev/next
        defaults: {
            fixedWeekCount: true
        }
    };
    ;;

    /* An abstract class for all agenda-related views. Displays one more columns with time slots running vertically.
     ----------------------------------------------------------------------------------------------------------------------*/
// Is a manager for the TimeGrid subcomponent and possibly the DayGrid subcomponent (if allDaySlot is on).
// Responsible for managing width/height.

    var AgendaView = FC.AgendaView = View.extend({

        scroller: null,

        timeGridClass: TimeGrid, // class used to instantiate the timeGrid. subclasses can override
        timeGrid: null, // the main time-grid subcomponent of this view

        dayGridClass: DayGrid, // class used to instantiate the dayGrid. subclasses can override
        dayGrid: null, // the "all-day" subcomponent. if all-day is turned off, this will be null

        axisWidth: null, // the width of the time axis running down the side

        headContainerEl: null, // div that hold's the timeGrid's rendered date header
        noScrollRowEls: null, // set of fake row elements that must compensate when scroller has scrollbars

        // when the time-grid isn't tall enough to occupy the given height, we render an <hr> underneath
        bottomRuleEl: null,


        initialize: function() {
            this.timeGrid = this.instantiateTimeGrid();

            if (this.opt('allDaySlot')) { // should we display the "all-day" area?
                this.dayGrid = this.instantiateDayGrid(); // the all-day subcomponent of this view
            }

            this.scroller = new Scroller({
                overflowX: 'hidden',
                overflowY: 'auto'
            });
        },


        // Instantiates the TimeGrid object this view needs. Draws from this.timeGridClass
        instantiateTimeGrid: function() {
            var subclass = this.timeGridClass.extend(agendaTimeGridMethods);

            return new subclass(this);
        },


        // Instantiates the DayGrid object this view might need. Draws from this.dayGridClass
        instantiateDayGrid: function() {
            var subclass = this.dayGridClass.extend(agendaDayGridMethods);

            return new subclass(this);
        },


        /* Rendering
         ------------------------------------------------------------------------------------------------------------------*/


        // Sets the display range and computes all necessary dates
        setRange: function(range) {
            View.prototype.setRange.call(this, range); // call the super-method

            this.timeGrid.setRange(range);
            if (this.dayGrid) {
                this.dayGrid.setRange(range);
            }
        },


        // Renders the view into `this.el`, which has already been assigned
        renderDates: function() {

            this.el.addClass('fc-agenda-view').html(this.renderSkeletonHtml());
            this.renderHead();

            this.scroller.render();
            var timeGridWrapEl = this.scroller.el.addClass('fc-time-grid-container');
            var timeGridEl = $('<div class="fc-time-grid" />').appendTo(timeGridWrapEl);
            this.el.find('.fc-body > tr > td').append(timeGridWrapEl);

            this.timeGrid.setElement(timeGridEl);
            this.timeGrid.renderDates();

            // the <hr> that sometimes displays under the time-grid
            this.bottomRuleEl = $('<hr class="fc-divider ' + this.widgetHeaderClass + '"/>')
                .appendTo(this.timeGrid.el); // inject it into the time-grid

            if (this.dayGrid) {
                this.dayGrid.setElement(this.el.find('.fc-day-grid'));
                this.dayGrid.renderDates();

                // have the day-grid extend it's coordinate area over the <hr> dividing the two grids
                this.dayGrid.bottomCoordPadding = this.dayGrid.el.next('hr').outerHeight();
            }

            this.noScrollRowEls = this.el.find('.fc-row:not(.fc-scroller *)'); // fake rows not within the scroller
        },


        // render the day-of-week headers
        renderHead: function() {
            this.headContainerEl =
                this.el.find('.fc-head-container')
                    .html(this.timeGrid.renderHeadHtml());
        },


        // Unrenders the content of the view. Since we haven't separated skeleton rendering from date rendering,
        // always completely kill each grid's rendering.
        unrenderDates: function() {
            this.timeGrid.unrenderDates();
            this.timeGrid.removeElement();

            if (this.dayGrid) {
                this.dayGrid.unrenderDates();
                this.dayGrid.removeElement();
            }

            this.scroller.destroy();
        },


        // Builds the HTML skeleton for the view.
        // The day-grid and time-grid components will render inside containers defined by this HTML.
        renderSkeletonHtml: function() {
            return '' +
                '<table>' +
                '<thead class="fc-head">' +
                '<tr>' +
                '<td class="fc-head-container ' + this.widgetHeaderClass + '"></td>' +
                '</tr>' +
                '</thead>' +
                '<tbody class="fc-body">' +
                '<tr>' +
                '<td class="' + this.widgetContentClass + '">' +
                (this.dayGrid ?
                        '<div class="fc-day-grid"/>' +
                        '<hr class="fc-divider ' + this.widgetHeaderClass + '"/>' :
                        ''
                ) +
                '</td>' +
                '</tr>' +
                '</tbody>' +
                '</table>';
        },


        // Generates an HTML attribute string for setting the width of the axis, if it is known
        axisStyleAttr: function() {
            if (this.axisWidth !== null) {
                return 'style="width:' + this.axisWidth + 'px"';
            }
            return '';
        },


        /* Business Hours
         ------------------------------------------------------------------------------------------------------------------*/


        renderBusinessHours: function() {
            this.timeGrid.renderBusinessHours();

            if (this.dayGrid) {
                this.dayGrid.renderBusinessHours();
            }
        },


        unrenderBusinessHours: function() {
            this.timeGrid.unrenderBusinessHours();

            if (this.dayGrid) {
                this.dayGrid.unrenderBusinessHours();
            }
        },


        /* Now Indicator
         ------------------------------------------------------------------------------------------------------------------*/


        getNowIndicatorUnit: function() {
            return this.timeGrid.getNowIndicatorUnit();
        },


        renderNowIndicator: function(date) {
            this.timeGrid.renderNowIndicator(date);
        },


        unrenderNowIndicator: function() {
            this.timeGrid.unrenderNowIndicator();
        },


        /* Dimensions
         ------------------------------------------------------------------------------------------------------------------*/


        updateSize: function(isResize) {
            this.timeGrid.updateSize(isResize);

            View.prototype.updateSize.call(this, isResize); // call the super-method
        },


        // Refreshes the horizontal dimensions of the view
        updateWidth: function() {
            // make all axis cells line up, and record the width so newly created axis cells will have it
            this.axisWidth = matchCellWidths(this.el.find('.fc-axis'));
        },


        // Adjusts the vertical dimensions of the view to the specified values
        setHeight: function(totalHeight, isAuto) {
            var eventLimit;
            var scrollerHeight;
            var scrollbarWidths;

            // reset all dimensions back to the original state
            this.bottomRuleEl.hide(); // .show() will be called later if this <hr> is necessary
            this.scroller.clear(); // sets height to 'auto' and clears overflow
            uncompensateScroll(this.noScrollRowEls);

            // limit number of events in the all-day area
            if (this.dayGrid) {
                this.dayGrid.removeSegPopover(); // kill the "more" popover if displayed

                eventLimit = this.opt('eventLimit');
                if (eventLimit && typeof eventLimit !== 'number') {
                    eventLimit = AGENDA_ALL_DAY_EVENT_LIMIT; // make sure "auto" goes to a real number
                }
                if (eventLimit) {
                    this.dayGrid.limitRows(eventLimit);
                }
            }

            if (!isAuto) { // should we force dimensions of the scroll container?

                scrollerHeight = this.computeScrollerHeight(totalHeight);
                this.scroller.setHeight(scrollerHeight);
                scrollbarWidths = this.scroller.getScrollbarWidths();

                if (scrollbarWidths.left || scrollbarWidths.right) { // using scrollbars?

                    // make the all-day and header rows lines up
                    compensateScroll(this.noScrollRowEls, scrollbarWidths);

                    // the scrollbar compensation might have changed text flow, which might affect height, so recalculate
                    // and reapply the desired height to the scroller.
                    scrollerHeight = this.computeScrollerHeight(totalHeight);
                    this.scroller.setHeight(scrollerHeight);
                }

                // guarantees the same scrollbar widths
                this.scroller.lockOverflow(scrollbarWidths);

                // if there's any space below the slats, show the horizontal rule.
                // this won't cause any new overflow, because lockOverflow already called.
                if (this.timeGrid.getTotalSlatHeight() < scrollerHeight) {
                    this.bottomRuleEl.show();
                }
            }
        },


        // given a desired total height of the view, returns what the height of the scroller should be
        computeScrollerHeight: function(totalHeight) {
            return totalHeight -
                subtractInnerElHeight(this.el, this.scroller.el); // everything that's NOT the scroller
        },


        /* Scroll
         ------------------------------------------------------------------------------------------------------------------*/


        // Computes the initial pre-configured scroll state prior to allowing the user to change it
        computeInitialScroll: function() {
            var scrollTime = moment.duration(this.opt('scrollTime'));
            var top = this.timeGrid.computeTimeTop(scrollTime);

            // zoom can give weird floating-point values. rather scroll a little bit further
            top = Math.ceil(top);

            if (top) {
                top++; // to overcome top border that slots beyond the first have. looks better
            }

            return top;
        },


        queryScroll: function() {
            return this.scroller.getScrollTop();
        },


        setScroll: function(top) {
            this.scroller.setScrollTop(top);
        },


        /* Hit Areas
         ------------------------------------------------------------------------------------------------------------------*/
        // forward all hit-related method calls to the grids (dayGrid might not be defined)


        prepareHits: function() {
            this.timeGrid.prepareHits();
            if (this.dayGrid) {
                this.dayGrid.prepareHits();
            }
        },


        releaseHits: function() {
            this.timeGrid.releaseHits();
            if (this.dayGrid) {
                this.dayGrid.releaseHits();
            }
        },


        queryHit: function(left, top) {
            var hit = this.timeGrid.queryHit(left, top);

            if (!hit && this.dayGrid) {
                hit = this.dayGrid.queryHit(left, top);
            }

            return hit;
        },


        getHitSpan: function(hit) {
            // TODO: hit.component is set as a hack to identify where the hit came from
            return hit.component.getHitSpan(hit);
        },


        getHitEl: function(hit) {
            // TODO: hit.component is set as a hack to identify where the hit came from
            return hit.component.getHitEl(hit);
        },


        /* Events
         ------------------------------------------------------------------------------------------------------------------*/


        // Renders events onto the view and populates the View's segment array
        renderEvents: function(events) {
            var dayEvents = [];
            var timedEvents = [];
            var daySegs = [];
            var timedSegs;
            var i;

            // separate the events into all-day and timed
            for (i = 0; i < events.length; i++) {
                if (events[i].allDay) {
                    dayEvents.push(events[i]);
                }
                else {
                    timedEvents.push(events[i]);
                }
            }

            // render the events in the subcomponents
            timedSegs = this.timeGrid.renderEvents(timedEvents);
            if (this.dayGrid) {
                daySegs = this.dayGrid.renderEvents(dayEvents);
            }

            // the all-day area is flexible and might have a lot of events, so shift the height
            this.updateHeight();
        },


        // Retrieves all segment objects that are rendered in the view
        getEventSegs: function() {
            return this.timeGrid.getEventSegs().concat(
                this.dayGrid ? this.dayGrid.getEventSegs() : []
            );
        },


        // Unrenders all event elements and clears internal segment data
        unrenderEvents: function() {

            // unrender the events in the subcomponents
            this.timeGrid.unrenderEvents();
            if (this.dayGrid) {
                this.dayGrid.unrenderEvents();
            }

            // we DON'T need to call updateHeight() because:
            // A) a renderEvents() call always happens after this, which will eventually call updateHeight()
            // B) in IE8, this causes a flash whenever events are rerendered
        },


        /* Dragging (for events and external elements)
         ------------------------------------------------------------------------------------------------------------------*/


        // A returned value of `true` signals that a mock "helper" event has been rendered.
        renderDrag: function(dropLocation, seg) {
            if (dropLocation.start.hasTime()) {
                return this.timeGrid.renderDrag(dropLocation, seg);
            }
            else if (this.dayGrid) {
                return this.dayGrid.renderDrag(dropLocation, seg);
            }
        },


        unrenderDrag: function() {
            this.timeGrid.unrenderDrag();
            if (this.dayGrid) {
                this.dayGrid.unrenderDrag();
            }
        },


        /* Selection
         ------------------------------------------------------------------------------------------------------------------*/


        // Renders a visual indication of a selection
        renderSelection: function(span) {
            if (span.start.hasTime() || span.end.hasTime()) {
                this.timeGrid.renderSelection(span);
            }
            else if (this.dayGrid) {
                this.dayGrid.renderSelection(span);
            }
        },


        // Unrenders a visual indications of a selection
        unrenderSelection: function() {
            this.timeGrid.unrenderSelection();
            if (this.dayGrid) {
                this.dayGrid.unrenderSelection();
            }
        }

    });


// Methods that will customize the rendering behavior of the AgendaView's timeGrid
// TODO: move into TimeGrid
    var agendaTimeGridMethods = {


        // Generates the HTML that will go before the day-of week header cells
        renderHeadIntroHtml: function() {
            var view = this.view;
            var weekText;

            if (view.opt('weekNumbers')) {
                weekText = this.start.format(view.opt('smallWeekFormat'));

                return '' +
                    '<th class="fc-axis fc-week-number ' + view.widgetHeaderClass + '" ' + view.axisStyleAttr() + '>' +
                    '<span>' + // needed for matchCellWidths
                    htmlEscape(weekText) +
                    '</span>' +
                    '</th>';
            }
            else {
                return '<th class="fc-axis ' + view.widgetHeaderClass + '" ' + view.axisStyleAttr() + '></th>';
            }
        },


        // Generates the HTML that goes before the bg of the TimeGrid slot area. Long vertical column.
        renderBgIntroHtml: function() {
            var view = this.view;

            return '<td class="fc-axis ' + view.widgetContentClass + '" ' + view.axisStyleAttr() + '></td>';
        },


        // Generates the HTML that goes before all other types of cells.
        // Affects content-skeleton, helper-skeleton, highlight-skeleton for both the time-grid and day-grid.
        renderIntroHtml: function() {
            var view = this.view;

            return '<td class="fc-axis" ' + view.axisStyleAttr() + '></td>';
        }

    };


// Methods that will customize the rendering behavior of the AgendaView's dayGrid
    var agendaDayGridMethods = {


        // Generates the HTML that goes before the all-day cells
        renderBgIntroHtml: function() {
            var view = this.view;

            return '' +
                '<td class="fc-axis ' + view.widgetContentClass + '" ' + view.axisStyleAttr() + '>' +
                '<span>' + // needed for matchCellWidths
                (view.opt('allDayHtml') || htmlEscape(view.opt('allDayText'))) +
                '</span>' +
                '</td>';
        },


        // Generates the HTML that goes before all other types of cells.
        // Affects content-skeleton, helper-skeleton, highlight-skeleton for both the time-grid and day-grid.
        renderIntroHtml: function() {
            var view = this.view;

            return '<td class="fc-axis" ' + view.axisStyleAttr() + '></td>';
        }

    };

    ;;

    var AGENDA_ALL_DAY_EVENT_LIMIT = 5;

// potential nice values for the slot-duration and interval-duration
// from largest to smallest
    var AGENDA_STOCK_SUB_DURATIONS = [
        { hours: 1 },
        { minutes: 30 },
        { minutes: 15 },
        { seconds: 30 },
        { seconds: 15 }
    ];

    fcViews.agenda = {
        'class': AgendaView,
        defaults: {
            allDaySlot: true,
            allDayText: 'all-day',
            slotDuration: '00:30:00',
            minTime: '00:00:00',
            maxTime: '24:00:00',
            slotEventOverlap: true // a bad name. confused with overlap/constraint system
        }
    };

    fcViews.agendaDay = {
        type: 'agenda',
        duration: { days: 1 }
    };

    fcViews.agendaWeek = {
        type: 'agenda',
        duration: { weeks: 1 }
    };
    ;;

    return FC; // export for Node/CommonJS
});
;
/*
 * jQuery UI Draggable 1.9.2
 * http://jqueryui.com
 *
 * Copyright 2012 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/draggable/
 *
 * Depends:
 * @depends path=/resources/scripts/jquery/ui/jquery.ui.core.js
 * @depends path=/resources/scripts/jquery/ui/jquery.ui.mouse.js
 * @depends path=/resources/scripts/jquery/ui/jquery.ui.widget.js
 */
(function(a,b){a.widget("ui.draggable",a.ui.mouse,{version:"1.9.2",widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false},_create:function(){if(this.options.helper=="original"&&!(/^(?:r|a|f)/).test(this.element.css("position"))){this.element[0].style.position="relative"}(this.options.addClasses&&this.element.addClass("ui-draggable"));(this.options.disabled&&this.element.addClass("ui-draggable-disabled"));this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy()},_mouseCapture:function(c){var d=this.options;if(this.helper||d.disabled||a(c.target).is(".ui-resizable-handle")){return false}this.handle=this._getHandle(c);if(!this.handle){return false}a(d.iframeFix===true?"iframe":d.iframeFix).each(function(){a('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1000}).css(a(this).offset()).appendTo("body")});return true},_mouseStart:function(c){var d=this.options;this.helper=this._createHelper(c);this.helper.addClass("ui-draggable-dragging");this._cacheHelperProportions();if(a.ui.ddmanager){a.ui.ddmanager.current=this}this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};a.extend(this.offset,{click:{left:c.pageX-this.offset.left,top:c.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(c);this.originalPageX=c.pageX;this.originalPageY=c.pageY;(d.cursorAt&&this._adjustOffsetFromHelper(d.cursorAt));if(d.containment){this._setContainment()}if(this._trigger("start",c)===false){this._clear();return false}this._cacheHelperProportions();if(a.ui.ddmanager&&!d.dropBehaviour){a.ui.ddmanager.prepareOffsets(this,c)}this._mouseDrag(c,true);if(a.ui.ddmanager){a.ui.ddmanager.dragStart(this,c)}return true},_mouseDrag:function(c,e){this.position=this._generatePosition(c);this.positionAbs=this._convertPositionTo("absolute");if(!e){var d=this._uiHash();if(this._trigger("drag",c,d)===false){this._mouseUp({});return false}this.position=d.position}if(!this.options.axis||this.options.axis!="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!="x"){this.helper[0].style.top=this.position.top+"px"}if(a.ui.ddmanager){a.ui.ddmanager.drag(this,c)}return false},_mouseStop:function(e){var g=false;if(a.ui.ddmanager&&!this.options.dropBehaviour){g=a.ui.ddmanager.drop(this,e)}if(this.dropped){g=this.dropped;this.dropped=false}var c=this.element[0],f=false;while(c&&(c=c.parentNode)){if(c==document){f=true}}if(!f&&this.options.helper==="original"){return false}if((this.options.revert=="invalid"&&!g)||(this.options.revert=="valid"&&g)||this.options.revert===true||(a.isFunction(this.options.revert)&&this.options.revert.call(this.element,g))){var d=this;a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){if(d._trigger("stop",e)!==false){d._clear()}})}else{if(this._trigger("stop",e)!==false){this._clear()}}return false},_mouseUp:function(c){a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)});if(a.ui.ddmanager){a.ui.ddmanager.dragStop(this,c)}return a.ui.mouse.prototype._mouseUp.call(this,c)},cancel:function(){if(this.helper.is(".ui-draggable-dragging")){this._mouseUp({})}else{this._clear()}return this},_getHandle:function(c){var d=!this.options.handle||!a(this.options.handle,this.element).length?true:false;a(this.options.handle,this.element).find("*").addBack().each(function(){if(this==c.target){d=true}});return d},_createHelper:function(d){var e=this.options;var c=a.isFunction(e.helper)?a(e.helper.apply(this.element[0],[d])):(e.helper=="clone"?this.element.clone().removeAttr("id"):this.element);if(!c.parents("body").length){c.appendTo((e.appendTo=="parent"?this.element[0].parentNode:e.appendTo))}if(c[0]!=this.element[0]&&!(/(fixed|absolute)/).test(c.css("position"))){c.css("position","absolute")}return c},_adjustOffsetFromHelper:function(c){if(typeof c=="string"){c=c.split(" ")}if(a.isArray(c)){c={left:+c[0],top:+c[1]||0}}if("left" in c){this.offset.click.left=c.left+this.margins.left}if("right" in c){this.offset.click.left=this.helperProportions.width-c.right+this.margins.left}if("top" in c){this.offset.click.top=c.top+this.margins.top}if("bottom" in c){this.offset.click.top=this.helperProportions.height-c.bottom+this.margins.top}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var c=this.offsetParent.offset();if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.contains(this.scrollParent[0],this.offsetParent[0])){c.left+=this.scrollParent.scrollLeft();c.top+=this.scrollParent.scrollTop()}if((this.offsetParent[0]==document.body)||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.ui.ie)){c={top:0,left:0}}return{top:c.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:c.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var c=this.element.position();return{top:c.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:c.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else{return{top:0,left:0}}},_cacheMargins:function(){this.margins={left:(parseInt(this.element.css("marginLeft"),10)||0),top:(parseInt(this.element.css("marginTop"),10)||0),right:(parseInt(this.element.css("marginRight"),10)||0),bottom:(parseInt(this.element.css("marginBottom"),10)||0)}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var g=this.options;if(g.containment=="parent"){g.containment=this.helper[0].parentNode}if(g.containment=="document"||g.containment=="window"){this.containment=[g.containment=="document"?0:a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,g.containment=="document"?0:a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,(g.containment=="document"?0:a(window).scrollLeft())+a(g.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(g.containment=="document"?0:a(window).scrollTop())+(a(g.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]}if(!(/^(document|window|parent)$/).test(g.containment)&&g.containment.constructor!=Array){var h=a(g.containment);var e=h[0];if(!e){return}var f=h.offset();var d=(a(e).css("overflow")!="hidden");this.containment=[(parseInt(a(e).css("borderLeftWidth"),10)||0)+(parseInt(a(e).css("paddingLeft"),10)||0),(parseInt(a(e).css("borderTopWidth"),10)||0)+(parseInt(a(e).css("paddingTop"),10)||0),(d?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(a(e).css("borderLeftWidth"),10)||0)-(parseInt(a(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(d?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(a(e).css("borderTopWidth"),10)||0)-(parseInt(a(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];this.relative_container=h}else{if(g.containment.constructor==Array){this.containment=g.containment}}},_convertPositionTo:function(g,i){if(!i){i=this.position}var e=g=="absolute"?1:-1;var f=this.options,c=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,h=(/(html|body)/i).test(c[0].tagName);return{top:(i.top+this.offset.relative.top*e+this.offset.parent.top*e-((this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(h?0:c.scrollTop()))*e)),left:(i.left+this.offset.relative.left*e+this.offset.parent.left*e-((this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():h?0:c.scrollLeft())*e))}},_generatePosition:function(d){var e=this.options,l=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,i=(/(html|body)/i).test(l[0].tagName);var h=d.pageX;var g=d.pageY;if(this.originalPosition){var c;if(this.containment){if(this.relative_container){var k=this.relative_container.offset();c=[this.containment[0]+k.left,this.containment[1]+k.top,this.containment[2]+k.left,this.containment[3]+k.top]}else{c=this.containment}if(d.pageX-this.offset.click.left<c[0]){h=c[0]+this.offset.click.left}if(d.pageY-this.offset.click.top<c[1]){g=c[1]+this.offset.click.top}if(d.pageX-this.offset.click.left>c[2]){h=c[2]+this.offset.click.left}if(d.pageY-this.offset.click.top>c[3]){g=c[3]+this.offset.click.top}}if(e.grid){var j=e.grid[1]?this.originalPageY+Math.round((g-this.originalPageY)/e.grid[1])*e.grid[1]:this.originalPageY;g=c?(!(j-this.offset.click.top<c[1]||j-this.offset.click.top>c[3])?j:(!(j-this.offset.click.top<c[1])?j-e.grid[1]:j+e.grid[1])):j;var f=e.grid[0]?this.originalPageX+Math.round((h-this.originalPageX)/e.grid[0])*e.grid[0]:this.originalPageX;h=c?(!(f-this.offset.click.left<c[0]||f-this.offset.click.left>c[2])?f:(!(f-this.offset.click.left<c[0])?f-e.grid[0]:f+e.grid[0])):f}}return{top:(g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+((this.cssPosition=="fixed"?-this.scrollParent.scrollTop():(i?0:l.scrollTop())))),left:(h-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+((this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():i?0:l.scrollLeft())))}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");if(this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval){this.helper.remove()}this.helper=null;this.cancelHelperRemoval=false},_trigger:function(c,d,e){e=e||this._uiHash();a.ui.plugin.call(this,c,[d,e]);if(c=="drag"){this.positionAbs=this._convertPositionTo("absolute")}return a.Widget.prototype._trigger.call(this,c,d,e)},plugins:{},_uiHash:function(c){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});a.ui.plugin.add("draggable","connectToSortable",{start:function(d,f){var e=a(this).data("draggable"),g=e.options,c=a.extend({},f,{item:e.element});e.sortables=[];a(g.connectToSortable).each(function(){var h=a.data(this,"sortable");if(h&&!h.options.disabled){e.sortables.push({instance:h,shouldRevert:h.options.revert});h.refreshPositions();h._trigger("activate",d,c)}})},stop:function(d,f){var e=a(this).data("draggable"),c=a.extend({},f,{item:e.element});a.each(e.sortables,function(){if(this.instance.isOver){this.instance.isOver=0;e.cancelHelperRemoval=true;this.instance.cancelHelperRemoval=false;if(this.shouldRevert){this.instance.options.revert=true}this.instance._mouseStop(d);this.instance.options.helper=this.instance.options._helper;if(e.options.helper=="original"){this.instance.currentItem.css({top:"auto",left:"auto"})}}else{this.instance.cancelHelperRemoval=false;this.instance._trigger("deactivate",d,c)}})},drag:function(d,g){var f=a(this).data("draggable"),c=this;var e=function(j){var p=this.offset.click.top,n=this.offset.click.left;var h=this.positionAbs.top,l=this.positionAbs.left;var k=j.height,m=j.width;var q=j.top,i=j.left;return a.ui.isOver(h+p,l+n,q,i,k,m)};a.each(f.sortables,function(j){var h=false;var k=this;this.instance.positionAbs=f.positionAbs;this.instance.helperProportions=f.helperProportions;this.instance.offset.click=f.offset.click;if(this.instance._intersectsWith(this.instance.containerCache)){h=true;a.each(f.sortables,function(){this.instance.positionAbs=f.positionAbs;this.instance.helperProportions=f.helperProportions;this.instance.offset.click=f.offset.click;if(this!=k&&this.instance._intersectsWith(this.instance.containerCache)&&a.ui.contains(k.instance.element[0],this.instance.element[0])){h=false}return h})}if(h){if(!this.instance.isOver){this.instance.isOver=1;this.instance.currentItem=a(c).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",true);this.instance.options._helper=this.instance.options.helper;this.instance.options.helper=function(){return g.helper[0]};d.target=this.instance.currentItem[0];this.instance._mouseCapture(d,true);this.instance._mouseStart(d,true,true);this.instance.offset.click.top=f.offset.click.top;this.instance.offset.click.left=f.offset.click.left;this.instance.offset.parent.left-=f.offset.parent.left-this.instance.offset.parent.left;this.instance.offset.parent.top-=f.offset.parent.top-this.instance.offset.parent.top;f._trigger("toSortable",d);f.dropped=this.instance.element;f.currentItem=f.element;this.instance.fromOutside=f}if(this.instance.currentItem){this.instance._mouseDrag(d)}}else{if(this.instance.isOver){this.instance.isOver=0;this.instance.cancelHelperRemoval=true;this.instance.options.revert=false;this.instance._trigger("out",d,this.instance._uiHash(this.instance));this.instance._mouseStop(d,true);this.instance.options.helper=this.instance.options._helper;this.instance.currentItem.remove();if(this.instance.placeholder){this.instance.placeholder.remove()}f._trigger("fromSortable",d);f.dropped=false}}})}});a.ui.plugin.add("draggable","cursor",{start:function(d,e){var c=a("body"),f=a(this).data("draggable").options;if(c.css("cursor")){f._cursor=c.css("cursor")}c.css("cursor",f.cursor)},stop:function(c,d){var e=a(this).data("draggable").options;if(e._cursor){a("body").css("cursor",e._cursor)}}});a.ui.plugin.add("draggable","opacity",{start:function(d,e){var c=a(e.helper),f=a(this).data("draggable").options;if(c.css("opacity")){f._opacity=c.css("opacity")}c.css("opacity",f.opacity)},stop:function(c,d){var e=a(this).data("draggable").options;if(e._opacity){a(d.helper).css("opacity",e._opacity)}}});a.ui.plugin.add("draggable","scroll",{start:function(d,e){var c=a(this).data("draggable");if(c.scrollParent[0]!=document&&c.scrollParent[0].tagName!="HTML"){c.overflowOffset=c.scrollParent.offset()}},drag:function(e,f){var d=a(this).data("draggable"),g=d.options,c=false;if(d.scrollParent[0]!=document&&d.scrollParent[0].tagName!="HTML"){if(!g.axis||g.axis!="x"){if((d.overflowOffset.top+d.scrollParent[0].offsetHeight)-e.pageY<g.scrollSensitivity){d.scrollParent[0].scrollTop=c=d.scrollParent[0].scrollTop+g.scrollSpeed}else{if(e.pageY-d.overflowOffset.top<g.scrollSensitivity){d.scrollParent[0].scrollTop=c=d.scrollParent[0].scrollTop-g.scrollSpeed}}}if(!g.axis||g.axis!="y"){if((d.overflowOffset.left+d.scrollParent[0].offsetWidth)-e.pageX<g.scrollSensitivity){d.scrollParent[0].scrollLeft=c=d.scrollParent[0].scrollLeft+g.scrollSpeed}else{if(e.pageX-d.overflowOffset.left<g.scrollSensitivity){d.scrollParent[0].scrollLeft=c=d.scrollParent[0].scrollLeft-g.scrollSpeed}}}}else{if(!g.axis||g.axis!="x"){if(e.pageY-a(document).scrollTop()<g.scrollSensitivity){c=a(document).scrollTop(a(document).scrollTop()-g.scrollSpeed)}else{if(a(window).height()-(e.pageY-a(document).scrollTop())<g.scrollSensitivity){c=a(document).scrollTop(a(document).scrollTop()+g.scrollSpeed)}}}if(!g.axis||g.axis!="y"){if(e.pageX-a(document).scrollLeft()<g.scrollSensitivity){c=a(document).scrollLeft(a(document).scrollLeft()-g.scrollSpeed)}else{if(a(window).width()-(e.pageX-a(document).scrollLeft())<g.scrollSensitivity){c=a(document).scrollLeft(a(document).scrollLeft()+g.scrollSpeed)}}}}if(c!==false&&a.ui.ddmanager&&!g.dropBehaviour){a.ui.ddmanager.prepareOffsets(d,e)}}});a.ui.plugin.add("draggable","snap",{start:function(d,e){var c=a(this).data("draggable"),f=c.options;c.snapElements=[];a(f.snap.constructor!=String?(f.snap.items||":data(draggable)"):f.snap).each(function(){var h=a(this);var g=h.offset();if(this!=c.element[0]){c.snapElements.push({item:this,width:h.outerWidth(),height:h.outerHeight(),top:g.top,left:g.left})}})},drag:function(u,p){var g=a(this).data("draggable"),q=g.options;var y=q.snapTolerance;var x=p.offset.left,w=x+g.helperProportions.width,f=p.offset.top,e=f+g.helperProportions.height;for(var v=g.snapElements.length-1;v>=0;v--){var s=g.snapElements[v].left,n=s+g.snapElements[v].width,m=g.snapElements[v].top,A=m+g.snapElements[v].height;if(!((s-y<x&&x<n+y&&m-y<f&&f<A+y)||(s-y<x&&x<n+y&&m-y<e&&e<A+y)||(s-y<w&&w<n+y&&m-y<f&&f<A+y)||(s-y<w&&w<n+y&&m-y<e&&e<A+y))){if(g.snapElements[v].snapping){(g.options.snap.release&&g.options.snap.release.call(g.element,u,a.extend(g._uiHash(),{snapItem:g.snapElements[v].item})))}g.snapElements[v].snapping=false;continue}if(q.snapMode!="inner"){var c=Math.abs(m-e)<=y;var z=Math.abs(A-f)<=y;var j=Math.abs(s-w)<=y;var k=Math.abs(n-x)<=y;if(c){p.position.top=g._convertPositionTo("relative",{top:m-g.helperProportions.height,left:0}).top-g.margins.top}if(z){p.position.top=g._convertPositionTo("relative",{top:A,left:0}).top-g.margins.top}if(j){p.position.left=g._convertPositionTo("relative",{top:0,left:s-g.helperProportions.width}).left-g.margins.left}if(k){p.position.left=g._convertPositionTo("relative",{top:0,left:n}).left-g.margins.left}}var h=(c||z||j||k);if(q.snapMode!="outer"){var c=Math.abs(m-f)<=y;var z=Math.abs(A-e)<=y;var j=Math.abs(s-x)<=y;var k=Math.abs(n-w)<=y;if(c){p.position.top=g._convertPositionTo("relative",{top:m,left:0}).top-g.margins.top}if(z){p.position.top=g._convertPositionTo("relative",{top:A-g.helperProportions.height,left:0}).top-g.margins.top}if(j){p.position.left=g._convertPositionTo("relative",{top:0,left:s}).left-g.margins.left}if(k){p.position.left=g._convertPositionTo("relative",{top:0,left:n-g.helperProportions.width}).left-g.margins.left}}if(!g.snapElements[v].snapping&&(c||z||j||k||h)){(g.options.snap.snap&&g.options.snap.snap.call(g.element,u,a.extend(g._uiHash(),{snapItem:g.snapElements[v].item})))}g.snapElements[v].snapping=(c||z||j||k||h)}}});a.ui.plugin.add("draggable","stack",{start:function(d,e){var g=a(this).data("draggable").options;var f=a.makeArray(a(g.stack)).sort(function(i,h){return(parseInt(a(i).css("zIndex"),10)||0)-(parseInt(a(h).css("zIndex"),10)||0)});if(!f.length){return}var c=parseInt(f[0].style.zIndex)||0;a(f).each(function(h){this.style.zIndex=c+h});this[0].style.zIndex=c+f.length}});a.ui.plugin.add("draggable","zIndex",{start:function(d,e){var c=a(e.helper),f=a(this).data("draggable").options;if(c.css("zIndex")){f._zIndex=c.css("zIndex")}c.css("zIndex",f.zIndex)},stop:function(c,d){var e=a(this).data("draggable").options;if(e._zIndex){a(d.helper).css("zIndex",e._zIndex)}}})})(jQuery);
;
/*
 * jQuery UI Resizable 1.9.2
 * http://jqueryui.com
 *
 * Copyright 2012 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/resizable/
 *
 * Depends:
 * @depends path=/resources/scripts/jquery/ui/jquery.ui.core.js
 * @depends path=/resources/scripts/jquery/ui/jquery.ui.mouse.js
 * @depends path=/resources/scripts/jquery/ui/jquery.ui.widget.js
 */
(function(c,d){c.widget("ui.resizable",c.ui.mouse,{version:"1.9.2",widgetEventPrefix:"resize",options:{alsoResize:false,animate:false,animateDuration:"slow",animateEasing:"swing",aspectRatio:false,autoHide:false,containment:false,ghost:false,grid:false,handles:"e,s,se",helper:false,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1000},_create:function(){var h=this,k=this.options;this.element.addClass("ui-resizable");c.extend(this,{_aspectRatio:!!(k.aspectRatio),aspectRatio:k.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:k.helper||k.ghost||k.animate?k.helper||"ui-resizable-helper":null});if(this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)){this.element.wrap(c('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")}));this.element=this.element.parent().data("resizable",this.element.data("resizable"));this.elementIsWrapper=true;this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")});this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0});this.originalResizeStyle=this.originalElement.css("resize");this.originalElement.css("resize","none");this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"}));this.originalElement.css({margin:this.originalElement.css("margin")});this._proportionallyResize()}this.handles=k.handles||(!c(".ui-resizable-handle",this.element).length?"e,s,se":{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"});if(this.handles.constructor==String){if(this.handles=="all"){this.handles="n,e,s,w,se,sw,ne,nw"}var l=this.handles.split(",");this.handles={};for(var f=0;f<l.length;f++){var j=c.trim(l[f]),e="ui-resizable-"+j;var g=c('<div class="ui-resizable-handle '+e+'"></div>');g.css({zIndex:k.zIndex});if("se"==j){g.addClass("ui-icon ui-icon-gripsmall-diagonal-se")}this.handles[j]=".ui-resizable-"+j;this.element.append(g)}}this._renderAxis=function(q){q=q||this.element;for(var n in this.handles){if(this.handles[n].constructor==String){this.handles[n]=c(this.handles[n],this.element).show()}if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var o=c(this.handles[n],this.element),p=0;p=/sw|ne|nw|se|n|s/.test(n)?o.outerHeight():o.outerWidth();var m=["padding",/ne|nw|n/.test(n)?"Top":/se|sw|s/.test(n)?"Bottom":/^e$/.test(n)?"Right":"Left"].join("");q.css(m,p);this._proportionallyResize()}if(!c(this.handles[n]).length){continue}}};this._renderAxis(this.element);this._handles=c(".ui-resizable-handle",this.element).disableSelection();this._handles.mouseover(function(){if(!h.resizing){if(this.className){var i=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)}h.axis=i&&i[1]?i[1]:"se"}});if(k.autoHide){this._handles.hide();c(this.element).addClass("ui-resizable-autohide").mouseenter(function(){if(k.disabled){return}c(this).removeClass("ui-resizable-autohide");h._handles.show()}).mouseleave(function(){if(k.disabled){return}if(!h.resizing){c(this).addClass("ui-resizable-autohide");h._handles.hide()}})}this._mouseInit()},_destroy:function(){this._mouseDestroy();var e=function(g){c(g).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){e(this.element);var f=this.element;this.originalElement.css({position:f.css("position"),width:f.outerWidth(),height:f.outerHeight(),top:f.css("top"),left:f.css("left")}).insertAfter(f);f.remove()}this.originalElement.css("resize",this.originalResizeStyle);e(this.originalElement);return this},_mouseCapture:function(f){var g=false;for(var e in this.handles){if(c(this.handles[e])[0]==f.target){g=true}}return !this.options.disabled&&g},_mouseStart:function(g){var j=this.options,f=this.element.position(),e=this.element;this.resizing=true;this.documentScroll={top:c(document).scrollTop(),left:c(document).scrollLeft()};if(e.is(".ui-draggable")||(/absolute/).test(e.css("position"))){e.css({position:"absolute",top:f.top,left:f.left})}this._renderProxy();var k=b(this.helper.css("left")),h=b(this.helper.css("top"));if(j.containment){k+=c(j.containment).scrollLeft()||0;h+=c(j.containment).scrollTop()||0}this.offset=this.helper.offset();this.position={left:k,top:h};this.size=this._helper?{width:e.outerWidth(),height:e.outerHeight()}:{width:e.width(),height:e.height()};this.originalSize=this._helper?{width:e.outerWidth(),height:e.outerHeight()}:{width:e.width(),height:e.height()};this.originalPosition={left:k,top:h};this.sizeDiff={width:e.outerWidth()-e.width(),height:e.outerHeight()-e.height()};this.originalMousePosition={left:g.pageX,top:g.pageY};this.aspectRatio=(typeof j.aspectRatio=="number")?j.aspectRatio:((this.originalSize.width/this.originalSize.height)||1);var i=c(".ui-resizable-"+this.axis).css("cursor");c("body").css("cursor",i=="auto"?this.axis+"-resize":i);e.addClass("ui-resizable-resizing");this._propagate("start",g);return true},_mouseDrag:function(e){var g=this.helper,f=this.options,l={},k=this,i=this.originalMousePosition,m=this.axis;var p=(e.pageX-i.left)||0,n=(e.pageY-i.top)||0;var h=this._change[m];if(!h){return false}var j=h.apply(this,[e,p,n]);this._updateVirtualBoundaries(e.shiftKey);if(this._aspectRatio||e.shiftKey){j=this._updateRatio(j,e)}j=this._respectSize(j,e);this._propagate("resize",e);g.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"});if(!this._helper&&this._proportionallyResizeElements.length){this._proportionallyResize()}this._updateCache(j);this._trigger("resize",e,this.ui());return false},_mouseStop:function(h){this.resizing=false;var i=this.options,l=this;if(this._helper){var g=this._proportionallyResizeElements,e=g.length&&(/textarea/i).test(g[0].nodeName),f=e&&c.ui.hasScroll(g[0],"left")?0:l.sizeDiff.height,k=e?0:l.sizeDiff.width;var n={width:(l.helper.width()-k),height:(l.helper.height()-f)},j=(parseInt(l.element.css("left"),10)+(l.position.left-l.originalPosition.left))||null,m=(parseInt(l.element.css("top"),10)+(l.position.top-l.originalPosition.top))||null;if(!i.animate){this.element.css(c.extend(n,{top:m,left:j}))}l.helper.height(l.size.height);l.helper.width(l.size.width);if(this._helper&&!i.animate){this._proportionallyResize()}}c("body").css("cursor","auto");this.element.removeClass("ui-resizable-resizing");this._propagate("stop",h);if(this._helper){this.helper.remove()}return false},_updateVirtualBoundaries:function(g){var j=this.options,i,h,f,k,e;e={minWidth:a(j.minWidth)?j.minWidth:0,maxWidth:a(j.maxWidth)?j.maxWidth:Infinity,minHeight:a(j.minHeight)?j.minHeight:0,maxHeight:a(j.maxHeight)?j.maxHeight:Infinity};if(this._aspectRatio||g){i=e.minHeight*this.aspectRatio;f=e.minWidth/this.aspectRatio;h=e.maxHeight*this.aspectRatio;k=e.maxWidth/this.aspectRatio;if(i>e.minWidth){e.minWidth=i}if(f>e.minHeight){e.minHeight=f}if(h<e.maxWidth){e.maxWidth=h}if(k<e.maxHeight){e.maxHeight=k}}this._vBoundaries=e},_updateCache:function(e){var f=this.options;this.offset=this.helper.offset();if(a(e.left)){this.position.left=e.left}if(a(e.top)){this.position.top=e.top}if(a(e.height)){this.size.height=e.height}if(a(e.width)){this.size.width=e.width}},_updateRatio:function(h,g){var i=this.options,j=this.position,f=this.size,e=this.axis;if(a(h.height)){h.width=(h.height*this.aspectRatio)}else{if(a(h.width)){h.height=(h.width/this.aspectRatio)}}if(e=="sw"){h.left=j.left+(f.width-h.width);h.top=null}if(e=="nw"){h.top=j.top+(f.height-h.height);h.left=j.left+(f.width-h.width)}return h},_respectSize:function(l,g){var j=this.helper,i=this._vBoundaries,r=this._aspectRatio||g.shiftKey,q=this.axis,t=a(l.width)&&i.maxWidth&&(i.maxWidth<l.width),m=a(l.height)&&i.maxHeight&&(i.maxHeight<l.height),h=a(l.width)&&i.minWidth&&(i.minWidth>l.width),s=a(l.height)&&i.minHeight&&(i.minHeight>l.height);if(h){l.width=i.minWidth}if(s){l.height=i.minHeight}if(t){l.width=i.maxWidth}if(m){l.height=i.maxHeight}var f=this.originalPosition.left+this.originalSize.width,p=this.position.top+this.size.height;var k=/sw|nw|w/.test(q),e=/nw|ne|n/.test(q);if(h&&k){l.left=f-i.minWidth}if(t&&k){l.left=f-i.maxWidth}if(s&&e){l.top=p-i.minHeight}if(m&&e){l.top=p-i.maxHeight}var n=!l.width&&!l.height;if(n&&!l.left&&l.top){l.top=null}else{if(n&&!l.top&&l.left){l.left=null}}return l},_proportionallyResize:function(){var k=this.options;if(!this._proportionallyResizeElements.length){return}var g=this.helper||this.element;for(var f=0;f<this._proportionallyResizeElements.length;f++){var h=this._proportionallyResizeElements[f];if(!this.borderDif){var e=[h.css("borderTopWidth"),h.css("borderRightWidth"),h.css("borderBottomWidth"),h.css("borderLeftWidth")],j=[h.css("paddingTop"),h.css("paddingRight"),h.css("paddingBottom"),h.css("paddingLeft")];this.borderDif=c.map(e,function(l,n){var m=parseInt(l,10)||0,o=parseInt(j[n],10)||0;return m+o})}h.css({height:(g.height()-this.borderDif[0]-this.borderDif[2])||0,width:(g.width()-this.borderDif[1]-this.borderDif[3])||0})}},_renderProxy:function(){var e=this.element,h=this.options;this.elementOffset=e.offset();if(this._helper){this.helper=this.helper||c('<div style="overflow:hidden;"></div>');var f=(c.ui.ie6?1:0),g=(c.ui.ie6?2:-1);this.helper.addClass(this._helper).css({width:this.element.outerWidth()+g,height:this.element.outerHeight()+g,position:"absolute",left:this.elementOffset.left-f+"px",top:this.elementOffset.top-f+"px",zIndex:++h.zIndex});this.helper.appendTo("body").disableSelection()}else{this.helper=this.element}},_change:{e:function(g,f,e){return{width:this.originalSize.width+f}},w:function(h,f,e){var j=this.options,g=this.originalSize,i=this.originalPosition;return{left:i.left+f,width:g.width-f}},n:function(h,f,e){var j=this.options,g=this.originalSize,i=this.originalPosition;return{top:i.top+e,height:g.height-e}},s:function(g,f,e){return{height:this.originalSize.height+e}},se:function(g,f,e){return c.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[g,f,e]))},sw:function(g,f,e){return c.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[g,f,e]))},ne:function(g,f,e){return c.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[g,f,e]))},nw:function(g,f,e){return c.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[g,f,e]))}},_propagate:function(f,e){c.ui.plugin.call(this,f,[e,this.ui()]);(f!="resize"&&this._trigger(f,e,this.ui()))},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});c.ui.plugin.add("resizable","alsoResize",{start:function(f,g){var e=c(this).data("resizable"),i=e.options;var h=function(j){c(j).each(function(){var k=c(this);k.data("resizable-alsoresize",{width:parseInt(k.width(),10),height:parseInt(k.height(),10),left:parseInt(k.css("left"),10),top:parseInt(k.css("top"),10)})})};if(typeof(i.alsoResize)=="object"&&!i.alsoResize.parentNode){if(i.alsoResize.length){i.alsoResize=i.alsoResize[0];h(i.alsoResize)}else{c.each(i.alsoResize,function(j){h(j)})}}else{h(i.alsoResize)}},resize:function(g,i){var f=c(this).data("resizable"),j=f.options,h=f.originalSize,l=f.originalPosition;var k={height:(f.size.height-h.height)||0,width:(f.size.width-h.width)||0,top:(f.position.top-l.top)||0,left:(f.position.left-l.left)||0},e=function(m,n){c(m).each(function(){var q=c(this),r=c(this).data("resizable-alsoresize"),p={},o=n&&n.length?n:q.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];c.each(o,function(s,u){var t=(r[u]||0)+(k[u]||0);if(t&&t>=0){p[u]=t||null}});q.css(p)})};if(typeof(j.alsoResize)=="object"&&!j.alsoResize.nodeType){c.each(j.alsoResize,function(m,n){e(m,n)})}else{e(j.alsoResize)}},stop:function(e,f){c(this).removeData("resizable-alsoresize")}});c.ui.plugin.add("resizable","animate",{stop:function(i,p){var m=c(this).data("resizable"),j=m.options;var h=m._proportionallyResizeElements,e=h.length&&(/textarea/i).test(h[0].nodeName),f=e&&c.ui.hasScroll(h[0],"left")?0:m.sizeDiff.height,l=e?0:m.sizeDiff.width;var g={width:(m.size.width-l),height:(m.size.height-f)},k=(parseInt(m.element.css("left"),10)+(m.position.left-m.originalPosition.left))||null,n=(parseInt(m.element.css("top"),10)+(m.position.top-m.originalPosition.top))||null;m.element.animate(c.extend(g,n&&k?{top:n,left:k}:{}),{duration:j.animateDuration,easing:j.animateEasing,step:function(){var o={width:parseInt(m.element.css("width"),10),height:parseInt(m.element.css("height"),10),top:parseInt(m.element.css("top"),10),left:parseInt(m.element.css("left"),10)};if(h&&h.length){c(h[0]).css({width:o.width,height:o.height})}m._updateCache(o);m._propagate("resize",i)}})}});c.ui.plugin.add("resizable","containment",{start:function(f,s){var q=c(this).data("resizable"),j=q.options,l=q.element;var g=j.containment,k=(g instanceof c)?g.get(0):(/parent/.test(g))?l.parent().get(0):g;if(!k){return}q.containerElement=c(k);if(/document/.test(g)||g==document){q.containerOffset={left:0,top:0};q.containerPosition={left:0,top:0};q.parentData={element:c(document),left:0,top:0,width:c(document).width(),height:c(document).height()||document.body.parentNode.scrollHeight}}else{var n=c(k),i=[];c(["Top","Right","Left","Bottom"]).each(function(p,o){i[p]=b(n.css("padding"+o))});q.containerOffset=n.offset();q.containerPosition=n.position();q.containerSize={height:(n.innerHeight()-i[3]),width:(n.innerWidth()-i[1])};var r=q.containerOffset,e=q.containerSize.height,m=q.containerSize.width,h=(c.ui.hasScroll(k,"left")?k.scrollWidth:m),t=(c.ui.hasScroll(k)?k.scrollHeight:e);q.parentData={element:k,left:r.left,top:r.top,width:h,height:t}}},resize:function(g,r){var m=c(this).data("resizable"),i=m.options,f=m.containerSize,q=m.containerOffset,n=m.size,p=m.position,s=m._aspectRatio||g.shiftKey,e={top:0,left:0},h=m.containerElement;if(h[0]!=document&&(/static/).test(h.css("position"))){e=q}if(p.left<(m._helper?q.left:0)){m.size.width=m.size.width+(m._helper?(m.position.left-q.left):(m.position.left-e.left));if(s){m.size.height=m.size.width/m.aspectRatio}m.position.left=i.helper?q.left:0}if(p.top<(m._helper?q.top:0)){m.size.height=m.size.height+(m._helper?(m.position.top-q.top):m.position.top);if(s){m.size.width=m.size.height*m.aspectRatio}m.position.top=m._helper?q.top:0}m.offset.left=m.parentData.left+m.position.left;m.offset.top=m.parentData.top+m.position.top;var l=Math.abs((m._helper?m.offset.left-e.left:(m.offset.left-e.left))+m.sizeDiff.width),t=Math.abs((m._helper?m.offset.top-e.top:(m.offset.top-q.top))+m.sizeDiff.height);var k=m.containerElement.get(0)==m.element.parent().get(0),j=/relative|absolute/.test(m.containerElement.css("position"));if(k&&j){l-=m.parentData.left}if(l+m.size.width>=m.parentData.width){m.size.width=m.parentData.width-l;if(s){m.size.height=m.size.width/m.aspectRatio}}if(t+m.size.height>=m.parentData.height){m.size.height=m.parentData.height-t;if(s){m.size.width=m.size.height*m.aspectRatio}}},stop:function(f,p){var l=c(this).data("resizable"),g=l.options,m=l.position,n=l.containerOffset,e=l.containerPosition,i=l.containerElement;var j=c(l.helper),r=j.offset(),q=j.outerWidth()-l.sizeDiff.width,k=j.outerHeight()-l.sizeDiff.height;if(l._helper&&!g.animate&&(/relative/).test(i.css("position"))){c(this).css({left:r.left-e.left-n.left,width:q,height:k})}if(l._helper&&!g.animate&&(/static/).test(i.css("position"))){c(this).css({left:r.left-e.left-n.left,width:q,height:k})}}});c.ui.plugin.add("resizable","ghost",{start:function(g,h){var f=c(this).data("resizable"),i=f.options,e=f.size;f.ghost=f.originalElement.clone();f.ghost.css({opacity:0.25,display:"block",position:"relative",height:e.height,width:e.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof i.ghost=="string"?i.ghost:"");f.ghost.appendTo(f.helper)},resize:function(f,g){var e=c(this).data("resizable"),h=e.options;if(e.ghost){e.ghost.css({position:"relative",height:e.size.height,width:e.size.width})}},stop:function(f,g){var e=c(this).data("resizable"),h=e.options;if(e.ghost&&e.helper){e.helper.get(0).removeChild(e.ghost.get(0))}}});c.ui.plugin.add("resizable","grid",{resize:function(e,n){var k=c(this).data("resizable"),h=k.options,l=k.size,i=k.originalSize,j=k.originalPosition,p=k.axis,m=h._aspectRatio||e.shiftKey;h.grid=typeof h.grid=="number"?[h.grid,h.grid]:h.grid;var g=Math.round((l.width-i.width)/(h.grid[0]||1))*(h.grid[0]||1),f=Math.round((l.height-i.height)/(h.grid[1]||1))*(h.grid[1]||1);if(/^(se|s|e)$/.test(p)){k.size.width=i.width+g;k.size.height=i.height+f}else{if(/^(ne)$/.test(p)){k.size.width=i.width+g;k.size.height=i.height+f;k.position.top=j.top-f}else{if(/^(sw)$/.test(p)){k.size.width=i.width+g;k.size.height=i.height+f;k.position.left=j.left-g}else{k.size.width=i.width+g;k.size.height=i.height+f;k.position.top=j.top-f;k.position.left=j.left-g}}}}});var b=function(e){return parseInt(e,10)||0};var a=function(e){return !isNaN(parseInt(e,10))}})(jQuery);
;
/*
 * Copyright (C) 1999-2015 Jive Software. All rights reserved.
 *
 * This software is the proprietary information of Jive Software. Use is subject to license terms.
 */

/*globals _jive_locale */
/**
 * @depends path=/plugins/event-type-plugin/resources/script/fullcalendar/fullcalendar.js
 * @depends path=/resources/scripts/jquery/ui/jquery.ui.draggable.js
 * @depends path=/resources/scripts/jquery/ui/jquery.ui.resizable.js
 * @depends template=jive.event.calendar.moveConfirmation
 * @depends template=jive.event.calendar.resizeConfirmation
 */
jive.namespace('EventCalendarApp');

jive.EventCalendarApp.CalendarView = jive.oo.Class.extend(function(protect) {
    jive.conc.observable(this);
    
    this.init = function(options) {
        var view = this;
        this.userID = options.userID;
        this.containerID = options.containerID;
        this.containerType = options.containerType;
        this.recursive = options.recursive;
        this.monthDayFormat = options.monthDayFormat.replace('d','D');
        this.canCreateEvents = options.canCreateEvents;
        this.display24hrClock = options.display24hrClock;
        this.i18n = options.i18n;
        this.monthYearTitleFormat = options.monthYearFormat.replace('yyyy','YYYY');
        
        if(this.userID) {
            this.url = jive.rest.url('/calendar/user/' + view.userID);
        } else {
            this.url = jive.rest.url('/calendar/' + view.containerType + '/' + view.containerID);
        } 
        
        this.showCalendar();
    };

    this.showCalendar = function() {
        var view = this;
        $j(document).ready(function(){
            $j('#event-calendar').fullCalendar({
                timeFormat: view.display24hrClock ? 'H:mm' : 'h(:mm)a',
                header: {
                    left: 'prev,next today',
                    center: 'title',
                    right: 'month,agendaWeek,agendaDay'
                },
                weekMode: 'liquid',
                allDayText: view.i18n.tags.all_day,
                nextDayThreshold: "00:00:00",
                editable: view.canCreateEvents,
                eventDrop: view.eventDropped.bind(view),
                eventResize: view.eventResized.bind(view),
                events: function(start, end, timezone, callback) {
                    $j.ajax({
                        url: view.url,
                        type: 'GET',
                        data: {
                            start: start.valueOf(),
                            end: end.valueOf(),
                            recursive: view.recursive
                        },
                        dataType: 'json',
                        success: function(events) {
                            $j.each(events, function(i, event) {
                                if (event.allDay) {
                                    // fullcalendar.js line 100048, workaround for ignoring nextdaythreshold for all day events
                                    event.end = new Date(new Date(event.end).getTime() + 60*60*24*1000);
                                }
                            });
                            callback(events);
                        },
                        error: function (e) {
                            console.log(e);
                        }
                    })
                },
                titleFormat : {
                    month : view.monthYearTitleFormat,
                    week: "MMM D, YYYY",
                    day: 'dddd, MMM D, YYYY'
                },
                columnFormat: {
                    week: 'ddd ' + view.monthDayFormat,
                    day: 'dddd ' + view.monthDayFormat
                },
                buttonText: {
                    prevText: view.i18n.buttons.prevText,
                    nextText: view.i18n.buttons.nextText,
                    today: view.i18n.buttons.today,
                    month: view.i18n.buttons.month,
                    week: view.i18n.buttons.week,
                    day: view.i18n.buttons.day
                },
                monthNames: [view.i18n.months.january,
                             view.i18n.months.february,
                             view.i18n.months.march,
                             view.i18n.months.april,
                             view.i18n.months.may,
                             view.i18n.months.june,
                             view.i18n.months.july,
                             view.i18n.months.august,
                             view.i18n.months.september,
                             view.i18n.months.october,
                             view.i18n.months.november,
                             view.i18n.months.december],
                monthNamesShort: [view.i18n.monthsShort.january,
                                  view.i18n.monthsShort.february,
                                  view.i18n.monthsShort.march,
                                  view.i18n.monthsShort.april,
                                  view.i18n.monthsShort.may,
                                  view.i18n.monthsShort.june,
                                  view.i18n.monthsShort.july,
                                  view.i18n.monthsShort.august,
                                  view.i18n.monthsShort.september,
                                  view.i18n.monthsShort.october,
                                  view.i18n.monthsShort.november,
                                  view.i18n.monthsShort.december],
                dayNames: [view.i18n.days.sunday,
                           view.i18n.days.monday,
                           view.i18n.days.tuesday,
                           view.i18n.days.wednesday,
                           view.i18n.days.thursday,
                           view.i18n.days.friday,
                           view.i18n.days.saturday],
                dayNamesShort: [view.i18n.daysShort.sunday,
                                view.i18n.daysShort.monday,
                                view.i18n.daysShort.tuesday,
                                view.i18n.daysShort.wednesday,
                                view.i18n.daysShort.thursday,
                                view.i18n.daysShort.friday,
                                view.i18n.daysShort.saturday]
                             
            });
        });
    };

    this.eventDropped = function( event, delta, revertFunc, jsEvent, ui, calendar_view ) {
        if(!event.allDay && calendar_view.name == 'month') {
            this.showMoveConfirmation(event, delta, revertFunc);
        } else {
			// e14 - COMDEV-2147 - Show the confirmation for the week view
			this.showMoveConfirmation(event, delta, revertFunc);
            //this.reschedule(event, delta, event.allDay, revertFunc);
        }
    };

    this.showMoveConfirmation = function(event, delta, revertFunc) {
        var view = this;
        $j(jive.event.calendar.moveConfirmation()).lightbox_me({
            destroyOnClose: true,
            closeClick: false,
            closeEsc: false,
            onLoad: function() {
                $j('#event-calendar-confirm-fullday').click( function() {
                    view.rescheduleAsAllDay(event, delta, revertFunc);
                });

                $j('#event-calendar-confirm-asis').click(function () {
                    view.rescheduleAsIs(event, delta, revertFunc);
                });

                $j('#event-calendar-confirm-cancel').click(function () {
                    revertFunc();
                });
            }
        });
    };

    this.eventResized = function( event, delta, revertFunc, jsEvent, ui, calendar_view ) {
        if(!event.allDay && calendar_view.name == 'month') {
            this.showResizeConfirmation(event, delta, revertFunc, calendar_view);
        } else {
			// e14 - COMDEV-2147 - Show the confirmation for the week view
			this.showResizeConfirmation(event, delta, revertFunc, calendar_view);
            //this.resize(event, delta, event.allDay, revertFunc);
        }
    };

    this.showResizeConfirmation = function(event, delta, revertFunc, calendar_view) {
        var view = this;
        $j(jive.event.calendar.resizeConfirmation()).lightbox_me({
            destroyOnClose: true,
            closeClick: false,
            closeEsc: false,
            onLoad: function() {
				// e14 - COMDEV-2147 - This is probably a resize via the week view.. so don't show the description text which is for the Month 
				if (!event.allDay && (calendar_view.name=='agendaWeek' || calendar_view.name=='agendaDay')) $j('#event-calendar-confirm p').hide();
				
                $j('#event-calendar-confirm-continue').click(function() {
                    if (!event.allDay && (calendar_view.name=='agendaWeek' || calendar_view.name=='agendaDay')) {
						view.resize(event, delta, event.allDay, revertFunc);
					} else {
						view.resize(event, delta, true, revertFunc);
					}
                });

                $j('#event-calendar-confirm-cancel').click(function() {
                    revertFunc();
                });
            }
        });
    };

    this.rescheduleAsAllDay = function(event, delta, revertFunc) {
        this.reschedule(event, delta, true, revertFunc);
    };

    this.rescheduleAsIs = function(event, delta, revertFunc) {
        this.reschedule(event, delta, false, revertFunc);
    }

    this.reschedule = function(event, delta, allDay, revertFunc) {
        this.saveEvent(event, delta, allDay, 'drop', revertFunc);
    }

    this.resize = function(event, delta, allDay, revertFunc) {
        this.saveEvent(event, delta, allDay, 'resize', revertFunc);
    }

    this.saveEvent = function saveEvent(event, delta, allDay, action, revertFunc) {
        var view = this;
        var data = new Object();
        data.dayDelta = delta.days();
        data.minuteDelta = delta.minutes();
        data.allDay = allDay;
        data.action = action;

        view.emitP('saveEvent', event.id, data)
            .addCallback(function() {
                event.allDay = allDay;
                $j('#event-calendar').fullCalendar('render');
            })
            .addErrback(function(message, code) {
                revertFunc();
            });
    };
});

;
/*
 * Copyright (C) 1999-2015 Jive Software. All rights reserved.
 *
 * This software is the proprietary information of Jive Software. Use is subject to license terms.
 */

/**
 * @depends path=/plugins/event-type-plugin/resources/script/apps/eventCalendar/models/calendar_source.js
 * @depends path=/plugins/event-type-plugin/resources/script/apps/eventCalendar/views/calendar_view.js
 */
jive.namespace('EventCalendarApp');

jive.EventCalendarApp.Main = jive.oo.Class.extend(function(protect) {
    this.init = function(options) {
        var main = this;
        
        this.calendarSource = new jive.EventCalendarApp.CalendarSource(options);
        this.calendarView = new jive.EventCalendarApp.CalendarView(options);
        this.options = options;
        
        this.calendarView.addListener('saveEvent', function(eventID, data, promise) {
            main.calendarSource.save(eventID, data)
            .addCallback(function(data) {
                promise.emitSuccess(data);
            })
            .addErrback(function(error, status) {
                promise.emitError(error, status);
            });
        });
    };
}); 

;
goog.provide("jive.event.invite.invalidInviteesList");goog.provide("jive.event.invite.inviteConfirmation");goog.provide("jive.event.invite.inviteUsers");goog.provide("jive.event.invite.usersWithoutPermission");goog.require("soy");goog.require("soydata");goog.require("soy.StringBuilder");
jive.event.invite.inviteUsers=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="jive-modal j-modal" id="jive-modal-invite"><header><h2>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("event.invite.title"),[])),'</h2></header><a href="#" class="j-modal-close-top close">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close"),[])),' <span class="j-close-icon j-ui-elem"></span></a><section class="jive-modal-content clearfix"><div id="invite-error" class="jive-error-box" style="display:none" ></div><form class="j-form">',
opt_data["private"]?'<p class="j-info"><span class="j-info-icon j-ui-elem"></span>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("invite.private.access"),[]))+"</p>":"",'<p class="ie-zindex-fix"><label for="invite-users">');var open__soy14=new soy.StringBuilder('<strong class="required">');open__soy14=open__soy14.toString();var close__soy16=new soy.StringBuilder("</strong>");close__soy16=close__soy16.toString();output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("event.invite.people.label.required"),
[new soydata.VERY_UNSAFE.ordainSanitizedHtml(open__soy14),new soydata.VERY_UNSAFE.ordainSanitizedHtml(close__soy16)])),'</label><input type="text" name="invite-users" id="invite-users" class="j-user-autocomplete j-autocomplete-input jive-chooser-input jive-form-element-text j-ui-elem" autocomplete="on"/></p><p><label for="jive-invite-not-message">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("event.invite.message.label.required"),[new soydata.VERY_UNSAFE.ordainSanitizedHtml(open__soy14),
new soydata.VERY_UNSAFE.ordainSanitizedHtml(close__soy16)])),'</label><textarea name="message" class="jive-form-element-textarea" id="jive-invite-not-message">',soy.$$escapeHtml(opt_data.message),'</textarea></p><p><input type="submit" name="invite-submit" class="j-btn-callout" value="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("event.invite.submit.button"),[])),'" /><button type="button" class="close">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.cancel"),[])),"</button></p></form></section></div>");
return opt_sb?"":output.toString()};jive.event.invite.inviteConfirmation=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("event.invite.confirm"),[])));return opt_sb?"":output.toString()};
jive.event.invite.usersWithoutPermission=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<p class="j-warn"><span class="jive-icon-sml jive-icon-warn"></span>',opt_data["private"]?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("event.invite.nopermission.private"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("event.invite.nopermission.noattachment"),[])),"</p>");return opt_sb?"":output.toString()};
jive.event.invite.invalidInviteesList=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<p> ",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("event.invite.invalid.invitees"),[]))," </p>");return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.actionqueue.item.eventInvitationActionRequest");goog.provide("jive.eae.actionqueue.item.eventInvitationReplyResult");goog.require("soy");goog.require("soydata");goog.require("soy.StringBuilder");goog.require("jive.eae.actionqueue.actionQueueItemAction");goog.require("jive.shared.displayutil.avatar");goog.require("jive.shared.displayutil.renderGuestDisplayName");goog.require("jive.shared.displayutil.renderIconElement");goog.require("jive.shared.displayutil.userDisplayNameLink");
goog.require("jive.shared.soy.i18nHelper");
jive.eae.actionqueue.item.eventInvitationActionRequest=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-aq-av clearfix"><div class="j-actionQ-item-data invite-request clearfix"><div class="j-av">');if(opt_data.data.inviter)jive.shared.displayutil.avatar(soy.$$augmentMap(opt_data.data.inviter,{size:"32"}),output);output.append('</div><h4 class="j-aq-header font-color-meta">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("eae.actionqueue.invite.label"),[])),
"</h4><p>");var inviter__soy12=new soy.StringBuilder;if(!opt_data.data.inviter.anonymous)jive.shared.displayutil.userDisplayNameLink(opt_data.data.inviter,inviter__soy12);else jive.shared.displayutil.renderGuestDisplayName({message:""},inviter__soy12);inviter__soy12=inviter__soy12.toString();var event__soy19=new soy.StringBuilder('<a href="',soy.$$filterNoAutoescape(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.data.objData.href)),'" class="title">');if(opt_data.data.objData.iconElement)jive.shared.displayutil.renderIconElement({icon:opt_data.data.objData.iconElement},
event__soy19);else event__soy19.append('<span class="',soy.$$escapeHtml(opt_data.data.objData.iconCSS),'"></span>');event__soy19.append(soy.$$escapeHtml(opt_data.data.objData.displayName),"</a>");event__soy19=event__soy19.toString();output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(opt_data.data.inviteKey),[new soydata.VERY_UNSAFE.ordainSanitizedHtml(inviter__soy12),new soydata.VERY_UNSAFE.ordainSanitizedHtml(event__soy19)])),'</p><div class="j-aq-actions clearfix">');var actionList36=
opt_data.data.actions;var actionListLen36=actionList36.length;for(var actionIndex36=0;actionIndex36<actionListLen36;actionIndex36++){var actionData36=actionList36[actionIndex36];jive.eae.actionqueue.actionQueueItemAction({action:actionData36},output)}output.append("</div></div></div>");return opt_sb?"":output.toString()};
jive.eae.actionqueue.item.eventInvitationReplyResult=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml(jive.i18n.getMinKey(opt_data.data.messageKey)),arg0:soy.$$escapeHtml(opt_data.data.eventTitle)},output);return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.actionqueue.actionQueueItemAction");
jive.eae.actionqueue.actionQueueItemAction=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.action.href?'<a href="'+soy.$$escapeHtml(opt_data.action.href)+'" class="j-btn-global j-action-button">'+soy.$$escapeHtml(opt_data.action.name)+"</a>":'<a href="#" name="'+soy.$$escapeHtml(opt_data.action.code)+'" class="j-btn-global j-action-button">'+soy.$$escapeHtml(opt_data.action.name)+"</a>");return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.notificationqueue.item.eventDeleteNotification");goog.provide("jive.eae.notificationqueue.item.eventUpdateNotification");goog.require("soy");goog.require("soydata");goog.require("soy.StringBuilder");goog.require("jive.eae.actionqueue.actionQueueItemAction");goog.require("jive.shared.displayutil.renderIconElement");
jive.eae.notificationqueue.item.eventUpdateNotification=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-aq-av clearfix"><div class="j-actionQ-item-data event-update clearfix"><h4 class="j-aq-header font-color-meta">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("eae.notification.event_update.label"),[])),'</h4><p><a href="',soy.$$filterNoAutoescape(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.data.objData.href)),'" class="title">');
if(opt_data.data.objData.iconElement)jive.shared.displayutil.renderIconElement({icon:opt_data.data.objData.iconElement},output);else output.append('<span class="',soy.$$escapeHtml(opt_data.data.objData.iconCSS),'"></span>');output.append(soy.$$filterNoAutoescape(opt_data.data.objData.displayName),"</a> ",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("eae.notification.event_update.text"),[])),'</p><div class="j-aq-actions clearfix">');var actionList22=opt_data.data.actions;var actionListLen22=
actionList22.length;for(var actionIndex22=0;actionIndex22<actionListLen22;actionIndex22++){var actionData22=actionList22[actionIndex22];jive.eae.actionqueue.actionQueueItemAction({action:actionData22},output)}output.append("</div></div></div>");return opt_sb?"":output.toString()};
jive.eae.notificationqueue.item.eventDeleteNotification=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-aq-av clearfix"><h4 class="j-aq-header font-color-meta"><span class="jive-icon-med jive-icon-gear"></span>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("eae.notification.event_delete.label"),[])),"</h4><p>");if(opt_data.data.objData.iconElement)jive.shared.displayutil.renderIconElement({icon:opt_data.data.objData.iconElement},output);else output.append('<span class="',
soy.$$escapeHtml(opt_data.data.objData.iconCSS),'"></span>');output.append(soy.$$escapeHtml(opt_data.data.objData.displayName)," ",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("eae.notification.event_delete.text"),[])),'</p><div class="j-aq-actions clearfix">');var actionList43=opt_data.data.actions;var actionListLen43=actionList43.length;for(var actionIndex43=0;actionIndex43<actionListLen43;actionIndex43++){var actionData43=actionList43[actionIndex43];jive.eae.actionqueue.actionQueueItemAction({action:actionData43},
output)}output.append("</div></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.nitro.admin.nitroAdminModal");goog.require("soy");goog.require("soydata");goog.require("soy.StringBuilder");
jive.nitro.admin.nitroAdminModal=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="jive-modal" id="jive-nitro-admin-modal"><header><h2 class="jive-modal-title">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("nitro.admin.title"),[])),'</h2></header><a class="j-modal-close-top jive-close close" href="#">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close"),[])),' <span class="j-close-icon j-ui-elem"></span></a><section class="jive-modal-content clearfix"><iframe src="',
soy.$$escapeHtml(opt_data.baseUrl),"/?userName=",soy.$$escapeHtml(opt_data.username),"&password=",soy.$$escapeHtml(opt_data.password),"&autoLogin=true&mode=",soy.$$escapeHtml(opt_data.mode),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("nitro.admin.title"),[])),"</iframe></section></div>");return opt_sb?"":output.toString()};
;
/*
 * Copyright (C) 1999-2015 Jive Software. All rights reserved.
 *
 * This software is the proprietary information of Jive Software. Use is subject to license terms.
 */
jive.namespace('nitro.admin');

/**
 * @depends path=/resources/scripts/jive/json-security.js
 */

jive.nitro.admin.NitroAdminSource = jive.RestService.extend(function(protect, _super) {
	protect.init = function(options) {
		this.options = options;
	};

	this.loadNitroAdminConfig = function() {
		var promise = new jive.conc.Promise();
		var error = this.errorFinding;
		var url = jive.rest.url("/nitro/admin/config");

		$j.ajax({
			url: url,
			type: "GET",
			contentType: "application/json; charset=utf-8",
			dataType: "json",
			success: function(data) {
				promise.emitSuccess(data);
			},
			error: this.errorCallback(promise, error)
		});

		return promise;
	};
});

;
/*
 * Copyright (C) 1999-2015 Jive Software. All rights reserved.
 *
 * This software is the proprietary information of Jive Software. Use is subject to license terms.
 */
jive.namespace('nitro.admin');

jive.nitro.admin.NitroAdminView = jive.oo.Class.extend(function(protect, _super) {
	jive.conc.observable(this);

	this.init = function(options) {
		var view = this;
		this.options = options;

		$j(document).ready(function() {
			view.attachLinkHandler();
		});
	};

	protect.attachLinkHandler = function() {
		var view = this;

		$j('body').on('click', '#jive-nav-link-nitro-admin' , function(e) {
			view.emitP('nitroAdminLinkClicked').addCallback(function(config) {
				$j('#j-satNav-menu').trigger('close');
				view.openModal(config);
				e.preventDefault();
			}).addErrback(function() {
				console.log('promise got an errback');
			});
		});
	};

	protect.openModal = function(config) {
		var view = this;

		if (!$j('#jive-nitro-admin-modal').is(':visible')) {
			var modal = $j(jive.nitro.admin.nitroAdminModal(config));
			$j('body').append(modal);

			view.populateModal(modal.filter(':first'), function() {
				// on close callback
			});
		}
	};

	protect.populateModal = function(modal, callback) {
		modal.lightbox_me({
			onClose: function() {
				callback();
				modal.remove();
			},
			scrollWithPage: false,
			centered: true,
			destroyOnClose: true,
			closeClick: false
		});
	};
});

;
/*
 * Copyright (C) 1999-2015 Jive Software. All rights reserved.
 *
 * This software is the proprietary information of Jive Software. Use is subject to license terms.
 */

/**
 * @depends path=/plugins/gamification/resources/script/apps/admin/models/admin_source.js plugin=gamification
 * @depends path=/plugins/gamification/resources/script/apps/admin/views/admin_view.js plugin=gamification
 */
jive.namespace('nitro.admin');

jive.nitro.admin.Main = jive.oo.Class.extend(function(protect, _super) {

	this.init = function(options) {
		var main = this;
		this.options = options;

		this.nitroAdminSource = new jive.nitro.admin.NitroAdminSource(options);
		this.nitroAdminView = new jive.nitro.admin.NitroAdminView(options);

		this.nitroAdminView.addListener('nitroAdminLinkClicked', function(promise) {
			main.nitroAdminSource.loadNitroAdminConfig().addCallback(function (config) {
				promise.emitSuccess(config);
			}).addErrback(function (error, status) {
				console.log('got an error in main.js');
				promise.emitError(error, status);
			});
		});
	};
});

;
/*
 * Copyright (C) 1999-2015 Jive Software. All rights reserved.
 *
 * This software is the proprietary information of Jive Software. Use is subject to license terms.
 */

/**
 * @depends path=/plugins/gamification/resources/script/apps/admin/main.js plugin=gamification
 */

$j(document).ready(function() {
	new jive.nitro.admin.Main({});
});

;
goog.provide("jive.outcomes.badge.badgeRaw");
jive.outcomes.badge.badgeRaw=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<",soy.$$escapeHtml(opt_data.tagName),' class="js-outcome-badge j-outcome-badge js-outcome-type-',soy.$$escapeHtml(opt_data.outcomeType)," j-outcome-type-",soy.$$escapeHtml(opt_data.outcomeType)," ",opt_data.extraClasses?" "+soy.$$escapeHtml(opt_data.extraClasses):"",'"',opt_data.outcomeId?'data-outcome="'+soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/api/core/v3/outcomes/"+
opt_data.outcomeId))+'"':"",opt_data.objectType&&opt_data.objectId?'data-ed=\'{"type":'+soy.$$escapeHtml(opt_data.objectType)+', "id": '+soy.$$escapeHtml(opt_data.objectId)+"}'":"",'data-outcome-type="',soy.$$escapeHtml(opt_data.outcomeType),'">',!opt_data.embedded?'<a href="#" aria-haspopup="true">':"",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.badge."+opt_data.outcomeType)),[])),!opt_data.embedded?"</a>":"","</",soy.$$escapeHtml(opt_data.tagName),">");return opt_sb?
"":output.toString()};
;
goog.provide("jive.outcomes.badge.badge");jive.outcomes.badge.badge=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.outcomes.badge.badgeRaw(soy.$$augmentMap(opt_data,{tagName:"li"}),output);return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.summary.avatar");goog.provide("jive.outcomes.summary.detailsLinks");goog.provide("jive.outcomes.summary.rollup");goog.provide("jive.outcomes.summary.rollupReply");goog.provide("jive.outcomes.summary.summaryContainer");goog.provide("jive.outcomes.summary.summaryCount");goog.provide("jive.outcomes.summary.textCountBadge");goog.provide("jive.outcomes.summary.typeIdFromTypeName");goog.require("soy");goog.require("soydata");goog.require("soy.StringBuilder");goog.require("jive.outcomes.badge.badgeByline");
goog.require("jive.outcomes.badge.badgeRaw");goog.require("jive.outcomes.helpful.msgHelpfulCount");goog.require("jive.shared.displayutil.avatar");goog.require("jive.shared.displayutil.userDisplayNameLink");
jive.outcomes.summary.summaryContainer=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<ul id="js-outcome-summary-container-',soy.$$escapeHtml(opt_data.objectType),"-",soy.$$escapeHtml(opt_data.objectId),'" class="js-outcome-summary-container j-outcome-summary-container js-ed-',soy.$$escapeHtml(opt_data.objectType),"-",soy.$$escapeHtml(opt_data.objectId),'" data-object-type="',soy.$$escapeHtml(opt_data.objectType),'" data-object-id="',soy.$$escapeHtml(opt_data.objectId),
'" aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.summaryContainer.ariaLabel"),[])),'" role="group"></ul>');return opt_sb?"":output.toString()};
jive.outcomes.summary.summaryCount=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<li class="js-outcome-summary-count j-outcome-summary-count js-outcome-type-',soy.$$escapeHtml(opt_data.outcomeType)," j-outcome-type-",soy.$$escapeHtml(opt_data.outcomeType),'" tabindex="0" role="button" aria-haspopup="true" data-outcome-type="',soy.$$escapeHtml(opt_data.outcomeType),'" data-count="',soy.$$escapeHtml(opt_data.count),'" aria-label="',soy.$$escapeHtml(opt_data.outcomeType),
'"><a class="js-outcome-count-block j-outcome-count-block" href="#"><span class="j-outcome-count">',soy.$$escapeHtml(opt_data.count),"</span>");jive.outcomes.badge.badgeRaw({outcomeType:opt_data.outcomeType,embedded:true,tagName:"span"},output);output.append("</a></li>");return opt_sb?"":output.toString()};
jive.outcomes.summary.rollup=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-outcome-rollup jive-modal-wide"><h3 class="j-outcome-rollup-title">');jive.outcomes.badge.badgeRaw({tagName:"span",outcomeType:opt_data.outcomeType,embedded:true},output);output.append('<span class="j-outcome-rollup-title-text"> ',soy.$$filterNoAutoescape(opt_data.tloTitle),'</span></h3><div class="j-outcome-rollup-replies">');var replyList47=opt_data.replies;var replyListLen47=
replyList47.length;for(var replyIndex47=0;replyIndex47<replyListLen47;replyIndex47++){var replyData47=replyList47[replyIndex47];jive.outcomes.summary.rollupReply({reply:replyData47,outcomeTypeName:opt_data.outcomeType},output)}output.append('</div><div class="j-outcome-done-block j-rc5 j-rc-none-top"><a href="#" class="js-outcome-done-button j-btn-global">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.summary.done"),[])),"</a></div></div>");return opt_sb?"":output.toString()};
jive.outcomes.summary.avatar=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.shared.displayutil.avatar(soy.$$augmentMap(opt_data.user,{enabled:opt_data.user.jive.enabled,partner:opt_data.user.jive.externalContributor,username:opt_data.user.jive.username,visible:opt_data.user.jive.visible,anonymous:false,prop:null,avatarID:0,size:32,hideTooltip:true}),output);return opt_sb?"":output.toString()};
jive.outcomes.summary.rollupReply=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-outcome-badge-popup">');jive.outcomes.summary.detailsLinks({outcome:opt_data.reply.outcomes[opt_data.outcomeTypeName],contextUrl:opt_data.reply.resources.html.ref},output);jive.outcomes.badge.badgeByline({outcomeTypeName:opt_data.outcomeTypeName,author:opt_data.reply.outcomes[opt_data.outcomeTypeName].user,modifiedDate:opt_data.reply.outcomes[opt_data.outcomeTypeName].updated},
output);output.append('<div class="j-outcome-details js-outcome-details" style="display:none;"></div></div><div class="j-outcome-rollup-reply"><div class="j-outcome-reply-avatar">');if(opt_data.reply.author)jive.outcomes.summary.avatar({user:opt_data.reply.author},output);else jive.shared.displayutil.avatar({anonymous:true,enabled:true,partner:false,username:"guest",id:0,ID:0,displayName:"",visible:true,prop:null,avatarID:0,size:32},output);output.append('</div><div class="j-outcome-reply-box"><p class="j-outcome-reply-byline jive-comment-meta font-color-meta">');
if(opt_data.reply.author)jive.shared.displayutil.userDisplayNameLink(soy.$$augmentMap(opt_data.reply.author,{anonymous:false}),output);else jive.shared.displayutil.userDisplayNameLink({anonymous:true,enabled:true,username:"guest",id:0,displayName:"",visible:true},output);output.append(' <a href="',soy.$$escapeHtml(opt_data.reply.resources.html.ref),'" class="j-outcome-reply-date font-color-normal js-outcome-reply-incontext">',soy.$$escapeHtml((opt_data.reply.updated?jive.model.DateUtil.parseISODateTime(opt_data.reply.updated):
"")?_jive_moment(parseFloat(opt_data.reply.updated?jive.model.DateUtil.parseISODateTime(opt_data.reply.updated):"")?parseFloat(opt_data.reply.updated?jive.model.DateUtil.parseISODateTime(opt_data.reply.updated):""):opt_data.reply.updated?jive.model.DateUtil.parseISODateTime(opt_data.reply.updated):"").add(_jive_timezoneoffset*60*60*1E3).lang(_jive_locale.toLowerCase().replace("_","-")).format("lll"):""),'<span class="j-in-context font-color-meta-light"> (',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.summary.rollup.inContext"),
[])),")</span></a>");if(opt_data.reply.helpfulCount){output.append('<span style="float:right;">');if(!opt_data.reply.unhelpfulCount)jive.outcomes.helpful.msgHelpfulCount({helpfulCount:opt_data.reply.helpfulCount,overallCount:opt_data.reply.helpfulCount,displayOverall:false},output);else jive.outcomes.helpful.msgHelpfulCount({helpfulCount:opt_data.reply.helpfulCount,overallCount:opt_data.reply.helpfulCount+opt_data.reply.unhelpfulCount,displayOverall:true},output);output.append("</span>")}output.append('</p><div class="j-outcome-reply-body js-outcome-reply-body">',
soy.$$filterNoAutoescape(opt_data.reply.content.text),'</div><div class="j-outcome-more js-outcome-more" style="display:none;"><a class="j-rc3 font-color-meta" href=\'#\'>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.more"),[])),"</a></div></div></div>");return opt_sb?"":output.toString()};
jive.outcomes.summary.detailsLinks=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.outcome.note||opt_data.outcome.properties&&opt_data.outcome.properties.approvers?'<div class="j-outcome-link-container"><a class="j-outcome-link-details js-outcome-link-details js-outcome-link" href="#" data-outcome-url="'+soy.$$escapeHtml(opt_data.outcome.resources.self.ref)+'">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.summary.details"),[]))+'</a><a class="j-outcome-link-incontext js-outcome-link-incontext js-outcome-link" href="'+
soy.$$escapeHtml(opt_data.contextUrl)+'" style="display:none;">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.summary.rollup.inContext"),[]))+"</a></div>":"");return opt_sb?"":output.toString()};
jive.outcomes.summary.typeIdFromTypeName=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;switch(opt_data.typeName){case "document":output.append("102");break;case "comment":output.append("105");break;case "discussion":output.append("1");break;case "message":output.append("2");break;case "post":output.append("38");break;case "update":output.append("1464927464");break;default:output.append("-1")}return opt_sb?"":output.toString()};
jive.outcomes.summary.textCountBadge=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.outcomeType!="finalized"&&opt_data.outcomeType!="outdated"&&opt_data.count>1?'<span class="j-outcome-count j-search-result-meta">'+soy.$$escapeHtml(opt_data.count)+"</span> ":"",'<span class="js-outcome-text-badge j-outcome-text-badge js-outcome-type-',soy.$$escapeHtml(opt_data.outcomeType)," j-outcome-type-",soy.$$escapeHtml(opt_data.outcomeType),'" data-outcome-type="',
soy.$$escapeHtml(opt_data.outcomeType),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.badge."+opt_data.outcomeType)),[])),opt_data.isLast!=true?'<span class="j-search-result-meta">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.comma"),[]))+"</span> ":"","</span>");return opt_sb?"":output.toString()};
;
goog.provide("jive.soy.share.alreadySharedToPlace");goog.provide("jive.soy.share.attachmentLinks");goog.provide("jive.soy.share.control");goog.provide("jive.soy.share.emailLinks");goog.provide("jive.soy.share.extendedShare");goog.provide("jive.soy.share.listWithoutPermission");goog.provide("jive.soy.share.notAbleToShare");goog.provide("jive.soy.share.removeContentPlaceLinkControl");goog.provide("jive.soy.share.removeContentPlaceLinkFailure");goog.provide("jive.soy.share.removeContentPlaceLinkSuccess");
goog.provide("jive.soy.share.secretGroupMessage");goog.provide("jive.soy.share.send_private_msg");goog.provide("jive.soy.share.share");goog.provide("jive.soy.share.shareConfirmation");goog.provide("jive.soy.share.shareToPlaceAccessInfo");goog.provide("jive.soy.share.userWithoutPermission");goog.provide("jive.soy.share.usersNotRelated");goog.require("soy");goog.require("soydata");goog.require("soy.StringBuilder");goog.require("e14.soy.share.share");
jive.soy.share.control=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<a href="#" class="',opt_data.type=="text"?"share-link j-meta-control lnk ":opt_data.type=="largeButton"?"j-social-action ":"",opt_data.classes?soy.$$escapeHtmlAttribute(opt_data.classes):"",'" title="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("share.link.title"),[])),'" data-command="share" data-object-type="',soy.$$escapeHtmlAttribute(opt_data.objectType),'" data-object-id="',
soy.$$escapeHtmlAttribute(opt_data.objectId),'"',opt_data.contentPlaceRelInfo?'data-relationship-id="'+soy.$$escapeHtmlAttribute(opt_data.contentPlaceRelInfo.relationshipID)+'"':"",">",opt_data.icon?"<span"+(opt_data.type=="smallButton"?' class="j-ui-elem"':"")+'><span class="jive-icon-glyph icon-share2"></span>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.link"),[]))+"</span>":soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.link"),[])),"</a>");return opt_sb?"":output.toString()};
jive.soy.share.share=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.e14_anonymous=="false")if(opt_data.e14_country=="CN"||opt_data.e14_country=="HK"||opt_data.e14_country=="TW")e14.soy.share.share(soy.$$augmentMap(opt_data,{width:460}),output);else if(opt_data.e14_country=="IN")e14.soy.share.share(soy.$$augmentMap(opt_data,{width:400}),output);else e14.soy.share.share(soy.$$augmentMap(opt_data,{width:520}),output);else e14.soy.share.share(soy.$$augmentMap(opt_data,
{width:380}),output);return opt_sb?"":output.toString()};jive.soy.share.shareConfirmation=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<p>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.confirm"),[])),"</p>");return opt_sb?"":output.toString()};
jive.soy.share.secretGroupMessage=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<p>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.secretgroup"),[])),"</p>");return opt_sb?"":output.toString()};jive.soy.share.send_private_msg=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("send.private.autoaccess"),[opt_data.objectName])));return opt_sb?"":output.toString()};
jive.soy.share.userWithoutPermission=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="js-share-msg j-tips ',!(opt_data.user.anonymous||opt_data.user.external)&&opt_data.externallyInviteable?" wide":"",'">');if(opt_data.user.anonymous||opt_data.user.external)if(!opt_data.invitationsEnabled)output.append(opt_data.attachmentAvailable?'<p class="j-warn">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.guest.nopermission.attachment"),[]))+"<p>":
'<p class="j-warn">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.guest.nopermission.noattachment"),[]))+"<p>");else if(opt_data["private"]&&opt_data.editor){output.append('<p class="j-warn">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.guest.nopermission.invite.private"),[])),"<p>");jive.soy.share.attachmentLinks(opt_data.user,output)}else if(opt_data.attachmentAvailable){output.append('<p class="j-warn">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.guest.nopermission.invite.attachment"),
[])),"<p>");jive.soy.share.attachmentLinks(opt_data.user,output)}else{output.append('<p class="j-warn">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.guest.nopermission.invite.noattachment"),[])),"<p>");jive.soy.share.emailLinks(opt_data.user,output)}else if(opt_data["private"]&&opt_data.editor)output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.user.nopermission.private"),[])));else if(opt_data.editor&&opt_data.externallyInviteable&&!opt_data.user.partner){output.append('<p class="j-warn">',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.user.nopermission.extended_share"),[])),"</p>");jive.soy.share.extendedShare(opt_data.user,output)}else if(opt_data.attachmentAvailable)output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.user.nopermission.attachment"),[])));else output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.user.nopermission.noattachment"),[])));output.append("</div>");return opt_sb?"":output.toString()};
jive.soy.share.attachmentLinks=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<p><a href="#" class="js-notify-user" data-user-identifier="',soy.$$escapeHtmlAttribute(opt_data.email),'" ',opt_data.notified?'style="display:none"':""," >",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.attachment.send.link"),[])),'</a><a href="#" class="js-unnotify-user" data-user-identifier="',soy.$$escapeHtmlAttribute(opt_data.email),'" ',!opt_data.notified?'style="display:none"':
""," >",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.attachment.remove.link"),[])),"</a><p>");return opt_sb?"":output.toString()};
jive.soy.share.emailLinks=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<p><a href="#" class="js-notify-user" data-user-identifier="',soy.$$escapeHtmlAttribute(opt_data.email),'" ',opt_data.notified?'style="display:none"':"",">",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.email.send.link"),[])),'</a><a href="#" class="js-unnotify-user" data-user-identifier="',soy.$$escapeHtmlAttribute(opt_data.email),'" ',!opt_data.notified?'style="display:none"':
"",">",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.email.remove.link"),[])),"</a><p>");return opt_sb?"":output.toString()};
jive.soy.share.extendedShare=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-extended-share js-extended-share"><label for="extend-share"><input id="extend-share" type="radio" name="extendShare" value="share" data-user-identifier="',soy.$$escapeHtmlAttribute(opt_data.email),'" ',opt_data.extendedShare||!opt_data.notified?"checked":"","/>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.user.nopermission.extended_share.share"),[])),'</label><label for="send-pdf"><input id="send-pdf" type="radio" name="extendShare" value="no-share" data-user-identifier="',
soy.$$escapeHtmlAttribute(opt_data.email),'" ',opt_data.notified?"checked":"","/>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.user.nopermission.extended_share.attach"),[])),'</label><input type="button" value="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("share.user.nopermission.extended_share.ok"),[])),'" class="close"></div>');return opt_sb?"":output.toString()};
jive.soy.share.listWithoutPermission=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="js-share-msg j-tips">',opt_data["private"]&&opt_data.editor?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.list.nopermission.private"),[])):opt_data.attachmentAvailable?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.list.nopermission.attachment"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.list.nopermission.noattachment"),
[])),"</div>");return opt_sb?"":output.toString()};jive.soy.share.usersNotRelated=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<p class="j-warn"><span class="jive-icon-sml jive-icon-redalert"></span>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.notrelated"),[])),"</p>");return opt_sb?"":output.toString()};
jive.soy.share.notAbleToShare=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="js-share-msg j-tips"><p class="j-warn">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.user.no_access"),[])),"<p></div>");return opt_sb?"":output.toString()};
jive.soy.share.shareToPlaceAccessInfo=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="js-share-msg j-tips"><p class="j-info">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.place.access.warning"),[])),"<p></div>");return opt_sb?"":output.toString()};
jive.soy.share.alreadySharedToPlace=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="js-share-msg j-tips"><p class="j-warn">',opt_data.place&&opt_data.place.objectTypeName?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.place.type.already.exists"),[opt_data.place.objectTypeName])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.place.already.exists"),[])),"<p></div>");return opt_sb?"":output.toString()};
jive.soy.share.removeContentPlaceLinkControl=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<a href="#" class="js-delete-content-place-rel button lnk" data-command="deleteContentPlaceRel" data-relationship-id="',soy.$$escapeHtmlAttribute(opt_data.contentPlaceRelationship.relationshipID),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.place.remove_link"),[])),"</a>");return opt_sb?"":output.toString()};
jive.soy.share.removeContentPlaceLinkSuccess=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<span>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.place.remove_link.success"),[])),"</span>");return opt_sb?"":output.toString()};
jive.soy.share.removeContentPlaceLinkFailure=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<span>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.place.remove_link.failure"),[])),"</span>");return opt_sb?"":output.toString()};
;
goog.provide("jive.soy.share.share");
jive.soy.share.share=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="jive-modal j-modal j-pop" id="jive-modal-share" aria-modal="true" role="dialog" tabindex="-1" aria-labelledby="jive-modal-share-header"><header id="jive-modal-share-header"><h2>');var shareKey__soy4=new soy.StringBuilder("share.",soy.$$escapeHtml(opt_data.objectType));shareKey__soy4=shareKey__soy4.toString();output.append(shareKey__soy4==jive.i18n.i18nText(jive.i18n.getMsg(shareKey__soy4),[])?
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.unknown"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(shareKey__soy4),[])),'</h2></header><a href="#" role="button" class="j-modal-close-top close" aria-label="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("global.close.modal"),[])),'" title="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("global.close.modal"),[])),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close"),[])),
'  <span class="jive-icon-glyph icon-close-med" role="img"></span></a><section class="jive-modal-content j-pop-main j-invite-modal clearfix"><div id="share-error" class="jive-error-box" style="display:none" aria-live="polite" aria-atomic="true" ></div><form class="j-form">',opt_data["private"]?'<p class="j-info"><span class="j-info-icon j-ui-elem"></span>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.private.access"),[]))+"</p>":"",'<label for="share-users">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.people.label"),
[]))," (",opt_data.placeSharesEnabled?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("send.invite.nonusers.withplaceshares.label"),[])):opt_data.externalCommunity?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("send.invite.nonusers.external.label"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("send.invite.nonusers.noimport.label"),[])),')</label><div class="j-user-input-typeahead"><input type="text" name="share-users" role="textbox" id="share-users" class="j-autocomplete-input j-user-autocomplete j-autocomplete-jive-chooser-input jive-form-element-text j-ui-elem" autocomplete="on" role="combobox"/></div><div class="ie-zindex-fix j-form-exp font-color-meta-light"><strong>',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("send.invite.examples"),[]))," </strong>");jive.UserPicker.soy.inputPlaceholder({userAllowed:true,emailAllowed:opt_data.externallyShareable,placeAllowed:opt_data.placeSharesEnabled,domains:opt_data.domains,multiple:true},output);output.append("<p>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("send.invite.nonusers.noimport.explanation"),[])),'</p></div><p><label for="jive-send-content-not-message">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.message.label"),
[]))," <span>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.message.include.optional"),[])),'</span></label><textarea name="message" class="jive-form-element-textarea font-color-normal" id="jive-send-content-not-message">',soy.$$filterNoAutoescape(opt_data.message),'</textarea></p><div class="j-pop-row j-last"><button type="submit" id="share-content-submit" name="share-content-submit" class="j-btn-callout">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.submit.button"),
[])),'</button><button type="button" class="close">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.cancel"),[])),"</button></div></form></section></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.soy.share.shareConfirmation");jive.soy.share.shareConfirmation=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<p>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.confirm"),[])),"</p>");return opt_sb?"":output.toString()};
;
goog.provide("jive.soy.share.secretGroupMessage");jive.soy.share.secretGroupMessage=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<p>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.secretgroup"),[])),"</p>");return opt_sb?"":output.toString()};
;
goog.provide("jive.soy.share.usersNotRelated");jive.soy.share.usersNotRelated=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<p class="j-warn"><span class="jive-icon-sml jive-icon-redalert"></span>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.notrelated"),[])),"</p>");return opt_sb?"":output.toString()};
;
goog.provide("jive.soy.share.attachmentLinks");
jive.soy.share.attachmentLinks=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<p><a href="#" class="js-notify-user" data-user-identifier="',soy.$$escapeHtmlAttribute(opt_data.email),'" ',opt_data.notified?'style="display:none"':""," >",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.attachment.send.link"),[])),'</a><a href="#" class="js-unnotify-user" data-user-identifier="',soy.$$escapeHtmlAttribute(opt_data.email),'" ',!opt_data.notified?'style="display:none"':
""," >",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.attachment.remove.link"),[])),"</a><p>");return opt_sb?"":output.toString()};
;
goog.provide("jive.soy.share.emailLinks");
jive.soy.share.emailLinks=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<p><a href="#" class="js-notify-user" data-user-identifier="',soy.$$escapeHtmlAttribute(opt_data.email),'" ',opt_data.notified?'style="display:none"':"",">",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.email.send.link"),[])),'</a><a href="#" class="js-unnotify-user" data-user-identifier="',soy.$$escapeHtmlAttribute(opt_data.email),'" ',!opt_data.notified?'style="display:none"':
"",">",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.email.remove.link"),[])),"</a><p>");return opt_sb?"":output.toString()};
;
goog.provide("jive.soy.share.extendedShare");
jive.soy.share.extendedShare=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-extended-share js-extended-share"><label for="extend-share"><input id="extend-share" type="radio" name="extendShare" value="share" data-user-identifier="',soy.$$escapeHtmlAttribute(opt_data.email),'" ',opt_data.extendedShare||!opt_data.notified?"checked":"","/>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.user.nopermission.extended_share.share"),[])),'</label><label for="send-pdf"><input id="send-pdf" type="radio" name="extendShare" value="no-share" data-user-identifier="',
soy.$$escapeHtmlAttribute(opt_data.email),'" ',opt_data.notified?"checked":"","/>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.user.nopermission.extended_share.attach"),[])),'</label><input type="button" value="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("share.user.nopermission.extended_share.ok"),[])),'" class="close"></div>');return opt_sb?"":output.toString()};
;
goog.provide("jive.soy.share.userWithoutPermission");
jive.soy.share.userWithoutPermission=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="js-share-msg j-tips ',!(opt_data.user.anonymous||opt_data.user.external)&&opt_data.externallyInviteable?" wide":"",'">');if(opt_data.user.anonymous||opt_data.user.external)if(!opt_data.invitationsEnabled)output.append(opt_data.attachmentAvailable?'<p class="j-warn">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.guest.nopermission.attachment"),[]))+"<p>":
'<p class="j-warn">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.guest.nopermission.noattachment"),[]))+"<p>");else if(opt_data["private"]&&opt_data.editor){output.append('<p class="j-warn">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.guest.nopermission.invite.private"),[])),"<p>");jive.soy.share.attachmentLinks(opt_data.user,output)}else if(opt_data.attachmentAvailable){output.append('<p class="j-warn">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.guest.nopermission.invite.attachment"),
[])),"<p>");jive.soy.share.attachmentLinks(opt_data.user,output)}else{output.append('<p class="j-warn">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.guest.nopermission.invite.noattachment"),[])),"<p>");jive.soy.share.emailLinks(opt_data.user,output)}else if(opt_data["private"]&&opt_data.editor)output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.user.nopermission.private"),[])));else if(opt_data.editor&&opt_data.externallyInviteable&&!opt_data.user.partner){output.append('<p class="j-warn">',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.user.nopermission.extended_share"),[])),"</p>");jive.soy.share.extendedShare(opt_data.user,output)}else if(opt_data.attachmentAvailable)output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.user.nopermission.attachment"),[])));else output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.user.nopermission.noattachment"),[])));output.append("</div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.soy.share.listWithoutPermission");
jive.soy.share.listWithoutPermission=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="js-share-msg j-tips">',opt_data["private"]&&opt_data.editor?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.list.nopermission.private"),[])):opt_data.attachmentAvailable?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.list.nopermission.attachment"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.list.nopermission.noattachment"),[])),
"</div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.soy.share.alreadySharedToPlace");
jive.soy.share.alreadySharedToPlace=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="js-share-msg j-tips"><p class="j-warn">',opt_data.place&&opt_data.place.objectTypeName?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.place.type.already.exists"),[opt_data.place.objectTypeName])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.place.already.exists"),[])),"<p></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.soy.share.shareToPlaceAccessInfo");jive.soy.share.shareToPlaceAccessInfo=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="js-share-msg j-tips"><p class="j-info">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.place.access.warning"),[])),"<p></div>");return opt_sb?"":output.toString()};
;
jive.namespace("ShareApp");
define("apps/share/views/share_view","apps/userpicker/main apps/shared/controllers/localexchange soy!jive.error.rest.soy.errorFinding soy!jive.error.rest.soy.errorUpdating soy!jive.soy.share.share soy!jive.soy.share.shareConfirmation soy!jive.soy.share.secretGroupMessage soy!jive.soy.share.usersNotRelated soy!jive.soy.share.userWithoutPermission soy!jive.soy.share.listWithoutPermission soy!jive.soy.share.alreadySharedToPlace soy!jive.soy.share.shareToPlaceAccessInfo jive/dispatcher jquery/jquery.lightbox_me".split(" "),function($UserPicker$$,
$localexchange$$,$errorFinding$$,$errorUpdating$$,$shareMain$$,$shareConfirmation$$,$secretGroupMessage$$,$usersNotRelated$$,$userWithoutPermission$$,$listWithoutPermission$$,$alreadySharedToPlace$$,$shareToPlaceAccessInfo$$,$dispatcher$$){jive.ShareApp.ShareView=jive.oo.Class.extend(function($protect$$){jive.conc.observable(this);this.init=function $this$init$(){this.recipients=[];this.placeRecipients=[];this.options={}};$protect$$.submitShare=function $$protect$$$submitShare$($objectID$$,$objectType$$,
$$modalDiv$$,$objectName$$){var $view$$=this,$data$$={message:$j("#jive-send-content-not-message").val(),recipients:$view$$.buildRecipientArray(),subject:$j("#jive-send-content-not-subject").val(),placeRecipients:$view$$.buildPlaceRecipientsArray()};$data$$.message=$data$$.message.replace(/</g,"\x26lt;").replace(/>/g,"\x26gt;");$view$$.emitP("share",$objectType$$,$objectID$$,$data$$).addCallback(function(){$j($shareConfirmation$$({objectName:$objectName$$})).message({style:"success"});$$modalDiv$$.trigger("close");
$view$$.recipients.some(function($recipient$$){return $recipient$$.id!==window._jive_current_user.ID})&&($dispatcher$$.dispatch("trial.share.created"),$dispatcher$$.dispatch("trial.updatePercentComplete"));0<$view$$.placeRecipients.length&&$localexchange$$.emit("content.place.relationship.share.added",$objectType$$,$objectID$$,$view$$.placeRecipients.length);$data$$.recipients.some(function($recipient$$){return $recipient$$.extendedAuthor})&&$view$$.showExtendedAuthorBar($objectType$$,$objectID$$);
$view$$.recipients=[];$view$$.placeRecipients=[]}).addErrback(function($message$$){($message$$?$j("\x3cp\x3e"+$message$$+"\x3c/p\x3e"):$j($errorUpdating$$({href:window.location}))).message({showClose:!0,style:"error"});$$modalDiv$$.find("input, button").prop("disabled",!1)})};$protect$$.isExtendedAuthor=function $$protect$$$isExtendedAuthor$($recipient$$){return this.options.externallyInviteable&&!$recipient$$.notified&&!$recipient$$.partner&&!$recipient$$.external&&!$recipient$$.entitled&&"email"!==
$recipient$$.prop.matchType};$protect$$.buildRecipientArray=function $$protect$$$buildRecipientArray$(){var $view$$=this;this.checkExternalUsers(this.userPicker.getSelectedUsersAndLists(!0));return this.recipients.map(function($recipient$$){return{identifier:-1!=$recipient$$.id?$recipient$$.id:$recipient$$.email,notified:$recipient$$.notified,extendedAuthor:$view$$.isExtendedAuthor.call($view$$,$recipient$$)}})};$protect$$.buildPlaceRecipientsArray=function $$protect$$$buildPlaceRecipientsArray$(){return this.placeRecipients=
this.userPicker.getSelectedUsersAndLists().containers.filter(function($container$$){return!$container$$.alreadyLinkedToPlace}).map(function($container$$){return{objectID:$container$$.id,objectType:$container$$.type}})};$protect$$.checkExternalUsers=function $$protect$$$checkExternalUsers$($data$$){$j("#jive-include-attach-div").hide();$data$$.users.forEach(function($user$$){(-1==$user$$.id||!$user$$.entitled)&&$j("#jive-include-attach-div").show()});this.recipients=this.recipients.filter(function($recipient$$){return $data$$.users.some(function($selectedUser$$){return $selectedUser$$.email===
$recipient$$.email})});var $added$$=this.addedRecipients($data$$.users);this.recipients=this.recipients.concat($added$$)};$protect$$.addedRecipients=function $$protect$$$addedRecipients$($selectedUsers$$){var $view$$=this;return $selectedUsers$$.filter(function($selectedUser$$){return!$view$$.recipients.some(function($recipient$$){return $selectedUser$$.email===$recipient$$.email})}).map(function($selectedUser$$){return $j.extend({},{notified:(!$view$$.options.externallyInviteable||!$view$$.options.invitationsEnabled)&&
!$selectedUser$$.partner&&!$selectedUser$$.external},$selectedUser$$)})};$protect$$.recipient=function $$protect$$$recipient$($email$$){return this.recipients.filter(function($recipient$$){return $recipient$$.email===$email$$})};$protect$$.notifyUser=function $$protect$$$notifyUser$($email$$,$notified$$){this.recipient($email$$).forEach(function($r$$){$r$$.notified=$notified$$});$j(".js-notify-user").toggle();$j(".js-unnotify-user").toggle()};$protect$$.extendedAuthor=function $$protect$$$extendedAuthor$($email$$,
$extendAuthorship$$){this.recipient($email$$).forEach(function($r$$){$r$$.extendedAuthor=$extendAuthorship$$})};this.openShareModal=function $this$openShareModal$($objectID$$,$objectType$$,$relationshipID$$){var $view$$=this;$view$$.emitP("prepareShare",$objectType$$,$objectID$$,$relationshipID$$).addCallback(function($data$$0$$){if(!$view$$.open)if($view$$.open=!0,$data$$0$$.invitationsEnabled&&($view$$.options.invitationsEnabled=!0),$data$$0$$.externallyInviteable&&($view$$.options.externallyInviteable=
!0),$data$$0$$.placeSharesEnabled&&($view$$.options.placeSharesEnabled=!0),$view$$.recipients=[],$view$$.placeRecipients=[],$data$$0$$.secretGroup&&!$data$$0$$.externallyInviteable)$j($secretGroupMessage$$()).message({showClose:!0,style:"error"});else{$data$$0$$.e14_anonymous=-1<_jive_current_user.ID?"false":"true";var $$body_$href_URLCheck_picker_url$$=$j(location).attr("href");0<$j(location).attr("href").indexOf("roadTestApps")&&0<$j("#jive-roadtest-description").find("a").length&&($$body_$href_URLCheck_picker_url$$=
_jive_base_absolute_url,$$body_$href_URLCheck_picker_url$$=$$body_$href_URLCheck_picker_url$$.replace($$body_$href_URLCheck_picker_url$$.substr($$body_$href_URLCheck_picker_url$$.indexOf("/community")),""),$$body_$href_URLCheck_picker_url$$+=$j("#jive-roadtest-description").find("a").attr("href"));$data$$0$$.e14_href=$$body_$href_URLCheck_picker_url$$;$data$$0$$.e14_country=e14Country;$data$$0$$.e14_title=$data$$0$$.objectTitle;$data$$0$$.e14_title_replaced=$data$$0$$.objectTitle.replace(" ","%20");
var $$body_$href_URLCheck_picker_url$$=$j(location).attr("href"),$$body_$href_URLCheck_picker_url$$=$$body_$href_URLCheck_picker_url$$.substring($$body_$href_URLCheck_picker_url$$.length-4,$$body_$href_URLCheck_picker_url$$.length),$$e14_share$$=!0;if("docs"==$$body_$href_URLCheck_picker_url$$||"zzz"==$$body_$href_URLCheck_picker_url$$||"ogs/"==$$body_$href_URLCheck_picker_url$$||"ity/"==$$body_$href_URLCheck_picker_url$$||"olls"==$$body_$href_URLCheck_picker_url$$||"ple/"==$$body_$href_URLCheck_picker_url$$||
"ups/"==$$body_$href_URLCheck_picker_url$$||"eads"==$$body_$href_URLCheck_picker_url$$||"ons/"==$$body_$href_URLCheck_picker_url$$||"rks/"==$$body_$href_URLCheck_picker_url$$||"jspa"==$$body_$href_URLCheck_picker_url$$||"true"==$$body_$href_URLCheck_picker_url$$)$$e14_share$$=!1;$data$$0$$.e14_share=$$e14_share$$;var $$modal$$=$j($shareMain$$($data$$0$$));$$modal$$.lightbox_me({destroyOnClose:!0,centered:!0,closeClick:!1,closeEsc:!1,closeFocusSelector:jive.Accessibility.hasStackedFocus()?jive.Accessibility.popFocus():
'a[data-command\x3d"share"][data-object-id\x3d"'+$objectID$$+'"][data-object-type\x3d"'+$objectType$$+'"]',onLoad:function(){$dispatcher$$.dispatch("trial.share.modal.loaded")},onClose:function(){$view$$.cleanupModal()}});$$modal$$.find("form").submit(function($e$$){$e$$.preventDefault();$j(this).find("input,button").prop("disabled",!0);$view$$.submitShare($objectID$$,$objectType$$,$$modal$$,$data$$0$$.objectNameCapital)});$$body_$href_URLCheck_picker_url$$=new $UserPicker$$({multiple:!0,listAllowed:!0,
emailAllowed:$data$$0$$.externallyShareable,placeAllowed:$data$$0$$.placeSharesEnabled,browsePlaceAllowed:$data$$0$$.placeSharesEnabled,containerType:containerType,containerID:containerID,message:"",object:{objectID:$objectID$$,objectType:$objectType$$},entitlement:"VIEW",$input:$j("#share-users"),canInvitePartners:$data$$0$$.externallyShareable,canInviteJustPartners:!1,canInvitePreprovisioned:!0,relatedMessage:$j($usersNotRelated$$()),userMessages:[$view$$.getUserPermissionsMessage($data$$0$$)],
listMessages:[$view$$.getListPermissionsMessage($data$$0$$)],placeWarnMessages:[$view$$.getAlreadySharedToPlaceMessage($data$$0$$)],placeInfoMessages:[$view$$.getShareToPlaceAccessMessage($data$$0$$)],placeholder:" ",existingRelationshipID:$relationshipID$$,includeShareContext:!0});$$body_$href_URLCheck_picker_url$$.addListener("selectedUsersChanged",function($data$$){$view$$.checkExternalUsers($data$$)});$view$$.userPicker=$$body_$href_URLCheck_picker_url$$;$$body_$href_URLCheck_picker_url$$=$j("body");
$$body_$href_URLCheck_picker_url$$.on("click",".js-notify-user",function($e$$){$view$$.notifyUser($j(this).data("user-identifier"),!0);$e$$.preventDefault()});$$body_$href_URLCheck_picker_url$$.on("click",".js-unnotify-user",function($e$$){$view$$.notifyUser($j(this).data("user-identifier"),!1);$e$$.preventDefault()});$$body_$href_URLCheck_picker_url$$.on("change",":checked",function($e$$){"share"==$j($e$$.target).val()?($view$$.extendedAuthor($j(this).data("user-identifier"),!0),$view$$.notifyUser($j(this).data("user-identifier"),
!1)):($view$$.extendedAuthor($j(this).data("user-identifier"),!1),$view$$.notifyUser($j(this).data("user-identifier"),!0))})}}).addErrback(function($message$$){($message$$?$j("\x3cp\x3e"+$message$$+"\x3c/p\x3e"):$j($errorFinding$$({href:window.location}))).message({showClose:!0,style:"error"})})};$protect$$.cleanupModal=function $$protect$$$cleanupModal$(){$j(".js-userpicker-user-msg").trigger("close");var $$body$$=$j("body");$$body$$.undelegate(".js-notify-user","click");$$body$$.undelegate(".js-unnotify-user",
"click");this.open=!1};$protect$$.getUserPermissionsMessage=function $$protect$$$getUserPermissionsMessage$($data$$){var $view$$=this;return{type:"warn",render:function($templateData_user$$){$templateData_user$$.notified=$view$$.recipient($templateData_user$$.email).some(function($r$$){return $r$$.notified});$templateData_user$$.extendedAuthor=$view$$.recipient($templateData_user$$.email).some(function($r$$){return $r$$.extendedAuthor});$templateData_user$$=$j.extend({user:$templateData_user$$},$data$$);
return $userWithoutPermission$$($templateData_user$$)}}};$protect$$.getListPermissionsMessage=function $$protect$$$getListPermissionsMessage$($data$$){return{type:"warn",render:function(){return $listWithoutPermission$$($data$$)}}};$protect$$.getShareToPlaceAccessMessage=function $$protect$$$getShareToPlaceAccessMessage$($data$$){return{type:"info",render:function($place_templateData$$){$place_templateData$$=$j.extend({place:$place_templateData$$},$data$$);return $shareToPlaceAccessInfo$$($place_templateData$$)}}};
$protect$$.getAlreadySharedToPlaceMessage=function $$protect$$$getAlreadySharedToPlaceMessage$($data$$){return{type:"warn",render:function($place$$1_templateData$$){$place$$1_templateData$$=$j.extend({place:$place$$1_templateData$$},$data$$);return $alreadySharedToPlace$$($place$$1_templateData$$)}}};$protect$$.showExtendedAuthorBar=function $$protect$$$showExtendedAuthorBar$($objectType$$,$objectId$$){$j(".js-ext-invites").is(":visible")||require(["soy!jive.extended_invitation.warn_bar","soy!jive.content.comment.rte_message"],
function($warnBarTemplate$$,$rteMessage$$){var $visibilityBar$$=$j(".external-access"),$hasExternalContributors$$=$visibilityBar$$.is(":visible");($hasExternalContributors$$?$visibilityBar$$.children():$visibilityBar$$).fadeOut(function(){$visibilityBar$$.replaceWith($warnBarTemplate$$({warnVisibleToPartner:$hasExternalContributors$$,warnAboutExtendedAuthors:!0,canRemoveExtendedAuthors:!0,objectType:$objectType$$,objectId:$objectId$$}))});$j(".js-rte-message").replaceWith($rteMessage$$({externallyVisible:$hasExternalContributors$$,
extendedAuthors:!0,objectType:$objectType$$,objectId:$objectId$$}))})}});return jive.ShareApp.ShareView});
;
jive.namespace("ShareApp");define("apps/share/models/share_source",["apps/shared/models/rest_service"],function(a){jive.ShareApp.ShareSource=a.extend(function(b){this.init=function(){this.suppressGenericErrorMessages()};this.save=function(c,g,e){var f=new jive.conc.Promise(),d=this;$j.ajax({type:"POST",url:jive.rest.url("/objects/")+c+"/"+g+"/shares",dataType:"json",data:JSON.stringify(e),contentType:"application/json; charset=utf-8",success:function(h,j,i){if(h){d.merge(e,h)}f.emitSuccess(e)},error:d.errorCallback(f),timeout:30000});return f};this.get=function(c,f){var e=new jive.conc.Promise(),d=this;$j.ajax({type:"GET",url:jive.rest.url("/objects/")+c+"/"+f+"/sharetemplate",dataType:"json",data:{},contentType:"application/json; charset=utf-8",success:function(g,i,h){e.emitSuccess(g)},error:d.errorCallback(e),timeout:30000});return e}});return jive.ShareApp.ShareSource});
;
jive.namespace("ShareApp");define("apps/share/main",["apps/share/models/share_source","apps/share/views/share_view"],function(b,a){jive.ShareApp.Main=jive.oo.Class.extend(function(){this.init=function(e){var d=e||{};var c=d.source||new b();this.view=new a();this.view.addListener("prepareShare",function(g,i,f,h){c.get(g,i).addCallback(h.emitSuccess.bind(h)).addErrback(h.emitError.bind(h))});this.view.addListener("share",function(f,i,g,h){c.save(f,i,g).addCallback(h.emitSuccess.bind(h).aritize(0)).addErrback(h.emitError.bind(h))})};this.showModal=function(e,d,c){this.view.openShareModal(e,d,c)}});return jive.ShareApp.Main});
;
goog.provide("jive.socialgroups.soy.joinConfirmation");goog.provide("jive.socialgroups.soy.leaveConfirmation");goog.provide("jive.socialgroups.soy.leaveGroup");goog.provide("jive.socialgroups.soy.renderError");goog.require("soy");goog.require("soydata");goog.require("soy.StringBuilder");goog.require("jive.error.rest.soy.errorFinding");
jive.socialgroups.soy.leaveGroup=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="jive-modal jive-modal-medium" id="jive-modal-leave-group"><header>',opt_data.pendingApproval?'<h2 class="jive-modal-title jive-modal-title-leave-group">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.join.cancel.colon"),[]))+" "+soy.$$escapeHtml(opt_data.groupName)+"</h2>":'<h2 class="jive-modal-title jive-modal-title-leave-group">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.leave.title"),
[]))+" "+soy.$$escapeHtml(opt_data.groupName)+"</h2>",'</header><label class="j-508-label" id="close-modal-508">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close.modal"),[])),'</label><a href="#" class="j-modal-close-top close" aria-labelledby="close-modal-508" title="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close.modal"),[])),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close"),[])),'  <span class="j-close-icon  j-ui-elem"></span></a><\!-- Manage categories listing --\><section class="jive-modal-content j-modal-content-text jive-modal-leave-group clearfix">',
opt_data.canLeaveSocialGroup?(opt_data.pendingApproval?"<h3>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.leave.canceljoin"),[opt_data.groupName]))+"</h3>"+(opt_data.requiresApproval?"<p>"+soy.$$escapeHtml(opt_data.leaveI18n)+"</p>":""):"<h3>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.leave.confirm"),[opt_data.groupName]))+"</h3>"+(opt_data.requiresApproval?"<p>"+soy.$$escapeHtml(opt_data.leaveI18n)+"</p>":"")+"<p>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.leave.follow.remove"),
[]))+"</p>")+'<div class="jive-form-buttons"><button type="button" class="j-btn-callout" id="group-leave-submit">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.leave.accept"),[]))+'</button><button type="button" class="jive-modal-close close">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.cancel"),[]))+"</button></div>":opt_data.onlyOneOwner?"<p>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.leave.onlyowner"),[]))+"</p><p>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.leave.onlyowner.info"),
[]))+'</p><div class="jive-form-buttons"><button type="button" class="jive-modal-close close">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.cancel"),[]))+"</button></div>":soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.leave.already.gone"),[])),"</section></div>");return opt_sb?"":output.toString()};
jive.socialgroups.soy.joinConfirmation=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.pendingApproval?"<div>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.join.apprvl.info"),[]))+"</div>":opt_data.banned?"<div>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.banned_member.msg"),[]))+"</div>":"<div>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.join.confirm"),[]))+"</div>");return opt_sb?"":output.toString()};
jive.socialgroups.soy.leaveConfirmation=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.pendingApproval?"<div>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.cancel.message"),[]))+"</div>":"<div>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.leave.message"),[]))+"</div>");return opt_sb?"":output.toString()};
jive.socialgroups.soy.renderError=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;switch(opt_data.code){case 4026:output.append("<p>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.join.notallowed"),[])),"</p>");break;case 4008:output.append("<p>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.not.found"),[])),"</p>");break;default:if(opt_data.message)output.append("<p>",soy.$$escapeHtml(opt_data.message),"</p>");else jive.error.rest.soy.errorFinding(opt_data,
output)}return opt_sb?"":output.toString()};
;
define("apps/shared/models/nested_rest_service",["apps/shared/models/rest_service"],function(a){jive.NestedRestService=a.extend(function(b,c){b.init=function(d){c.init.call(this,d);this.parentType=d.parentType;this.parentID=d.parentID;this.POST_RESOURCE_ENDPOINT=[this.RESOURCE_ENDPOINT,this.parentType,this.parentID].join("/")}});return jive.NestedRestService});
;
jive.namespace("Browse.Content");define("apps/browse/content/model/content_source",["apps/shared/models/rest_service"],function(a){jive.Browse.Content.ItemSource=a.extend(function(b){b.resourceType="content";b.pluralizedResourceType=b.resourceType;b.putOnUpdate=true});return jive.Browse.Content.ItemSource});
;
jive.namespace("Move.Content");jive.Move.Content.MoveContentItemSource=jive.Browse.Content.ItemSource.extend(function(a,b){a.suppressGenericErrorMessages();a.errorCallback=function(e,c){var d=this;return function(k,l,h){var i,g,f;try{i=JSON.parse(k.responseText)}catch(j){}g=i?i.message:null;f=(i&&i.code)?i.code:k.status;if(l!=="error"||k.status>=100){if(g){try{$j("<p>"+g+"</p>").message({style:"error"})}catch(j){if(console&&console.log){console.log(j)}}}else{a.displayError(c())}e.emitError.apply(e,[g,f])}}}});define("apps/movecontent/models/move_content_item_source",function(){return jive.Move.Content.MoveContentItemSource});
;
jive.namespace("Browse.Container");define("apps/browse/container/model/container_source",["apps/shared/models/rest_service"],function(a){jive.Browse.Container.ItemSource=a.extend(function(b){b.resourceType="container";this.getContainerProperty=function(d){var c=this.RESOURCE_ENDPOINT+"/"+d.containerType+"/"+d.containerID+"/prop/"+d.propName;return this.commonAjaxRequest(new jive.conc.Promise(),"GET",{url:c,data:{}})};this.setContainerProperty=function(d){var c=this.RESOURCE_ENDPOINT+"/"+d.containerType+"/"+d.containerID+"/prop/"+d.propName;return this.commonAjaxRequest(new jive.conc.Promise(),"POST",{url:c,data:d.propValue})};this.removeContainerProperty=function(d){var c=this.RESOURCE_ENDPOINT+"/"+d.containerType+"/"+d.containerID+"/prop/"+d.propName;return this.commonAjaxRequest(new jive.conc.Promise(),"DELETE",{url:c})};this.getSpaceChildren=function(d){var c=this.RESOURCE_ENDPOINT+"/"+d.containerID+"/children";return this.commonAjaxRequest(new jive.conc.Promise(),"GET",{url:c,data:d})};this.getBreadcrumbBean=function(d){var c=this.RESOURCE_ENDPOINT+"/"+d.containerType+"/"+d.containerID+"/breadcrumbs";return this.commonAjaxRequest(new jive.conc.Promise(),"GET",{url:c,data:{}})}});return jive.Browse.Container.ItemSource});
;
goog.provide("jive.movecontent.confirm");
jive.movecontent.confirm=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="js-move-confirm-section"><header><h2>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("content.mv.confirm.title"),[])),"</h2></header>",opt_data.moderatedTargetPlace?'<div id="jive-warn-moderation" class="jive-warn-box"><span class="jive-icon-med jive-icon-warn"></span><div>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("content.mv.moderated_place.text"),[]))+"</div></div>":
"",'<a class="j-modal-close-top close" href="#">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close"),[])),' <span class="j-close-icon j-ui-elem" role="img"></span></a><section class="jive-modal-content jive-modal-content-move clearfix"><h6>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("content.mv.really_move_it.text"),[])),'</h6><p><img src="',soy.$$escapeHtml(jive.soy.func.resourceUrl(window._jive_base_url,"/9.0.5.998b920/","//files1.element14.com/community","/images/transparent.png")),
'" alt="" class="',soy.$$escapeHtml(opt_data.content.iconCss),' jive-icon-med" /> ',soy.$$filterNoAutoescape(opt_data.content.subject),"</p><h6>");if(opt_data.targetPersonalContainer)jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("content.mv.into_ctr.text"),arg0:'<img src="'+soy.$$escapeHtml(jive.soy.func.resourceUrl(window._jive_base_url,"/9.0.5.998b920/","//files1.element14.com/community","/images/transparent.png"))+'" alt="" class="'+soy.$$escapeHtml(opt_data.content.iconCss)+' jive-icon-med" /> '+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(opt_data.personalContainerKey),[])),noAutoEscape:"true"},output);else output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("content.mv.into_this_ctr.text"),[])));output.append("</h6>",!opt_data.targetPersonalContainer?'<p><img src="'+soy.$$escapeHtml(jive.soy.func.resourceUrl(window._jive_base_url,"/9.0.5.998b920/","//files1.element14.com/community","/images/transparent.png"))+'" alt="" class="'+soy.$$escapeHtml(opt_data.targetContainer.iconCss)+
' jive-icon-med" /> '+soy.$$filterNoAutoescape(opt_data.targetContainer.subject)+"</p>":"",opt_data.docWithCollaborators?'<p class="jive-warning"><span><span class="jive-icon-sml jive-icon-warn"></span>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("content.mv.remove_collab.text"),[]))+"</span></p>":"",opt_data.restrictedSocialGroup?'<p class="jive-warning"><span><span class="jive-icon-sml jive-icon-warn"></span>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("content.mv.restricted_group.text"),
[]))+"</span></p>":"",opt_data.hasExtendedAuthors?'<p class="jive-warning"><span><span class="jive-icon-sml jive-icon-warn"></span>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("content.mv.extended_authors.text"),[]))+"</span></p>":"",opt_data.sourceIsExStorage?'<p class="jive-warning"><span><span class="jive-icon-sml jive-icon-warn"></span>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("content.mv.external_storage_source.text"),[]))+"</span></p>":opt_data.targetIsExStorage?'<p class="jive-warning"><span><span class="jive-icon-sml jive-icon-warn"></span>'+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("content.mv.external_storage_target.text"),[]))+"</span></p>":"",opt_data.hasPlaceLinks?'<p class="jive-warning"><span><span class="jive-icon-sml jive-icon-warn"></span>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("content.mv.related_places.text"),[]))+"</span></p>":"",'<p class="j-move-notify-streams" ',opt_data.content.archetype!="content"?'style="display:none;"':"",'><input aria-labelledby="move-notify-label" type="checkbox" class="js-move-notify-streams" /> <strong id="move-notify-label" class="j-move-notify-label js-move-notify-toggle">',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("content.mv.notify_streams.text"),[])),'</strong></p><div class="j-form-row"><button class="js-move-confirm j-btn-callout">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("content.mv.confirm.button"),[])),'</button><button class="js-move-confirm-cancel">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.cancel"),[])),"</button></div></section></div>");return opt_sb?"":output.toString()};
;
jive.namespace("Move.Content");jive.Move.Content.MoveView=jive.AbstractView.extend(function(a){var c=jQuery,b=jive.Move.Content;a.init=function(){var d=this;c(document).ready(function(){c("#jive-link-move a, a#jive-link-move").click(function(e){d.emit("browse");e.preventDefault()})})};this.confirm=function(f){var d=this;var e=c(".jive-modal");var g=jive.movecontent.confirm(f);d.prevContent=e.children();d.visibleContent=d.prevContent.filter(":visible");d.visibleContent.hide();e.append(g).removeClass("j-container-browse").trigger("resize");e.find(".js-move-notify-toggle").click(function(){var h=e.find(".js-move-notify-streams");h.attr("checked",!h.is(":checked"))});e.find(".js-move-confirm").click(function(h){var i=c(this);i.attr("disabled","disabled");d.emit("moveConfirmed",{targetContainerType:f.targetContainer.type,targetContainerID:f.targetContainer.id,notifyStreams:e.find(".js-move-notify-streams").is(":checked"),failureCallback:function(){i.removeAttr("disabled")}});h.preventDefault()});e.find(".js-move-confirm-cancel, .close").click(function(h){e.find(".js-move-confirm-section").remove();d.visibleContent.show().focus();e.addClass("j-container-browse").trigger("resize");h.preventDefault()});c("body").find(".js_lb_overlay").click(function(h){e.find(".js-move-confirm-section").remove();h.preventDefault()})}});define("apps/movecontent/views/move_view",function(){return jive.Move.Content.MoveView});
;
jive.namespace("Move.Content");jive.Move.Content.CapabilitiesSource=jive.NestedRestService.extend(function(a,b){a.resourceType="capability";a.init=function(c){b.init.call(this,c);this.pluralizedResourceType="capabilities";this.RESOURCE_ENDPOINT=jive.rest.url("/"+["content",this.parentType,this.parentID,this.pluralizedResourceType].join("/"));this.POST_RESOURCE_ENDPOINT=this.RESOURCE_ENDPOINT}});define("apps/movecontent/models/move_content_source",function(){return jive.Move.Content.CapabilitiesSource});
;
jive.namespace("Move.Container");jive.Move.Container.CapabilitiesSource=jive.NestedRestService.extend(function(a,b){a.resourceType="capability";a.init=function(c){b.init.call(this,c);this.pluralizedResourceType="capabilities";this.RESOURCE_ENDPOINT=jive.rest.url("/"+["containers",this.parentType,this.parentID,this.pluralizedResourceType].join("/"));this.POST_RESOURCE_ENDPOINT=this.RESOURCE_ENDPOINT}});define("apps/movecontent/models/move_container_source",function(){return jive.Move.Container.CapabilitiesSource});
;
jive.namespace("Move.Content");jive.Move.Content.Main=jive.oo.Class.extend(function(a){a.init=function(c){var b=this;this.objectType=c.objectType;this.objectID=c.objectID;this.containerType=c.containerType;this.containerID=c.containerID;this.isContainer=c.isContainer||false;this.contentCapabilitiesSource=new jive.Move.Content.CapabilitiesSource({parentID:this.objectID,parentType:this.objectType});this.containerCapabilitiesSource=new jive.Move.Container.CapabilitiesSource({parentID:this.objectID,parentType:this.objectType});this.contentSource=new jive.Move.Content.MoveContentItemSource();this.containerSource=new jive.Browse.Container.ItemSource();this.moveView=new jive.Move.Content.MoveView();this.placePicker=new jive.Placepicker.Main($j.extend({pickerContext:"move"},c));this.moveView.addListener("browse",function(d){b.placePicker.showPicker()});this.moveView.addListener("moveConfirmed",function(d){if(b.isContainer){b.handleConfirmation(b.containerSource,d)}else{b.handleConfirmation(b.contentSource,d)}});this.placePicker.addListener("container",function(d,e){if(b.isContainer){b.handleContainerSelected(b.containerCapabilitiesSource,d)}else{b.handleContainerSelected(b.contentCapabilitiesSource,d)}})};a.handleConfirmation=function(d,c){var b=this;d.save({id:b.objectType+"/"+b.objectID,objectType:c.targetContainerType,objectID:c.targetContainerID,notifyStreams:!!c.notifyStreams}).addCallback(function(e){window.location=jive.app.url({path:e.link+"?prevContainerType="+b.containerType+"&prevContainerID="+b.containerID})}).addErrback(function(e){c.failureCallback()})};a.handleContainerSelected=function(d,c){var b=this;d.findAll({containerType:c.targetContainerType,containerID:c.targetContainerID}).addCallback(function(i){var e=$j("#js-place-link-breadcrumb");var h=false;if(e&&e.length>0){var f=parseInt(e.attr("data-place-link-count"));h=typeof f=="number"&&f>0}var g=$j.extend({hasPlaceLinks:h},i);b.moveView.confirm(g)})}});define("apps/movecontent/main",function(){return jive.Move.Content.Main});
;
goog.provide("jive.movecontent.confirm");goog.provide("jive.movecontent.imports");goog.provide("jive.movecontent.successMessage");goog.require("soy");goog.require("soydata");goog.require("soy.StringBuilder");goog.require("jive.shared.displayutil.containerDisplayNameLink");goog.require("jive.shared.soy.i18nHelper");jive.movecontent.imports=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;return opt_sb?"":output.toString()};
jive.movecontent.successMessage=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="jive-success-box" aria-live="polite" aria-atomic="true"><div><span class="jive-icon-med jive-icon-check"></span>');var param9=new soy.StringBuilder;jive.shared.displayutil.containerDisplayNameLink({container:opt_data.prevContainer},param9);var param12=new soy.StringBuilder;jive.shared.displayutil.containerDisplayNameLink(opt_data,param12);jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("content.mv.success"),
arg0:soy.$$escapeHtml(opt_data.contentTypeName),arg1:param9.toString(),arg2:param12.toString(),noAutoEscape:"true"},output);output.append("</div></div>");return opt_sb?"":output.toString()};
jive.movecontent.confirm=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="js-move-confirm-section"><header><h2>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("content.mv.confirm.title"),[])),"</h2></header>",opt_data.moderatedTargetPlace?'<div id="jive-warn-moderation" class="jive-warn-box"><span class="jive-icon-med jive-icon-warn"></span><div>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("content.mv.moderated_place.text"),[]))+"</div></div>":
"",'<a class="j-modal-close-top close" href="#">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close"),[])),' <span class="j-close-icon j-ui-elem" role="img"></span></a><section class="jive-modal-content jive-modal-content-move clearfix"><h6>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("content.mv.really_move_it.text"),[])),'</h6><p><img src="',soy.$$escapeHtml(jive.soy.func.resourceUrl(window._jive_base_url,"/9.0.5.998b920/","//files1.element14.com/community","/images/transparent.png")),
'" alt="" class="',soy.$$escapeHtml(opt_data.content.iconCss),' jive-icon-med" /> ',soy.$$filterNoAutoescape(opt_data.content.subject),"</p><h6>");if(opt_data.targetPersonalContainer)jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("content.mv.into_ctr.text"),arg0:'<img src="'+soy.$$escapeHtml(jive.soy.func.resourceUrl(window._jive_base_url,"/9.0.5.998b920/","//files1.element14.com/community","/images/transparent.png"))+'" alt="" class="'+soy.$$escapeHtml(opt_data.content.iconCss)+' jive-icon-med" /> '+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(opt_data.personalContainerKey),[])),noAutoEscape:"true"},output);else output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("content.mv.into_this_ctr.text"),[])));output.append("</h6>",!opt_data.targetPersonalContainer?'<p><img src="'+soy.$$escapeHtml(jive.soy.func.resourceUrl(window._jive_base_url,"/9.0.5.998b920/","//files1.element14.com/community","/images/transparent.png"))+'" alt="" class="'+soy.$$escapeHtml(opt_data.targetContainer.iconCss)+
' jive-icon-med" /> '+soy.$$filterNoAutoescape(opt_data.targetContainer.subject)+"</p>":"",opt_data.docWithCollaborators?'<p class="jive-warning"><span><span class="jive-icon-sml jive-icon-warn"></span>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("content.mv.remove_collab.text"),[]))+"</span></p>":"",opt_data.restrictedSocialGroup?'<p class="jive-warning"><span><span class="jive-icon-sml jive-icon-warn"></span>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("content.mv.restricted_group.text"),
[]))+"</span></p>":"",opt_data.hasExtendedAuthors?'<p class="jive-warning"><span><span class="jive-icon-sml jive-icon-warn"></span>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("content.mv.extended_authors.text"),[]))+"</span></p>":"",opt_data.sourceIsExStorage?'<p class="jive-warning"><span><span class="jive-icon-sml jive-icon-warn"></span>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("content.mv.external_storage_source.text"),[]))+"</span></p>":opt_data.targetIsExStorage?'<p class="jive-warning"><span><span class="jive-icon-sml jive-icon-warn"></span>'+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("content.mv.external_storage_target.text"),[]))+"</span></p>":"",opt_data.hasPlaceLinks?'<p class="jive-warning"><span><span class="jive-icon-sml jive-icon-warn"></span>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("content.mv.related_places.text"),[]))+"</span></p>":"",'<p class="j-move-notify-streams" ',opt_data.content.archetype!="content"?'style="display:none;"':"",'><input aria-labelledby="move-notify-label" type="checkbox" class="js-move-notify-streams" /> <strong id="move-notify-label" class="j-move-notify-label js-move-notify-toggle">',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("content.mv.notify_streams.text"),[])),'</strong></p><div class="j-form-row"><button class="js-move-confirm j-btn-callout">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("content.mv.confirm.button"),[])),'</button><button class="js-move-confirm-cancel">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.cancel"),[])),"</button></div></section></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.modalizer.foo");goog.require("soy");goog.require("soydata");goog.require("soy.StringBuilder");jive.modalizer.foo=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.badge.outcomeBadge");jive.outcomes.badge.outcomeBadge=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.outcomes.badge.badge({outcomeType:String(opt_data.outcome.outcomeType.name).toLowerCase(),embedded:opt_data.embedded},output);return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.badge.headerBadgeRaw");
jive.outcomes.badge.headerBadgeRaw=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<",soy.$$escapeHtml(opt_data.tagName),' class="js-outcome-badge js-outcome-badge-noclick js-outcome-type-',soy.$$escapeHtml(opt_data.outcomeType)," j-outcome-type-",soy.$$escapeHtml(opt_data.outcomeType),opt_data.extraClasses?" "+soy.$$escapeHtml(opt_data.extraClasses):"",'" data-outcome-type="',soy.$$escapeHtml(opt_data.outcomeType),'"><span class="j-outcome-badge j-outcome-type-',
soy.$$escapeHtml(opt_data.outcomeType),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.badge."+opt_data.outcomeType)),[])),"</span></",soy.$$escapeHtml(opt_data.tagName),">");return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.badge.headerBadge");jive.outcomes.badge.headerBadge=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.outcomes.badge.headerBadgeRaw(soy.$$augmentMap(opt_data,{tagName:"li"}),output);return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.badge.headerOutcomeBadge");jive.outcomes.badge.headerOutcomeBadge=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.outcomes.badge.headerBadge({outcomeType:String(opt_data.outcome.outcomeType.name).toLowerCase(),embedded:opt_data.embedded},output);return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.badge.headerBadges");jive.outcomes.badge.headerBadges=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;var outcomeList3=opt_data.outcomes;var outcomeListLen3=outcomeList3.length;for(var outcomeIndex3=0;outcomeIndex3<outcomeListLen3;outcomeIndex3++){var outcomeData3=outcomeList3[outcomeIndex3];jive.outcomes.badge.headerOutcomeBadge({outcome:outcomeData3,embedded:opt_data.embedded},output)}return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.badge.headerBadgeByline");
jive.outcomes.badge.headerBadgeByline=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<span class="j-outcome-byline font-color-meta">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.badge.popup."+opt_data.outcomeTypeName)),[]))," ");jive.shared.displayutil.userDisplayNameLink(soy.$$augmentMap(opt_data.author,{anonymous:false}),output);output.append(' <span class="font-color-meta">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.badge.popup.datePart"),
[(opt_data.modifiedDate?jive.model.DateUtil.parseISODateTime(opt_data.modifiedDate):"")?_jive_moment.utc(parseFloat(opt_data.modifiedDate?jive.model.DateUtil.parseISODateTime(opt_data.modifiedDate):"")?parseFloat(opt_data.modifiedDate?jive.model.DateUtil.parseISODateTime(opt_data.modifiedDate):""):opt_data.modifiedDate?jive.model.DateUtil.parseISODateTime(opt_data.modifiedDate):"").lang(_jive_locale.toLowerCase().replace("_","-")).format("lll"):""])),"</span></span>");return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.badge.headerBadgeOutdatedLink");jive.outcomes.badge.headerBadgeOutdatedLink=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<span class="j-outcomes-redirect">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.badge.popup.outdated.link.meta"),[])),' <a href="',soy.$$escapeHtml(opt_data.href),'">',soy.$$escapeHtml(opt_data.title),"</a></span>");return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.badge.headerBadgeActionLink");
jive.outcomes.badge.headerBadgeActionLink=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<span class="j-outcome-modal-footer-link font-color-meta"><a class="j-outcome-modal-footer-link js-actionLink ',soy.$$escapeHtml(opt_data.extraClasses?opt_data.extraClasses:""),'"',opt_data.actionData?'data-action-data="'+soy.$$escapeHtml(opt_data.actionData)+'"':"",opt_data.event?'data-event="'+soy.$$escapeHtml(opt_data.event)+'"':"",'href="#">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.actionMenu.item.meta."+
opt_data.labelSuffix)),[])),"</a></span>");return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.badge.headerBadgePopup");
jive.outcomes.badge.headerBadgePopup=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-outcome-badge-popup j-outcome-popup j-outcome-meta">');if(!(opt_data.props.url&&opt_data.props.title))jive.outcomes.badge.headerBadgeByline(opt_data,output);if(opt_data.props.url&&opt_data.props.title)jive.outcomes.badge.headerBadgeOutdatedLink({href:opt_data.props.url,title:opt_data.props.title},output);if(opt_data.props.url&&opt_data.props.title)jive.outcomes.badge.headerBadgeByline(opt_data,
output);if(opt_data.actions.length>0){var itemList17=opt_data.actions;var itemListLen17=itemList17.length;for(var itemIndex17=0;itemIndex17<itemListLen17;itemIndex17++){var itemData17=itemList17[itemIndex17];output.append(!(itemIndex17==0)?"":"");jive.outcomes.badge.headerBadgeActionLink(itemData17,output)}}output.append("</div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.badge.fakeOutcomeBadge");jive.outcomes.badge.fakeOutcomeBadge=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.outcomes.badge.badgeRaw({outcomeType:String(opt_data.outcomeTypeName).toLowerCase(),tagName:"li",embedded:true,extraClasses:"j-fake-badge js-fake-badge"},output);return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.badge.badgeByline");
jive.outcomes.badge.badgeByline=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-outcome-byline">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.badge.popup."+opt_data.outcomeTypeName)),[]))," ");jive.shared.displayutil.userDisplayNameLink(soy.$$augmentMap(opt_data.author,{anonymous:false}),output);output.append(' <span class="font-color-meta">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.badge.popup.datePart"),[(opt_data.modifiedDate?
jive.model.DateUtil.parseISODateTime(opt_data.modifiedDate):"")?_jive_moment(parseFloat(opt_data.modifiedDate?jive.model.DateUtil.parseISODateTime(opt_data.modifiedDate):"")?parseFloat(opt_data.modifiedDate?jive.model.DateUtil.parseISODateTime(opt_data.modifiedDate):""):opt_data.modifiedDate?jive.model.DateUtil.parseISODateTime(opt_data.modifiedDate):"").add(_jive_timezoneoffset*60*60*1E3).lang(_jive_locale.toLowerCase().replace("_","-")).format("lll"):""])),"</span></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.badge.badgeComment");jive.outcomes.badge.badgeComment=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-outcome-comment"><p><strong class="font-color-meta">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.badge.popup.messageLabel"),[])),"</strong> ",soy.$$changeNewlineToBr(soy.$$escapeHtml(opt_data.comment)),"</p></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.shared.displayutil.commaItemList");jive.shared.displayutil.commaItemList=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;var itemList3=opt_data.items;var itemListLen3=itemList3.length;for(var itemIndex3=0;itemIndex3<itemListLen3;itemIndex3++){var itemData3=itemList3[itemIndex3];output.append(itemIndex3==0?soy.$$escapeHtml(itemData3):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("itemList.delim"),[]))+" "+soy.$$escapeHtml(itemData3))}return opt_sb?"":output.toString()};
;
goog.provide("jive.shared.displayutil.plainItemList");
jive.shared.displayutil.plainItemList=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(!opt_data.items||opt_data.items.length==0);else if(opt_data.items.length==1)output.append(soy.$$escapeHtml(opt_data.items[0]));else if(opt_data.items.length==2)output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("itemList.2"),[opt_data.items[0],opt_data.items[1]])));else if(opt_data.items.length==3)output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("itemList.3"),[opt_data.items[0],
opt_data.items[1],opt_data.items[2]])));else{jive.shared.displayutil.commaItemList({items:opt_data.items.slice(0,-3)},output);output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("itemList.delim"),[]))," ");jive.shared.displayutil.plainItemList({items:opt_data.items.slice(-3)},output)}return opt_sb?"":output.toString()};
;
goog.provide("jive.shared.displayutil.itemList");
jive.shared.displayutil.itemList=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<span class="j-item-list js-item-list',opt_data.classNames?" "+soy.$$escapeHtml(opt_data.classNames):"","\" data-items='",soy.$$escapeHtml(JSON.stringify(opt_data.items).replace(/</g,"\\u003C").replace(/>/g,"\\u003E").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")),"'>");if(!opt_data.items||opt_data.items.length==0);else if(opt_data.items.length<4)jive.shared.displayutil.plainItemList(opt_data,
output);else if(opt_data.items.length==4)output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("itemList.4"),[opt_data.items[0],opt_data.items[1],opt_data.items[2],opt_data.items[3]])));else{output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("itemList.more"),[opt_data.items[0],opt_data.items[1],opt_data.items[2]]))," <",soy.$$escapeHtml(opt_data.tagName?opt_data.tagName:"a")," ");if(opt_data.useTitle){output.append('title="');jive.shared.displayutil.plainItemList({items:opt_data.items.slice(3)},
output);output.append('" ')}output.append('class="j-item-list-more js-item-list-more',opt_data.moreClassNames?" "+soy.$$escapeHtml(opt_data.moreClassNames):"",opt_data.expandable?" js-item-list-showMore":"",'"',!opt_data.tagName?' href="#"':"",">",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("itemList.others"),[opt_data.items.length-3])),"</",soy.$$escapeHtml(opt_data.tagName?opt_data.tagName:"a"),">")}output.append("</span>");return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.badge.badgeAlertedNames");jive.outcomes.badge.badgeAlertedNames=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-outcome-approvers font-color-meta"><strong>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.badge.popup.approversLabel"),[])),"</strong> ");jive.shared.displayutil.itemList({items:opt_data.alertedNames,expandable:true},output);output.append("</div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.badge.badgeShareLink");
jive.outcomes.badge.badgeShareLink=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<a class="j-share-link ',opt_data.actionData&&opt_data.event?"js-actionLink j-ui-elem j-share-add-contributors font-color-meta-light":"",'"',opt_data.actionData?'data-action-data="'+soy.$$escapeHtml(opt_data.actionData)+'"':"",opt_data.event?'data-event="'+soy.$$escapeHtml(opt_data.event)+'"':"",opt_data.actionData&&opt_data.event?'title="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.actionMenu.share."+
opt_data.labelSuffix)),[]))+'"':"",'href="',soy.$$escapeHtml(opt_data.href?opt_data.href:"#"),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.actionMenu.share."+opt_data.labelSuffix)),[])),"</a>");return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.badge.badgeOutdatedLink");jive.outcomes.badge.badgeOutdatedLink=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-outcomes-outdated-redirect j-outcome-comment"><p><h5>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.badge.popup.outdated.link"),[])),' </h5><a href="',soy.$$escapeHtml(opt_data.href),'">',soy.$$escapeHtml(opt_data.title),"</a></p></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.badge.badgeActionLink");
jive.outcomes.badge.badgeActionLink=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<a class="j-outcome-modal-footer-link js-actionLink ',soy.$$escapeHtml(opt_data.extraClasses?opt_data.extraClasses:""),'"',opt_data.actionData?'data-action-data="'+soy.$$escapeHtml(opt_data.actionData)+'"':"",opt_data.event?'data-event="'+soy.$$escapeHtml(opt_data.event)+'"':"",'href="#">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.actionMenu.item."+opt_data.labelSuffix)),
[])),"</a>");return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.badge.badgePopup");
jive.outcomes.badge.badgePopup=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-outcome-badge-popup j-outcome-popup">');jive.outcomes.badge.badgeByline(opt_data,output);if(opt_data.comment)jive.outcomes.badge.badgeComment(opt_data,output);if(opt_data.alertedNames)jive.outcomes.badge.badgeAlertedNames(opt_data,output);if(opt_data.shareLink)jive.outcomes.badge.badgeShareLink(opt_data.shareLink,output);if(opt_data.props.url&&opt_data.props.title)jive.outcomes.badge.badgeOutdatedLink({href:opt_data.props.url,
title:opt_data.props.title},output);if(opt_data.actions.length>0){output.append('<footer class="j-outcome-modal-footer j-pop-row j-last">');var itemList24=opt_data.actions;var itemListLen24=itemList24.length;for(var itemIndex24=0;itemIndex24<itemListLen24;itemIndex24++){var itemData24=itemList24[itemIndex24];output.append(!(itemIndex24==0)?'<span class="font-color-meta-light">|</span>':"");jive.outcomes.badge.badgeActionLink(itemData24,output)}output.append("</footer>")}output.append("</div>");return opt_sb?
"":output.toString()};
;
define("apps/outcomes/viewUtil",["jquery","apps/shared/controllers/localexchange"],function(g,i){var l=["wip","finalized","outdated","official","decision","pending","resolved","success","helpful"];function c(q){var o=[];var r=false;for(var p=l.length-1;p>=0;--p){if(r){o.push(l[p])}else{if(l[p]===q){r=true}}}return o}function f(u,r){if(u===r){return 0}var t=u.name.toLowerCase(),o=r.name.toLowerCase(),p=t.localeCompare(o);if(p===0){return 0}for(var q=0;q<l.length;++q){var s=l[q];if(s==t){return -1}if(s==o){return 1}}return p}function b(){if(b.timeout){clearTimeout(b.timeout)}b.timeout=setTimeout(function(){b.timeout=null;i.emit("heightChanged")},250)}function j(q,p,o){this.labelSuffix=q;this.event=p;this.actionData=o}function a(o){return g.map(o,function(p){if(p.verb=="get"){return null}var r="outcome."+p.verb;var q;if(p.context){q={outcomeType:p.subject,predecessor:{url:p.context.resources.self.ref,outcomeType:p.context.outcomeType,shared:p.context.properties?p.context.properties.shared:false}}}else{q=p.subject}q=JSON.stringify(q);var s;if(p.context){s=p.context.outcomeType.name.toLowerCase()+"."}else{s=""}s+=p.subject.name.toLowerCase()+"."+p.verb;return new j(s,r,q)})}function d(s,r,q){var o=r.first();var p=null;while(o.length){p=null;s.each(function(){if(o.has(this).length){p=g(this);return false}return true});if(p){return p}o=o.parent()}if(!r||r.length==0){s.each(function(){if(g(this).data("outcome-type")==q){p=g(this);return false}return true});if(p){return p}}return g()}return{getEd:function k(p){var o=g(p);return{type:o.data("objectType"),id:o.data("objectId")}},getParentEd:function e(p){var o=g(p);return{type:o.data("parentObjectType"),id:o.data("parentObjectId")}},getContext:function n(p){var o=g(p);return o.data("context")},getContextMeta:function n(p){var o=g(p);return o.data("meta-context")},getRootCommunityName:function m(p){var o=g(p);return o.data("root-community")},placeItem:function h(q,t,s,r,p){var u=g();var o=g();q.each(function(){var y=g(this),x=y.children(":visible").length==0,v=g(t).clone(),w=c(s);if(x&&p){y.hide()}u=u.add(v);if(w!=null){var z=g();g.each(w,function(A,B){z=r(y,B);return z.length==0});if(z.length==0){y.prepend(v)}else{z.after(v)}}else{y.append(v)}if(p){y.slideDown(p)}if(x){o=o.add(y)}});if(o.length>0){o.promise().done(b)}return u},outcomeTypeComparator:f,buildLinkActions:a,nearest:d}});
;
goog.provide("jive.i18n.keys.outcomesErrorMissing");jive.i18n.keys.outcomesErrorMissing=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.error.missing"),[])));return opt_sb?"":output.toString()};
;
define("apps/shared/models/promise_cache",["jquery"],function(d){function a(l,k){this.cache={};this.keyNames=l;this.logEnabled=k&&console&&console.log}a.prototype._access=function i(m,p,o){var k=this.cache;for(var l=0;k!=null&&l<this.keyNames.length;++l){var n=m[this.keyNames[l]];if(k[n]==null){if(p){if(l<this.keyNames.length-1){k[n]={}}else{if(o!=null){k[n]=o}}}}else{if((l==this.keyNames.length-1)&&p&&o==null){delete k[n]}}k=k[n]}return k};a.prototype.get=function b(l,m){var k=this._access(l);if(k==null){if(this.logEnabled){console.log("Cache missed",l)}if(m){return this.put(l,m(l))}else{k=new d.Deferred();k.reject(this,l);return k.promise()}}else{if(this.logEnabled){console.log("Cache Hit",l)}return k}};a.prototype.getAll=function e(m,n){var l=[];var k=this;d.each(m,function(){l.push(k.get(this,n))});return d.when.apply(d,l).then(function(){return Array.prototype.slice.apply(arguments)})};a.prototype.getAllBulk=function c(o,n){var p=[],m=this;d.each(o,function(){if(!m.has(this)){p.push(this)}});if(p.length){var k=n(p);d.each(p,function(r,q){if(m.logEnabled){console.log("Bulk Cache missed",q)}m.put(q,k.then(function s(t){return t[r]}))})}function l(q,r){console.error("ERROR: bulk load failed",r);return this}return this.getAll(o,l)};a.prototype.put=function h(k,l){return this._access(k,true,l)};a.prototype.has=function j(k){var l=this._access(k);return l!=null};a.prototype.clear=function f(k){this._access(k,true,null)};a.prototype.clearAll=function g(){this.cache={}};return a});
;
define("apps/outcomes/outcomesModel",["jquery","apps/shared/models/core_deferred","apps/shared/models/promise_cache"],function(A,u,a){var b=false;var H=new a(["type","id"],b);var h=new a(["type","id"],b);function f(M,L,K){return{outcomeType:M,note:L,properties:K}}function B(O){var N={};function M(P){var Q=P.type,R=P.id;if(!N[Q]){N[Q]={}}if(!N[Q][R]){N[Q][R]=true;return false}else{return true}}var K=[];for(var L=0;L<O.length;++L){if(!M(O[L])){K.push(O[L])}else{}}return K}function k(K){if(!K){throw new Error("Null entity descriptor")}return H.get(K,function(L){return u.getObject(L.type,L.id)})}function d(L){return H.getAllBulk(L,function K(M){var N=[];A.each(M,function(){N.push(this.type);N.push(this.id)});return u.runQuery(function(O){return O.jive.corev3.contents.getByEntityDescriptor({entityDescriptor:N.join(",")})})})}function s(K){return K}function t(K){return u.runQuery(function(L){return L.jive.corev3.outcomes.get({uri:K})})}function z(L,N,K){var O=L.join(","),M={filters:"outcomeType("+O+")",count:N,hidden:!!K};return u.runQuery(function(P){return P.jive.corev3.outcomes.get(M)})}function w(K){return k(K).then(function(L){if(L.getOutcomeTypes){return u.runQuery(L.getOutcomeTypes())}else{return A.when([])}}).then(s)}function o(K){return k(K).then(x)}function x(K){return h.get(K,function(L){if(L.getOutcomes){return u.runQuery(L.getOutcomes())}else{return A.when([])}}).then(s)}function j(K){return k(K).then(function(L){return A.when(L,x(L))})}function g(K,M){if(!M){M="outcomes"}var L=h.getAllBulk(K,function(O){var N=[];A.each(O,function(){if(this.getOutcomes){N.push(this.getOutcomes())}});return u.runAll(N).then(u.squashBatchLists)});return L.then(function(N){for(var O=0;O<K.length;++O){K[O][M]=N[O]}A.each(K,function(){var P=this;A.each(P[M],function(R,S){var Q=S.outcomeType.name.toLowerCase();P[M][Q]=S})});return K})}function c(K){return u.runQuery(K.getHistory())}function p(K){var L=0,N;if(K.replyCount){L=K.replyCount}var M={hierarchical:false,filter:"likeCount("+L+")",fields:"@most_liked"};if(K.getReplies){N=K.getReplies(M)}else{if(K.getComments){N=K.getComments(M)}}return N}function m(L,K){var O=K.join(","),M={filter:"outcomeType("+O+")",hierarchical:false,fields:"@outcome_replies"},N;if(L.getReplies){N=L.getReplies(M)}else{if(L.getComments){N=L.getComments(M)}}return N}function v(K,M){var L=[];A.each(K,function(){L.push(this[M].get())});return u.runAll(L).then(function(O){for(var N=0;N<K.length;++N){K[N][M]=O[N]}return K})}function i(K){if(K.properties&&K.properties.approvers){var L=K.properties.approvers.map(function(M){return function(N){return N.jive.corev3.people.get({uri:M,fields:"@summary"})}});return u.runAll(L).then(function(M){K.properties.alertedUsers=M;return K})}return A.when(K)}function D(K){if(K.properties&&K.properties.share){return u.runQuery(function(L){return L.jive.corev3.shares.get({uri:K.properties.share})}).then(function(L){K.properties.outcomeShare=L;return K})}return A.when(K)}function n(K,N,M,L){return k(K).then(function(O){return u.runQuery(O.createOutcome(f(N,M,L))).done(function(){h.clear(O)})}).then(function(O){return v([O],"user")}).then(function(O){return O[0]})}function I(K,N,O,M,L){return u.runQuery(N.createOutcome(f(O,M,L))).done(function(){k(K).done(function(P){h.clear(P)})}).then(function(P){return v([P],"user")}).then(function(P){return P[0]})}function q(K,N,O,M,L){return j(K).then(function(P,R){var Q=null;A.each(R,function(){if(this.outcomeType.name==N.name){Q=this}});if(!Q){return l()}Q.properties=A.extend(Q.properties,L);return u.runQuery(Q.update()).then(function(S){h.clear(P);return S})})}function G(K,L){return j(K).then(function(N,O){h.clear(N);var M=null;A.each(O,function(){if(this.outcomeType.name.toLowerCase()==L.name.toLowerCase()){M=this;return false}return true});if(!M){return l()}return u.runQuery(M.destroy())})}function J(L,K){return k(L).then(function(M){if(M.getChildOutcomeTypes){return u.runQuery(M.getChildOutcomeTypes({isCreate:!!K})).then(s)}else{return[]}})}function r(K){return A.when(k(K),J(K)).then(function(L,N){var M=[];A.each(N,function(){var O=this.name.toLowerCase(),P=m(L,[O]);if(P){M.push(u.runQuery(P).then(u.slurp).then(function(R){var Q={};Q[O]=R.length;return Q}))}});M.push(x(L));return A.when.apply(A,M)}).then(function(){var M={};if(arguments.length>1){M=A.extend.apply(A,[{}].concat(Array.prototype.slice.call(arguments,0,arguments.length-1)))}var L=arguments[arguments.length-1];A.each(L,function(){var N=this.outcomeType.name.toLowerCase();if(M[N]!=null){M[N]+=1}});return M})}function F(K){return k(K).then(function(L){var M=p(L);if(M){return u.runQuery(M).then(u.slurp)}else{return{}}})}function E(L,K){var M=m(L,K);if(M){return u.runQuery(m(L,K)).then(u.slurp)}else{return{}}}function e(K){K=B(K);return d(K).then(function(L){var M=[];A.each(L,function(){if(this.getOutcomes){M.push(this.getOutcomes())}});return u.runAll(M)}).then(u.squashBatchLists).then(function(L){var M=[];A.each(L,function(N,O){M.push({ed:K[N],outcomes:O})});return M})}function y(){h.clearAll()}function C(){H.clearAll()}function l(){var L=A.Deferred();var M=jive.i18n.keys.outcomesErrorMissing();var K={error:{code:409,message:M}};L.reject(K);return L.promise()}return{getOutcome:t,getOutcomeHistory:c,getOutcomeTypes:w,getDescendantOutcomeTypes:J,getOutcomes:o,getOutcomesForObj:x,getAllOutcomes:g,getFullUsers:v,getApproverUsers:i,getShare:D,createOutcome:n,createSuccessorOutcome:I,destroyOutcome:G,updateOutcome:q,getOutcomeCounts:r,getObject:k,getRepliesByOutcomeTypes:E,getMostLikedReplies:F,getOutcomesForEntities:e,clearCache:y,getUserOutcomes:z,clearEntityCache:C}});
;
define("apps/outcomes/shareModel",["jquery","apps/shared/models/core_deferred","apps/shared/models/promise_cache"],function(e,a,c){function b(g,h,f){return{content:{text:h,type:"text/html"},shared:g,participants:f}}function d(g,i,f){var h=b(g,i,f);return a.runQuery(function(j){return j.jive.corev3.shares.create(h)})}return{createShare:d}});
;
define("apps/outcomes/shareMain",["jquery","apps/shared/controllers/localexchange","apps/outcomes/shareModel","apps/outcomes/outcomesModel"],function(e,b,f,a){function d(g,h){if(!h.properties||!h.properties.message||!h.properties.approvers||!h.properties.shared){return}if(h.properties.share){return}f.createShare(h.resources.self.ref,h.properties.message,h.properties.approvers).done(function(i){return c(g,h,i)})}function c(g,j,i){var h=j.properties;h.message="";h.share=i.resources.self.ref;return a.updateOutcome(g,j.outcomeType,null,null,h)}b.addListener("outcome.created",d);b.addListener("outcome.updated",d);return{createShare:d}});
;
define("apps/outcomes/outcomesMain",["jquery","underscore","apps/shared/controllers/localexchange","apps/shared/controllers/switchboard","apps/outcomes/outcomesModel","apps/outcomes/shareMain"],function(w,L,f,G,c){function i(O,U,N,M,Q,P,T){var S;var R;if(U.outcomeType){S=c.getOutcome(U.predecessor.url).then(function(V){return c.createSuccessorOutcome(O,V,U.outcomeType,Q,P).done(function(){var W=V.outcomeType;R=V;G.emit("outcome.deleted",O,W);f.emit("outcome.deleted",O,W)})})}else{S=c.createOutcome(O,U,Q,P)}S.done(function(V){var W=R&&V.outcomeType.id==R.outcomeType.id&&V.user.id!=R.user.id;G.emit("outcome.created",O,V,W);f.emit("outcome.created",O,V,W)}).fail(function(V){console.log("Failed to create",V);n(V);f.emit("outcome.refresh",[O])});if(T){T.proxy(S)}return S}function D(N,Q,S,P,O,R){var M=c.destroyOutcome(N,Q).done(function(){G.emit("outcome.deleted",N,Q);f.emit("outcome.deleted",N,Q)}).fail(function(T){console.log("Failed to delete",T);n(T);f.emit("outcome.removeBadge",N,Q);f.emit("outcome.refreshSummary")});if(R){R.proxy(M)}return M}function x(N,R,T,Q,P,O,S){var M=c.updateOutcome(N,R,T,Q,O).done(function(U){if(!O){O.shared=U.properties.shared}G.emit("outcome.updated",N,U,O.shared);f.emit("outcome.updated",N,U,O.shared)}).fail(function(U){console.log("Failed to update",U);n(U);f.emit("outcome.removeBadge",N,R);f.emit("outcome.refreshSummary")});if(S){S.proxy(M)}return M}function F(M){c.getObject(M).done(function(N){if(E(N)){c.getOutcomeCounts(M).done(function(O){c.getMostLikedReplies(M).done(function(P){f.emit("outcome.summary",M,O,P,N)})})}})}function l(M,N){N.proxy(c.getOutcomes(M))}function h(M,N){N.proxy(c.getOutcomeHistory(M))}function m(M,N){N.proxy(c.getObject(M))}function H(M,P,O){var N;c.getObject(M).then(function(Q){N=Q.subject;return w.when(c.getRepliesByOutcomeTypes(Q,[P]),c.getOutcomesForObj(Q),Q)}).then(function(T,Q,R){for(var S=0;S<Q.length;++S){if(Q[S].outcomeType.name.toLowerCase()==P){T.unshift(R)}}return c.getFullUsers(T,"author")}).then(function(Q){return c.getAllOutcomes(Q,"outcomes")}).done(function(Q){f.emit("outcome.rolledup",P,Q,O,N)})}function p(O,N,M){c.getFullUsers(O,"author").done(function(P){f.emit("mostLiked.rolledup",P,N,M)})}function K(M){f.emitP("outcome.clearBadges",M).then(function(){c.getOutcomesForEntities(M).done(function(N){w.each(N,function(){var O=this.ed;w.each(this.outcomes,function(){if(!e(this)){f.emit("outcome.display",O,this)}})})})})}function e(M){return M.outcomeType.alternativeGrouping=="true"}function C(M,N){N.proxy(c.getObject(M).then(function(O){var P=[];if(O.correctAnswer){P.push(new r(O,"correctAnswer",M))}return P}))}function B(M,N){N.proxy(c.getObject(M).then(function(O){var P=[];if(O.destroy){P.push(new r(O,"delete",M))}if(O.update){P.push(new r(O,"edit",M))}return P}))}function J(M,N){N.proxy(c.getDescendantOutcomeTypes(M))}function g(M,N){N.proxy(c.getDescendantOutcomeTypes(M,true))}function s(O,N){var M=[];w.each(O,function(){if("true"!==this.alternativeGrouping){M.push(new r(this,"post",N))}});return M}function v(M,N){N.proxy(w.when(c.getOutcomeTypes(M),c.getOutcomes(M)).then(function(P,Q){var O=s(P,M);w.each(Q,function(){if(this.destroy){O.push(new r(this.outcomeType,"delete",M))}else{O.push(new r(this.outcomeType,"get",M))}if(this.update){O.push(new r(this.outcomeType,"put",M))}});return O}))}function k(M,N){N.proxy(c.getOutcomeTypes(M).then(function(O){return s(O,M)}))}function b(N){var M=[];if(d(N)){M.push(new r(N.outcomeType,"delete",null))}if(N.createOutcome&&N.successorOutcomeTypes){w.each(N.successorOutcomeTypes,function(){M.push(new r(this,"post",N))})}return new w.Deferred().resolve(M)}function d(N){var M=N.outcomeType.name!="resolved"&&N.successorOutcomeTypes.length;var O=N.successorOutcomeTypes[0]==null;return N.destroy&&(M||O)}function o(M,N){return N.proxy(c.getOutcome(M).then(b))}function q(M){return c.getApproverUsers(M).then(function(N){return c.getShare(N)})}function A(M,N){N.proxy(c.getOutcome(M).then(function(O){return w.when(q(O),b(O))}))}function u(M,N){N.proxy(c.getOutcome(M).then(function(O){return c.getApproverUsers(O)}))}function z(M,N){N.proxy(c.getObject(M).then(function(O){return O.subject}))}function j(M){M.proxy(c.getUserOutcomes(["pending"],2,true))}function a(M){f.emit("outcome.refreshSummary")}function t(){c.clearCache()}function y(){c.clearEntityCache()}function I(M,N){f.emit("outcome.display",M,N);f.emit("outcome.refreshSummary")}G.addListener("outcome.created",I);G.addListener("outcome.updated",function(M,N){f.emit("outcome.removeBadge",M,N.outcomeType);f.emit("outcome.display",M,N)});G.addListener("outcome.deleted",function(M,N){f.emit("outcome.removeBadge",M,N);f.emit("outcome.refreshSummary")});G.addListener("acclaim.recorded.like",function(){f.emit("outcome.refreshSummary")});function n(N){if(N&&N.error&&N.error.message){var M=N.error.code&&N.error.code==404?jive.i18n.keys.outcomesErrorMissing():N.error.message;$j("<p>"+M+"</p>").message({style:"error"})}else{$j(jive.error.rest.soy.errorSaving({href:window.location})).message({showClose:true,style:"error"})}f.emit("outcome.resync")}function E(M){return !M.restrictReplies||!M.restrictComments}function r(N,O,M){this.subject=N;this.verb=O;this.context=M}f.addListener("outcome.post",i);f.addListener("outcome.delete",D);f.addListener("outcome.put",x);f.addListener("outcome.summarize",F);f.addListener("outcome.get",l);f.addListener("outcome.getHistory",h);f.addListener("outcome.getContentObject",m);f.addListener("outcome.refresh",K);f.addListener("outcome.rollup",H);f.addListener("outcome.rollupMostLiked",p);f.addListener("outcome.getOutcomeActions",v);f.addListener("outcome.getOutcomeCreateActions",k);f.addListener("outcome.prepareForBadgePopup",A);f.addListener("outcome.prepareOutcomeDetails",u);f.addListener("outcome.prepareForShareActionPopup",z);f.addListener("outcome.prepareActionTooltip",j);f.addListener("outcome.getOutcomeUrlActions",o);f.addListener("outcome.getContentObjectActions",B);f.addListener("outcome.getAdditionalContentObjectActions",C);f.addListener("outcome.getDescendantOutcomeTypes",J);f.addListener("outcome.getDescendantOutcomeTypesForCreate",g);f.addListener("commentDeleted",a);f.addListener("outcome.clearCache",t);f.addListener("outcome.clearEntityCache",y);return{create:i,summarize:F,history:history,refresh:K,rollup:H,rollupMostLiked:p}});
;
goog.provide("jive.outcomes.history.showLink");jive.outcomes.history.showLink=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<a href="#" class="font-color-meta j-outcome-modal-footer-link j-outcome-history-link js-outcome-history-link">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.history.link"),[])),"</a>");return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.history.item");
jive.outcomes.history.item=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-outcome-history-item">');if(opt_data.item.ownerChanged)output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.history.ownerChanged"),[]))," ");else{jive.outcomes.badge.badgeRaw({outcomeType:opt_data.item.outcomeType.name,embedded:true,tagName:"span"},output);output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.history.marked"),[])),
" ")}output.append('<span class="j-outcome-reply-author">');jive.shared.displayutil.userDisplayNameLink(soy.$$augmentMap(opt_data.item.user,{anonymous:false}),output);output.append('</span> <span class="font-color-meta">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.history.date"),[(opt_data.item.creationDate?jive.model.DateUtil.parseISODateTime(opt_data.item.creationDate):"")?_jive_moment(parseFloat(opt_data.item.creationDate?jive.model.DateUtil.parseISODateTime(opt_data.item.creationDate):
"")?parseFloat(opt_data.item.creationDate?jive.model.DateUtil.parseISODateTime(opt_data.item.creationDate):""):opt_data.item.creationDate?jive.model.DateUtil.parseISODateTime(opt_data.item.creationDate):"").add(_jive_timezoneoffset*60*60*1E3).lang(_jive_locale.toLowerCase().replace("_","-")).format("lll"):""])),'</span><p class="j-outcome-history-note">',soy.$$escapeHtml(opt_data.item.note),"</p><br></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.history.showPopup");
jive.outcomes.history.showPopup=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-outcome-badge-popup j-outcome-popup j-pop-main" style="display: block;"><div class="j-outcome-history-items"><div class="j-outcome-history-title">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.history.title"),[]))," ",soy.$$escapeHtml(opt_data.subject),"</div>");if(opt_data.alertedNames){output.append('<div class="j-outcome-approvers font-color-meta"><strong>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.badge.popup.approversLabel"),
[])),"</strong> ");jive.shared.displayutil.itemList({items:opt_data.alertedNames,expandable:true},output);output.append("</div>")}var itemList17=opt_data.items;var itemListLen17=itemList17.length;for(var itemIndex17=0;itemIndex17<itemListLen17;itemIndex17++){var itemData17=itemList17[itemIndex17];jive.outcomes.history.item({item:itemData17},output)}output.append('</div><footer class="j-outcome-modal-footer j-pop-row j-last"><a href="#" class="js-outcome-done-button j-outcome-modal-footer-link">',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.history.done"),[])),"</a></footer></div>");return opt_sb?"":output.toString()};
;
(function(c){var a=0;var b="__generated_id_";c.fn.id=function(d){if(!this.length){return""}var e=this.first();if(d){e.attr("id",d);return this}else{var f=e.attr("id");if(f){return f}else{d=b+a;++a;e.attr("id",d);return d}}}})(jQuery);
;
goog.provide("jive.shared.displayutil.itemListMore");jive.shared.displayutil.itemListMore=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.shared.displayutil.plainItemList(opt_data,output);output.append(' <a href="#" class="j-item-list-showFewer js-item-list-showFewer">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("itemList.showFewer"),[])),"</a>");return opt_sb?"":output.toString()};
;
define("apps/shared/views/itemList",["jquery","jive/accessibility"],function(f,b){function a(i){i.preventDefault();var j=f(this).closest(".js-item-list"),h=j.data("items"),g=template=jive.shared.displayutil.itemListMore({items:h});j.data("oldHtml",j.html()).html(g);b.focusIn(j)}function d(h){h.preventDefault();var i=f(this).closest(".js-item-list"),g=i.data("oldHtml");i.html(g);b.focusIn(i)}function e(g){g.on("click",".js-item-list-showMore",a).on("click",".js-item-list-showFewer",d)}function c(g){var h=f(jive.shared.displayutil.itemList({items:g,expandable:true}));e(h);return h}return{bindHandlers:e,makeList:c}});
;
define("apps/outcomes/historyView",["jquery","apps/shared/controllers/localexchange","apps/shared/views/itemList","apps/outcomes/outcomesMain"],function(e,d,b){function g(j){if(j){j.preventDefault()}var i=e(this);var h=i.data("originalContext");if(!h){h=i}if(i.data("outcome")){a(h,i.data("outcome"),i.data("alertedNames"),i.data("targetEd"))}else{console.log("History link is missing an entity descriptor: ",i)}}function a(h,j,k,i){d.emitP("outcome.getHistory",j).then(function(l){d.emitP("outcome.getContentObject",i).then(function(n){var u=[];var m={};var s;var t;var q;l.forEach(function(w){q=w.user;var v=$j.extend(true,{},w);if(t&&q.id!=t.id){u.push($j.extend(true,w,{ownerChanged:true}))}t=q;s=v.outcomeType;if(s.id!=m.id){u.push(v)}m=s});var o={items:u,alertedNames:k,subject:n.subject};o.items.forEach(function(v){v.note=e("<div>"+v.note+"</div>").text()});var r=jive.outcomes.history.showPopup(o);var p=e(r).popover({context:h,onClose:function(){h.removeAttr("aria-owns")},hoverSelection:false});p.find(".js-outcome-done-button").on("click",function(v){p.trigger("close")});h.attr("aria-owns",p.id());d.emit("outcome.history.popoverDisplayed",j);b.bindHandlers(p)})})}function c(k,l,m,j,h){if(k.predecessorOutcome){var i=e(jive.outcomes.history.showLink());i.data("outcome",k);i.data("alertedNames",l);i.data("originalContext",h);i.data("targetEd",j);m.append(i);d.emit("outcome.history.linkDisplayed",k)}}function f(h,i){i.find(".js-outcome-history-link").safeRemove()}d.addListener("outcome.history.displayLink",c);d.addListener("outcome.history.removeLink",f);return{display:c,remove:f,clickHandler:g}});
;
goog.provide("jive.outcomes.summary.avatar");jive.outcomes.summary.avatar=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.shared.displayutil.avatar(soy.$$augmentMap(opt_data.user,{enabled:opt_data.user.jive.enabled,partner:opt_data.user.jive.externalContributor,username:opt_data.user.jive.username,visible:opt_data.user.jive.visible,anonymous:false,prop:null,avatarID:0,size:32,hideTooltip:true}),output);return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.mostLiked.reply");
jive.outcomes.mostLiked.reply=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-outcome-badge-popup"><div class="outcome-byline">',opt_data.reply.likeCount==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.mostLiked.likes_singular"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.mostLiked.likes_plural"),[opt_data.reply.likeCount])),'</div></div><div class="j-outcome-rollup-reply"><div class="j-outcome-reply-avatar">');if(opt_data.reply.author)jive.outcomes.summary.avatar({user:opt_data.reply.author},
output);else jive.shared.displayutil.avatar({anonymous:true,enabled:true,partner:false,username:"guest",id:0,ID:0,displayName:"",visible:true,prop:null,avatarID:0,size:32},output);output.append('</div><div class="j-outcome-reply-box"><p class="j-outcome-reply-byline jive-comment-meta font-color-meta">');if(opt_data.reply.author)jive.shared.displayutil.userDisplayNameLink(soy.$$augmentMap(opt_data.reply.author,{anonymous:false}),output);else jive.shared.displayutil.userDisplayNameLink({anonymous:true,
enabled:true,username:"guest",id:0,displayName:"",visible:true},output);output.append(' <a href="',soy.$$escapeHtml(opt_data.reply.resources.html.ref),'" class="j-outcome-reply-date font-color-normal js-outcome-reply-incontext">',soy.$$escapeHtml((opt_data.reply.updated?jive.model.DateUtil.parseISODateTime(opt_data.reply.updated):"")?_jive_moment(parseFloat(opt_data.reply.updated?jive.model.DateUtil.parseISODateTime(opt_data.reply.updated):"")?parseFloat(opt_data.reply.updated?jive.model.DateUtil.parseISODateTime(opt_data.reply.updated):
""):opt_data.reply.updated?jive.model.DateUtil.parseISODateTime(opt_data.reply.updated):"").add(_jive_timezoneoffset*60*60*1E3).lang(_jive_locale.toLowerCase().replace("_","-")).format("lll"):""),'<span class="j-in-context font-color-meta-light"> (',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.summary.rollup.inContext"),[])),')</span></a></p><div class="j-outcome-reply-body js-outcome-reply-body">',soy.$$filterNoAutoescape(opt_data.reply.content.text),'</div><div class="j-outcome-more js-outcome-more" style="display:none;"><a class="j-rc3 font-color-meta" href=\'#\'>',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.more"),[])),"</a></div></div></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.mostLiked.rollup");
jive.outcomes.mostLiked.rollup=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-outcome-rollup jive-modal-wide"><h3 class="j-outcome-rollup-title">');jive.outcomes.badge.badgeRaw({outcomeType:"mostLiked",embedded:true,tagName:"span"},output);output.append("<b>",soy.$$filterNoAutoescape(opt_data.tloSubject),'</b></h3><div class="j-outcome-rollup-replies">');var replyList12=opt_data.replies;var replyListLen12=replyList12.length;for(var replyIndex12=0;replyIndex12<
replyListLen12;replyIndex12++){var replyData12=replyList12[replyIndex12];jive.outcomes.mostLiked.reply({reply:replyData12},output)}output.append('</div><div class="j-outcome-done-block j-rc5 j-rc-none-top"><a href="#" class="js-outcome-done-button j-btn-global">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.summary.done"),[])),"</a></div></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.mostLiked.pseudoBadge");
jive.outcomes.mostLiked.pseudoBadge=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<li class="js-outcome-summary-count j-outcome-summary-count js-mostLiked j-most-liked" tabindex="0" role="button" aria-haspopup="true"><a class="js-outcome-count-block j-outcome-count-block" href="#">');jive.outcomes.badge.badgeRaw({outcomeType:"mostLiked",embedded:true,tagName:"span"},output);output.append("</a></li>");return opt_sb?"":output.toString()};
;
define("apps/outcomes/mostLikedView",["jquery","apps/shared/controllers/localexchange","apps/outcomes/viewUtil","apps/outcomes/outcomesMain"],function(d,a,c){function f(g){return g.length>0}function b(j,i,g){if(f(i)){var h=d(jive.outcomes.mostLiked.pseudoBadge({}));j.find(".js-mostLiked").remove();j.append(h)}}function e(l,j,h){var k=jive.outcomes.mostLiked.rollup({replies:l,tloSubject:j});var i={context:h,returnPopover:true,hoverSelection:false,onClose:function(){h.removeAttr("aria-owns")}};var m=d(k).popover(i);h.attr("aria-owns",m.id());function g(o){var p=o.hasClass("j-js-expanded");if(!p){o.addClass("j-js-expanded")}var n=o.height();if(!p){o.removeClass("j-js-expanded")}return n}m.find(".js-outcome-reply-body").each(function(){var n=d(this);if(g(n)>150){n.next(".js-outcome-more").show()}});m.find(".js-outcome-more").on("click",function(n){d(this).hide().prev(".js-outcome-reply-body").addClass("j-js-expanded");n.preventDefault()});m.find(".js-outcome-done-button").on("click",function(n){i.closeFunc();n.preventDefault()});a.emit("renderedContent",m);a.emit("mostLiked.rollupDisplayed",l)}a.addListener("mostLiked.rolledup",e);a.addListener("mostLiked.badge",b);return{mostLikedRollup:e,mostLikedBadge:b}});
;
define("apps/outcomes/badgeHelper",["jquery"],function(f){var d=["outdated","official","finalized","wip"];var a=false;function g(){a=true}function c(){a=false}function b(h){if(a&&d.indexOf(h)!=-1){return true}return false}function e(j,i){var h=j.outcomeType.name.toLowerCase();if(a&&d.indexOf(h)>-1){return jive.outcomes.badge.headerOutcomeBadge({outcome:j,customBadgeTemplate:i})}else{return jive.outcomes.badge.outcomeBadge({outcome:j,customBadgeTemplate:i})}}return{isHeaderBadge:b,getBadge:e,enableHeaderBadges:g,disableHeaderBadges:c}});
;
define("apps/outcomes/badgeView",["jquery","apps/shared/controllers/localexchange","apps/outcomes/viewUtil","apps/shared/views/itemList","apps/outcomes/badgeHelper","apps/outcomes/outcomesMain"],function(h,b,o,n,d){function c(t,s,u){return o.placeItem(t,s,u,function(w,v){return w.find(".js-outcome-badge.js-outcome-type-"+v)})}function p(t,w){var u=w.outcomeType.name.toLowerCase();var x=h(".js-outcome-badge-container.js-ed-"+t.type+"-"+t.id);var v=x.data("customBadgeTemplate");var s=d.getBadge(w,v);x=j(x,u);x=x.not(":has(.js-outcome-type-"+u+")");c(x,s,u).data("outcome",w.resources.self.ref).data("ed",t);if(d.isHeaderBadge(u)){r(x)}b.emit("outcome.displayed",t,w)}function l(t,u,w){var s=jive.outcomes.badge.fakeOutcomeBadge({outcomeTypeName:u});var v=h(".js-outcome-badge-container.js-ed-"+t.type+"-"+t.id);v=j(v,u);c(v.not(":has(.js-outcome-badge.js-outcome-type-"+u+")"),s,u);w.emitSuccess(v.find(".js-outcome-badge.js-outcome-type-"+u))}function f(s,u){var t=u.name.toLowerCase();var v=h(".js-outcome-badge-container.js-ed-"+s.type+"-"+s.id);v.find(".js-outcome-badge.js-outcome-type-"+t).safeRemove()}function q(t,s){h.each(t,function(){var u=this;var v=h(".js-outcome-badge-container.js-ed-"+u.type+"-"+u.id);if(!v.hasClass("js-outcome-badge-container-top")){v.find(".js-outcome-badge").safeRemove()}});if(s){s.emitSuccess()}}function g(s){s=s||document;var t=[];h(".js-outcome-badge-container",s).not("[data-no-hydrate]").each(function(){t.push(o.getEd(this))});b.emit("outcome.refresh",t)}function k(s){if(s){s.preventDefault()}var t=h(this);if(t.data("outcome")&&t.data("ed")){a(t,t.data("ed"),t.data("outcome"))}else{console.log("badge is missing outcome or entity descriptor data: ",t)}}function m(v,u,t,s){this.labelSuffix=v;this.event=u;this.actionData=t;this.href=s}function r(u){var t=u.find("li");var s=$j(".js-outcome-badge-container-top > li > .j-outcome-badge-popup");if(!(s.length>0)){if(t.data("outcome")&&t.data("ed")){b.emitP("outcome.prepareForBadgePopup",t.data("outcome")).then(function(z,A){var y=o.buildLinkActions(A);var v=e(z.updated);var x={outcomeTypeName:z.outcomeType.name.toLowerCase(),author:z.user,modifiedDate:v,actions:y,props:z.properties};x=i(z,x);var w=jive.outcomes.badge.headerBadgePopup(x);t.append(w);t.on("click",".js-actionLink",function(C){C.preventDefault();var D=h(this);var E=t.closest(".js-outcome-badge-container");var B=o.getEd(E);b.emit("outcome.doAction",D.data("event"),B,D.data("actionData"),E)})})}}}function e(t){var s=new Date(t).getTimezoneOffset()/60;if(s>0){return t.replace("0000",s>9?s:"0"+s)}else{return t.replace("+0000",s<-9?s:"-0"+-s)}}function i(t,s){if(t.note){s.comment=h("<div/>").html(t.note).text()}if(t.properties){var v=[];if(t.properties.alertedUsers){h.each(t.properties.alertedUsers,function(x,w){v.push(w.displayName)});s.alertedNames=v}if(t.outcomeType.name=="pending"){if(v.length==0){v.push(t.user.displayName);s.alertedNames=v}if(t.properties.outcomeShare){if(document.URL!=t.properties.outcomeShare.resources.html.ref){var u=t.outcomeType.name.toLowerCase()+".view";s.shareLink=new m(u,null,null,t.properties.outcomeShare.resources.html.ref)}}else{if(t.update){var u=t.outcomeType.name.toLowerCase()+".put";s.shareLink=new m(u,"outcome.put",JSON.stringify(t.outcomeType),null)}}}}return s}function a(u,s,t){if(u.attr("aria-owns")){h("#"+u.attr("aria-owns")).trigger("close")}else{b.emitP("outcome.prepareForBadgePopup",t).then(function(A,B){var z=_.filter(B,function(C){if(h.inArray(C.subject.name,["decision","success"])!=-1){return true}return C.verb!="delete"});var y=o.buildLinkActions(z);var w={outcomeTypeName:A.outcomeType.name.toLowerCase(),author:A.user,modifiedDate:A.updated,actions:y,props:A.properties};w=i(A,w);var v=jive.outcomes.badge.badgePopup(w);var x=h(v).popover({context:u,hoverSelection:true,onClose:function(){u.removeAttr("aria-owns")},hoverSelection:false});b.emit("outcome.history.displayLink",A,w.alertedNames,x.find(".j-outcome-modal-footer"),s,u);b.addListener("outcome.history.popoverDisplayed",function(){x.trigger("close")});u.attr("aria-owns",x.id());n.bindHandlers(x);x.on("click",".js-actionLink",function(D){D.preventDefault();var E=h(this);var F=h(u).closest(".js-outcome-badge-container");var C=o.getEd(F);b.emit("outcome.doAction",E.data("event"),C,E.data("actionData"),u);E.trigger("close")})})}}function j(t,s){t=t.filter(function(){var u=h(this).data("allowedOutcomeTypes");return !u||u.indexOf(s)>=0});return t}b.addListener("outcome.display",p);b.addListener("outcome.displayFake",l);b.addListener("outcome.removeBadge",f);b.addListener("outcome.clearBadges",q);return{display:p,removeBadge:f,refresh:g,clickHandler:k}});
;
goog.provide("jive.outcomes.summary.summaryCount");
jive.outcomes.summary.summaryCount=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<li class="js-outcome-summary-count j-outcome-summary-count js-outcome-type-',soy.$$escapeHtml(opt_data.outcomeType)," j-outcome-type-",soy.$$escapeHtml(opt_data.outcomeType),'" tabindex="0" role="button" aria-haspopup="true" data-outcome-type="',soy.$$escapeHtml(opt_data.outcomeType),'" data-count="',soy.$$escapeHtml(opt_data.count),'" aria-label="',soy.$$escapeHtml(opt_data.outcomeType),
'"><a class="js-outcome-count-block j-outcome-count-block" href="#"><span class="j-outcome-count">',soy.$$escapeHtml(opt_data.count),"</span>");jive.outcomes.badge.badgeRaw({outcomeType:opt_data.outcomeType,embedded:true,tagName:"span"},output);output.append("</a></li>");return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.summary.detailsLinks");
jive.outcomes.summary.detailsLinks=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.outcome.note||opt_data.outcome.properties&&opt_data.outcome.properties.approvers?'<div class="j-outcome-link-container"><a class="j-outcome-link-details js-outcome-link-details js-outcome-link" href="#" data-outcome-url="'+soy.$$escapeHtml(opt_data.outcome.resources.self.ref)+'">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.summary.details"),[]))+'</a><a class="j-outcome-link-incontext js-outcome-link-incontext js-outcome-link" href="'+
soy.$$escapeHtml(opt_data.contextUrl)+'" style="display:none;">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.summary.rollup.inContext"),[]))+"</a></div>":"");return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.helpful.msgHelpfulCount");
jive.outcomes.helpful.msgHelpfulCount=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(parseInt(opt_data.helpfulCount,10)>0?opt_data.displayOverall?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("acclaim.helpful.count"),[opt_data.helpfulCount,opt_data.overallCount])):parseInt(opt_data.helpfulCount,10)==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("acclaim.just.helpful.count.singular"),[opt_data.helpfulCount])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("acclaim.just.helpful.count.plural"),
[opt_data.helpfulCount])):"");return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.summary.rollupReply");
jive.outcomes.summary.rollupReply=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-outcome-badge-popup">');jive.outcomes.summary.detailsLinks({outcome:opt_data.reply.outcomes[opt_data.outcomeTypeName],contextUrl:opt_data.reply.resources.html.ref},output);jive.outcomes.badge.badgeByline({outcomeTypeName:opt_data.outcomeTypeName,author:opt_data.reply.outcomes[opt_data.outcomeTypeName].user,modifiedDate:opt_data.reply.outcomes[opt_data.outcomeTypeName].updated},output);
output.append('<div class="j-outcome-details js-outcome-details" style="display:none;"></div></div><div class="j-outcome-rollup-reply"><div class="j-outcome-reply-avatar">');if(opt_data.reply.author)jive.outcomes.summary.avatar({user:opt_data.reply.author},output);else jive.shared.displayutil.avatar({anonymous:true,enabled:true,partner:false,username:"guest",id:0,ID:0,displayName:"",visible:true,prop:null,avatarID:0,size:32},output);output.append('</div><div class="j-outcome-reply-box"><p class="j-outcome-reply-byline jive-comment-meta font-color-meta">');
if(opt_data.reply.author)jive.shared.displayutil.userDisplayNameLink(soy.$$augmentMap(opt_data.reply.author,{anonymous:false}),output);else jive.shared.displayutil.userDisplayNameLink({anonymous:true,enabled:true,username:"guest",id:0,displayName:"",visible:true},output);output.append(' <a href="',soy.$$escapeHtml(opt_data.reply.resources.html.ref),'" class="j-outcome-reply-date font-color-normal js-outcome-reply-incontext">',soy.$$escapeHtml((opt_data.reply.updated?jive.model.DateUtil.parseISODateTime(opt_data.reply.updated):
"")?_jive_moment(parseFloat(opt_data.reply.updated?jive.model.DateUtil.parseISODateTime(opt_data.reply.updated):"")?parseFloat(opt_data.reply.updated?jive.model.DateUtil.parseISODateTime(opt_data.reply.updated):""):opt_data.reply.updated?jive.model.DateUtil.parseISODateTime(opt_data.reply.updated):"").add(_jive_timezoneoffset*60*60*1E3).lang(_jive_locale.toLowerCase().replace("_","-")).format("lll"):""),'<span class="j-in-context font-color-meta-light"> (',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.summary.rollup.inContext"),
[])),")</span></a>");if(opt_data.reply.helpfulCount){output.append('<span style="float:right;">');if(!opt_data.reply.unhelpfulCount)jive.outcomes.helpful.msgHelpfulCount({helpfulCount:opt_data.reply.helpfulCount,overallCount:opt_data.reply.helpfulCount,displayOverall:false},output);else jive.outcomes.helpful.msgHelpfulCount({helpfulCount:opt_data.reply.helpfulCount,overallCount:opt_data.reply.helpfulCount+opt_data.reply.unhelpfulCount,displayOverall:true},output);output.append("</span>")}output.append('</p><div class="j-outcome-reply-body js-outcome-reply-body">',
soy.$$filterNoAutoescape(opt_data.reply.content.text),'</div><div class="j-outcome-more js-outcome-more" style="display:none;"><a class="j-rc3 font-color-meta" href=\'#\'>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.more"),[])),"</a></div></div></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.summary.rollup");
jive.outcomes.summary.rollup=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-outcome-rollup jive-modal-wide"><h3 class="j-outcome-rollup-title">');jive.outcomes.badge.badgeRaw({tagName:"span",outcomeType:opt_data.outcomeType,embedded:true},output);output.append('<span class="j-outcome-rollup-title-text"> ',soy.$$filterNoAutoescape(opt_data.tloTitle),'</span></h3><div class="j-outcome-rollup-replies">');var replyList12=opt_data.replies;var replyListLen12=
replyList12.length;for(var replyIndex12=0;replyIndex12<replyListLen12;replyIndex12++){var replyData12=replyList12[replyIndex12];jive.outcomes.summary.rollupReply({reply:replyData12,outcomeTypeName:opt_data.outcomeType},output)}output.append('</div><div class="j-outcome-done-block j-rc5 j-rc-none-top"><a href="#" class="js-outcome-done-button j-btn-global">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.summary.done"),[])),"</a></div></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.badge.badgeByline");goog.provide("jive.outcomes.badge.badgeDetails");
jive.outcomes.badge.badgeByline=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-outcome-byline">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.badge.popup."+opt_data.outcomeTypeName)),[]))," ");jive.shared.displayutil.userDisplayNameLink(soy.$$augmentMap(opt_data.author,{anonymous:false}),output);output.append(' <span class="font-color-meta">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.badge.popup.datePart"),
[(opt_data.modifiedDate?jive.model.DateUtil.parseISODateTime(opt_data.modifiedDate):"")?_jive_moment(parseFloat(opt_data.modifiedDate?jive.model.DateUtil.parseISODateTime(opt_data.modifiedDate):"")?parseFloat(opt_data.modifiedDate?jive.model.DateUtil.parseISODateTime(opt_data.modifiedDate):""):opt_data.modifiedDate?jive.model.DateUtil.parseISODateTime(opt_data.modifiedDate):"").add(_jive_timezoneoffset*60*60*1E3).lang(_jive_locale.toLowerCase().replace("_","-")).format("lll"):""])),"</span></div>");
return opt_sb?"":output.toString()};
jive.outcomes.badge.badgeDetails=function(opt_data,opt_sb){opt_data=opt_data||{};var output=opt_sb||new soy.StringBuilder;output.append(opt_data.comment?'<div class="j-outcome-comment"><strong class="font-color-meta">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.badge.popup.messageLabel"),[]))+"</strong> "+soy.$$changeNewlineToBr(soy.$$escapeHtml(opt_data.comment))+"</div>":"");if(opt_data.alertedNames)jive.outcomes.badge.badgeAlertedNames(opt_data,output);return opt_sb?"":output.toString()};
;
define("apps/outcomes/summaryView",["jquery","apps/shared/controllers/localexchange","apps/outcomes/viewUtil","apps/shared/views/itemList","apps/outcomes/outcomesMain"],function(d,f,b,h){function c(k,o,m,l){var n=d("#js-outcome-summary-container-"+k.type+"-"+k.id);if(n.length&&o){d.each(o,function(q,r){if(r>0){var p=jive.outcomes.summary.summaryCount({outcomeType:q,count:r});if(0==n.children(".js-outcome-summary-count.js-outcome-type-"+q).replaceWith(p).length){b.placeItem(n,p,q,function(t,s){return t.children(".js-outcome-summary-count.js-outcome-type-"+s)},200)}}else{n.children(".js-outcome-summary-count.js-outcome-type-"+q).safeRemove()}});n.children(".js-outcome-summary-count.js-mostLiked").safeRemove();f.emit("mostLiked.badge",n,m,l.subject)}if(n.length){d(function(){n.off();n.on("click","li",function p(u){u.preventDefault();var s=d(this);if(!s.attr("data-outcome-type")){return}if(s.attr("aria-owns")){d("#"+s.attr("aria-owns")).trigger("close")}else{var t=s.data("outcomeType"),v=s.closest(".js-outcome-summary-container"),r=v.data("objectType"),q=v.data("objectId");f.emit("outcome.rollup",{id:q,type:r},t,s)}});n.on("click",".js-mostLiked",function p(r){r.preventDefault();var q=d(this);f.emit("outcome.rollupMostLiked",m.valueOf(),l.subject,q)})})}}f.addListener("outcome.summary",c);function g(o,q,l,n){var p=jive.outcomes.summary.rollup({replies:q,outcomeType:o,tloTitle:n});var m={context:l,returnPopover:true,hoverSelection:true,onClose:function(){l.removeAttr("aria-owns")}};var r=d(p).popover(m);l.attr("aria-owns",r.id());function k(t){var u=t.hasClass("j-js-expanded");if(!u){t.addClass("j-js-expanded")}var s=t.height();if(!u){t.removeClass("j-js-expanded")}return s}r.find(".js-outcome-reply-body").each(function(){var s=d(this);if(k(s)>150){s.next(".js-outcome-more").show()}});r.find(".js-outcome-more").on("click",function(s){d(this).hide().prev(".js-outcome-reply-body").addClass("j-js-expanded");s.preventDefault()});r.find(".js-outcome-done-button").on("click",function(s){m.closeFunc();s.preventDefault()});r.find("a.js-outcome-reply-incontext").on("click",function(){m.closeFunc();var s=/#.*$/.exec(d(this).attr("href"));if(s){jive.conc.nextTick(function(){jive.Accessibility.focusIn(d(s[0]))})}f.emit("outcome.expandCollapsedComments")});r.find(".js-outcome-link-incontext").on("click",function(){m.closeFunc();var s=/#.*$/.exec(d(this).attr("href"));if(s){jive.conc.nextTick(function(){jive.Accessibility.focusIn(d(s[0]))})}f.emit("outcome.expandCollapsedComments")});f.emit("renderedContent",r);f.emit("outcome.rollupDisplayed",o,q)}function i(l){if(l){l.preventDefault()}var k=d(this);if(k.data("outcomeUrl")){j(k.closest(".j-outcome-badge-popup"),k.data("outcomeUrl"))}else{console.log("link is missing outcomeUrl: ",k)}}function j(k,l){f.emitP("outcome.prepareOutcomeDetails",l).then(function(o){var q=k.find(".j-outcome-details");var n={comment:d("<div/>").html(o.note).text()};var p=[];if(o.properties.alertedUsers){d.each(o.properties.alertedUsers,function(s,r){p.push(r.displayName)});n.alertedNames=p}var m=jive.outcomes.badge.badgeDetails(n);q.append(m).slideDown();k.find(".js-outcome-link").toggle().focus();h.bindHandlers(k)})}function a(k){k=k||document;d(".js-outcome-summary-container",k).each(function(){f.emit("outcome.summarize",b.getEd(this))})}function e(k,m){var l=m.outcomeType.name.toLowerCase();if(l!="finalized"){return}f.emit("outcome.collapseComments")}f.addListener("outcome.rolledup",g);f.addListener("outcome.refreshSummary",a);f.addListener("outcome.created",e);return{summarize:a,outcomeRollup:g,clickHandler:i}});
;
goog.provide("jive.outcomes.action.actionMenuItem");
jive.outcomes.action.actionMenuItem=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<li>",opt_data.url||opt_data.event?'<a class="js-actionItem lnk '+soy.$$escapeHtmlAttribute(opt_data.extraClasses?opt_data.extraClasses:"")+'"'+(opt_data.actionData?'data-action-data="'+soy.$$escapeHtmlAttribute(opt_data.actionData)+'"':"")+(opt_data.event?'data-event="'+soy.$$escapeHtmlAttribute(opt_data.event)+'"':"")+'href="'+soy.$$filterNoAutoescape(opt_data.url?opt_data.url:"#")+
'">':'<span class="font-color-meta j-disabled-actionItem '+soy.$$escapeHtmlAttribute(opt_data.extraClasses?opt_data.extraClasses:"")+'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.actionMenu.item."+opt_data.labelSuffix)),[])),opt_data.url||opt_data.event?"</a>":"</span>","</li>");return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.action.actionMenu");
jive.outcomes.action.actionMenu=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-pop-main j-menu j-quick-menu">');if(opt_data.outcomes.length){output.append('<h4 id="action-menu-outcome-heading" class="j-menu-section-heading font-color-meta-light">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.actionMenu.outcomesHeading"),[])),'</h4><ul aria-labelledby="action-menu-outcome-heading">');var itemList9=opt_data.outcomes;var itemListLen9=
itemList9.length;for(var itemIndex9=0;itemIndex9<itemListLen9;itemIndex9++){var itemData9=itemList9[itemIndex9];jive.outcomes.action.actionMenuItem(itemData9,output)}if(opt_data.additionalActions){var itemList14=opt_data.additionalActions;var itemListLen14=itemList14.length;for(var itemIndex14=0;itemIndex14<itemListLen14;itemIndex14++){var itemData14=itemList14[itemIndex14];jive.outcomes.action.actionMenuItem(itemData14,output)}}output.append("</ul>")}if(opt_data.actions.length){output.append('<h4 id="action-menu-action-heading" class="j-menu-section-heading font-color-meta-light">',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.actionMenu.actionHeading"),[])),'</h4><ul id="action-menu-action-list" aria-labelledby="action-menu-action-heading">');var itemList23=opt_data.actions;var itemListLen23=itemList23.length;for(var itemIndex23=0;itemIndex23<itemListLen23;itemIndex23++){var itemData23=itemList23[itemIndex23];jive.outcomes.action.actionMenuItem(itemData23,output)}output.append("</ul>")}output.append(!opt_data.actions.length&&!opt_data.outcomes.length?'<div class="j-no-actions">'+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.actionMenu.emptyMessage"),[]))+"</div>":"","</div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.action.createdMessage");jive.outcomes.action.createdMessage=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<div>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.action.createdMessage."+opt_data.suffix)),[])),"</div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.action.deletedMessage");jive.outcomes.action.deletedMessage=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<div>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.action.deletedMessage."+opt_data.suffix)),[])),"</div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.action.updatedMessage");jive.outcomes.action.updatedMessage=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<div>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.action.updatedMessage."+opt_data.suffix)),[])),"</div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.action.confirmModal");
jive.outcomes.action.confirmModal=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="jive-modal jive-modal-narrow j-outcome-confirm"><header><h2 class="jive-modal-title">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.action.confirmMessage."+String(opt_data.outcomeType.name).toLowerCase()+".title")),[])),'</h2></header><a href="#" class="j-modal-close-top close">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close"),[])),
'<span class="j-close-icon j-ui-elem" role="img"></span></a><div class="jive-modal-content clearfix"><p><span class="jive-icon-med jive-icon-warn"></span><span class="j-confirm-question">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.action.confirmMessage."+String(opt_data.outcomeType.name).toLowerCase()+".question")),[])),'</span><span class="j-confirm-result">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.action.confirmMessage."+
String(opt_data.outcomeType.name).toLowerCase()+".result")),[])),'</span></p><div class="jive-form-buttons"><button type="button" name="ok" class="j-btn-callout">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.action.confirmMessage."+String(opt_data.outcomeType.name).toLowerCase()+".confirmButton")),[])),'</button><button type="button" name="cancel">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.cancel"),[])),"</button></div></div></div>");return opt_sb?
"":output.toString()};
;
goog.provide("jive.outcomes.action.markAlertModal");
jive.outcomes.action.markAlertModal=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-outcome-popup"><form name="pending-alert-form" action="#" class="j-form"><header class="j-outcome-modal-heading"><h3 class="font-color-meta">',opt_data.communityName?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.actionMenu.item."+opt_data.outcomeTypeName+".context.post")),[opt_data.communityName])):opt_data.notShareable?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.actionMenu.item."+
opt_data.outcomeTypeName+".post")),[])):opt_data.isUpdate?opt_data.isTakeOwnership?" "+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.update.title"),[]))+" ":" "+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.unresolve.title"),[]))+" ":soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.title"),[])),"</h3>",opt_data.communityName?'<span class="font-color-meta">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.actionMenu.item."+
opt_data.outcomeTypeName+".context.post.desc")),[]))+"</span>":"",'</header><div class="shareable" style="display:none"><div class="j-pending-alert-note-container js-pending-alert-note-container j-form-row"><textarea id="pending-alert-note" name="pending-alert-note" class="j-pending-alert-note" placeholder="',!opt_data.existingShare?soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.notePlaceholder.required"),[])):soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.notePlaceholder"),
[])),'"></textarea><label for="pending-alert-note"><span class="font-color-meta">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.noteDescription"),[])),"</span></label></div>",!opt_data.existingShare?'<div class="j-pending-share-target-container js-pending-share-target-container j-form-row j-rc4"><input type="checkbox" id="j-send-pending-share-checkbox" name="send-pending-share"/><label for="j-send-pending-share-checkbox" class="js-send-pending-share-label">'+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.checkboxDescription"),[]))+'</label><div class="j-pending-share j-pending-share-optional js-pending-share" style="display: none;"><div class="j-pending-share-people-picker-container js-pending-share-people-picker-container j-form-row"><input type="text" name="pending-share-users" class="j-autocomplete-input j-user-autocomplete j-ui-elem" role="combobox" placeHolder="'+soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.people.placeHolder"),
[]))+'" aria-label="'+soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.people.placeHolder"),[]))+'"/></div><label for="pending-share-message">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.shareText"),[opt_data.shareText]))+'</label><div class="j-pending-share-place-message-container js-pending-share-place-message-container"><textarea id="pending-share-message" name="pending-share-message" class="j-pending-share-message">'+
soy.$$escapeHtmlRcdata(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.shareText"),[opt_data.shareText]))+"</textarea></div></div></div>":"",'</div><div class="jive-form-element j-form-row urlAllowed" style="display:none"><label for="outdated-link">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.outdatedAlert.urlDescription"),[])),'</label><input type="hidden" id="outdated-url" name="outdated-url"/><input type="text" id="outdated-link" name="outdated-link" class="jive-form-textinput"/><p id="outdated-url-display" class="j-outdated-link-meta font-color-meta-light" name="outdated-url-display"></p></div><div class="j-form-row generalNote" style="display:none"><div class="j-note-container"><label for="outcome-note">',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.outcomeNote.noteLabel"),[])),'</label><textarea id="outcome-note" name="outcome-note" class="j-outcome-note"></textarea></div></div><footer class="j-pending-alert-footer j-pop-row j-last"><button type="submit" name="success" class="j-btn-callout">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.sendButton"),[])),'</button><button type="button" name="cancel">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.cancel"),
[])),"</button></footer></form></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.action.tloExclusionModal");
jive.outcomes.action.tloExclusionModal=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="jive-modal jive-modal-narrow j-outcome-confirm"><header><h2 class="jive-modal-title" aria-label="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.action.confirmMessage.exclusion."+String(opt_data.outcomeType.name).toLowerCase()+".title")),[])),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.action.confirmMessage.exclusion."+String(opt_data.outcomeType.name).toLowerCase()+
".title")),[])),'</h2></header><a href="#" class="j-modal-close-top close">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close"),[])),'<span class="j-close-icon j-ui-elem" role="img"></span></a><div class="jive-modal-content clearfix"><p><span class="jive-icon-med jive-icon-warn"></span><span class="j-confirm-question" id="j-confirm-question-',soy.$$escapeHtmlAttribute(String(opt_data.outcomeType.name).toLowerCase()),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.action.confirmMessage.exclusion."+
String(opt_data.outcomeType.name).toLowerCase()+".question")),[])),'</span><span class="j-confirm-result" id="j-confirm-result-',soy.$$escapeHtmlAttribute(String(opt_data.outcomeType.name).toLowerCase()),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.confirmMessage.exclusion.result"),[])),'</span></p><div class="jive-form-buttons"><button type="button" name="ok" class="j-btn-callout" aria-labelledby="j-confirm-question-',soy.$$escapeHtmlAttribute(String(opt_data.outcomeType.name).toLowerCase()),
'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.confirmMessage.exclusion.confirmButton"),[])),'</button><button type="button" name="cancel">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.cancel"),[])),"</button></div></div></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.action.pendingAssigneeModal");
jive.outcomes.action.pendingAssigneeModal=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-outcome-popup" style="width:516px;"><form name="pending-alert-form" action="#" class="j-form"><header class="j-outcome-modal-heading"><h3 class="font-color-meta">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.addContributors.title"),[])),'</h3></header><div class="j-pending-share js-pending-share j-form-row"><div class="j-pending-share-people-picker-container js-pending-share-people-picker-container"><input type="text" name="pending-share-users" class="j-autocomplete-input j-user-autocomplete j-ui-elem" role="combobox" placeHolder="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.people.placeHolder"),
[])),'" aria-label="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.people.placeHolder"),[])),'"/></div><label for="pending-share-message">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.shareText"),[opt_data.shareText])),'</label><div class="j-pending-share-place-message-container js-pending-share-place-message-container"><textarea id="pending-share-message" name="pending-share-message" class="j-pending-share-message">',
soy.$$escapeHtmlRcdata(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.shareText"),[opt_data.shareText])),'</textarea></div></div><footer class="j-pending-alert-footer j-pop-row j-last"><button type="submit" name="success" class="j-btn-callout">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.sendButton"),[])),'</button><button type="button" name="cancel">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.cancel"),[])),"</button></footer></form></div>");
return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.action.pendingAlertPermissionWarning");
jive.outcomes.action.pendingAlertPermissionWarning=function(opt_data,opt_sb){opt_data=opt_data||{};var output=opt_sb||new soy.StringBuilder;output.append('<div class="js-pending-permissionWarning j-pending-permissionWarning">',opt_data.privateContent?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.private.permissionWarning"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.permissionWarning"),[])),"</div>");return opt_sb?"":
output.toString()};
;
goog.provide("jive.outcomes.action.unknownError");jive.outcomes.action.unknownError=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<div>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.unknownError"),[])),"</div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.action.actionTooltip");
jive.outcomes.action.actionTooltip=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-outcome-tooltip-popup j-outcome-popup"><header><h5><strong>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingTooltip.title"),[])),'</strong></h5><header><div class="j-outcome-tooltip-details"><p>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingTooltip.body"),[])),'</p><a class="j-outcome-tooltip-link" href="',
soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/actions/marked"))),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingTooltip.link"),[])),'</a></div><footer class="j-outcome-modal-footer j-pop-row j-last"><a href="#" class="js-outcome-done-button">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.summary.done"),[])),"</a></footer></div>");return opt_sb?"":output.toString()};
;
define("apps/outcomes/actionView",["jquery","underscore","apps/shared/controllers/localexchange","apps/outcomes/viewUtil","apps/outcomes/outcomesMain","apps/outcomes/badgeView","apps/userpicker/main","apps/shared/views/loader_view","apps/modalizer/main"],function(h,y,c,p,q,s,m,t,o){var w=new o({width:"medium"});function e(C,B,A){this.labelSuffix=C;this.event=B;this.actionData=A}function g(A){A.sort(function(C,B){return p.outcomeTypeComparator(C.subject,B.subject)});return A}function k(J){if(J){J.preventDefault()}var A=h(this);var E={context:A,returnPopover:true,hoverSelection:true};var H=p.getEd(A),C=p.getContext(A);var N,G;if(C==="activity"){N=c.emitP("outcome.getAdditionalContentObjectActions",H).deferred();G=[]}else{N=[];G=c.emitP("outcome.getContentObjectActions",H).deferred()}var K=c.emitP("outcome.getOutcomeCreateActions",H).deferred().then(g);var F=setTimeout(D,500);var B;function D(){F=null;B=h("<div></div>");var O=new t({size:"small",showLabel:false,inline:true});O.appendTo(B);B.popover({context:A,onClose:function(){O.destroy()}})}function L(){if(F!=null){clearTimeout(F)}else{if(B){B.trigger("close")}}}h.when(K,N,G).then(function I(T,U,Q){L();var R=[],P=[],S=[];h.each(Q,function(){S.push(new e(this.subject.type+"."+this.verb,"reply."+this.subject.type+"."+this.verb))});var O=A.data("domActions");if(O){S=S.concat(O)}h.each(T,function(){var V;if(this.verb!="get"){V="outcome."+this.verb}R.push(new e(this.subject.name.toLowerCase()+"."+this.verb,V,JSON.stringify(this.subject)))});h.each(U,function(){P.push(new e(this.subject.type+"."+this.verb,"reply."+this.subject.type+"."+this.verb,JSON.stringify(h.extend(this.context,{nonOutcome:true}))))});h(jive.outcomes.action.actionMenu({outcomes:R,additionalActions:P,actions:S})).on("click","a.js-actionItem",function(X){var Y=h(this);var W=Y.data("event");if(W){var V=Y.data("actionData");if(V&&V.nonOutcome){j(W,V,A)}else{l(W,H,V,A,A.data("parentId"))}X.preventDefault()}else{if(Y.is(".js-modalize-action[href]")){w.modalize(Y.attr("href"),A);X.preventDefault()}}E.closeFunc()}).popover(E)},function M(){L();h(jive.outcomes.action.unknownError()).message({style:"error"});console.log("action button request(s) failed: ",arguments)})}var i={POST:"outcome.post",PUT:"outcome.put",DELETE:"outcome.delete"};var z={};function j(B,A,C){c.emitP(B,A,C)}function l(C,A,B,D,G){function F(I,H){return c.emitP(C,A,B,G,D,I,H)}var E=null;if(B){if(B.outcomeType){E=B.outcomeType}else{E=B}}r(E,A,C,B,D,F).then(function(I,H){F(I,H)})}function r(W,am,al,T,Q,P){var R=new h.Deferred(),ac=al,ad,H;if(T){H=T.outcomeType?T.outcomeType.name.toLowerCase():T.name.toLowerCase()}var ai;var U=false;if(al==i.PUT&&T.shareable){f(am,T,Q,P).then(function(){R.reject()});return R}function S(){ai.reposition()}function M(){this.callbacks=[];this.run=function(ao,an){return y.reduce(this.callbacks,function(aq,ap){return ap.call(this,aq)},ao,an)};this.addCallback=function(an){this.callbacks.push(an)}}function I(){function an(ap,ar,at){var au=new h.Deferred();var aq=h(jive.outcomes.action.confirmModal({outcomeType:at}));var ao={centered:true,onClose:function(){au.reject()}};aq.lightbox_me(ao).on("click","button[name='ok']",function(av){av.preventDefault();R.resolve();au.resolve();h(this).trigger("close")}).on("click","button[name='cancel']",function(av){av.preventDefault();au.reject();h(this).trigger("close")});return au}an(am,al,T).always(function(){Q.focus()}).then(function(){c.emit("outcome.expandCollapsedComments")})}if(ac==i.DELETE){var E={confirmUnmark:I};var X=new M();y.each(E,function(ao,an){if(W[an]){X.addCallback(ao)}});X.run();if(X.callbacks.length==0){R.resolve()}return R}var ah=new M(),aj=new M(),O=new M(),Z=new M();var N={shareable:".shareable",urlAllowed:".urlAllowed",generalNote:".generalNote"};y.each(N,function(an,ao){if(W&&W[ao]){ah.addCallback(function(){this.find(an).show()})}});function F(ao){var ap="input[name='send-pending-share']";var au="input[name='pending-share-users']";var at="textarea[name='pending-share-message']";var ar="textarea[name='pending-alert-note']";var aq;function an(){var av=h(ap).is(":checked");if(av){ao.find(".js-pending-share").show()}else{ao.find(".js-pending-share").hide()}}ao.find(ap).on("change",an);ao.on("click","button[name='success']",function(az){az.preventDefault();c.removeListener("heightChanged",S);if(h(this).prop("disabled")){return}var aw=ao.find(ar).val();var ay=null;var ax=null;var aA=false;var av=ao.find(ap).is(":checked");if(av){var aB=ao.find(au).val().split(",");aB=h.map(aB,function(aC){return parseInt(aC,10)});ay=h.map(aB,function(aC){return"people/api/core/v3/people/"+aC});ax=ao.find(at).val();aA=true}aq.teardown();R.resolve(aw,{approvers:ay,message:ax,shared:aA})}).on("click","button[name='cancel']",function(av){c.removeListener("heightChanged",S);R.reject();av.preventDefault();aq.teardown()});aq=new m({userMessages:[{type:"warn",render:function(){return jive.outcomes.action.pendingAlertPermissionWarning({privateContent:a(am,ad)})}}],messageDelay:100,canInvitePartners:true,object:{objectID:am.id,objectType:am.type},$input:ao.find(au),multiple:true,listAllowed:true,browseAllowed:true});aq.addListener("selectedUsersChanged",function(){ai.reposition();C()});an()}function L(){var ap=["outdated","official","finalized","wip"];for(var ao=0;ao<ap.length;ao++){var an=ap[ao];if(H!=an){c.emit("outcome.removeBadge",am,{name:an});if(an==="finalized"){c.emit("outcome.expandCollapsedComments")}}}}function ae(ap){var at=/((?:[a-z][a-z\\.\\d\\-]+)\\.(?:[a-z][a-z\\-]+))(?![\\w\\.])/;var ao="input#outdated-url";var ar="#outdated-url-display";var aq="input#outdated-link";var an=function(){var au=h.trim(ap.find(aq).val());if(au.length>0){if(au.indexOf("://")==-1){au="http://"+au}h.ajax({type:"GET",url:_jive_base_absolute_url+"/__services/v2/rest/rteLinks",data:{href:au},dataFilter:function(aw,av){return aw.slice(aw.indexOf("{"))}}).done(function(av){if(av.value.length>0&&!av.customTitle){if(av.macroName){ap.find(ao).val(au);ap.find(ar).html(h('<a href="'+au+'" class="font-color-meta-light">'+au.substr(au.indexOf("://")+3)+"</>"));ap.find(aq).val(av.title).addClass("font-color-link")}else{ap.find(ao).val(av.value);ap.find(ar).html(h('<a href="'+av.value+'" class="font-color-meta-light">'+av.value.substr(av.value.indexOf("://")+3)+"</>"));ap.find(aq).val(av.title).addClass("font-color-link")}}})}};ap.on("click","button[name='success']",function(aw){aw.preventDefault();var au=h.trim(ap.find(ao).val());var av=h.trim(ap.find(aq).val());if(au.length==0){if(av.indexOf("://")==-1){if(av.length>0&&at.test(av.split("/")[0])){au="http://"+av}else{av=""}}else{if(av.indexOf("http")==0){au=av}else{au="";av=""}}}R.resolve(undefined,{url:au,title:av});L()}).on("click","button[name='cancel']",function(au){R.reject();au.preventDefault()}).on("blur",aq,an).on("paste",aq,function(au){setTimeout(an,0)})}function J(ao){var an="textarea[name='outcome-note']";ao.on("click","button[name='success']",function(aq){aq.preventDefault();if(h(this).prop("disabled")){return}var ap=ao.find(an).val();R.resolve(ap)}).on("click","button[name='cancel']",function(ap){R.reject();ap.preventDefault()})}function D(an){an.on("click","button[name='ok']",function(ao){ao.preventDefault();R.resolve();h(this).trigger("close");L()}).on("click","button[name='cancel']",function(ao){ao.preventDefault();R.reject();h(this).trigger("close")})}var ak={shareable:F,urlAllowed:ae,generalNote:J,confirmExclusion:D};y.each(ak,function(ao,an){if(W&&W[an]){Z.addCallback(function(){ao(this)})}});if(ah.callbacks.length==0&&(W&&!W.confirmExclusion)){R.resolve();return R}function A(){if(!T){return R.resolve()}var aq;var ao;var at=h.Deferred();if(T.outcomeType){aq=T.outcomeType.name.toLowerCase();if(T.outcomeType.communityAudience){ao="true"===T.outcomeType.communityAudience}}else{aq=T.name.toLowerCase();if(T.communityAudience){ao="true"===T.communityAudience}}if(W.confirmExclusion){var ar=aq;var ap=[];if("finalized"==ar){ap=["official","outdated","wip"]}else{if("outdated"==ar){ap=["official","finalized","wip"]}else{if("official"==ar){ap=["finalized","outdated","wip"]}else{if("wip"==ar){ap=["finalized","outdated","official"]}}}}var an=h("li.js-outcome-type-"+ap[0]).length>0||h("li.js-outcome-type-"+ap[1]).length>0||h("li.js-outcome-type-"+ap[2]).length>0;if(!an){R.resolve();at.reject();return at}}c.emitP("outcome.prepareForShareActionPopup",am).then(function(au){c.emitP("outcome.displayFake",am,aq).then(function(ay){var aw;if(ao){if("activity"==p.getContext(Q)){var aE;var av=p.getContextMeta(Q);if(av&&"inbox"==av){aE=$j("#j-comm-activity-list")}else{aE=$j("#j-stream-item-list");if(aE.length==0){aE=$j("#j-comm-activity-list")}}if(aE&&aE.length>0){aw=p.getRootCommunityName(aE)}}else{aw=T.rootCommunityName?T.rootCommunityName:p.getRootCommunityName(Q)}}ad=p.nearest(ay,Q,aq);var aA="textarea[name='outcome-note']";var aD=ad.parent().filter(".js-outcome-badge-container-top");aD.addClass("j-fake-badge");aD.find(".js-outcome-badge").find("div").hide().end().find("[class*=j-outcome-type]").removeClass("j-outcome-badge").end().addClass("j-outcome-badge").removeClass("j-fake-badge");var ax=!!T.predecessor;var az={isUpdate:ax,isTakeOwnership:ax&&T.predecessor.outcomeType.name==T.outcomeType.name,existingShare:ax&&!!T.predecessor.shared,shareText:h("<div/>").html(au).text(),outcomeTypeName:aq,notShareable:!W.shareable,communityName:aw};ai={context:ad,onClose:function(){ay.filter(".js-fake-badge").remove();aD.removeClass("j-fake-badge")},returnPopover:true,hoverSelection:false,accessibleBoundaryType:"dialog",additionalContainerSelector:"#user-autocomplete-modal-container, .js-pending-permissionWarning"};var aB={centered:true,onClose:function(){ay.filter(".js-fake-badge").remove();aD.removeClass("j-fake-badge");aD.find(".js-outcome-badge").find("div").show().end().find("[class*=j-outcome-type]").addClass("j-outcome-badge").end().removeClass("j-outcome-badge")}};var aC;if(T.confirmExclusion){aC=h(jive.outcomes.action.tloExclusionModal({outcomeType:T}));aC.lightbox_me(aB);aC.options=aB}else{U=true;aC=h(jive.outcomes.action.markAlertModal(az));aC.popover(ai).on("click","button[name='success']",function(aF){aF.preventDefault();if(h(this).prop("disabled")){return}ai.closeFunc()}).on("click","button[name='cancel']",function(aF){ai.closeFunc();aF.preventDefault()});aC.options=ai}at.resolve(aC)})});return at}var ag={shareable:{sendMessage:"input[name='send-pending-share']",targetUserIds:"input[name='pending-share-users']",shareText:"textarea[name='pending-share-message']",noteText:"textarea[name='pending-alert-note']"},urlAllowed:{urlSelector:"input#outdated-link"},generalNote:{noteSelector:"textarea[name='outcome-note']"}};y.each(ag,function(an,ao){if(W&&W[ao]){aj.addCallback(function(ap){var aq=this;ap[ao]={};y.each(ag[ao],function(at,ar){if(aq.find(at).is(":checkbox")){ap[ao][ar]=aq.find(at).is(":checked")}else{ap[ao][ar]=aq.find(at).val()}});return ap})}});function ab(an){return an&&an.length>0}function aa(ap,an,ao){if(an.sendMessage){return ab(an.targetUserIds)&&ab(an.shareText)}return true}function V(aq,an,ap,ao){if(ao.noteRequired){return ab(aq)}return true}var K={shareable:{sendMessage:aa,targetUserIds:aa,shareText:aa,noteText:ab},generalNote:{noteSelector:V}};y.each(K,function(ao,an){if(W&&W[an]){O.addCallback(function(ar){var aq=this;var ap=true;y.each(K[an],function(at,au){ap=ap&&at(aq[an][au],aq[an],au,W)});return !!ar&&!!ap})}});var Y;var af;var B;function G(){var an=h.Deferred();if(W&&W.urlAllowed&&(h("li.js-outcome-type-finalized").length>0||h("li.js-outcome-type-official").length>0||h("li.js-outcome-type-outdated").length>0||h("li.js-outcome-type-wip").length>0)){d(am,al,T).then(function(){an.resolve()})}else{an.resolve()}return an}G().then(function(){if(!T){return R.resolve()}A().then(function(an){Y=an;ah.run(null,Y);if(U){S()}Z.run(null,Y);y.each(ag,function(ao,ap){if(W[ap]){y.each(ag[ap],function(ar,aq){C();Y.find(ar).on("change keyup blur",function(){af=aj.run({},Y)});Y.find(ar).on("change keyup blur",function(){B=O.run(true,af);if(B){Y.find("button[name='success']").prop("disabled",false)}else{Y.find("button[name='success']").prop("disabled",true)}})})}})}).always(function(){Q.focus()})});function C(){af=aj.run({},Y);B=O.run(true,af);if(B){Y.find("button[name='success']").prop("disabled",false)}else{Y.find("button[name='success']").prop("disabled",true)}}return R}function b(C,D,B){if(!z[C]){z[C]={}}var A=z[C];A[D]=B}function v(C){var D=h(".js-tlo",C||document);if(D.length){var A=p.getEd(D);var B=h(".js-tlo-action-button",C||document).closest("li");c.emitP("outcome.getOutcomeActions",A).then(function(E){B.hide();h.each(E,function(){var F=B.find(".js-outcome-method-"+this.verb+".js-outcome-type-"+this.subject.name.toLowerCase()).closest("li");F.show()})})}}c.addListener("outcome.doAction",l);c.addListener("outcome.created",function(A,B,D){var C=jive.outcomes.action.createdMessage({suffix:D?"takeOwnership":B.outcomeType.name.toLowerCase()});h(C).message({style:"success"});v()});c.addListener("outcome.deleted",function(A,C){var B=jive.outcomes.action.deletedMessage({suffix:C.name.toLowerCase()});h(B).message({style:"success"});v()});c.addListener("outcome.updated",function(B,C,A){var D=jive.outcomes.action.updatedMessage({suffix:A?"addAssignees":C.outcomeType.name.toLowerCase()});h(D).message({style:"success"});v()});c.addListener("outcome.resync",function(){v()});c.addListener("outcome.created",n);c.addListener("outcome.warnEdit",function(D,A,B,C){if(D&&A.type){c.emitP("outcome.get",A).then(function(E){var H=false;var F;for(var G=0;G<E.length;++G){if(E[G].outcomeType.confirmContentEdit&&E[G].outcomeType.confirmContentEdit=="true"&&E[G].user&&E[G].user.id!=B){H=true;F=E[G].user;break}}if(H){u(F).then(function(){document.location.href=h(C).attr("href")})}else{document.location.href=h(C).attr("href")}})}else{document.location.href=h(C).attr("href")}});function d(B,D,E){var F=new h.Deferred();var C=h(jive.outcomes.action.tloExclusionModal({outcomeType:E}));var A={centered:true,onClose:function(){F.reject()}};C.lightbox_me(A).on("click","button[name='ok']",function(G){G.preventDefault();F.resolve();h(this).trigger("close")}).on("click","button[name='cancel']",function(G){G.preventDefault();F.reject();h(this).trigger("close")});return F}function u(B){var D=new h.Deferred();var C=h(jive.outcomes.action.inProgressConfirmModal({user:B}));var A={centered:true,onClose:function(){D.reject()}};C.lightbox_me(A).on("click","button[name='ok']",function(E){D.resolve();h(this).trigger("close")}).on("click","button[name='cancel']",function(E){E.preventDefault();D.reject();h(this).trigger("close")});return D}function f(A,B,D,F){var C=h.Deferred();c.emitP("outcome.prepareForShareActionPopup",A).then(function(G){E(A,G).then(F).then(function(){C.resolve()}).always(function(){D.focus()})});function E(H,G){var I=new h.Deferred();c.emitP("outcome.displayFake",H,"pending").then(function(P){var Q=p.nearest(P,D,"pending");var L={context:Q,onClose:function(){c.removeListener("heightChanged",O);I.reject()},returnPopover:true,hoverSelection:false,accessibleBoundaryType:"dialog",additionalContainerSelector:"#user-autocomplete-modal-container, .js-pending-permissionWarning"};function O(){L.reposition()}c.addListener("heightChanged",O);I.always(function(){L.closeFunc()});var J="input[name='pending-share-users']";var N="textarea[name='pending-share-message']";var R=h(jive.outcomes.action.pendingAssigneeModal({shareText:G}));R.popover(L).on("click","button[name='success']",function(V){V.preventDefault();if(h(this).prop("disabled")){return}var W=R.find(J).val().split(",");W=h.map(W,function(X){return parseInt(X,10)});if(W.indexOf(_jive_current_user.ID)<0){W.unshift(_jive_current_user.ID)}var U=h.map(W,function(X){return"people/api/core/v3/people/"+X});var T=R.find(N).val();var S=null;I.resolve(S,{approvers:U,message:T,shared:true})}).on("click","button[name='cancel']",function(S){I.reject();S.preventDefault()});var M=new m({userMessages:[{type:"warn",render:function(){return jive.outcomes.action.pendingAlertPermissionWarning({privateContent:a(H,Q)})}}],messageDelay:100,canInvitePartners:true,object:{objectID:H.id,objectType:H.type},$input:R.find(J),multiple:true,listAllowed:true,browseAllowed:true});M.addListener("selectedUsersChanged",function(){L.reposition();K()});function K(){var T=R.find(J).val();var S=h.trim(R.find(N).val());if(T.length<=0||S.length<=0){R.find("button[name='success']").prop("disabled",true)}else{R.find("button[name='success']").prop("disabled",false)}}R.find(N).on("change keyup blur",K);K()},function(){I.reject()});return I}return C}function n(A,C){var B=C.outcomeType.name.toLowerCase();if(B!="pending"){return}var E=h(".js-outcome-badge-container.js-ed-"+A.type+"-"+A.id);var D=E.find(".js-outcome-badge.js-outcome-type-"+B);c.emitP("outcome.prepareActionTooltip").then(function(F){if(F.length>1){return}x(D)})}function x(A){var B=jive.outcomes.action.actionTooltip();h(B).popover({context:A,closeSelector:".js-outcome-done-button"})}function a(E,B){if((E.type===102||E.type===105||E.type===1||E.type===2)&&B){var D=B.parent();if((E.type===1||E.type===102)&&D&&D.siblings("div.jive-content-personal").length>0){return true}else{if(D){var C=p.getParentEd(D);if(C&&C.type&&(C.type===102||C.type===1)){var A=$j("ul#js-outcome-badge-container-"+C.type+"-"+C.id);return A&&A.siblings("div.jive-content-personal").length>0}}}}return false}return{clickHandler:k,tloActionButtonRefresh:v,setActionHandler:b,displayTooltip:n}});
;
goog.provide("jive.outcomes.helpful.displayHelpfulCounts");
jive.outcomes.helpful.displayHelpfulCounts=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<span class="js-outcome-helpful-counts-container j-outcome-helpful-counts-container font-color-okay" data-object-type="',soy.$$escapeHtml(opt_data.objectType),'" data-object-id="',soy.$$escapeHtml(opt_data.objectId),'" data-helpful-count="',soy.$$escapeHtml(opt_data.helpfulCount),'" data-overall-count="',soy.$$escapeHtml(opt_data.overallCount),'" data-display-overall="',soy.$$escapeHtml(opt_data.displayOverall),
'" >');jive.outcomes.helpful.msgHelpfulCount(opt_data,output);output.append("</span>");return opt_sb?"":output.toString()};
;
define("apps/outcomes/helpfulModel",["jquery","apps/shared/models/core_deferred"],function(f,c){function e(h){return a(h).then(function(i){if(i.markHelpful){return c.runQuery(i.markHelpful())}})}function b(h){return a(h).then(function(i){if(i.unmarkHelpful){return c.runQuery(i.unmarkHelpful())}})}function g(h){return a(h).then(function(i){if(i.markUnhelpful){return c.runQuery(i.markUnhelpful())}})}function d(h){return a(h).then(function(i){if(i.unmarkUnhelpful){return c.runQuery(i.unmarkUnhelpful())}})}function a(h){return c.getObject(h.type,h.id)}return{createHelpful:e,destroyHelpful:b,createUnhelpful:g,destroyUnhelpful:d}});
;
define("apps/outcomes/helpfulMain",["jquery","apps/shared/controllers/localexchange","apps/outcomes/helpfulModel"],function(c,e,d){function f(h){return d.createHelpful(h).done(function(){e.emit("outcome.helpfulCreated",h)})}function a(h){return d.destroyHelpful(h).done(function(){e.emit("outcome.helpfulDeleted",h)})}function g(h){return d.createUnhelpful(h).done(function(){e.emit("outcome.unhelpfulCreated",h)})}function b(h){return d.destroyUnhelpful(h).done(function(){e.emit("outcome.unhelpfulDeleted",h)})}e.addListener("outcome.createHelpful",f);e.addListener("outcome.deleteHelpful",a);e.addListener("outcome.createUnhelpful",g);e.addListener("outcome.deleteUnhelpful",b);return{createHelpful:f,destroyHelpful:a,createUnhelpful:g,destroyUnhelpful:b}});
;
define("apps/outcomes/helpfulView",["jquery","underscore","apps/shared/controllers/localexchange","apps/outcomes/viewUtil","apps/outcomes/helpfulMain"],function(c,w,a,r){function m(y){var x=c(this);if(x.attr("data-command")==="mark"){l(x)}else{q(x)}}function l(x){if(x.attr("data-type")==="helpful"){t(x)}else{j(x)}}function q(x){if(x.attr("data-type")==="helpful"){n(x)}else{k(x)}}function t(y){u();var x=y.parent(".js-outcome-helpful-container"),z=r.getEd(x),B=x.find(".js-unhelpful-link"),A=B.hasClass("js-selected");a.emit("outcome.createHelpful",z);x.find(".js-icon-helpful").addClass("active");B.removeClass("js-selected").removeClass("j-selected");y.addClass("js-selected").addClass("j-selected");B.attr("data-command","mark");y.attr("data-command","unmark");if(A){i(z)}else{f(z)}}function n(y){o();var x=y.parent(".js-outcome-helpful-container"),z=r.getEd(x),A=x.find(".js-unhelpful-link");a.emit("outcome.deleteHelpful",z);x.find(".js-selected").removeClass("js-selected").removeClass("j-selected");x.find(".js-icon-helpful").removeClass("active");y.attr("data-command","mark");A.attr("data-command","mark");v(z)}function j(B){o();var y=B.parent(".js-outcome-helpful-container"),z=r.getEd(y),x=y.find(".js-helpful-link"),A=x.hasClass("js-selected");a.emit("outcome.createUnhelpful",z);y.find(".js-selected").removeClass("js-selected").removeClass("j-selected");y.find(".js-icon-helpful").addClass("active");B.addClass("js-selected").addClass("j-selected");B.attr("data-command","unmark");x.attr("data-command","mark");if(A){e(z)}else{s(z)}}function k(A){u();var y=A.parent(".js-outcome-helpful-container"),z=r.getEd(y),x=y.find(".js-helpful-link");a.emit("outcome.deleteUnhelpful",z);y.find(".js-selected").removeClass("js-selected").removeClass("j-selected");y.find(".js-icon-helpful").removeClass("active");A.attr("data-command","mark");x.attr("data-command","mark");p(z)}function u(){var z=c(".js-outcome-summary-count",parent.document);if(z.length){var y=z.data("count");var A=y+1;b(z,A)}else{var x=c(".js-outcome-summary-container",parent.document);x.append(jive.outcomes.summary.summaryCount({count:1,outcomeType:"helpful"}))}}function o(){var y=c(".js-outcome-summary-count",parent.document);if(y.length){var x=y.data("count");var z=x-1;if(z==0){y.remove()}else{b(y,z)}}}function b(y,A){var z=y.data();z=w.extend(z,{count:A});var x=jive.outcomes.summary.summaryCount(z);y.replaceWith(x)}function i(x){h(1,0,x)}function s(x){h(0,1,x)}function f(x){h(1,1,x)}function e(x){h(-1,0,x)}function p(x){h(0,-1,x)}function v(x){h(-1,-1,x)}function h(z,A,y){var B=g(y),C=B.data();if(B.length){C=w.extend(C,d(B,z,A));var x=jive.outcomes.helpful.displayHelpfulCounts(C);B.replaceWith(x)}}function g(x){return c('.js-outcome-helpful-counts-container[data-object-type="'+x.type+'"][data-object-id="'+x.id+'"]')}function d(z,x,y){return{helpfulCount:z.data("helpfulCount")+x,overallCount:z.data("overallCount")+y}}return{clickHandler:m}});
;
define("apps/discussion_app/models/question_source",["apps/shared/models/rest_service","lib/jiverscripts/src/conc/observable","lib/jiverscripts/src/conc/promise"],function(a,c,b){return a.extend(function(d,e){c(this);d.resourceType="message";d.pluralizedResourceType=d.resourceType;this.init=function(f){this.options=f;e.init.call(this,this.options)};this.getQuestion=function(g){var f=this.RESOURCE_ENDPOINT+"/"+g+"/question";return this.commonAjaxRequest(new b(),"GET",{url:f,data:{}})};this.markAssumedAnswered=function(g){var f=this.RESOURCE_ENDPOINT+"/"+g+"/assumedanswered";return this.commonAjaxRequest(new b(),"POST",{url:f,data:{}})};this.markCorrect=function(h,f){var g=this.RESOURCE_ENDPOINT+"/"+h+"/"+f+"/correct";return this.commonAjaxRequest(new b(),"POST",{url:g,data:{}})};this.unmarkCorrect=function(h,f){var g=this.RESOURCE_ENDPOINT+"/"+h+"/"+f+"/unmark";return this.commonAjaxRequest(new b(),"POST",{url:g,data:{}})}})});
;
define("apps/outcomes/correctAnswerHelper",["jquery","apps/shared/controllers/localexchange","apps/discussion_app/models/question_source"],function(d,b,e){var a=new e();function c(f,g,i){var h=g.closest(".j-sub-activity-items").data("threadId");var j=a.markCorrect(h,f.id).then(function(k){b.emit("reply.message.correctAnswer.created",k);b.emit("outcome.clearEntityCache",{type:1,id:h});g.closest("div.reply").addClass("j-act-correct-answer")});if(i){i.proxy(j)}return j}return{markCorrect:c}});
;
require(["jquery","underscore","apps/shared/controllers/localexchange"],function(c,a,b){b.addLazyListener("renderedContent",["apps/outcomes/badgeView"],function(e,d){e.refresh(d)},function(d){return c(".js-outcome-badge-container",d).not("[data-no-hydrate]").length>0});b.addLazyListener("reply.message.correctAnswer",["apps/outcomes/correctAnswerHelper"],function(d,e,f,g){d.markCorrect(e,f,g)},function(d,e){return d.id>0&&e});b.addLazyListener("renderedContent",["apps/outcomes/summaryView"],function(e,d){e.summarize(d)},function(d){return c(".js-outcome-summary-container",d).length>0});b.addLazyListener("renderedContent",["apps/outcomes/actionView"],function(e,d){e.tloActionButtonRefresh(d)},function(d){return c(".js-tlo-action-button",d).length>0});c(function(){c("body").off(".outcomes").on("vclick.outcomes","a.js-outcome-button",function(d){require(["apps/outcomes/actionView"],a.bind(function(e){e.clickHandler.call(this)},this));d.preventDefault()}).on("vclick.outcomes",".js-outcome-badge-container .js-outcome-badge:not(.js-outcome-badge-noclick)",function(d){require(["apps/outcomes/badgeView"],a.bind(function(e){e.clickHandler.call(this)},this));d.preventDefault()}).on("vclick.outcomes",".js-outcome-history-link",function(d){require(["apps/outcomes/historyView"],a.bind(function(e){c(this).parent("j-pop-main").attr("id");e.clickHandler.call(this)},this));d.preventDefault()}).on("vclick.outcomes",".j-outcome-link-details",function(d){require(["apps/outcomes/summaryView"],a.bind(function(e){e.clickHandler.call(this)},this))}).on("vclick.outcomes",".js-outcome-helpful-container .js-action-link",function(d){require(["apps/outcomes/helpfulView"],a.bind(function(e){e.clickHandler.call(this)},this));d.preventDefault()});require(["apps/outcomes/actionView"],function(d){d.tloActionButtonRefresh()})})});
;
goog.provide("jive.i18n.keys.antivirusScanningText");jive.i18n.keys.antivirusScanningText=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("antivirus.scanning.text"),[])));return opt_sb?"":output.toString()};
;
goog.provide("jive.antivirus.infoButton");
jive.antivirus.infoButton=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<a href="#" class="js-antivirus-info j-antivirus-info-icon" aria-label="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("antivirus.info.hover_text"),[])),'"><span class="jive-icon-glyph icon-info" title="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("antivirus.info.hover_text"),[])),'"></span></a>');return opt_sb?"":output.toString()};
;
goog.provide("jive.antivirus.scanRecordInfo");
jive.antivirus.scanRecordInfo=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<span class="j-antivirus js-antivirus-scan-record j-antivirus-',soy.$$escapeHtmlAttribute(opt_data.scanRecord.status),'" ',!opt_data.showScanRecord?' style="display:none" ':"","><strong>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey(opt_data.scanRecord.labelKey)),[])),"</strong> ",opt_data.showLastScanned?'<strong class="j-antivirus-lastscanned">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey(opt_data.scanRecord.descriptionKey)),
[]))+"</strong> "+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey(opt_data.scanRecord.lastScanDate)),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey(opt_data.scanRecord.descriptionKey)),[])),"</span>");return opt_sb?"":output.toString()};
;
define("apps/antivirus/views/antivirus_view",["jquery","apps/shared/views/abstract_view","lib/jiverscripts/src/conc/observable"],function(b,a,c){return a.extend(function(){c(this);this.init=function(d){this.options=d;this.interceptAttachmentLinks();this.interceptDocumentBodyLinks()};this.interceptAttachmentLinks=function(){var d=this;var e=jive.antivirus.infoButton();b("div.jive-attachments li").each(function(){var i=b(this);var f=13;var h=i.attr("data-attachmentid");var g=b(e);b(this).find("div a").first().after(g);g.click(d.toggleAntivirusInfoVisibility);d.interceptScannedObjectLink(i,f,h,"div.j-attachment-info span.j-attach-meta",null,null,false)})};this.toggleAntivirusInfoVisibility=function(){var d=b(this).parent().find(".js-antivirus-scan-record").toggle()};this.interceptDocumentBodyLinks=function(){if(b("div.jive-wiki-body-file-info-last").length==0){var d=this;b("div.jive-wiki-body-download").each(function(){var g=b(this);var e=110;var f=d.getBodyId(g);d.interceptScannedObjectLink(g,e,f,"span.jive-wiki-body-file span.jive-wiki-body-file-actions",null,null,false)})}};this.interceptScannedObjectLink=function(k,e,f,j,i,h,g){var d=this;if(!i){i=this.getScanOnDownloadHandler(k,j,e,f);k.find("a:not(.js-antivirus-info)").each(function(){var l=b(this);l.click(i)})}d.emitP("getScanRecord",e,f,"status,enabled,preventDownload,rescannable,labelKey,descriptionKey,lastScanDate").addCallback(function(m){var l;k.find("a:not(.js-antivirus-info)").each(function(){l=b(this);if(m.preventDownload){if(!m.rescannable){var o=l.attr("class");l.after('<span class="'+o+'">'+l.html()+"</span>");l.remove()}}else{l.unbind("click",i)}});if(m.enabled||(m.preventDownload&&!m.rescannable)){var n=jive.antivirus.scanRecordInfo({showScanRecord:g||k.hasClass("jive-wiki-body-download"),scanRecord:m,showLastScanned:(m.descriptionKey.toString().indexOf("MODIFIED")>-1)});k.find(j).after(n)}if(e==110&&(m.preventDownload&&!m.rescannable)){k.find(j).remove()}if(l&&h){window.location=l.attr("href")}}).addErrback(function(){k.find("a:not(.js-antivirus-info)").each(function(){$scanObjectLink=b(this);var l=$scanObjectLink.attr("class");$scanObjectLink.after('<span class="'+l+'">'+$scanObjectLink.html()+"</span>");$scanObjectLink.remove()})})};this.getScanOnDownloadHandler=function(j,i,e,g){var d=this;var f=false;var h=function(k){if(!f){f=d.scanStarting(j);d.emitP("scan",e,g,"status,preventDownload").addCallback(function(l){f=d.scanComplete(j);d.interceptScannedObjectLink(j,e,g,i,h,!l.preventDownload,true)}).addErrback(function(n,m){if(m==501){var l;j.find("a").each(function(){l=b(this);l.unbind("click",h)});j.find("div.j-antivirus-scanning").remove();if(l){window.location=l.attr("href")}}else{f=d.scanComplete(j);d.interceptScannedObjectLink(j,e,g,i,h,null,true)}})}k.preventDefault();return false};return h};this.scanStarting=function(d){d.find(".j-antivirus").each(function(){var e=b(this);e.after('<div class="j-antivirus-scanning"><div><strong>'+jive.i18n.keys.antivirusScanningText()+"</strong></div></div>");e.remove()});return true};this.scanComplete=function(d){d.find(".j-antivirus-scanning").each(function(){var e=b(this);e.remove()});return false};this.getBodyId=function(j){var e=b(j);var d=e.find("a").first().attr("href");var i=e.attr("data-body-id");if(d){var h=d.split("/");if(h.length>2){var f=h[h.length-2];var g=f.split("-");if(g.length>1){return g[g.length-1]}}}else{if(i&&b.isNumeric(i)){return i}}}})});
;
define("apps/antivirus/models/antivirus_source",["apps/shared/models/rest_service","lib/jiverscripts/src/conc/promise"],function(a,b){return a.extend(function(c){c.resourceType="scanRecord";c.pluralizedResourceType=c.resourceType;var d=_jive_base_url+"/api/core/v3/antivirus/";this.getScanRecord=function(f,g,e,i){if(!i){i=new b()}var h=d+f+"/"+g;return this.commonAjaxRequest(i,"GET",{url:h,data:{fields:e}||{}})};this.scan=function(f,g,e,i){if(!i){i=new b()}var h=d+f+"/"+g;c.displayGenericErrorMessages=false;return this.commonAjaxRequest(i,"PUT",{url:h,data:{fields:e}||{}}).always(function(){c.displayGenericErrorMessages=true})}})});
;
define("apps/antivirus/main",["lib/jiverscripts/src/oo/class","./models/antivirus_source","./views/antivirus_view"],function(a,b,c){return a.extend(function(d){this.init=function(f){this.options=f;var e=this;e.model=new b(f);e.view=new c(f);e.view.addListener("getScanRecord",function(h,i,g,j){e.model.getScanRecord(h,i,g,j).addCallback(j.emitSuccess.bind(j)).addErrback(j.emitError.bind(j))});e.view.addListener("scan",function(h,i,g,j){e.model.scan(h,i,g,j).addCallback(j.emitSuccess.bind(j)).addErrback(j.emitError.bind(j))})}})});
;
define("antivirus",["apps/antivirus/main","documentReady"],function(a){new a({})});
;
define("apps/shared/models/deferred_rest_service",["jquery"],function(a){return jive.oo.Class.extend(function(b){b.resourceType="abstract";b.displayGenericErrorMessages=true;b.putOnUpdate=false;b.init=function(d){var c=this;this.pluralizedResourceType=this.pluralizedResourceType||this.resourceType+"s";var e=jive.rest.url("/"+this.pluralizedResourceType);this.RESOURCE_ENDPOINT=(d&&d.forceSecure)?jive.secure(e):e;this.POST_RESOURCE_ENDPOINT=this.RESOURCE_ENDPOINT;this.defaultParams={}};this.suppressGenericErrorMessages=function(){this.displayGenericErrorMessages=false};b.commonAjaxRequest=function(j,e,d,h){var g=this,i,c,f;e=e.toUpperCase();if(e=="POST"){f={contentType:"application/json; charset=utf-8"};c=this.errorSaving}else{if(e=="GET"){c=this.errorFinding}else{if(e=="PUT"){f={contentType:"application/json; charset=utf-8"};c=this.errorUpdating}else{if(e=="DELETE"){c=this.errorDestroying}}}}a.ajax(a.extend({type:e,dataType:"json",success:i||function(k,m,l){g.normalizeID(k);j.resolve(k)},error:this.errorCallback(j,c),timeout:30000},f||{},d));return j};this.save=function(d){this.normalizeID(d);var c=this.saveUrl(d);var e=this.saveMethod(d);return this.commonAjaxRequest(new a.Deferred(),e,{url:c,data:JSON.stringify(this.withoutId(d))},d)};this.get=function(f,e){var c=this.RESOURCE_ENDPOINT+"/"+f,d=jQuery.extend({},this.defaultParams,e||{});return this.commonAjaxRequest(new a.Deferred(),"GET",{url:c,data:d})};this.findAll=function(e){var c=this.RESOURCE_ENDPOINT,d=a.extend({},this.defaultParams,e);return this.commonAjaxRequest(new a.Deferred(),"GET",{url:c,data:d})};this.destroy=function(e){var d=new a.Deferred(),c=this;if(e.hasOwnProperty("id")){e=e.id}a.ajax({type:"DELETE",url:this.RESOURCE_ENDPOINT+"/"+e,success:function(){d.emitSuccess()},error:function(f){c.maybeEmitError(d,c.errorDestroying,[null,f&&f.status])},timeout:30000});return d};b.normalizeID=function(c){var d=c?(c.id||c[this.resourceType+"ID"]):null;if(c&&d){c.id=d}};b.unwrapResponse=function(c){if(Object.keys(c).length===1){return c[Object.keys(c)[0]]}else{return c}};b.errorCallback=function(e,c){var d=this;return function(k,l,h){var i,g,f;try{i=JSON.parse(k.responseText)}catch(j){}g=i?i.message:null;f=(i&&i.code)?i.code:k.status;if(l!=="error"||k.status>=100){d.maybeEmitError(e,c,[g,f])}}};b.maybeEmitError=function(e,c,d){if(this.displayGenericErrorMessages){this.displayError(c())}e.reject.apply(e,d)};b.displayError=function(c){a(c).message({style:"error"})};b.errorSaving=function(){return jive.error.rest.soy.errorSaving({href:window.location})};b.errorFinding=function(){return jive.error.rest.soy.errorFinding({href:window.location})};b.errorUpdating=function(){return jive.error.rest.soy.errorUpdating({href:window.location})};b.errorDestroying=function(){return jive.error.rest.soy.errorDestroying({href:window.location})};b.withoutId=function(c){var d={};Object.keys(c).forEach(function(e){if(e!="id"){d[e]=c[e]}});return d};b.saveUrl=function(c){if(c.id){return this.RESOURCE_ENDPOINT+"/"+c.id}else{return this.POST_RESOURCE_ENDPOINT}};b.saveMethod=function(c){if(c.id&&this.putOnUpdate){return"PUT"}else{return"POST"}}})});
;
jive.namespace("GuidedNavigation");define("apps/guided_navigation/models/source",["jquery","underscore","apps/shared/models/deferred_rest_service"],function(d,a,c){var b=c.extend(function(e){this.init=function(){this.RESOURCE_ENDPOINT=jive.app.url({path:"/api/core/v3/tiles/"})};this.fetch=function(g){var f=this.RESOURCE_ENDPOINT+g+"/";return this.commonAjaxRequest(new d.Deferred(),"GET",{url:f})}});return b});
;
goog.provide("jive.guided_navigation.link");
jive.guided_navigation.link=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.action?'<a href="'+soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.action.url))+'" class="j-guided-nav-link">'+(opt_data.navIconPrefix?'<span class="jive-icon-glyph icon-angle-left"></span> ':"")+(opt_data.jiveIconClasses?'<span class="'+soy.$$escapeHtml(opt_data.jiveIconClasses)+'"></span>':"")+'<span class="lnk">'+soy.$$escapeHtml(opt_data.text)+"</span>"+
(opt_data.navIconPostfix?' <span class="jive-icon-glyph icon-angle-right"></span>':"")+"</a>":(opt_data.jiveIconClasses?'<span class="'+soy.$$escapeHtml(opt_data.jiveIconClasses)+'"></span>':"")+soy.$$escapeHtml(opt_data.text));return opt_sb?"":output.toString()};
;
goog.provide("jive.guided_navigation.header");jive.guided_navigation.header=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.guided_navigation.link(soy.$$augmentMap(opt_data.parent,{jiveIconClasses:false}),output);output.append(" / ",soy.$$escapeHtml(opt_data.tileName));return opt_sb?"":output.toString()};
;
goog.provide("jive.guided_navigation.back");jive.guided_navigation.back=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.guided_navigation.link(soy.$$augmentMap(opt_data,{text:jive.i18n.i18nText(jive.i18n.getMsg("guidedNavigation.backTo"),[opt_data.text]),jiveIconClasses:false}),output);return opt_sb?"":output.toString()};
;
goog.provide("jive.guided_navigation.section");
jive.guided_navigation.section=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<h4 class="font-color-meta">',soy.$$escapeHtml(opt_data.text),'</h4><ul class="j-icon-list">');var itemList6=opt_data.items;var itemListLen6=itemList6.length;for(var itemIndex6=0;itemIndex6<itemListLen6;itemIndex6++){var itemData6=itemList6[itemIndex6];output.append("<li ",itemData6.isCurrent?'class="j-selected font-color-normal j-current"':"",">");jive.guided_navigation.link(itemData6,
output);output.append("</li>")}output.append("</ul>");return opt_sb?"":output.toString()};
;
goog.provide("jive.guided_navigation.menu");
jive.guided_navigation.menu=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-menu j-guided-nav-menu j-quick-menu j-pop-main js-guided-navigation-menu" style="display: none;">');var sectionList4=opt_data.content;var sectionListLen4=sectionList4.length;for(var sectionIndex4=0;sectionIndex4<sectionListLen4;sectionIndex4++){var sectionData4=sectionList4[sectionIndex4];jive.guided_navigation.section(sectionData4,output)}output.append("</div>");return opt_sb?
"":output.toString()};
;
goog.provide("jive.guided_navigation.navbar");
jive.guided_navigation.navbar=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="prev">');if(opt_data.prev)jive.guided_navigation.link(soy.$$augmentMap(opt_data.prev,{navIconPrefix:true}),output);else jive.guided_navigation.back(soy.$$augmentMap(opt_data.parent,{navIconPrefix:true}),output);output.append('</div><div class="js-menu-action j-gNav-menu">');jive.guided_navigation.menu(opt_data,output);output.append("<a href='#' class='js-list j-guided-nav-link'><span class=\"lnk\">",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("guidedNavigation.outOf"),
[opt_data.position,opt_data.count])),'</span><span class="j-nav-more jive-icon-glyph icon-arrow-down2"></span></a></div><div class="next">');if(opt_data.next)jive.guided_navigation.link(soy.$$augmentMap(opt_data.next,{navIconPostfix:true}),output);else jive.guided_navigation.back(soy.$$augmentMap(opt_data.parent,{navIconPostfix:true}),output);output.append("</div>");return opt_sb?"":output.toString()};
;
define("apps/guided_navigation/views/view",["jquery","underscore","soy!jive.guided_navigation.header","soy!jive.guided_navigation.navbar"],function(c,b,e,a){function d(g){var f=this;this.options=g;this.$el=g.$el;f.render=function(h){if(this.options.pos<1||this.options.pos>h.aggregate.length){return}this.data=h;this.addHeader();this.addNavBar();this.bindHandlers();this.$el.show()};f.bindHandlers=function(){this.$el.on("click.guided_nav",".js-menu-action",this.showMenu)};f.addHeader=function(){var h=e({parent:this.data.parent,tileName:this.data.title});this.$el.find(".js-header").append(h)};f.addNavBar=function(){var k=this.data.aggregate;var l=parseInt(this.options.pos),i=l-1;var j={parent:this.data.parent,count:k.length,position:l,content:this.data.content,next:i+1<k.length?k[i+1]:false,prev:i-1>=0?k[i-1]:false};var h=a(j);this.$el.find(".js-navbar").append(h)};f.showMenu=function(h){h.preventDefault();c(".js-guided-navigation-menu").popover({context:c(this),darkPopover:true,destroyOnClose:false,hoverSelection:true})}}return d});
;
jive.namespace("GuidedNavigation");define("apps/guided_navigation/helper",["jquery","underscore"],function(d,c){function e(){var f=$j.deparam.querystring();return{id:f.nav,pos:f.pos}}function b(g,f,h){g=a(g,"nav",h);g=a(g,"pos",f);return g}function a(h,f,i){var g=new RegExp("([?|&])"+f+"=.*?(&|#|$)","i");if(h.match(g)){return h.replace(g,"$1"+f+"="+i+"$2")}else{var k="";var j=h.indexOf("?")!==-1?"&":"?";if(h.indexOf("#")!==-1){k=h.replace(/.*#/,"#");h=h.replace(/#.*/,"")}return h+j+f+"="+i+k}}return{getNav:e,processURL:b}});
;
jive.namespace("GuidedNavigation");define("apps/guided_navigation/main",["jquery","underscore","apps/guided_navigation/models/source","apps/guided_navigation/views/view","apps/guided_navigation/helper"],function(c,a,e,d,b){jive.GuidedNavigation.Main=jive.oo.Class.extend(function(f){f.init=function(h){var g=this;this.options=h=a.extend({$el:c(".js-guided-nav")},b.getNav());if(!h.id||!h.pos){return}this.model=new e();this.view=new d(h);this.model.fetch(h.id).done(function(i){var j=g.processTile(i);g.view.render(j)}).fail(function(){console.log("failed to retrieve navigation bar for ID: "+h.tileID)})};f.processTile=function(i){var g=this;var j=1;var h=[];a.each(i.data.content,function(k){a.each(k.items,function(l){l.isCurrent=(g.options.pos==j);if(l.action){l.action.url=b.processURL(l.action.url,j,i.id)}h.push(l);j++})});return a.extend({aggregate:h},i.data)}});return jive.GuidedNavigation.Main});
;
jive.Rate=function(h,g,o,r,v,l,x,q,b){var n=jive.rest.url("/rating/"+o+"/"+r);var p;var d;var c;var e;var t;var f;var s;$j.getJSON(n,function(z){p=z.ratingInfo;w();u();k();if(f){var y={body:"",element:s,i18n:l,containerType:h,containerID:g,resourceType:o,resourceID:r,rteOptions:b};require(["apps/rate/main"],function(A){new A(y)})}});function u(){if(q){s=$j('.jive-content-rating[data-guid="'+q+'"]')}else{s=$j("#jive-content-rating")}}function w(){d=(p.ratedByUser&&p.userRating.score>0)?p.userRating.score:0;c=p.userRating?p.userRating.description:"";e=false;t=p.availableRatings;f=p.commentable&&x}function i(y){$j.getJSON(n,function(z){j(z);y.resolve()});return false}function j(y){require(["soy!jive.rate.soy.renderRating"],function(A){y.i18n=l;var z=A(y);s.find(".jive-content-avgrating").html(z)})}function a(A){e=true;var y=s.find(".j-rating-comment-instruct .font-color-okay strong"),z=new $j.Deferred();y.html(l.rateSavingText);if(!s.find(".j-rating-container").hasClass("j-rating-container-active")){s.find(".j-rating-container").addClass("j-rating-container-active");if(!s.find(".j-rating-container").hasClass("j-rating-container-active-tab")){s.find(".j-rating-comment-instruct").css("opacity","0").animate({width:"toggle",opacity:1},500)}}$j.post(n,{score:A},function(){i(z);d=A;m(A);s.find(".jive-icon-userrating-"+A).attr("aria-pressed","true");s.find(".jive-icon-userrating-"+A).prevAll("a").attr("aria-pressed","false");s.find(".jive-icon-userrating-"+A).nextAll("a").attr("aria-pressed","false");s.find(".j-comment-on-rating").focus()});z.then(function(){y.html(l.rateSavedText);if(!f){s.find(".j-rating-comment-instruct").fadeOut(2500,function(){s.find(".j-rating-container").removeClass("j-rating-container-active")})}e=false})}function m(y){$j.each(t,function(z,A){if(y==0){s.find(".jive-content-userrating-desc").html("")}if(y==A.score){s.find(".jive-content-userrating-desc").html(A.description)}s.find(".jive-icon-userrating-"+A.score).toggleClass("jive-icon-rate-usr-on",y>=A.score).toggleClass("jive-icon-rate-usr-off",y<A.score)})}function k(){var y=jive.rate.soy.renderRating({ratingInfo:p,i18n:l});if(p.rateable){y+=jive.rate.soy.renderUserRating({ratingInfo:p,userRating:d,commentable:f,ratingDescription:c,i18n:l})}s.append(y);s.find(".jive-content-userrating").show();$j.each(p.availableRatings,function(A,z){s.find(".jive-icon-userrating-"+z.score).bind("click",function(){a(z.score)});s.find(".jive-icon-userrating-"+z.score).hover(function(){m(z.score)},function(){m(d)});s.find(".jive-icon-userrating-"+z.score).bind("focus",function(){m(z.score)});s.find(".jive-icon-userrating-"+z.score).bind("blur",function(){m(d)})})}};
;
goog.provide("jive.rate.soy.renderRating");goog.provide("jive.rate.soy.renderUserRating");goog.require("soy");goog.require("soydata");goog.require("soy.StringBuilder");
jive.rate.soy.renderRating=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="jive-content-avgrating" tabindex="0" aria-labelledby="j-rating-score"><span class="j-508-label" id="j-rating-score">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("jive.field.colon"),[opt_data.i18n.avgUserRatingTitlei18n]))," ",opt_data.ratingInfo.ratingCount>0?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("rate.amount"),[opt_data.ratingInfo.meanRating,opt_data.ratingInfo.availableRatings.length])):
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("rate.ratings.none"),[]))," (",soy.$$escapeHtml(opt_data.ratingInfo.ratingCount)," ",opt_data.ratingInfo.ratingCount==1?soy.$$escapeHtml(opt_data.i18n.rateRatingLabel):soy.$$escapeHtml(opt_data.i18n.rateRatingsLabel),')</span><div class="jive-content-avgrating-title">',soy.$$escapeHtml(opt_data.i18n.avgUserRatingTitlei18n),'</div><div class="jive-content-avgrating-score" title="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("rate.amount.complete"),
[opt_data.ratingInfo.meanRating,opt_data.ratingInfo.availableRatings.length])),'"><span class="j-508-label">',opt_data.ratingInfo.ratingCount>0?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("rate.amount.complete"),[opt_data.ratingInfo.meanRating,opt_data.ratingInfo.availableRatings.length])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("rate.ratings.none"),[])),"</span>");var availableRatingList30=opt_data.ratingInfo.availableRatings;var availableRatingListLen30=availableRatingList30.length;
for(var availableRatingIndex30=0;availableRatingIndex30<availableRatingListLen30;availableRatingIndex30++){var availableRatingData30=availableRatingList30[availableRatingIndex30];output.append('<span class="jive-icon-avgrating-',soy.$$escapeHtml(availableRatingData30.score)," jive-icon-med jive-icon-rate-avg-",opt_data.ratingInfo.meanRating>=availableRatingData30.score?"on":opt_data.ratingInfo.meanRating>=availableRatingData30.score-0.5?"half":"off",'"></span>')}output.append('</div><div class="jive-content-rating-print" style="display: none;">',
soy.$$escapeHtml(opt_data.ratingInfo.meanRating),'</div><div class="jive-content-avgrating-count">(',soy.$$escapeHtml(opt_data.ratingInfo.ratingCount)," ",opt_data.ratingInfo.ratingCount==1?soy.$$escapeHtml(opt_data.i18n.rateRatingLabel):soy.$$escapeHtml(opt_data.i18n.rateRatingsLabel),")</div></div>");return opt_sb?"":output.toString()};
jive.rate.soy.renderUserRating=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="jive-content-userrating jive-content-myrating-print"><div class="j-rating-container clearfix"><div class="j-rating clearfix"><div class="jive-content-userrating-title">',soy.$$escapeHtml(opt_data.i18n.myRatingLabel),' <span class="jive-content-userrating-desc">',soy.$$escapeHtml(opt_data.ratingDescription),'</span></div><div class="jive-content-userrating-score">');var availableRatingList60=
opt_data.ratingInfo.availableRatings;var availableRatingListLen60=availableRatingList60.length;for(var availableRatingIndex60=0;availableRatingIndex60<availableRatingListLen60;availableRatingIndex60++){var availableRatingData60=availableRatingList60[availableRatingIndex60];output.append('<a href="javascript:void(0);" class="jive-icon-userrating-',soy.$$escapeHtml(availableRatingData60.score)," jive-icon-med jive-icon-rate-usr-",opt_data.userRating>=availableRatingData60.score?"on":"off",'" aria-labelledby="button-score-label-',
soy.$$escapeHtml(availableRatingData60.score),'" role="button" aria-pressed="',opt_data.userRating==availableRatingData60.score?"true":"false",'"><span id="button-score-label-',soy.$$escapeHtml(availableRatingData60.score),'" class="j-508-label">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("rate.rating.rate"),[availableRatingData60.description,availableRatingData60.score,opt_data.ratingInfo.availableRatings.length])),"</span></a>")}output.append('<div class="jive-content-userrating-saved" style="display: none;" role="status"></div></div></div><div class="j-rating-comment-instruct"><p class="font-color-okay" role="status"><strong>',
soy.$$escapeHtml(opt_data.i18n.rateRatingSaved),"</strong></p>",opt_data.commentable?'<p class="font-color-meta"><a href="#" class="j-comment-on-rating" onclick="$j.scrollTo(\'.jive-content-avgrating\', 300);"><strong>'+soy.$$escapeHtml(opt_data.i18n.writeAReview)+"</strong></a></p>":"",'</div></div></div><div class="j-rating-comment"><ul class="jive-comment"><li><div class="jive-comment-arrow"></div><div class="jive-comment-content"><p class="jive-comment-meta font-color-meta-light">',soy.$$escapeHtml(opt_data.i18n.commentOnRating),
'</p><div class="jive-rating-comment-body"> </div></div></li></ul></div>');return opt_sb?"":output.toString()};
;
jive.namespace("Rate");define("apps/rate/main",["commentMacroApps"],function(){jive.Rate.Main=function(k){var j=k.containerID;var g=k.containerType;var a=k.container;var b=k.resourceType;var i=k.resourceID;var c=k.i18n;var h=k.body,d=k.element?k.element:"#jive-rating-content",f;function e(m,l){window.jive.CommentApp.comments.closeForms();if(f){f.remove()}jive.CommentApp.comments.renderForm(jive.CommentApp.FormView,m,$j.extend({commentMode:"rate",i18n:c},l))}$j(document).ready(function(){var l=$j(d);$j(function(){l.find(".j-comment-on-rating").click(function(){e(l.find(".jive-rating-comment-body"),{formActionContainer:".jive-rating-comment-body",bodyContent:h,containerType:g,containerID:j,resourceType:b,resourceID:i,rteOptions:k.rteOptions});l.find(".jive-content-avgrating").css("height","30px").animate({padding:"0",width:"0",opacity:"0"},500,function(){l.find(".j-rating-comment").animate({opacity:"toggle"},800).slideDown()});l.find(".jive-content-userrating").animate({padding:"0"},500).css("border","none");l.find(".j-rating-comment-instruct").animate({width:"0",opacity:"0",padding:"0"},400,function(){$j(this).hide()}).css("border","none");l.find(".j-rating-container").removeClass("j-rating-container-active");l.find(".j-rating-container").addClass("j-rating-container-active-tab");return false})});var m=function(){l.find(".j-rating-comment").hide();l.find(".jive-content-userrating").removeAttr("style");l.find(".jive-content-avgrating").removeAttr("style");l.find(".j-rating-comment-instruct").removeAttr("style");l.find(".j-rating-container").removeClass("j-rating-container-active");l.find(".j-rating-container").removeClass("j-rating-container-active-tab")};jive.CommentApp.comments.addCommentListViewListener("cancelComment",m);jive.CommentApp.comments.addCommentListViewListener("savedComment",m);jive.CommentApp.comments.addCommentListViewListener("createComment",m);jive.CommentApp.comments.addCommentListViewListener("replyComment",m);jive.CommentApp.comments.addCommentListViewListener("editComment",m)})};return jive.Rate.Main});
;
define("apps/extendedinvitations/models/source",["jquery","underscore","apps/shared/models/core_deferred"],function(c,b,a){return jive.oo.Class.extend(function(e){e.load=function(i){return a.getObject(i.objecttype,i.objectid)};function g(i){var j=i.discussion?"discussion":"rootURI";if(b.isUndefined(i[j])||f(i[j])){return i}return a.runQuery(osapi.jive.corev3.contents.get({id:b.last(i[j].split("/"))}))}function f(k){var j=k.split("/").reverse(),l=j.shift(),i=j.shift();return !/discussion|contents|document/.test(i)}function h(i){return b.sortBy(i,"displayName")}function d(i){b.each(i,function(j){if(j&&j.jive&&j.jive.profile){j.title=b.find(j.jive.profile,function(k){return k.jive_label==="Title"})}return j});return i}this.getAuthors=function(i){return this.load(i).then(g).then(function(j){if(_jive_current_user.partner||_jive_current_user.external){return j.extendedAuthors}else{return a.runAll(b.invoke(j.extendedAuthors,"get")).then(d).then(h)}})};this.removeAuthor=function(i,j){return this.load(i).then(function(k){k.extendedAuthors=b.filter(k.extendedAuthors,function(l){return +l.id!==j});return a.runQuery(k.update)})}})});
;
goog.provide("jive.shared.displayutil.coreApiAvatar");jive.shared.displayutil.coreApiAvatar=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.shared.displayutil.avatar(soy.$$augmentMap(opt_data,{enabled:opt_data.jive.enabled,visible:opt_data.visible||opt_data.jive.visible,username:opt_data.jive.username,partner:opt_data.jive.externalContributor,size:opt_data.size,uri:opt_data.uri}),output);return opt_sb?"":output.toString()};
;
goog.provide("jive.shared.displayutil.coreApiUserDisplayNameLink");jive.shared.displayutil.coreApiUserDisplayNameLink=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.shared.displayutil.userDisplayNameLink(soy.$$augmentMap(opt_data,{anonymous:false,enabled:opt_data.jive.enabled,username:opt_data.jive.username,visible:opt_data.jive.visible}),output);return opt_sb?"":output.toString()};
;
goog.provide("jive.extended_invitation.showExtendedAuthorsModal");
jive.extended_invitation.showExtendedAuthorsModal=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="js-show-extended-authors j-show-extended-authors"><ul class="j-people-list">');var authorList4=opt_data.authors;var authorListLen4=authorList4.length;for(var authorIndex4=0;authorIndex4<authorListLen4;authorIndex4++){var authorData4=authorList4[authorIndex4];output.append('<li class="clearfix" data-user-id="',soy.$$escapeHtml(authorData4.id),'">');jive.shared.displayutil.coreApiAvatar(soy.$$augmentMap(authorData4,
{size:26}),output);output.append('<span class="j-ext-author">');if(opt_data.removeAuthorLink){output.append("<em>");jive.shared.displayutil.userDisplayNameLink(authorData4,output);output.append("</em>")}else jive.shared.displayutil.coreApiUserDisplayNameLink(authorData4,output);output.append(authorData4.title?'<em class="font-color-meta-light">'+soy.$$escapeHtml(authorData4.title.value)+"</em>":"","</span>",opt_data.removeAuthorLink?'<a href="#" class="j-remove-author font-color-meta">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.warn.dialog.link"),
[]))+"</a>":"","</li>")}output.append("</ul></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.extended_invitation.removeShareInline");
jive.extended_invitation.removeShareInline=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="js-remove-ext-invites j-remove-ext-invites"><p>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.warn.dialog.confirm"),[])),'</p><a href="#" class="ok j-btn-global">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.warn.dialog.revoke.button"),[])),'</a><a href="#" class="cancel j-btn-global">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.warn.dialog.cancel.button"),
[])),"</a></div>");return opt_sb?"":output.toString()};
;
define("apps/extendedinvitations/views/view",["jquery","underscore","soy!jive.extended_invitation.showExtendedAuthorsModal","soy!jive.extended_invitation.removeShareInline"],function(b,a,d,c){return jive.oo.Class.extend(function(e){jive.conc.observable(this);e.init=function(f){a.extend(this,f)};this.show=function(i,h){if(!h||h.length<=0){return(new b.Deferred()).reject()}var g=this,f=b(i).data("removeAuthors");this.modal=b.parseHTML(d({authors:h,removeAuthorLink:f}));b(this.modal).popover({context:i,hoverSelection:f,onLoad:function(){if(f){b(g.modal).on("click","li",g.showRemoveConfirm.bind(g,i))}}})};e.showRemoveConfirm=function(h,i){var g=this,f=b(i.target).closest("li");$confirm=b(b.parseHTML(c()));f.children().fadeOut(function(){f.append($confirm)});$confirm.on("click","a",function(k,j){if(b(this).hasClass("ok")){g.removeAuthorsHandler.call(g,h,k)}else{j.remove();k.children().fadeIn()}}.curry(f,$confirm));i.preventDefault()};e.removeAuthorsHandler=function(f,g){if(g.siblings("li").length==0){g.remove();b(this.modal).trigger("close")}else{g.remove()}this.emit("removeAuthor",f,g.data("userId"))}})});
;
define("apps/extendedinvitations/main",["jquery","underscore","apps/extendedinvitations/models/source","apps/extendedinvitations/views/view","soy!jive.error.rest.soy.errorFinding","soy!jive.error.rest.soy.errorSaving","soy!jive.content.comment.rte_message"],function(e,c,d,f,g,b,a){jive.oo.Class.extend(function(h){h.init=function(){var i;this.el=".js-extended-authors";this.source=new d();this.view=new f();this.bindEvents()};h.bindEvents=function(){e("body").on("click",this.el,this.showAuthors.bind(this));this.view.addListener("removeAuthor",this.handleRemoveAuthor.bind(this))};h.showAuthors=function(j){var i=this.getObject(e(j.target));this.source.getAuthors(i).then(this.view.show.bind(this.view,j.target)).fail(this.errorHandler.bind(this,g))};h.handleRemoveAuthor=function(l,k){var i=this,j=this.getObject(e(l).closest(this.el));this.source.removeAuthor(j,k).then(function(){return i.source.getAuthors(j)}).then(function(o){if(!o||o.length===0){var n=e(l).closest(".js-ext-invites"),m=e(".js-shared-group-text"),p=m.length>0?n.find(".js-ext-invites-text"):n;p.fadeOut(function(){if(m.length>0){m.fadeIn();n.removeClass("js-ext-invites")}});e(".js-rte-message").replaceWith(a({externallyVisible:m.length>0,extendedAuthors:false,objectType:j.objectType,objectId:j.objectId}))}}).fail(this.errorHandler.bind(this,b))};h.errorHandler=function(i){e(i({href:_jive_base_url})).message({style:"error"})};h.getObject=function(i){return i.data()}})()});
;
goog.provide("jive.content.comment.extendedAuthors");
jive.content.comment.extendedAuthors=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;var listText__soy3=new soy.StringBuilder('<a href="#" class="js-extended-authors j-extended-authors" data-objecttype="',soy.$$escapeHtml(opt_data.objectType),'" data-objectid="',soy.$$escapeHtml(opt_data.objectId),'">',opt_data.externallyVisible?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.warn.reply.partner.and.extended.people"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.warn.reply.extended.authors.people"),
[])),"</a>");listText__soy3=listText__soy3.toString();output.append(opt_data.externallyVisible?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.warn.reply.partner.and.extended"),[new soydata.VERY_UNSAFE.ordainSanitizedHtml(listText__soy3)])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.warn.reply.extended.authors"),[new soydata.VERY_UNSAFE.ordainSanitizedHtml(listText__soy3)])));return opt_sb?"":output.toString()};
;
goog.provide("jive.content.comment.rte_message");
jive.content.comment.rte_message=function(opt_data,opt_sb){opt_data=opt_data||{};var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-rte-message js-rte-message">');if(opt_data.extendedAuthors||opt_data.externallyVisible){output.append('<span class="jive-icon-med jive-icon-partner"></span><span class="font-color-meta-light j-browse-external-access"><em>');if(opt_data.extendedAuthors)jive.content.comment.extendedAuthors(opt_data,output);else output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("partner.content.reply.warn.visible"),
[])));output.append("</em></span>")}output.append("</div>");return opt_sb?"":output.toString()};
;
define("apps/shared/models/location_state",function(){if(jive.LocationState&&jive.locationState){return jive.locationState}jive.LocationState=jive.oo.Class.extend(function(a){var b=jQuery;jive.conc.observable(this);a.defaults={supportPushState:true,supportFragment:true};a.init=function(c){var f=b.extend({},this.defaults,c||{}),e=location.href,g=this;this.location=e;this.description="";this.manuallyUpdatingHash=false;this.supportPushState=f.supportPushState&&!!(window.history&&window.history.pushState);this.supportFragment=f.supportFragment;var d=[this.supportPushState?"popstate":null,this.supportFragment?"hashchange":null].filter(function(h){return !!h}).join(" ");b(window).bind(d,function(i){var h=location.href;if(g.afterInit||h!==e){g.location=h;if(!g.manuallyUpdatingHash){g.emitChange(g.current(),g.description,h)}g.manuallyUpdatingHash=false}})};this.get=function(c){return this.current()[c]};this.getState=function(){return this.current()};this.getEphemeralState=function(){return b.deparam.fragment()};a.getPermaState=function(){return b.deparam.querystring()};this.pushState=function(e,c){var d=b.extend(this.current(),e);Object.keys(e).forEach(function(f){if(typeof e[f]=="undefined"||(b.isArray(e[f])&&e[f].length<1)){delete d[f]}});this.setState(d,c)};this.setState=function(g,f,e){var d=this.lastLocation;this.location=this.supportPushState?this.newLocation(g,e):this.newFragment(g,e);this.description=f||"";this.emitChange(g,f,this.location);if(this.location!==d){if(this.supportPushState){try{history.pushState(this.current(),this.description,this.location)}catch(c){window.location=this.location}}else{if(this.supportFragment){this.updateLocationHash(this.location)}}}};this.watchParam=function(d,e){var c=this.getState()[d];this.addListener("change",function(i,h,g){var f=i[d];if(f!==c){e(f,i,h,g);c=f}})};a.current=function(){var e=this.location.match(/\?/)?b.deparam.querystring(this.location):{},d=this.location.match(/#/)?b.deparam.fragment(this.location):{};var f=b.extend({},e,d);var c={};Object.keys(f).forEach(function(g){if(f[g]!==""){c[g]=f[g]}});return c};a.newLocation=function(e,c){var d;if(!c){d=location.href.split(/[?#]/)[0]}else{if(c.slice(0,_jive_base_url.length)===_jive_base_url||c.match(/^[a-z]+:/i)){d=c}else{d=jive.app.url({path:"/"+c.replace(/^\//,"")})}}return b.param.querystring(d,e)};a.newFragment=function(g,e){var c={},f=b.deparam.querystring(),h;h=location.href.split("#")[0];if(e){g.nPLoc=e}Object.keys(f).forEach(function(i){if(typeof g[i]==="undefined"||(b.isArray(g[i])&&g[i].length<1)){c[i]=""}});Object.keys(g).forEach(function(i){if(f[i]!==String(g[i])){c[i]=g[i]}});var d=b.param.fragment(h,c);if(/#[^=&]+=$/.test(d)){d=d.substring(0,d.length-1)}return d};a.emitChange=function(e,d,c){if(c!==this.lastLocation){this.emit("change",e,d,c);this.lastLocation=c;this.afterInit=true}else{this.emit("noChange",e,d,c)}};a.updateLocationHash=function(d){var c=this;function e(){c.preserveScrollPosition(d.split("#")[1],function(){c.manuallyUpdatingHash=true;location.href=d})}if(b.browser.msie&&b.browser.version<8){(this.locationHashTimeouts||[]).forEach(function(f){clearTimeout(f)});this.locationHashTimeouts=[];this.locationHashTimeouts.push(setTimeout(function(){c.locationHashTimeouts.push(setTimeout(e,100))},100))}else{e()}};a.preserveScrollPosition=function(c,e){var d;if(c){d=b(window).scrollTop();e();b(window).scrollTop(d)}else{e()}}});jive.locationState=new jive.LocationState();return jive.locationState});
;
goog.provide("jive.shared.soy.pageUrl");
jive.shared.soy.pageUrl=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.urlParams?soy.$$escapeHtml(opt_data.urlPath)+soy.$$escapeHtml(Object.keys(jQuery.extend({},opt_data.urlParams,function(){var map={};var pairs=[["start",opt_data.page>1?(opt_data.page-1)*opt_data.pageSize:[]]];for(var i=0;i<pairs.length;i+=1)map[pairs[i][0]]=pairs[i][1];return map}())).length>0?"?"+jQuery.param(jQuery.extend({},opt_data.urlParams,function(){var map={};var pairs=[["start",
opt_data.page>1?(opt_data.page-1)*opt_data.pageSize:[]]];for(var i=0;i<pairs.length;i+=1)map[pairs[i][0]]=pairs[i][1];return map}())):""):soy.$$escapeHtml(opt_data.urlPath)+soy.$$escapeHtml(Object.keys(function(){var map={};var pairs=[["start",opt_data.page>1?(opt_data.page-1)*opt_data.pageSize:[]]];for(var i=0;i<pairs.length;i+=1)map[pairs[i][0]]=pairs[i][1];return map}()).length>0?"?"+jQuery.param(function(){var map={};var pairs=[["start",opt_data.page>1?(opt_data.page-1)*opt_data.pageSize:[]]];
for(var i=0;i<pairs.length;i+=1)map[pairs[i][0]]=pairs[i][1];return map}()):""));return opt_sb?"":output.toString()};
;
goog.provide("jive.shared.soy.pageToStart");jive.shared.soy.pageToStart=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$escapeHtml((opt_data.page-1)*opt_data.pageSize));return opt_sb?"":output.toString()};
;
goog.provide("jive.shared.soy.numberedPageLink");
jive.shared.soy.numberedPageLink=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.active){output.append('<a href="');jive.shared.soy.pageUrl(soy.$$augmentMap(opt_data,{page:opt_data.number}),output);output.append('" class="j-pagination-current font-color-normal" title="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("global.numbered_page_title"),[opt_data.number])),'" data-start="');jive.shared.soy.pageToStart(soy.$$augmentMap(opt_data,{page:opt_data.number}),
output);output.append('"><strong>',soy.$$escapeHtml(opt_data.number),"</strong></a>")}else{output.append('<a href="');jive.shared.soy.pageUrl(soy.$$augmentMap(opt_data,{page:opt_data.number}),output);output.append('" title="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("global.numbered_page_title"),[opt_data.number])),'" data-start="');jive.shared.soy.pageToStart(soy.$$augmentMap(opt_data,{page:opt_data.number}),output);output.append('">',soy.$$escapeHtml(opt_data.number),"</a>")}return opt_sb?
"":output.toString()};
;
goog.provide("jive.shared.soy.paginationLinks");
jive.shared.soy.paginationLinks=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-pagination"',opt_data.elementID?'id="'+soy.$$escapeHtmlAttribute(opt_data.elementID)+'"':"",opt_data.max<=1&&!opt_data.alwaysShow?'style="display:none"':"",">");if(opt_data.current>=1)jive.shared.soy.numberedPageLink(soy.$$augmentMap(opt_data,{number:1,active:opt_data.current==1}),output);output.append(opt_data.current>5?'<span class="ellipsis">&hellip;</span>':"");var iInit21=
opt_data.current-3;var iLimit21=opt_data.current+4;for(var i21=iInit21;i21<iLimit21;i21++)if(i21>1&&i21<=opt_data.max)jive.shared.soy.numberedPageLink(soy.$$augmentMap(opt_data,{number:i21,active:opt_data.current==i21}),output);output.append(opt_data.max>opt_data.current+4?'<span class="ellipsis">&hellip;</span>':"");if(opt_data.max>opt_data.current+3)jive.shared.soy.numberedPageLink(soy.$$augmentMap(opt_data,{number:opt_data.max}),output);output.append('<span class="j-pagination-prevnext">');if(opt_data.current>
1){output.append('<a href="');jive.shared.soy.pageUrl(soy.$$augmentMap(opt_data,{page:opt_data.current-1}),output);output.append('" class="j-pagination-prev" title="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("global.previous_page_title"),[])),'" data-start="');jive.shared.soy.pageToStart(soy.$$augmentMap(opt_data,{page:opt_data.current-1}),output);output.append('">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.previous"),[])),"</a>")}else output.append('<span class="j-pagination-prev j-disabled font-color-meta">',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.previous"),[])),"</span>");if(opt_data.current<opt_data.max){output.append('<a href="');jive.shared.soy.pageUrl(soy.$$augmentMap(opt_data,{page:opt_data.current+1}),output);output.append('" class="j-pagination-next" title="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("global.next_page_title"),[])),'" data-start="');jive.shared.soy.pageToStart(soy.$$augmentMap(opt_data,{page:opt_data.current+1}),output);output.append('">',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.next"),[])),"</a>")}else output.append('<span class="j-pagination-next j-disabled font-color-meta">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.next"),[])),"</span>");output.append("</span></div>");return opt_sb?"":output.toString()};
;
define("apps/shared/views/pagination_links",function(){jive.PaginationLinks=jive.AbstractView.extend(function($protect$$){var $$$$=jQuery;$protect$$.init=function $$protect$$$init$($options$$){var $view$$=this;$options$$=$options$$||{};$$$$(document).ready(function(){$view$$.content=$options$$.element?$$$$($options$$.element||".j-pagination"):$$$$(jive.shared.soy.paginationLinks($options$$.params));$view$$.content.find("a[data-start]").each(function(){$j(this).attr("href",$j(this).attr("href").replace("/community/community/content",
"/community/content"));$j(this).attr("href",$j(this).attr("href").replace("/community/community/people","/community/people"));$j(this).attr("href",$j(this).attr("href").replace("/community/community/places","/community/places"))});$view$$.content.find("a[data-start]").click(function($event$$){var $start$$=parseInt($$$$(this).data("start"),10),$scrollTarget$$=$options$$.scrollTo?$$$$($options$$.scrollTo):$$$$();$view$$.emit("start",$start$$);0<$scrollTarget$$.length&&!$view$$.inView($scrollTarget$$)&&
$$$$.scrollTo($scrollTarget$$,200);$event$$.preventDefault()})})};$protect$$.inView=function $$protect$$$inView$($elem$$){var $docViewTop$$=$$$$(window).scrollTop(),$docViewBottom$$=$docViewTop$$+$$$$(window).height(),$elemTop$$=$$$$($elem$$).offset().top;return $elemTop$$+$$$$($elem$$).height()>=$docViewTop$$&&$elemTop$$<=$docViewBottom$$}});return jive.PaginationLinks});
;
define("apps/shared/controllers/paginated",function(){jive.Paginated=jive.oo.Class.extend(function(a){var c=jQuery,b;a.loadPage=jive.oo._abstract;a.initPagination=function(e,f){var d=this;f=f||{};this.defaultState=c.extend({start:0,numResults:20},e);this.promises=[];this.locationState=f.locationState||jive.locationState;this.paramFilter=f.paramFilter;this.linkViewClass=f.viewClass||jive.PaginationLinks;this.scrollTo=f.scrollTo;this.links=[];this.locationState.addListener("change",function(g){if(d.rollingBack){d.rollingBack=false;return}d.emitChange(g)});c(document).ready(function(){jive.conc.nextTick(function(){var g=d.locationState.getEphemeralState();if(Object.keys(g).length>0){d.emitChange(d.locationState.getState())}});if(c(f.paginationSelector||".j-pagination").length>0){d.links=c(f.paginationSelector||".j-pagination").toArray().map(function(g){return d.buildLinks({element:g})})}else{d.links=[d.buildLinks()]}})};a.pushState=function(i){var e=this.locationState.getState(),f=this.paramFilter?this.paramFilter(e):e,h=new jive.conc.Promise(),d=this;var g=Object.keys(i).reduce(function(l,j){if(d.defaultState.hasOwnProperty(j)&&d.deepEqual(d.defaultState[j],i[j])){l[j]=b}else{l[j]=i[j]}return l},{});Object.keys(f).forEach(function(j){if(f.hasOwnProperty(j)&&typeof f[j]=="undefined"){g[j]=b}});this.lastState=this.locationState.getState();this.locationState.pushState(g);this.promises.push(h);return h};a.getState=function(){return this.normalized(this.locationState.getState())};a.rollback=function(){if(this.lastState){this.rollingBack=true;this.locationState.setState(this.lastState)}};a.normalized=function(g){var e=this.paramFilter?this.paramFilter(g):g,f=c.extend({},this.defaultState,e),d=this;Object.keys(f).forEach(function(h){if(c.isArray(d.defaultState[h])&&!c.isArray(f[h])){f[h]=[f[h]]}else{if(c.isArray(d.defaultState[h])&&f[h].length<1){f[h]=d.defaultState[h]}}});return f};a.emitChange=function(e){var d=this,f=c(document.activeElement);d.loadPage(d.normalized(e)).addCallback(function(g,h){if(jQuery.contains(document.body,f[0])){if(f.is(":focusable")){f.focus()}}else{if(f.attr("id")){$j("#"+f.attr("id").replace(/[!"#$%&'()*+,.\/:;<=>?@\[\\\]^`{|}~]/g,"\\$&")).focus()}}d.updatePaginationLinks(g,h);d.promises.forEach(function(i){i.emitSuccess()});d.promises=[];c(".js-updatable-link").each(function(){var i=c(this),j=i.data("urlParams");if(j){i.attr("href",location.pathname+"?"+c.param(c.extend(e,j)))}})}).addErrback(function(){d.promises.forEach(function(g){g.emitError()});d.promises=[];d.rollback()})};a.buildLinks=function(f){f=f||{};var e=new this.linkViewClass(c.extend({},f,{params:c.extend({urlParams:this.locationState.getState(),urlPath:location.pathname,pageSize:this.getState().numResults},f.params),scrollTo:this.scrollTo})),d=this;if(!e._paginatedListening){e.addListener("start",function(g){d.setStart(g)});e.addListener("page",function(g){d.setPage(g)});e._paginatedListening=true}return e};a.updatePaginationLinks=function(e,f){var g=this.links,d=this;this.links=g.map(function(){return d.buildLinks({params:{current:e,max:f}})});g.forEach(function(h,j){h.replaceWith(d.links[j])})};a.setStart=function(e){var d=parseInt(e,10)||0;this.pushState({start:d})};a.setPage=function(d){this.setStart(this.pageToStart(d))};a.pageToStart=function(e,d){d=d||this.getState().numResults;return(e-1)*d};a.startToPage=function(e,d){d=d||this.getState().numResults;return(e/d)+1};a.deepEqual=function(e,d){if(c.isArray(e)&&c.isArray(d)){return e.length==d.length&&e.every(function(g,f){return g==d[f]})}else{if(c.isArray(e)||c.isArray(d)){return false}else{return e==d}}}});return jive.Paginated});
;
define("apps/shared/views/tab_view",function(){jive.TabView=function(e,m){jive.conc.observable(this);m=m||{};var j=m.activeClass||"jive-body-tabcurrent",a=m.tabSelector||".jive-body-tab",d=m.nameFromTab||function(n){return(n.attr("id")||"").replace(/-tab$/,"")},h=this;function l(){return $j(e).find(a)}function c(){return l().filter(function(){return $j(this).hasClass(j)})}function g(){return d(l().filter(function(){return $j(this).hasClass(j)}))}function f(n){l().each(function(){var p=$j(this),o=d(p);p.toggleClass(j,o==n)});l().each(function(){var q=$j(this),p=d(q),o=$j('[id="'+p+'"]');if(p==n){o.show()}else{o.hide()}})}function k(n){h.emit("tabSwitch",n,c())}function i(n){f(n);k(n)}function b(o,p){var n=l().filter(function(){return d($j(this))==o});n.toggle(!!p)}this.switchTo=i;this.setVisibility=b;this.activeTabName=g;this.activeTab=c;$j(document).ready(function(){$j(e).delegate(a,"click",function(p){var o=$j(this),n=d(o);i(n);p.preventDefault()});if(!l().hasClass(j)){l().first().trigger("click")}})};return jive.TabView});
;
jive.namespace("SharedViews");define("apps/shared/views/rte_view",function(){jive.SharedViews.RteView=$Class.extend({init:function(a,b){this._preferredMode=window.preferredMode||b.preferredMode||"advanced";this._container=$j(a);this._formActionContainer=(b.formActionContainer)?$j(b.formActionContainer):this._container;this._rteDisabledBrowser=b.rteDisabledBrowser;this._resourceID=b.resourceID;this._resourceType=b.resourceType;this._isAnonymous=b.isAnonymous;this._templateName=b.templateName||"rte-template";this._bodyContent=b.bodyContent;this._settingsID=b.settingsID||"mini";this._i18n=b.i18n;this.images_enabled=b.imagesEnabled;var c=this;$j(document).ready(function(){c._render();if(!c._rteDisabledBrowser){c._createRTE()}c._addListeners()})},remove:function(){if(!this._rteDisabledBrowser){if(this._rte){this._rte.destroy()}window.editor.clear("wysiwygtext");jive.rte.multiRTE=jive.rte.multiRTE.filter(function(a){return a!="wysiwygtext"})}this._container.find("form").remove();$j(window).unbind("unload",this._unloadCallback);this.emit("remove")},val:function(a){if(a){this._rte.setHTML(a);return this}else{return this._getContentBody()}},setPreviewButtonText:function(a){this._container.find("[name=preview]").val(a)},focus:function(){this._rte.tinymceFocus()},_initEditor:function(){this._currentMode="advanced";var a=this;var b=new jive.rte.RTEListener();b.doneTogglingMode=function(){if(a._currentMode=="advanced"){a._currentMode="rawhtml"}else{a._currentMode="advanced"}a._refreshLinks();a.emit("toggle",a._currentMode)};this._rte.addListener(b);if(this._preferredMode=="rawhtml"){this._rte.toggleEditorMode("wysiwygtext")}else{if(tinymce.isIE){this._rte.toggleEditorMode();this._rte.toggleEditorMode()}}},_initRTE:function(){var a=this;if(this._rte.isTextOnly()){$j("#wysiwyg-panel").removeClass("loading");this._preferredMode="rawhtml";this._currentMode="rawhtml";return}this._initEditor();this._refreshLinks();setTimeout(function(){a.focus()},0);this.emit("ready")},_createRTE:function(){var b=this;var a={images_enabled:this.images_enabled||false};this._rte=new jive.rte.RTE(jiveControl,"wysiwygtext",this._settingsID,a);window.editor.put("wysiwygtext",this._rte);jive.rte.multiRTE.push("wysiwygtext");var c=new jive.rte.RTEListener();c.initFinished=function(d){b._initRTE()};this._rte.addListener(c)},_getContentBody:function(){if(!this._rteDisabledBrowser){return this._rte.getHTML()}else{return this._container.find("textarea:visible").val()}},_getValues:function(){return{body:this._getContentBody()}},_postHandler:function(){this.emit("post",this._getValues());return false},_addListeners:function(){var a=this;this._formActionContainer.find("[name=post]").click(function(){return a._postHandler()}).end().find("[name=preview]").click(function(){a.emit("preview",a._getValues());return false}).end().find("[name=cancel]").click(function(){a.emit("cancel",a._getValues());a._unload();return false});this._container.find(".toggle_preferred_mode").click(function(){var b=a._currentMode;$j.post(jive.rest.url("/wikiText/preferredEditorMode/"+b)).then(function(){a._preferredMode=b;window.preferredMode=b;a._refreshLinks()});return false}).end().find(".toggle_html").click(function(){a._rte.toggleEditorMode("wysiwygtext");return false});this._unloadCallback=this._unload.bind(this);$j(window).bind("unload",this._unloadCallback)},_unload:(function(){}),_template:(function(){var b={};return function a(f,e){var c=/^[\w\-]+$/.test(f)?b[f]=b[f]||a(document.getElementById(f).innerHTML):new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+f.replace(/[\r\t\n]/g," ").replace(/(^|%>)(.+?)(<%|$)/,function(g,h,i,j){return h+d(i)+j}).split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("'")+"');}return p.join('');");return e?c(e):c;function d(g){return g.replace("'","&apos;").replace("\\","\\\\")}}})(),_render:function(){this._container.append(this._template(this._templateName,{body:this._bodyContent}))},_refreshLinks:function(){this._container.find(".toggle_html").toggle(this._currentMode=="rawhtml");this._container.find(".toggle_preferred_mode").toggle(this._preferredMode!=this._currentMode)}});jive.conc.observable(jive.SharedViews.RteView.prototype);return jive.SharedViews.RteView});
;
goog.provide("jive.shared.formwaiting.formWaitingOverlay");jive.shared.formwaiting.formWaitingOverlay=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="jive-js-form-disable jive-form-waiting-disable"><div class="',soy.$$escapeHtml(opt_data.bgCssClass),'"></div></div>');return opt_sb?"":output.toString()};
;
jive.namespace("shared");jive.shared.FormWaitingView=$Class.extend({init:function(a,b){this._$container=$j(a);b=b||{};if(b.containerPadding){this._containerPadding=b.containerPadding}else{this._containerPadding=this._$container.css("padding-left")==null?0:Number(this._$container.css("padding-left").replace("px",""))}this._buttonSelector=b.buttonSelector||"input[type=button], input[type=submit]";this._bgCssClass=b.bgCssClass||"jive-form-waiting-disable-bg"},disableForm:function(){var e=new jive.loader.LoaderView({size:"big"});if(this._$container.find(".jive-js-form-disable").length==0){var c={width:this._$container.innerWidth(),height:this._$container.innerHeight(),left:0,top:0};var d=$j(jive.shared.formwaiting.formWaitingOverlay({bgCssClass:this._bgCssClass}));for(var b in c){d.css(b,c[b]+"px")}d.prependTo(this._$container);var a=e.getContent();e.appendTo(d);a.css("left",(c.width/2-a.width()/2)+"px");a.css("top",(c.height/2-a.height()/2)+"px");this._$container.find(this._buttonSelector).prop("disabled",true)}},enableForm:function(){this._$container.find(".jive-js-form-disable").remove();this._$container.find(this._buttonSelector).prop("disabled",false)},isFormEnabled:function(){return this._$container.find(".jive-js-form-disable").length==0}});define("apps/shared/views/form_waiting_view",function(){return jive.shared.FormWaitingView});
;
define("apps/shared/models/rest_service",["jquery"],function($$$$){window.jive.RestService=jive.oo.Class.extend(function($protect$$){$protect$$.resourceType="abstract";$protect$$.displayGenericErrorMessages=!0;$protect$$.putOnUpdate=!1;$protect$$.init=function $$protect$$$init$($options$$){this.pluralizedResourceType=this.pluralizedResourceType||this.resourceType+"s";var $endpoint$$=jive.rest.url("/"+this.pluralizedResourceType);this.POST_RESOURCE_ENDPOINT=this.RESOURCE_ENDPOINT=$options$$&&$options$$.forceSecure?
jive.secure($endpoint$$):$endpoint$$;this.defaultParams={}};this.suppressGenericErrorMessages=function $this$suppressGenericErrorMessages$(){this.displayGenericErrorMessages=!1};$protect$$.commonAjaxRequest=function $$protect$$$commonAjaxRequest$($promise$$,$type$$,$settings$$){var $source$$=this,$error$$,$ajaxSettings$$;$type$$=$type$$.toUpperCase();"POST"==$type$$?($ajaxSettings$$={contentType:"application/json; charset\x3dutf-8"},$error$$=this.errorSaving):"GET"==$type$$?$error$$=this.errorFinding:
"PUT"==$type$$?($ajaxSettings$$={contentType:"application/json; charset\x3dutf-8"},$error$$=this.errorUpdating):"DELETE"==$type$$&&($error$$=this.errorDestroying);"undefined"!=typeof $settings$$.url&&"POST"==$type$$&&(-1<$settings$$.url.indexOf("/v2/rest/comments/")&&(pfTrackEvent(!0,_jive_current_user.username,"event5","commentPosted"),e14ConversionPixel("AddComment")),-1<$settings$$.url.indexOf("/v2/rest/message/")&&(pfTrackEvent(!0,_jive_current_user.username,"event4","replyPosted"),e14ConversionPixel("AddComment")));
$$$$.ajax($$$$.extend({type:$type$$,dataType:"json",success:function($data$$){$source$$.normalizeID($data$$);$promise$$.emitSuccess($data$$)},error:this.errorCallback($promise$$,$error$$),timeout:12E4},$ajaxSettings$$||{},$settings$$));return $promise$$};this.save=function $this$save$($resource$$){this.normalizeID($resource$$);var $url$$=this.saveUrl($resource$$),$method$$=this.saveMethod($resource$$);return this.commonAjaxRequest(new jive.conc.Promise,$method$$,{url:$url$$,data:JSON.stringify(this.withoutId($resource$$))},
$resource$$)};this.get=function $this$get$($id$$,$params$$){var $url$$=this.RESOURCE_ENDPOINT+"/"+$id$$,$data$$=jQuery.extend({},this.defaultParams,$params$$||{});return this.commonAjaxRequest(new jive.conc.Promise,"GET",{url:$url$$,data:$data$$})};this.findAll=function $this$findAll$($data$$23_params$$){var $url$$=this.RESOURCE_ENDPOINT;$data$$23_params$$=$$$$.extend({},this.defaultParams,$data$$23_params$$);return this.commonAjaxRequest(new jive.conc.Promise,"GET",{url:$url$$,data:$data$$23_params$$})};
this.destroy=function $this$destroy$($id$$){var $promise$$=new jive.conc.Promise,$source$$=this;$id$$.hasOwnProperty("id")&&($id$$=$id$$.id);$$$$.ajax({type:"DELETE",url:this.RESOURCE_ENDPOINT+"/"+$id$$,success:function(){$promise$$.emitSuccess()},error:function($xhr$$){$source$$.maybeEmitError($promise$$,$source$$.errorDestroying,[null,$xhr$$&&$xhr$$.status])},timeout:3E4});return $promise$$};$protect$$.normalizeID=function $$protect$$$normalizeID$($resource$$){var $id$$=$resource$$?$resource$$.id||
$resource$$[this.resourceType+"ID"]:null;$resource$$&&$id$$&&($resource$$.id=$id$$)};$protect$$.unwrapResponse=function $$protect$$$unwrapResponse$($resp$$){return 1===Object.keys($resp$$).length?$resp$$[Object.keys($resp$$)[0]]:$resp$$};$protect$$.errorCallback=function $$protect$$$errorCallback$($promise$$,$genericError$$){var $source$$=this;return function($xhr$$,$textStatus$$){var $jsonResp$$,$message$$,$code$$;try{$jsonResp$$=JSON.parse($xhr$$.responseText)}catch($e$$){}$message$$=$jsonResp$$?
$jsonResp$$.message||$jsonResp$$.error||null:null;$code$$=$jsonResp$$&&$jsonResp$$.code?$jsonResp$$.code:$xhr$$.status;"error"==$textStatus$$&&"4043"==$code$$&&400==$xhr$$.status?($source$$.displayError("\x3cp\x3e"+$message$$+"\x3c/p\x3e"),$promise$$.emitError.apply($promise$$,[$message$$,$code$$])):"CUSTOM"===$code$$?($source$$.displayError(jive.error.rest.soy[$jsonResp$$.errorCode]($jsonResp$$)),$promise$$.emitError.apply($promise$$,[$message$$,$code$$])):415===$xhr$$.status?($source$$.displayError(jive.error.rest.soy.errorUploadImageInvalid()),
$promise$$.emitError.apply($promise$$,[$message$$,$code$$])):("error"!==$textStatus$$||100<=$xhr$$.status)&&$source$$.maybeEmitError($promise$$,$genericError$$,[$message$$,$code$$])}};$protect$$.maybeEmitError=function $$protect$$$maybeEmitError$($promise$$,$genericError$$,$args$$){this.displayGenericErrorMessages&&this.displayError($genericError$$());$promise$$.emitError.apply($promise$$,$args$$)};$protect$$.displayError=function $$protect$$$displayError$($message$$){$$$$($message$$).message({style:"error"})};
$protect$$.errorSaving=function $$protect$$$errorSaving$(){return jive.error.rest.soy.errorSaving({href:window.location})};$protect$$.errorFinding=function $$protect$$$errorFinding$(){return jive.error.rest.soy.errorFinding({href:window.location})};$protect$$.errorUpdating=function $$protect$$$errorUpdating$(){return jive.error.rest.soy.errorUpdating({href:window.location})};$protect$$.errorDestroying=function $$protect$$$errorDestroying$(){return jive.error.rest.soy.errorDestroying({href:window.location})};
$protect$$.withoutId=function $$protect$$$withoutId$($resource$$){var $obj$$={};Object.keys($resource$$).forEach(function($k$$){"id"!=$k$$&&($obj$$[$k$$]=$resource$$[$k$$])});return $obj$$};$protect$$.saveUrl=function $$protect$$$saveUrl$($resource$$){return $resource$$.id?this.RESOURCE_ENDPOINT+"/"+$resource$$.id:this.POST_RESOURCE_ENDPOINT};$protect$$.saveMethod=function $$protect$$$saveMethod$($resource$$){return $resource$$.id&&this.putOnUpdate?"PUT":"POST"}});return window.jive.RestService});
;
define("apps/shared/models/nested_rest_service",["apps/shared/models/rest_service"],function(a){jive.NestedRestService=a.extend(function(b,c){b.init=function(d){c.init.call(this,d);this.parentType=d.parentType;this.parentID=d.parentID;this.POST_RESOURCE_ENDPOINT=[this.RESOURCE_ENDPOINT,this.parentType,this.parentID].join("/")}});return jive.NestedRestService});
;
jive.namespace("CommentApp");jive.CommentApp.CommentSource=jive.NestedRestService.extend(function(a,c){a.resourceType="comment";a.init=function(d){this.parentType=d.resourceType;this.parentID=d.resourceID;this.listAction=d.listAction;this.location=d.location;this.commentMode=d.commentMode;this.isPrintPreview=Boolean(d.isPrintPreview);this.contentObject=d.contentObject;c.init.call(this,{parentType:this.parentType,parentID:this.parentID})};a.errorCallback=function(f,d){var e=this;return function(m,n,j){var k,i,h,g;try{k=JSON.parse(m.responseText);if(k){if(k.error){i=k.error.message?k.error.message:null;g=k.error.exStorageError?true:false;h=k.error.status?k.error.status:500}else{if(j&&k.code){i=k.message?k.message:null;h=k.code?k.code:500;g=false}}}if(n!=="error"||m.status>=100){if(!g){if(!i){i=d()}if(!h){h=500}}try{$j("<p>"+i+"</p>").message({style:"error"})}catch(l){if(console&&console.log){console.log(l)}}f.emitError.apply(f,[i,h])}}catch(l){a.displayError(d())}}};this.destroy=function(f){var e=new jive.conc.Promise(),d=this;if(f.hasOwnProperty("id")){f=f.id}$j.ajax({type:"DELETE",url:this.RESOURCE_ENDPOINT+"/"+f,success:function(){e.emitSuccess()},error:function(k,l){var i,h,g;try{i=JSON.parse(k.responseText);h=(i&&i.error&&i.error.message)?i.error.message:null;exStorageError=(i&&i.error&&i.error.exStorageError)?true:false;g=(i&&i.error&&i.error.status)?i.error.status:500;if(l!=="error"||k.status>=100){if(exStorageError){try{$j("<p>"+h+"</p>").message({style:"error"})}catch(j){if(console&&console.log){console.log(j)}}e.emitError.apply(e,[h,g])}}}catch(j){d.maybeEmitError(e,d.errorDestroying,[null,k&&k.status])}},timeout:30000});return e};var b=1;this.save=function(e){var d=$j.deparam.querystring().fromQ?$j.deparam.querystring().fromQ:$j.deparam.fragment().fromQ;if(d){e.fromQuest=d}return c.save.call(this,e)};this.getAllAsHTML=function(e){var d=new jive.conc.Promise();$j.ajax({type:"GET",url:this.listAction,dataType:"html",cache:false,data:$j.extend({location:this.location,mode:this.commentMode,isPrintPreview:this.isPrintPreview},this.contentObject,e),success:function(f){d.emitSuccess(f)},error:function(f){d.emitError(f)}});return d};this.getPreview=function(e){var d=new jive.conc.Promise();$j.ajax({type:"POST",url:this.POST_COMMENT_ENDPOINT+"/preview",dataType:"html",cache:false,data:{commentBody:e.body},success:function(f){d.emitSuccess(f)},error:function(f){d.emitError(f)}});return d}});define("apps/comment_app/models/comment_source",function(){return jive.CommentApp.CommentSource});
;
jive.namespace("CommentApp");jive.CommentApp.Comment=$Class.extend({init:function(b){var a=this;Object.keys(b).forEach(function(c){if(c!="outcome"){a[c]=b[c]}})}});define("apps/comment_app/models/comment",function(){return jive.CommentApp.Comment});
;
goog.provide("jive.CommentApp.soy.outcomeAttachment");
jive.CommentApp.soy.outcomeAttachment=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<span>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("cmnt.outcome.attached"),[]))," ");jive.outcomes.badge.badgeRaw({tagName:"span",outcomeType:String(opt_data.outcomeType.name).toLowerCase(),embedded:true},output);output.append('<a href="#" class="j-remove-outcome js-remove-outcome" title="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.remove"),[])),'"><span class="jive-icon-sml jive-glyph-remove"></span><span class="j-508-label"></span></a></span>');
return opt_sb?"":output.toString()};
;
define("apps/outcomes/replyOutcomeView",["jquery","apps/shared/controllers/localexchange","apps/outcomes/outcomesMain"],function(e,b){function a(g){g.preventDefault();var h=e(this).closest(".js-reply-outcome-action-container");h.find("a.js-reply-outcome-button").show();h.find(".js-reply-outcome-badge-container").hide().children().remove();h.closest(".jive-js-addReply").find(".js-outcome-attachment").removeData("outcomeType").val("")}function f(i,g){g.find("a.js-reply-outcome-button").hide();var h=jive.CommentApp.soy.outcomeAttachment({outcomeType:i});g.find(".js-reply-outcome-badge-container").show().html(h);g.find(".js-remove-outcome").on("click",a);g.find(".js-outcome-attachment").data("outcomeType",i).val(i.name.toLowerCase())}function c(g){return b.emitP("outcome.getDescendantOutcomeTypesForCreate",g)}function d(g,h){return c(h).then(function(i){if(i.length>0){g.find(".js-reply-outcome-action-container").show();g.find(".js-reply-outcome-button").on("click",function(k){k.preventDefault();var l=[];e.each(i,function(m,n){l.push({labelSuffix:n.name.toLowerCase()+".post",actionData:JSON.stringify(n),event:"attachOutcome"})});var j={context:e(this),hoverSelection:true,returnPopover:true};e(jive.outcomes.action.actionMenu({outcomes:l,actions:[]})).on("click","a.js-actionItem",function(n){var o=e(this);var m=o.data("actionData");f(m,g);n.preventDefault();j.closeFunc()}).popover(j)})}})}return d});
;
jive.namespace("CommentApp");define("apps/comment_app/views/comment_list_view",["jquery","apps/outcomes/replyOutcomeView","apps/shared/controllers/localexchange","apps/outcomes/viewUtil","apps/shared/views/rte_quote_source"],function(e,b,a,d,c){jive.CommentApp.CommentListView=jive.AbstractView.extend(function(f){var i=new jive.Modalizer.Main({width:"medium"}),k;jive.conc.observable(this);function g(l){return e(l).closest(".jive-comment-actions").attr("data-comment-id")}function h(l){c.trigger("quote:set",e(l).data())}this.init=function(l,o){var m=this;k=m;this.container="#"+l;this.containerID=l;this.isThreaded=o.isThreaded;this.i18n=o.i18n;this.options=o;this.showReplies=!o.isFinalized||window.location.hash.length>0;e(document).ready(function(){e(m.container).delegate("#inline-comment-sort","change",function(){m.emit("sortChange",e(this).val())});m.bindEvents()});this.initFinalized();function n(){m.scrollToPermalink();a.removeListener("heightChanged",n)}a.addListener("heightChanged",n);a.addListener("outcome.expandCollapsedComments",function(){k.showReplies=true;k.checkCommentRollupState()});a.addListener("outcome.collapseComments",function(){k.showReplies=false;k.checkCommentRollupState()})};this.getContent=function(){return e(this.container)};this.closeForm=function(){if(this.form){this.form.remove();this.form=null;e(".jive-comment-add-link").show();this.emit("formClosed")}};this.renderForm=function(q,n,p,m){var l=this;this.closeForm();var o=q===jive.CommentApp.EditFormView;if(o){this.hideShowCommentForm(p.getDOMElement(),false)}else{this.hideShowCommentForm(null,false)}e(".jive-comment-add-link").hide();this.form=new q(n,m);n.parent(".jive-rendered-content").removeClass("jive-rendered-content");this.proxyListener(this.form,"post","saveComment",function(r,s){s.addCallback(function(){l.closeForm()}).addErrback(function(u,t){l.displayError(u,t)})});this.proxyListener(this.form,"post","savedComment");this.proxyListener(this.form,"cancel","cancelComment",function(){l.closeForm();l.hideShowCommentForm(null,true)});this.form.addListener("remove",function(){if(o){p.hideCommentEdit()}})};f.renderPostForm=function(m,o){var l=this.commentForm(o);var n=e(l).find(".jive-comment-post");this.renderForm(jive.CommentApp.FormView,n,o,e.extend({i18n:this.i18n},m));return l};f.renderEditForm=function(n,l){var m=e(n.getDOMElement());if(!m.is(".jive-comment-edit")){m=m.find(".jive-comment-edit:first")}return this.renderForm(jive.CommentApp.EditFormView,m,n,l)};f.commentView=function j(m){var l=e("#comment-"+m);return(new jive.CommentApp.CommentView(l,e.extend({id:m},this.options)))};this.editComment=function(n,o){this.hideShowCommentForm(null,true);var l=this.commentView(n),m=e("#comment-"+o).find("a:has(.commentAdd):first");h(m);l.showCommentEdit();this.renderEditForm(l,e.extend({id:n},this.options))};this.deleteComment=function(m){var l=confirm(this.i18n.confirmDeleteComment);if(l){this.commentView(m).remove();this.emit("deleteComment",m)}};this.createReplyTo=function(o){var p={id:0,inReplyTo:{id:o}};this.emit("replyComment",p);var m=this.commentView(o),n=$j("#comment-"+o+" a .commentAdd").closest("a");h(n);var l=this.renderPostForm(e.extend({parentCommentID:o},this.options),m);b(l,{type:this.options.resourceType,id:this.options.resourceID});l.find(".jive-comment-textarea").focus()};this.createReply=function(){this.emit("createComment",{id:0});var l=this.renderPostForm(this.options);l.find(".jive-create-comment p.jive-comment-meta").hide();b(l,{type:this.options.resourceType,id:this.options.resourceID});l.find(".jive-comment-textarea").focus()};f.bindEvents=function(){var l=this;var m=e(this.container);m.on("vclick",".j-action-item > .js-actionItem",function(p){var o=e(this),n=o.data("event");p.preventDefault();if(n){a.emitP(n,d.getEd(o),undefined,o.data("parendId"))}else{i.modalize(o.attr("href"),o)}});m.on("vclick",".jive-comment-actions a:has(.commentEdit)",function(o){var n=g(this);var q=e(this).attr("data-parentID");var p={id:n};if(q){e.extend(p,{inReplyTo:{id:q}})}l.emit("editComment",p);l.editComment(n,q);o.preventDefault()});m.on("vclick",".jive-comment-actions a:has(.commentDelete)",function(o){var n=g(this);l.deleteComment(n);o.preventDefault()});m.on("vclick",".jive-comment-actions a:has(.commentAdd)",function(o){var n=g(this);l.createReplyTo(n);o.preventDefault()});m.on("vclick",".js-add-comment",function(n){l.createReply();n.preventDefault()})};f.scrollToPermalink=function(){var m=(window.location.hash.match(/^#([^\/].+)$/)||[])[1];m=encodeURIComponent(m);var l=m?e(this.container+' a[name="'+m+'"], '+this.container+' [id="'+m+'"]'):e();if(l.length>0){if(!this.getContent().is(":visible")&&window.tabView){window.tabView.setVisibility(this.containerID,true);window.tabView.switchTo(this.containerID)}e.scrollTo(l,100,{offset:{top:-20,left:-200}})}};this.setContent=function(l){var m=e(this.container).html(l);this.scrollToPermalink();jive.localexchange.emit("renderedContent",m)};this.displayError=function(m,l){if(l==401||l==403||l==4026||l===0){m=jive.i18n.sub(this.i18n.globalLoginRequired,'<a href="'+encodeURI(window.location).replace(/#.*$/,"")+'">',"</a>")}m=m||this.i18n.globalAjaxError;e("#jive-comment-error-box").show();e("#jive-comment-error").html(m).show()};this.displaySuccess=function(l){e("#success-moderation-edit").html('<div><span class="jive-icon-med jive-icon-warn"></span>'+l+"</div>").show();e.scrollTo(e("#success-moderation-edit"),100,{offset:{top:-40,left:0}})};this.setPreviewButtonText=function(l){};this.scrollTo=function(m){var l=e(this.container);if(!this.inView(l)){e.scrollTo(e(this.container),m||200,{offset:{top:-30,left:0}})}};f.inView=function(m){var o=e(window).scrollTop(),n=o+e(window).height(),l=e(m).offset().top;return((l>=o)&&(l<=n))};f.hideShowCommentForm=function(l,m){l=l||e(this.container).find(".jive-js-addReply");if(l.length===0){return}if(m){l.fadeOut("fast").remove()}else{l.fadeIn("fast");e.scrollTo(l,100,{offset:{top:-100,left:0},axis:"y"})}};f.listElement=function(){var l=e(this.container).find("ul.jive-comment:first");if(l.length===0){l=e("<ul/>",{"class":"jive-comment jive-comment-threaded clearfix jive-comment-indent-0"});e(this.container).find(".jive-comment-container").html(l)}return l};f.append=function(l){this.listElement().append(l)};f.commentForm=function(p){this.hideShowCommentForm(null,true);var m={commentMode:this.options.commentMode};if(p){e.extend(m,{commentID:p.getCommentID(),username:p.username()})}var n=e(jive.CommentApp.soy.renderReply(m));if(p){p.append(n);if(this.isThreaded){var o=p.indent(),l=parseInt(n.parent().css("margin-left"),10);n.css("margin-left",-o-l+"px")}}else{this.append(n)}return n};f.initFinalized=function(){$j("#jive-unroll-comments").off("click").on("click",function(l){l.preventDefault();k.showReplies=true;k.checkCommentRollupState()});k.checkCommentRollupState()};f.checkCommentRollupState=function(){if(!!window.location.hash){k.showReplies=true}if(k.showReplies){if($j("#jive-rolled-up-comments").is(":visible")){$j("#jive-rolled-up-comments").fadeOut(150,function(){$j("#jive-comment-tabs").fadeIn(200)})}}else{if(!$j("#jive-rolled-up-comments").is(":visible")){$j("#jive-comment-tabs").fadeOut(200,function(){$j("#jive-rolled-up-comments").fadeIn(150)})}}return e("#jive-rolled-up-replies, #jive-replies").promise()};this.beforeListLoad=function(){e(this.container).append('<div class="j-loader-box">'+this.i18n.loading+"</div>")}});return jive.CommentApp.CommentListView});
;
goog.provide("jive.CommentApp.soy.outcomeAttachmentMenu");
jive.CommentApp.soy.outcomeAttachmentMenu=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-reply-outcome-action-container js-reply-outcome-action-container" style="display: none;"><a href="#" class="font-color-meta js-reply-outcome-button">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.reply.actionButton.label"),[])),' <span class="j-ui-elem j-action-down-arrow"></span></a><div class="js-reply-outcome-badge-container" styles="display: none;"></div></div>');return opt_sb?
"":output.toString()};
;
goog.provide("jive.DiscussionApp.soy.renderReply");goog.provide("jive.DiscussionApp.soy.replyErrorMessage");
jive.DiscussionApp.soy.renderReply=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<li class="addReply jive-js-addReply" style="display:none"><div msgID="',soy.$$escapeHtml(opt_data.messageID),'" class="jive-thread-reply-indent0 jive-reply-add-inline"><div class="jive-thread-reply-indent-shadow"><div class="jive-thread-reply jive-thread-reply-self clearfix"><div class="jive-thread-reply-inline">',opt_data.moderated?'<div id="jive-moderation-box" class="jive-content-moderation-box"><span class="jive-icon-med jive-icon-warn"></span>'+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("mod.content.create"),[]))+"</div>":"",'<strong class="font-color-meta">',soy.$$escapeHtml(opt_data.i18n.forumThrdReplyTo),' <span class="replyToName">',soy.$$escapeHtml(opt_data.userName),'</span> <img src="');jive.resource.url({path:"/images/inline-reply-arrow.png"},output);output.append('" alt=""></strong>',opt_data.externallyVisible=="true"?"":"",opt_data.anonymous?'<div class="jive-comment-post-anonymous"><div><input id="reply-author" name="replyGuestName" type="text" required aria-required="true"><label for="reply-author">'+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.name"),[]))+'<span class="font-color-meta-light">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("blogs.vwpst.required.label"),[]))+'</span></label></div><div><input id="comment-email" name="replyGuestEmail" type="email" required aria-required="true"><label for="comment-email">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.email_address"),[]))+'<span class="font-color-meta-light">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("blogs.vwpst.rqdNotPblshd.label"),
[]))+"</span></label></div></div>":"",'<a class="font-color-meta advEditor" href="javascript:void(0);">',soy.$$escapeHtml(opt_data.i18n.advEditor),"</a>");jive.CommentApp.soy.outcomeAttachmentMenu(null,output);output.append('<p class="jive-discussion-post"></p></div></div></div></div></li>');return opt_sb?"":output.toString()};
jive.DiscussionApp.soy.replyErrorMessage=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(opt_data.key),[])));return opt_sb?"":output.toString()};
;
goog.provide("jive.i18n.keys.forumThrdNameRequiredText");jive.i18n.keys.forumThrdNameRequiredText=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("forum.thrd.name_required.text"),[])));return opt_sb?"":output.toString()};
;
goog.provide("jive.i18n.keys.forumThrdEmailRequiredText");jive.i18n.keys.forumThrdEmailRequiredText=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("forum.thrd.email_required.text"),[])));return opt_sb?"":output.toString()};
;
goog.provide("jive.i18n.keys.postErrPlsEnterBodyText");jive.i18n.keys.postErrPlsEnterBodyText=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("post.err.pls_enter_body.text"),[])));return opt_sb?"":output.toString()};
;
goog.provide("jive.i18n.keys.globalUnsavedChangesText");jive.i18n.keys.globalUnsavedChangesText=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.unsaved_changes.text"),[])));return opt_sb?"":output.toString()};
;
goog.provide("jive.i18n.keys.forumPostSaveAndEditText");jive.i18n.keys.forumPostSaveAndEditText=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("forum.post.save_and_edit.text"),[])));return opt_sb?"":output.toString()};
;
var form2js=(function(){function e(m,l,n,k,p){if(typeof n=="undefined"||n==null){n=true}if(typeof l=="undefined"||l==null){l="."}if(arguments.length<5){p=false}m=typeof m=="string"?document.getElementById(m):m;var q=[],j,o=0;if(m.constructor==Array||(typeof NodeList!="undefined"&&m.constructor==NodeList)){while(j=m[o++]){q=q.concat(d(j,k,p))}}else{q=d(m,k,p)}return b(q,n,l)}function b(s,A,C){var p={},q={},y,x,w,v,u,r,n,t,o,m,z,D,B;for(y=0;y<s.length;y++){u=s[y].value;if(A&&(u===""||u===null)){continue}D=s[y].name;B=D.split(C);r=[];n=p;t="";for(x=0;x<B.length;x++){z=B[x].split("][");if(z.length>1){for(w=0;w<z.length;w++){if(w==0){z[w]=z[w]+"]"}else{if(w==z.length-1){z[w]="["+z[w]}else{z[w]="["+z[w]+"]"}}m=z[w].match(/([a-z_]+)?\[([a-z_][a-z0-9_]+?)\]/i);if(m){for(v=1;v<m.length;v++){if(m[v]){r.push(m[v])}}}else{r.push(z[w])}}}else{r=r.concat(z)}}for(x=0;x<r.length;x++){z=r[x];if(z.indexOf("[]")>-1&&x==r.length-1){o=z.substr(0,z.indexOf("["));t+=o;if(!n[o]){n[o]=[]}n[o].push(u)}else{if(z.indexOf("[")>-1){o=z.substr(0,z.indexOf("["));m=z.replace(/(^([a-z_]+)?\[)|(\]$)/gi,"");t+="_"+o+"_"+m;if(!q[t]){q[t]={}}if(o!=""&&!n[o]){n[o]=[]}if(x==r.length-1){if(o==""){n.push(u);q[t][m]=n[n.length-1]}else{n[o].push(u);q[t][m]=n[o][n[o].length-1]}}else{if(!q[t][m]){if((/^[a-z_]+\[?/i).test(r[x+1])){n[o].push({})}else{n[o].push([])}q[t][m]=n[o][n[o].length-1]}}n=q[t][m]}else{t+=z;if(x<r.length-1){if(!n[z]){n[z]={}}n=n[z]}else{n[z]=u}}}}}return p}function d(k,j,l){var i=a(k,j,l);return i.length>0?i:g(k,j,l)}function g(k,j,m){var i=[],l=k.firstChild;while(l){i=i.concat(a(l,j,m));l=l.nextSibling}return i}function a(l,j,n){var k,m,i,o=f(l,n);k=j&&j(l);if(k&&k.name){i=[k]}else{if(o!=""&&l.nodeName.match(/INPUT|TEXTAREA/i)){m=c(l);i=[{name:o,value:m}]}else{if(o!=""&&l.nodeName.match(/SELECT/i)){m=c(l);i=[{name:o.replace(/\[\]$/,""),value:m}]}else{i=g(l,j,n)}}}return i}function f(i,j){if(i.name&&i.name!=""){return i.name}else{if(j&&i.id&&i.id!=""){return i.id}else{return""}}}function c(i){if(i.disabled){return null}switch(i.nodeName){case"INPUT":case"TEXTAREA":switch(i.type.toLowerCase()){case"radio":case"checkbox":if(i.checked&&i.value==="true"){return true}if(!i.checked&&i.value==="true"){return false}if(i.checked){return i.value}break;case"button":case"reset":case"submit":case"image":return"";break;default:return i.value;break}break;case"SELECT":return h(i);break;default:break}return null}function h(o){var k=o.multiple,j=[],n,p,m;if(!k){return o.value}for(n=o.getElementsByTagName("option"),p=0,m=n.length;p<m;p++){if(n[p].selected){j.push(n[p].value)}}return j}return e})();var js2form=(function(){var f=/^\[\d+?\]/,j=/^[a-zA-Z_][a-zA-Z_0-9]+/,l=/\[[0-9]+?\]$/,g=/(.*)(\[)([0-9]*)(\])$/,k=/\[([0-9]+)\]\[([0-9]+)\]/g,d=/INPUT|TEXTAREA/i;function h(q,s,m,u,p){if(arguments.length<3){m="."}if(arguments.length<4){u=null}if(arguments.length<5){p=false}var o,r;o=i(s);r=a(q,p,m,{},false);for(var t=0;t<o.length;t++){var v=o[t].name,n=o[t].value;if(typeof r[v]!="undefined"){b(r[v],n)}else{if(typeof r[v.replace(l,"[]")]!="undefined"){b(r[v.replace(l,"[]")],n)}}}}function b(q,p){var o,n,m;if(q instanceof Array){for(n=0;n<q.length;n++){if(q[n].value==p){if(q[n].checked!=true){$j(q[n]).click()}}}}else{if(d.test(q.nodeName)){$j(q).val(p)}else{if(/SELECT/i.test(q.nodeName)){o=q.getElementsByTagName("option");for(n=0,m=o.length;n<m;n++){if(o[n].value==p){o[n].selected=true;if(q.multiple){break}}else{if(!q.multiple){o[n].selected=false}}}}}}}function a(q,p,n,v,r){if(arguments.length<4){v={}}var A={},w=q.firstChild,m,o,y,u,t,s,z;while(w){m="";if(w.name&&w.name!=""){m=w.name}else{if(p&&w.id&&w.id!=""){m=w.id}}if(m==""){var x=a(w,p,n,v,r);for(y in x){if(typeof A[y]=="undefined"){A[y]=x[y]}else{for(u=0;u<x[y].length;u++){A[y].push(x[y][u])}}}}else{if(/SELECT/i.test(w.nodeName)){for(t=0,z=w.getElementsByTagName("option"),s=z.length;t<s;t++){if(r){z[t].selected=false}o=e(m,n,v);A[o]=w}}else{if(/INPUT/i.test(w.nodeName)&&/CHECKBOX|RADIO/i.test(w.type)){if(r){w.checked=false}o=e(m,n,v);o=o.replace(l,"[]");if(!A[o]){A[o]=[]}A[o].push(w)}else{if(r){w.value=""}o=e(m,n,v);A[o]=w}}}w=w.nextSibling}return A}function e(o,p,u){var v=[],n=o.split(p),s,r,q,m,w,t;o=o.replace(k,"[$1].[$2]");for(t=0;t<n.length;t++){s=n[t];v.push(s);r=s.match(g);if(r!=null){q=v.join(p);m=q.replace(g,"$3");q=q.replace(g,"$1");if(typeof(u[q])=="undefined"){u[q]={lastIndex:-1,indexes:{}}}if(m==""||typeof u[q].indexes[m]=="undefined"){u[q].lastIndex++;u[q].indexes[m]=u[q].lastIndex}w=u[q].indexes[m];v[v.length-1]=s.replace(g,"$1$2"+w+"$4")}}q=v.join(p);q=q.replace("].[","][");return q}function i(q,o){var m=[],p,n;if(arguments.length==1){o=0}if(q==null){m=[{name:"",value:null}]}else{if(typeof q=="string"||typeof q=="number"||typeof q=="date"||typeof q=="boolean"){m=[{name:"",value:q}]}else{if(q instanceof Array){for(p=0;p<q.length;p++){n="["+p+"]";m=m.concat(c(q[p],n,o+1))}}else{for(p in q){n=p;m=m.concat(c(q[p],n,o+1))}}}}return m}function c(n,q,p){var t;var m=[],o=i(n,p+1),r,s;for(r=0;r<o.length;r++){t=q;if(f.test(o[r].name)){t+=o[r].name}else{if(j.test(o[r].name)){t+="."+o[r].name}}s={name:t,value:o[r].value};m.push(s)}return m}return h})();(function(a){a.fn.toObject=function(c){var b=[],d={mode:"first",delimiter:".",skipEmpty:true,nodeCallback:null,useIdIfEmptyName:false};if(c){a.extend(d,c)}switch(d.mode){case"first":return form2js(this.get(0),d.delimiter,d.skipEmpty,d.nodeCallback,d.useIdIfEmptyName);break;case"all":this.each(function(){b.push(form2js(this,d.delimiter,d.skipEmpty,d.nodeCallback,d.useIdIfEmptyName))});return b;break;case"combine":return form2js(Array.prototype.slice.call(this),d.delimiter,d.skipEmpty,d.nodeCallback,d.useIdIfEmptyName);break}}})(jQuery);
;
goog.provide("jive.content.draftRecoverButtonLabel");
jive.content.draftRecoverButtonLabel=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<span aria-hidden="true" class="j-508-label" id="draft-recover-label-',soy.$$escapeHtml(opt_data.id),'">');jive.shared.soy.i18nHelper({i18nKey:opt_data.subject?soy.$$escapeHtml("draft.recover.label.subject"):soy.$$escapeHtml("draft.recover.label.subject.none"),arg0:soy.$$escapeHtml((opt_data.modificationDate?jive.model.DateUtil.parseISODateTime(opt_data.modificationDate):"")?_jive_moment(parseFloat(opt_data.modificationDate?
jive.model.DateUtil.parseISODateTime(opt_data.modificationDate):"")?parseFloat(opt_data.modificationDate?jive.model.DateUtil.parseISODateTime(opt_data.modificationDate):""):opt_data.modificationDate?jive.model.DateUtil.parseISODateTime(opt_data.modificationDate):"").add(_jive_timezoneoffset*60*60*1E3).lang(_jive_locale.toLowerCase().replace("_","-")).format("ll"):""),arg1:soy.$$escapeHtml(function(word,limit){var bits,i;if("string"!==typeof word)return"";bits=word.split("");if(bits.length>limit){for(i=
bits.length-1;i>-1;--i)if(i>limit)bits.length=i;else if(" "===bits[i]){bits.length=i;break}bits.push("...")}return bits.join("")}(opt_data.subject,70))},output);output.append("</span>");return opt_sb?"":output.toString()};
;
goog.provide("jive.content.draftDeleteButtonLabel");
jive.content.draftDeleteButtonLabel=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<span aria-hidden="true" class="j-508-label" id="draft-delete-label-',soy.$$escapeHtml(opt_data.id),'">');jive.shared.soy.i18nHelper({i18nKey:opt_data.subject?soy.$$escapeHtml("draft.delete.label.subject"):soy.$$escapeHtml("draft.delete.label.subject.none"),arg0:soy.$$escapeHtml((opt_data.modificationDate?jive.model.DateUtil.parseISODateTime(opt_data.modificationDate):"")?_jive_moment(parseFloat(opt_data.modificationDate?
jive.model.DateUtil.parseISODateTime(opt_data.modificationDate):"")?parseFloat(opt_data.modificationDate?jive.model.DateUtil.parseISODateTime(opt_data.modificationDate):""):opt_data.modificationDate?jive.model.DateUtil.parseISODateTime(opt_data.modificationDate):"").add(_jive_timezoneoffset*60*60*1E3).lang(_jive_locale.toLowerCase().replace("_","-")).format("ll"):""),arg1:soy.$$escapeHtml(function(word,limit){var bits,i;if("string"!==typeof word)return"";bits=word.split("");if(bits.length>limit){for(i=
bits.length-1;i>-1;--i)if(i>limit)bits.length=i;else if(" "===bits[i]){bits.length=i;break}bits.push("...")}return bits.join("")}(opt_data.subject,70))},output);output.append("</span>");return opt_sb?"":output.toString()};
;
goog.provide("jive.content.draft");
jive.content.draft=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="jive-draft" id="draft-',soy.$$escapeHtml(opt_data.id),'"><dl><dt>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("draft.saved.last.short"),[])),"</dt><dd>",soy.$$escapeHtml((opt_data.modificationDate?jive.model.DateUtil.parseISODateTime(opt_data.modificationDate):"")?_jive_moment(parseFloat(opt_data.modificationDate?jive.model.DateUtil.parseISODateTime(opt_data.modificationDate):"")?
parseFloat(opt_data.modificationDate?jive.model.DateUtil.parseISODateTime(opt_data.modificationDate):""):opt_data.modificationDate?jive.model.DateUtil.parseISODateTime(opt_data.modificationDate):"").add(_jive_timezoneoffset*60*60*1E3).lang(_jive_locale.toLowerCase().replace("_","-")).format("ll"):""),"</dd>",opt_data.subject?"<dt>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.subject.colon"),[]))+"</dt><dd>"+soy.$$escapeHtml(function(word,limit){var bits,i;if("string"!==typeof word)return"";
bits=word.split("");if(bits.length>limit){for(i=bits.length-1;i>-1;--i)if(i>limit)bits.length=i;else if(" "===bits[i]){bits.length=i;break}bits.push("...")}return bits.join("")}(opt_data.subject,70))+"</dd>":"",'</dl><button id="draft-recover-button-',soy.$$escapeHtml(opt_data.id),'" class="jive-description use-draft" aria-labelledby="draft-recover-label-',soy.$$escapeHtml(opt_data.id),'" role="button">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("draft.recover"),[])),"</button>");jive.content.draftRecoverButtonLabel(opt_data,
output);output.append('<button id="draft-delete-button-',soy.$$escapeHtml(opt_data.id),'" class="jive-description destroy-draft" aria-labelledby="draft-delete-label-',soy.$$escapeHtml(opt_data.id),'" role="button">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("draft.delete"),[])),"</button>");jive.content.draftDeleteButtonLabel(opt_data,output);output.append("</div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.content.drafts");
jive.content.drafts=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div id="autosave-prompt" class="jive-warn-box" role="alert" aria-live="polite" aria-atomic="true" tabindex="0"><div><p><span class="jive-icon-med jive-icon-warn"></span>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("draft.exists.info"),[])),"</p>");var draftList6=opt_data.drafts;var draftListLen6=draftList6.length;for(var draftIndex6=0;draftIndex6<draftListLen6;draftIndex6++){var draftData6=draftList6[draftIndex6];
jive.content.draft(draftData6,output)}output.append("</div></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.content.draftlastsaved");jive.content.draftlastsaved=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<span class="last-saved">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("draft.saved.last"),[opt_data.date?_jive_moment(parseFloat(opt_data.date)?parseFloat(opt_data.date):opt_data.date).add(_jive_timezoneoffset*60*60*1E3).lang(_jive_locale.toLowerCase().replace("_","-")).format("LT"):""])),"</span>");return opt_sb?"":output.toString()};
;
jive.namespace("draft");define("apps/content/draft/view",["jquery","underscore","apps/shared/views/abstract_view","apps/shared/models/location_state","apps/shared/controllers/switchboard","soy!jive.content.drafts","soy!jive.content.draftlastsaved"],function(e,a,c,g,d,b,f){return c.extend(function(i,k){var l=jQuery,h;var j=false;this.init=function(n){var p;k.init.call(this,n);this.options=l.extend({pushStateEnabled:true},n);h=this;h.locationState=g;h.timeoutId=null;h.rte=h.options.rte;var o=h.getContent();var m=h.serializeForm();o.data("autosave",m);h.emit("display");tinyMCE.activeEditor.onChange.add(function(){h.setActive(true)});p=tinyMCE.activeEditor.onNodeChange.add(function(){h.setActive(true)});tinyMCE.activeEditor.onKeyPress.add(function(){h.setActive(true)});tinyMCE.activeEditor.onClick.add(function(){h.setActive(true)});l(":input").change(function(){h.setActive(true)});l(window).on("beforeunload",function(){h.setActive(false);h.removeFromWorkingDrafts(o.find("#draftID").attr("value"))});l('.j-comment-form input[name="post"]:visible, #submitButton').on("click",function(){if(tinyMCE.activeEditor){tinyMCE.activeEditor.onNodeChange.remove(p)}h.setActive(false)});l('.jive-form-button-cancel, input[name="cancel"]:visible').on("click",function(){tinyMCE.activeEditor.onNodeChange.remove(p);h.setActive(false);h.removeFromWorkingDrafts(o.find("#draftID").attr("value"))});d.addListener("draft.destroy",function(q){h.destroy(q)});h.setActive(true)};this.pause=function(){h.setActive(true)};this.unpause=function(){h.setActive(false)};this.setActive=function(m){h.isActive=m;clearTimeout(h.timeoutId);if(m){h.timeoutId=setTimeout(h.checkIsActive,h.options.interval*1000)}};this.checkIsActive=function(){if(h.isActive){h.save();h.setActive(false)}};this.save=function(){var q=false;var o=function(u,t){if(t==4026||t==403){j=true}};var m=h.serializeForm();if(m.body.length===0){return}var p=h.getContent();var n=p.data("autosave");var s=p.data("lastAttempt");if(s){q=m.body==s.body&&m.subject==s.subject&&JSON.stringify(m.properties)==JSON.stringify(s.properties)}var r=m.body!=n.body||m.subject!=n.subject||JSON.stringify(m.properties)!=JSON.stringify(n.properties);if(!q){j=false}p.data("lastAttempt",m);if(r&&!j){if(n.id){m.id=n.id;h.emitP("save",m,o)}else{h.emitP("create",m,o)}}};i.serializeForm=function(){var n={};var o=h.getContent();var q=o.toObject({mode:"all"})[0];var m=a.find(o.serializeArray(),{name:"publishBar.visibility"});n.objectType=h.options.objectType;n.draftObjectType=h.options.draftObjectType;n.draftObjectID=h.options.draftObjectID;n.subject=l("#"+h.options.subject).val();var p=h.getRTE();if(p&&p.isSpellChecking()){n.body=""}else{n.body=p?p.getHTML():""}n.properties={};l.each(h.options.properties,function(s,r){n.properties[r]=q[r]});l.extend(n.properties.publishBar,{visibility:m&&m.value});return n};i.getRTE=function(){return h.rte?h.rte:window.editor.get(h.options.editorId)};this.saved=function(o,t){try{var s=h.getContent();s.data("autosave",o);h.addToWorkingDrafts(o.id);if(h.options.pushStateEnabled){h.updatePushState(o.id)}h.updateFormDraftID(s,o.id);var p=new Date();var r=l(f({date:p}));var n=l(h.getRTE().getBelowEditorArea());var m=n.find(".last-saved");if(m.length){m.replaceWith(r)}else{r.hide().appendTo(n).fadeIn();h.getRTE().autoReposition()}t.emitSuccess(o)}catch(q){if(t){t.emitError(q)}}};this.display=function(r){var n=h.locationState.getState().draftID;if(n){var q=false;l.each(r,function(t,s){if(s.id==n){h.emit("restore",s);q=true}});if(q){return}}var o=[];l.each(r,function(t,s){if(!h.isWorkingDraft(s.id)){o.push(s)}});if(o.length===0){return}var p=h.getContent();var m=l(b({drafts:o}));m.find(".jive-draft").each(function(s){l(this).data("draft",o[s])});m.hide().insertBefore(p).fadeIn();m.on("click",".use-draft",function(u){var t=l(u.target).closest(".jive-draft");var s=t.data("draft");h.emit("restore",s);d.emit("draft.destroy",s.id)});m.on("click",".destroy-draft",function(u){var t=l(u.target).closest(".jive-draft");var s=t.data("draft");h.emit("destroy",s.id);d.emit("draft.destroy",s.id)});m.focus()};this.restore=function(n){var m=h.getContent();js2form(m[0],n.properties);h.getRTE().setHTML(n.body);l("#"+h.options.subject).val(n.subject);m.trigger("restore",n);h.addToWorkingDrafts(n.id);h.updateFormDraftID(m,n.id);m.data("autosave",n);l("#autosave-prompt").fadeOut(function(){l(this).safeRemove()});if(h.options.pushStateEnabled){h.updatePushState(n.id)}};this.destroy=function(q){var m=l("#autosave-prompt");if(m.length===0){return}var o=l("#draft-"+q);if(o.length===0){return}var p=m.find(".jive-draft").length>1;var n=p?o:m;n.fadeOut(function(){l(this).safeRemove()})};i.updateFormDraftID=function(n,o){var m=n.find("input#draftID");if(m.length===0){m=l("<input />",{id:"draftID",name:"draftID",type:"hidden"});m.appendTo(n)}m.val(o)};i.updatePushState=function(m){h.locationState.pushState({draftID:m})};i.addToWorkingDrafts=function(n){var m=h.getWorkingDrafts();if(!h.isWorkingDraft(n)){m.push(n)}if(typeof(localStorage)!="undefined"){localStorage.setItem("workingDrafts",m)}};i.removeFromWorkingDrafts=function(n){var m=h.getWorkingDrafts();m.splice(m.indexOf(String(n)),1);if(typeof(localStorage)!="undefined"){localStorage.setItem("workingDrafts",m)}};i.isWorkingDraft=function(m){return l.inArray(String(m),h.getWorkingDrafts())>-1};i.getWorkingDrafts=function(){if(typeof(localStorage)=="undefined"){return[]}var m=localStorage.getItem("workingDrafts");return m?m.split(","):[]}})});
;
jive.namespace("draft");define("apps/content/draft/source",["apps/shared/models/rest_service"],function(a){jive.draft.Model=a.extend(function(b){b.resourceType="draft";b.pluralizedResourceType=b.resourceType;this.save=function(c){return this.commonAjaxRequest(new jive.conc.Promise(),"PUT",{url:this.RESOURCE_ENDPOINT+"/"+c.id,contentType:"application/json; charset=utf-8",data:JSON.stringify(c)})};this.create=function(c){return this.commonAjaxRequest(new jive.conc.Promise(),"POST",{url:this.RESOURCE_ENDPOINT,contentType:"application/json; charset=utf-8",data:JSON.stringify(c)})};this.display=function(c){return this.get(c)}});return jive.draft.Model});
;
jive.namespace("draft");define("apps/content/draft/main",["apps/content/draft/view"],function(a){jive.draft.Main=jive.oo.Class.extend(function(b){this.init=function(c){b.main=this;this.options=$j.extend({enabled:true,interval:10,keepaliveInterval:90,objectType:null,draftObjectType:null,draftObjectID:null,editorId:null,subject:null,images:[],properties:[],confirmationMessage:jive.i18n.keys.globalUnsavedChangesText(),saveMessage:jive.i18n.keys.forumPostSaveAndEditText(),savedMessage:jive.i18n.keys.forumPostSaveAndEditText()},c);c=this.options;this.view=new a(c);this.model=new jive.draft.Model(c);this.view.addListener("keepalive",function(d){var e=b.main.model.get("");e.addListener("error",function(g,f){if(f==403){window.clearInterval(d)}})});this.view.addListener("display",function(d){var e=c.objectType+"/"+c.draftObjectType+"/"+c.draftObjectID;b.main.model.display(e).addCallback(function(f){b.main.view.display(f)})});this.view.addListener("create",function(e,d,f){b.main.model.create(e).addCallback(function(g){b.main.view.saved(g,f)}).addErrback(function(){f.emitError()}).addListener("error",d)});this.view.addListener("save",function(e,d,f){b.main.model.save(e).addCallback(function(g){b.main.view.saved(g,f)}).addErrback(function(){f.emitError()}).addListener("error",d)});this.view.addListener("restore",function(d){b.main.view.restore(d)});this.view.addListener("destroy",function(d){b.main.model.destroy(d).addCallback(function(e){b.main.view.destroy(d)})})};this.pause=function(){b.main.view.pause()};this.unpause=function(){b.main.view.unpause()}});return jive.draft.Main});
;
jive.namespace("CommentApp");define("apps/comment_app/views/form_view",function(){jive.CommentApp.FormView=jive.oo.Class.extend(function(a,b){jive.conc.observable(this);this.init=function(c,d){this._parentCommentID=d.parentCommentID;this._commentMode=d.commentMode;if(!this._postBlock){this._postBlock=$j("#jive-comment-post-block")}this._itemAuthorID="comment-author";this._itemBodyID="commentBody";this._itemEmailID="comment-email";this._itemURLID="comment-url";this._container=$j(c);this._initFormWaitingView(d.i18n);this.rteView=null;this.options=d;this._render()};this.getParentCommentID=function(){return this._parentCommentID};a._initFormWaitingView=function(c){this._formWaitingView=new jive.shared.FormWaitingView(this._container.parents(".jive-js-addReply"),{containerPadding:0})};a.focus=function(){if(this._isAnonymous){$j("#"+this._itemAuthorID).focus()}else{b.focus.call(this)}};a._getValues=function(){return{body:this.rteView.getHTML(),mobileEditor:this.rteView.isMobileOnly(),name:$j("#"+this._itemAuthorID).val(),email:$j("#"+this._itemEmailID).val(),url:$j("#"+this._itemURLID).val(),parentCommentID:this._parentCommentID,commentMode:this._commentMode,outcome:this._container.find(".js-outcome-attachment").data("outcomeType")}};a._postHandler=function(){var c=this;if(c._validateComment()){c._formWaitingView.disableForm();c.emitP("post",c._getValues()).addCallback(function(){c._formWaitingView.enableForm()}).addErrback(function(){c._formWaitingView.enableForm()})}return false};a._validateComment=function(){var c=this._getValues();if(this.options.isAnonymous&&$def(c.name)&&$j.trim(c.name)===""){$j("<p/>",{text:jive.DiscussionApp.soy.replyErrorMessage({key:jive.i18n.keys.forumThrdNameRequiredText()})}).message({style:"error"});return false}else{if(this.options.isAnonymous&&$def(c.email)&&$j.trim(c.email)===""){$j("<p/>",{text:jive.DiscussionApp.soy.replyErrorMessage({key:jive.i18n.keys.forumThrdEmailRequiredText()})}).message({style:"error"});return false}else{if($j.trim(c.body)===""){$j("<p/>",{text:jive.DiscussionApp.soy.replyErrorMessage({key:jive.i18n.keys.postErrPlsEnterBodyText()})}).message({style:"error"});return false}else{return true}}}};a._initFormControls=function(d,c){};a._isEdit=function(){return false};a._render=function(){var e=this._template();var j="wysiwyg_id_"+jive.CommentApp.FormView.id;jive.CommentApp.FormView.id++;e.find("textarea").attr("id",j);this._container.append(e);this._initFormControls(this._container,j);var h=this;var c=new jive.rte.EntitlementService({objectID:h.options.resourceID,objectType:h.options.resourceType,entitlement:"VIEW"});var g=new jive.rte.ImageService({objectId:-1,objectType:-1,containerId:h.options.containerID,containerType:h.options.containerType});var f=$j("#"+j).closest("form");var d=new jive.rte.FormService({$form:f,formSubmitHandler:function(){return h._postHandler()}});var i=$j.extend({$element:$j("#"+j),isEditing:this._isEdit,pinToolbar:false,body_class:"tiny_mce_content jive-widget-formattedtext j-comment-rte",onReady:function(){if(h.options.rteOptions.onReady){h.options.rteOptions.onReady()}jive.conc.nextTick(function(){h.rteView.focus()});if(!h.options.isAnonymous){var k={selector:f,objectType:105,draftObjectType:h.options.resourceType,draftObjectID:h.options.resourceID,editorId:j,pushStateEnabled:false,keepAliveEnabled:h.options.keepAliveEnabled};new jive.draft.Main(k)}},services:{imageService:g,formService:d,entitlementService:c}},this.options.rteOptions);this.rteView=new jive.rte.RTEWrap(i);this._container.find("form").find("[name=cancel]").on("vclick",function(k){h.emit("cancel",h._getValues());k.preventDefault()})};a._template=function(){return $j("<div></div>").html(this._postBlock.html())};this.remove=function(){var c=this.rteView.getID();if(this.rteView){this.rteView.killYourself();this.rteView.destroy()}window.editor.clear(c);jive.rte.multiRTE=jive.rte.multiRTE.filter(function(d){return d!=c});this._container.find("form").parent().html("");$j(window).unbind("unload",this._unloadCallback);this.emit("remove")}});jive.CommentApp.FormView.id=0;return jive.CommentApp.FormView});
;
goog.provide("jive.content.draft");goog.provide("jive.content.draftDeleteButtonLabel");goog.provide("jive.content.draftRecoverButtonLabel");goog.provide("jive.content.draftlastsaved");goog.provide("jive.content.drafts");goog.require("soy");goog.require("soydata");goog.require("soy.StringBuilder");goog.require("jive.shared.soy.i18nHelper");
jive.content.drafts=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div id="autosave-prompt" class="jive-warn-box" role="alert" aria-live="polite" aria-atomic="true" tabindex="0"><div><p><span class="jive-icon-med jive-icon-warn"></span>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("draft.exists.info"),[])),"</p>");var draftList6=opt_data.drafts;var draftListLen6=draftList6.length;for(var draftIndex6=0;draftIndex6<draftListLen6;draftIndex6++){var draftData6=
draftList6[draftIndex6];jive.content.draft(draftData6,output)}output.append("</div></div>");return opt_sb?"":output.toString()};
jive.content.draftlastsaved=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<span class="last-saved">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("draft.saved.last"),[opt_data.date?_jive_moment(parseFloat(opt_data.date)?parseFloat(opt_data.date):opt_data.date).add(_jive_timezoneoffset*60*60*1E3).lang(_jive_locale.toLowerCase().replace("_","-")).format("LT"):""])),"</span>");return opt_sb?"":output.toString()};
jive.content.draft=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="jive-draft" id="draft-',soy.$$escapeHtml(opt_data.id),'"><dl><dt>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("draft.saved.last.short"),[])),"</dt><dd>",soy.$$escapeHtml((opt_data.modificationDate?jive.model.DateUtil.parseISODateTime(opt_data.modificationDate):"")?_jive_moment(parseFloat(opt_data.modificationDate?jive.model.DateUtil.parseISODateTime(opt_data.modificationDate):
"")?parseFloat(opt_data.modificationDate?jive.model.DateUtil.parseISODateTime(opt_data.modificationDate):""):opt_data.modificationDate?jive.model.DateUtil.parseISODateTime(opt_data.modificationDate):"").add(_jive_timezoneoffset*60*60*1E3).lang(_jive_locale.toLowerCase().replace("_","-")).format("ll"):""),"</dd>",opt_data.subject?"<dt>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.subject.colon"),[]))+"</dt><dd>"+soy.$$escapeHtml(function(word,limit){var bits,i;if("string"!==typeof word)return"";
bits=word.split("");if(bits.length>limit){for(i=bits.length-1;i>-1;--i)if(i>limit)bits.length=i;else if(" "===bits[i]){bits.length=i;break}bits.push("...")}return bits.join("")}(opt_data.subject,70))+"</dd>":"",'</dl><button id="draft-recover-button-',soy.$$escapeHtml(opt_data.id),'" class="jive-description use-draft" aria-labelledby="draft-recover-label-',soy.$$escapeHtml(opt_data.id),'" role="button">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("draft.recover"),[])),"</button>");jive.content.draftRecoverButtonLabel(opt_data,
output);output.append('<button id="draft-delete-button-',soy.$$escapeHtml(opt_data.id),'" class="jive-description destroy-draft" aria-labelledby="draft-delete-label-',soy.$$escapeHtml(opt_data.id),'" role="button">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("draft.delete"),[])),"</button>");jive.content.draftDeleteButtonLabel(opt_data,output);output.append("</div>");return opt_sb?"":output.toString()};
jive.content.draftRecoverButtonLabel=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<span aria-hidden="true" class="j-508-label" id="draft-recover-label-',soy.$$escapeHtml(opt_data.id),'">');jive.shared.soy.i18nHelper({i18nKey:opt_data.subject?soy.$$escapeHtml("draft.recover.label.subject"):soy.$$escapeHtml("draft.recover.label.subject.none"),arg0:soy.$$escapeHtml((opt_data.modificationDate?jive.model.DateUtil.parseISODateTime(opt_data.modificationDate):"")?_jive_moment(parseFloat(opt_data.modificationDate?
jive.model.DateUtil.parseISODateTime(opt_data.modificationDate):"")?parseFloat(opt_data.modificationDate?jive.model.DateUtil.parseISODateTime(opt_data.modificationDate):""):opt_data.modificationDate?jive.model.DateUtil.parseISODateTime(opt_data.modificationDate):"").add(_jive_timezoneoffset*60*60*1E3).lang(_jive_locale.toLowerCase().replace("_","-")).format("ll"):""),arg1:soy.$$escapeHtml(function(word,limit){var bits,i;if("string"!==typeof word)return"";bits=word.split("");if(bits.length>limit){for(i=
bits.length-1;i>-1;--i)if(i>limit)bits.length=i;else if(" "===bits[i]){bits.length=i;break}bits.push("...")}return bits.join("")}(opt_data.subject,70))},output);output.append("</span>");return opt_sb?"":output.toString()};
jive.content.draftDeleteButtonLabel=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<span aria-hidden="true" class="j-508-label" id="draft-delete-label-',soy.$$escapeHtml(opt_data.id),'">');jive.shared.soy.i18nHelper({i18nKey:opt_data.subject?soy.$$escapeHtml("draft.delete.label.subject"):soy.$$escapeHtml("draft.delete.label.subject.none"),arg0:soy.$$escapeHtml((opt_data.modificationDate?jive.model.DateUtil.parseISODateTime(opt_data.modificationDate):"")?_jive_moment(parseFloat(opt_data.modificationDate?
jive.model.DateUtil.parseISODateTime(opt_data.modificationDate):"")?parseFloat(opt_data.modificationDate?jive.model.DateUtil.parseISODateTime(opt_data.modificationDate):""):opt_data.modificationDate?jive.model.DateUtil.parseISODateTime(opt_data.modificationDate):"").add(_jive_timezoneoffset*60*60*1E3).lang(_jive_locale.toLowerCase().replace("_","-")).format("ll"):""),arg1:soy.$$escapeHtml(function(word,limit){var bits,i;if("string"!==typeof word)return"";bits=word.split("");if(bits.length>limit){for(i=
bits.length-1;i>-1;--i)if(i>limit)bits.length=i;else if(" "===bits[i]){bits.length=i;break}bits.push("...")}return bits.join("")}(opt_data.subject,70))},output);output.append("</span>");return opt_sb?"":output.toString()};
;
jive.namespace("CommentApp");jive.CommentApp.EditFormView=jive.CommentApp.FormView.extend(function(a,b){this.init=function(c,d){this._id=d.id;this._postBlock=$j("#jive-comment-edit-block");b.init.call(this,c,d)};a._initFormWaitingView=function(c){this._formWaitingView=new jive.shared.FormWaitingView($j(this._container).parents(".jive-comment-content"),{containerPadding:0})};a._initFormControls=function(h,g){var d=h.find(".jive-comment-rte-source").val();var c=h.find("[name=commentGuestName]").val();var f=h.find("[name=commentGuestEmail]").val();var e=h.find("[name=commentGuestUrl]").val();if(c||f||e){h.find(".jive-comment-rte-source").val();h.find(".jive-comment-post-anonymous [name=name]").val(c);h.find(".jive-comment-post-anonymous [name=email]").val(f);h.find(".jive-comment-post-anonymous [name=url]").val(e);h.find(".jive-comment-post-anonymous").show()}else{h.find(".jive-comment-post-anonymous").hide()}$j("#"+g).val(d)};a._isEdit=function(){return true};a._getValues=function(){return{body:this.rteView.getHTML(),mobileEditor:this.rteView.isMobileOnly(),name:this._container.find("[name=name]").val(),email:this._container.find("[name=email]").val(),url:this._container.find("[name=url]").val(),id:this._id}}});define("apps/comment_app/views/edit_form_view",function(){return jive.CommentApp.EditFormView});
;
jive.namespace("CommentApp");jive.CommentApp.CommentView=function(k,p){jive.conc.observable(this);var m=p.id,h=$j(k),d=p.isThreaded,o=p.i18n,g=this;function e(){h.fadeOut(function(){$j(this).remove()});this.emit("remove",m);return this}function n(q){h.find("[class*=comment-preview]").html(q).fadeIn()}function l(){return h}function i(){h.find(".jive-comment-meta:first, #comment-body-"+m+", .js-comment-footer").hide();h.find(".jive-comment-meta:first").after('<p class="jive-js-edit-title j-editing-comment jive-comment-meta font-color-meta-light">'+o.cmntEditingTitle+"</p>")}function j(){h.find(".jive-comment-meta:first, #comment-body-"+m+", .js-comment-footer").show();h.find(".jive-js-edit-title").remove()}function f(){return m}function c(){return h.find(".jive-username-link:first").text()}function a(q){var r;if(d){r=h.find("ul.jive-comment:first");if(r.length===0){r=$j("<ul/>",{"class":"jive-comment clearfix jive-comment-threaded jive-comment-indent-1"});h.append(r)}r.append(q)}else{h.parent().append(q)}}function b(){var q=h.parents().addBack().filter("ul.jive-comment").toArray();return q.slice(1).reduce(function(s,r){return s+parseInt($j(r).css("margin-left"),10)},0)}this.remove=e;this.displayPreview=n;this.getDOMElement=l;this.getCommentID=f;this.username=c;this.showCommentEdit=i;this.hideCommentEdit=j;this.append=a;this.indent=b};define("apps/comment_app/views/comment_view",function(){return jive.CommentApp.CommentView});
;
jive.namespace("CommentApp");define("apps/comment_app/views/comment_list_view",["jquery","apps/outcomes/replyOutcomeView","apps/shared/controllers/localexchange","apps/outcomes/viewUtil","apps/shared/views/rte_quote_source"],function(e,b,a,d,c){jive.CommentApp.CommentListView=jive.AbstractView.extend(function(f){var i=new jive.Modalizer.Main({width:"medium"}),k;jive.conc.observable(this);function g(l){return e(l).closest(".jive-comment-actions").attr("data-comment-id")}function h(l){c.trigger("quote:set",e(l).data())}this.init=function(l,o){var m=this;k=m;this.container="#"+l;this.containerID=l;this.isThreaded=o.isThreaded;this.i18n=o.i18n;this.options=o;this.showReplies=!o.isFinalized||window.location.hash.length>0;e(document).ready(function(){e(m.container).delegate("#inline-comment-sort","change",function(){m.emit("sortChange",e(this).val())});m.bindEvents()});this.initFinalized();function n(){m.scrollToPermalink();a.removeListener("heightChanged",n)}a.addListener("heightChanged",n);a.addListener("outcome.expandCollapsedComments",function(){k.showReplies=true;k.checkCommentRollupState()});a.addListener("outcome.collapseComments",function(){k.showReplies=false;k.checkCommentRollupState()})};this.getContent=function(){return e(this.container)};this.closeForm=function(){if(this.form){this.form.remove();this.form=null;e(".jive-comment-add-link").show();this.emit("formClosed")}};this.renderForm=function(q,n,p,m){var l=this;this.closeForm();var o=q===jive.CommentApp.EditFormView;if(o){this.hideShowCommentForm(p.getDOMElement(),false)}else{this.hideShowCommentForm(null,false)}e(".jive-comment-add-link").hide();this.form=new q(n,m);n.parent(".jive-rendered-content").removeClass("jive-rendered-content");this.proxyListener(this.form,"post","saveComment",function(r,s){s.addCallback(function(){l.closeForm()}).addErrback(function(u,t){l.displayError(u,t)})});this.proxyListener(this.form,"post","savedComment");this.proxyListener(this.form,"cancel","cancelComment",function(){l.closeForm();l.hideShowCommentForm(null,true)});this.form.addListener("remove",function(){if(o){p.hideCommentEdit()}})};f.renderPostForm=function(m,o){var l=this.commentForm(o);var n=e(l).find(".jive-comment-post");this.renderForm(jive.CommentApp.FormView,n,o,e.extend({i18n:this.i18n},m));return l};f.renderEditForm=function(n,l){var m=e(n.getDOMElement());if(!m.is(".jive-comment-edit")){m=m.find(".jive-comment-edit:first")}return this.renderForm(jive.CommentApp.EditFormView,m,n,l)};f.commentView=function j(m){var l=e("#comment-"+m);return(new jive.CommentApp.CommentView(l,e.extend({id:m},this.options)))};this.editComment=function(n,o){this.hideShowCommentForm(null,true);var l=this.commentView(n),m=e("#comment-"+o).find("a:has(.commentAdd):first");h(m);l.showCommentEdit();this.renderEditForm(l,e.extend({id:n},this.options))};this.deleteComment=function(m){var l=confirm(this.i18n.confirmDeleteComment);if(l){this.commentView(m).remove();this.emit("deleteComment",m)}};this.createReplyTo=function(o){var p={id:0,inReplyTo:{id:o}};this.emit("replyComment",p);var m=this.commentView(o),n=$j("#comment-"+o+" a .commentAdd").closest("a");h(n);var l=this.renderPostForm(e.extend({parentCommentID:o},this.options),m);b(l,{type:this.options.resourceType,id:this.options.resourceID});l.find(".jive-comment-textarea").focus()};this.createReply=function(){this.emit("createComment",{id:0});var l=this.renderPostForm(this.options);l.find(".jive-create-comment p.jive-comment-meta").hide();b(l,{type:this.options.resourceType,id:this.options.resourceID});l.find(".jive-comment-textarea").focus()};f.bindEvents=function(){var l=this;var m=e(this.container);m.on("vclick",".j-action-item > .js-actionItem",function(p){var o=e(this),n=o.data("event");p.preventDefault();if(n){a.emitP(n,d.getEd(o),undefined,o.data("parendId"))}else{i.modalize(o.attr("href"),o)}});m.on("vclick",".jive-comment-actions a:has(.commentEdit)",function(o){var n=g(this);var q=e(this).attr("data-parentID");var p={id:n};if(q){e.extend(p,{inReplyTo:{id:q}})}l.emit("editComment",p);l.editComment(n,q);o.preventDefault()});m.on("vclick",".jive-comment-actions a:has(.commentDelete)",function(o){var n=g(this);l.deleteComment(n);o.preventDefault()});m.on("vclick",".jive-comment-actions a:has(.commentAdd)",function(o){var n=g(this);l.createReplyTo(n);o.preventDefault()});m.on("vclick",".js-add-comment",function(n){l.createReply();n.preventDefault()})};f.scrollToPermalink=function(){var m=(window.location.hash.match(/^#([^\/].+)$/)||[])[1];m=encodeURIComponent(m);var l=m?e(this.container+' a[name="'+m+'"], '+this.container+' [id="'+m+'"]'):e();if(l.length>0){if(!this.getContent().is(":visible")&&window.tabView){window.tabView.setVisibility(this.containerID,true);window.tabView.switchTo(this.containerID)}e.scrollTo(l,100,{offset:{top:-20,left:-200}})}};this.setContent=function(l){var m=e(this.container).html(l);this.scrollToPermalink();jive.localexchange.emit("renderedContent",m)};this.displayError=function(m,l){if(l==401||l==403||l==4026||l===0){m=jive.i18n.sub(this.i18n.globalLoginRequired,'<a href="'+encodeURI(window.location).replace(/#.*$/,"")+'">',"</a>")}m=m||this.i18n.globalAjaxError;e("#jive-comment-error-box").show();e("#jive-comment-error").html(m).show()};this.displaySuccess=function(l){e("#success-moderation-edit").html('<div><span class="jive-icon-med jive-icon-warn"></span>'+l+"</div>").show();e.scrollTo(e("#success-moderation-edit"),100,{offset:{top:-40,left:0}})};this.setPreviewButtonText=function(l){};this.scrollTo=function(m){var l=e(this.container);if(!this.inView(l)){e.scrollTo(e(this.container),m||200,{offset:{top:-30,left:0}})}};f.inView=function(m){var o=e(window).scrollTop(),n=o+e(window).height(),l=e(m).offset().top;return((l>=o)&&(l<=n))};f.hideShowCommentForm=function(l,m){l=l||e(this.container).find(".jive-js-addReply");if(l.length===0){return}if(m){l.fadeOut("fast").remove()}else{l.fadeIn("fast");e.scrollTo(l,100,{offset:{top:-100,left:0},axis:"y"})}};f.listElement=function(){var l=e(this.container).find("ul.jive-comment:first");if(l.length===0){l=e("<ul/>",{"class":"jive-comment jive-comment-threaded clearfix jive-comment-indent-0"});e(this.container).find(".jive-comment-container").html(l)}return l};f.append=function(l){this.listElement().append(l)};f.commentForm=function(p){this.hideShowCommentForm(null,true);var m={commentMode:this.options.commentMode};if(p){e.extend(m,{commentID:p.getCommentID(),username:p.username()})}var n=e(jive.CommentApp.soy.renderReply(m));if(p){p.append(n);if(this.isThreaded){var o=p.indent(),l=parseInt(n.parent().css("margin-left"),10);n.css("margin-left",-o-l+"px")}}else{this.append(n)}return n};f.initFinalized=function(){$j("#jive-unroll-comments").off("click").on("click",function(l){l.preventDefault();k.showReplies=true;k.checkCommentRollupState()});k.checkCommentRollupState()};f.checkCommentRollupState=function(){if(!!window.location.hash){k.showReplies=true}if(k.showReplies){if($j("#jive-rolled-up-comments").is(":visible")){$j("#jive-rolled-up-comments").fadeOut(150,function(){$j("#jive-comment-tabs").fadeIn(200)})}}else{if(!$j("#jive-rolled-up-comments").is(":visible")){$j("#jive-comment-tabs").fadeOut(200,function(){$j("#jive-rolled-up-comments").fadeIn(150)})}}return e("#jive-rolled-up-replies, #jive-replies").promise()};this.beforeListLoad=function(){e(this.container).append('<div class="j-loader-box">'+this.i18n.loading+"</div>")}});return jive.CommentApp.CommentListView});
;
jive.namespace("CommentApp");jive.CommentApp.Main=jive.Paginated.extend(function(a){this.init=function(c){var b=this;this.commentMode=c.commentMode;this.defaultSort=c.sort||"datedesc";this.paginate=c.paginate||false;this.pageSize=c.pageSize||25;this.i18n=c.i18n;switch(this.commentMode){case"inline":this.containerID="jive-inlinecomments";break;case"backchannel":this.containerID="jive-authordiscussion";break;default:this.containerID="jive-comments";break}this.commentSource=new jive.CommentApp.CommentSource($j.extend({location:this.containerID},c));this.commentListView=new jive.CommentApp.CommentListView(this.containerID,c);if(this.commentMode==="comments"){jive.localexchange.addListener("reply.comment.edit",function(d,e,f){b.commentListView.editComment(d.id,f)}).addListener("reply.comment.delete",function(d){b.commentListView.deleteComment(d.id)}).addListener("reply.comment.create",function(d){if(d.type==105){b.commentListView.createReplyTo(d.id)}else{b.commentListView.createReply()}})}this.commentListView.addListener("sortChange",function(d){b.defaultSort=d;b.update({sort:d})}).addListener("saveComment",function(f,g){var h=new jive.CommentApp.Comment(f),d=this,e=f.outcome;b.commentSource.save(h).addCallback(function(m){var j="comment-"+m.id;var k=window.location.href.split("#")[0]+"#"+j;g.emitSuccess();var i;if(m.moderated){i=b.loadPage().then(function(){d.displaySuccess(b.i18n.postSuccessText)})}else{if(window.location.href!=k){var l={};l[j]="";i=b.update(l)}else{i=b.update()}}if(e){i.then(function(){jive.localexchange.emit("outcome.doAction","outcome.post",{type:105,id:m.id},e,$j())})}}).addErrback(function(j,i){g.emitError(j,i)})}).addListener("deleteComment",function(d){b.commentSource.destroy(d).addCallback(function(){b.update({comment:[]});jive.localexchange.emit("commentDeleted",{id:d})})});$j(document).ready(function(){var d;if(b.paginate){b.pager=b.newPager()}if(!b.paginate||Object.keys(jive.locationState.getEphemeralState()).length<1){b.update()}require(["jive.rte"],$j.noop)})};this.closeForms=function(){this.commentListView.closeForm()};this.renderForm=function(b,d,c){this.commentListView.renderForm(b,d,null,c)};this.addCommentListViewListener=function(b,c){this.commentListView.addListener(b,c)};this.refresh=function(){this.update()};a.newPager=function(){var c;var d={replaceWith:function(){}};jive.conc.observable(d);var b=this;this.initPagination({numResults:this.pageSize,sort:this.defaultSort},{locationState:new jive.LocationState({supportPushState:false}),viewClass:function(){return d},paginationSelector:"body",paramFilter:function(f){var e={};Object.keys(f).forEach(function(g){var h=g.match(/^comment-(.*)$/);if(h){e.comment=h[1];e[g]=c}else{e[g]=f[g]}});return e}});$j("#"+this.containerID).delegate(".js-pagination a[data-page]","click",function(e){var f=parseInt($j(this).attr("data-page"),10);d.emit("page",f);b.commentListView.scrollTo();e.preventDefault()});return this};a.loadPage=function(c){var b=new jive.conc.Promise();c=this.cacheCommentParamForPagination(c);this.loadComments(c,function(){b.emitSuccess()});return b};a.cacheCommentParamForPagination=function(c){var b=window.location.hash.match(/comment\-(\d+)/);if(b&&b.length==2&&!c.comment){c.comment=b[1]}return c};a.update=function(b){if(this.paginate&&b){return this.pager.pushState(b)}else{return this.loadPage(this.pager?this.pager.getState():b)}};a.loadComments=function(c,d){var b=this;c=c||{};c.sort=c.sort||this.defaultSort;if(!this.paginate){this.commentListView.beforeListLoad()}this.commentListView.showSpinner({context:$j("#"+this.containerID+" .jive-comment-container"),size:"big"});this.commentSource.getAllAsHTML(c).addCallback(function(e){b.commentListView.setContent(e);if($j.isFunction(d)){d(e,"success")}}).always(function(){b.commentListView.hideSpinner()})}});define("apps/comment_app/main",["apps/comment_app/views/comment_list_view"],function(){return jive.CommentApp.Main});
;
jive.action=(function(){var a=_jive_base_url+"/";return{url:function(b,c){var d="";Object.keys(c).forEach(function(e){d+=e+"="+c[e]+"&"});if(d.length>0){d="?"+d.slice(0,d.length-1)}return a+b+".jspa"+d}}})();
;
goog.provide("jive.shared.displayutil.a11yBoundary");goog.provide("jive.shared.displayutil.anonymousAvatar");goog.provide("jive.shared.displayutil.avatar");goog.provide("jive.shared.displayutil.avatarImage");goog.provide("jive.shared.displayutil.avatarLink");goog.provide("jive.shared.displayutil.cardError");goog.provide("jive.shared.displayutil.cardLoading");goog.provide("jive.shared.displayutil.close");goog.provide("jive.shared.displayutil.commaItemList");goog.provide("jive.shared.displayutil.containerDisplayNameLink");
goog.provide("jive.shared.displayutil.coreApiAvatar");goog.provide("jive.shared.displayutil.coreApiUserDisplayName");goog.provide("jive.shared.displayutil.coreApiUserDisplayNameLink");goog.provide("jive.shared.displayutil.groupTypeIcon");goog.provide("jive.shared.displayutil.icon");goog.provide("jive.shared.displayutil.infoBox");goog.provide("jive.shared.displayutil.itemList");goog.provide("jive.shared.displayutil.itemListMore");goog.provide("jive.shared.displayutil.messagePopup");goog.provide("jive.shared.displayutil.plainItemList");
goog.provide("jive.shared.displayutil.remoteUserDisplayNameLink");goog.provide("jive.shared.displayutil.renderAttachmentLink");goog.provide("jive.shared.displayutil.renderGuestDisplayName");goog.provide("jive.shared.displayutil.renderIconElement");goog.provide("jive.shared.displayutil.renderIconElementAttrs");goog.provide("jive.shared.displayutil.userDisplayName");goog.provide("jive.shared.displayutil.userDisplayNameLink");goog.provide("jive.shared.displayutil.userRoleBadgeImage");goog.require("soy");
goog.require("soydata");goog.require("soy.StringBuilder");goog.require("jive.shared.file.fileTypeIconClass");
jive.shared.displayutil.avatar=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;var src__soy3=new soy.StringBuilder(opt_data.href?soy.$$escapeHtml(opt_data.href):!opt_data.enabled||!opt_data.visible?"/images/jive-avatar-disabled.png":opt_data.prop&&opt_data.prop.integrationUserInfo&&opt_data.prop.integrationUserInfo.avatar&&!opt_data.forceAvatarID?soy.$$filterNoAutoescape(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.prop.integrationUserInfo.avatar)):opt_data.anonymous?
"/people/guest/avatar/"+soy.$$escapeHtml(opt_data.size)+".png":opt_data.username&&opt_data.avatarID?soy.$$filterNoAutoescape(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/people/"+encodeURIComponent(opt_data.username)+"/avatar/"+opt_data.size+".png",{"a":opt_data.avatarID})):opt_data.username?soy.$$filterNoAutoescape(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/people/"+encodeURIComponent(opt_data.username)+"/avatar/"+opt_data.size+".png")):"/images/jive-avatar-default.png");
src__soy3=src__soy3.toString();if(!opt_data.imageOnly&&!(opt_data.prop&&opt_data.prop.integrationUserInfo)){var param27=new soy.StringBuilder;jive.shared.displayutil.avatarImage(soy.$$augmentMap(opt_data,{src:src__soy3}),param27);jive.shared.displayutil.avatarLink(soy.$$augmentMap(opt_data,{displayName:opt_data.displayName,content:param27.toString()}),output)}else jive.shared.displayutil.avatarImage(soy.$$augmentMap(opt_data,{src:src__soy3}),output);return opt_sb?"":output.toString()};
jive.shared.displayutil.coreApiAvatar=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.shared.displayutil.avatar(soy.$$augmentMap(opt_data,{enabled:opt_data.jive.enabled,visible:opt_data.visible||opt_data.jive.visible,username:opt_data.jive.username,partner:opt_data.jive.externalContributor,size:opt_data.size,uri:opt_data.uri}),output);return opt_sb?"":output.toString()};
jive.shared.displayutil.anonymousAvatar=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.shared.displayutil.avatar({anonymous:true,enabled:true,partner:false,username:"guest",id:0,ID:0,displayName:"",visible:true,prop:null,avatarID:0,size:opt_data.size},output);return opt_sb?"":output.toString()};
jive.shared.displayutil.avatarLink=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;var extraParams___soy56=opt_data.extraParams!=null?opt_data.extraParams:{};var params__soy57=opt_data.trackingID?soy.$$augmentMap({sr:opt_data.trackingID},extraParams___soy56):opt_data.extraParams;var shouldShowUrl__soy58=opt_data.prop&&opt_data.prop.integrationUserInfo&&!opt_data.prop.integrationUserInfo.overrideUrl?true:false;output.append(!opt_data.anonymous&&opt_data.visible?(!opt_data.hideLink&&
!shouldShowUrl__soy58?"<a "+(opt_data.prop&&opt_data.prop.integrationUserInfo?'href="'+soy.$$filterNoAutoescape(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.prop.integrationUserInfo.overrideUrl,params__soy57))+'"':'href="'+soy.$$filterNoAutoescape(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/people/"+encodeURIComponent(opt_data.username),params__soy57))+'"')+'aria-label="'+soy.$$escapeHtml(opt_data.displayName)+'" class="j-avatar '+(opt_data.extraClass?soy.$$escapeHtml(opt_data.extraClass)+
" ":"")+(!opt_data.hideTooltip&&!(opt_data.prop&&opt_data.prop.integrationUserInfo)?" jiveTT-hover-user":"")+(!opt_data.hidePartnerBadge&&!opt_data.currentUserPartner&&opt_data.partner&&opt_data.size>=32?" j-partner":"")+'"'+(!(opt_data.prop&&opt_data.prop.integrationUserInfo)?'data-userId="'+(opt_data.ID?soy.$$escapeHtml(opt_data.ID):soy.$$escapeHtml(opt_data.id))+'"':"")+(opt_data.prop&&opt_data.prop.presence&&!(opt_data.prop&&opt_data.prop.integrationUserInfo)?' data-online="'+soy.$$escapeHtml(opt_data.prop.presence.online)+
'" data-presence="'+soy.$$escapeHtml(opt_data.prop.presence.jsObject)+'" data-externalId="'+(opt_data.prop.presence.userExternalID?soy.$$escapeHtml(opt_data.prop.presence.userExternalID):"")+'"'+(opt_data.avatarID?' data-avatarId="'+soy.$$escapeHtml(opt_data.avatarID)+'"':"")+(opt_data.username&&!(opt_data.prop&&opt_data.prop.integrationUserInfo)?'  data-username="'+soy.$$escapeHtml(encodeURIComponent(opt_data.username))+'"':""):"")+(opt_data.uri?' data-uri="'+soy.$$escapeHtml(opt_data.uri)+'"':"")+
">":"")+(opt_data.content?soy.$$filterNoAutoescape(opt_data.content):"")+(opt_data.enabled?(!opt_data.hidePartnerBadge&&!opt_data.currentUserPartner&&opt_data.partner&&opt_data.size>=32?'<span class="jive-icon-med jive-icon-partner" aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("partner.browse.external.contributor"),[]))+'"></span>':"")+(opt_data.showDisplayName?soy.$$escapeHtml(opt_data.displayName):""):"")+(!opt_data.hideLink&&shouldShowUrl__soy58==false?"</a>":""):opt_data.content?
soy.$$filterNoAutoescape(opt_data.content):"");return opt_sb?"":output.toString()};
jive.shared.displayutil.avatarImage=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<img class="jive-avatar" src="',soy.$$filterNoAutoescape(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.src)),'"',opt_data.avatarID?' data-avatarId="'+soy.$$escapeHtml(opt_data.avatarID)+'"':"",opt_data.username?' data-username="'+soy.$$escapeHtml(encodeURIComponent(opt_data.username))+'"':"",!opt_data.hideHeight?' height="'+soy.$$escapeHtml(opt_data.size)+'" data-height="'+
soy.$$escapeHtml(opt_data.size)+'"':"",'width="',soy.$$escapeHtml(opt_data.size),'"',opt_data.storeSizeData?' data-size="'+soy.$$escapeHtml(opt_data.size)+'"':"",!opt_data.anonymous&&opt_data.visible&&opt_data.enabled?' data-random="'+soy.$$escapeHtml(jive.soy.func.randomString())+'"':"",opt_data.style?' style="'+soy.$$escapeHtml(opt_data.style)+'"':"",'alt="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("photoavatar.edit.profile_photo.title"),[])),'"',opt_data.displayName?' alt="'+soy.$$escapeHtml(opt_data.displayName)+
'" title="'+soy.$$escapeHtml(opt_data.displayName)+'"':""," />");return opt_sb?"":output.toString()};
jive.shared.displayutil.icon=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.type=="url")output.append('<span aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.externalUrl"),[])),'" role=img class="jive-icon-',soy.$$escapeHtml(opt_data.size),' jive-icon-external-site"></span>');else if(opt_data.type=="favorite")output.append('<span aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.bookmark"),[])),'" role="img" class="jive-icon-',
soy.$$escapeHtml(opt_data.size),' jive-icon-bookmark"></span>');else if(opt_data.type=="post")output.append('<span aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.blogPost"),[])),'" role="img" class="jive-icon-',soy.$$escapeHtml(opt_data.size),' jive-icon-blog"></span>');else if(opt_data.type=="update")output.append('<span aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.status"),[])),'" role="img" class="jive-icon-',soy.$$escapeHtml(opt_data.size),
' jive-icon-status"></span>');else if(opt_data.type=="dm")output.append('<span aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.message"),[])),'" role="img" class="jive-icon-',soy.$$escapeHtml(opt_data.size),' jive-icon-direct-message"></span>');else if(opt_data.type=="comment")output.append(opt_data.rootType?opt_data.rootType=="post"?'<span aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.comment"),[]))+'" role="img" class="jive-icon-'+soy.$$escapeHtml(opt_data.size)+
' jive-icon-blog-comment"></span>':opt_data.rootType=="update"?'<span aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.comment"),[]))+'" role="img" class="jive-icon-'+soy.$$escapeHtml(opt_data.size)+' jive-icon-status-comment"></span>':opt_data.rootType=="entry"||opt_data.rootType=="file"?'<span aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.comment"),[]))+'" role="img" class="jive-icon-'+soy.$$escapeHtml(opt_data.size)+' jive-icon-comment"></span>':
opt_data.rootType=="dm"?'<span aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.comment"),[]))+'" role="img" class="jive-icon-'+soy.$$escapeHtml(opt_data.size)+' jive-icon-direct-message"></span>':opt_data.rootType!="comment"?'<span aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.comment"),[]))+'" role="img" class="jive-icon-'+soy.$$escapeHtml(opt_data.size)+" jive-icon-"+soy.$$escapeHtml(opt_data.rootType)+'-comment"></span>':"":opt_data.parentContent&&
opt_data.parentContent.type?opt_data.parentContent.type=="post"?'<span aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.comment"),[]))+'" role="img" class="jive-icon-'+soy.$$escapeHtml(opt_data.size)+' jive-icon-blog-comment"></span>':opt_data.parentContent.type=="update"?'<span aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.comment"),[]))+'" role="img" class="jive-icon-'+soy.$$escapeHtml(opt_data.size)+' jive-icon-status-comment"></span>':opt_data.parentContent.type==
"entry"?'<span aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.comment"),[]))+'" role="img" class="jive-icon-'+soy.$$escapeHtml(opt_data.size)+' jive-icon-comment"></span>':opt_data.parentContent.type=="dm"?'<span aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.comment"),[]))+'" role="img" class="jive-icon-'+soy.$$escapeHtml(opt_data.size)+' jive-icon-direct-message"></span>':opt_data.parentContent.type!="comment"?'<span aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.comment"),
[]))+'" role="img" class="jive-icon-'+soy.$$escapeHtml(opt_data.size)+" jive-icon-"+soy.$$escapeHtml(opt_data.parentContent.type)+'-comment"></span>':"":'<span aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.comment"),[]))+'" role="img" class="jive-icon-'+soy.$$escapeHtml(opt_data.size)+' jive-icon-comment"></span>');else if(opt_data.type=="discussion"||opt_data.type=="message")output.append(opt_data.answer?'<span aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.discussion"),
[]))+'" role="img" class="jive-icon-'+soy.$$escapeHtml(opt_data.size)+' jive-icon-discussion-correct"></span>':opt_data.helpful?'<span aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.discussion"),[]))+'" role="img" class="jive-icon-'+soy.$$escapeHtml(opt_data.size)+' jive-icon-discussion-helpful"></span>':opt_data.question?'<span aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.discussion"),[]))+'" role="img" class="jive-icon-'+soy.$$escapeHtml(opt_data.size)+
' jive-icon-discussion-question"></span>':'<span aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.discussion"),[]))+'" role="img" class="jive-icon-'+soy.$$escapeHtml(opt_data.size)+' jive-icon-discussion"></span>');else if(opt_data.type=="file"){output.append('<span aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.uploaded_file"),[])),'" class="');if(opt_data.iconCss)output.append("jive-icon-",soy.$$escapeHtml(opt_data.size)," ",soy.$$escapeHtml(opt_data.iconCss));
else jive.shared.file.fileTypeIconClass({extension:opt_data.extension,size:opt_data.size,defaultIcon:"jive-icon-document-upload"},output);output.append('"></span>')}else if(opt_data.type=="person"&&opt_data.jive)if(opt_data.size=="sml")jive.shared.displayutil.avatar(soy.$$augmentMap(opt_data,{username:opt_data.jive.username,size:12,enabled:true,visible:true}),output);else if(opt_data.size=="med")jive.shared.displayutil.avatar(soy.$$augmentMap(opt_data,{username:opt_data.jive.username,size:16,enabled:true,
visible:true}),output);else if(opt_data.size=="big")jive.shared.displayutil.avatar(soy.$$augmentMap(opt_data,{username:opt_data.jive.username,size:25,enabled:true,visible:true}),output);else jive.shared.displayutil.avatar(soy.$$augmentMap(opt_data,{username:opt_data.jive.username,size:opt_data.size,enabled:true,visible:true}),output);else if(opt_data.type=="userregistration")output.append('<span aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.profile"),[])),'" role="img" class="jive-icon-med jive-icon-profile"></span>');
else if(opt_data.type=="extStreamActivity")output.append('<img aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tse.objecttype.name"),[])),'" role="img" class="jive-icon-',soy.$$escapeHtml(opt_data.size),'" alt="" src="',soy.$$escapeHtml(opt_data.productIcon),'"></img>');else if(opt_data.type=="interaction"||opt_data.type=="collaboration")output.append('<span aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.comment"),[])),'" role="img" class="jive-icon-',
soy.$$escapeHtml(opt_data.size),' jive-icon-direct-message"></span>');else if(opt_data.type=="profileimage")output.append('<span aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("people.profileimage.name"),[])),'" role="img" class="jive-icon-',soy.$$escapeHtml(opt_data.size),' jive-icon-photo"></span>');else if(opt_data.type=="106642994"||opt_data.type=="photoAlbum")output.append('<span aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("global.access.content.type."+
opt_data.type)),[])),'" role="img" class="jive-icon-',soy.$$escapeHtml(opt_data.size),' jive-icon-doctype-image"></span>');else if(opt_data.type)output.append('<span aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("global.access.content.type."+opt_data.type)),[])),'" role="img" class="jive-icon-',soy.$$escapeHtml(opt_data.size)," jive-icon-",soy.$$escapeHtml(opt_data.type),'"></span>');return opt_sb?"":output.toString()};
jive.shared.displayutil.cardError=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("error.general"),[])));return opt_sb?"":output.toString()};
jive.shared.displayutil.cardLoading=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-card-loading"><strong class="jive-tooltip2-loading">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.loading"),[])),"</strong></div>");return opt_sb?"":output.toString()};
jive.shared.displayutil.userDisplayNameLink=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;var extraParams___soy417=opt_data.extraParams!=null?opt_data.extraParams:{};var params__soy418=opt_data.trackingID?soy.$$augmentMap({sr:opt_data.trackingID},extraParams___soy417):opt_data.extraParams;output.append(opt_data.displayName?!opt_data.anonymous?opt_data.prop&&opt_data.prop.integrationUserInfo&&!opt_data.prop.integrationUserInfo.overrideUrl?'<span class="jive-username-span jive-username-link jive-integration-user '+
(!opt_data.enabled?" jive-user-disabled":"")+" "+(opt_data.extraCss?" "+soy.$$escapeHtml(opt_data.extraCss):"")+'" '+(opt_data.renderInvisible?'style="display:none;"':"")+">"+(opt_data.displayNameOverride?soy.$$escapeHtml(opt_data.displayNameOverride):soy.$$escapeHtml(opt_data.displayName))+"</span>":opt_data.visible?"<a "+(opt_data.prop&&opt_data.prop.integrationUserInfo?'href="'+soy.$$filterNoAutoescape(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.prop.integrationUserInfo.overrideUrl,
params__soy418))+'" class="jive-username-link ':'href="'+soy.$$filterNoAutoescape(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/people/"+encodeURIComponent(opt_data.username),params__soy418))+'" data-username="'+soy.$$escapeHtml(opt_data.username)+'" data-avatarId="'+soy.$$escapeHtml(opt_data.avatarID)+'" data-userId="'+soy.$$escapeHtml(opt_data.id)+'" '+(opt_data.prop&&opt_data.prop.presence&&opt_data.prop.presence.jsObject?'data-online="'+soy.$$escapeHtml(opt_data.prop.presence.online)+
'" data-presence="'+soy.$$escapeHtml(opt_data.prop.presence.jsObject)+'" data-externalId="'+(opt_data.prop.presence.userExternalID?soy.$$escapeHtml(opt_data.prop.presence.userExternalID):"")+'" ':"")+'class="jive-username-link '+(!opt_data.hideTooltip?" jiveTT-hover-user":"")+" ")+(!opt_data.enabled?" jive-user-disabled":"")+" "+(opt_data.extraCss?" "+soy.$$escapeHtml(opt_data.extraCss):"")+'" '+(opt_data.renderInvisible?'style="display:none;"':"")+">"+(opt_data.displayNameOverride?soy.$$escapeHtml(opt_data.displayNameOverride):
soy.$$escapeHtml(opt_data.displayName))+"</a>":'<span class="jive-username-span jive-username-link '+(!opt_data.enabled?" jive-user-disabled":"")+" "+(opt_data.extraCss?" "+soy.$$escapeHtml(opt_data.extraCss):"")+'" '+(opt_data.renderInvisible?'style="display:none;"':"")+">"+(opt_data.displayNameOverride?soy.$$escapeHtml(opt_data.displayNameOverride):soy.$$escapeHtml(opt_data.displayName))+"</span>":'<em class="guest">'+soy.$$escapeHtml(opt_data.displayName)+"</em>":"");return opt_sb?"":output.toString()};
jive.shared.displayutil.coreApiUserDisplayNameLink=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.shared.displayutil.userDisplayNameLink(soy.$$augmentMap(opt_data,{anonymous:false,enabled:opt_data.jive.enabled,username:opt_data.jive.username,visible:opt_data.jive.visible}),output);return opt_sb?"":output.toString()};
jive.shared.displayutil.remoteUserDisplayNameLink=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<span><img src="',soy.$$escapeHtml(opt_data.avatarUrl),'" width="48" height="48" alt="" class="jive-avatar" /></span><h5>',soy.$$escapeHtml(opt_data.userDisplayName),'</h5><span class="jive-note-user-status">',soy.$$escapeHtml(opt_data.userStatus),'</span><ul class="jive-profile-tt-fields">',opt_data.userPhone?"<li><strong>Phone Number:</strong> "+soy.$$escapeHtml(opt_data.userPhone)+
"</li>":"",opt_data.userEmail?'<li><strong>Email:</strong> <a href="mailto:'+soy.$$escapeHtml(opt_data.userEmail)+'">'+soy.$$escapeHtml(opt_data.userEmail)+"</a></li>":"","</ul>");var extraParams___soy551=opt_data.extraParams!=null?opt_data.extraParams:{};output.append('<p><a href="',soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.profileUrl,extraParams___soy551)),'">View ',soy.$$escapeHtml(opt_data.userDisplayName),"'s profile</a></p>");return opt_sb?"":output.toString()};
jive.shared.displayutil.userDisplayName=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.displayName?!opt_data.anonymous?soy.$$escapeHtml(opt_data.displayName):'<em class="guest">'+soy.$$escapeHtml(opt_data.displayName)+"</em>":"");return opt_sb?"":output.toString()};
jive.shared.displayutil.coreApiUserDisplayName=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.shared.displayutil.userDisplayName(soy.$$augmentMap(opt_data,{anonymous:opt_data.jive.anonymous}),output);return opt_sb?"":output.toString()};
jive.shared.displayutil.renderGuestDisplayName=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.message.displayName?soy.$$escapeHtml(opt_data.message.displayName):opt_data.message.username?soy.$$escapeHtml(opt_data.message.username):opt_data.message.userEmail?soy.$$escapeHtml(opt_data.message.userEmail):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.guest"),[])));return opt_sb?"":output.toString()};
jive.shared.displayutil.containerDisplayNameLink=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<a href="',soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.container.jiveObjectURL)),'" class="font-color-meta j-container ',!opt_data.hideTooltip?" jivecontainerTT-hover-container":"",'" data-objectId="',soy.$$escapeHtml(opt_data.container.id),'" data-objectType="',soy.$$escapeHtml(opt_data.container.type),'">',opt_data.container.typeSocialGroup?
soy.$$filterNoAutoescape(opt_data.container.name):opt_data.container.typeUserContainer&&opt_data.container.typeWallEntry?soy.$$filterNoAutoescape(jive.i18n.i18nText(jive.i18n.getMsg("activity.in_user_container2.we"),[opt_data.container.userDisplayName])):opt_data.container.typeUserContainer?soy.$$filterNoAutoescape(opt_data.container.userDisplayName):soy.$$filterNoAutoescape(opt_data.container.name),"</a>");return opt_sb?"":output.toString()};
jive.shared.displayutil.groupTypeIcon=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.size?opt_data.size=="med"?"<span aria-label='"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("global.group."+opt_data.typeName)),[]))+"' role='img' class=\"jive-icon-med jive-icon-group-"+soy.$$escapeHtml(opt_data.typeName)+'"></span>':opt_data.size=="big"||opt_data.size=="large"?"<span aria-label='"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("global.group."+
opt_data.typeName)),[]))+"' role='img' class=\"jive-icon-big jive-icon-group-"+soy.$$escapeHtml(opt_data.typeName)+'"></span>':"<span aria-label='"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("global.group."+opt_data.typeName)),[]))+"' role='img' class=\"jive-icon-sml jive-icon-group-"+soy.$$escapeHtml(opt_data.typeName)+'"></span>':"");return opt_sb?"":output.toString()};
jive.shared.displayutil.renderIconElement=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;switch(opt_data.icon.tag){case "img":output.append("<img ");jive.shared.displayutil.renderIconElementAttrs(opt_data.icon,output);output.append("/>");break;case "span":output.append("<span ");jive.shared.displayutil.renderIconElementAttrs({attributeNames:opt_data.icon.attributeNames,attributes:opt_data.icon.attributes,extraAttributes:opt_data.extraAttributes},output);output.append("></span>");
break;case "div":output.append("<div ");jive.shared.displayutil.renderIconElementAttrs(opt_data.icon,output);output.append("></div>");break}return opt_sb?"":output.toString()};
jive.shared.displayutil.renderIconElementAttrs=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;var nameList646=opt_data.attributeNames;var nameListLen646=nameList646.length;for(var nameIndex646=0;nameIndex646<nameListLen646;nameIndex646++){var nameData646=nameList646[nameIndex646];output.append(soy.$$escapeHtml(nameData646),'="',soy.$$escapeHtml(opt_data.attributes[nameData646]),opt_data.extraAttributes?" "+soy.$$escapeHtml(opt_data.extraAttributes):"",'" ')}return opt_sb?"":output.toString()};
jive.shared.displayutil.renderAttachmentLink=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.object.meta&&opt_data.object.meta.length>0&&opt_data.object.meta[0].fullImageUrl?'<a href="'+soy.$$escapeHtml(opt_data.object.meta[0].fullImageUrl)+'" class="jive-icon-med jive-icon-photo" title="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("profile.update.status.image"),[]))+'" aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("profile.update.status.image"),
[]))+'"></a>':"");return opt_sb?"":output.toString()};
jive.shared.displayutil.messagePopup=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-alert-container" role="alert" aria-live="polite" aria-atomic="true"><div class="j-alert j-rc5 j-alert-',soy.$$escapeHtml(opt_data.style)," clearfix ",opt_data.showClose?"j-alert-withbutton":"",'"><span class="j-js-alert-message"></span>');if(opt_data.showClose){output.append('<a href="#" class="j-js-message-popup-close-button j-close-button" ',!opt_data.showCloseAria?
'aria-hidden="true"':"",'><span class="j-508-label">');if(opt_data.closeTitle)output.append(soy.$$escapeHtml(opt_data.closeTitle));else jive.shared.displayutil.close(null,output);output.append('</span><span class="jive-icon-med jive-glyph-delete-white"></span></a>')}output.append("</div></div>");return opt_sb?"":output.toString()};
jive.shared.displayutil.infoBox=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="jive-info-box"><div><span class="jive-icon-med jive-icon-info"></span><strong>',soy.$$escapeHtml(opt_data.message),"</strong></div></div>");return opt_sb?"":output.toString()};
jive.shared.displayutil.close=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close"),[])));return opt_sb?"":output.toString()};
jive.shared.displayutil.a11yBoundary=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<span class="j-508-label a11y-boundary">',opt_data.type=="menu"?opt_data.isEnd?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("a11y.boundary.menu.end"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("a11y.boundary.menu.start"),[])):opt_data.isEnd?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("a11y.boundary.dialog.start"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("a11y.boundary.dialog.end"),
[])),"</span>");return opt_sb?"":output.toString()};
jive.shared.displayutil.itemList=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<span class="j-item-list js-item-list',opt_data.classNames?" "+soy.$$escapeHtml(opt_data.classNames):"","\" data-items='",soy.$$escapeHtml(JSON.stringify(opt_data.items).replace(/</g,"\\u003C").replace(/>/g,"\\u003E").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")),"'>");if(!opt_data.items||opt_data.items.length==0);else if(opt_data.items.length<4)jive.shared.displayutil.plainItemList(opt_data,
output);else if(opt_data.items.length==4)output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("itemList.4"),[opt_data.items[0],opt_data.items[1],opt_data.items[2],opt_data.items[3]])));else{output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("itemList.more"),[opt_data.items[0],opt_data.items[1],opt_data.items[2]]))," <",soy.$$escapeHtml(opt_data.tagName?opt_data.tagName:"a")," ");if(opt_data.useTitle){output.append('title="');jive.shared.displayutil.plainItemList({items:opt_data.items.slice(3)},
output);output.append('" ')}output.append('class="j-item-list-more js-item-list-more',opt_data.moreClassNames?" "+soy.$$escapeHtml(opt_data.moreClassNames):"",opt_data.expandable?" js-item-list-showMore":"",'"',!opt_data.tagName?' href="#"':"",">",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("itemList.others"),[opt_data.items.length-3])),"</",soy.$$escapeHtml(opt_data.tagName?opt_data.tagName:"a"),">")}output.append("</span>");return opt_sb?"":output.toString()};
jive.shared.displayutil.itemListMore=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.shared.displayutil.plainItemList(opt_data,output);output.append(' <a href="#" class="j-item-list-showFewer js-item-list-showFewer">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("itemList.showFewer"),[])),"</a>");return opt_sb?"":output.toString()};
jive.shared.displayutil.plainItemList=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(!opt_data.items||opt_data.items.length==0);else if(opt_data.items.length==1)output.append(soy.$$escapeHtml(opt_data.items[0]));else if(opt_data.items.length==2)output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("itemList.2"),[opt_data.items[0],opt_data.items[1]])));else if(opt_data.items.length==3)output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("itemList.3"),
[opt_data.items[0],opt_data.items[1],opt_data.items[2]])));else{jive.shared.displayutil.commaItemList({items:opt_data.items.slice(0,-3)},output);output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("itemList.delim"),[]))," ");jive.shared.displayutil.plainItemList({items:opt_data.items.slice(-3)},output)}return opt_sb?"":output.toString()};
jive.shared.displayutil.commaItemList=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;var itemList776=opt_data.items;var itemListLen776=itemList776.length;for(var itemIndex776=0;itemIndex776<itemListLen776;itemIndex776++){var itemData776=itemList776[itemIndex776];output.append(itemIndex776==0?soy.$$escapeHtml(itemData776):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("itemList.delim"),[]))+" "+soy.$$escapeHtml(itemData776))}return opt_sb?"":output.toString()};
jive.shared.displayutil.userRoleBadgeImage=function(opt_data,opt_sb){opt_data=opt_data||{};var output=opt_sb||new soy.StringBuilder;output.append(opt_data.groupBadgeUri&&opt_data.groupBadgeRoleName?'<img src="'+soy.$$escapeHtml(opt_data.groupBadgeUri)+'" title="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("rolebadge."+String(opt_data.groupBadgeRoleName).toLowerCase())),[]))+'" alt="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("rolebadge."+
String(opt_data.groupBadgeRoleName).toLowerCase())),[]))+'" height="16" width="16" class="j-role-badge">':"");return opt_sb?"":output.toString()};
;
goog.provide("jive.CommentApp.soy.outcomeAttachment");goog.provide("jive.CommentApp.soy.outcomeAttachmentMenu");goog.provide("jive.CommentApp.soy.renderReply");goog.require("soy");goog.require("soydata");goog.require("soy.StringBuilder");goog.require("jive.outcomes.badge.badgeRaw");goog.require("jive.resource.url");goog.require("jive.shared.displayutil.avatar");goog.require("jive.shared.soy.i18nHelper");
jive.CommentApp.soy.renderReply=function(opt_data,opt_sb){opt_data=opt_data||{};var output=opt_sb||new soy.StringBuilder;output.append('<li class="addReply jive-js-addReply" style="display:none;',opt_data.indent?" margin-left:"+soy.$$escapeHtml(opt_data.indent):"",'">');jive.shared.displayutil.avatar({anonymous:_jive_current_user.anonymous,enabled:_jive_current_user.enabled,partner:_jive_current_user.partner,username:_jive_current_user.username,id:_jive_current_user.id,ID:_jive_current_user.ID,displayName:_jive_current_user.displayName,
visible:true,prop:_jive_current_user.prop,avatarID:_jive_current_user.avatarID,currentUserPartner:_jive_current_user.partner,size:32},output);output.append('<div class="jive-comment-arrow"></div><div class="jive-comment-content jive-create-comment"><p class="jive-comment-meta font-color-meta-light"><strong style="" class="font-color-meta replyTo">');jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("cmnt.reply_to.gtitle"),arg0:'<span class="replyToName">'+soy.$$escapeHtml(opt_data.username)+"</span>",
noAutoEscape:true},output);output.append('<img src="');jive.resource.url({path:"/images/inline-reply-arrow.png"},output);output.append('" alt=""/></strong></p>');if(opt_data.commentMode=="comments")jive.CommentApp.soy.outcomeAttachmentMenu(null,output);output.append("<div ",opt_data.commentID?'id="comment-body-'+soy.$$escapeHtml(opt_data.commentID)+'"':"",' class="jive-comment-body"><div class="jive-rendered-content"><p><div ',opt_data.commentID?'id="jive-content-post-'+soy.$$escapeHtml(opt_data.commentID)+
'"':"",' class="jive-comment-post"></div></p></div></div></div></li>');return opt_sb?"":output.toString()};
jive.CommentApp.soy.outcomeAttachmentMenu=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-reply-outcome-action-container js-reply-outcome-action-container" style="display: none;"><a href="#" class="font-color-meta js-reply-outcome-button">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.reply.actionButton.label"),[])),' <span class="j-ui-elem j-action-down-arrow"></span></a><div class="js-reply-outcome-badge-container" styles="display: none;"></div></div>');return opt_sb?
"":output.toString()};
jive.CommentApp.soy.outcomeAttachment=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<span>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("cmnt.outcome.attached"),[]))," ");jive.outcomes.badge.badgeRaw({tagName:"span",outcomeType:String(opt_data.outcomeType.name).toLowerCase(),embedded:true},output);output.append('<a href="#" class="j-remove-outcome js-remove-outcome" title="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.remove"),[])),'"><span class="jive-icon-sml jive-glyph-remove"></span><span class="j-508-label"></span></a></span>');
return opt_sb?"":output.toString()};
;
goog.provide("jive.DiscussionApp.soy.renderReply");goog.provide("jive.DiscussionApp.soy.replyErrorMessage");goog.provide("jive.DiscussionApp.soy.rteMsgQuote");goog.require("soy");goog.require("soydata");goog.require("soy.StringBuilder");goog.require("jive.CommentApp.soy.outcomeAttachmentMenu");goog.require("jive.resource.url");goog.require("jive.shared.soy.i18nHelper");
jive.DiscussionApp.soy.renderReply=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<li class="addReply jive-js-addReply" style="display:none"><div msgID="',soy.$$escapeHtml(opt_data.messageID),'" class="jive-thread-reply-indent0 jive-reply-add-inline"><div class="jive-thread-reply-indent-shadow"><div class="jive-thread-reply jive-thread-reply-self clearfix"><div class="jive-thread-reply-inline">',opt_data.moderated?'<div id="jive-moderation-box" class="jive-content-moderation-box"><span class="jive-icon-med jive-icon-warn"></span>'+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("mod.content.create"),[]))+"</div>":"",'<strong class="font-color-meta">',soy.$$escapeHtml(opt_data.i18n.forumThrdReplyTo),' <span class="replyToName">',soy.$$escapeHtml(opt_data.userName),'</span> <img src="');jive.resource.url({path:"/images/inline-reply-arrow.png"},output);output.append('" alt=""></strong>',opt_data.externallyVisible=="true"?"":"",opt_data.anonymous?'<div class="jive-comment-post-anonymous"><div><input id="reply-author" name="replyGuestName" type="text" required aria-required="true"><label for="reply-author">'+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.name"),[]))+'<span class="font-color-meta-light">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("blogs.vwpst.required.label"),[]))+'</span></label></div><div><input id="comment-email" name="replyGuestEmail" type="email" required aria-required="true"><label for="comment-email">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.email_address"),[]))+'<span class="font-color-meta-light">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("blogs.vwpst.rqdNotPblshd.label"),
[]))+"</span></label></div></div>":"",'<a class="font-color-meta advEditor" href="javascript:void(0);">',soy.$$escapeHtml(opt_data.i18n.advEditor),"</a>");jive.CommentApp.soy.outcomeAttachmentMenu(null,output);output.append('<p class="jive-discussion-post"></p></div></div></div></div></li>');return opt_sb?"":output.toString()};
jive.DiscussionApp.soy.replyErrorMessage=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(opt_data.key),[])));return opt_sb?"":output.toString()};
jive.DiscussionApp.soy.rteMsgQuote=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="jive-rendered-content"><blockquote class="jive-quote"><span class="jive-quote-header">');if(opt_data.isAnonymous)output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("post.guest_wrote.label"),[])));else{output.append("<span>");jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("post.user_wrote.label"),arg0:'<a href="'+soy.$$escapeHtml(opt_data.author.resources.html.ref)+
'" data-object-id="'+soy.$$escapeHtml(opt_data.author.id)+'" data-object-type="'+soy.$$escapeHtml(opt_data.author.type)+'"></a>',noAutoEscape:"true"},output);output.append("</span>")}output.append("</span><br/><br/>",soy.$$filterNoAutoescape(opt_data.msgBody),"</blockquote></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.shared.formwaiting.formWaitingOverlay");goog.require("soy");goog.require("soydata");goog.require("soy.StringBuilder");jive.shared.formwaiting.formWaitingOverlay=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="jive-js-form-disable jive-form-waiting-disable"><div class="',soy.$$escapeHtml(opt_data.bgCssClass),'"></div></div>');return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.action.actionButton");goog.provide("jive.outcomes.action.actionMenu");goog.provide("jive.outcomes.action.actionMenuItem");goog.provide("jive.outcomes.action.actionTooltip");goog.provide("jive.outcomes.action.confirmModal");goog.provide("jive.outcomes.action.createdMessage");goog.provide("jive.outcomes.action.deletedMessage");goog.provide("jive.outcomes.action.inProgressConfirmModal");goog.provide("jive.outcomes.action.markAlertModal");goog.provide("jive.outcomes.action.outcomeNoteModal");
goog.provide("jive.outcomes.action.outdatedAlertModal");goog.provide("jive.outcomes.action.pendingAlertModal");goog.provide("jive.outcomes.action.pendingAlertPermissionWarning");goog.provide("jive.outcomes.action.pendingAssigneeModal");goog.provide("jive.outcomes.action.tloExclusionModal");goog.provide("jive.outcomes.action.unknownError");goog.provide("jive.outcomes.action.updatedMessage");goog.require("soy");goog.require("soydata");goog.require("soy.StringBuilder");
jive.outcomes.action.actionButton=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<a href="#" class="font-color-meta js-outcome-button j-outcome-button',opt_data.extraClasses?" "+soy.$$escapeHtmlAttribute(opt_data.extraClasses):"",'" data-object-type="',soy.$$escapeHtmlAttribute(opt_data.objectType),'" data-object-id="',soy.$$escapeHtmlAttribute(opt_data.objectId),'"',opt_data.domActions?'data-dom-actions="'+soy.$$escapeHtmlAttribute(JSON.stringify(opt_data.domActions).replace(/</g,
"\\u003C").replace(/>/g,"\\u003E").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029"))+'"':"",opt_data.parentId?'data-parent-id="'+soy.$$escapeHtmlAttribute(opt_data.parentId)+'"':"",opt_data.context?'data-context="'+soy.$$escapeHtmlAttribute(opt_data.context)+'"':"",opt_data.communityName?'data-root-community="'+soy.$$escapeHtmlAttribute(opt_data.communityName)+'"':"",opt_data.contextMeta?'data-meta-context="'+soy.$$escapeHtmlAttribute(opt_data.contextMeta)+'"':"",">",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.actionButton.label"),
[])),' <span class="j-ui-elem j-action-down-arrow"></span></a>');return opt_sb?"":output.toString()};
jive.outcomes.action.actionMenu=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-pop-main j-menu j-quick-menu">');if(opt_data.outcomes.length){output.append('<h4 id="action-menu-outcome-heading" class="j-menu-section-heading font-color-meta-light">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.actionMenu.outcomesHeading"),[])),'</h4><ul aria-labelledby="action-menu-outcome-heading">');var itemList48=opt_data.outcomes;var itemListLen48=
itemList48.length;for(var itemIndex48=0;itemIndex48<itemListLen48;itemIndex48++){var itemData48=itemList48[itemIndex48];jive.outcomes.action.actionMenuItem(itemData48,output)}if(opt_data.additionalActions){var itemList53=opt_data.additionalActions;var itemListLen53=itemList53.length;for(var itemIndex53=0;itemIndex53<itemListLen53;itemIndex53++){var itemData53=itemList53[itemIndex53];jive.outcomes.action.actionMenuItem(itemData53,output)}}output.append("</ul>")}if(opt_data.actions.length){output.append('<h4 id="action-menu-action-heading" class="j-menu-section-heading font-color-meta-light">',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.actionMenu.actionHeading"),[])),'</h4><ul id="action-menu-action-list" aria-labelledby="action-menu-action-heading">');var itemList62=opt_data.actions;var itemListLen62=itemList62.length;for(var itemIndex62=0;itemIndex62<itemListLen62;itemIndex62++){var itemData62=itemList62[itemIndex62];jive.outcomes.action.actionMenuItem(itemData62,output)}output.append("</ul>")}output.append(!opt_data.actions.length&&!opt_data.outcomes.length?'<div class="j-no-actions">'+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.actionMenu.emptyMessage"),[]))+"</div>":"","</div>");return opt_sb?"":output.toString()};
jive.outcomes.action.actionMenuItem=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<li>",opt_data.url||opt_data.event?'<a class="js-actionItem lnk '+soy.$$escapeHtmlAttribute(opt_data.extraClasses?opt_data.extraClasses:"")+'"'+(opt_data.actionData?'data-action-data="'+soy.$$escapeHtmlAttribute(opt_data.actionData)+'"':"")+(opt_data.event?'data-event="'+soy.$$escapeHtmlAttribute(opt_data.event)+'"':"")+'href="'+soy.$$filterNoAutoescape(opt_data.url?opt_data.url:"#")+
'">':'<span class="font-color-meta j-disabled-actionItem '+soy.$$escapeHtmlAttribute(opt_data.extraClasses?opt_data.extraClasses:"")+'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.actionMenu.item."+opt_data.labelSuffix)),[])),opt_data.url||opt_data.event?"</a>":"</span>","</li>");return opt_sb?"":output.toString()};
jive.outcomes.action.createdMessage=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<div>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.action.createdMessage."+opt_data.suffix)),[])),"</div>");return opt_sb?"":output.toString()};
jive.outcomes.action.deletedMessage=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<div>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.action.deletedMessage."+opt_data.suffix)),[])),"</div>");return opt_sb?"":output.toString()};
jive.outcomes.action.updatedMessage=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<div>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.action.updatedMessage."+opt_data.suffix)),[])),"</div>");return opt_sb?"":output.toString()};
jive.outcomes.action.unknownError=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<div>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.unknownError"),[])),"</div>");return opt_sb?"":output.toString()};
jive.outcomes.action.confirmModal=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="jive-modal jive-modal-narrow j-outcome-confirm"><header><h2 class="jive-modal-title">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.action.confirmMessage."+String(opt_data.outcomeType.name).toLowerCase()+".title")),[])),'</h2></header><a href="#" class="j-modal-close-top close">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close"),
[])),'<span class="j-close-icon j-ui-elem" role="img"></span></a><div class="jive-modal-content clearfix"><p><span class="jive-icon-med jive-icon-warn"></span><span class="j-confirm-question">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.action.confirmMessage."+String(opt_data.outcomeType.name).toLowerCase()+".question")),[])),'</span><span class="j-confirm-result">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.action.confirmMessage."+
String(opt_data.outcomeType.name).toLowerCase()+".result")),[])),'</span></p><div class="jive-form-buttons"><button type="button" name="ok" class="j-btn-callout">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.action.confirmMessage."+String(opt_data.outcomeType.name).toLowerCase()+".confirmButton")),[])),'</button><button type="button" name="cancel">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.cancel"),[])),"</button></div></div></div>");return opt_sb?
"":output.toString()};
jive.outcomes.action.tloExclusionModal=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="jive-modal jive-modal-narrow j-outcome-confirm"><header><h2 class="jive-modal-title" aria-label="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.action.confirmMessage.exclusion."+String(opt_data.outcomeType.name).toLowerCase()+".title")),[])),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.action.confirmMessage.exclusion."+String(opt_data.outcomeType.name).toLowerCase()+
".title")),[])),'</h2></header><a href="#" class="j-modal-close-top close">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close"),[])),'<span class="j-close-icon j-ui-elem" role="img"></span></a><div class="jive-modal-content clearfix"><p><span class="jive-icon-med jive-icon-warn"></span><span class="j-confirm-question" id="j-confirm-question-',soy.$$escapeHtmlAttribute(String(opt_data.outcomeType.name).toLowerCase()),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.action.confirmMessage.exclusion."+
String(opt_data.outcomeType.name).toLowerCase()+".question")),[])),'</span><span class="j-confirm-result" id="j-confirm-result-',soy.$$escapeHtmlAttribute(String(opt_data.outcomeType.name).toLowerCase()),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.confirmMessage.exclusion.result"),[])),'</span></p><div class="jive-form-buttons"><button type="button" name="ok" class="j-btn-callout" aria-labelledby="j-confirm-question-',soy.$$escapeHtmlAttribute(String(opt_data.outcomeType.name).toLowerCase()),
'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.confirmMessage.exclusion.confirmButton"),[])),'</button><button type="button" name="cancel">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.cancel"),[])),"</button></div></div></div>");return opt_sb?"":output.toString()};
jive.outcomes.action.outcomeNoteModal=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-outcome-popup"><form name="outcome-note-form" action="#" class="j-form"><header class="j-outcome-modal-heading"><h3 class="font-color-meta">',opt_data.communityName?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.actionMenu.item."+opt_data.outcomeTypeName+".context.post")),[opt_data.communityName])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.actionMenu.item."+
opt_data.outcomeTypeName+".post")),[])),"</h3>",opt_data.communityName?'<span class="font-color-meta">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.actionMenu.item."+opt_data.outcomeTypeName+".context.post.desc")),[]))+"</span>":"",'</header><div class="j-form-row"><div class="j-note-container"><label for="outcome-note">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.outcomeNote.noteLabel"),[])),'</label><textarea id="outcome-note" name="outcome-note" class="j-outcome-note"></textarea></div></div><footer class="j-outcome-modal-footer j-pop-row j-last"><button type="button" name="success" class="j-btn-callout">',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.outcomeNote.sendButton"),[])),'</button><button type="button" name="cancel">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.cancel"),[])),"</button></footer></form></div>");return opt_sb?"":output.toString()};
jive.outcomes.action.pendingAlertModal=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-outcome-popup"><form name="pending-alert-form" action="#" class="j-form"><header class="j-outcome-modal-heading"><h3 class="font-color-meta">',opt_data.isUpdate?opt_data.isTakeOwnership?" "+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.update.title"),[]))+" ":" "+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.unresolve.title"),
[]))+" ":soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.title"),[])),'</h3></header><div class="j-pending-alert-note-container js-pending-alert-note-container j-form-row"><textarea id="pending-alert-note" name="pending-alert-note" class="j-pending-alert-note" placeholder="',!opt_data.existingShare?soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.notePlaceholder.required"),[])):soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.notePlaceholder"),
[])),'"></textarea><label for="pending-alert-note"><span class="font-color-meta">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.noteDescription"),[])),"</span></label></div>",!opt_data.existingShare?'<div class="j-pending-share-target-container js-pending-share-target-container j-form-row j-rc4"><input type="checkbox" id="j-send-pending-share-checkbox" name="send-pending-share"/><label for="j-send-pending-share-checkbox" class="js-send-pending-share-label">'+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.checkboxDescription"),[]))+'</label><div class="j-pending-share j-pending-share-optional js-pending-share" style="display: none;"><div class="j-pending-share-people-picker-container js-pending-share-people-picker-container j-form-row"><input type="text" name="pending-share-users" class="j-autocomplete-input j-user-autocomplete j-ui-elem" role="combobox" placeHolder="'+soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.people.placeHolder"),
[]))+'" aria-label="'+soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.people.placeHolder"),[]))+'"/></div><label for="pending-share-message">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.shareText"),[opt_data.shareText]))+'</label><div class="j-pending-share-place-message-container js-pending-share-place-message-container"><textarea id="pending-share-message" name="pending-share-message" class="j-pending-share-message">'+
soy.$$escapeHtmlRcdata(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.shareText"),[opt_data.shareText]))+"</textarea></div></div></div>":"",'<footer class="j-pending-alert-footer j-pop-row j-last"><button type="submit" name="success" class="j-btn-callout">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.sendButton"),[])),'</button><button type="button" name="cancel">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.cancel"),[])),
"</button></footer></form></div>");return opt_sb?"":output.toString()};
jive.outcomes.action.outdatedAlertModal=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-outcome-popup j-outcome-popup-outdated"><form name="pending-alert-form" action="#" class="j-form"><header class="j-outcome-modal-heading"><h3 class="font-color-meta">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.actionMenu.item.outdated.post"),[])),'</h3></header><div class="jive-form-element j-form-row"><label for="outdated-link">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.outdatedAlert.urlDescription"),
[])),'</label><input type="hidden" id="outdated-url" name="outdated-url"/><input type="text" id="outdated-link" name="outdated-link" class="jive-form-textinput"/><p id="outdated-url-display" class="j-outdated-link-meta font-color-meta-light" name="outdated-url-display"></p></div><footer class="j-outcome-modal-footer j-pop-row j-last"><button type="submit" name="success" class="j-btn-callout">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.outcomeNote.sendButton"),[])),'</button><button type="button" name="cancel">',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.cancel"),[])),"</button></footer></form></div>");return opt_sb?"":output.toString()};
jive.outcomes.action.pendingAssigneeModal=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-outcome-popup" style="width:516px;"><form name="pending-alert-form" action="#" class="j-form"><header class="j-outcome-modal-heading"><h3 class="font-color-meta">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.addContributors.title"),[])),'</h3></header><div class="j-pending-share js-pending-share j-form-row"><div class="j-pending-share-people-picker-container js-pending-share-people-picker-container"><input type="text" name="pending-share-users" class="j-autocomplete-input j-user-autocomplete j-ui-elem" role="combobox" placeHolder="',
soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.people.placeHolder"),[])),'" aria-label="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.people.placeHolder"),[])),'"/></div><label for="pending-share-message">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.shareText"),[opt_data.shareText])),'</label><div class="j-pending-share-place-message-container js-pending-share-place-message-container"><textarea id="pending-share-message" name="pending-share-message" class="j-pending-share-message">',
soy.$$escapeHtmlRcdata(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.shareText"),[opt_data.shareText])),'</textarea></div></div><footer class="j-pending-alert-footer j-pop-row j-last"><button type="submit" name="success" class="j-btn-callout">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.sendButton"),[])),'</button><button type="button" name="cancel">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.cancel"),[])),"</button></footer></form></div>");
return opt_sb?"":output.toString()};
jive.outcomes.action.inProgressConfirmModal=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="jive-modal jive-modal-narrow j-outcome-confirm"><header><h2 class="jive-modal-title" aria-label="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.confirmMessage.edit.wip.document.title"),[])),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.confirmMessage.edit.wip.document.title"),[])),'</h2></header><a href="#" class="j-modal-close-top close">',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close"),[])),'<span class="j-close-icon j-ui-elem" role="img"></span></a><div class="jive-modal-content clearfix"><p><span class="jive-icon-med jive-icon-warn"></span><span class="j-confirm-question" id="j-confirm-question-edit-wip-document">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.confirmMessage.edit.wip.document.question"),[])),'</span><span class="j-confirm-result" id="j-confirm-result-edit-wip-document">',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.confirmMessage.edit.wip.document.result"),[opt_data.user.displayName])),'</span></p><div class="jive-form-buttons"><button type="button" name="ok" class="j-btn-callout" aria-labelledby="j-confirm-question-edit-wip-document">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.confirmMessage.edit.wip.document.confirmButton"),[])),'</button><button type="button" name="cancel">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.cancel"),
[])),"</button></div></div></div>");return opt_sb?"":output.toString()};
jive.outcomes.action.pendingAlertPermissionWarning=function(opt_data,opt_sb){opt_data=opt_data||{};var output=opt_sb||new soy.StringBuilder;output.append('<div class="js-pending-permissionWarning j-pending-permissionWarning">',opt_data.privateContent?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.private.permissionWarning"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.permissionWarning"),[])),"</div>");return opt_sb?"":
output.toString()};
jive.outcomes.action.actionTooltip=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-outcome-tooltip-popup j-outcome-popup"><header><h5><strong>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingTooltip.title"),[])),'</strong></h5><header><div class="j-outcome-tooltip-details"><p>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingTooltip.body"),[])),'</p><a class="j-outcome-tooltip-link" href="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,
"/actions/marked"))),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingTooltip.link"),[])),'</a></div><footer class="j-outcome-modal-footer j-pop-row j-last"><a href="#" class="js-outcome-done-button">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.summary.done"),[])),"</a></footer></div>");return opt_sb?"":output.toString()};
jive.outcomes.action.markAlertModal=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-outcome-popup"><form name="pending-alert-form" action="#" class="j-form"><header class="j-outcome-modal-heading"><h3 class="font-color-meta">',opt_data.communityName?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.actionMenu.item."+opt_data.outcomeTypeName+".context.post")),[opt_data.communityName])):opt_data.notShareable?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.actionMenu.item."+
opt_data.outcomeTypeName+".post")),[])):opt_data.isUpdate?opt_data.isTakeOwnership?" "+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.update.title"),[]))+" ":" "+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.unresolve.title"),[]))+" ":soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.title"),[])),"</h3>",opt_data.communityName?'<span class="font-color-meta">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.actionMenu.item."+
opt_data.outcomeTypeName+".context.post.desc")),[]))+"</span>":"",'</header><div class="shareable" style="display:none"><div class="j-pending-alert-note-container js-pending-alert-note-container j-form-row"><textarea id="pending-alert-note" name="pending-alert-note" class="j-pending-alert-note" placeholder="',!opt_data.existingShare?soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.notePlaceholder.required"),[])):soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.notePlaceholder"),
[])),'"></textarea><label for="pending-alert-note"><span class="font-color-meta">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.noteDescription"),[])),"</span></label></div>",!opt_data.existingShare?'<div class="j-pending-share-target-container js-pending-share-target-container j-form-row j-rc4"><input type="checkbox" id="j-send-pending-share-checkbox" name="send-pending-share"/><label for="j-send-pending-share-checkbox" class="js-send-pending-share-label">'+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.checkboxDescription"),[]))+'</label><div class="j-pending-share j-pending-share-optional js-pending-share" style="display: none;"><div class="j-pending-share-people-picker-container js-pending-share-people-picker-container j-form-row"><input type="text" name="pending-share-users" class="j-autocomplete-input j-user-autocomplete j-ui-elem" role="combobox" placeHolder="'+soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.people.placeHolder"),
[]))+'" aria-label="'+soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.people.placeHolder"),[]))+'"/></div><label for="pending-share-message">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.shareText"),[opt_data.shareText]))+'</label><div class="j-pending-share-place-message-container js-pending-share-place-message-container"><textarea id="pending-share-message" name="pending-share-message" class="j-pending-share-message">'+
soy.$$escapeHtmlRcdata(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.shareText"),[opt_data.shareText]))+"</textarea></div></div></div>":"",'</div><div class="jive-form-element j-form-row urlAllowed" style="display:none"><label for="outdated-link">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.outdatedAlert.urlDescription"),[])),'</label><input type="hidden" id="outdated-url" name="outdated-url"/><input type="text" id="outdated-link" name="outdated-link" class="jive-form-textinput"/><p id="outdated-url-display" class="j-outdated-link-meta font-color-meta-light" name="outdated-url-display"></p></div><div class="j-form-row generalNote" style="display:none"><div class="j-note-container"><label for="outcome-note">',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.outcomeNote.noteLabel"),[])),'</label><textarea id="outcome-note" name="outcome-note" class="j-outcome-note"></textarea></div></div><footer class="j-pending-alert-footer j-pop-row j-last"><button type="submit" name="success" class="j-btn-callout">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.action.pendingAlert.sendButton"),[])),'</button><button type="button" name="cancel">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.cancel"),
[])),"</button></footer></form></div>");return opt_sb?"":output.toString()};
;
jive.model.ProjectCacheListener=function(){this.loadProject=function(a){};this.beginLoadingProjects=function(){};this.doneLoadingProjects=function(){};this.loadingProjectsFailed=function(){}};
;
goog.provide("jive.apps.alerts.renderDevError");
jive.apps.alerts.renderDevError=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<p><a href='javascript:;' onclick=\"$j('#j-dev-err-msg-",soy.$$escapeHtml(opt_data.appId),'\').show();">Click here for more info</a></p><div id="j-dev-err-msg-',soy.$$escapeHtml(opt_data.appId),'" class="j-app-error-message"  style="display:none"><p>',soy.$$escapeHtml(opt_data.errorMessage),"</p><a href='javascript:;' onclick=\"$j('#j-dev-err-msg-",soy.$$escapeHtml(opt_data.appId),"').hide();\">Hide this message</a></div>");
return opt_sb?"":output.toString()};
;
goog.provide("jive.apps.alerts.renderAppHalt");
jive.apps.alerts.renderAppHalt=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;switch(opt_data.code){case 401:output.append('<div class="j-app-alert"><span class="j-ui-elem j-alert-icon"></span><p>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.halt.needs.credentials"),[])),'</p><button class="j-error-msg-configure-credentials-app-btn">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.halt.needs.credentials.btn"),[])),"</button></div>");
break;case 10404:output.append('<div class="j-app-alert"><span class="j-ui-elem j-alert-icon"></span><p>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.halt.unavailable"),[])),"</p>");if(opt_data.errorMessage)jive.apps.alerts.renderDevError(opt_data,output);output.append("<p>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.halt.unavailable.detail"),[])),'</p><button class="j-error-msg-refresh-app-btn">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.halt.refresh.btn"),
[])),"</button></div>");break;case 10500:output.append('<div class="j-app-alert"><span class="j-ui-elem j-alert-icon"></span><p>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.halt.app.cannot.load"),[])),"</p>");if(!opt_data.fromExtension){output.append("<ul><li><strong>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.halt.app.cannot.load.delete"),[])),"</strong> ",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.halt.app.cannot.load.delete.detail"),
[])),"</li></ul>");if(opt_data.errorMessage)jive.apps.alerts.renderDevError(opt_data,output);output.append('<button class="j-error-msg-delete-app-btn">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.halt.delete.btn"),[])),'</button><button class="j-error-msg-refresh-app-btn">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.halt.refresh.btn"),[])),"</button>")}output.append("</div>");break;case 6E3:output.append('<div class="j-app-alert"><span class="j-ui-elem j-alert-icon"></span><p>',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.halt.app.malformed"),[])),"</p>");if(opt_data.message)jive.apps.alerts.renderDevError({appId:opt_data.appId,errorMessage:opt_data.message},output);output.append('<button class="j-error-msg-refresh-app-btn">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.halt.refresh.btn"),[])),"</button></div>");break;case 1E3:output.append('<div class="j-app-alert"><span class="j-ui-elem j-alert-icon"></span>',opt_data.modifier&&
opt_data.modifier=="configurationError"?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.configure.failure"),[])):"<p>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.halt.needs.configure"),[]))+'</p><button class="j-error-msg-configure-app-btn">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.halt.needs.configure.btn"),[]))+"</button>","</div>");break;case 1010:output.append('<div class="j-app-alert"><span class="j-ui-elem j-alert-icon"></span>',
opt_data.modifier&&opt_data.modifier=="configurationError"?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.configure.failure"),[])):"<p>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.halt.needs.configure.update"),[]))+'</p><button class="j-error-msg-configure-app-btn">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.halt.needs.configure.btn"),[]))+"</button>","</div>");break;case 2010:output.append('<div class="j-app-alert"><span class="j-ui-elem j-alert-icon"></span><p>',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.alert.banned"),[])),"</p><ul><li><strong>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.alert.banned.detail.delete"),[])),"</strong> ",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.alert.banned.detail.delete.detail"),[])),'</li></ul><p><a class="j-launch-market-faq" href="javascript:;">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.alert.banned.detail.more.info"),
[])),'</a>.</p><button class="j-error-msg-delete-app-btn">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.halt.delete.btn"),[])),"</button></div>");break;case 2020:output.append('<div class="j-app-alert"><span class="j-ui-elem j-alert-icon"></span><p>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.alert.blacklisted"),[opt_data.creator])),"</p><ul><li><strong>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.alert.blacklisted.detail.delete"),
[])),"</strong> ",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.alert.blacklisted.detail.delete.detail"),[])),'</li></ul><p><a class="j-launch-market-faq" href="javascript:;">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.alert.blacklisted.detail.more.info"),[])),'</a>.</p><button class="j-error-msg-delete-app-btn">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.halt.delete.btn"),[])),"</button></div>");break;case 2040:output.append('<div class="j-app-alert"><span class="j-ui-elem j-alert-icon"></span><p>',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.alert.subscription.expired"),[])),'</p><button class="j-error-msg-remove-subscription-expired-app-btn">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.renew.subscription"),[])),"</button></div>");break;case 2050:output.append('<div class="j-app-alert"><span class="j-ui-elem j-alert-icon"></span><p>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.alert.subscription.disabled"),[])),
"</p>",opt_data.message?"<p><b>"+soy.$$escapeHtml(opt_data.message)+"</b></p>":"",!opt_data.fromExtension?'<div><button class="j-error-msg-delete-app-btn">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.halt.delete.btn"),[]))+'</button><button class="j-error-msg-app-more-info-btn">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.halt.more.info.btn"),[]))+"</button></div>":"","</div>");break;case 2060:output.append('<div class="j-app-alert"><span class="j-ui-elem j-alert-icon"></span><h3>',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.halt.needs.oauth.credentials"),[])),'</h3><div class="j-oauth-grant"><p>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.halt.needs.oauth.credentials.need.grant"),[])),'</p><button class="j-error-msg-grant-oauth-access-btn">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.halt.needs.oauth.credentials.grant.btn"),[])),'</button></div><div class="j-oauth-authorize"><p>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.halt.needs.oauth.credentials.authorization"),
[])),'</p><button class="j-error-msg-granted-oauth-access-btn">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.halt.needs.oauth.credentials.granted.btn"),[])),'</button><button class="j-error-msg-oauth-approved-btn" style="display:none"></button></div></div>');break;case 5010:output.append('<div class="j-app-alert"><span class="j-ui-elem j-alert-icon"></span><p>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.alert.throttle.violation"),[])),'</p><button class="j-error-msg-remove-throttle-violation-btn">',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.alert.dismiss"),[])),"</button></div>");break;case 5020:output.append('<div class="j-app-alert"><span class="j-ui-elem j-alert-icon"></span><p>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.alert.bulkcancel.warning"),[])),'</p><button class="j-error-msg-delete-app-btn">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.alert.bulkcancel.deleteButton"),[])),'</button><button class="j-error-msg-purchase-app-btn">',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.alert.bulkcancel.purchaseButton"),[])),"</button></div>");break;default:output.append('<div class="j-app-alert"><span class="j-ui-elem j-alert-icon"></span><p>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.alert.unexpected"),[])),"(",soy.$$escapeHtml(opt_data.code),")</p>",opt_data.message?"<p>"+soy.$$escapeHtml(opt_data.message)+"</p>":"");if(opt_data.errorMessage)jive.apps.alerts.renderDevError(opt_data,
output);output.append("</div>")}return opt_sb?"":output.toString()};
;
define("jive/app/configure/views/validate",["jquery"],function(a){return jive.AbstractView.extend(function(b){this.init=function(d,c,e){this.serviceBlock=d;this.errorOptions=c;this.invalidFields=e};this.work=function(){var c=this;this.serviceBlock.find(".j-service-error").removeClass("j-service-error");var d=this.serviceBlock.find("INPUT.j-service-radio:visible");if(d.filter(":checked").length==0){this.errorOptions.missing_endpoint=true;d.each(function(){c.invalidFields.push(this)})}this.serviceBlock.find("INPUT.j-service-credential:visible").each(function(){var e=a.trim(a(this).val());a(this).val(e);if(!e){c.errorOptions.missing_credential=true;c.invalidFields.push(this)}});this.serviceBlock.find("textarea.j-service-credential:visible").each(function(){var e=a.trim(a(this).val());a(this).val(e);if(!e){c.errorOptions.missing_credential=true;c.invalidFields.push(this)}})}})});
;
goog.provide("jive.apps.configure.renderAppDataErrorMessage");
jive.apps.configure.renderAppDataErrorMessage=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;var messageKeyList3=opt_data.messageKeys;var messageKeyListLen3=messageKeyList3.length;for(var messageKeyIndex3=0;messageKeyIndex3<messageKeyListLen3;messageKeyIndex3++){var messageKeyData3=messageKeyList3[messageKeyIndex3];output.append('<span class="error-message">');switch(messageKeyData3){case "configure.success":output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.configure.success"),[])));
break;case "configure.cancel":output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.configure.cancel"),[])));break;case "configure.cancel.not.changed":output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.configure.cancel.not.changed"),[])));break;case "configure.noneed":output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.configure.no.need"),[])));break;case "credentials.cancel":output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.configure.credentials.cancel"),
[])));break;case "credentials.success":output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.configure.credentials.success"),[])));break;case "credentials.fail":output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.configure.credentials.fail"),[])));break;case "missing.endpoint":output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.configure.error.missing.endpoint"),[])));break;case "missing.credential":output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.configure.error.missing.credential"),
[])));break;case "permissions.acceptance":output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.install.permissions.acceptance"),[])));break;case "install.error":output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.install.error"),[])));break;default:output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("error.general"),[])))}output.append("</span>")}return opt_sb?"":output.toString()};
;
define("jive/app/configure/views/error",["jquery"],function(a){return jive.oo.Class.extend(function(b){b.init=function(){};this.clear=function(){a("#jive-modal-app-configure-feedback").hide()};this.render=function(d){if(d==null){return}var c=[];if(d.missing_endpoint){c.push("missing.endpoint")}if(d.missing_credential){c.push("missing.credential")}if(c.length==0){c.push("error.general")}if(c.length<1){this.clear();return}try{a("#jive-modal-app-configure-feedback").show().html(jive.apps.configure.renderAppDataErrorMessage(c))}catch(f){}};this.fieldsToVisualMarkers=function(c){return(a(c).map(function(){var d=a(this);return d.hasClass("j-service-radio")?d.parent()[0]:this})).addClass("j-service-error")}})});
;
goog.provide("jive.apps.container.renderMessage");jive.apps.container.renderMessage=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<span>",soy.$$escapeHtml(opt_data.message),"</span>");return opt_sb?"":output.toString()};
;
goog.provide("jive.i18n.keys.appframeworkAppConfigureSuccess");jive.i18n.keys.appframeworkAppConfigureSuccess=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.configure.success"),[])));return opt_sb?"":output.toString()};
;
goog.provide("jive.i18n.keys.appframeworkAppConfigureFailure");jive.i18n.keys.appframeworkAppConfigureFailure=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.configure.failure"),[])));return opt_sb?"":output.toString()};
;
goog.provide("jive.apps.container.blockingAlertView");
jive.apps.container.blockingAlertView=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div id="app-blocking-alert-container" class="j-app-modal-content j-pop-main j-app-alert"><div id="app-blocking-alert-detail"></div><div class="j-modal-footer"><button id="j-app-blocking-alert-submit" type="submit" class="j-btn-callout">Submit</button><button id="j-app-blocking-alert-cancel" type="submit" class="j-btn-global">Cancel</button></div></div>');return opt_sb?"":output.toString()};
;
goog.provide("jive.i18n.keys.appframeworkAppDevelopmentRefresh");jive.i18n.keys.appframeworkAppDevelopmentRefresh=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.development.refresh"),[])));return opt_sb?"":output.toString()};
;
goog.provide("jive.i18n.keys.appframeworkAppConfigureCancel");jive.i18n.keys.appframeworkAppConfigureCancel=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.configure.cancel"),[])));return opt_sb?"":output.toString()};
;
goog.provide("jive.i18n.keys.errorGeneral");jive.i18n.keys.errorGeneral=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("error.general"),[])));return opt_sb?"":output.toString()};
;
goog.provide("jive.apps.configure.renderConfigureAppNotNeeded");jive.apps.configure.renderConfigureAppNotNeeded=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<section class="clearfix"><p>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.configure.service.no.need"),[])),"</p></section>");return opt_sb?"":output.toString()};
;
goog.provide("jive.apps.configure.renderServicesSection");
jive.apps.configure.renderServicesSection=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<section class="app-services-section"><h3 class="j-app-config-header font-color-normal">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.configure.services.header"),[])),'</h3><ul class="ul-sections">');var serviceList6=opt_data.configureAppView.serviceView;var serviceListLen6=serviceList6.length;for(var serviceIndex6=0;serviceIndex6<serviceListLen6;serviceIndex6++){var serviceData6=
serviceList6[serviceIndex6];if(opt_data.configureAppView.configured&&serviceData6.serviceOptionView.length<2||!opt_data.configureAppView.configured&&serviceData6.selected)output.append('<li class="j-service-block-alert" data-serviceid="',soy.$$escapeHtml(serviceData6.selectedService.serviceID),'" data-alias="',soy.$$escapeHtml(serviceData6.selectedService.alias),'"><p><img alt="" src="',soy.$$filterNoAutoescape(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/images/jaf/j-icon-service-generic.png")),
'" class="jaf-icon-svc" > ',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.configuration.service"),[])),"&nbsp;<b>",soy.$$escapeHtml(serviceData6.name),"</b>&nbsp;",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.configuration.ready"),[])),"</p></li>");else{output.append('<li class="j-service-block-alert"><p>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.configuration.found"),[])),"&nbsp;",soy.$$escapeHtml(serviceData6.serviceOptionView.length),
"&nbsp;",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.configuration.instances"),[])),"&nbsp; <b>",soy.$$escapeHtml(serviceData6.name),"</b>.&nbsp;",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.configuration.select"),[])),"</p><div>");var serviceOptionViewList35=serviceData6.serviceOptionView;var serviceOptionViewListLen35=serviceOptionViewList35.length;for(var serviceOptionViewIndex35=0;serviceOptionViewIndex35<serviceOptionViewListLen35;serviceOptionViewIndex35++){var serviceOptionViewData35=
serviceOptionViewList35[serviceOptionViewIndex35];output.append('<p class="j-form-row"><input type="radio" name="service-',soy.$$escapeHtml(serviceOptionViewData35.optionGroupID),'" value="',soy.$$escapeHtml(serviceOptionViewData35.serviceID),'" class="j-service-radio" data-serviceid="',soy.$$escapeHtml(serviceOptionViewData35.serviceID),'" data-alias="',soy.$$escapeHtml(serviceOptionViewData35.alias),'" data-optionid="',soy.$$escapeHtml(serviceOptionViewData35.optionID),'" data-optiongroupid="',
soy.$$escapeHtml(serviceOptionViewData35.optionGroupID),'" id="j-service-',soy.$$escapeHtml(serviceOptionViewData35.optionID),'"',serviceData6.selectedService&&serviceData6.selectedService.serviceID==serviceOptionViewData35.serviceID?" checked":"",'><label for="j-service-',soy.$$escapeHtml(serviceOptionViewData35.optionID),'"><img alt="" src="',soy.$$filterNoAutoescape(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/images/jaf/j-icon-service-generic.png")),'" class="jaf-icon-svc" > ',soy.$$escapeHtml(serviceOptionViewData35.name),
"</label></p>")}output.append("</div></li>")}}output.append("</ul></section>");return opt_sb?"":output.toString()};
;
goog.provide("jive.apps.configure.renderConfigureApp");
jive.apps.configure.renderConfigureApp=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<section class="clearfix">');if(opt_data.configureAppView.cannotConfigure)output.append('<div class="jaf-cannot-configure j-rc4"><p>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.configure.failure"),[])),"</p></div>");else{output.append('<div id="jive-modal-app-configure-feedback" style="display:none; color:red;"></div>');if(opt_data.configureAppView.requiresServices)jive.apps.configure.renderServicesSection(opt_data,
output)}output.append("</section>");return opt_sb?"":output.toString()};
;
define("jive/app/configure/views/serviceblocks",["jquery"],function(a){return jive.AbstractView.extend(function(b){this.init=function(){this.blocks=a(".app-services-section .j-service-block-alert")};this.validate=function(c){return c(this.blocks)};this.get_services=function(){var c=[];this.blocks.each(function(){var e=a(this).attr("data-serviceid");if(e){c.push({serviceID:e,alias:a(this).attr("data-alias")})}else{var d=a(this).find("input.j-service-radio:checked");if(d){c.push({serviceID:d.attr("data-serviceid"),alias:d.attr("data-alias")})}}});return c}})});
;
define("jive/app/configure/views/configure_view",["jquery","jive/app/configure/views/serviceblocks","jive/app/configure/views/validate","jive/app/configure/views/error"],function(c,a,d,b){return jive.AbstractView.extend(function(e){this.init=function(g,h,f){this.instanceAppID=g.instanceAppID;this.configSetupData=h;this.configSetupData.app=g;if(h.requiresServices){this.content=c(jive.apps.configure.renderConfigureApp({configureAppView:h}));f.html("");f.append(this.content);c("#app-config-save").focus();this.bindClickEvents()}else{this.content=c(jive.apps.configure.renderConfigureAppNotNeeded());f.html("");f.append(this.content)}};e.bindClickEvents=function(){var f=this;var g=this.content;f.emit("app.service.wire.cancel",{callback:function(){f.emit("app.cancel_configuration")}});f.emit("app.service.wire.submit",{callback:function(){var h=new a();var j=h.validate(f.validate);if(j){var i=h.get_services();f.emit("app.save_configuration",i)}}});g.find(".j-service-radio").each(function(){var h=c(this).attr("data-optiongroupid");var i=c(this).attr("data-optionid");c(this).click(function(){c(".j-service-credentials[data-optiongroupid="+h+"]").hide();c(".j-service-credentials[data-optionid="+i+"]").show()})})};e.validate=function(g){var i=new b();i.clear();var f={};var h=[];g.find(".j-service-error").removeClass("j-service-error");g.each(function(){var j=new d(c(this),f,h);j.work()});if(h.length){i.render(f);i.fieldsToVisualMarkers(h)}return h.length==0}})});
;
define("jive/app/configure/models/configure_model",["jquery"],function(a){return jive.oo.Class.extend(function(b){jive.conc.observable(this);b.init=function(){};this.persist_configuration=function(c){var d=this;a.ajax({type:"PUT",url:jive.api.apps("instances/"),data:JSON.stringify(c),contentType:"application/json",dataType:"json",success:function(e){d.emit("app.configure.success")},error:function(e){d.emit("app.configure.failed")}})};this.get_configuration_data=function(e){var c=this;var d=jive.api.apps("instances/"+e+"/config_setup");a.getJSON(d,function(f){c.emit("app.got.configure.data",f)})}})});
;
define("jive/app/configure/main",["jive/app/configure/views/configure_view","jive/app/configure/models/configure_model"],function(a,b){return jive.oo.Class.extend(function(c){jive.conc.observable(this);c.init=function(e){var d=this;var f=e.app;this.domTarget=e.domTarget;this.instanceAppID=f.instanceAppID;this.model=new b();this.model.addListener("app.got.configure.data",function(g){d.configureView=new a(f,g,d.domTarget);d.configureView.addListener("app.save_configuration",function(i){var h={instanceAppID:d.instanceAppID,services:i};d.model.persist_configuration(h)});d.configureView.addListener("app.cancel_configuration",function(){d.emit("app.configure.cancel",d.instanceAppID)});d.configureView.addListener("app.service.wire.submit",function(h){d.emit("app.service.wire.submit",h)});d.configureView.addListener("app.service.wire.cancel",function(h){d.emit("app.service.wire.cancel",h)})});this.model.get_configuration_data(this.instanceAppID);this.model.addListener("app.configure.success",function(){d.emit("app.configure.success",d.instanceAppID)});this.model.addListener("app.configure.failed",function(){d.emit("app.configure.failed",d.instanceAppID)})}})});
;
define("jive/app/placepicker/main",function(){return jive.oo.Class.extend(function(a){a.init=function(c){var b=this;this.personalContainerTitleKey=c.personalContainerTitleKey;this.personalContainerCaptionKey=c.personalContainerCaptionKey;this.searchPlaceholderKey=c.searchPlaceholderKey;this.closeOnSelect=true;var d={closeOnSelect:this.closeOnSelect,filterGroup:"appPlacePicker",personalContainerTitleKey:b.personalContainerTitleKey,personalContainerCaptionKey:b.personalContainerCaptionKey,searchPlaceholderKey:b.searchPlaceholderKey,containerType:c.containerType,pickerContext:"app",filterByContainer:(c.containerType)?true:false,objectType:c.contentType};if(c.contentType!=38){d.allowedContainerIds=c.containerType}this.placePicker=new jive.Placepicker.Main(d)};this.showPicker=function(c){var b=this;b.placePicker.showPicker();b.placePicker.addListener("container",function(d){c(d);b.placePicker.removeListener("container")})}})});
;
define("jive/app/alert/views/blocking_alert_view",["jquery"],function(a){return jive.oo.Class.extend(function(b){jive.conc.observable(this);b.init=function(c){this.app=c};this.applyBlockingAlert=function(c,e){var d=this.prepareBlockingAlertHtml(this.app,e);a(c).append(d);return d};b.prepareBlockingAlertHtml=function(e,i){var d;var g=this;var k=e.id;var f="";var j=null;if(i){switch(i.code){case 1000:case 1010:if(e.configurationError){f="configurationError"}d=function(l,m){m.find(".j-error-msg-configure-app-btn").click(function(){g.emit("app.block",{type:"app.launch.config",app:e})})};break;case 2010:d=function(l,m){m.find(".j-error-msg-remove-banned-app-btn").click(function(){g.emit("app.block",{type:"app.remove.banned",app:e})});m.find(".j-error-msg-delete-app-btn").click(function(){g.emit("app.block",{type:"app.delete",app:e})});m.find(".j-launch-market-faq").click(function(){j=window.open(window._jive_base_url+"/apps/market/marketfaq/"+e.appUUID,"marketfaq","resizable=yes,scrollbars=yes");if(j){j.focus()}})};break;case 2020:d=function(l,m){m.find(".j-error-msg-remove-blacklisted-app-btn").click(function(){g.emit("app.block",{type:"app.remove.blacklisted",app:e})});m.find(".j-error-msg-delete-app-btn").click(function(){g.emit("app.block",{type:"app.delete",app:e})});m.find(".j-launch-market-faq").click(function(){j=window.open(window._jive_base_url+"/apps/market/marketfaq/"+e.appUUID,"marketfaq","resizable=yes,scrollbars=yes");if(j){j.focus()}})};break;case 2040:d=function(l,m){m.find(".j-error-msg-remove-subscription-expired-app-btn").click(function(){g.emit("app.block",{type:"app.launch.account",app:e})});m.find(".j-visit-app-market-link").click(function(){j=window.open(window._jive_base_url+"/apps/market/marketfaq/"+e.appUUID,"marketfaq","resizable=yes,scrollbars=yes");if(j){j.focus()}})};break;case 2050:d=function(l,m){m.find(".j-error-msg-app-more-info-btn").click(function(){j=window.open(window._jive_base_url+"/apps/market/marketfaq/"+e.appUUID,"marketfaq","resizable=yes,scrollbars=yes");if(j){j.focus()}});m.find(".j-error-msg-delete-app-btn").click(function(){g.emit("app.block",{type:"app.delete",app:e})})};break;case 5010:d=function(l,m){m.find(".j-error-msg-remove-throttle-violation-btn").click(function(){g.emit("app.block",{type:"app.remove.throttle.violation",app:e})});m.find(".j-why-apps-may-be-suspended").click(function(){j=window.open(window._jive_base_url+"/apps/market/marketfaq/"+e.appUUID,"marketfaq","resizable=yes,scrollbars=yes");if(j){j.focus()}})};break;case 5020:d=function(l,m){m.find(".j-error-msg-delete-app-btn").click(function(){g.emit("app.block",{type:"app.delete",app:e})});m.find(".j-error-msg-purchase-app-btn").click(function(){g.emit("app.block",{type:"app.launch.market",app:e})})};break;case 10404:d=function(l,m){m.find(".j-error-msg-refresh-app-btn").click(function(){g.emit("app.block",{type:"app.refresh",app:e})})};break;case 10500:d=function(l,m){m.find(".j-error-msg-delete-app-btn").click(function(){g.emit("app.block",{type:"app.delete",app:e})});m.find(".j-error-msg-refresh-app-btn").click(function(){g.emit("app.block",{type:"app.refresh",app:e})})};break;case 6000:break}}if(!d){d=function(l,m){m.find(".j-error-msg-refresh-app-btn").click(function(){g.emit("app.block",{type:"app.refresh",app:e})})}}var h={code:i.code,modifier:f,message:i.message,creator:i.creator,errorMessage:i.errorMessage,fromExtension:i.fromExtension,iconSrc:e.iconSrc,appTitle:e.title};var c=a(jive.apps.alerts.renderAppHalt(h));d(this,c);return c}})});
;
define("jive/app/alert/main",["jive/app/alert/views/blocking_alert_view"],function(a){return jive.oo.Class.extend(function(b){jive.conc.observable(this);b.init=function(d,c){this.app=d;this.targetDomElement=c;this.blockingAlerts=this.app.blockingAlerts};this.hasBlockingAlerts=function(){return this.blockingAlerts.length>0};this.getApp=function(){return this.app};this.getActiveAlert=function(){return this.hasBlockingAlerts?this.blockingAlerts[0]:false};this.applyBlock=function(e,h,g){h=h||this.app;e=e?e:this.targetDomElement;if(!e){return}g=g||this.getActiveAlert();if(!g){return}var d=this;var c=new a(h);var f=c.applyBlockingAlert(e,g);c.addListener("app.block",function(i){d.emit("app.block",i)});return f};this.routeActionClicks=function(h,i,d,g,f){if(h.type=="app.launch.config"){i(this)}else{if(h.type=="app.launch.market"||h.type=="launch.market.app.profile"){window.location=window._jive_base_url+"/apps/market/marketapp/"+h.app.appUUID}else{if(h.type=="launch.market.faq"){var e=window.open(window._jive_base_url+"/apps/market/marketfaq/"+h.app.appUUID,"marketfaq","resizable=yes,scrollbars=yes");if(e){e.focus()}}else{if(h.type=="app.launch.account"){window.location=window._jive_base_url+"/apps/market/marketuser/"+h.app.appUUID}else{var c=function(){};var j=function(){};if(h.type=="app.remove.banned"||h.type=="app.remove.blacklisted"||h.type=="app.delete"||h.type=="app.hide"){c=d;j=g}f.emit(h.type,h.app,c,j)}}}}}})});
;
goog.provide("jive.autosearch.contentItemDetail");
jive.autosearch.contentItemDetail=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.shared.displayutil.icon(soy.$$augmentMap(opt_data.item,{size:"med"}),output);output.append(opt_data.item.subject?'<span class="result-title lnk">'+soy.$$escapeHtml(opt_data.item.subject).replace(/&amp;#160;/g,"&#160;").replace(/&amp;#nbsp;/g,"&#160;").replace(/&amp;/g,"&")+'</span><span class="j-508-label">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("jive.field.parens"),[jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("global.access.content.type."+
opt_data.item.type)),[])]))+"</span>":opt_data.item.parentContent&&opt_data.item.parentContent.name?'<span class="result-title lnk">'+soy.$$escapeHtml(opt_data.item.parentContent.name)+'</span><span class="j-508-label">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("jive.field.parens"),[jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("global.access.content.type."+opt_data.item.parentContent.type)),[])]))+"</span>":"",opt_data.item.author?' <em class="font-color-normal">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.spotlight.by_author_posted_date"),
[opt_data.item.author.displayName,opt_data.item.updatedDate?_jive_moment(parseFloat(opt_data.item.updatedDate)?parseFloat(opt_data.item.updatedDate):opt_data.item.updatedDate).add(_jive_timezoneoffset*60*60*1E3).lang(_jive_locale.toLowerCase().replace("_","-")).format("ll"):""]))+"</em>":"",opt_data.item.displayExternalAccess?'<span class="j-browse-external-access"><em>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("partner.browse.ext_access"),[]))+"</em></span>":"");return opt_sb?"":output.toString()};
;
goog.provide("jive.autosearch.contentItem");
jive.autosearch.contentItem=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<a class="j-result-bookmark ',opt_data.item.promotedResult?"j-search-promoted-result-container":"",'"');if(opt_data.item.resources&&opt_data.item.resources.html)if(opt_data.item.uuid&&opt_data.item.index)if((opt_data.item.resources.html.ref.match(new RegExp("#",""))||[]).length>0){var parts__soy14=opt_data.item.resources.html.ref.split(new RegExp("#",""));output.append('href="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(parts__soy14[0])),
"?sr=search&searchId=",soy.$$escapeUri(opt_data.item.uuid),"&searchIndex=",soy.$$escapeUri(opt_data.item.index),parts__soy14.length>1?"#"+soy.$$escapeHtmlAttribute(parts__soy14[1]):"",'">')}else output.append('href="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.item.resources.html.ref)),"?sr=search&searchId=",soy.$$escapeUri(opt_data.item.uuid),"&searchIndex=",soy.$$escapeUri(opt_data.item.index),'">');else output.append('href="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.item.resources.html.ref)),
'">');else output.append(">");output.append(opt_data.item.promotedResult?'<span class="j-search-promoted-result-label">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.promoted_result"),[]))+"</span>":"");if(opt_data.item.type=="favorite"){output.append('<span data-id="',soy.$$escapeHtmlAttribute(opt_data.item.id),'" class="j-remove-mark jive-icon-glyph icon-bookmark" data-component="button" data-command="remove"></span>');if(opt_data.item.favoriteObject.type=="url")jive.autosearch.contentItemDetail(opt_data,
output);else jive.autosearch.contentItemDetail({item:opt_data.item.favoriteObject},output)}else jive.autosearch.contentItemDetail(opt_data,output);output.append("</a>");return opt_sb?"":output.toString()};
;
goog.provide("jive.autosearch.peopleItem");
jive.autosearch.peopleItem=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<a href="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.item.resources.html.ref)),'">');jive.shared.displayutil.avatar({enabled:true,username:opt_data.item.jive.username,id:null,displayName:opt_data.item.displayName,visible:true,prop:null,avatarID:opt_data.item.thumbnailId,size:24,hideTooltip:true,hideLink:true},output);output.append(opt_data.item.mentionName?'<span class="result-title lnk">'+
soy.$$escapeHtml(opt_data.item.mentionName)+"</span>":'<span class="result-title lnk">'+soy.$$escapeHtml(opt_data.item.displayName)+"</span>",'<span class="j-508-label">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.user.parens"),[])),"</span>",opt_data.item.title||opt_data.item.department?' <em class="font-color-normal">'+(opt_data.item.title&&opt_data.item.department?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.result.people.in"),[opt_data.item.title,opt_data.item.department])):
opt_data.item.title?soy.$$escapeHtml(opt_data.item.title):opt_data.item.department?soy.$$escapeHtml(opt_data.item.department):"")+"</em>":"",opt_data.item.displayExternalContributor?'<span class="font-color-meta-light j-browse-external-access"><em>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("partner.browse.external.contributor"),[]))+"</em></span>":"","</a>");return opt_sb?"":output.toString()};
;
goog.provide("jive.autosearch.placeItem");
jive.autosearch.placeItem=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.item.resources&&opt_data.item.resources.html){if(opt_data.item.uuid&&opt_data.item.index)if((opt_data.item.resources.html.ref.match(new RegExp("#",""))||[]).length>0){var parts__soy9=opt_data.item.resources.html.ref.split(new RegExp("#",""));output.append('<a href="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(parts__soy9[0])),"?sr=search&searchId=",soy.$$escapeUri(opt_data.item.uuid),"&searchIndex=",
soy.$$escapeUri(opt_data.item.index),parts__soy9.length>1?"#"+soy.$$escapeHtmlAttribute(parts__soy9[1]):"",'">')}else output.append('<a href="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.item.resources.html.ref)),"?sr=search&searchId=",soy.$$escapeUri(opt_data.item.uuid),"&searchIndex=",soy.$$escapeUri(opt_data.item.index),'">');else output.append('<a href="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.item.resources.html.ref)),'">');output.append(opt_data.item.type==
"page"&&opt_data.item.parentPlace?'<span class="jive-icon-med jive-icon-'+soy.$$escapeHtmlAttribute(opt_data.item.parentPlace.type)+'"></span><span class="result-title lnk">'+soy.$$escapeHtml(opt_data.item.parentPlace.name)+"&nbsp;-&nbsp;"+soy.$$escapeHtml(opt_data.item.name)+"</span>":'<span class="jive-icon-med jive-icon-'+soy.$$escapeHtmlAttribute(opt_data.item.type)+'"></span><span class="result-title lnk">'+soy.$$escapeHtml(opt_data.item.name)+"</span>",'<span class="j-508-label">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("jive.field.parens"),
[jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("global."+opt_data.item.type)),[])])),"</span>",opt_data.item.displayExternalAccess?'<span class="font-color-meta-light j-browse-external-access"><em>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("partner.browse.ext_access"),[]))+"</em></span>":"","</a>")}return opt_sb?"":output.toString()};
;
goog.provide("jive.autosearch.resultList");
jive.autosearch.resultList=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;var itemList3=opt_data.list;var itemListLen3=itemList3.length;for(var itemIndex3=0;itemIndex3<itemListLen3;itemIndex3++){var itemData3=itemList3[itemIndex3];output.append('<li data-component="listitem" class="j-listitem ',opt_data.max&&itemIndex3>=opt_data.max?"j-inactive":""," ",opt_data.type=="people"?"j-listitem-people":"",'" role="option" data-type="',soy.$$escapeHtmlAttribute(itemData3.type),'" data-id="',
soy.$$escapeHtmlAttribute(itemData3.id),'">');switch(opt_data.type){case "content":jive.autosearch.contentItem({item:itemData3},output);break;case "people":jive.autosearch.peopleItem({item:itemData3},output);break;case "places":jive.autosearch.placeItem({item:itemData3},output);break}output.append("</li>")}return opt_sb?"":output.toString()};
;
goog.provide("jive.autosearch.showMoreAccessibleLabel");
jive.autosearch.showMoreAccessibleLabel=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<span class="j-508-label lnk" id="',soy.$$escapeHtmlAttribute(opt_data.type),'-show-more-label">',opt_data.type=="places"?opt_data.numMoreResults==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.show.more.places.singular"),[opt_data.numMoreResults])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.show.more.places.plural"),[opt_data.numMoreResults])):
opt_data.type=="people"?opt_data.numMoreResults==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.show.more.people.singular"),[opt_data.numMoreResults])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.show.more.people.plural"),[opt_data.numMoreResults])):opt_data.numMoreResults==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.show.more.content.singular"),[opt_data.numMoreResults])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.show.more.content.plural"),
[opt_data.numMoreResults])),"</span>");return opt_sb?"":output.toString()};
;
goog.provide("jive.autosearch.resultSection");
jive.autosearch.resultSection=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<ul aria-labelledby="header_',soy.$$escapeHtmlAttribute(opt_data.type),'" aria-live="polite" role="listbox" class="',opt_data.type=="people"?"j-avatar-list ":"",'j-icon-list">');jive.autosearch.resultList(opt_data,output);output.append(opt_data.view=="bookmarks"?'<li class="j-listitem moreResults font-color-meta" data-component="listitem" role="option"><a class="more all noIcon" href="'+soy.$$filterNoAutoescape(jive.soy.func.buildUrl(window._jive_base_absolute_url,
"/bookmarks"))+'"><span class="lnk">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.history.bookmarks.link"),[]))+'</span><span class="jive-icon-glyph icon-arrow-right2 inlineIcon"></span></a></li>':opt_data.view=="all"||opt_data.view=="filtered"?'<li class="j-listitem moreResults'+(opt_data.max&&opt_data.list.length>opt_data.max?" j-inactive":"")+' font-color-meta" data-component="listitem" role="option"><a class="more all noIcon" href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,
"/search.jspa")))+"?q="+soy.$$escapeUri(opt_data.searchTerm)+"&facet="+soy.$$escapeUri(opt_data.type)+(opt_data.view=="filtered"?"&"+soy.$$escapeUri(opt_data.filterType)+"="+soy.$$escapeUri(opt_data.filter):"")+'" ><span class="lnk">'+(opt_data.type=="places"?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.results.all.place.link"),[]))+(opt_data.filterDisplayName?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.results.all.content.in"),[opt_data.filterDisplayName])):""):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("search.results.all."+
opt_data.type+".link")),[]))+(opt_data.filterDisplayName?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.results.all.content.in"),[opt_data.filterDisplayName])):""))+'</span><span class="jive-icon-glyph icon-arrow-right2 inlineIcon"></span></a></li>':opt_data.view=="recent"?'<li class="j-listitem moreResults'+(opt_data.max&&opt_data.list.length>opt_data.max?" j-inactive":"")+' font-color-meta" data-component="listitem" role="option"><a class="more all noIcon" href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,
"/"+opt_data.type)))+"?filterID=historyarchetype%5B"+(opt_data.type=="places"?"containers":soy.$$escapeUri(opt_data.type))+'%5D" ><span class="lnk">'+(opt_data.type=="places"?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.history.recent.containers.link"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("search.history.recent."+opt_data.type+".link")),[])))+'</span><span class="jive-icon-glyph icon-arrow-right2 inlineIcon"></span></a></li>':"");if(opt_data.view!=
"bookmarks"&&opt_data.max&&opt_data.list.length>opt_data.max){output.append('<li class="j-listitem moreResults font-color-meta" data-component="listitem" role="option"><a href="#" class="more noIcon" data-component="button" data-command="more"><span role="presentation" aria-hidden="true" class="lnk">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.show.more"),[opt_data.list.length-opt_data.max])),'</span><span role="img" class="jive-icon-glyph icon-arrow-down2 inlineIcon" aria-hidden="true"></span>');
jive.autosearch.showMoreAccessibleLabel({type:opt_data.type,numMoreResults:opt_data.list.length-opt_data.max},output);output.append("</a></li>")}output.append("</ul>");return opt_sb?"":output.toString()};
;
define("jive/app/core_container/views/appscontainer_view",["jive/app/configure/main","jive/app/placepicker/main","jive/app/alert/main","osapi"],function(a,d,c,b){return jive.AbstractView.extend(function(e){jive.conc.observable(this);var f={};this.getEmbeddedContext=function(g){return f[g]};this.setEmbeddedContext=function(g,h){f[g]=h};this.deleteEmbeddedContext=function(g){delete f[g]};this.prepareMarketContext=function(g){f["market-app"]={target:{type:"embed"},jive:g};return{embeddedID:"market-app"}};this.init=function(g,h){this.commonContainer=g;this.options=h;this.bounds={maxWidth:1200,maxHeight:1200,minWidth:350,minHeight:150};this.addListener("app.apply.alert",this.handleAppAlert)};this.render=function(){};this.handleAppsMarketInstall=function(){};this.renderApp_=function(g,i,m,k){var p=this;if(!g){return}var j=new c(i,$j(g.el_));if(j.hasBlockingAlerts()){p.emit("app.apply.alert",j)}else{var h=this.createRenderParams_(i);var l=i.appURL;var n=m||function(){};var o=k||{};this.commonContainer.navigateGadget(g,l,o,h,n)}};this.renderAppEE_=function(j,m,k,i,g){var h=new c(m,j);if(h.hasBlockingAlerts()){this.emit("app.apply.alert",h);return false}else{var l=m.appURL||"";this.getAppFeatures(l,function(o){if(o.error){var n={};i(n,{error:o.error});return}this.renderAppEE_impl(j,m,k,o,i,g)});return true}};this.renderAppEE_impl=function(n,j,l,g,o,m){l=l||{};var i=this.isOpenSocialFeatureRequired("2.5",(g||{}),"embedded-experiences");var p=e.constructEEDataModel(j,l);if(i){l=e.constructOpenSocialEEContext(l);if(!!l.appContext){p.context=l.appContext}}var h=this.createRenderParams_(j);var q=o||function(){};var r=m||{};var k={};k[b.container.ee.RenderParam.GADGET_RENDER_PARAMS]=h;k[b.container.ee.RenderParam.GADGET_VIEW_PARAMS]=r;this.commonContainer.ee.navigate(n,p,k,q,l.containerContext)};e.constructOpenSocialEEContext=function(h){var g={};if(h.jive&&h.jive.content){g.containerContext={};g.containerContext[b.container.ee.Context.ASSOCIATED_CONTEXT]={};g.containerContext[b.container.ee.Context.ASSOCIATED_CONTEXT]=h.jive.content}if(h&&h.target&&h.target.context){g.appContext=h.target.context}return g};e.constructEEDataModel=function(m,k){var l=m.appURL;var h=m.view;var j={};j.gadget=l;j.context=k;if(k&&(k.target||k.display)){var i=k.display||{};var g=k.target||{};if(g.type&&g.type==="embed"){g.type=b.container.ee.TargetType.GADGET}j[b.container.ee.DataModel.PREFERRED_EXPERIENCE]={display:i,target:g};if(k.target&&!k.target.hasOwnProperty("view")){k.target.view=m.view}}return j};this.computeAppDimensions=function(l,h){var k;if(h){k=h.replace(".","_")}var g=(k&&l.heightByView&&l.heightByView[k])||l.height||l.actionHeight;var j=(k&&l.widthByView&&l.widthByView[k])||l.width||l.actionWidth;var i=false;if(g===9999&&j===9999){i=true}return{height:g,width:j,isMaximum:i}};e.createRenderParams_=function(k){var h=b.container.RenderParam;var j={};var g=k.view;j[h.VIEW]=g;var i=this.computeAppDimensions(k,g);j[h.HEIGHT]=i.height;j[h.WIDTH]=i.width;j[h.USER_PREFS]=k.userPrefs;if(!window.__JAF_DEBUG){j[h.NO_CACHE]=k.hasOwnProperty(h.NO_CACHE)?k.nocache:false}return j};this.getRealTitle=function(i,h){var g="";if((i.title||h)&&i.actionLabel){g=(h?h:i.title)+" : "+i.actionLabel}else{if(i.title||h){g=h?h:i.title}else{if(i.actionLabel){g=i.actionLabel}}}return g};this.getAppFeatures=function(h,i){var g=this;this.commonContainer.preloadGadget(h,function(j){if(!j[h]||j[h].error){i.call(g,{error:j[h].error})}else{var k={};var l=j[h].modulePrefs;if(l&&l.features){k=l.features}i.call(g,k)}})};this.isOpenSocialFeatureRequired=function(h,l,m){var j="opensocial-"+h;var k=l[j]||null;if(k&&k.required){return true}if(m){var g=l[m]||null;if(g&&g.params.specificationVersion){var i=g.params.specificationVersion;i=$j.trim(i.toString());if(i.length>h.length){i=i.substring(0,h.length)}if(i===h){return true}}}return false};this.sendNotification=function(h){h=h||{};var i=h.message;var g=h.severity||"info";if(typeof(i)!="undefined"){$j("<p/>").text(i).message({style:g})}};this.setTitle=function(){};this.maximizeApp=function(){};this.reload=function(){};this.closeApp=function(){};this.resizeContainerHeight=function(){};this.resizeContainerWidth=function(){};this.requestNavigateTo=function(){};this.scrollIntoView=function(){};this.handleAppAlert=function(g){};this.initPlacePicker=function(g,i){var h=new d(g);h.showPicker(i)};this.initUserPicker=function(h,k){var j={multiple:false};h=$j.extend(j,h);var i=new jive.UserPicker.SelectPeopleView();var g=function(l){i.close();k(l)};i.setOptions(h).addListener("select",g).open()};this.initUnifiedPicker=function(g,h){require(["apps/autosearch/lightbox"],function(i){new i(g).addListener("chosen",function(j){h({type:j.type,id:j.id,ref:j.resources.self.ref})}).addListener("cancel",function(){h()})})};this.invokeCredentials=function(){};this.destroyCredentials=function(){};this.invokeSettings=function(){};this.destroySettings=function(){};this.closeModal=function(g){};this.setModalTitle=function(g){e.setWhichModalTitle();whichTitle.text(g)};e.setWhichModalTitle=function(){var g=".js-app-title-main";var h=$j(".js-app-title > *");whichTitle=g?h.filter(g):null};this.refresh=function(){this.emit("app.reload");this.displayRefreshMsg(true)};this.displayRefreshMsg=function(g,k){var h=g?"info":"error";var j=g?jive.i18n.keys.appframeworkAppDevelopmentRefresh():jive.i18n.keys.errorGeneral();var i=jive.apps.container.renderMessage({message:j});this.sendNotification({message:i,severity:h})};this.handleConfigurationDialog=function(i,j){var h=this;var l=i.getApp();var g=$j(jive.apps.container.blockingAlertView());if(l.configurationError){g.find("#j-app-blocking-alert-submit").hide();g.find("#j-app-blocking-alert-cancel").addClass("j-btn-callout")}var k=new a({app:l,domTarget:g.find("#app-blocking-alert-detail")});k.addListener("app.service.wire.cancel",function(m){$j("#j-app-blocking-alert-cancel").click(function(){var n=jive.apps.container.renderMessage({message:jive.i18n.keys.appframeworkAppConfigureCancel()});h.sendNotification({severity:"warn",message:n});$j(".j-modal-close-top").click()})});k.addListener("app.service.wire.submit",function(m){$j("#j-app-blocking-alert-submit").click(m.callback)});k.addListener("app.configure.success",function(){var m=jive.apps.container.renderMessage({message:jive.i18n.keys.appframeworkAppConfigureSuccess()});h.sendNotification({severity:"info",message:m});if(j&&j.configureCallback){j.configureCallback(true)}h.emit("app.reload",false)});k.addListener("app.configure.failed",function(){var m=jive.apps.container.renderMessage({message:jive.i18n.keys.appframeworkAppConfigureFailure()});h.sendNotification({severity:"error",message:m});if(j&&j.configureCallback){j.configureCallback(false)}});$j("#j-app-modal-parent iframe").css({display:"none"});$j("#j-app-modal-parent").append(g)};this.resizeModal=function(g,i,h){};this.restoreChromeNav=function(){};this.hideChromeNav=function(){};this.getRenderedApp=function(){};this.getMaximumHeight=function(){};this.getMaximumWidth=function(){};this.boundedHeight=function(g){g=(g+"").match(/\d+/)[0]/1;var h=Math.min(Math.max(g,this.bounds.minHeight),this.bounds.maxHeight);return h};this.boundedWidth=function(g){g=(g+"").match(/\d+/)[0]/1;var h=Math.min(Math.max(g,this.bounds.minWidth),this.bounds.maxWidth);return h};e.delayedRunner=function(i,h,g){var k=new Date().getTime();var j=window.setInterval(function(){var l=new Date().getTime();if(l-k>1500||g()){i();window.clearInterval(j)}},h)};e.recenter=function(j,h){h=!($j.browser.msie&&$j.browser.version<9)&&h;var g=j.height();var i=j.width();j.css({position:"fixed",top:"50%",marginTop:j.outerHeight()/-2,left:"50%",marginLeft:j.outerWidth()/-2});if(h){j.animate({marginLeft:i/-2,marginTop:g/-2},{duration:300,queue:false})}else{j.css({marginLeft:i/-2,marginTop:g/-2},{duration:300,queue:false})}}})});
;
goog.provide("jive.apps.container.appModalHeader");jive.apps.container.appModalHeader=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<header><h2><img alt="" class="j-app-fav-icon" src="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.app.favIconSrc)),'" /> <span class="js-app-title"><span class="js-app-title-main"></span></span></h2></header>');return opt_sb?"":output.toString()};
;
goog.provide("jive.apps.container.canvasConfigurationModal");
jive.apps.container.canvasConfigurationModal=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="jive-modal j-app-modal j-pop js-app-chrome" id="jive-canvas-modal">');jive.apps.container.appModalHeader(opt_data,output);output.append('<label class="j-508-label" id="close-modal-508">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close.modal"),[])),'</label><a href="#" class="j-modal-close-top close" aria-labelledby="close-modal-508" title="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("global.close.modal"),
[])),'"><span class="j-close-icon j-ui-elem" role="img"></span></a><div id="j-app-modal-parent" class="jive-modal-content j-pop-main"></div></div>');return opt_sb?"":output.toString()};
;
function JiveSiteData(b,c,a){return{mvcView:b,app:c,view:c.view,viewParams:a,getAppView:function(){return this.view},getActionInfo:function(){return this.actionInfo},setActionInfo:function(d){this.actionInfo=d},getGadgetMetaData:function(){return this.gadgetInfo},setGadgetMetaData:function(d){this.gadgetInfo=d},getEEContext:function(){return this.context},setEEContext:function(d){this.context=d;if(d&&d.target&&d.target.view){this.view=d.target.view}},getSelection:function(){return this.selection},setSelection:function(d){this.selection=d},getLaunchContext:function(){return this.launchContext}}}JiveSiteData.get=function(b){var a=b[osapi.container.GadgetSite.RPC_ARG_KEY];return a.jiveData};
;
define("jive/app/core_container/navigate_app",function(){return jive.oo.Class.extend(function(a){var d={};var c=/(\/apps\/)([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})/;var b=/(\/apps\/)([a-zA-Z0-9\/\-._]{1,120})/;this.init=function(e){};this.setCanvasToken=function(e){d=e};this.getCanvasToken=function(){return d};this.getCanvasAppInfoFromUrl=function(f){var g=f||window.location.pathname;var e=c.exec(g);if(e!==null){return e[2]}e=b.exec(g);if(e!=null){return e[2]}return null};this.addActionQueueItemToViewParams=function(f){var h=(typeof(f)!=="undefined"&&f!==null)?f:{};var g=/&aq=([1-9]\d*)/.exec(window.location.search+" "+window.location.hash);if(g){var e=g[1];h.jive_aq=e}return h}})});
;
jive.namespace("Apps");jive.Apps.RteArtifacts=jive.oo.Class.extend(function(b){var i=CS_RESOURCE_BASE_URL+"/images/tiny_mce3/themes/advanced/skins/default/img/progress.gif";var f=450;var h="OpenSocial/2.5";var g="legacy";this.init=function(){};b.showMessage=function(l,k){$j("<p/>").html(l).message({style:k})};this.buildArtifactMarkup=function(v,z){var m=v?v[osapi.container.GadgetSite.RPC_ARG_KEY]:null;var o=m.jiveData.app;var y=z.artifactJson;var r=z.rteBound;b.makeArtifactURLsAbsolute(y,o,z.suppressImageUpload);var t=b.normalizeArtifact(y);var l=t.icon;var q=t.previewImage;var x=l||q;if(console){console.log("imageUrl",x)}var u=this;var s=function(K,H){if(!K){v.callback({error:"No artifactJson metadata was provided"});return}var I=m.getActiveSiteHolder().getGadgetInfo();var C=I.modulePrefs.features.actions;var A;if(C&&C.params&&C.params["action-contributions"]){var F=C.params["action-contributions"];for(var E=0;E<F.length;++E){var M=F[E].replace(/\n/mg,"");var D=M.match(/id="(.+?)"/);A=D?D[1]:null;if(A&&A==z.actionId){break}}}if(!A){v.callback({error:"App does not define action "+z.actionId});return}if(!m){u.showMessage("Error occured, app site missing");v.callback({error:"Application framework error"});return}var N=m.jiveData;var J=u.createArtifact({ed:document,appUUID:N.app.appUUID,appInstanceUUID:N.app.appInstanceUUID,data:K,rteBound:r});var G=$j(J);var L=G.wrap("<span></span>").parent().html();if($j.browser.msie){if($j.browser.version<9){L=L.replace(/<\w[^>]*>/g,function(O){return O.replace(/(\w+=)([-.\w]+)/g,'$1"$2"')});L=L.replace(/(<IMG((\s+\w+(\s*=\s*(?:".*?"|'.*?'|[^'">\s]+))?)+\s*|\s*)\s*>)/g,"$1</IMG>")}else{var B=function(O,P){var Q=G.attr(P);if(Q){var R=Q.replace(/\"/g,"&quot;");O=O.replace(P+"='"+Q+"'",P+'="'+R+'"')}return O};L=B(L,"_context")}}v.callback({markup:L,error:H})};if(z.suppressImageUpload||!x){s(y);return}var n=l?b.uploadArtifactIcon(l,o.appInstanceUUID):undefined;var p=q?b.uploadArtifactImage(q):undefined;var k=n||p;if(!k){var w="Error uploading iconUrl or previewImage.";u.showMessage(w);if(console){console.log(w)}s(y,w);return}k.addCallback(function(A){A=A||x;if(l){b.updateIcon(y,A)}else{b.updatePreviewImage(y,A)}s(y)}).addErrback(function(A){var B="Could not upload "+x;u.showMessage(B);if(console){console.log(B,A)}s(y,B)})};b.isProxiedUrl=function(k){return k.startsWith(gadgets.io.getProxyUrl().split("?")[0])};b.makeRelativeAppResourceUrl=function(k,m){var l=m.appURL?m.appURL.match(/.*\//)[0]:"";if(k.match(/^http/)===null&&k.match(/^\/\//)===null){return l+k}return null};this.makeArtifactURLsAbsolute=function(t,l,m,s){var q=function(v){if(s&&/^(\/\w+)?\/gadgets\/(js|concat|proxy)\?/.exec(v)){return s+v}else{var u=b.makeRelativeAppResourceUrl(v,l);if(u){return u}else{if(v.match(/^\/\//)){if(typeof gadgets!="undefined"){var y=gadgets.io.getProxyUrl();var x=y.match(/^https?:(\/\/.+)\?/);if(x&&x.length>1){x[1]=x[1].substring(0,2)+".*"+x[1].substring(2);if(v.match("^"+x[1])){var w=v.match(/url=(.+)&?/);if(w&&w.length>1){return w[1]}}}}}}}};var p=b.normalizeArtifact(t);var o=p.previewImage;if(o){var k=/^(\/\w+)?\/resources\/add-ons\/[0-9a-f-]{36}\/[0-9a-f]{8,16}\//.exec(o);if(!k){o=q(o)||o;if(!m&&!b.isProxiedUrl(o)){var n={};if(s){n.host=s.substring(s.indexOf("//")+2)}o=gadgets.io.getProxyUrl(o,n)}}b.updatePreviewImage(t,o)}var r=p.icon;if(r){var k=false;if(s&&m===null&&typeof m==="object"){m=!!/^(\/\w+)?\/gadgets\/proxy\?/.exec(r);k=/^(\/\w+)?\/resources\/add-ons\/[0-9a-f-]{36}\/[0-9a-f]{8,16}\//.exec(r)}if(!k){r=q(r)||r;if(!m&&!b.isProxiedUrl(r)){var n={};if(s){n.host=s.substring(s.indexOf("//")+2)}r=gadgets.io.getProxyUrl(r,n)}}b.updateIcon(t,r)}if(console){console.log(t)}};b.updatePreviewImage=function(l,k){if(b.deduceArtifactFormatType(l)==h){l.previewImage=k}else{l.display.previewImage=k}};b.updateIcon=function(k,l){if(b.deduceArtifactFormatType(k)==h){k.preferredExperience.display.icon=l}else{k.display.icon=l}};b.deduceArtifactFormatType=function(k){return k.preferredExperience?h:g};b.normalizeArtifact=function(l){var p=b.deduceArtifactFormatType(l);if(p==h){var o=l.preferredExperience;var k=o.target.type;k=k==="gadget"?"embed":k;o.display=o.display||{};o.target=o.target||{};var n=o.display.type;var m=n=="image"?o.display.altText:o.display.label;return{hasPreviewImage:n=="image"&&l.previewImage,hasIcon:n=="text"&&Boolean(o.display.icon),linkType:k||"none",label:m||l.actionLabel,icon:o.display.icon,previewImage:l.previewImage,url:l.url,view:o.target.view,context:l.context,artifactFormatType:p}}else{l.display=l.display||{};l.target=l.target||{};return{hasPreviewImage:l.display.type=="image",hasIcon:l.display.type=="text"&&Boolean(l.display.icon),linkType:l.target.type||"none",label:l.display.label||l.actionLabel,icon:l.display.icon,previewImage:l.display.previewImage,url:l.target.url,view:l.target.view,context:l.target.context,artifactFormatType:p}}};b.extractFileName=function(k){return b.isProxiedUrl(k)?k.match(/.*\%2F(.+)/)[1]:k.match(/.*\/(.+)/)[1]};this.createArtifact=function(m){var x=m.rte,p=m.ed,D=m.appUUID,E=m.actionId,J=m.data,C=m.editedContentBean,n=m.appInstanceUUID,k=m.rteBound;var q=x||k;var G=q?function(M){return"__"+M}:function(M){return"_"+M};J=J||{};J.actionLabel=m.actionLabel;var s=b.normalizeArtifact(J);var u=s.hasPreviewImage;var B=s.hasIcon;var A=s.linkType;var v=s.label;var H=s.icon;var z=s.previewImage;var o=s.url;var y=s.view;var l=s.context;var L=x?p.getDoc():p;var r=$j(L.createElement("a"));r.attr("jivemacro","appEmbeddedView");r.attr("__jive_macro_name","appEmbeddedView");r.attr("href",A=="url"?o:"javascript:;");if(x){if(u){var F=(C&&C.attachmentConfigActionBean)?C.attachmentConfigActionBean.canAttach:true;var I=b.extractFileName(z);var w=$j(p.dom.create("img")).attr("src",i).attr("alt",I);r.append(w);var t=$j(p.dom.create("img")).attr("src",z).attr("alt",I).addClass("jiveImage").hide();r.append(t);t.load(function(){t.unbind();j(t);w.unbind().remove();t.show();jive.conc.nextTick(function(){if(F&&e(t)){c(t,x,p).addCallback(function(M){z=M.attr("src");r.attr("__previewImage",z)})}})});r.addClass("jive-link-app-preview")}else{if(B){var F=(C&&C.attachmentConfigActionBean)?C.attachmentConfigActionBean.canAttach:true;r.text(v);r.css("background-image","url('"+H+"')");r.addClass("jive-link-app-icon");r.attr("__icon",H);var I=b.extractFileName(H);var t=$j(p.dom.create("img")).attr("src",H).attr("alt",I).hide();jive.conc.nextTick(function(){if(F&&e(t)){d(t,x,p,n).addCallback(function(M){H=M.attr("src");r.attr("__icon",H);r.css("background-image","url('"+H+"')")})}});r.append($j(p.dom.create("span")).addClass("j-ui-elem").addClass("j-app-link"))}else{r.text(v);r.addClass("jive-link-app");r.append($j(x?p.dom.create("span"):L.createElement("span")).addClass("j-ui-elem").addClass("j-app-link"))}}}else{if(u){var I=b.extractFileName(z);r.attr(G("previewImage"),z);r.addClass("jive-link-app-preview");var K=$j(L.createElement("img"));K.attr("src",z).attr("alt",I).addClass("jiveImage");r.append(K)}else{if(B){r.text(v);if(!$j.browser.msie){r.css("background-image","url('"+H+"')")}r.addClass("jive-link-app-icon");r.attr(G("icon"),H);r.append($j(L.createElement("span")).addClass("j-ui-elem").addClass("j-app-link"))}else{r.text(v);r.addClass("jive-link-app");r.append($j(L.createElement("span")).addClass("j-ui-elem").addClass("j-app-link"))}}}if(v){r.attr("title",v)}r.attr(G("appUUID"),D);r.attr(G("action_id"),E);if(A=="embed"){r.attr(G("view"),y||"embedded");r.attr(G("context"),JSON.stringify(l||{}))}if(o){r.attr(G("url"),o)}r.attr("modifiedTitle","true");r.addClass("jive_macro");r.addClass("jive_macro_appEmbeddedView");return r[0]};this.parseSelectionContextFromArtifact=function(n){var m=n.attr("__context");var t=n.attr("__view");var l=n.attr("__url");var o=n.attr("__previewImage")?"image":"text";var u=n.attr("__title");var p=n.attr("__previewImage");var v=n.text().trim()||"";var s=n.attr("__icon");var r=null;switch(o){case"image":r={type:"image",previewImage:p};if(u){r.label=u}break;case"text":r={type:"text",label:v};if(s){r.icon=s}break}var k=(m||t)?"embed":"url";var q=null;switch(k){case"embed":q={type:"embed",view:t||"embedded"};if(m){q.context=JSON.parse(m)}if(l){q.url=l}break;case"url":q={type:"url",url:l||""};break}return{display:r,target:q}};this.uploadArtifactIcon=function(l,k){var m=b.extractFileName(l);var n=jive.api.apps("instances/"+k+"/attach_image")+"?name="+m;return a(n,l)};this.uploadArtifactImage=function(k){var l=b.extractFileName(k);var m=jive.rest.url("/rteImages")+"?name="+l+"&objectId=-1&objectType=-1";return a(m,k)};function j(m){var k=m.width();if(k>f){var n=f/k;var l=Math.round(n*k);m.attr("width",l)}}function e(m){var k=m.attr("src");if(k.match(/^\/[^\/]/)){return 0}var l="(https?:)?//"+location.hostname+(location.port?":"+location.port:"");if(!k.match("^"+l)){return true}return b.isProxiedUrl(k)?1:0}function d(n,m,l,k){var o=jive.api.apps("instances/"+k+"/attach_image");return c(n,m,l,o)}function c(k,l,r,p){var m=l.getImageService();var s=k.attr("alt");var t=k.attr("src");function o(){if(console){console.log("Image REST request failed for %s",s,arguments)}k.remove()}var n=new jive.conc.Promise();var u=l.getFormService();var q=u.setFormEnabled(false,r.getLang("jiveimage.please_wait"));m.createFromImageSrc(s,b.isProxiedUrl(t)?t:encodeURI(t),p).addCallback(function(v){k.load(function(){var w=$j(this);w.css({width:w.width()+"px",height:w.height()+"px","max-width":"","max-height":""})});k.attr("src",v.url);jive.conc.nextTick(function(){r.nodeChanged()});n.emitSuccess(k)}).addErrback(function(){o();n.emitError()}).always(function(){u.setFormEnabled(q)});return n}function a(o,k){var n=new jive.conc.Promise();var l={url:o,contentType:"application/x-www-form-urlencoded",processData:false,data:"url="+b.isProxiedUrl(k)?k:encodeURIComponent(k)};var m={contentType:"application/json; charset=utf-8"};$j.ajax($j.extend({type:"POST",dataType:"json",success:function(p,r,q){if(!p||!p.url){n.emitError()}else{n.emitSuccess(p.url)}},error:function(p){n.emitError(p)},timeout:30000},m,l));return n}});define("jive/app/rte/artifacts",["gadgets"],function(a){return jive.Apps.RteArtifacts});
;
goog.provide("jive.i18n.keys.globalAjaxError");jive.i18n.keys.globalAjaxError=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.ajax_error"),[])));return opt_sb?"":output.toString()};
;
define("apps/activity_stream/models/rtc_source",["jquery","underscore","lib/jiverscripts/src/oo/class","apps/shared/models/core_deferred"],function(d,c,b,a){return b.extend(function(e){e.init=function(f){if(f&&f.collabID){this.collabID=f.collabID;this.rtcEnabled=f.rtcEnabled;this.collabDeferred=this.getCollaboration(this.collabID)}};this.getCollaboration=function(f){return a.runQuery(function(g){return g.jive.corev3.collaborations.get({uri:"/collaborations/"+f})})};this.getInteractions=function(g){var f=this;return f.collabDeferred.then(function(h){return a.runQuery(h.getInteractions(g)).then(function(i){c.each(i,function(j){c.extend(j.author,j.author.jive);j.author.entitled=true;j.collabID=f.collabID;j.rtcEnabled=f.rtcEnabled});return i})})};this.updateSubject=function(h){var g=this,f={subject:h};return g.collabDeferred.then(function(i){return a.runQuery(i.setSubject(f))})};this.createInteraction=function(h){var g=this;var f={content:{text:h}};return g.collabDeferred.then(function(i){return a.runQuery(i.createInteraction(f)).then(function(j){c.extend(j.author,j.author.jive);j.author.entitled=true;j.collabID=g.collabID;j.rtcEnabled=g.rtcEnabled;return j})})};this.createCollaboration=function(g,i,h){var f=this;return a.runQuery(function(j){return j.jive.corev3.collaborations.create({participants:g,subject:h})}).then(function(j){f.collabDeferred=d.when(j);f.createInteraction("<body>"+i+"</body>")})};this.addCollaborators=function(h,j,i){var f=this,g=j.split(",").map(function(k){return{id:k}});return f.collabDeferred.then(function(k){return a.runQuery(k.addParticipant({participants:g}))}).then(function(k){return k.participants.map(function(l){return c.find(i,function(m){return m.id==l.id})})})};this.leaveCollaboration=function(){var f=this;return f.collabDeferred.then(function(){return a.runQuery(function(g){return g.jive.corev3.collaborations.removeParticipants({userID:window._jive_current_user.ID,uri:"/collaborations/"+f.collabID+"/participants/"+window._jive_current_user.ID})})})};this.deleteDM=function(f){return this.remove(jive.rest.corev3.url("/dms/"+f))};this.deleteComment=function(f){return this.remove(jive.rest.corev3.url("/comments/"+f))};this.remove=function(g){function f(){d("<p />").html(jive.i18n.keys.globalAjaxError()).message({style:"error"})}return d.ajax(g,{type:"DELETE",error:f})}})});
;
goog.provide("jive.i18n.keys.tinymceJivementionSecretGroup");jive.i18n.keys.tinymceJivementionSecretGroup=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tinymce.jivemention.secret_group"),[])));return opt_sb?"":output.toString()};
;
goog.provide("jive.i18n.keys.tinymceJivementionRestrictedContent");jive.i18n.keys.tinymceJivementionRestrictedContent=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tinymce.jivemention.restricted_content"),[])));return opt_sb?"":output.toString()};
;
goog.provide("jive.wall.charLenErrors");jive.wall.charLenErrors=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.error?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("we.chars.over"),[opt_data.numChars])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("we.chars.remaining"),[opt_data.numChars])));return opt_sb?"":output.toString()};
;
goog.provide("jive.wall.submitErrors");
jive.wall.submitErrors=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.key=="over"?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("we.form.character.limit.over"),[])):opt_data.key=="noplaceselected"?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("we.form.no.place.selected"),[])):opt_data.key=="none"?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("we.form.character.limit.none"),[])):soy.$$escapeHtml(opt_data.key));return opt_sb?"":output.toString()};
;
goog.provide("jive.statusinput.attachments.renderCommonAttachment");
jive.statusinput.attachments.renderCommonAttachment=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<li",opt_data.attachment.id?' id="'+opt_data.attachment.id+'"':"",opt_data.containerClass?' class="'+soy.$$escapeHtml(opt_data.containerClass)+'"':"",'><a href="',soy.$$escapeHtml(opt_data.linkUrl),'" ',opt_data.attachment.originalURL?'jiveOriginalURL="'+soy.$$escapeHtml(opt_data.attachment.originalURL)+'"':"",' style="display: block;" class="j-attach-anchor"><img src="',
soy.$$filterNoAutoescape(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.attachment.imageThumbnailUrl)),'" alt="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.attachment"),[])),'"/></a>',opt_data.removable?'<a href="javascript:void(0);" class="j-remove-attachment">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.remove"),[]))+"</a>":"","</li>");return opt_sb?"":output.toString()};
;
goog.provide("jive.statusinput.attachments.renderLinkThumbnails");
jive.statusinput.attachments.renderLinkThumbnails=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-thumbnails j-rc3">',opt_data.removable?'<div class="j-controls">'+(parseInt(opt_data.attachment.properties.thumbnailCount,10)>1?'<a class="left j-preview-choose" aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("wallentry.external_url.preview.image.previous"),[]))+'" href="#"><span class="jive-icon-glyph icon-arrow-left2"></span></a><a class="right j-preview-choose" aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("wallentry.external_url.preview.image.next"),
[]))+'" href="#"><span class="jive-icon-glyph icon-arrow-right2"></span></a>':"")+'<a class="no-thumb" aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("wallentry.external_url.preview.image.remove"),[]))+'" href="#"><span class="jive-icon-glyph icon-close-med"></span></a></div>':"",'<ul class="j-thumbnails-viewport">',opt_data.attachment.properties.thumbnailID_1?'<li class="j-thumbnail '+(opt_data.removable?"selected":"")+'"><a href="'+soy.$$filterNoAutoescape(opt_data.attachment.properties.linkURL)+
'"><img '+(opt_data.attachment.properties.title?'title="'+soy.$$escapeHtml(opt_data.attachment.properties.title)+'"':"")+'src="'+soy.$$filterNoAutoescape(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.attachment.properties.thumbnailURL_1))+'" data-image-id="'+soy.$$escapeHtml(opt_data.attachment.properties.thumbnailID_1)+'" alt=""/></a></li>':"",opt_data.attachment.properties.thumbnailID_2?'<li class="j-thumbnail"><a href="'+soy.$$filterNoAutoescape(opt_data.attachment.properties.linkURL)+
'"><img '+(opt_data.attachment.properties.title?'title="'+soy.$$escapeHtml(opt_data.attachment.properties.title)+'"':"")+'src="'+soy.$$filterNoAutoescape(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.attachment.properties.thumbnailURL_2))+'" data-image-id="'+soy.$$escapeHtml(opt_data.attachment.properties.thumbnailID_2)+'" alt=""/></a></li>':"",opt_data.attachment.properties.thumbnailID_3?'<li class="j-thumbnail"><a href="'+soy.$$filterNoAutoescape(opt_data.attachment.properties.linkURL)+
'"><img '+(opt_data.attachment.properties.title?'title="'+soy.$$escapeHtml(opt_data.attachment.properties.title)+'"':"")+'src="'+soy.$$filterNoAutoescape(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.attachment.properties.thumbnailURL_3))+'" data-image-id="'+soy.$$escapeHtml(opt_data.attachment.properties.thumbnailID_3)+'" alt=""/></a></li>':"","</ul></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.statusinput.attachments.renderLinkAttachment");
jive.statusinput.attachments.renderLinkAttachment=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<li class="js-attached-link j-attached-link clearfix"',opt_data.attachment.id?' id="'+opt_data.attachment.id+'"':"",' style="display:block">',opt_data.removable?'<div class="j-preview-header">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("wallentry.external_url.preview"),[]))+'<a  href="javascript:void(0);" class="j-remove-attachment j-close font-color-meta-light" aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("wallentry.external_url.preview.remove"),
[]))+'"><span class="jive-icon-glyph icon-close-med"></span></a></div>':"",'<div class="j-simple">');if(opt_data.attachment.properties.type=="video"&&opt_data.attachment.properties.html)output.append('<div class="j-video">',soy.$$filterNoAutoescape(opt_data.attachment.properties.html),"</div>");else if(opt_data.attachment.properties.type=="photo"&&opt_data.attachment.properties.imageURL)output.append('<div class="j-image"><img src="',soy.$$filterNoAutoescape(jive.soy.func.buildUrl(window._jive_base_absolute_url,
opt_data.attachment.properties.imageURL)),'" alt=""/></div>');else if(opt_data.attachment.properties.thumbnailCount)jive.statusinput.attachments.renderLinkThumbnails(opt_data,output);output.append('<div class="j-details"><a class="j-title" href="',soy.$$escapeHtml(opt_data.attachment.properties.linkURL),'">',opt_data.attachment.properties.title?soy.$$escapeHtml(opt_data.attachment.properties.title):soy.$$filterNoAutoescape(opt_data.attachment.properties.linkURL),"</a>",opt_data.attachment.properties.description?
'<p class="j-description">'+soy.$$filterNoAutoescape(opt_data.attachment.properties.description)+"</p>":"",opt_data.attachment.properties.providerURL&&opt_data.attachment.properties.providerDisplay?'<span class="j-meta"><a class="j-provider" href="'+soy.$$escapeHtml(opt_data.attachment.properties.providerURL)+'">'+soy.$$escapeHtml(opt_data.attachment.properties.providerDisplay)+"</a></span>":"","</div></div></li>");return opt_sb?"":output.toString()};
;
goog.provide("jive.statusinput.attachments.renderAttachment");
jive.statusinput.attachments.renderAttachment=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;switch(opt_data.attachment.objectType){case 102:jive.statusinput.attachments.renderCommonAttachment(soy.$$augmentMap(opt_data,{linkUrl:soy.$$filterNoAutoescape(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.entry.jiveObjectURL)),containerClass:"j-attached-document"}),output);break;case 111:if(!opt_data.hideFirstImage&&(!opt_data.attachment.properties||!opt_data.attachment.properties.hidden))jive.statusinput.attachments.renderCommonAttachment(soy.$$augmentMap(opt_data,
{linkUrl:soy.$$filterNoAutoescape(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.attachment.fullImageUrl)),containerClass:"j-attached-image"}),output);break;case 801:if(opt_data.attachment.properties.linkURL)jive.statusinput.attachments.renderLinkAttachment(opt_data,output);else if(opt_data.attachment.properties.videoURL)output.append('<li class="j-attached-video" ',opt_data.attachment.id?'id="'+opt_data.attachment.id+'"':"",'><a rel="fb" href="',soy.$$filterNoAutoescape(opt_data.attachment.properties.videoURL),
'" style="width: ',soy.$$escapeHtml(opt_data.attachment.properties.thumbnailWidth),"px; height: ",soy.$$escapeHtml(opt_data.attachment.properties.thumbnailHeight),'px" class="j-attach-anchor j-attach-video"><img src="',soy.$$filterNoAutoescape(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.attachment.properties.thumbnailURL)),'" width="',soy.$$escapeHtml(opt_data.attachment.properties.thumbnailWidth),'" height="',soy.$$escapeHtml(opt_data.attachment.properties.thumbnailHeight),'" alt="',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.attachment"),[])),'" /><span class="j-icon-play" style="display: none; position: absolute; left: ',soy.$$escapeHtml((parseInt(opt_data.attachment.properties.thumbnailWidth,10)+12-40)/2),'px; top: 20px; "></span></a>',opt_data.removable?'<a href="javascript:void(0);" class="j-remove-attachment">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.remove"),[]))+"</a>":"","</li>");break}return opt_sb?"":output.toString()};
;
goog.provide("jive.statusinput.attachments.renderAttachments");
jive.statusinput.attachments.renderAttachments=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.entry.meta){output.append('<a  class="j-attachment-arrow j-attachment-arrow-left clearfix" title="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("wallentry.attachment.slideToLeft"),[])),'" aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("wallentry.attachment.slideToLeft"),[])),'" href="javascript:void(0);"><span class="jive-icon-link-back"></span></a><ul class="j-attached-items clearfix">');var attachmentList10=
opt_data.entry.meta;var attachmentListLen10=attachmentList10.length;for(var attachmentIndex10=0;attachmentIndex10<attachmentListLen10;attachmentIndex10++){var attachmentData10=attachmentList10[attachmentIndex10];if(opt_data.entry.collabObjectType=="109016030")jive.statusinput.attachments.renderAttachment(soy.$$augmentMap(opt_data,{attachment:attachmentData10,hideFirstImage:false}),output);else jive.statusinput.attachments.renderAttachment(soy.$$augmentMap(opt_data,{attachment:attachmentData10,hideFirstImage:opt_data.hideFirstImage&&
attachmentIndex10==0}),output)}output.append(opt_data.removable?"<li class='j-attached-loading'></li>":"",'</ul><a class="j-attachment-arrow j-attachment-arrow-right clearfix" title="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("wallentry.attachment.slideToRight"),[])),'" aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("wallentry.attachment.slideToRight"),[])),'" href="javascript:void(0);"><span class="jive-icon-link-forward"></span></a>')}return opt_sb?"":output.toString()};
;
goog.provide("jive.statusinput.containers.renderAttachmentsContainer");
jive.statusinput.containers.renderAttachmentsContainer=function(opt_data,opt_sb){opt_data=opt_data||{};var output=opt_sb||new soy.StringBuilder;output.append("<div ",opt_data.id?'id="'+opt_data.id+'" ':"",'class="jive-js-attachment-container j-attachment-container clearfix" ',opt_data.visible?'style="display:block"':"",">");if(opt_data.entry&&opt_data.entry.meta)jive.statusinput.attachments.renderAttachments(opt_data,output);output.append("</div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.statusinput.containers.microbloggingStatusInputSuccess");
jive.statusinput.containers.microbloggingStatusInputSuccess=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div id="j-js-mb-success" class="j-mb-success-msg j-rc4"><header class="font-color-new">',opt_data.entry.status!="AWAITING_MODERATION"?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("eae.mb.post.success.title"),[opt_data.entry.containerName])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("we.form.posted.moderation.place.name"),[opt_data.entry.containerName])),
'<a href="javascript:void(0)" class="j-js-mb-success-dismiss j-mb-dismiss" aria-label="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("anncmt.dismiss_announcemt.button"),[])),'"><span class="jive-icon-sml jive-glyph-remove"></span></a></header><p>',soy.$$filterNoAutoescape(opt_data.entry.message),"</p><p>");if(opt_data.entry&&opt_data.entry.meta&&opt_data.entry.meta.length>0){jive.statusinput.containers.renderAttachmentsContainer({id:"attachmentContainer-success",entry:opt_data.entry,
visible:true},output);jive.shared.soy.resourceInlineJs({code:"require(['apps/microblogging/views/attachment_view'],function(AttachmentView){var attachmentView = new AttachmentView({selector:'#attachmentContainer-success'}); attachmentView.postRender();});"},output)}output.append("</p><div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.statusinput.containers.microbloggingStatusInputLastUpdate");
jive.statusinput.containers.microbloggingStatusInputLastUpdate=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<strong>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("eae.mb.last_update"),[])),"</strong> ",soy.$$filterNoAutoescape(opt_data.latestStatusUpdate.text),' <strong><a href="',soy.$$filterNoAutoescape(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.latestStatusUpdate.url)),'" class="j-comment-count j-inline-link font-color-meta-light" aria-label="',
opt_data.latestStatusUpdate.commentcount==1?soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("global.comments.singular"),[opt_data.latestStatusUpdate.commentcount])):soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("global.comments.plural"),[opt_data.latestStatusUpdate.commentcount])),'"><span class="jive-icon-sml jive-glyph-comment"></span>',soy.$$escapeHtml(opt_data.latestStatusUpdate.commentcount),"</a></strong>");return opt_sb?"":output.toString()};
;
goog.provide("jive.i18n.keys.weFormAddimage");jive.i18n.keys.weFormAddimage=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("we.form.addimage"),[])));return opt_sb?"":output.toString()};
;
goog.provide("jive.publishbar.userWithoutPermission");jive.publishbar.userWithoutPermission=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-tips">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("doc.collab.err.no_perm_user.info"),[])),"</div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.publishbar.listWithoutPermission");jive.publishbar.listWithoutPermission=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-tips">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("doc.collab.err.no_perm_list.info"),[])),"</div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.publishbar.visibility");
jive.publishbar.visibility=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.showVisibility?'<span id="'+(opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"")+"js-visibility-"+soy.$$escapeHtml(opt_data.visibility)+'" class="js-visibility-option">'+(opt_data.placeVisibility?(opt_data.preInputNameKey&&opt_data.preInputNameKey!=""?'<label for="'+(opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"")+'js-publishbar-place-input">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey(opt_data.preInputNameKey)),
[]))+"</label>":"")+'  <span class="j-publish-input-row"><input type="text" id="'+(opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"")+'js-publishbar-place-input" class="j-publish-input-entry" autocomplete="off" role="combobox"'+(opt_data.communityFeatureVisible?'placeholder="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("publishbar.visibility.place.holder"),[]))+'" aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("publishbar.visibility.place.holder"),[]))+'"':
'placeholder="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("publishbar.visibility.group.holder"),[]))+'" aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("publishbar.visibility.group.holder"),[]))+'"')+"/>"+(opt_data.inputBrowse?'<a href="#trigger_modal" id="'+(opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"")+'js-publishbar-place-browse">'+(opt_data.communityFeatureVisible?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("publishbar.visibility.place.browse"),
[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("publishbar.visibility.group.browse"),[])))+"</a>":"")+'</span><div id="'+(opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"")+'js-publishbar-place-results" class="j-pop j-autocomplete" style="display: none;"></div>':opt_data.peopleVisibility?'<span><input type="text" id="'+(opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"")+'js-publishbar-users" name="publishBar.users" class="j-autocomplete-input j-user-autocomplete j-ui-elem" role="combobox" placeHolder="'+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("publishbar.visibility.people.holder"),[]))+'" aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("publishbar.visibility.people.holder"),[]))+'"/></span>':opt_data.allVisibility&&opt_data.personalBlog?opt_data.personalBlog.id>0?soy.$$escapeHtml(opt_data.personalBlog.name):'<span id="js-publishbar-createblog-default">'+soy.$$escapeHtml(opt_data.personalBlog.name)+'   <a href="#" class="font-color-meta" id="js-publishbar-createblog-change">'+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("publishbar.visibility.change.blog"),[]))+'</a></span><span id="js-publishbar-createblog" style="display:none;"><label for="personal-blog-name-id" class="j-508-label" aria-hidden="true">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("publishbar.visibility.change.blog"),[]))+'</label><input id="personal-blog-name-id" type="text" name="publishBar.personalBlogName" value="'+soy.$$escapeHtml(opt_data.personalBlog.name)+'"/></span>':"")+"</span>":
"");return opt_sb?"":output.toString()};
;
goog.provide("jive.publishbar.creatorVisibilityInfo");
jive.publishbar.creatorVisibilityInfo=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<input type="hidden" id="',opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"",'js-container-objecttype" name="publishBar.container.objectType" value="',soy.$$escapeHtml(opt_data.visibilityBean.placeItemBean.type),'"/><input type="hidden" id="',opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"",'js-container-id" name="publishBar.container.objectID" value="',soy.$$escapeHtml(opt_data.visibilityBean.placeItemBean.id),
'"/>',opt_data.includeVisibilityValue?'<input type="hidden" name="publishBar.visibility" value="'+soy.$$escapeHtml(opt_data.visibilityBean.visibility)+'"/>':"");return opt_sb?"":output.toString()};
;
goog.provide("jive.people.profile.friendListChooser");
jive.people.profile.friendListChooser=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<span class="j-friend-list-chooser-container j-js-friend-list-chooser-container"',opt_data.hideFriendListChooser||opt_data.friendLists&&opt_data.friendLists.length==0?' style="display: none;"':"",">",!opt_data.darkButton?'<a href="#" class="js-connection-label-btn j-connection-label-btn j-social-action j-split-button j-btn-global j-btn-small" '+(opt_data.hidden?'style="display:none"':
"")+' title="'+soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("profile.friends.addconnectionlabel.text"),[]))+'"><span class="jive-icon-glyph icon-user-plus"></span><span class="j-508-label">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("profile.friends.addconnectionlabel.text"),[]))+"</span></a>":'<a href="#" class="js-connection-label-btn j-connection-label-btn j-social-action" '+(opt_data.hidden?'style="display:none"':"")+' title="'+soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("profile.friends.addconnectionlabel.text"),
[]))+'"><span class="jive-icon-glyph icon-user-plus"></span><span class="j-508-label">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("profile.friends.addconnectionlabel.text"),[]))+"</span></a>",'<div id="j-connection-labels-menu" class="j-connection-labels-menu js-connection-labels-menu j-menu j-quick-menu j-pop-main" style="display: none;" data-userid="',soy.$$escapeHtmlAttribute(opt_data.targetUserID),'"><h3 class="font-color-meta-light">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("profile.friends.addconnectionlabel.text"),
[])),'</h3><form class="j-js-friend-list-chooser"><ul class="j-icon-list">');if(opt_data.friendLists){var listList36=opt_data.friendLists;var listListLen36=listList36.length;for(var listIndex36=0;listIndex36<listListLen36;listIndex36++){var listData36=listList36[listIndex36];jive.people.profile.friendListChooserLabel(soy.$$augmentMap(listData36,{selected:listData36.targetUserAMember,userID:opt_data.targetUserID}),output)}}output.append("</ul></form></div></span>");return opt_sb?"":output.toString()};
;
goog.provide("jive.people.profile.followCounts");
jive.people.profile.followCounts=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<ul class="font-color-meta">',!opt_data.bidirectional?"<li>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("profile.friends.following"),[]))+' <span class="js-following-count">'+soy.$$escapeHtml(opt_data.followingCount)+"</span></li><li>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("profile.friends.followers"),[]))+' <span class="js-follower-count">'+soy.$$escapeHtml(opt_data.followerCount)+
"</span></li>":"<li>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("profile.friends.friends"),[]))+' <span class="js-follower-count">'+soy.$$escapeHtml(opt_data.followerCount)+"</span></li>","</ul>");return opt_sb?"":output.toString()};
;
goog.provide("jive.people.profile.followLink");
jive.people.profile.followLink=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(!opt_data.targetUserDisabled){output.append('<div class="js-follow-user-link j-follow-user-link clearfix" role="link" data-userid="',soy.$$escapeHtmlAttribute(opt_data.targetUserID),'" data-streamsassoc="',soy.$$escapeHtmlAttribute(opt_data.streamsAssociatedCount),'" data-location="',soy.$$escapeHtmlAttribute(opt_data.renderLocation),'" data-bidirectional="',soy.$$escapeHtmlAttribute(opt_data.bidirectional),
'" data-follower-count="',soy.$$escapeHtmlAttribute(opt_data.followerCount),'" data-displayname="',soy.$$escapeHtmlAttribute(opt_data.targetUserDisplayName),'" data-approvals-enabled="',soy.$$escapeHtmlAttribute(opt_data.approvalsEnabled),'" aria-live="polite" aria-atomic="true" aria-label="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("profile.friends.following.label"),[])),'"><a href="#" class="js-follow ',!opt_data.darkButton?"j-btn-global j-btn-small":"j-social-action",'" ',
opt_data.targetUserACurrentFriend||opt_data.targetUserAPendingFriend?'style="display:none"':"",">",opt_data.darkButton?'<span class="jive-icon-glyph icon-plus-circle2"></span>':"",!opt_data.bidirectional?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("profile.friends.startfollowing.button"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("profile.friends.addfriend.button"),[])),' <span class="jive-icon-glyph icon-pulse j-instreamicon"></span></a><a href="#" class="j-following js-following ',
!opt_data.hideFriendListChooser&&opt_data.friendLists&&opt_data.friendLists.length>0?"j-split-button notlast":""," ",!opt_data.darkButton?"j-btn-global j-btn-small":"j-social-action",'" ',!opt_data.targetUserACurrentFriend?'style="display:none"':"",">",opt_data.darkButton?'<span class="jive-icon-glyph icon-plus-circle2"></span>':"");jive.people.profile.followingAssociatedStreamCount({count:opt_data.streamsAssociatedCount,renderLocation:opt_data.renderLocation},output);output.append('</a><span class="js-pending j-disabled ',
!opt_data.darkButton?"j-btn-global j-btn-small":"j-social-action",'" ',!opt_data.targetUserAPendingFriend?'style="display:none"':"",">",opt_data.darkButton?'<span class="jive-icon-glyph icon-plus-circle2"></span>':"",!opt_data.bidirectional?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("profile.follow.pendingapproval.text"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("profile.friend.pendingapproval.text"),[])),"</span>");jive.people.profile.friendListChooser(soy.$$augmentMap(opt_data,
{hidden:!opt_data.targetUserACurrentFriend}),output);if(!opt_data.hideFollowingCount)jive.people.profile.followCounts(opt_data,output);output.append("</div>")}return opt_sb?"":output.toString()};
;
goog.provide("jive.soy.acclaim.displayUserRow");
jive.soy.acclaim.displayUserRow=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(!opt_data.onlyFriends||opt_data.onlyFriends&&opt_data.currentUserID!=opt_data.user.id&&opt_data.user.prop.connections.targetUserACurrentFriend)if(opt_data.onlyNotes&&opt_data.user.prop.hasBookmarknotes||!opt_data.onlyNotes){output.append('<tr data-user-id="',soy.$$escapeHtml(opt_data.user.id),'">');if(!opt_data.onlyNotes){output.append('<td class="j-td-avatar ',opt_data.user.prop.hasBookmarknotes?
"j-td-topalign":"",'">');if(opt_data.activityType=="expertise")jive.shared.displayutil.icon(soy.$$augmentMap(opt_data.user,{size:35}),output);else jive.shared.displayutil.avatar(soy.$$augmentMap(opt_data.user,{size:35,currentUserPartner:opt_data.currentUserPartner,extraParams:opt_data.extraParams}),output);output.append("</td>")}output.append('<td class="j-td-name">');if(opt_data.currentUserID==opt_data.user.id)jive.shared.displayutil.userDisplayNameLink(soy.$$augmentMap(opt_data.user,{displayNameOverride:jive.i18n.i18nText(jive.i18n.getMsg("global.you"),
[]),extraParams:opt_data.extraParams}),output);else jive.shared.displayutil.userDisplayNameLink(soy.$$augmentMap(opt_data.user,{extraParams:opt_data.extraParams}),output);output.append(!opt_data.onlyNotes?"<\!-- TODO: show truncated version of the notes --\>"+(opt_data.activityType=="bookmark"&&opt_data.user.prop.hasBookmarknotes&&opt_data.user.prop.bookmarknotes?'<p class="j-user-bookmark-notes">'+soy.$$filterNoAutoescape(opt_data.user.prop.bookmarknotes)+"</p>":""):"<\!-- TODO: show full, non-plain text / non-escaped version of the full notes --\>"+
(opt_data.activityType=="bookmark"&&opt_data.user.prop.hasBookmarknotes&&opt_data.user.prop.bookmarknotes?'<p class="j-user-bookmark-notes">'+soy.$$filterNoAutoescape(opt_data.user.prop.bookmarknotes)+"</p>":""),"</td>");if(opt_data.activityType!="bookmark"&&!opt_data.hideFollow)if(!opt_data.onlyNotes){output.append('<td class="j-td-follow">');if(opt_data.user.prop.connections&&opt_data.user.prop.connections.followLinkShown)if(opt_data.user.id!=opt_data.currentUserID&&opt_data.user.visible)jive.people.profile.followLink(soy.$$augmentMap(opt_data.user.prop.connections,
{targetUserID:opt_data.user.id,targetUserDisplayName:opt_data.user.displayName,hideFollowingCount:true,renderLocation:"bookmarked-user-list",streamsAssociatedCount:opt_data.user.prop.connections.streamsAssociatedBean?opt_data.user.prop.connections.streamsAssociatedBean.streamIDs.length:0}),output);output.append("</td>")}output.append("</tr>")}return opt_sb?"":output.toString()};
;
goog.provide("jive.soy.acclaim.renderEmptyListText");
jive.soy.acclaim.renderEmptyListText=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.activityType=="bookmark"?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("acclaim.modal.empty.msg.bookmarks"),[])):opt_data.activityType=="like"?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("acclaim.modal.empty.msg.likes"),[])):opt_data.activityType=="follow"?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("acclaim.modal.empty.msg.follow"),[])):opt_data.activityType==
"connections"?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("acclaim.modal.empty.msg.connections"),[])):opt_data.activityType=="membership"?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("acclaim.modal.empty.msg.membership"),[])):opt_data.activityType=="same_question"?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("acclaim.modal.empty.msg.same_question"),[])):"");return opt_sb?"":output.toString()};
;
goog.provide("jive.soy.acclaim.renderUserList");
jive.soy.acclaim.renderUserList=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<table",opt_data.id?' id="'+soy.$$escapeHtml(opt_data.id)+'"':"",opt_data.classNames?' class="'+soy.$$escapeHtml(opt_data.classNames)+'"':"",!opt_data.show?' style="display: none;"':"","><tbody>");var userList18=opt_data.users;var userListLen18=userList18.length;if(userListLen18>0)for(var userIndex18=0;userIndex18<userListLen18;userIndex18++){var userData18=userList18[userIndex18];jive.soy.acclaim.displayUserRow({activityType:opt_data.activityType,
user:userData18,currentUserID:opt_data.currentUserID,currentUserPartner:opt_data.currentUserPartner,onlyFriends:opt_data.onlyFriends,onlyNotes:opt_data.onlyNotes,hideFollow:opt_data.hideFollow,extraParams:opt_data.extraParams},output)}else{output.append('<tr><td><p class="j-empty font-color-meta-light">');if(opt_data.emptyContent)output.append(soy.$$filterNoAutoescape(opt_data.emptyContent));else jive.soy.acclaim.renderEmptyListText(opt_data,output);output.append("</p></td></tr>")}output.append("</tbody></table>");
return opt_sb?"":output.toString()};
;
goog.provide("jive.soy.acclaim.renderUserNotesList");
jive.soy.acclaim.renderUserNotesList=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<table id="',soy.$$escapeHtml(opt_data.id),'" class="',soy.$$escapeHtml(opt_data.classNames),'"',!opt_data.show?' style="display: none;"':"","><tbody>");var userList12=opt_data.users;var userListLen12=userList12.length;if(userListLen12>0)for(var userIndex12=0;userIndex12<userListLen12;userIndex12++){var userData12=userList12[userIndex12];if(userData12.prop.bookmarknotes)jive.soy.acclaim.displayUserRow({activityType:opt_data.activityType,
user:userData12,currentUserID:opt_data.currentUserID,currentUserPartner:opt_data.currentUserPartner,onlyFriends:opt_data.onlyFriends,onlyNotes:opt_data.onlyNotes},output)}else output.append('<tr><td><p class="j-empty font-color-meta-light">There are no bookmark notes on this item</p></td></tr>');output.append("</tbody></table>");return opt_sb?"":output.toString()};
;
goog.provide("jive.soy.acclaim.renderAcclaimModal");
jive.soy.acclaim.renderAcclaimModal=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="jive-modal j-modal j-acclaim-mini-modal j-people-list-modal" data-you-id="',soy.$$escapeHtml(opt_data.youID),'" role="dialog" tabindex="-1" aria-labelledby="acclaim-header"><header role="header" id="acclaim-header"><h2 ',opt_data.activityType=="bookmark"?'class="j-modal-bookmark-header"':"",'><p class="modal-initially-focused" tabindex="0">');jive.shared.soy.getCountTextByType({count:opt_data.totalCount,
type:opt_data.activityType,bidirectionalGraph:opt_data.bidirectionalGraph},output);output.append('</p></h2></header><label class="j-508-label" id="close-modal-508">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close.modal"),[])),'</label><a href="#" class="j-modal-close-top close" aria-labelledby="close-modal-508" title="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close.modal"),[])),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.close"),[])),
' <span class="jive-icon-glyph icon-close-med" role="img"></span></a><section  class="jive-modal-content clearfix">',!opt_data.guest?'<nav id="jive-view-picker" class="j-modal-filter"><input type="checkbox" value="1" id="js-friends" name="user-filter"/><label for="js-friends">'+(opt_data.bidirectionalGraph?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("profile.friends.filter.label"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("profile.connections.filter.label"),[])))+"</label>"+
(opt_data.activityType=="bookmark"?'<br/><input type="checkbox" value="2" id="js-only-notes" name="user-filter"/><label for="js-only-notes">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("bookmarks.sidebar.filter.notes"),[]))+"</label>":"")+"</nav>":"");jive.soy.acclaim.renderUserList({activityType:opt_data.activityType,users:opt_data.users,currentUserID:opt_data.youID,currentUserPartner:opt_data.youPartner,onlyFriends:false,id:"modal-liked-everyone",classNames:"liked-everyone-list js-everyone-list",
show:true},output);jive.soy.acclaim.renderUserList({activityType:opt_data.activityType,users:opt_data.users,currentUserID:opt_data.youID,currentUserPartner:opt_data.youPartner,onlyFriends:true,id:"modal-liked-friends",classNames:"liked-friends-list js-friends-list",show:false},output);if(opt_data.activityType=="bookmark"){jive.soy.acclaim.renderUserNotesList({activityType:opt_data.activityType,users:opt_data.users,currentUserID:opt_data.youID,currentUserPartner:opt_data.youPartner,onlyFriends:false,
onlyNotes:true,id:"modal-bookmark-notes",classNames:"j-user-bookmark-notes-list j-js-user-bookmark-notes-list",show:false},output);jive.soy.acclaim.renderUserNotesList({activityType:opt_data.activityType,users:opt_data.users,currentUserID:opt_data.youID,currentUserPartner:opt_data.youPartner,onlyFriends:true,onlyNotes:true,id:"modal-bookmark-friends-notes",classNames:"j-user-bookmark-notes-list j-js-user-bookmark-friends-notes-list",show:false},output)}output.append("</section></div>");return opt_sb?
"":output.toString()};
;
goog.provide("jive.soy.acclaim.privateBookmarkNotification");jive.soy.acclaim.privateBookmarkNotification=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<tr class="j-private-bookmark-notification j-js-private-bookmark-notification"><td colspan="3">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("acclaim.modal.privateBookmarks"),[])),"</td></tr>");return opt_sb?"":output.toString()};
;
goog.provide("jive.soy.acclaim.guestsWithSameQuestionNotShownNotification");jive.soy.acclaim.guestsWithSameQuestionNotShownNotification=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<tr class="j-private-bookmark-notification j-js-private-bookmark-notification"><td colspan="3">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("acclaim.modal.same_question.guests_not_shown"),[])),"</td></tr>");return opt_sb?"":output.toString()};
;
jive.namespace("Activity.Info");jive.Activity.Info.ActivityInfoView=jive.AbstractView.extend(function(a){var d=jQuery;function b(e){return e==="bookmark"}function c(e){return e==="same_question"}this.init=function(f){var e=this;this.$modal=null;this.pageSize=f.pageSize;this.soyParams={};this.renderModal=function(g){return $j(jive.soy.acclaim.renderAcclaimModal(g))};this.handleFollow=function(i){if(this.$modal){var h=this.$modal.find("table.js-everyone-list, table.js-friends-list"),g="tr[data-user-id="+i.id+"]";if(!h.eq(1).find(g).length){h.eq(0).find(g).clone().prependTo(h.eq(1).find("tbody"))}}};jive.switchboard.addListener("follow.user.complete",this.handleFollow.bind(this))};this.showUsers=function(e,j){var f=this,h={centered:true,destroyOnClose:true,closeFocusSelector:j.context,initialFocusSelector:".modal-initially-focused",onClose:function(){$j(".js-pop").remove()}};this.soyParams=a.buildSoyParams(e,j);this.$modal&&this.$modal.remove();var g=this.renderModal(this.soyParams);if(b(e.activityType)){var i=jive.soy.acclaim.privateBookmarkNotification();g.find("table.js-everyone-list tbody").each(function(){$j(this).append(i)})}else{if(c(e.activityType)){var i=jive.soy.acclaim.guestsWithSameQuestionNotShownNotification();g.find("table.js-everyone-list tbody").each(function(){$j(this).append(i)})}}this.$modal=g.lightbox_me(h);this.$modal.find("#jive-view-picker input:checkbox").click(function(){var k=$j("#jive-view-picker input:checked");var l=0;if(k.length==1){l=k.val()}else{if(k.length==2){l=3}}f.$modal.find("table").hide();f.$modal.find("table").eq(l).show()});this.$modal.find(".jive-modal-content").endlessScroll({fireDelay:false,callback:function(k){if(f.soyParams.moreResults){f.emitP("loadUsersFromIndex",j,f.pageSize*k).addCallback(function(l){f.soyParams.moreResults=l.moreResults;f.appendUsers(l)})}}})};this.appendUsers=function(f){var k=f&&f.items?f.items:[];if(k.length>0){this.$modal.find(".j-js-private-bookmark-notification").remove();var e=this.$modal.find(".jive-modal-content tbody:visible");var h=e.parent().attr("id");var i=this.renderModal($j.extend({},this.soyParams,{users:k}));var g=i.find("table#"+h+" tr");e.append(g.clone());if(b(this.soyParams.activityType)){var j=jive.soy.acclaim.privateBookmarkNotification();e.append(j)}else{if(c(this.soyParams.activityType)){var j=jive.soy.acclaim.guestsWithSameQuestionNotShownNotification();e.append(j)}}}};a.buildSoyParams=function(e,f){return{activityType:f.activityType,bidirectionalGraph:e.bidirectionalGraph,currentUserID:e.currentUserID,currentUserPartner:e.currentUserPartner,moreResults:e.moreResults,objectID:f.objectID,objectType:f.objectType,totalCount:e.totalCount,users:e.items,youID:f.youID||e.currentUserID,youPartner:f.youPartner||e.currentUserPartner}}});define("apps/browse/activity/info/views/activity_info_view",function(){return jive.Activity.Info.ActivityInfoView});
;
jive.namespace("Activity");define("apps/browse/activity/model/activity_source",["apps/shared/models/rest_service"],function(a){jive.Activity.ItemSource=a.extend(function(b){b.resourceType="activity";b.pluralizedResourceType=b.resourceType;this.getContentActivityUsers=function(e,f,d){var c={cache:false,data:{count:d,start:f},url:[this.RESOURCE_ENDPOINT,"users",e.activityType,e.objectType,e.objectID].join("/")};return this.commonAjaxRequest(new jive.conc.Promise(),"GET",c)}});return jive.Activity.ItemSource});
;
jive.namespace("Activity.Info");jive.Activity.Info.Main=jive.oo.Class.extend(function(a){this.init=function(){this.pageSize=20;this.source=new jive.Activity.ItemSource();this.view=new jive.Activity.Info.ActivityInfoView({pageSize:this.pageSize});var b=this;this.view.addListener("loadUsersFromIndex",function(e,d,c){b.source.getContentActivityUsers(e,d,b.pageSize).addCallback(function(f){c.emitSuccess(f)})})};this.showUsers=function(e,d){var b=this.view,c=new jive.conc.Promise();this.source.getContentActivityUsers(e,d,this.pageSize).addCallback(function(f){b.showUsers(f,e);c.emitSuccess($j.extend({totalCount:f.totalCount},e))}).addErrback(function(){c.emitError()});return c}});define("apps/browse/activity/info/main",function(){return jive.Activity.Info.Main});
;
if(!jive.acclaim){jive.acclaim=(function(d){var c=jive.conc.observable({}),b=new jive.Activity.Info.Main(),e={showBookmarks:"bookmark",showChildren:"children",showConnections:"connections",showFollowers:"follow",showAcclaim:"credit",showMembers:"membership",showExternalContributorMembers:"externalContributorsMembership"};require(["jive/dispatcher"],function(f){f.listen(Object.keys(e),function(h,g){h=d.extend({activityType:a(g,h)},h);delete h.count;delete h.command;var i=d.extend({objectID:h.objectId,context:this},h);delete i.objectId;c.emit("beforeFetch",h);b.showUsers(i,0).addCallback(function(j){c.emit("afterFetch",d.extend({totalCount:j.totalCount},h))}).addErrback(function(){c.emit("afterFetch",h)})})});function a(f,g){if(f=="showAcclaim"){return g.acclaimType}return e[f]}return c})(jQuery)};
;
goog.provide("jive.eae.acclaim.count");
jive.eae.acclaim.count=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;var countSlug__soy3=opt_data.count==null?0:opt_data.count;output.append("<a ",opt_data.id?'id="'+soy.$$escapeHtmlAttribute(opt_data.id)+'"':""," ",opt_data.classes?'class="'+soy.$$escapeHtmlAttribute(opt_data.classes)+'"':"",' data-command="',soy.$$escapeHtmlAttribute(opt_data.command),'"',opt_data.acclaimType?'data-acclaim-type="'+soy.$$escapeHtmlAttribute(opt_data.acclaimType)+'"':"",'data-object-id="',soy.$$escapeHtmlAttribute(opt_data.objectId),
'" data-object-type="',soy.$$escapeHtmlAttribute(opt_data.objectType),'" data-count="',soy.$$escapeHtmlAttribute(countSlug__soy3),'" href="#" role="link"',opt_data.accessibilityLinkLabel?'aria-label="'+soy.$$escapeHtmlAttribute(opt_data.accessibilityLinkLabel)+'" title="'+soy.$$escapeHtmlAttribute(opt_data.accessibilityLinkLabel)+'"':"",">",opt_data.text?soy.$$escapeHtml(opt_data.text):soy.$$escapeHtml(countSlug__soy3),"</a> ");return opt_sb?"":output.toString()};
;
goog.provide("jive.shared.soy.render");jive.shared.soy.render=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$filterNoAutoescape(jive.soy.func.eval(opt_data.templateName,opt_data.failGracefully,false,opt_data.data,output)));return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.storage.render_container_exstorage_info");
jive.integration.storage.render_container_exstorage_info=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<div>",opt_data.exStorageInfo.iconUrl?'<span class="jive-icon-med" style="margin-top: 3px"><img src="'+soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.exStorageInfo.iconUrl))+'" alt=""></span>':"","<span ",opt_data.exStorageInfo.iconUrl?' style="margin-left: -5px;" ':""," >");jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("external-storage.document.fileUpload.groupSelected"),
arg0:opt_data.exStorageInfo.externalUrl?'<a href="#" onclick="window.open(\''+soy.$$escapeHtml(opt_data.exStorageInfo.externalUrl)+"')\">"+soy.$$escapeHtml(opt_data.exStorageInfo.displayName)+"</a>":soy.$$escapeHtml(opt_data.exStorageInfo.displayName),arg1:opt_data.exStorageInfo.externalUrl?'<a href="#" onclick="window.open(\''+soy.$$escapeHtml(opt_data.exStorageInfo.externalUrl)+"')\">"+soy.$$escapeHtml(opt_data.exStorageInfo.displayName)+"</a>":soy.$$escapeHtml(opt_data.exStorageInfo.displayName),
noAutoEscape:"true"},output);output.append("</span></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.publishbar.placeView");
jive.publishbar.placeView=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<section ",opt_data.placeChangeable?"":'style="display:none;"','><input type="hidden" id="',opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"",'j-publishbar-place-type" name="publishBar.container.objectType" value="',soy.$$escapeHtml(opt_data.type),'" /><input type="hidden" id="',opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"",'j-publishbar-place-id" name="publishBar.container.objectID" value="',
soy.$$escapeHtml(opt_data.id),'"/><div class="j-place-info clearfix" data-object-type="',soy.$$escapeHtml(opt_data.type),'" data-object-id="',soy.$$escapeHtml(opt_data.id),'">',opt_data.preInputNameKey&&opt_data.preInputNameKey!=""?'<label for="'+(opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"")+'js-publishbar-place-input">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey(opt_data.preInputNameKey)),[]))+"</label>":"","  <div>");if(!opt_data.placeRenderType||opt_data.placeRenderType==
"standard"){output.append('<span class="',soy.$$escapeHtml(opt_data.iconCss),' jive-icon-med"></span>',opt_data.prop.placeImage&&opt_data.prop.placeImage.urlMedium?'<img src="'+soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.prop.placeImage.urlMedium))+'" alt="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.image"),[]))+'" width="60"/>':"",'<div class="j-place-view-info j-js-place-view-info"><strong><span class="js-header-text">',soy.$$escapeHtml(opt_data.subject),
"</span></strong>  ",opt_data.prop.perms.allowedToMove?'<a href="#" id="'+(opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"")+'js-publishbar-changePlace" class="font-color-meta">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.change"),[]))+' <span class="j-508-label" aria-hidden="true">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("we.form.no.place.selected"),[]))+"</span></a>":"",opt_data.prop.parentInfo?'<p class="j-browse-content-location font-color-meta-light">'+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.in"),[]))+' <a href="'+soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.prop.parentInfo.link))+'" class="font-color-meta-light jivecontainerTT-hover-container" data-objectId="'+soy.$$escapeHtml(opt_data.prop.parentInfo.id)+'" data-objectType="'+soy.$$escapeHtml(opt_data.prop.parentInfo.type)+'" target="_blank">'+soy.$$escapeHtml(opt_data.prop.parentInfo.subject)+"</a></p>":"",opt_data.prop.socialGroupInfo||
opt_data.prop.isVisibleToPartner?'<p class="j-browse-content-location font-color-meta-light">'+(opt_data.prop.socialGroupInfo?"<span class=\"jive-icon-sml role='img' jive-icon-group-"+soy.$$escapeHtml(opt_data.prop.socialGroupInfo.typeName)+'-glyph" title="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("browse.info.sgroup."+opt_data.prop.socialGroupInfo.typeName)),[]))+'"></span>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("browse.info.sgroup."+
opt_data.prop.socialGroupInfo.typeName)),[])):"")+(opt_data.prop.socialGroupInfo&&opt_data.prop.isVisibleToPartner?", ":"")+(opt_data.prop.isVisibleToPartner?'<span class="font-color-meta-light j-browse-external-access"> <em>('+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("partner.browse.ext_access"),[]))+")</em></span>":"")+"</p>":"");if(opt_data.prop.placeCustom)jive.shared.soy.render({templateName:opt_data.prop.placeCustom.templateName,data:function(){var map={};var pairs=[["props",opt_data.prop.placeCustom.props]];
for(var i=0;i<pairs.length;i+=1)map[pairs[i][0]]=pairs[i][1];return map}(),failGracefully:false},output);if(opt_data.showExStorageInfo&&opt_data.prop.exStorageInfo)jive.integration.storage.render_container_exstorage_info({exStorageInfo:opt_data.prop.exStorageInfo},output);output.append('<p class="j-publish-bar-acclaim-container j-js-publish-bar-acclaim-container">');if(opt_data.prop.followInfo){var param126=new soy.StringBuilder;jive.shared.soy.getCountTextByType({count:opt_data.prop.followInfo&&
opt_data.prop.followInfo.numFollowers?soy.$$escapeHtml(opt_data.prop.followInfo.numFollowers):"0",type:"showfollowcount"},param126);jive.eae.acclaim.count({command:"showFollowers",count:opt_data.prop.followInfo&&opt_data.prop.followInfo.numFollowers?soy.$$escapeHtml(opt_data.prop.followInfo.numFollowers):"0",objectId:opt_data.id,objectType:opt_data.type,text:opt_data.prop.followInfo&&opt_data.prop.followInfo.numFollowers?opt_data.prop.followInfo.numFollowers==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.followers.singular"),
[opt_data.prop.followInfo.numFollowers])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.followers.plural"),[opt_data.prop.followInfo.numFollowers])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.followers.plural"),[0])),accessibilityLinkLabel:param126.toString()},output)}output.append("<br/>");if(opt_data.prop.socialGroupInfo){var param160=new soy.StringBuilder;jive.shared.soy.getCountTextByType({count:opt_data.prop.socialGroupInfo?soy.$$escapeHtml(opt_data.prop.socialGroupInfo.numMembers):
"0",type:"showmembercount"},param160);jive.eae.acclaim.count({command:"showMembers",count:opt_data.prop.socialGroupInfo?soy.$$escapeHtml(opt_data.prop.socialGroupInfo.numMembers):"0",objectId:opt_data.id,objectType:opt_data.type,text:(opt_data.prop.socialGroupInfo&&opt_data.prop.socialGroupInfo.numMembers?soy.$$escapeHtml(opt_data.prop.socialGroupInfo.numMembers):"0")+" "+(opt_data.prop.socialGroupInfo.numMembers==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.members.singular"),
[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.members.plural"),[]))),accessibilityLinkLabel:param160.toString()},output);output.append(" (");var param186=new soy.StringBuilder;jive.shared.soy.getCountTextByType({count:opt_data.prop.socialGroupInfo?soy.$$escapeHtml(opt_data.prop.socialGroupInfo.numMembers):"0",type:"showmembercount"},param186);jive.eae.acclaim.count({command:"showExternalContributorMembers",count:opt_data.prop.socialGroupInfo?soy.$$escapeHtml(opt_data.prop.socialGroupInfo.numPartners):
"0",objectId:opt_data.id,objectType:opt_data.type,text:opt_data.prop.socialGroupInfo.numPartners==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.membercount.externalcontributors.singular"),[opt_data.prop.socialGroupInfo.numPartners])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.membercount.externalcontributors.plural"),[opt_data.prop.socialGroupInfo.numPartners])),accessibilityLinkLabel:param186.toString()},output);output.append(")")}output.append("</p></div>")}else output.append(opt_data.iconCss?
'<span class="'+soy.$$escapeHtml(opt_data.iconCss)+' jive-icon-med"></span>':"","<div><strong>",opt_data.preInputNameKey&&opt_data.preInputNameKey!=""?'<span class="j-508-label">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey(opt_data.preInputNameKey)),[]))+"</span>":"",'<span class="js-header-text" tabindex="0">',soy.$$escapeHtml(opt_data.subject),"</span></strong></div>",opt_data.prop.isVisibleToPartner?' <span class="font-color-meta-light j-browse-external-access"> <em>('+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("partner.browse.ext_access"),[]))+")</em></span>":"","  ",opt_data.prop.perms.allowedToMove?'<a href="#" id="'+(opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"")+'js-publishbar-changePlace" class="font-color-meta">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.change"),[]))+' <span class="j-508-label">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("we.form.no.place.selected"),[]))+"</span></a>":"");output.append("</div></div></section>");
return opt_sb?"":output.toString()};
;
goog.provide("jive.tags.autocomplete.tags");
jive.tags.autocomplete.tags=function(opt_data,opt_sb){opt_data=opt_data||{};var output=opt_sb||new soy.StringBuilder;output.append('<div id="',opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"",' jive-compose-tags-form" class="j-tag-form"><label for="js-tag-input',opt_data.identifier?" "+soy.$$escapeHtml(opt_data.identifier):"",'j">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("publishbar.tags.title"),[])),' <span class="font-color-meta">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("publishbar.tags.desc"),
[])),"</span></label>");jive.tags.autocomplete.tagInput(opt_data,output);output.append("</div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.publishbar.tagSets");
jive.publishbar.tagSets=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.placeCategories&&opt_data.placeCategories.length>0){output.append('<div id="',opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"",'js-publishbar-tagsets"><input type="hidden" name="publishBar.categories" id="',opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"",'j-publishbar-categories" value="" /><div id="jive-compose-categories" class="clearfix" role="group"><label></span>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.categories"),
[])),'<span class="font-color-meta">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("category.create-content.text"),[])),"</span></label><table><tr><td>");var placeCategoryList18=opt_data.placeCategories;var placeCategoryListLen18=placeCategoryList18.length;for(var placeCategoryIndex18=0;placeCategoryIndex18<placeCategoryListLen18;placeCategoryIndex18++){var placeCategoryData18=placeCategoryList18[placeCategoryIndex18];output.append(!(placeCategoryIndex18==0)&&placeCategoryIndex18%opt_data.categoriesPerColumn==
0?"</td><td>":"",'<div><span class="jive-category-wrap"><input type="checkbox" id="',opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"","j-category_",soy.$$escapeHtml(placeCategoryData18.id),'" class="j-category-input" value="',soy.$$escapeHtml(placeCategoryData18.id),'" ',opt_data.categories&&opt_data.categories.indexOf(placeCategoryData18.id)>-1?'checked="checked"':"",' data-tags="');var tagList35=placeCategoryData18.tags;var tagListLen35=tagList35.length;for(var tagIndex35=0;tagIndex35<
tagListLen35;tagIndex35++){var tagData35=tagList35[tagIndex35];output.append(soy.$$escapeHtml(tagData35),!(tagIndex35==tagListLen35-1)?", ":"")}output.append('" role="checkbox" /><label for="j-category_',soy.$$escapeHtml(placeCategoryData18.id),'" class="font-color-normal"><i class="jive-icon-glyph icon-categories"></i><span class="j-catname">',soy.$$escapeHtml(placeCategoryData18.name),"</span></label></span></div>")}output.append('</td></tr></table></div><content tag="jiveTooltip"><div id="jiveTT-note-suggest" class="jive-tooltip-help notedefault snp-mouseoffset"><div id="jive-note-category-suggestion-body"><strong>',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("category.create-content.suggested.text"),[])),"</strong><p>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("category.publishbar.related-tags.tooltip"),[])),'&nbsp;<strong id="jive-note-category-tags"></strong></p></div></div></content></div>')}return opt_sb?"":output.toString()};
;
goog.provide("jive.publishbar.organize");jive.publishbar.organize=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.showTags){jive.tags.autocomplete.tags(opt_data,output);if(opt_data.showCategories)jive.publishbar.tagSets(opt_data,output)}return opt_sb?"":output.toString()};
;
goog.provide("jive.publishbar.authorPolicyOption");
jive.publishbar.authorPolicyOption=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<li ",opt_data.hidden?'style="display: none;"':"",'><input type="radio" id="',opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"","js-publishbar-docAuthorPolicy-",soy.$$escapeHtml(opt_data.value),'" name="publishBar.authorPolicy" value="',soy.$$escapeHtml(opt_data.value),'" ',opt_data.hidden?'disabled="disabled" ':"",opt_data.selected?'checked="checked"':"",' role="radio"/><label for="',
opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"","js-publishbar-docAuthorPolicy-",soy.$$escapeHtml(opt_data.value),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey(opt_data.nameKey)),[])),"</label></li>");return opt_sb?"":output.toString()};
;
goog.provide("jive.publishbar.documentAuthors");
jive.publishbar.documentAuthors=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<li class="j-rc5"><input type="checkbox" name="publishBar.docAuthorsOption" id="',opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"",'js-publishbar-docAuthorsOption" ',!opt_data.defaultAuthorPolicySelected||opt_data.forceAuthorList?' checked="checked"':"",' role="checkbox" value="true"/><input type="hidden" name="publishBar.defaultAuthorshipPolicy" id="',opt_data.identifier?
soy.$$escapeHtml(opt_data.identifier):"",'js-publishbar-docDefaultAuthorshipPolicy"  value="',soy.$$escapeHtml(opt_data.defaultAuthorPolicy),'"/><label for="',opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"",'js-publishbar-docAuthorsOption">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey(opt_data.authorPolicyNameKey)),[])),' <span class="font-color-meta">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey(opt_data.authorPolicyDescriptionKey)),
[])),'</span></label><div id="',opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"",'js-publishbar-docAuthorDetails" class="j-advanced-details"><ul role="radiogroup">');var authorPolicyOptionList30=opt_data.authorPolicyOptions;var authorPolicyOptionListLen30=authorPolicyOptionList30.length;for(var authorPolicyOptionIndex30=0;authorPolicyOptionIndex30<authorPolicyOptionListLen30;authorPolicyOptionIndex30++){var authorPolicyOptionData30=authorPolicyOptionList30[authorPolicyOptionIndex30];jive.publishbar.authorPolicyOption(soy.$$augmentMap(authorPolicyOptionData30,
{selected:opt_data.authorPolicy==authorPolicyOptionData30.value,identifier:opt_data.identifier}),output)}output.append('</ul><div id="',opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"",'js-publishbar-docAuthors-multiple" class="j-publishbar-people-block" ',!opt_data.authorPolicyMultiple?'style="display:none;"':"",'><label for="',opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"",'js-publishbar-docAuthors" class="j-508-label">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("publishbar.authorPolicy.multiple.selected"),
[])),'</label><input type="text" id="',opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"",'js-publishbar-docAuthors" name="publishBar.authors" class="j-autocomplete-input j-user-autocomplete j-ui-elem" role="combobox"/></div></div></li>');return opt_sb?"":output.toString()};
;
goog.provide("jive.publishbar.documentApprovers");
jive.publishbar.documentApprovers=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<li class="j-rc5"><div class="clearfix"><input type="checkbox" name="publishBar.docApproversOption" id="',opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"",'js-publishbar-docApproversOption" ',opt_data.approvers&&opt_data.approvers.length>0?'checked="checked"':"",' role="checkbox" /><label for="',opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"",'js-publishbar-docApproversOption">',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("publishbar.approvers.toggle"),[])),'</label></div><div id="',opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"",'js-publishbar-docApproversDetails" class="j-publishbar-people-block" ',!(opt_data.approvers&&opt_data.approvers.length>0)?'style="display: none;"':"",">");if(opt_data.placeApprovers&&opt_data.placeApprovers.length>0){output.append('<div class="j-place-approvers"><span>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("doc.collab.approvers.label"),
[])),'</span><div class="jive-chooser-list j-result-list"><ul class="clearfix">');var placeApproverList31=opt_data.placeApprovers;var placeApproverListLen31=placeApproverList31.length;for(var placeApproverIndex31=0;placeApproverIndex31<placeApproverListLen31;placeApproverIndex31++){var placeApproverData31=placeApproverList31[placeApproverIndex31];output.append("<li>");jive.shared.displayutil.userDisplayNameLink(placeApproverData31,output);output.append("</li>")}output.append('</ul></div></div><label for="',
opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"",'js-publishbar-docApprovers">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("publishbar.additional.approvers"),[])),"</label><br/>")}output.append('<input type="text" id="',opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"",'js-publishbar-docApprovers" name="publishBar.approvers" class="j-autocomplete-input j-user-autocomplete j-ui-elem" role="combobox" aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("publishbar.additional.approvers"),
[])),'"/></div></li>');return opt_sb?"":output.toString()};
;
goog.provide("jive.publishbar.commentOption");
jive.publishbar.commentOption=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<li ",opt_data.hidden?'style="display: none;"':"",'><input type="radio" id="',opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"","js-publishbar-",soy.$$escapeHtml(opt_data.id),'" name="publishBar.commentStatus" value="',soy.$$escapeHtml(opt_data.value),'"',opt_data.selected?'checked="checked"':"",' role="radio" /><label for="',opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):
"","js-publishbar-",soy.$$escapeHtml(opt_data.id),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey(opt_data.nameKey)),[])),"</label></li>");return opt_sb?"":output.toString()};
;
goog.provide("jive.publishbar.commentOptions");
jive.publishbar.commentOptions=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<li class="j-rc5"><input type="checkbox" name="publishBar.commentOption" id="',opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"",'js-publishbar-commentOption" ',opt_data.restrictComments?'checked="checked"':"",' role="checkbox" /><label for="',opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"",'js-publishbar-commentOption">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("publishbar.commentoptions.toggle"),
[])),'</label><div id="',opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"",'js-publishbar-commentOptionDetails" class="j-advanced-details" ',!opt_data.showAdditionalCommentOptions||!opt_data.restrictComments?'style="display: none;"':"",'><ul role="radiogroup">');var commentStatusOptionList26=opt_data.commentStatusOptions;var commentStatusOptionListLen26=commentStatusOptionList26.length;for(var commentStatusOptionIndex26=0;commentStatusOptionIndex26<commentStatusOptionListLen26;commentStatusOptionIndex26++){var commentStatusOptionData26=
commentStatusOptionList26[commentStatusOptionIndex26];jive.publishbar.commentOption(soy.$$augmentMap(commentStatusOptionData26,{selected:opt_data.commentStatus==commentStatusOptionData26.value,identifier:opt_data.identifier}),output)}output.append("</ul></div></li>");return opt_sb?"":output.toString()};
;
goog.provide("jive.publishbar.blogPostPublishDate");
jive.publishbar.blogPostPublishDate=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<li class="j-rc5"><input type="checkbox" name="publishBar.blogPublishOption" id="',opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"","js-publishbar-blogPublishOption\" value='true' ",opt_data.selectedDate?'checked="checked"':"",' role="checkbox" /><label for="',opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"",'js-publishbar-blogPublishOption">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("publishbar.blogpost.date.toggle"),
[])),'</label><div id="',opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"",'js-publishbar-blogPublishDetails" ',!opt_data.selectedDate?'style="display: none;"':"",'><span class="publishAtDateTimePicker"/><input type="text" id="',opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"",'publishDate" name="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("publishBar.publishDate.selectedDate"),[])),'" aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.date"),
[])),'" class="j-time-picker j-form-datepicker" autocomplete="off" value="" required /></span> ');jive.shared.soy.resourceInlineJs({code:"jQuery(document).ready(function() {define(['apps/shared/views/date_picker_view'], function(DatePickerView) {var datePicker = new DatePickerView({ locale: \""+soy.$$escapeHtml(opt_data.locale)+"\" }); datePicker.addDatePicker('#"+(opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"")+"publishDate');});});"},output);output.append('<select name="publishBar.publishDate.selectedHour" aria-label="',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.hour"),[])),'">');if(true==opt_data.is24HrTime)for(var hour48=0;hour48<24;hour48++)output.append('<option value="',soy.$$escapeHtml(hour48),'"',hour48==opt_data.selectedHour?' selected="true"':"",">",soy.$$escapeHtml(hour48),"</option>");else for(var hour59=1;hour59<13;hour59++)output.append('<option value="',soy.$$escapeHtml(hour59),'"',hour59==opt_data.selectedHour?' selected="true"':"",">",soy.$$escapeHtml(hour59),"</option>");output.append('</select><select name="publishBar.publishDate.selectedMinute" aria-label="',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.minute"),[])),'">');for(var minute72=0;minute72<60;minute72++)output.append('<option value="',soy.$$escapeHtml(minute72),'"',minute72==opt_data.selectedMinute?' selected="true"':"",">",minute72<10?"0":"",soy.$$escapeHtml(minute72),"</option>");output.append("</select>");if(true!=opt_data.is24HrTime){output.append('<select name="publishBar.publishDate.selectedPeriod" aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.period"),
[])),'">');var periodList91=opt_data.periods;var periodListLen91=periodList91.length;for(var periodIndex91=0;periodIndex91<periodListLen91;periodIndex91++){var periodData91=periodList91[periodIndex91];output.append('<option value="',soy.$$escapeHtml(periodData91),'"',periodData91==opt_data.selectedPeriod?' selected="true"':"",">",soy.$$escapeHtml(periodData91),"</option>")}output.append("</select>")}output.append("</li>");return opt_sb?"":output.toString()};
;
goog.provide("jive.polls.voteStartImmediatelyOption");
jive.polls.voteStartImmediatelyOption=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<li><input type="radio" name="activeMode" value="',soy.$$escapeHtml(opt_data.optionBean.value),'" id="',soy.$$escapeHtml(opt_data.optionBean.id),'"',opt_data.optionBean.id==opt_data.activeBean.id?' checked="checked" ':"",' /><label for="',soy.$$escapeHtml(opt_data.optionBean.id),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("polls.voting_startnow.label"),[])),"</label></li>");
return opt_sb?"":output.toString()};
;
goog.provide("jive.polls.voteStartLaterOption");
jive.polls.voteStartLaterOption=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<li><input type="radio" name="activeMode" value="',soy.$$escapeHtml(opt_data.optionBean.value),'" id="',soy.$$escapeHtml(opt_data.optionBean.id),'"',opt_data.optionBean.id==opt_data.activeBean.id?' checked="checked" ':"",' /><label for="',soy.$$escapeHtml(opt_data.optionBean.id),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("polls.voting_startlater.label"),[])),' </label><span class="activeDatePicker" ',
opt_data.optionBean.id!=opt_data.activeBean.id?'style="display:none;"':"",">");jive.shared.form.datepicker({id:"activeDate",name:"activeDate",value:opt_data.optionBean.date?opt_data.optionBean.date:"",initialize:false,futureOnly:true},output);if(opt_data.optionBean.date)jive.shared.soy.resourceInlineJs({code:'$j(function() {$j("#activeDate").attr("value", "'+soy.$$escapeHtml(opt_data.optionBean.date)+'");});'},output);output.append("</span></li>");return opt_sb?"":output.toString()};
;
goog.provide("jive.polls.voteStart");
jive.polls.voteStart=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div id="jive-poll-active" class="j-form-row jive-poll-exp clearfix"><label>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("polls.voting_starts.label"),[])),'<span class="font-color-meta">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("polls.voting_starts.desc"),[])),"</span></label><ul>");var optionList8=opt_data.voteStartOptions;var optionListLen8=optionList8.length;for(var optionIndex8=
0;optionIndex8<optionListLen8;optionIndex8++){var optionData8=optionList8[optionIndex8];jive.shared.soy.render({templateName:optionData8.optionTemplate,data:function(){var map={};var pairs=[["optionBean",optionData8.id==opt_data.voteStartBean.id?opt_data.voteStartBean:optionData8],["activeBean",opt_data.voteStartBean]];for(var i=0;i<pairs.length;i+=1)map[pairs[i][0]]=pairs[i][1];return map}(),failGracefully:false},output)}output.append("</ul></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.polls.voteEndsNowOption");
jive.polls.voteEndsNowOption=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<li><input type="radio" name="endsMode" value="',soy.$$escapeHtml(opt_data.optionBean.value),'" id="',soy.$$escapeHtml(opt_data.optionBean.id),'"',opt_data.optionBean.id==opt_data.activeBean.id?' checked="checked" ':"",' /><label for="',soy.$$escapeHtml(opt_data.optionBean.id),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("polls.poll_ends_now.radio"),[])),'<span class="font-color-meta">',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("polls.poll_ends_now.desc"),[])),"</span></label></li>");return opt_sb?"":output.toString()};
;
goog.provide("jive.polls.voteEndsNeverOption");
jive.polls.voteEndsNeverOption=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<li><input type="radio" name="endsMode" value="',soy.$$escapeHtml(opt_data.optionBean.value),'" id="',soy.$$escapeHtml(opt_data.optionBean.id),'"',opt_data.optionBean.id==opt_data.activeBean.id?' checked="checked" ':"",' /><label for="',soy.$$escapeHtml(opt_data.optionBean.id),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("polls.poll_never_ends.radio"),[])),"</label></li>");
return opt_sb?"":output.toString()};
;
goog.provide("jive.polls.voteEndsRelativeOption");
jive.polls.voteEndsRelativeOption=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<li><input type="radio" name="endsMode" value="',soy.$$escapeHtml(opt_data.optionBean.value),'" id="',soy.$$escapeHtml(opt_data.optionBean.id),'" aria-labelledby="',soy.$$escapeHtml(opt_data.optionBean.id),'-label"',opt_data.optionBean.id==opt_data.activeBean.id?' checked="checked" ':"",' /><label id="',soy.$$escapeHtml(opt_data.optionBean.id),'-label">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("polls.endPollOnRelative.label"),
[new soydata.VERY_UNSAFE.ordainSanitizedHtml('<input type="text" name="endsDays" id="endsDays" size="3" value="14" class="autoWidth"/>')])),"</label></li>");return opt_sb?"":output.toString()};
;
goog.provide("jive.polls.voteEndsLaterOption");
jive.polls.voteEndsLaterOption=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<li><input type="radio" name="endsMode" value="',soy.$$escapeHtml(opt_data.optionBean.value),'" id="',soy.$$escapeHtml(opt_data.optionBean.id),'"',opt_data.optionBean.id==opt_data.activeBean.id?' checked="checked" ':"",' /><label for="',soy.$$escapeHtml(opt_data.optionBean.id),'" id="endLatr">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("polls.endPollOnSpecificDy.radio"),[])),
' </label><span class="expiresDatePicker" ',opt_data.optionBean.id!=opt_data.activeBean.id?'style="display:none;"':"",">");jive.shared.form.datepicker({id:"endsDate",name:"endsDate",value:"",initialize:false},output);if(opt_data.optionBean.date)jive.shared.soy.resourceInlineJs({code:'$j(function() {$j("#endsDate").attr("value", "'+soy.$$escapeHtml(opt_data.optionBean.date)+'");});'},output);output.append("</span></li>");return opt_sb?"":output.toString()};
;
goog.provide("jive.polls.voteEnd");
jive.polls.voteEnd=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div id="jive-poll-end" class="j-form-row jive-poll-exp clearfix"><label>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("polls.voting_ends.label"),[])),'<span class="font-color-meta">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("polls.voting_ends.desc"),[])),"</span></label><ul>");var optionList8=opt_data.voteEndOptions;var optionListLen8=optionList8.length;for(var optionIndex8=0;optionIndex8<
optionListLen8;optionIndex8++){var optionData8=optionList8[optionIndex8];jive.shared.soy.render({templateName:optionData8.optionTemplate,data:function(){var map={};var pairs=[["optionBean",optionData8.id==opt_data.voteEndBean.id?opt_data.voteEndBean:optionData8],["activeBean",opt_data.voteEndBean]];for(var i=0;i<pairs.length;i+=1)map[pairs[i][0]]=pairs[i][1];return map}(),failGracefully:false},output)}output.append("</ul></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.publishbar.pollOptions");
jive.publishbar.pollOptions=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<li class="j-rc5"><input type="checkbox" name="publishBar.pollVoteOptions" id="',opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"",'js-publishbar-pollVoteOptions" value="true" ',!opt_data.defaultOptions?'checked="checked"':"",' role="checkbox" /><label for="',opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"",'js-publishbar-pollVoteOptions">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("publishbar.polls.toggle"),
[])),'</label><div id="',opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"",'js-publishbar-pollVoteDetails" ',opt_data.defaultOptions?'style="display: none;"':"",">");jive.polls.voteStart(opt_data,output);jive.polls.voteEnd({voteEndOptions:opt_data.voteEndsOptions,voteEndBean:opt_data.voteEndsBean},output);output.append("</div></li>");return opt_sb?"":output.toString()};
;
goog.provide("jive.publishbar.collaborationOptions");
jive.publishbar.collaborationOptions=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.showOptionsLink){output.append('<label><a href="#" id="',opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"",'js-publishbar-collab-link">',opt_data.expandAdvancedOptions?'<span class="jive-icon-glyph icon-arrow-down2"></span>':'<span class="jive-icon-glyph icon-arrow-right2"></span>',"<strong>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("publishbar.collaboptions.link"),[])),
'</strong></a></label><ul class="j-advanced-options" id="',opt_data.identifier?soy.$$escapeHtml(opt_data.identifier):"",'js-publishbar-collab"',!opt_data.expandAdvancedOptions?' style="display: none;"':"",' role="group" >');if(opt_data.showAuthors){jive.publishbar.documentAuthors(soy.$$augmentMap(opt_data.authorsBean,{identifier:opt_data.identifier}),output);if(opt_data.showApprovers)jive.publishbar.documentApprovers(soy.$$augmentMap(opt_data.approversBean,{identifier:opt_data.identifier}),output)}if(opt_data.showCommentOptions)jive.publishbar.commentOptions(soy.$$augmentMap(opt_data.commentOptionsBean,
{identifier:opt_data.identifier}),output);if(opt_data.showBlogPostPublishDate)jive.publishbar.blogPostPublishDate(soy.$$augmentMap(opt_data.blogPostPublishDateBean,{identifier:opt_data.identifier}),output);if(opt_data.showPollOptions)jive.publishbar.pollOptions(soy.$$augmentMap(opt_data.pollOptionsBean,{identifier:opt_data.identifier}),output);output.append("</ul>")}return opt_sb?"":output.toString()};
;
goog.provide("jive.publishbar.guestInvited");jive.publishbar.guestInvited=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-tips">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("publishbar.guest.invited"),[])),"</div>");return opt_sb?"":output.toString()};
;
function PublishBarTagSetSupport(b,e,a,d){var c=this;this.tagInput=$j(b);this.categoriesId=e;this.identifier=a;this.tagSets=[];this.suggestCategories=function(f){if(this.tagSets.length>0){if(!f){f=this.tagInput.val().toLowerCase().split(",")}$j(this.tagSets).each(function(){var g=this;var h=g.tags;var i=true;$j(f).each(function(j,k){if($j.trim(k)!=""){if($j.inArray(k,h)!=-1){i=false;return false}}});if(i){c.undoHighlight($j("#"+(c.identifier||"")+"j-category_"+g.id))}else{c.doHighlight($j("#"+(c.identifier||"")+"j-category_"+g.id))}})}};this.doHighlight=function(f){$j(f).closest("span").find("img").show();$j(f).closest("span").addClass("jive-category-highlight")};this.undoHighlight=function(f){$j(f).closest("span").removeClass("jive-category-highlight");$j(f).closest("span").find("label").find("img").hide()};this.updateTagSets=function(){var f=[];$j("#jive-compose-categories").find(".j-category-input").each(function(){var g=$j(this);if(g.prop("checked")){f.push(g.val())}});$j("#"+this.categoriesId).val(f.join(","))};$j("#jive-compose-categories").find(".j-category-input").each(function(){c.tagSets.push({id:$j(this).val(),tags:_.map($j(this).attr("data-tags").split(","),function(f){return f.trim()})})});$j("#jive-compose-categories").find(".j-category-input").click(function(){c.updateTagSets()});this.suggestCategories();this.updateTagSets();$j("#jive-compose-categories img.tooltip").tooltip({of:$j("#jive-compose-categories img.tooltip"),position:"left top",at:"right top",collision:"none flip"}).on("show",function(g){$j("p#tooltip").css({"z-index":100});var f=$j(this).closest("span").find("input").data("tags");$j(g.relatedTarget).find("#jive-note-category-tags").html(f)})};
;
goog.provide("jive.publishbar.containerLink");
jive.publishbar.containerLink=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.writableByUser?'<a href="#" data-objecttype="'+soy.$$escapeHtml(opt_data.type)+'" data-objectid="'+soy.$$escapeHtml(opt_data.id)+'" class="'+(opt_data.extraCssClass?soy.$$escapeHtml(opt_data.extraCssClass):"")+" js-target-container"+(opt_data.props&&opt_data.props.isVisibleToPartner?" j-external-access":"")+'">':'<span class="j-place-unavailable">',opt_data.noIcon?"":'<span class="'+
(opt_data.writableByUser?soy.$$escapeHtml(opt_data.iconCss)+" jive-icon-"+(opt_data.iconSize?soy.$$escapeHtml(opt_data.iconSize):"med"):"jive-icon-sml jive-icon-place-unavailable")+'"></span>','<span class="',!opt_data.writableByUser?"jive-container-unavailable-text":"lnk"," js-container-title ",opt_data.overrideNameCssClass?soy.$$escapeHtml(opt_data.overrideNameCssClass):"",'" ',!opt_data.writableByUser?'title="'+(opt_data.type==2020?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.picker.usercontainer.unavailable"),
[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.picker.unavailable"),[])))+'"':"",">",soy.$$escapeHtml(opt_data.subject),"</span>",opt_data.props&&opt_data.props.isVisibleToPartner?'<span class="jive-icon-med jive-icon-partner" title="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("partner.browse.ext_access"),[]))+'"></span>':"",opt_data.writableByUser?"</a>":"</span>",opt_data.caption?' <span class="j-container-caption font-color-meta">'+soy.$$escapeHtml(opt_data.caption)+
"</span>":"");return opt_sb?"":output.toString()};
;
goog.provide("jive.publishbar.containerList");
jive.publishbar.containerList=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-places-list"><ul class="j-autocomplete-results j-icon-list" role="listbox">');var containerList4=opt_data.containers;var containerListLen4=containerList4.length;if(containerListLen4>0)for(var containerIndex4=0;containerIndex4<containerListLen4;containerIndex4++){var containerData4=containerList4[containerIndex4];output.append('<li role="option">');jive.publishbar.containerLink(soy.$$augmentMap(containerData4,
{contentType:opt_data.contentType,iconSize:"med",upload:opt_data.upload,writableByUser:containerData4.prop&&containerData4.prop.perms&&containerData4.prop.perms.allowedToContribute&&containerData4.prop.perms.allowedToMove,props:containerData4.prop}),output);output.append("</li>")}else output.append(!opt_data.renderType||opt_data.renderType=="standard"?'<li role="option">'+(opt_data.emptyKey?'<p class="font-color-meta j-empty">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey(opt_data.emptyKey)),
[]))+"</p>":'<p class="font-color-meta j-empty">'+(opt_data.communityFeatureVisible?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("publishbar.place.search.noresults"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("publishbar.group.search.noresults"),[])))+"</p>")+"</li>":"");if(opt_data.renderType&&opt_data.renderType=="quick"){if(opt_data.showCommunityOption){output.append('<li role="option">');jive.publishbar.containerLink({subject:soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("publishbar.option.all"),
[opt_data.communityName])),type:opt_data.userContainerDescriptor.objectType,id:opt_data.userContainerDescriptor.id,iconCss:"",iconSize:"",noIcon:true,writableByUser:true,overrideNameCssClass:"js-container-title-override"},output);output.append("</li>")}output.append('<li role="option">');jive.publishbar.containerLink({subject:soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("publishbar.place.suggested.browse"),[])),type:-1,id:-1,iconCss:"",iconSize:"",noIcon:true,extraCssClass:"suggestBrowseAllPlaces",
writableByUser:true},output);output.append("</li>")}output.append("</ul></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.publishbar.placeSearchResults");
jive.publishbar.placeSearchResults=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-pop-main j-menu j-quick-menu">');if(opt_data.suggested&&opt_data.containers.length==0&&opt_data.renderType=="standard")output.append(!opt_data.renderType||opt_data.renderType=="standard"?'<div class="j-actions"><strong>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("publishbar.place.suggested.results"),[]))+"</strong></div>"+(opt_data.communityFeatureVisible?'<p class="j-noresults">'+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("publishbar.place.suggested.noresults"),[]))+"</p>":'<p class="j-noresults">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("publishbar.group.suggested.noresults"),[]))+"</p>"):"");else{output.append(!opt_data.renderType||opt_data.renderType=="standard"?'<p class="j-actions">'+(opt_data.suggested?opt_data.communityFeatureVisible?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("publishbar.place.suggested.results"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("publishbar.group.suggested.results"),
[])):opt_data.communityFeatureVisible?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("publishbar.place.search.results"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("publishbar.group.search.results"),[])))+"</p>":"");jive.publishbar.containerList(opt_data,output)}output.append("</div>");return opt_sb?"":output.toString()};
;
jive.namespace("PublishBar");jive.PublishBar.PlaceView=jive.oo.Class.extend(function(a){jive.conc.observable(this);this.init=function(d,e,h,f,c){var b=this;this.$input=$j(d);this.$browse=$j(h);this.$input.suggestBox({typeAheadOptions:{itemSelector:"li:visible:has('a')"},queryFunc:function g(i){if(!i||i.trim()==""){return b.emitP("suggest")}else{return b.emitP("search",i)}},processResults:function(l,k,j){var i=!j||j.trim()=="";return $j.extend({suggested:i,communityFeatureVisible:jive.global.communityFeatureVisible},l)},template:function(i){return jive.publishbar.placeSearchResults($j.extend({renderType:f,showCommunityOption:c},i))},displayEmptySearch:true,popoverOptions:{flip:false,addClass:"j-autocomplete j-placePicker"}}).on("selectionChosen",function(k,j,i){i=i.find("a");b.selectPlace(i.data("objecttype"),i.data("objectid"),f,i.find("span.js-container-title-override").text());b.$input.trigger("close")}).on("focusWaitFinished",function(){b.$input.trigger("keystroke")}).on("close",function(i){i.stopPropagation()});b.$browse.click(function(i){b.emit("browse");i.preventDefault()})};this.selectPlace=function(e,b,d,c){this.emit("selectPlace",e,b,d,c)}});define("apps/publish_bar/views/place_view",function(){return jive.PublishBar.PlaceView});
;
jive.namespace("PublishBar");define("apps/publish_bar/models/search_places_source",["apps/shared/models/rest_service","jquery"],function(a,b){jive.PublishBar.SearchPlacesSource=a.extend(function(d,e){d.resourceType="container";d.init=function(g){e.init.call(this,g);this.RESOURCE_ENDPOINT=jive.rest.url("/containers/search")};this.findAll=function(h){var g=e.findAll.call(this,h).deferred();g.allowedToContribute=function(i){return g.pipe(c.bind(null,i))};return g};var f=["prop","perms","allowedToContribute"];function c(i,h){var g=h.containers.filter(function(j){var k=f.reduce(function(l,m){return typeof l[m]==="undefined"||l[m]},j);return k==i});return b.extend({},h,{containers:g})}});return jive.PublishBar.SearchPlacesSource});
;
jive.namespace("PublishBar");define("apps/publish_bar/models/suggested_places_source",["apps/shared/models/rest_service"],function(a){jive.PublishBar.SuggestedContainersSource=a.extend(function(b,c){b.resourceType="container";b.init=function(d){c.init.call(this,d);$j.extend(this.defaultParams,{containerType:d.containerType,containerID:d.containerID});this.RESOURCE_ENDPOINT=jive.rest.url("/containers/suggested")}});return jive.PublishBar.SuggestedContainersSource});
;
jive.namespace("PublishBar");jive.PublishBar.PlaceMain=jive.oo.Class.extend(function(a){jive.conc.observable(this);a.init=function(l){var e=this;var b=l.objectType||-1;var m=l.upload||false;var h=l.containerType||-1;var k=l.containerID||-1;var c=l.renderType;var i=l.showCommunityOption;var j=new jive.PublishBar.SuggestedContainersSource({containerType:h,containerID:k});var g=new jive.PublishBar.SearchPlacesSource();var d=new jive.PublishBar.PlaceView($j("#"+l.publishBarPlaceInputId),$j("#"+l.publishBarPlaceResultsId),$j("#"+l.publishBarPlaceBrowseId),c,i);d.addListener("suggest",function(n){j.get(b).addCallback(function(o){n.emitSuccess(o)})});d.addListener("search",function(o,p){var n=g.findAll({query:o,contentType:b,maxReturned:10});n.allowedToContribute(true).then(function(q){if(q.containers&&q.containers.length>0){p.emitSuccess(q)}else{n.then(function(r){p.emitSuccess(r)})}})});function f(){var n=new jive.Placepicker.Main({pickerContext:"create",objectType:b,containerType:h,containerID:k,upload:m,closeOnSelect:true,hideUserContainer:true});n.showPicker();n.addListener("container",function(o,p){d.selectPlace(o.targetContainerType,o.targetContainerID)})}d.addListener("browse",function(){f()});this.addListener("browse",function(){f()});d.addListener("selectPlace",function(q,n,p,o){e.emit("selectPlace",q,n,p,o)})}});define("apps/publish_bar/place_main",function(){return jive.PublishBar.PlaceMain});
;
jive.namespace("PublishBar");define("apps/publish_bar/models/publish_bar_source",["apps/shared/models/rest_service"],function(a){jive.PublishBar.PublishBarSource=a.extend(function(b,c){b.resourceType="container";b.init=function(d){d=d||{};c.init.call(this,d);this.RESOURCE_ENDPOINT=jive.rest.url("/publishbar")}});return jive.PublishBar.PublishBarSource});
;
jive.namespace("PublishBar");jive.PublishBar.Main=jive.oo.Class.extend(function(a){jive.conc.observable(this);a.init=function(d){var c=this;if(d.placeRenderType){c.placeRenderType=d.placeRenderType}if(d.showCommunityOption){c.showCommunityOption=d.showCommunityOption}c.identifierPrefix="";if(d.identifier){c.identifierPrefix=d.identifier}c.placeViewContainerId=c.identifierPrefix+"js-publishbar-place-selection";c.organizeContainerId=c.identifierPrefix+"js-publishbar-organize";c.collaborationContainerId=c.identifierPrefix+"js-publishbar-collaboration";c.loadingContainerId=c.identifierPrefix+"js-publishbar-loading";c.publishBarChangePlaceId=c.identifierPrefix+"js-publishbar-changePlace";c.publishBarOptionPrefixId=c.identifierPrefix+"js-publishbar-option-";c.publishBarOptionPlaceId=c.identifierPrefix+"js-publishbar-option-place";c.publishBarOptionAllId=c.identifierPrefix+"js-publishbar-option-all";c.publishBarOptionPeopleId=c.identifierPrefix+"js-publishbar-option-people";c.publishBarPlaceInputId=c.identifierPrefix+"js-publishbar-place-input";c.publishBarUsersId=c.identifierPrefix+"js-publishbar-users";c.visibilityPeopleId=c.identifierPrefix+"js-visibility-people";c.publishBarCreateBlogChangeId=c.identifierPrefix+"js-publishbar-createblog-change";c.publishBarCreateBlogDefault=c.identifierPrefix+"js-publishbar-createblog-default";c.publishBarCreateBlog=c.identifierPrefix+"js-publishbar-createblog";c.publishBarOptionPrivateId=c.identifierPrefix+"js-publishbar-option-private";c.privateDefaultAuthorPolicyId=c.identifierPrefix+"private-default-authorPolicy";c.publishBarTagInputClass=c.identifierPrefix+"js-tag-input";c.publishBarDocAuthorsId=c.identifierPrefix+"js-publishbar-docAuthors";c.publishBarDocAuthorPolicyPrefixId=c.identifierPrefix+"js-publishbar-docAuthorPolicy-";c.publishBarDocAuthorDetailsId=c.identifierPrefix+"js-publishbar-docAuthorDetails";c.publishBarDocDefautlAuthorshipPolicyId=c.identifierPrefix+"js-publishbar-docDefaultAuthorshipPolicy";c.publishBarDocAuthorOptionId=c.identifierPrefix+"js-publishbar-docAuthorsOption";c.publishBarDocAuthorsMultipleId=c.identifierPrefix+"js-publishbar-docAuthors-multiple";c.publishBarDocApproversId=c.identifierPrefix+"js-publishbar-docApprovers";c.publishBarDocApproversOptionId=c.identifierPrefix+"js-publishbar-docApproversOption";c.publishBarDocApproversDetailsId=c.identifierPrefix+"js-publishbar-docApproversDetails";c.publishBarCommentOptionId=c.identifierPrefix+"js-publishbar-commentOption";c.publishBarCommentOptionDetailsId=c.identifierPrefix+"js-publishbar-commentOptionDetails";c.publishBarCommentStatusNoneId=c.identifierPrefix+"js-publishbar-commentStatusNone";c.PublishBarCommentStatusOpenId=c.identifierPrefix+"js-publishbar-commentStatusOpen";c.publishDateId=c.identifierPrefix+"publishDate";c.publishBarBlogPublishOptionId=c.identifierPrefix+"js-publishbar-blogPublishOption";c.publishBarBlogPublishDetailsId=c.identifierPrefix+"js-publishbar-blogPublishDetails";c.publishBarPollVoteOptionsId=c.identifierPrefix+"js-publishbar-pollVoteOptions";c.publishBarPollVoteDetailsId=c.identifierPrefix+"js-publishbar-pollVoteDetails";c.publishBarCollabLinkId=c.identifierPrefix+"js-publishbar-collab-link";c.publishBarCollabId=c.identifierPrefix+"js-publishbar-collab";c.publishBarModerationWarningId=c.identifierPrefix+"js-publishbar-moderation-warning";c.publishBarPlaceResultsId=c.identifierPrefix+"js-publishbar-place-results";c.publishBarPlaceBrowseId=c.identifierPrefix+"js-publishbar-place-browse";c.publishBarTagSetsId=c.identifierPrefix+"js-publishbar-tagsets";c.publishBarCategories=c.identifierPrefix+"j-publishbar-categories";c.publishBarMoveNotifyStreams=c.identifierPrefix+"js-publishbar-move-notify-streams";c.statusUpdateModerationWarningId=c.identifierPrefix+"moderation-warning";c.activeLaterId="active-later";c.activeDateId="activeDate";c.endsNeverId="ends-never";c.endsDaysId="endsDays";c.endsDateId="endsDate";c.endsRelativeId="ends-relative";c.endsLaterId="ends-later";c.endsNowId="ends-now";c.publishBarSelectId=c.identifierPrefix+"js-publishbar-select";this.objectID=d.objectDescriptor?d.objectDescriptor.id:-1;this.objectType=d.objectType||-1;var b=d.initData||{};this.publishBarSource=new jive.PublishBar.PublishBarSource();this.placeViewContainer=$j("#"+c.placeViewContainerId);this.organizeContainer=$j("#"+c.organizeContainerId);this.collaborationContainer=$j("#"+c.collaborationContainerId);this.loadingContainer=$j("#"+c.loadingContainerId);this.resetAuthorshipOpts=false;this.visibility=b.visibilityBean.visibility;this.invitationsEnabled=b.visibilityBean.systemInvitationsEnabled;if(this.visibility=="place"&&b.visibilityBean.placeSelected){this.containerID=b.visibilityBean.placeItemBean.id;this.containerType=b.visibilityBean.placeItemBean.type;this.originalContainer={containerID:this.containerID,containerType:this.containerType}}this.handleVisibilityFocus=d.handleVisibilityFocus==null?true:d.handleVisibilityFocus;$j("#"+c.publishBarSelectId+" :radio").change(function(){c.setVisibility($j(this).val());if($j(this).val()!="place"){$j("#jive-compose-categories").remove()}});$j("#"+c.identifierPrefix+"j-publishbar-place-original").bind("resetToOriginalPlace",function(){var e=$j("#"+c.identifierPrefix+"j-publishbar-place-original");var f=e.data("placechangeable");if(f&&e.data("place-type-id")&&e.data("place-id")){c.selectPlace(e.data("place-type-id"),e.data("place-id"),e.data("render-type"),e.data("subject"))}});if(b.visibilityBean.placeSelected){this.initPlaceSelectedJavascript(b)}else{this.initVisibilityJavascript(b)}this.spinner=null;jive.acclaim.addListener("beforeFetch",a.setSpinnerVisibility.bind(this,"show"));jive.acclaim.addListener("afterFetch",a.setSpinnerVisibility.bind(this,"hide"))};a.setSpinnerVisibility=function(c){var b=this;var e=$j("#"+b.publishBarChangePlaceId).closest(".j-js-place-view-info").find(".j-js-publish-bar-acclaim-container"),d={inline:true,showLabel:false,size:"small"};e.css("position","relative");if(c==="show"&&!this.spinner){this.spinner=new jive.loader.LoaderView(d);this.spinner.prependTo(e)}else{if(c==="hide"&&this.spinner){this.spinner.destroy();this.spinner=null;e.find(".j-loading-container").remove()}}};a.setVisibility=function(c){var b=this;var d=b.visibility;b.visibility=c;if(d!="place"&&c=="place"){if(typeof(b.containerID)!="undefined"){return b.selectPlace(b.containerType,b.containerID)}if(d=="private"){b.resetAuthorshipOpts=true}}if(b.shouldAlertMove()){$j("#"+b.publishBarMoveNotifyStreams).show()}else{$j("#"+b.publishBarMoveNotifyStreams).hide()}if(!this.loadingContainer.find("#j-loading-content").length){b.spinner=new jive.loader.LoaderView({showLabel:false,size:"small"});b.spinner.appendTo(this.loadingContainer)}var e=(b.objectType<0||b.objectID<0)?"view":"edit";this.publishBarSource.get(e,{objectType:b.objectType,objectID:b.objectID,visibility:c}).addCallback(function(g){if(b.spinner){b.spinner.getContent().remove();b.spinner.destroy()}if(g.visibilityBean.visibility=="place"){g.visibilityBean.showVisibility=true}b.renderVisibilityContainer(g.visibilityBean);b.renderCollaborationContainer(g.optionsBean);b.initVisibilityJavascript(g);b.renderCreatorInfo(d,c,g);if(g.visibilityBean.showVisibility){var f=$j("ul#"+b.publishBarSelectId+" li div.j-share-to-option:visible");b.updateVisibilityFocus(f)}})};a.renderCreatorInfo=function(e,g,f){var b=this;var c=b.publishBarOptionPrefixId+e;var d=b.publishBarOptionPrefixId+g;$j("#"+c).remove("#"+b.identifierPrefix+"js-container-objecttype");$j("#"+c).remove("#"+b.identifierPrefix+"js-container-objectid");if(f.creator&&g!="place"){$j("#"+d).append(jive.publishbar.creatorVisibilityInfo({visibilityBean:f.visibilityBean,includeVisibilityValue:false}))}};a.selectPlace=function(h,c,e,d){var b=this;if(e=="quick"&&c==-1&&h==-1){this.jivePublishBarPlace.emit("browse");return}var g=new jive.loader.LoaderView({showLabel:false,size:"small"});g.appendTo(this.loadingContainer);var f=(b.objectType<0||b.objectID<0)?"view":"edit";this.publishBarSource.get(f,{objectType:this.objectType,objectID:this.objectID,visibility:"place",containerType:h,containerID:c}).addCallback(function(j){if(h!=14||c!=1){b.containerType=h;b.containerID=c}g.getContent().remove();g.destroy();if(b.tagAutocomplete){var i=b.tagAutocomplete.getTagsFromBadges();if(j.organizeBean.tags&&j.organizeBean.tags.length){j.organizeBean.tags=k(j.organizeBean.tags,i)}else{j.organizeBean.tags=i.join(",")}}b.renderPlaceViewContainer(j.visibilityBean.placeItemBean,d);b.renderOrganizeContainer(j.organizeBean);b.renderCollaborationContainer(j.optionsBean);b.initPlaceSelectedJavascript(j);if(b.shouldAlertMove()){$j("#"+b.publishBarMoveNotifyStreams).show()}else{$j("#"+b.publishBarMoveNotifyStreams).hide()}$j("#"+b.publishBarChangePlaceId).focus();require(["channel!publishBar"],function(l){l.trigger("place:selected",j.visibilityBean.placeItemBean)});b.emit("placeSelected",{containerType:h,containerId:c});function k(n,m){var l=n.split(",");return _.uniq(m.concat(l)).join(",")}})};a.updateVisibilityFocus=function(d){if(!this.handleVisibilityFocus){return}var c=this;var f=$j("ul#"+c.publishBarSelectId+" li div.j-share-to-option:visible"),b=f.siblings("label").find("input[type=radio]").attr("id"),e=d.siblings("label").find("input[type=radio]").attr("id");if(b===e){f.find(":focusable:first").focus()}};a.renderVisibilityContainer=function(d){var b=this,c=$j("ul#"+b.publishBarSelectId+" li div.j-share-to-option:visible");this.placeViewContainer.hide().empty();$j("ul#"+b.publishBarSelectId+" li div.j-share-to-option").hide().empty();if(d.showVisibility){$j("#"+b.publishBarOptionPrefixId+d.visibility).empty().append($j(jive.publishbar.visibility($j.extend({communityFeatureVisible:jive.global.communityFeatureVisible,identifier:b.identifierPrefix,inputBrowse:(c.data("inputbrowse")!==undefined?c.data("inputbrowse"):true),preInputNameKey:c.data("preinputnamekey")},d)))).show()}$j("#"+b.publishBarOptionPrefixId+d.visibility).parent().find("input[name='publishBar.visibility']").focus()};a.renderPlaceViewContainer=function(f,c){var b=this,d=$j("ul#"+b.publishBarSelectId+" li div.j-share-to-option");$j("ul#"+b.publishBarSelectId+" li div.j-share-to-option").hide().empty();var e=f;if(c){e.subject=c;e.iconCss=""}this.placeViewContainer.empty().append($j(jive.publishbar.placeView($j.extend({identifier:b.identifierPrefix,placeRenderType:b.placeRenderType,preInputNameKey:d.data("preinputnamekey"),placeChangeable:true,showExStorageInfo:true},e)))).show(0,function(){b.updateVisibilityFocus(d)})};a.renderOrganizeContainer=function(d){var b=this;var c=this.organizeContainer.clone();this.organizeContainer.empty().append($j(jive.publishbar.organize($j.extend({identifier:b.identifierPrefix},d))));this.transposeInputs(c,this.organizeContainer)};a.renderCollaborationContainer=function(c){var b=this;if(c.showOptionsLink){var d=this.collaborationContainer.clone();this.collaborationContainer.empty().append($j(jive.publishbar.collaborationOptions($j.extend({identifier:b.identifierPrefix},c)))).show();this.transposeInputs(d,this.collaborationContainer)}else{this.collaborationContainer.empty().hide()}};a.transposeInputs=function(d,b){var c=this;$j(d).find("input").each(function(){var e=$j(this);$j(b).find("input#"+e.attr("id")).each(function(){var f=$j(this);if(e.attr("type")=="radio"){}else{c.transposeNonRadioInput(e,f)}})});$j(d).find(".js-onboarding-tip").each(function(){var f=$j(this),e=f.next();$j(b).find("#"+e.attr("id")).before(f)})};a.transposeNonRadioInput=function(d,b){if(b.prop("disabled")){}var c=b.attr("type");if(c=="checkbox"){if(!b||$j(b).closest("li").find("input").length>1){return}b.prop("checked",d.prop("checked"))}else{b.val(d.val())}};a.initVisibilityJavascript=function(c){var b=this;if(c.visibilityBean.privateVisibility){this.initPrivateVisibilityJavascript(c.optionsBean)}else{this.destroyPrivateVisibilityJavascript()}if(c.visibilityBean.placeVisibility){this.initPlaceVisibilityJavascript()}else{if(c.visibilityBean.peopleVisibility){this.initPeopleVisibilityJavascript(c.visibilityBean.users)}else{if(c.visibilityBean.allVisibility){if(c.visibilityBean.personalBlog){this.initAllVisibilityJavascript()}}}}this.initTagJavascript(-1,-1);this.initOptionsJavascript(c.optionsBean);this.manageModerationWarning($j.extend(c,{initVisibility:true}));jive.localexchange.emit("initVisibilityJs",c,b)};a.initPlaceSelectedJavascript=function(c){var b=this;$j("#"+b.publishBarChangePlaceId).click(function(d){b.setVisibility("place");d.preventDefault()});this.initTagJavascript(c.visibilityBean.placeItemBean.type,c.visibilityBean.placeItemBean.id);this.initOptionsJavascript(c.optionsBean);this.manageModerationWarning(c);jive.localexchange.emit("initPlaceSelectedJs",c,b)};a.initPlaceVisibilityJavascript=function(){var b=this;this.jivePublishBarPlace=new jive.PublishBar.PlaceMain({objectType:this.objectType,publishBarPlaceInputId:b.publishBarPlaceInputId,publishBarPlaceResultsId:b.publishBarPlaceResultsId,publishBarPlaceBrowseId:b.publishBarPlaceBrowseId,renderType:b.placeRenderType,showCommunityOption:b.showCommunityOption});this.jivePublishBarPlace.addListener("selectPlace",function(f,c,e,d){b.selectPlace(f,c,e,d)});$j("#"+b.publishBarOptionPlaceId).find("#"+b.publishBarPlaceInputId).prop("required","required")};a.initPeopleVisibilityJavascript=function(c){var b=this;c=c?c:[];this.peopleAutocomplete=new jive.UserPicker.Main({multiple:true,valueIsUsername:true,emailAllowed:this.invitationsEnabled,listAllowed:true,canInvitePartners:true,$input:$j("#"+b.publishBarUsersId),startingUsers:{users:c,userlists:[]},selectionCallbacks:[this.decorateGuestUsers],userMessages:[this.getUserInviteMessage()]});$j("#"+b.visibilityPeopleId).find("input[name='publishBar.users']").prop("required","required").prop("errorFocus","#js-publishbar-users")};a.initAllVisibilityJavascript=function(){var b=this;$j("#"+b.publishBarCreateBlogChangeId).click(function(c){$j("#"+b.publishBarCreateBlogDefault).hide();$j("#"+b.publishBarCreateBlog).show();$j("#"+b.publishBarCreateBlog).find("input").focus();c.preventDefault()});$j("#"+b.publishBarCreateBlog).keypress(function(c){if(c.keyCode==10||c.keyCode==13){c.preventDefault()}})};a.initPrivateVisibilityJavascript=function(c){var b=this;if(c.authorsBean){$j("#"+b.publishBarOptionPrivateId).append('<input type="hidden" id="'+b.privateDefaultAuthorPolicyId+'" name="publishBar.authorPolicy" value="'+c.authorsBean.authorPolicySingleValue+'"/>')}};a.destroyPrivateVisibilityJavascript=function(){var b=this;$j("#"+b.publishBarOptionPrivateId).remove("#"+b.privateDefaultAuthorPolicyId)};a.initTagJavascript=function(e,c){var b=this;this.publishBarTagSetSupport=new PublishBarTagSetSupport($j("."+b.publishBarTagInputClass),b.publishBarCategories);var d=$j("."+b.publishBarTagInputClass);if(d.length>0){this.tagAutocomplete=new jive.Tags.Controller(d,{containerType:e,containerID:c,identifierPrefix:b.identifierPrefix}).addListener("tags.change",function(f){b.publishBarTagSetSupport.suggestCategories(f)})}};a.initOptionsJavascript=function(b){if(b.showOptionsLink){this.initCollaborationToggleJavascript()}if(b.showAuthors){this.initDocumentAuthorsJavascript(b.authorsBean)}if(b.showApprovers){this.initDocumentApproversJavascript(b.approversBean.approvers)}if(b.showCommentOptions){this.initCommentOptionsJavascript(b.commentOptionsBean)}if(b.showBlogPostPublishDate){this.initBlogPostPublishDateJavascript(b.blogPostPublishDateBean)}if(b.showPollOptions){this.initPollOptionsJavascript()}};a.initDocumentAuthorsJavascript=function(e){var c=this;var h=e.authors||[];var g=[];if(this.peopleAutocomplete&&this.peopleAutocomplete.getSelectedUsersAndLists()){var d=this.peopleAutocomplete.getSelectedUsersAndLists().users||[];g=$j.map(d,function(l){var k=false;$j.each(h,function(m,n){if((l.id==-1&&jive.util.equalsIgnoreCaseAndPadding(l.email,l.email))||(l.id==n.id&&l.objectType==n.objectType)){k=true;return true}});if(k){return null}var j=$j.extend(true,{},l);j.excluded=true;return j});if(g.length>=1&&!h.length===0){$j("#"+c.publishBarDocAuthorOptionId).prop("checked",true).change();$j("#"+c.publishBarDocAuthorDetailsId).show();$j("#"+c.publishBarDocAuthorsMultipleId).show();$j("#"+c.publishBarDocAuthorPolicyPrefixId+e.authorPolicyMultipleValue).prop("checked",true).change()}else{if(d.length>=1&&h.length===0){$j("#"+c.publishBarDocAuthorOptionId).prop("checked",true).change();$j("#"+c.publishBarDocAuthorDetailsId).show();$j("#"+c.publishBarDocAuthorsMultipleId).hide();$j("#"+c.publishBarDocAuthorPolicyPrefixId+2).prop("checked",true).change()}else{if(h.length>=1&&d.length>=1&&(d.length>h.length)){$j("#"+c.publishBarDocAuthorOptionId).prop("checked",true).change();$j("#"+c.publishBarDocAuthorDetailsId).show();$j("#"+c.publishBarDocAuthorsMultipleId).show()}else{$j("#"+c.publishBarDocAuthorOptionId).prop("checked",false).change();$j("#"+c.publishBarDocAuthorDetailsId).hide();$j("#"+c.publishBarDocAuthorsMultipleId).hide()}}}}else{if($j("#"+c.publishBarDocAuthorOptionId).prop("checked")){$j("#"+c.publishBarDocAuthorDetailsId).show()}else{$j("#"+c.publishBarDocAuthorDetailsId).hide()}}$j.merge(h,g);var f={multiple:true,valueIsUsername:true,emailAllowed:c.invitationsEnabled,listAllowed:true,$input:$j("#"+c.publishBarDocAuthorsId),canInvitePartners:true,startingUsers:{users:h,userlists:[]}};var i=c.getEntitlementCheckObjectForAuthors();if(i){f=$j.extend(f,{object:i,entitlement:c.getAuthorEntitlementCheckMask(),userMessages:[c.getUserPermissionsMessage()],listMessages:[c.getListPermissionsMessage()]})}this.docAuthorAutocomplete=new jive.UserPicker.Main(f);if(e.forceAuthorList){this.docAuthorAutocomplete.setNoPicker(true);this.peopleAutocomplete.addListener("selectedUsersChanged",function(o){var l=c.docAuthorAutocomplete.getSelectedUsersAndLists(true),j=l.users,k=l.userlists;if(o.changes&&o.changes.added){$j("#"+c.publishBarDocAuthorPolicyPrefixId+e.authorPolicyMultipleValue).prop("checked",true).change();if(o.changes.added.users){k.push(o.changes.added);c.docAuthorAutocomplete.setLists(k)}else{var m=o.changes.added instanceof Array?o.changes.added:[o.changes.added];j.push.apply(j,m);c.docAuthorAutocomplete.setUsers(j)}}if(o.changes&&o.changes.removed){var n=-1;$j.map(j,function(p,q){if(p.id===o.changes.removed.id){n=q}});if(n!==-1){j.splice(n,1);c.docAuthorAutocomplete.setUsers(j)}if(j.length&&j.length>=1){$j("#"+c.publishBarDocAuthorPolicyPrefixId+e.authorPolicyMultipleValue).prop("checked",true).change()}else{$j("#"+c.publishBarDocAuthorPolicyPrefixId+e.authorPolicyMultipleValue).prop("checked",false).change();$j("#"+c.publishBarDocAuthorOptionId).prop("checked",false).change();$j("#"+c.publishBarDocAuthorDetailsId).hide()}}})}if(c.resetAuthorshipOpts){var b=$j("#"+c.publishBarDocAuthorOptionId);if(b.prop("checked")){b.prop("checked",false)}}$j("#"+c.publishBarDocDefautlAuthorshipPolicyId).val(e.defaultAuthorPolicy);$j("#"+c.publishBarDocAuthorOptionId).click(function(){if($j(this).is(":checked")){$j("#"+c.publishBarDocAuthorDetailsId).show();if($j("#"+c.publishBarDocAuthorDetailsId+' li:visible input[id="'+c.publishBarDocAuthorPolicyPrefixId+e.defaultAuthorPolicy+'"]').length==1){$j("#"+c.publishBarDocAuthorPolicyPrefixId+e.defaultAuthorPolicy).prop("checked",true)}else{$j($j("#"+c.publishBarDocAuthorDetailsId+' li:visible input[name="publishBar.authorPolicy"]')[0]).prop("checked",true)}if($j("#"+c.publishBarDocAuthorDetailsId+' input[name="publishBar.authorPolicy"]:checked').val()==e.authorPolicyMultipleValue){$j("#"+c.publishBarDocAuthorsMultipleId).show()}if($j("#"+c.publishBarOptionPeopleId).prop("checked")){c.docAuthorAutocomplete.setNoPicker(true)}}else{$j("#"+c.publishBarDocAuthorDetailsId).hide();$j("#"+c.publishBarDocAuthorPolicyPrefixId+e.defaultAuthorPolicy).prop("checked",true);$j("#"+c.publishBarDocAuthorsMultipleId).hide()}});$j("#"+c.publishBarDocAuthorDetailsId+' input[name="publishBar.authorPolicy"]').change(function(){if($j(this).is(":checked")&&$j(this).val()==e.authorPolicyMultipleValue){$j("#"+c.publishBarDocAuthorsMultipleId).show()}else{$j("#"+c.publishBarDocAuthorsMultipleId).hide()}})};a.initDocumentApproversJavascript=function(c){var b=this;c=c?c:[];var e={multiple:true,valueIsUsername:true,listAllowed:true,$input:$j("#"+b.publishBarDocApproversId),startingUsers:{users:c,userlists:[]},canInvitePartners:true};var d=b.getEntitlementCheckObject();if(d){e=$j.extend(e,{object:d,entitlement:b.getApproverEntitlementCheckMask(),userMessages:[b.getUserPermissionsMessage()],listMessages:[b.getListPermissionsMessage()]})}window.docApproversAutocomplete=new jive.UserPicker.Main(e);$j("#"+b.publishBarDocApproversOptionId).click(function(){if($j(this).is(":checked")){$j("#"+b.publishBarDocApproversDetailsId).show();$j("#"+b.publishBarDocApproversDetailsId).find("input[name='publishBar.approvers']").prop("required","required")}else{$j("#"+b.publishBarDocApproversDetailsId).hide();$j("#"+b.publishBarDocApproversDetailsId).find("input[name='publishBar.approvers']").removeProp("required")}})};a.initCommentOptionsJavascript=function(c){var b=this;$j("#"+b.publishBarCommentOptionId).click(function(){if($j(this).is(":checked")){if(c.showAdditionalCommentOptions){$j("#"+b.publishBarCommentOptionDetailsId).show()}$j("#"+b.publishBarCommentStatusNoneId).prop("checked",true)}else{$j("#"+b.publishBarCommentOptionDetailsId).hide();$j("#"+b.PublishBarCommentStatusOpenId).prop("checked",true)}})};a.initBlogPostPublishDateJavascript=function(c){var b=this;if(c.selectedDate){$j("#"+b.publishDateId).attr("value",c.selectedDate)}else{$j("#"+b.publishDateId).attr("value",c.defaultDate)}$j("#"+b.publishBarBlogPublishOptionId).click(function(){if($j(this).is(":checked")){$j("#"+b.publishBarBlogPublishDetailsId).show()}else{$j("#"+b.publishBarBlogPublishDetailsId).hide()}})};a.initPollOptionsJavascript=function(){var b=this;$j("#"+b.publishBarPollVoteOptionsId).click(function(){if($j(this).is(":checked")){$j("#"+b.publishBarPollVoteDetailsId).show()}else{$j("#"+b.publishBarPollVoteDetailsId).hide()}});$j("#"+b.publishBarPollVoteDetailsId).find("input[name='activeMode']").change(function(){if($j("#"+b.activeLaterId).is(":checked")){$j(".activeDatePicker").show()}else{$j(".activeDatePicker").hide();$j("#"+b.activeDateId).val("")}});$j("#"+b.publishBarPollVoteDetailsId).find("input[name='endsMode']").change(function(){if($j("#"+b.publishBarPollVoteDetailsId).find("#"+b.endsNeverId).is(":checked")){$j("#"+b.publishBarPollVoteDetailsId).find(".expiresDatePicker").hide();$j("#"+b.publishBarPollVoteDetailsId).find("#"+b.endsDaysId).val("");$j("#"+b.publishBarPollVoteDetailsId).find("#"+b.endsDateId).val("")}else{if($j("#"+b.publishBarPollVoteDetailsId).find("#"+b.endsRelativeId).is(":checked")){$j("#"+b.publishBarPollVoteDetailsId).find(".expiresDatePicker").hide();$j("#"+b.publishBarPollVoteDetailsId).find("#"+b.endsDateId).val("")}else{if($j("#"+b.publishBarPollVoteDetailsId).find("#"+b.endsLaterId).is(":checked")){$j("#"+b.publishBarPollVoteDetailsId).find("#"+b.endsDaysId).val("");$j("#"+b.publishBarPollVoteDetailsId).find(".expiresDatePicker").show()}else{if($j("#"+b.publishBarPollVoteDetailsId).find("#"+b.endsNowId).is(":checked")){$j("#"+b.publishBarPollVoteDetailsId).find(".expiresDatePicker").hide();$j("#"+b.publishBarPollVoteDetailsId).find("#"+b.endsDaysId).val("");$j("#"+b.publishBarPollVoteDetailsId).find("#"+b.endsDateId).val("")}}}}})};a.initCollaborationToggleJavascript=function(){var b=this;$j("#"+b.publishBarCollabLinkId).click(function(c){$j(this).find("span.jive-icon-glyph").toggleClass("icon-arrow-right2").toggleClass("icon-arrow-down2");$j("#"+b.publishBarCollabId).slideToggle("fast");c.preventDefault()})};a.getEntitlementCheckObject=function(){var b=this;if(b.visibility=="place"){if(b.objectID>0&&b.isPlaceUnchanged()){return{objectID:b.objectID||-1,objectType:b.objectType||-1}}else{return{objectID:b.containerID||-1,objectType:b.containerType||-1}}}else{return null}};a.getEntitlementCheckObjectForAuthors=function(){var b=this;if(b.visibility=="place"){return{objectID:b.containerID||-1,objectType:b.containerType||-1}}else{return null}};a.isPlaceUnchanged=function(){return this.originalContainer&&this.originalContainer.containerID==this.containerID&&this.originalContainer.containerType==this.containerType};a.shouldAlertMove=function(){return(this.objectID||-1)!=-1&&(this.objectType||-1)!=-1&&this.visibility=="place"&&!this.isPlaceUnchanged()};a.getAuthorEntitlementCheckMask=function(){return"CREATE_DOCUMENT"};a.getApproverEntitlementCheckMask=function(){return(this.objectID>0&&this.isPlaceUnchanged())?"VIEW":"VIEW_CONTENT"};a.getUserPermissionsMessage=function(){return{type:"warn",render:function(b){return jive.publishbar.userWithoutPermission(b)}}};a.getListPermissionsMessage=function(){return{type:"warn",render:function(b){return jive.publishbar.listWithoutPermission(b)}}};a.decorateGuestUsers=function(b){var c=b.find('[data-user-id="-1"]');c.append('<span class="jive-icon-sml jive-icon-info">')};a.getUserInviteMessage=function(){return{type:"info",render:function(b){return jive.publishbar.guestInvited({})}}};a.manageModerationWarning=function(d){var b=this;var c=d?d.visibilityBean.placeItemBean:null;if(c&&c.prop.isModerated){$j("#"+b.publishBarModerationWarningId).show();if(d.visibilityBean.contentType==1464927464){if($j("#"+b.statusUpdateModerationWarningId)){if(d.initVisibility){$j("#"+b.statusUpdateModerationWarningId).hide()}else{$j("#"+b.statusUpdateModerationWarningId).show()}}}}else{$j("#"+b.publishBarModerationWarningId).hide();if(d.visibilityBean.contentType==1464927464){if($j("#"+b.statusUpdateModerationWarningId)){$j("#"+b.statusUpdateModerationWarningId).hide()}}}if(d.visibilityBean.contentType!=1464927464){jive.localexchange.emit("placeChanged",c)}}});define("apps/publish_bar/main",function(){return jive.PublishBar.Main});
;
define("apps/status_input/data_source",["jive/promise_util","jquery","underscore"],function(d,c,u){var n={};var a=false;function e(w,y){var x=n[w];var z=x?x.then(u.identity,function(){return y()}):y();n[w]=z;return z}function j(){a=true;return b()}function t(){a=false;n={}}function h(w){return e(w,c.getJSON.bind(c,w))}function i(B){var w=c.trim(B.replace(/_/g," "));if(w.length>255){return[]}var x=10;var C={sort:"relevanceDesc",count:x,filter:"search("+w.replace(/[()*]/g,"")+"*)",origin:"atmention",highlight:"false"};var z=l("/search/people",C);var y=s("/search/places",C);var A=f("/search/contents",C);return[z.then(function(D){return{type:"people",list:D}}),y.then(function(D){return{type:"places",list:D}}),A.then(function(D){return{type:"content",list:D}})]}function b(z){var A={count:z||10,origin:"warmcache"};var x=g(A);var w=r(A);var y=o(A);return[x.then(function(B){return{type:"people",list:B}}),w.then(function(B){return{type:"places",list:B}}),y.then(function(B){return{type:"content",list:B}})]}function g(y){var w=l("/activities/frequent/people",{count:y.count,origin:y.origin}).then(function(z){return z.filter(function(A){return A.id!==_jive_current_user.ID})});var x=l("/people",{sort:"dateJoinedAsc",count:y.count,origin:y.origin});return w.then(function(z){return z.length>=y.count?z:x.then(function(A){return q(z.concat(A)).slice(0,y.count)})})}function q(z){var x=z;var y=[];var w={};u.each(x,function(B,A){if(B.id&&!w[B.id]){w[B.id]=true;y.push(z[A])}});return y}function r(w){return s("/activities/recent/places",{count:w.count,origin:w.origin})}function o(w){return f("/activities/recent/content",{count:w.count,origin:w.origin})}function m(x){var w=c.trim(x.replace(/_/g," ")).toLowerCase();return h(jive.rest.url("/tags/search?query="+encodeURIComponent(w)+"*"))}function k(w,x){return w.sections.length===x.sections.length&&w.sections.every(function(z){var y=u.find(x.sections,function(A){return A.type===z.type});return y&&u.zipWith(z.list,y.list,function(B,A){return B&&A&&B.id==A.id&&B.type==A.type}).every(u.id)})}function l(w,x){return p("person",w,c.extend({fields:"type,id,mentionName,thumbnailId,jive",origin:x.origin||"unknown"},x)).then(function(y){y.forEach(function(A){var z=(A.jive&&A.jive.profile)||[];z.forEach(function(B){if(B.jive_label==="Title"){A.title=B.value}else{if(B.jive_label==="Department"){A.department=B.value}}});A.displayExternalContributor=(!_jive_current_user.partner)&&A.jive&&A.jive.externalContributor});return y})}function s(w,x){return p("place",w,c.extend({fields:"type,id,name,displayName,visibleToExternalContributors",origin:x.origin||"unknown"},x)).then(function(y){y.forEach(function(z){z.displayExternalAccess=(!_jive_current_user.partner)&&z.visibleToExternalContributors});return y})}function f(w,x){return p("content",w,c.extend({fields:"type,id,author,subject,visibleToExternalContributors,published,updated,question,answer,helpful,iconCss",collapse:true,origin:x.origin||"unknown"},x)).then(function(y){y.forEach(function(z){if(z.published){z.publishedDate=v(z.published).getTime()}if(z.updated){z.updatedDate=v(z.updated).getTime()}if(z.author&&!z.author.displayName){z.author.displayName=z.author.name.formatted||z.author.jive.username}if(z.type=="file"&&z.binaryURL){z.extension=z.binaryURL.split(".").slice(-1).join(".").toLowerCase()}if(!z.subject&&z.highlightSubject){z.subject=z.highlightSubject}if(!z.subject&&z.parentContent){z.subject=z.parentContent.name}z.subject=u.unescape(z.subject);z.displayExternalAccess=(!_jive_current_user.partner)&&z.visibleToExternalContributors});return y})}function p(z,x,y){var w=jive.rest.corev3.url(x)+"?"+c.param(y);return h(w).then(function(A){return A.list.map(function(B){return c.extend(B,{archetype:z})})})}function v(z){var w=z.replace(/\+\d+/,"Z");var y=new Date(w);if(isNaN(y.getTime())){var x=w.replace(/-/,"/").replace("T"," ").replace(/\.\d+Z/," GMT");y=new Date(x)}return y}return{viaCache:e,warmCache:j,clearCache:t,search:i,defaultData:b,tags:m,equals:k}});
;
define("libRange",["jquery"],function(g){function p(v){var u=0;while(v=v.previousSibling){++u}return u}function o(v,u){u.parentNode.insertBefore(v,u.nextSibling)}function s(w,u){var x=w,v;while(x){v=u;while(v&&x!=v){v=v.parentNode}if(x==v){break}x=x.parentNode}if(!x&&w.ownerDocument){return w.ownerDocument.documentElement}return x}var f=(function(){function u(C,B){var x=this;function v(){return C.selection.createRange()}function w(){return new B(C)}function A(){var D=v();if(!D||D.item){return false}return D.compareEndPoints("StartToEnd",D)===0}function y(D,E){var F,O=0,L,I,H,G,J,M,K=-1,N;F=D.duplicate();F.collapse(E);N=F.parentElement();if(N.ownerDocument!==C){return}while(N.contentEditable==="false"){N=N.parentNode}if(!N.hasChildNodes()){return{node:N,inside:1}}H=N.children;L=H.length-1;while(O<=L){M=Math.floor((O+L)/2);G=H[M];F.moveToElementText(G);K=F.compareEndPoints(E?"StartToStart":"EndToEnd",D);if(K>0){L=M-1}else{if(K<0){O=M+1}else{return{node:G}}}}if(K<0){if(!G){F.moveToElementText(N);F.collapse(true);G=N;I=true}else{F.collapse(false)}F.setEndPoint(E?"EndToStart":"EndToEnd",D);if(F.compareEndPoints(E?"StartToStart":"StartToEnd",D)>0){F=D.duplicate();F.collapse(E);J=-1;while(N==F.parentElement()){if(F.move("character",-1)==0){break}J++}}J=J||F.text.replace("\r\n"," ").length}else{F.collapse(true);F.setEndPoint(E?"StartToStart":"StartToEnd",D);J=F.text.replace("\r\n"," ").length}return{node:G,position:K,offset:J,inside:I}}function z(){var D=v(),M=w(),G,F,K,L,H,E;G=D.item?D.item(0):D.parentElement();if(G.ownerDocument!=C){return M}F=A();if(D.item){M.setStart(G.parentNode,p(G));M.setEnd(M.startContainer,M.startOffset+1);return M}function J(U){var P=y(D,U),N,S,T=0,R,Q,O;N=P.node;S=P.offset;if(P.inside&&!N.hasChildNodes()){M[U?"setStart":"setEnd"](N,0);return}if(S===Q){M[U?"setStartBefore":"setEndAfter"](N);return}if(P.position<0){R=P.inside?N.firstChild:N.nextSibling;if(!R){M[U?"setStartAfter":"setEndAfter"](N);return}if(!S){if(R.nodeType==3){M[U?"setStart":"setEnd"](R,0)}else{M[U?"setStartBefore":"setEndBefore"](R)}return}while(R){O=R.nodeValue;T+=O.length;if(T>=S){N=R;T-=S;T=O.length-T;break}R=R.nextSibling}}else{R=N.previousSibling;if(!R){return M[U?"setStartBefore":"setEndBefore"](N)}if(!S){if(N.nodeType==3){M[U?"setStart":"setEnd"](R,N.nodeValue.length)}else{M[U?"setStartAfter":"setEndAfter"](R)}return}while(R){T+=R.nodeValue.length;if(T>=S){N=R;T-=S;break}R=R.previousSibling}}M[U?"setStart":"setEnd"](N,T)}try{J(true);if(!F){J()}}catch(I){if(I.number==-2147024809){H=x.getBookmark(2);K=D.duplicate();K.collapse(true);G=K.parentElement();if(!F){K=D.duplicate();K.collapse(false);L=K.parentElement();L.innerHTML=L.innerHTML}G.innerHTML=G.innerHTML;x.moveToBookmark(H);D=v();J(true);if(!F){J()}}else{throw I}}return M}this.addRange=function(D){var J,G,F,L,N,M,I=C.body;function H(O){O.parentNode.removeChild(O)}function E(T){var P,S,O,R,Q;O=C.createElement("a");P=T?F:N;S=T?L:M;R=J.duplicate();if(P==C||P==C.documentElement){P=I;S=0}if(P.nodeType==3){P.parentNode.insertBefore(O,P);R.moveToElementText(O);R.moveStart("character",S);H(O);J.setEndPoint(T?"StartToStart":"EndToEnd",R)}else{Q=P.childNodes;if(Q.length){if(S>=Q.length){o(O,Q[Q.length-1])}else{P.insertBefore(O,Q[S])}R.moveToElementText(O)}else{O=C.createTextNode("\uFEFF");P.appendChild(O);R.moveToElementText(O.parentNode);R.collapse(true)}J.setEndPoint(T?"StartToStart":"EndToEnd",R);H(O)}}F=D.startContainer;L=D.startOffset;N=D.endContainer;M=D.endOffset;J=I.createTextRange();if(F==N&&F.nodeType==1&&L==M-1){if(L==M-1){try{G=I.createControlRange();G.addElement(F.childNodes[L]);G.select();return}catch(K){}}}E(true);E();J.select()};this.getRangeAt=z}return u})();var l=(function(){function u(x){var ac=this,ag=0,T=1,C=2,ah="startOffset",A="startContainer",ae="endContainer",P="endOffset",D=g.extend;D(ac,{startContainer:x,startOffset:0,endContainer:x,endOffset:0,collapsed:true,commonAncestorContainer:x,START_TO_START:0,START_TO_END:1,END_TO_END:2,END_TO_START:3,setStart:I,setEnd:K,setStartBefore:z,setStartAfter:X,setEndBefore:Y,setEndAfter:L,collapse:Q,selectNode:N,selectNodeContents:U,compareBoundaryPoints:M,deleteContents:H,extractContents:W,cloneContents:w,insertNode:S,surroundContents:ab,cloneRange:Z});ac.toString=v;function v(){var ak=this.cloneContents();var aj=[];var al=ak.firstChild;while(al){if(al.nodeType==3){aj.push(al.nodeValue)}else{if(al.nodeType==1){if(al.innerText!=null){aj.push(al.innerText)}else{aj.push(al.textContent)}}}al=al.nextSibling}return aj.join("")}function I(ak,aj){R(true,ak,aj)}function K(ak,aj){R(false,ak,aj)}function z(aj){I(aj.parentNode,p(aj))}function X(aj){I(aj.parentNode,p(aj)+1)}function Y(aj){K(aj.parentNode,p(aj))}function L(aj){K(aj.parentNode,p(aj)+1)}function Q(aj){if(aj){ac[ae]=ac[A];ac[P]=ac[ah]}else{ac[A]=ac[ae];ac[ah]=ac[P]}ac.collapsed=true;ac.commonAncestorContainer=ac[A]}function N(aj){z(aj);L(aj)}function U(aj){I(aj,0);K(aj,aj.nodeType===1?aj.childNodes.length:aj.nodeValue.length)}function M(an,aj){var aq=ac[A],al=ac[ah],ap=ac[ae],ak=ac[P],ao=aj.startContainer,at=aj.startOffset,am=aj.endContainer,ar=aj.endOffset;if(an===0){return V(aq,al,ao,at)}if(an===1){return V(ap,ak,ao,at)}if(an===2){return V(ap,ak,am,ar)}if(an===3){return V(aq,al,am,ar)}}function H(){F(C)}function W(){return F(ag)}function w(){return F(T)}function S(an){var ak=this[A],aj=this[ah],am,al;if((ak.nodeType===3||ak.nodeType===4)&&ak.nodeValue!=null){if(!aj){ak.parentNode.insertBefore(an,ak)}else{if(aj>=ak.nodeValue.length){o(an,ak)}else{am=ak.splitText(aj);ak.parentNode.insertBefore(an,am)}}}else{if(ak.childNodes.length>0){al=ak.childNodes[aj]}if(al){ak.insertBefore(an,al)}else{ak.appendChild(an)}}}function ab(ak){var aj=ac.extractContents();ac.insertNode(ak);ak.appendChild(aj);ac.selectNode(ak)}function Z(){return D(new u(x),{startContainer:ac[A],startOffset:ac[ah],endContainer:ac[ae],endOffset:ac[P],collapsed:ac.collapsed,commonAncestorContainer:ac.commonAncestorContainer})}function ad(aj,ak){var al;if(aj.nodeType==3){return aj}if(ak<0){return aj}al=aj.firstChild;while(al&&ak>0){--ak;al=al.nextSibling}if(al){return al}return aj}function E(){return(ac[A]==ac[ae]&&ac[ah]==ac[P])}function V(am,ao,ak,an){var ap,al,aj,aq,at,ar;if(am==ak){if(ao==an){return 0}if(ao<an){return -1}return 1}ap=ak;while(ap&&ap.parentNode!=am){ap=ap.parentNode}if(ap){al=0;aj=am.firstChild;while(aj!=ap&&al<ao){al++;aj=aj.nextSibling}if(ao<=al){return -1}return 1}ap=am;while(ap&&ap.parentNode!=ak){ap=ap.parentNode}if(ap){al=0;aj=ak.firstChild;while(aj!=ap&&al<an){al++;aj=aj.nextSibling}if(al<an){return -1}return 1}aq=s(am,ak);at=am;while(at&&at.parentNode!=aq){at=at.parentNode}if(!at){at=aq}ar=ak;while(ar&&ar.parentNode!=aq){ar=ar.parentNode}if(!ar){ar=aq}if(at==ar){return 0}aj=aq.firstChild;while(aj){if(aj==at){return -1}if(aj==ar){return 1}aj=aj.nextSibling}}function R(ak,an,am){var aj,al;if(ak){ac[A]=an;ac[ah]=am}else{ac[ae]=an;ac[P]=am}aj=ac[ae];while(aj.parentNode){aj=aj.parentNode}al=ac[A];while(al.parentNode){al=al.parentNode}if(al==aj){if(V(ac[A],ac[ah],ac[ae],ac[P])>0){ac.collapse(ak)}}else{ac.collapse(ak)}ac.collapsed=E();ac.commonAncestorContainer=s(ac[A],ac[ae])}function F(aq){var ap,am=0,at=0,ak,ao,al,an,aj,ar;if(ac[A]==ac[ae]){return y(aq)}for(ap=ac[ae],ak=ap.parentNode;ak;ap=ak,ak=ak.parentNode){if(ak==ac[A]){return J(ap,aq)}++am}for(ap=ac[A],ak=ap.parentNode;ak;ap=ak,ak=ak.parentNode){if(ak==ac[ae]){return ai(ap,aq)}++at}ao=at-am;al=ac[A];while(ao>0){al=al.parentNode;ao--}an=ac[ae];while(ao<0){an=an.parentNode;ao++}for(aj=al.parentNode,ar=an.parentNode;aj!=ar;aj=aj.parentNode,ar=ar.parentNode){al=aj;an=ar}return G(al,an,aq)}function y(ao){var aq,an,am,ap,aj,al,ak;if(ao!=C){aq=x.createDocumentFragment()}if(ac[ah]==ac[P]){return aq}if(ac[A].nodeType==3){an=ac[A].nodeValue;am=an.substring(ac[ah],ac[P]);if(ao!=T){ac[A].deleteData(ac[ah],ac[P]-ac[ah]);ac.collapse(true)}if(ao==C){return}aq.appendChild(x.createTextNode(am));return aq}ap=ad(ac[A],ac[ah]);aj=ac[P]-ac[ah];while(aj>0){al=ap.nextSibling;ak=O(ap,ao);if(aq){aq.appendChild(ak)}--aj;ap=al}if(ao!=T){ac.collapse(true)}return aq}function J(aq,an){var ap,ao,ak,aj,am,al;if(an!=C){ap=x.createDocumentFragment()}ao=B(aq,an);if(ap){ap.appendChild(ao)}ak=p(aq);aj=ak-ac[ah];if(aj<=0){if(an!=T){ac.setEndBefore(aq);ac.collapse(false)}return ap}ao=aq.previousSibling;while(aj>0){am=ao.previousSibling;al=O(ao,an);if(ap){ap.insertBefore(al,ap.firstChild)}--aj;ao=am}if(an!=T){ac.setEndBefore(aq);ac.collapse(false)}return ap}function ai(ao,an){var aq,ak,ap,aj,am,al;if(an!=C){aq=x.createDocumentFragment()}ap=af(ao,an);if(aq){aq.appendChild(ap)}ak=p(ao);++ak;aj=ac[P]-ak;ap=ao.nextSibling;while(aj>0){am=ap.nextSibling;al=O(ap,an);if(aq){aq.appendChild(al)}--aj;ap=am}if(an!=T){ac.setStartAfter(ao);ac.collapse(true)}return aq}function G(ao,aj,ar){var al,au,an,ap,aq,ak,at,am;if(ar!=C){au=x.createDocumentFragment()}al=af(ao,ar);if(au){au.appendChild(al)}an=ao.parentNode;ap=p(ao);aq=p(aj);++ap;ak=aq-ap;at=ao.nextSibling;while(ak>0){am=at.nextSibling;al=O(at,ar);if(au){au.appendChild(al)}at=am;--ak}al=B(aj,ar);if(au){au.appendChild(al)}if(ar!=T){ac.setStartAfter(ao);ac.collapse(true)}return au}function B(ap,aq){var al=ad(ac[ae],ac[P]-1),ar,ao,an,aj,ak,am=al!=ac[ae];if(al==ap){return aa(al,am,false,aq)}ar=al.parentNode;ao=aa(ar,false,false,aq);while(ar){while(al){an=al.previousSibling;aj=aa(al,am,false,aq);if(aq!=C){ao.insertBefore(aj,ao.firstChild)}am=true;al=an}if(ar==ap){return ao}al=ar.previousSibling;ar=ar.parentNode;ak=aa(ar,false,false,aq);if(aq!=C){ak.appendChild(ao)}ao=ak}}function af(ap,aq){var am=ad(ac[A],ac[ah]),an=am!=ac[A],ar,ao,al,aj,ak;if(am==ap){return aa(am,an,true,aq)}ar=am.parentNode;ao=aa(ar,false,true,aq);while(ar){while(am){al=am.nextSibling;aj=aa(am,an,true,aq);if(aq!=C){ao.appendChild(aj)}an=true;am=al}if(ar==ap){return ao}am=ar.nextSibling;ar=ar.parentNode;ak=aa(ar,false,true,aq);if(aq!=C){ak.appendChild(ao)}ao=ak}}function aa(aj,an,aq,ar){var am,al,ao,ak,ap;if(an){return O(aj,ar)}if(aj.nodeType==3){am=aj.nodeValue;if(aq){ak=ac[ah];al=am.substring(ak);ao=am.substring(0,ak)}else{ak=ac[P];al=am.substring(0,ak);ao=am.substring(ak)}if(ar!=T){aj.nodeValue=ao}if(ar==C){return}ap=aj.cloneNode(false);ap.nodeValue=al;return ap}if(ar==C){return}return aj.cloneNode(false)}function O(ak,aj){if(aj!=C){return aj==T?ak.cloneNode(true):ak}ak.parentNode.removeChild(ak)}}return u})();function e(){if(window.getSelection){return function u(x){if(!x){x=window}return x.getSelection()}}else{if(window.document.getSelection){return function w(x){if(!x){x=window}return x.document.getSelection()}}else{return function v(x){if(!x){x=window}return new f(x.document,l)}}}}function j(){if(window.document.createRange){return function v(w){if(!w){w=window.document}return w.createRange()}}else{return function u(w){if(!w){w=window.document}return new l(w)}}}var h=e();var t=j();function c(u){if(!u){u=window}this.doc=u.document;this.selection=h(u)}c.prototype.getSelection=function(){return this.selection};c.prototype.getRange=function(){return t(this.doc)};c.prototype.getSelectedRange=function(){var u;if(this.selection.rangeCount===0){u=null}else{u=this.selection.getRangeAt(0)}if(!u){u=this.getRange();u.setStart(this.doc,0);this.setSelectedRange(u)}return u};c.prototype.setSelectedRange=function(u){if(this.selection.rangeCount&&this.selection.getRangeAt(0)==u){return}if(this.selection.removeAllRanges){this.selection.removeAllRanges()}this.selection.addRange(u)};function r(u){return{c:u.startContainer,off:u.startOffset}}function q(){}q.prototype.selectWord=function i(u,B){u.collapse(B);var A=r(u);var z=this.prevCharPos(A),y=A,w;var x=/[^\s\u00a0]/;while(z&&(w=this.charAt(z))&&x.test(w)){y=z;z=this.prevCharPos(z)}z=y;var v=A;y=v;while((w=this.charAt(v))&&x.test(w)){y=v;v=this.nextCharPos(v)}if(!v){v=y;if((v.nodeType==1&&v.childNodes.length>v.off)||(v.nodeType==3&&v.nodeValue.length>v.off)){++v.off}}u.setStart(z.c,z.off);u.setEnd(v.c,v.off);if(u.collapsed){return""}return u.toString()};q.prototype.prevCharPos=function(u){if(u.c.nodeType==3){if(u.off>0){return{c:u.c,off:u.off-1}}else{return this.prevCharPos({c:u.c.parentNode,off:p(u.c)})}}else{if(u.c.nodeType==1){if(u.off>0){var v=u.c.childNodes[u.off-1];if(v.nodeType==3){return this.prevCharPos({c:v,off:v.nodeValue.length})}}}}return null};q.prototype.nextCharPos=function(u){if(u.c.nodeType==3){if(u.off<u.c.nodeValue.length-1){return{c:u.c,off:u.off+1}}else{if(u.off==u.c.nodeValue.length-1){return this.nextCharPos({c:u.c,off:u.off+1})}else{return this.nextCharPos({c:u.c.parentNode,off:p(u.c)+1})}}}else{if(u.c.nodeType==1){if(u.off<u.c.childNodes.length){var v=u.c.childNodes[u.off];if(v.nodeType==3){if(v.nodeValue.length>0){return{c:v,off:0}}else{return this.nextCharPos({c:v,off:0})}}}}}return null};q.prototype.charAt=function(u){if(u&&u.c.nodeType==3){return u.c.nodeValue.substr(u.off,1)}return null};function d(y,v,u,x){var w=y.ownerDocument.createRange();if(y&&v){w.setStart(y,v)}if(u&&x){w.setEnd(u,x)}else{w.collapse(true)}return w}function m(u){if(u.anchorNode==null||u.focusNode==null){return true}var w=d(u.anchorNode,u.anchorOffset);var v=d(u.focusNode,u.focusOffset);return w.compareBoundaryPoints(w.START_TO_START,v)<=0}function a(v){var u=v.nodeName;if(u=="#text"){u="#"+v.nodeValue}return u}function k(w,v){var u="";if(w.parentNode&&w.parentNode.nodeName!="HTML"){u=k(w.parentNode,p(w))+"/"}return u+a(w)+(v!=null?"["+v+"]":"")}function b(y,v){if(!v){v=new c()}var w=v.getSelection();var u=v.getSelectedRange();if(!y){y=""}else{if(!/ $/.test(y)){y=y+": "}}if(w.rangeCount==0){console.log(y+"No selection.")}else{if(u.collapsed){console.log(y+"current selection position: "+k(u.startContainer,u.startOffset)+" (collapsed)")}else{var x=m(w)?"->":"<-";console.log(y+"current selection range: "+k(u.startContainer,u.startOffset)+"\n\t- "+k(u.endContainer,u.endOffset)+" Direction "+x,u);if(w.anchorNode){console.log("Anchor-focus"+(w.baseNode!=null?", base-extent: ":": ")+k(w.anchorNode,w.anchorOffset)+" - "+k(w.focusNode,w.focusOffset)+(w.baseNode!=null?", "+k(w.baseNode,w.baseOffset)+" - "+k(w.extentNode,w.extentOffset):""))}}}}function n(v,u){if(!v){v=""}else{if(!/ $/.test(v)){v=v+": "}}if(u.collapsed){console.log(v+k(u.startContainer,u.startOffset)+" (collapsed)")}else{console.log(v+k(u.startContainer,u.startOffset)+" - "+k(u.endContainer,u.endOffset),u)}}return{RangeContext:c,RangeUtils:new q(),logSelection:b,logRange:n}});
;
jive.namespace("StatusInput");if(!jive.StatusInput.StatusInputs){define("apps/status_input/status_input",["apps/status_input/data_source","jive/fresh_action_queue","libRange","jquery","jquery/jquery.typeAhead"],function(c,d,b,e){jive.StatusInput.StatusInputs=$Class.extend({init:function(f,g){this._container=e(f);this._i18n=g.i18n;this._statusInputIdPostfix=g.idPostfix;this.statusInputs={};var h=this;e(document).asyncReady(function(){h._docReadyInit(g);h.emit("ready")})},getSubmitVals:function(f){return this.getStatusInput(f).getSubmitVals(true)},resetText:function(f){this.getStatusInput(f).resetText()},_docReadyInit:function(f){var g=this;this._container.find(".jive-js-statusinput").each(function(){var h=e(this).attr("id");g.statusInputs[h]=new jive.StatusInput.StatusInput(e(this),f)})},getStatusInput:function(f){return this.statusInputs[f]}});jive.conc.observable(jive.StatusInput.StatusInputs.prototype);jive.conc.observable(jive.StatusInput.StatusInputs.prototype);jive.StatusInput.StatusInput=$Class.extend({init:function(f,g){try{g.mobileUI=g.mobileUI||jive.rte.mobileUI;this._container=e(f);var i=this._container.get(0);i.insertBefore(document.createTextNode(""),i.firstChild);this.mobileUI=g.mobileUI;if(this.mobileUI){this._container=e("<input type='text' class='rteReplacement'/>");e(f).before(this._container);e(f).remove()}this._mobileEditor=g.mobileUI;this._i18n=g.i18n;this._selection=null;this._replacedInitialText=false;this._statusInputIdPostfix=g.idPostfix;this._initTypeAhead();this._initDD(g);this._initDDHandlers();this._blurWaitTimeout=null;this._maxCharCount=g.maxCharCount;this._maxCharCountBeforeWarning=((this._maxCharCount)?(g.maxCharCountBeforeWarn||this._maxCharCount*0.8):0);this._previousMatchReqsSpaceAfter=null;this._previousPasteVal=null;this._previousSanitizedHTML=null;this._supportsDomRange=e.isFunction(window.getSelection);this._id=this._container.attr("id");this._rangeContext=new b.RangeContext();this._actionQueue=new d();var j=this;e(document).bind("keyup mouseup",function(k){k.stopPropagation();switch(k.which){case 1:case 2:case 3:break;case 13:k.preventDefault();break;case 27:j._dd.hide();return;break;default:break}});this._container.bind("keyup",function(k){k.stopPropagation();switch(k.which){case 13:case 32:k.preventDefault();j._processToken();break;default:break}});this._container.bind("keypress",function(k){switch(k.which){case 13:k.preventDefault();if(j._mobileEditor){return false}break}});this.delay=(function(){var k=0;return function(m,l){clearTimeout(k);k=setTimeout(m,l)}})();this._container.bind("paste",function(k){if(j._checkTokens()){j._processToken();j._processCompleteToken()}else{setTimeout(function(){j._processToken();j._processCompleteToken()},150)}});this._container.bind("keydown",function(l){l.stopPropagation();var k;switch(l.which){case 13:l.preventDefault();break;case 32:j._processToken();break;case 37:k=j._rangeContext.getSelectedRange();if(k&&k.startContainer&&k.startContainer.parentNode==j._container[0].firstChild&&k.startOffset==0){e(j._container[0]).html("&nbsp"+e(j._container[0]).html());k.setStart(j._container[0].firstChild,0);k.collapse(true);j._rangeContext.setSelectedRange(k)}return;case 38:case 40:if(j._dd.isVisible()){l.preventDefault()}break;case 9:j._processToken();return;default:break}j.delay(function(){var n;switch(l.which){case 13:if(j._mobileEditor){return false}if(j._dd.isVisible()){j._dd.hide();return false}var o=document.createElement("br");o.setAttribute("data-jive-statusinputadd","true");var p=document.createTextNode(j._zeroWidthSpace);n=j._rangeContext.getSelectedRange();n.deleteContents();n.insertNode(p);if(e.browser.msie&&parseFloat(e.browser.version.charAt(0))==9){n.insertNode(document.createTextNode("\ufeff"))}n.insertNode(o);n.selectNodeContents(p);n.setStartAfter(p);n.setEndAfter(p);j._rangeContext.setSelectedRange(n);break;case 27:j._dd.hide();j.emit("escapeKeyPress");return;break;case 32:j._dd.hide();j._processCompleteToken();return;break;case 37:case 39:return;break;case 38:return;break;case 40:return;break;case 188:case 191:if(!l.shiftKey){j._dd.hide()}return;break;default:break}if((j._mobileEditor&&j._container.val().length==0)||(!j._mobileEditor&&j._container.text().length==0)){j._dd.hide();if(j._maxCharCount){j.emit("characterLenMsg","ok",{charCount:j.getCharCount()})}return}j.sanitizeHTML();if(!j._replacedInitialText){j._replacedInitialText=true}j._processToken();if(j._maxCharCount){var m=j.getCharCount();if(m>j._maxCharCountBeforeWarning){if(j.getCharCount()>j._maxCharCount){j.emit("characterLenMsg","error",{charCount:m,charOver:m-j._maxCharCount})}else{j.emit("characterLenMsg","warning",{charCount:m,charLeft:j._maxCharCount-m})}}else{j.emit("characterLenMsg","ok",{charCount:j.getCharCount()})}}},75)});this._container.bind("focus",function(k){if(!j.focusing){j.focusing=true;j._onContainerFocus(k)}});this._container.bind("blur",function(k){j._onContainerBlur(k)});this._container.blur(function(k){if(j._blurWaitTimeout){clearTimeout(j._blurWaitTimeout)}j._blurWaitTimeout=setTimeout(function(){j._processCompleteToken();j.emit("blur");j.sanitizeHTMLInterval=window.clearInterval(j.sanitizeHTMLInterval)},400)});this._addInstanceToInstanceObj();this._container.trigger("statusInputSuccess",[this]).data("statusInputStatus",true)}catch(h){this._container.trigger("statusInputFail").data("statusInputStatus",false)}},_onContainerFocus:function(f){this.sanitizeHTML();this.sanitizeHTMLInterval=window.setInterval(e.proxy(this.sanitizeHTML,this),500)},_triggerContainerFocus:function(){if(!this._container.is(":focus")){this._container.trigger("focus")}},_initTypeAhead:function(){var l=this;function h(){return l._checkTokens()}function q(r){return[27,38,40,9].indexOf(r.keyCode)>=0}function n(r){r.stopPropagation();r.preventDefault();return false}function k(t){var s;if(h()){var r=l._dd.isVisible();var u=new e.Event(t.type,{keyCode:t.keyCode});if(t.keyCode==13||t.keyCode==32){if(r&&l.typeAheadProxy.data("typeAhead").getSelected().length>0){s=n(t)}}else{if(q(t)){if(r){n(t);s=false}else{if(t.keyCode==27){n(t)}}}}if(r&&t.type=="keydown"&&t.keyCode==9){if(e("a.jive-js-friends.j-active").length){e("a.jive-js-history").click()}else{if(e("a.jive-js-history.j-active").length){e("a.jive-js-friends").click()}}}l.typeAheadProxy.trigger(u)}else{l.typeAheadProxy.trigger("close")}return s}function m(){if(l._isMention()){var r=l._getMention();if(r&&r.length>=2){l._performSearch(r)}else{l._showDefaultList()}}}this.typeAheadProxy=e("<input type='text' />").typeAhead({hasFocus:function g(){var r=e(document.activeElement);return r.get(0)===l._container.get(0)||r.closest(l._container).length>0},itemSelector:".j-autocomplete-results li:visible, .j-results li:visible",chooseOnSpace:true,ariaParent:this._container,focusTarget:this._container,keystrokeWait:400}).on("selectionChosen",function i(D,x,C,G){if(!l._dd.isVisible()){return}var r=C.find("a");var v=r.attr("data-id")||C.attr("data-id");var t=C.find("span.result-title").html();var u=t?t:"@";var s=r.attr("data-type")||C.attr("data-type");s=(jive.global.typeToNumeric&&jive.global.typeToNumeric[s])?jive.global.typeToNumeric[s]:s;if(r.hasClass("jive-js-status-input-create")){var F={newtag:1};l._dd.emit("interactionFinished",{link:r,index:-1,value:'<span class="jive-icon-med jive-icon-tag"></span>'+v,href:_jive_base_url+"/tags#/?tags="+v,html:r.html()},F)}else{if(r.data("command")==="more"){l._dd.expand(r)}else{var E=r.html(),z=r.attr("href");if(!v&&r.attr("data-objectType")&&r.attr("__default_attr")){v=r.attr("data-objectType")+"-"+r.attr("__default_attr")}var A=e(".j-statusinput-form :input");var y=A.filter('[name="contentID"]').val();var B=A.filter('[name="typeID"]').val();var w=new jive.rte.EntitlementService({objectID:y?y:0,objectType:B?B:0,entitlement:"VIEW"});w.checkEntitlement(s,v).addCallback(function(H){if(!H){var I="";if(s===3){I=jive.i18n.keys.tinymceJivementionNoNotification()}else{if(s===700){I=jive.i18n.keys.tinymceJivementionSecretGroup()}else{I=jive.i18n.keys.tinymceJivementionRestrictedContent()}}e("<p>"+u+" "+I+"</p>").message({style:"warn"})}});l._dd.emit("interactionFinished",{link:r,value:E,href:z,id:v,objectType:s})}}}).on("keystroke",function(r){m()}).on("focusWaitFinished",function(){if(!l._dd.isVisible()){l._processToken()}}).on("close blurWaitFinished",function(){l._dd.hide()});var j=this._container.on("keydown keyup",function(r){if(k(r)===false){r.stopImmediatePropagation()}}).attr("aria-autocomplete","list").attr("role","combobox").attr("tabindex","0");if(this._i18n&&this._i18n.ariaLabel){j.attr("aria-label",this._i18n.ariaLabel)}if(this._statusInputIdPostfix){var o="jive-508-label-";if(this._statusInputIdPostfix=="mbASHeader"&&this._container&&this._container.length>0){var p=this._container.attr("id");if(p){o=o+p}}else{o=o+"message-"+this._statusInputIdPostfix}var f=e("#"+o);if(f&&f.length>0){j.attr("aria-labelledby",o)}}},_addInstanceToInstanceObj:function(){jive.StatusInput.StatusInput.instances[this._id]=this},getContainer:function(){return this._container},isContainerEditable:function(){var f=this._container.attr("contenteditable");return f&&f==="true"},setContainerEditable:function(f){this._container.attr("contenteditable",f)},getSubmitVals:function(f){if(f){this._truncateNodes()}var g;if(this._mobileEditor){g=jive.util.escapeHTML(this._container.val())}else{g=this._container.html()}g=g.replace(/(.+)<\/?br\s?_?.*>/ig,"$1");g=g.replace(/(<\/?)(\w+)([^>]*>)/gi,function(k,j,i,h){return j+i.toLowerCase()+h.replace(/((data-jive-statusInputadd)|(data-jive-truncation-flag))=["']true["']/gi,"")});g=g.replace(/(<\/?[aA]\s+[^>]*href=")([^"]*)("[^>]*>)/gi,function(l,k,j,i){if(l.search(/<\w+[^>]*data-jive-statusinputinteral="true"[^>]*>/gi)!=-1){var h=j.replace(/https?\:\/\//,"").split("/").slice(1).join("/");return k+"/"+h+i}else{return l}});return g},_truncateNodes:function(){if(this.getCharCount()>this._maxCharCount){var m=this._container[0].childNodes;var l=0;var k=false;for(var h=0;h<m.length;h++){var g=m[h];if(k){this._container[0].removeChild(g)}else{var f=e(g).text().length;if(l+f>this._maxCharCount){var j=this._maxCharCount-l;this._truncateNode(g,j);k=true}l+=f}}}},_truncateNode:function(h,f){if(h.nodeType==3){var j=h.nodeValue;if(j.length<f){return f-j.length}else{h.nodeValue=h.nodeValue.substr(0,f);return 0}}else{var k=h.childNodes;for(var g=0;g<k.length;g++){if(f==0){h.removeChild(k[g])}else{f=this._truncateNode(k[g],f)}}}},truncateAnchors:function(){e(this._container).find("[data-jive-statusinputadd=true]:not([data-jive-truncation-flag=true],[data-jive-statusinputinteral=true],[data-jive-untrusted-link])").each(function(){var f=e(this);f.contents().filter(function(){return this.nodeType==3}).each(function(){var g=e(this);g.replaceWith(document.createTextNode(jive.util.truncateStr(g.text())))});f.attr("data-jive-truncation-flag",true)})},sanitizeHTML:function(){var g=this._container.html();if(this._previousSanitizedHTML==g){return}var m=this._container[0];if(m.childNodes.length==0||(m.childNodes.length==1&&m.lastChild.nodeName.toLowerCase()=="br")){m.insertBefore(document.createTextNode(""),m.lastChild)}var i=m.lastChild;if(!e.browser.msie&&(i==null||i.nodeType==3||i.nodeName&&i.nodeName.toLowerCase()!="br")){var j=document.createElement("br");j.setAttribute("_moz_dirty","");m.appendChild(j)}this.truncateAnchors();if(!e.browser.msie){g=g.replace(/<\/?br[^>]*>$/mi,"")}var p=this;this._container.find("a[data-jive-statusinputadd=true]").filter(function(){return e(this).text()==""}).each(function(){var s=p._rangeContext.getSelectedRange(),r=p._rangeContext.getRange(),t=false;r.selectNode(this);if(r.compareBoundaryPoints(r.START_TO_START,s)<=0||r.compareBoundaryPoints(r.END_TO_END,s)>=0){t=true}r.deleteContents();if(t){p._rangeContext.setSelectedRange(r)}});var k=this._container.children("[data-jive-statusInputadd!=true]");if(!e.browser.msie){k=k.filter(":not(:last)")}k.filter("br").not("[_moz_dirty]").each(function(){e(this).replaceWith("<br />")});k=k.not("br");if(k.length>0){var h,l=0,o=function(r){return/^style$/i.test(r.nodeName||"")},n=function(r){return/^(i|b|strong)$/i.test(r.nodeName||"")},q=function(r){if(/^(p|div)$/i.test(r.tagName)){return l++>0}return false};k.each(function(){var r=e(this);if(o(this)){r.remove()}else{if(n(this)){r.replaceWith(r.contents())}else{if(q(this)){r.before('<br data-statusInputadd="true" />')}h=document.createTextNode(r.text());p._container[0].replaceChild(h,this)}}});if(!e.browser.msie&&h){var f=this._rangeContext.getRange();f.selectNodeContents(h);f.collapse(false);this._rangeContext.setSelectedRange(f)}}this._previousPasteVal=this._container.text();this._previousSanitizedHTML=this._container.html()},resetText:function(){this._setText("");this._replacedInitialText=false;this.emit("characterLenMsg","ok",{charCount:this.getCharCount()})},getCharCount:function(){if(this.mobileUI){return this._container.val().length}else{return this._container.text().length}},_setText:function(f){if(this._mobileEditor){this._container.val(jive.util.unescapeHTML(f))}else{this._container.html(f)}},_focus:function(f){this._container.blur();this._container.attr("contentEditable",false).attr("contentEditable",true);this._container.focus()},_createNewSelectionUtil:function(){var g=false;if(e.browser.msie){if(this._container.contents().length==0){return}}else{var h=this._container[0].lastChild;if(!h){this.sanitizeHTML();h=this._container[0].lastChild}g=h.nodeName.toLowerCase()=="br"}var f=this._rangeContext.getRange();f.selectNode(this._container[0].lastChild);f.collapse(g);this._rangeContext.setSelectedRange(f)},_isMatch:function(g,f){return f.search(new RegExp(this._getPatterns()[g],"gi"))>-1},_matchUtil:function(g,f){return f.match(new RegExp(this._getPatterns()[g],"gi"))},_isMention:function(){var f=this._rangeContext.getSelectedRange().cloneRange();var g=b.RangeUtils.selectWord(f,true);return this._isMatch("mention",g)},_getMention:function(){var f=this._rangeContext.getSelectedRange().cloneRange();var h=b.RangeUtils.selectWord(f,true);var g=this._matchUtil("mention",h)[0];return g.substr(1,g.length)},_checkTokens:function a(){var g=this._rangeContext.getSelectedRange().cloneRange();var i=b.RangeUtils.selectWord(g,true);var h=this._getTokens();var f=false;e.each(Object.keys(h),function(){var j=h[this];if(i.match(j.regExp)){f=true;return false}});return f},_processToken:function(){if(!this._mobileEditor){var f=this._rangeContext.getSelectedRange().cloneRange();var g=b.RangeUtils.selectWord(f,true);g=g.replace(/^[\u200B\uFEFF]/i,"");if(g===""||g.slice(-1)===","){this._processCompleteToken()}else{this._processPartialToken(g,this._rangeContext.getSelectedRange().startContainer)}}},_processCompleteToken:function(){if(!this._dd.isVisible()){var f=this._tokenCallbacks||[];f.forEach(function(g){g()});if(f.length<1){this._dd.hide()}this._tokenCallbacks=[]}},_processPartialToken:function(k,i){var h=[],j=this._getTokens(),f=false,g=this;Object.keys(j).forEach(function(l){var m=j[l],n=k.match(m.regExp),o=k.match('^href="');if(n&&!o){f=true;n.push(i);if(m.complete){h.push(function(){m.complete.apply(g,n)})}if(m.keypress){m.keypress.apply(g,n)}}});if(!f){this._dd.hide()}this._tokenCallbacks=h},_performSearch:function(h){var g=this;var f=c.search(h);this._dataGroup=(this._dataGroup||0)+1;f.forEach(function(i){g._actionQueue.push(i,g._dataGroup).then(g._assembleData.bind(g)).then(g._dd.renderSearchData.bind(g._dd))})},_assembleData:function(f){if(!this._lastData){this._lastData=[{type:"people",list:[]},{type:"places",list:[]},{type:"content",list:[]}]}this._lastData=this._lastData.map(function(g){return g.type===f.type?f:g});return{sections:this._lastData.filter(function(g){return g.list.length>0})}},_getMacroname:function(f){return jive.global.typeToMacroName[f]},_getObjectType:function(f){return jive.global.typeToNumeric[f]},_zeroWidthSpace:e.browser.msie&&parseFloat(e.browser.version.charAt(0))<9?"\uFEFF":"\u200b"});jive.StatusInput.StatusInput.instances={};jive.StatusInput.StatusInput.sanitizeHTMLIntervalHandler=function(){for(var f in jive.StatusInput.StatusInput.instances){jive.StatusInput.StatusInput.instances[f].sanitizeHTML()}};jive.StatusInput.StatusInput.getRegExpsFromPatterns=function(f){var g={};Object.keys(f).forEach(function(h){var i=f[h],j;if(e.isArray(i)){j=i.map(function(k){return"("+k+")"}).join("|")}else{j=i}g[h]=new RegExp(j)});return g};jive.StatusInput.StatusInput.Patterns={mention:"@([^@ ]+)?"};jive.StatusInput.StatusInput.Tokens={mention:{regExp:new RegExp(jive.StatusInput.StatusInput.Patterns.mention,"i"),keypress:function(g,f){if(f&&f.length>=2){this._performSearch(f)}else{}}}};jive.conc.observable(jive.StatusInput.StatusInput.prototype);jive.StatusInput.renderAttachmentsWrapper=function(g,f,h){if(g.attachments){f.append(jive.statusinput.attachments.renderAttachments({entry:{meta:g.attachments},removable:h}))}else{f.append(jive.statusinput.attachments.renderAttachments(e.extend({},g,{removable:h})))}if(h){f.slideDown("fast",function(){e(this).animate({opacity:1},500)})}else{f.css("opacity","1").show()}jive.StatusInput.bindAttachment(f.find("ul.j-attached-items"),h)};jive.StatusInput.renderAttachmentWrapper=function(g,f,h){f.append(jive.statusinput.attachments.renderAttachment(e.extend(g,{removable:h})))};jive.StatusInput.bindAttachment=function(g,i){var f=0,h;g.find("li:visible").each(function(){f+=e(this).outerWidth()});if(g.find("li.js-attached-link").length==0){g.css("width",f+"px").data("innerWidth",f)}h=g.width()-g.closest(".j-attachment-container").width();if(h>0&&i){g.animate({left:(h*-1-40)},300)}g.find("li a.j-attach-anchor").unbind("hover").hover(function(){e(this).find(".j-icon-play").stop().fadeTo("fast",0.6)},function(){e(this).find(".j-icon-play").stop().fadeOut("fast")});g.parent().find("a.j-attachment-arrow").unbind().mousedown(function(){try{var k;var m=e(this).outerWidth()*2;h=g.width()-g.closest(".j-attachment-container").width();var j=parseInt(g.css("left"));if(isNaN(j)){j=0}if(e(this).hasClass("j-attachment-arrow-right")&&h>0){k=j+(h+m);g.stop().animate({left:(-h-m)},k*5,"linear")}else{if(h>0){k=j*-1;g.stop().animate({left:0},k*5,"linear")}}}catch(l){console.log(l)}}).mouseup(function(){g.stop();return false}).click(function(){return false});if(!i){jive.StatusInput.sizeContainer(g.parent().parent())}else{jive.StatusInput.showArrows()}};e(window).resize((function(){var f;return function(){var g=e(window).width();if(f&&g!==f){jive.StatusInput.sizeContainer()}f=g}})());jive.StatusInput.sizeContainer=function(g){var f;g=g||e(document);g.find(".j-attachment-container:visible:has(ul.j-attached-items)").hide().each(function(){var h=e(this),i=h.closest(".jive-table-cell-activity"),k=h.closest(".j-wall-repost-content"),l=h.parent(),j;if(i.length>0){j=i.width()}else{if(k.length>0){j=k.width()}else{if(h.closest(".j-wall-form").length>0){j=0}else{if(e.browser.msie){j=l.width()-12}else{j=l.width()}}}}f=h.find("ul.j-attached-items").data("innerWidth")||Number.POSITIVE_INFINITY;if(j>0){e(this).width(Math.min(j,f)).show()}else{h.show()}});jive.StatusInput.showArrows(g)};jive.StatusInput.showArrows=function(f){f=f||e(document);f.find("ul.j-attached-items:visible").each(function(){var h=e(this),g=h.parent();if(g.innerWidth()<h.innerWidth()){g.find("a.j-attachment-arrow").css("display","block");h.css("margin","0 20px")}else{g.find("a.j-attachment-arrow").hide();h.css({margin:"0",left:0})}})};return jive.StatusInput})};
;
goog.provide("jive.statusinput.dropdown.ddCreateTag");
jive.statusinput.dropdown.ddCreateTag=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<a class="jive-js-status-input-selectable jive-js-status-input-create j-createTag" href="#" data-id="',soy.$$escapeHtml(opt_data.currentTagText),'" data-type="tag"><span class="jive-icon-tag jive-icon-med"></span><span class="j-createLabel font-color-normal">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.create.colon"),[])),' </span><span class="result-title lnk">',
soy.$$escapeHtml(opt_data.currentTagText),"</span></a>");return opt_sb?"":output.toString()};
;
goog.provide("jive.statusinput.dropdown.ddOutputTags");
jive.statusinput.dropdown.ddOutputTags=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<ul class="j-autocomplete-results j-icon-list" role="listbox">');if(opt_data.shouldCreateTag&&opt_data.allowTagCreation){output.append('<li role="option">');jive.statusinput.dropdown.ddCreateTag(opt_data,output);output.append("</li>")}var entryList9=opt_data.entries;var entryListLen9=entryList9.length;for(var entryIndex9=0;entryIndex9<entryListLen9;entryIndex9++){var entryData9=
entryList9[entryIndex9];output.append('<li role="option"><a class="jive-js-status-input-selectable" href="',soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/tags#/",{tags:entryData9})),'" data-id="',soy.$$escapeHtml(entryData9),'" data-type="tag"><span class="jive-icon-med jive-icon-tag"></span><span class="result-title lnk">',soy.$$escapeHtml(entryData9),"</span></a></li>")}output.append("</ul>");return opt_sb?"":output.toString()};
;
goog.provide("jive.statusinput.dropdown.ddTagsContent");
jive.statusinput.dropdown.ddTagsContent=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.currentTagText)jive.statusinput.dropdown.ddOutputTags(opt_data,output);else output.append('<p class="j-autocomplete-tag-prompt j-autocomplete-prompt j-pop-desc">',opt_data.allowTagCreation?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("wallentry.status_input.dd.tags.title"),["Continue typing to search tags or create new tags"])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("wallentry.status_input.dd.tags.title_no_create"),
["Continue typing to search tags"])),"</p>");return opt_sb?"":output.toString()};
;
goog.provide("jive.statusinput.dropdown.ddTags");jive.statusinput.dropdown.ddTags=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-autocomplete-container j-pop-main j-menu j-quick-menu">');jive.statusinput.dropdown.ddTagsContent(opt_data,output);output.append("</div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.statusinput.dropdown.ddOutputEntries");
jive.statusinput.dropdown.ddOutputEntries=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;var sectionList3=opt_data.sections;var sectionListLen3=sectionList3.length;for(var sectionIndex3=0;sectionIndex3<sectionListLen3;sectionIndex3++){var sectionData3=sectionList3[sectionIndex3];output.append('<div class="j-results j-spotlight-find" data-type="',soy.$$escapeHtml(sectionData3.type),'"><h4 class="font-color-meta">',sectionData3.type=="people"?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.search_for.people"),
[])):sectionData3.type=="places"?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.search_for.places"),[])):sectionData3.type=="content"?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.search_for.content"),[])):"","</h4>");jive.autosearch.resultSection(soy.$$augmentMap(sectionData3,{max:5}),output);output.append("</div>")}return opt_sb?"":output.toString()};
;
goog.provide("jive.statusinput.dropdown.ddDefault");
jive.statusinput.dropdown.ddDefault=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-pop-main j-menu j-quick-menu j-autocomplete-container jive-spotlight-search-result" aria-live="polite"><p class="j-pop-desc j-autocomplete-prompt" style="max-height:none">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("wallentry.status_input.dd.default.title"),[])),'</p><div class="js-nav-menu-scrollable">');jive.statusinput.dropdown.ddOutputEntries(opt_data,
output);output.append("</div></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.statusinput.dropdown.ddSearch");
jive.statusinput.dropdown.ddSearch=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-autocomplete-container jive-spotlight-search-result j-pop-main j-menu j-quick-menu"><p class="j-pop-desc j-autocomplete-prompt" style="max-height:none">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("wallentry.status_input.dd.search.hint"),[])),'</p><div class="js-nav-menu-scrollable">');jive.statusinput.dropdown.ddOutputEntries(opt_data,output);output.append("</div></div>");
return opt_sb?"":output.toString()};
;
jive.namespace("MicroBlogging");define("apps/microblogging/status_input_drop_down",["apps/status_input/data_source","jquery","underscore","soy!jive.statusinput.dropdown.ddTags","soy!jive.statusinput.dropdown.ddDefault","soy!jive.statusinput.dropdown.ddSearch"],function(b,f,a,e,d,c){var g=f;if(!jive.MicroBlogging.StatusInputDropDown){jive.MicroBlogging.StatusInputDropDown=$Class.extend({init:function(j,i,h){h=h||{};var k=this;this._$popoverContext=g(j);this._typeAhead=i;this._dd=null;this._allowTagCreation=typeof h.allowTagCreation==="undefined"||h.allowTagCreation;this._typeAhead.options.eventTarget.on("selectionChanged",function(m,o,l,p){var q=l.data("id");var n=l.data("type");if(n&&q){k._lastSelected=[n,q]}if(p!=="mouse"){k.scrollTo(l)}})},renderDefaultList:function(j,h){if(this._unchanged(j)){return}var i=this._formatResults(j);this._render(f(d(i)),h)},renderTagsData:function(k,l,i){var h=k?this._normalizeTagsData(k):[];var j=!h.some(function(m){return m===l});if(this._allowTagCreation||!l||h.length>0){this._render(f(e({entries:h,currentTagText:l,allowTagCreation:this._allowTagCreation,shouldCreateTag:j})),i)}else{this.hide()}},renderSearchData:function(j,h){if(j.sections.length>0){if(this._unchanged(j)){return}var i=this._formatResults(j);this._render(f(c(i)),h)}else{this.hide()}},hide:function(){if(this._dd){this._dd.trigger("close");delete this._dd;delete this._lastEntries;delete this._lastSelected}this._shown=false;this.emit("close")},show:function(h){if(this._dd&&!this._shown){this._dd.popover(f.extend({context:this._$popoverContext,position:"below",align:"left",arrowOffset:6,duration:0,destroyOnClose:true,focusPopover:false,setRole:"listbox",containWithinViewport:true,onClose:this.hide.bind(this)},h));this._shown=true}},isVisible:function(){return this._shown},selectItem:function(i){if(!this._dd){return}var h=this._typeAhead.getSelectable().eq(i);this._typeAhead.setSelected(h)},selectItemById:function(i,j){if(!i||!j){return}var h=this._typeAhead.getSelectable().filter(function(l,m){var k=f(m);return k.data("type")===i&&k.data("id")===j});if(h.length>0){this._typeAhead.setSelected(h.filter(":first"))}},scrollTo:function(h){if(!this._dd||!this._dd.find(".js-nav-menu-scrollable").length){return}var k=this._dd.find(".js-nav-menu-scrollable");var l=k.height();var r=k.offset().top;var i=r+l;var o=h.outerHeight();var q=h.offset().top;var p=q+o;var n=k.find("h4").outerHeight()||32;var m=q<r+n;var j=p>i-n;if(m){k.scrollTo(h,{offset:0-n})}else{if(j){k.scrollTo(h,{offset:0-(l-o-n)})}}},expand:function(j){var i=f(j);var h=i.closest("ol,ul").find("li.j-inactive").removeClass("j-inactive").first();this._typeAhead.setSelected(h);i.closest("li").addClass("j-inactive")},_normalizeTagsData:function(h){if(h&&h.tagSearchResult){return h.tagSearchResult.filter(a.prop("found")).map(a.prop("name"))}},_getCollectionFromData:function(h){return h.mentionCollection||h},_getCollectionEntriesFromData:function(i){var h=i.mentionCollection?i.mentionCollection.entries:i.entries;return f.isArray(h)?h:[h]},_render:function(i,h){if(this.isVisible()){this._dd.empty().append(i.children());this._dd.trigger("triggerPopoverReposition");this.selectItemById.apply(this,this._lastSelected||[])}else{this._dd=i;this.show(f.isFunction(h)?h():h)}this._typeAhead.setSuggestElement(this._dd)},_unchanged:function(i){var h=this._lastEntries;this._lastEntries=i;return h&&b.equals(i,h)},_formatResults:function(h){h.sections=a.map(h.sections,function(i){i.list=a.map(i.list,function(j){if(j.subject){}return j});return i});return h}});jive.MicroBlogging.StatusInputDropDown.selectedItemClassName="jive-js-status-input-selected";jive.MicroBlogging.StatusInputDropDown.selectableItemClassName="jive-js-status-input-selectable";jive.conc.observable(jive.MicroBlogging.StatusInputDropDown.prototype);jive.MicroBlogging.StatusInputDropDown.delay=(function(){var h=0;return function(j,i){clearTimeout(h);h=setTimeout(j,i)}})()}return jive.MicroBlogging.StatusInputDropDown});
;
define("apps/microblogging/link_builder",["jquery"],function(d){function b(g,h){var l=g.find(".result-title").text(),e=g.attr("href"),f=g.data("id")||g.closest("[data-id]").data("id"),i=g.data("type")||g.closest("[data-type]").data("type"),j=g.find('[class*="jive-icon"]'),k=a((j.attr("class")||"").split(/\s+/)),m=d(h());m.text(l).attr("href",e).addClass(k);if(f){m.attr("jiveID",f);m.attr("data-id",f)}if(i){m.attr("data-type",i)}return m}function c(){}function a(g){var f={"jive-icon-blog":"jive-link-blog-small","jive-icon-doctype-compressed":"jive-icon-doctype-compressed-small","jive-icon-discussion":"jive-icon-discussion-small","jive-icon-discussion-bridged":"jive-icon-discussion-bridged-small","jive-icon-discussion-correct":"jive-icon-discussion-correct-small","jive-icon-discussion-question":"jive-icon-discussion-question-small","jive-icon-doctype-acrobat":"jive-icon-doctype-acrobat-small","jive-icon-doctype-document":"jive-icon-doctype-document-small","jive-icon-doctype-image":"jive-icon-doctype-image-small","jive-icon-doctype-presentation":"jive-icon-doctype-presentation-small","jive-icon-doctype-spreadsheet":"jive-icon-doctype-spreadsheet-small","jive-icon-document":"jive-link-wiki-small","jive-icon-document-upload":"jive-link-wiki-small","jive-icon-external-site":"jive-link-url-small","jive-icon-group":"jive-link-socialgroup-small","jive-icon-poll":"jive-link-poll-small","jive-icon-profile":"jive-link-profile-small","jive-icon-project":"jive-link-project-small","jive-icon-tag":"jive-link-tag-small","jive-icon-tile-activity":"jive-link-tilestream-small","jive-icon-space":"jive-link-community-small","jive-icon-idea":"jive-link-idea","jive-icon-event":"jive-link-event","jive-icon-video":"jive-link-video-small","jive-icon-status":"jive-link-status-small","jive-icon-task":"jive-link-task-small"},e=d.map(g,function(h){return h in f?f[h]:null});return e.shift()||"jive-link-profile-small"}return{objectRef:b,tagRef:c}});
;
jive.namespace("MicroBlogging");if(!jive.MicroBlogging.StatusInputs){define("apps/microblogging/status_input",["apps/status_input/status_input","apps/microblogging/status_input_drop_down","apps/status_input/data_source","apps/microblogging/link_builder","libRange","jive/promise_util","jquery"],function(b,f,c,h,a,e,d){var g=d;jive.MicroBlogging.StatusInputs=b.StatusInputs.extend({_docReadyInit:function(i){this._container.find(".jive-js-statusinput").each(function(l,j){var n=g(j).attr("id"),m=this.emit.bind(this,"characterLenMsg"),k=this.emit.bind(this,"atMentionFinished");this.statusInputs[n]=new jive.MicroBlogging.StatusInput(j,i).addListener("characterLenMsg",m).addListener("atMentionFinished",k)}.bind(this))}});jive.MicroBlogging.StatusInput=jive.StatusInput.StatusInput.extend({init:function(i,j){this._super(i,j);this._focusOnRdy=j.focusOnRdy;this._allowTagCreation=j.allowTagCreation==undefined?true:j.allowTagCreation;this._doNotAnimate=j.doNotAnimate==undefined?false:j.doNotAnimate;this.firefox=navigator.userAgent.toLowerCase().indexOf("firefox")>-1;var k=this;if(j.defaultValue){k._container.prev(".jive-js-statusinput-default").hide()}else{this._origHeight=0}this._container.bind("click",function(m){if(k.firefox){var l=k.focusing;k.focusing=true;k._container.blur();k._container.attr("contentEditable",false).attr("contentEditable",true);k._container.focus();if(!l){k.focusing=false}}k._triggerContainerFocus()});this._container.prev(".jive-js-statusinput-default").keydown(function(l){if(l.keyCode==13||l.keyCode==32){k._triggerContainerFocus()}});this._container.prev().focus(function(){k._triggerContainerFocus()})},_setOriginalHeight:function(){if(this._origHeight==0){this._origHeight=g(this._container).height()}},triggerOnFocusAnimation:function(){if(this._focusOnRdy){this._triggerContainerFocus()}},_onContainerFocus:function(k){var j=this;var i;this._super(k);this._container.prev(".jive-js-statusinput-default").hide();g("#j-js-mb-success").hide();if(!this._doNotAnimate){this._setOriginalHeight();i=this._container.animate({minHeight:Math.max(this._origHeight*2.2,15)},150,function(){if(j.firefox){j._container.blur();j._container.attr("contentEditable",false).attr("contentEditable",true);j._container.focus()}j.focusing=false})}else{j.focusing=false}this._container.addClass("j-mb-focused");this._container.attr("contentEditable",true);c.warmCache();this.emit("focus")},_onContainerBlur:function(i){this._container.removeClass("j-mb-focused");if(!this.getSubmitVals()){this._container.prev(".jive-js-statusinput-default").show()}c.clearCache()},_initDD:function(i){this._dd=new f(this._container,this.typeAheadProxy.data("typeAhead"),i)},_initDDHandlers:function(){var i=this;this._dd.addListener("interactionFinished",function(q,s){var o=h.objectRef(q.link,document.createElement.bind(document,"a"));d.each(d.extend({"data-jive-statusInputadd":"true","data-jive-statusInputInteral":"true"},s),function(u,v){o.attr(u,v)});var m=o.attr("data-id");var p=o.attr("data-type");var t=o.data("type")==="tag"?m:null;var r=t?"tag":i._getMacroname(p);var l=i._getObjectType(p);o.attr("href","javascript:;");o.attr("data-objectType",l);o.attr("jivemacro",r);o.attr("_modifiedtitle","true");o.addClass("jive_macro jive_macro_"+r);if(!t){o.attr("___default_attr",m)}if(t){o.attr("_tag",t)}var k=document.createTextNode(i._zeroWidthSpace);var j=i._rangeContext.getSelectedRange();a.RangeUtils.selectWord(j,true);var n=j.cloneRange();j.collapse(false);j.insertNode(k);k.parentNode.insertBefore(o.get(0),k);n.deleteContents();j.selectNodeContents(k);j.collapse(false);i._rangeContext.setSelectedRange(j);i._dd.hide();i.emit("atMentionFinished",q.id,q.value,q.objectType)})},_getTokens:function(){return jive.MicroBlogging.StatusInput.Tokens},_getPatterns:function(){return jive.MicroBlogging.StatusInput.Patterns},_showDefaultList:function(i){var j=this;this._actionQueue.push(e.whenAll(c.defaultData())).then(function(k){j._lastData=k;j._dd.renderDefaultList({sections:k.filter(function(l){return l.list.length>0})});if(i){j._dd.selectItem(0)}})},_showTagsList:function(j){var i=this;this._actionQueue.push(c.tags(j)).then(function(k){i._dd.renderTagsData(k,d.trim(j))})},handleAtMentionButtonClick:function(){this._replacedInitialText=true;this._container.focus();var j=this._rangeContext.getSelectedRange();if(g(j.commonAncestorContainer).parents(this._container).length==0){j.selectNodeContents(this._container[0]);j.collapse(false)}var l=j.cloneRange();if(a.RangeUtils.selectWord(l,false).length>0){l.collapse(false);var k=document.createTextNode(" ");l.insertNode(k);l.selectNodeContents(k);l.collapse(false);j=l}var i=document.createTextNode("@");j.insertNode(i);j.selectNodeContents(i);j.collapse(false);this._rangeContext.setSelectedRange(j);this._showDefaultList()},handleInsertLink:function(k){this._focus(true);k=k.trim();if(!this._isMatch("linkURL",k)){k="http://"+k}this._createNewSelectionUtil();var j=this._rangeContext.getSelectedRange();var i=document.createTextNode(k);j.insertNode(i);j.selectNodeContents(i);j.collapse(false);this._rangeContext.setSelectedRange(j);if(this._isMatch("linkURL",k)){this._processToken();this._processCompleteToken()}},swapLinkFor:function(i,l){var j=this;function k(r,p,q){if(r.nodeType==3){var o=null;var u=r.nodeValue;if(u.indexOf(p)<0){return}if(u.indexOf(p)==(u.length-p.length)){var n=document.createTextNode(" ");r.parentNode.insertBefore(n,r);r.parentNode.insertBefore(r,r.previousSibling);r.nodeValue=u.substring(0,u.indexOf(p));r.parentNode.insertBefore(g(l)[0],r);r.parentNode.insertBefore(r,r.previousSibling);o=n}else{if(u.indexOf(p)==0){r.nodeValue=u.substring(p.length);r.parentNode.insertBefore(g(l)[0],r);o=r}else{var v=u.substring(0,u.indexOf(p));var w=u.substring(u.indexOf(p)+p.length);r.nodeValue=w;r.parentNode.insertBefore(document.createTextNode(v),r);r.parentNode.insertBefore(g(l)[0],r);o=r}}if(o.nodeType==3&&o.nodeValue.length>1){var t=document.createTextNode(o.nodeValue.substring(1));o.nodeValue=o.nodeValue.substring(0,1);r.parentNode.insertBefore(t,o);r.parentNode.insertBefore(o,t)}var m=j._rangeContext.getSelectedRange();m.selectNodeContents(o);m.collapse(false);j._rangeContext.setSelectedRange(m)}if(r.nodeType==1){if(r.nodeName.toLowerCase()=="a"){return}else{for(var s=0;s<r.childNodes.length;s++){k(r.childNodes[s],p,q)}}}}k(this._container[0],i,l)}});(function(i){var j={mention:"^(@|)([^@ ]+)?",tags:"^#([^#, /]+)?",imageURL:"https?\\://\\S+(\\.png|\\.jpg|\\.gif|\\.jpeg)",linkURL:"https?\\://\\S+",youtubeURL:"https?\\://(?:[\\w\\-]+\\.)?youtube\\.com/watch\\S*[&?]v=([^&\\s]+)\\S*",httpNoSsl:"http\\://\\S+"};i.Patterns=j;i.Tokens={mention:{regExp:new RegExp(j.mention,"i"),keypress:function(l,k){if(!k||k.length<2){this._showDefaultList()}}},tags:{regExp:new RegExp(j.tags,"i"),keypress:function(l,k){if(k&&k.length<=56){if(k&&k.length>=2){this._showTagsList(k)}else{this._dd.renderTagsData()}}}},imageURL:{regExp:new RegExp(j.imageURL,"i"),keypress:function(k,n,m){if(!g(m).parent().attr("data-jive-statusinputImageURL")){this.emit("imageURLMatch",k);var l=g("<a></a>").text(k).attr("href",k).attr("data-jive-statusinputadd",true).attr("data-jive-statusinputImageURL",true);this.swapLinkFor(k,l)}this._dd.hide()}},linkURL:{regExp:new RegExp(j.linkURL,"i"),complete:function(k,m){var l=g(m);if(l.text()!==""&&!l.parent().attr("data-jive-statusinputImageURL")){this.emit("linkURLMatch",k)}this._dd.hide()}},youtubeURL:{regExp:new RegExp(j.youtubeURL,"i"),complete:function(k,m){var l=new RegExp(j.httpNoSsl,"i");if(k.match(l)){k=k.replace("http","https")}this.emit("youtubeURLMatch",k);this._dd.hide()}}}})(jive.MicroBlogging.StatusInput);return jive.MicroBlogging})};
;
jive.namespace("MicroBlogging");define("apps/microblogging/views/status_input_common_view",["apps/microblogging/status_input","apps/microblogging/views/attachment_view","jquery"],function(d,a,b){var c=b;jive.MicroBlogging.CommonView=jive.AbstractView.extend(function(e,f){this.init=function(g){f.init.call(this,g);this.idPostfix=g.idPostfix;this.maxCharCount=g.maxCharCount;this.statusInput=null;this.attachmentsView=null;this.$waitingViewElem=null;this.$formElem=null;this.$imageFormElem=null;this.mobileUI=g.mobileUI||jive.rte.mobileUI;this.atMentionBtn=g.atMentionBtn;this.imagesEnabled=g.imagesEnabled||window._jive_images_enabled||false;this.imgAttachmentBtn=g.imgAttachmentBtn;this.linkBtn=g.linkBtn;this.submitBtn=g.submitBtn;this.cancelBtn=g.cancelBtn;this.publishBarIdentifier="";this.publishBarViewBean=false;if(g.publishBarIdentifier){this.publishBarIdentifier=g.publishBarIdentifier}if(g.publishBarViewBean){this.publishBarViewBean=g.publishBarViewBean}if(g.supportAttachments==undefined){this.supportAttachments=true}else{this.supportAttachments=g.supportAttachments}this.doNotAnimate=!!g.doNotAnimate;this.allowTagCreation=g.allowTagCreation};this.postRender=function(){var g=this;if(this.mobileUI&&this.atMentionBtn.length){this.atMentionBtn.remove()}this.createFormElem();this.createWaitingViewElem();this.createWaitingView();this.createActionContainer();this.statusInput=new d.StatusInput(this.getContent().find(".jive-js-statusinput"),{maxCharCount:this.maxCharCount,idPostfix:this.idPostfix,focusOnRdy:true,doNotAnimate:this.doNotAnimate,allowTagCreation:this.allowTagCreation,i18n:{}});this.statusInput.addListener("characterLenMsg",g.handleCharacterLenMsg.bind(g)).addListener("atMentionFinished",g.handleAtMentionResult.bind(g));this.atMentionBtn.click(function(h){g.handleAtMentionClick(h,c(this))});if(this.linkBtn){this.linkBtn.click(function(h){if(!g.linkBtn.hasClass("j-disabled")){g.handleLinkBtnClick(h)}});this._getInsertLinkContainer().find("a.js-uri-add").click(function(h){g.handleInsertLink(h)});this._getInsertLinkContainer().find('input[type="uri"]').keydown(function(h){if(h.keyCode==13||h.keyCode==32){g.handleInsertLink(h)}})}if(this.imgAttachmentBtn&&this.imagesEnabled&&this.publishBarIdentifier!=="activityHome"){this.imgAttachmentBtn.jiveFileButton({name:"image",title:jive.i18n.keys.weFormAddimage(),id:"imageFile",accept:"image/*",tabindex:"-1"}).bind("choose",function(h,i){g.handleImageChoose(h,i)});this.imgAttachmentBtn.keydown(function(h){if(h.keyCode==13){c(this).find("input[name=image]").click()}})}this._getMetaImageContainer().find("form").submit(function(){var h=c(this);if(h.find("input[type=file]").val()==""){h=null;return false}g.handleImageURLMatch(null);h=null;return false});this.submitBtn.off().on("vclick",function(h){if(!g.waitingView.isFormEnabled()){return}g.waitingView.disableForm();g.handleSubmitClick(h);h.stopPropagation()});if(this.cancelBtn){this.cancelBtn.off().on("vclick",function(h){g.resetStatusInput();g.attachmentsView.removeAllAttachments();g.attachmentsView.reset();g.emit("cancel")})}this.statusInput.addListener("linkURLMatch",function(h){g.handleLinkURLMatch(h);if(g.shouldHandleEmbedly()&&g.isLinkBtnEnabled()){g.handleEmbedly(h)}}).addListener("imageURLMatch",function(h){if(!g.supportAttachments){return}else{if(g.shouldHandleEmbedly()){g.handleEmbedly(h,true)}else{g.handleImageURLMatch(h)}}}).addListener("youtubeURLMatch",function(h){if(!g.supportAttachments||g.shouldHandleEmbedly()){return}g.handleYoutubeURLMatch(h)}).addListener("focus",function(h){g.handleFocus(h)});this.attachmentsView=new a(this._getAttachmentsViewOptions());this.attachmentsView.addListener("removeImage",function(i,h){if(!g.supportAttachments){return}g.emitP("removeImage",i).addCallback(function(j){if(j==0){g.enableButtons()}h.emitSuccess(j)}).addErrback(function(k,j){h.emitError(k,j)})}).addListener("removeThumbnail",function(i,h){g.emitP("removeThumbnail",i).addCallback(function(j){h.emitSuccess(j)}).addErrback(function(k,j){h.emitError(k,j)})})};this.getStatusInput=function(){return this.statusInput};this.focus=function(){this.statusInput._focus()};this.createWaitingViewElem=function(){throw"createWaitingViewElem method is abstract. Need to implement in subclass"};this.createWaitingView=function(){this.waitingView=new jive.shared.FormWaitingView(this.$waitingViewElem)};this.enableForm=function(){this.waitingView.enableForm()};this.disableForm=function(){this.waitingView.disableForm()};this.createFormElem=function(){throw"createFormElem method is abstract. Need to implement in subclass"};this.createActionContainer=function(){this.$actionContainer=this.$formElem.find("[id^=status-input-actions-]");this.$inputActionContainer=this.$formElem.find("[id^=j-status-input-info]");this.$moderationMessageContainer=c("#"+this.publishBarIdentifier+"moderation-container")};this.handleAtMentionClick=function(h,g){this.statusInput.handleAtMentionButtonClick();this.emit("atMentionClick");h.stopPropagation()};this.handleAtMentionResult=function(){return null};this.handleCharacterLenMsg=function(h){var j=arguments[1]||{},g=this.$formElem.eq(0).find(".j-js-status-input-characters-remaining"),i=({ok:{msg:""},warning:{msg:jive.wall.charLenErrors({error:false,numChars:j.charLeft}),className:"warning"},error:{msg:jive.wall.charLenErrors({error:true,numChars:j.charOver}),className:"danger"}})[h];g.html(i.msg).removeClass("warning danger");if(h!=="ok"){g.addClass(i.className)}};this.handleLinkBtnClick=function(h){var g=this;this._getInsertLinkContainer().toggle("fast",function(){g._getInsertLinkContainer().find("input:visible").focus()})};this.handleInsertLink=function(h){var g=this._getInsertLinkContainer().find("input").val();this.statusInput.handleInsertLink(g);this.resetInsertLinkContainer()};this.handleLinkURLMatch=function(h){var g=this;this.emitP("linkURLMatch",h).addCallback(function(j,i){g.renderResolvedLink(i,j)}).addErrback(function(j,i){g.renderError(j,i)})};this.renderResolvedLink=function(h,g){this.statusInput.swapLinkFor(h,g)};e.getDraftData=function(){return null};this._getAttachmentsViewOptions=function(){return{selector:this.selector+" .jive-js-attachment-container"}};this._getMetaImageContainer=function(){return this.getContent().find("div.j-status-input-attach-action-container div.j-meta-image-container")};this._getInsertLinkContainer=function(){return this.getContent().find("div.js-insert-link")};this.resetInsertLinkContainer=function(){this._getInsertLinkContainer().hide().find('input[type="uri"]').val("")};this.handleImageURLMatch=function(h){this.attachmentsView.showLoadingNotification();this.disableLinkBtn();this.setDataForURLImage(h);var g=this;this.emitP("imageURLMatch",h,this.$imageFormElem,this.getDraftData()).addCallback(function(j,i){g.renderImageAttachment(i,j)}).addErrback(function(j,i){g.attachmentsView.hideLoadingNotification();if(g.attachmentsView.getAttachmentCount()==0){g.enableLinkBtn()}g.renderError(j,i)}).addCancelback(function(){g.attachmentsView.hideLoadingNotification()})};this.handleYoutubeURLMatch=function(h){this.attachmentsView.showLoadingNotification();var g=this;this.emitP("youtubeURLMatch",h,this.getDraftData()).addCallback(function(j,i){g.renderVideoAttachment(i,j)}).addErrback(function(j,i){g.attachmentsView.hideLoadingNotification();g.renderError(j,i)}).addCancelback(function(){g.attachmentsView.hideLoadingNotification()})};this.shouldHandleEmbedly=function(){return this.statusInput.isContainerEditable()&&this.supportAttachments&&this.hasLinkBtn()&&this.attachmentsView.getAttachmentCount()==0};this.handleEmbedly=function(i,h){var j=new c.Deferred();var k=this.attachmentsView.showLoadingNotification({listItemClass:"j-previewer-loading",spinnerSize:"big"});this.disableButtons();var g=this;this.emitP("embedlyURLMatch",i,this.getDraftData()).addCallback(function(m,l){g.renderEmbedlyAttachment(l,m);j.resolve()}).addErrback(function(m,l){g.enableButtons();if(m!="fetch failed"||l!="400"){g.renderError(m,l)}else{if(h){g.handleImageURLMatch(i)}}j.reject()}).addCancelback(function(){g.attachmentsView.hideLoadingNotification()});c.when(k,j).always(function(){g.attachmentsView.hideLoadingNotification()})};this.isLinkBtnEnabled=function(){return this.hasLinkBtn()&&!c(this.linkBtn).hasClass("j-disabled")};this.hasLinkBtn=function(){return !!this.linkBtn&&this.linkBtn.length>0};this.renderImageAttachment=function(g,h){this.attachmentsView.add(g,h)};this.renderVideoAttachment=function(g,h){this.attachmentsView.add(g,h)};this.renderEmbedlyAttachment=function(g,h){this.attachmentsView.add(g,h)};this.handleImageChoose=function(h,j){var g=this._getMetaImageContainer().find("form");var i=g.find("input[id=imageFile]");if(i.length==1){g[0].removeChild(i[0])}g.prepend(j);g.submit()};this.enableButtons=function(){this.enableImgAttachmentBtn();this.enableLinkBtn()};this.disableButtons=function(){this.disableImgAttachmentBtn();this.disableLinkBtn()};this.enableImgAttachmentBtn=function(){if(this.imgAttachmentBtn){this.imgAttachmentBtn.removeClass("j-disabled");this.imgAttachmentBtn.find('input[type="file"]').prop("disabled",false)}};this.disableImgAttachmentBtn=function(){if(this.imgAttachmentBtn){this.imgAttachmentBtn.addClass("j-disabled");this.imgAttachmentBtn.find('input[type="file"]').prop("disabled",true)}};this.enableLinkBtn=function(){if(this.hasLinkBtn()){this.linkBtn.removeClass("j-disabled")}};this.disableLinkBtn=function(){if(this.hasLinkBtn()){this.linkBtn.addClass("j-disabled")}this.resetInsertLinkContainer()};e.setDataForURLImage=function(g){this.$imageFormElem.find("input[name=imageURL]").val(g)};this.handleFocus=function(h){var g=this;if(this.$actionContainer.is(":hidden")){this._initialStatusInputHeight=this.statusInput.getContainer().height();if(!this.imagesEnabled&&this.imgAttachmentBtn){this.imgAttachmentBtn.hide()}this.$actionContainer.addClass("j-act-comment-actions clearfix");this.$actionContainer.css({opacity:0,height:1}).show().animate({height:"24px",opacity:1},200,"linear",function(){c(this).css("height","auto")});this.$formElem.closest("article").find("div.j-act-reply-form").addClass("r-active");this.$formElem.closest("article").find("div.eae-reply-avatar").fadeIn("fast")}if(this.$inputActionContainer&&this.$inputActionContainer.is(":hidden")){this.$inputActionContainer.removeAttr("style");this.$inputActionContainer.show()}if(this.$moderationMessageContainer&&this.$moderationMessageContainer.is(":hidden")){this.$moderationMessageContainer.show()}if(g.getContent().find("#j-js-mb-success").length){g.getContent().find("#j-js-mb-success").fadeOut("fast",function(){c(this).remove();g.getContent().find(".j-mb-last-update").show()})}if(g.publishBarIdentifier==="activityHome"){g.myPublishBar=new jive.PublishBar.Main({objectType:g.publishBarViewBean.objectType,objectDescriptor:g.publishBarViewBean.objectDescriptor,identifier:g.publishBarIdentifier,placeRenderType:"quick",showCommunityOption:(!g.publishBarViewBean.viewingUserPartner&&g.publishBarViewBean.visibilityBean.placeItemBean.prop.canPostToNetwork),initData:{visibilityBean:g.publishBarViewBean.visibilityBean,organizeBean:g.publishBarViewBean.organizeBean,optionsBean:g.publishBarViewBean.optionsBean},handleVisibilityFocus:false});if(g.imgAttachmentBtn&&g.imagesEnabled&&!g.initializedJiveFileButton){g.initializedJiveFileButton=true;g.imgAttachmentBtn.jiveFileButton({name:"image",title:jive.i18n.keys.weFormAddimage(),id:"imageFile",accept:"image/*",tabindex:"-1"}).bind("choose",function(i,j){g.handleImageChoose(i,j)});g.imgAttachmentBtn.keydown(function(i){if(i.keyCode==13){c(this).find("input[name=image]").click()}})}}this.emit("focus")};this.handleSubmitClick=function(h){var i=true;if(this.publishBarIdentifier){if(!(c("input#"+this.publishBarIdentifier+"j-publishbar-place-type").val()&&c("input#"+this.publishBarIdentifier+"j-publishbar-place-id").val())){i=false}}if(this.statusInput.getCharCount()!=0||!i||this.attachmentsView.getAttachmentCount()){if(this.maxCharCount&&this.statusInput.getCharCount()>this.maxCharCount){this.renderError(jive.wall.submitErrors({key:"over"}));this.emit("submitError",jive.wall.submitErrors({key:"over"}))}else{if(!i){this.renderError(jive.wall.submitErrors({key:"noplaceselected"}));this.emit("submitError",jive.wall.submitErrors({key:"noplaceselected"}))}else{c(".jive-js-error-general",this.$formElem).hide();var g=this;this.emitP("submit",this.getDataFromDom()).addCallback(function(k,j){if(k.wallentry!=undefined&&k.wallentry.errorMessage!=undefined){g.renderError(jive.wall.submitErrors({key:k.wallentry.errorMessage}));g.emit("submitError",jive.wall.submitErrors({key:k.wallentry.errorMessage}))}else{g.renderResponse(k)}}).addErrback(function(k,j){g.renderError(k,j)})}}}else{this.renderError(jive.wall.submitErrors({key:"none"}));this.emit("submitError",jive.wall.submitErrors({key:"none"}))}};this.getDataFromDom=function(){throw"getDataFromDom method is abstract. Need to implmenet in subclass"};this.normalizeData=function(){return this.statusInput.getSubmitVals()};this.renderError=function(i,g){this.waitingView.enableForm();var h=this.getContent().find(".jive-js-error-general");h.text(i);h.slideDown(100);h.attr("aria-invalid","true");h=null;setTimeout(function(){c(".jive-js-error-general",this.$formElem).fadeOut("fast")},3500)};this.renderResponse=function(g){this.waitingView.enableForm();this.attachmentsView.reset()};this.renderResponseCommon=function(i){this.getContent().find("#j-js-mb-success").fadeOut("fast");var h=this.getContent().find(".j-mb-last-update");if(h.length){h.hide();if(i.wallentry.containerType==2020){if(i.wallentry.status!="AWAITING_MODERATION"){var j=c(i.wallentry.message).text();j=c("<div/>").text(j).html();h.html(jive.statusinput.containers.microbloggingStatusInputLastUpdate({latestStatusUpdate:{text:j,url:i.wallentry.URL,commentcount:0}}))}}}var g=c(jive.statusinput.containers.microbloggingStatusInputSuccess({entry:i.wallentry}));g.hide();g.find(".j-js-mb-success-dismiss").click(function(){g.fadeOut("fast",function(){c(".j-mb-hint").show();h.show()})});this.getContent().append(g);g.animate({height:"toggle"},{duration:600},function(){if(i.wallentry.meta&&i.wallentry.meta.length>0){g.find(".jive-js-attachment-container").slideDown("fast",function(){c(this).animate({opacity:1},500)})}});this.resetStatusInput()};this.resetStatusInput=function(){this.statusInput.resetText();this.$actionContainer.hide();this.$inputActionContainer.hide();this.$moderationMessageContainer.hide();this.resetInsertLinkContainer();this.enableButtons();if(c("#"+this.publishBarIdentifier+"j-publishbar-place-original")){c("#"+this.publishBarIdentifier+"j-publishbar-place-original").trigger("resetToOriginalPlace")}this.$formElem.closest("article").find("div.eae-reply-avatar").hide();this.$formElem.closest("article").find("div.j-act-reply-form").removeClass("r-active");var g=this.statusInput.getContainer();g.css("minHeight","24px");g.prev(".jive-js-statusinput-default").show();g.removeClass("j-mb-focused");this.statusInput.setContainerEditable(false);g=null}});return jive.MicroBlogging.CommonView});
;
goog.provide("jive.statusinput.mention_warnings.jsI18nHelper");jive.statusinput.mention_warnings.jsI18nHelper=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(opt_data.key),[])));return opt_sb?"":output.toString()};
;
jive.namespace("MicroBlogging");jive.MicroBlogging.CommonController=jive.oo.Class.extend(function(a){jive.conc.observable(this);this.init=function(d){if(!d){d={}}this.microbloggingService=new jive.MicroBlogging.MicroBloggingSource();this.metaService=new jive.MetaSource();this.draftWallEntry=null;this.meta=[];this.viewOptions=d.viewOptions||{};this.initMBView();this.manuallyRenderView=d.manuallyRenderView||false;this.submitURLParams={objectType:14,objectID:1};if(d.trackingID){this.submitURLParams.trackingID=d.trackingID}var c=this;this.microbloggingView.addListener("submit",function(e,f){c.submitHandler(e,f)}).addListener("linkURLMatch",function(e,f){c.metaService.createLink(e).addCallback(function(g){f.emitSuccess(g,e)}).addErrback(function(h,g){f.emitError(h,g)})}).addListener("imageURLMatch",function(g,e,f,i){b(f,h,i);function h(){var j=c.metaService.createImage(c.draftWallEntry.wallentry,g,g!=null,e);j.addCallback(function(k){c.meta.push("video");i.emitSuccess(k,g)}).addErrback(function(l,k){i.emitError(l,k)})}}).addListener("removeImage",function(f,e){c.metaService.remove(f).addCallback(function(g){c.meta.pop();e.emitSuccess(c.meta.length)}).addErrback(function(h,g){e.emitError(h,g)})}).addListener("removeThumbnail",function(f,e){c.metaService.setLinkThumbnail(f).addCallback(function(g){e.emitSuccess()}).addErrback(function(h,g){e.emitError(h,g)})}).addListener("youtubeURLMatch",function(g,f,h){b(f,e,h);function e(){c.metaService.createVideo(c.draftWallEntry.wallentry,g).addCallback(function(i){c.metaService.fetch(i.id).addCallback(function(j){if(j.meta.length>0){c.meta.push("video");h.emitSuccess(c.metaService.normalizeData(j),g)}else{h.emitError(message,status)}}).addErrback(function(k,j){h.emitError(k,j)})}).addErrback(function(j,i){h.emitError(j,i)})}}).addListener("embedlyURLMatch",function(h,g,k){b(g,i,k);function i(){c.meta.push("embedly");c.metaService.fetchEmbedly(h).addCallback(function(l){e(l)}).addErrback(function(){c.meta.pop();k.emitError("fetch failed",400);k.emitError("fetch failed",404)})}function e(m){if(c.draftWallEntry){var l={linkmeta:{parentObjectType:c.draftWallEntry.wallentry.objectType,parentObjectID:c.draftWallEntry.wallentry.objectId,url:h,type:j(m),title:!!m.title?m.title:"",description:!!m.description?m.description:"",providerURL:!!m.provider_url?m.provider_url:"",providerDisplay:!!m.provider_name?m.provider_name:"",thumbnailURLs:f(m),html:j(m)==="video"?m.object.html:"",imageURL:j(m)==="photo"?m.object.url:""}};c.metaService.createLinkMeta(l).addCallback(function(n){if(!!n.meta){k.emitSuccess(c.metaService.normalizeData(n),h)}else{c.meta.pop();k.emitError()}}).addErrback(function(o,n){c.meta.pop();k.emitError(o,n)})}else{c.meta.pop();k.emitError()}}function f(l){var m=[];if(!!l.images){l.images.forEach(function(n){m.push(n.url)})}return m.slice(0,3)}function j(l){if(!!l.object&&l.object.type){return l.object.type}else{return l.type}}}).addListener("cancel",function(){c.emit("cancel")});function b(e,g,f){if(c.meta.length>0&&c.meta[0]=="embedly"){f.cancel();return}c.draftData=e;if(c.draftWallEntry==null){c.createDraft(g,f)}else{g()}}if(!this.manuallyRenderView){this.renderView()}};a.submitHandler=function(d,e){var c=this;var b;if(this.draftWallEntry!=null){b=$j.extend(true,{},this.draftWallEntry,d)}else{b=d}if(d.wallentry&&d.wallentry.attachmentID&&d.wallentry.imageID){this.metaService.setLinkThumbnail(d.wallentry.attachmentID,d.wallentry.imageID)}this.submitServiceCall(b,e)};a.submitServiceCall=function(c,d){var b=this;this.microbloggingService.publishEntry(this.submitURLParams,c).addCallback(function(e){b.submitSuccessCallback(e,d)}).addErrback(function(f,e){b.submitErrCallback(f,e,d)})};a.submitSuccessCallback=function(b,c){this.draftWallEntry=null;this.meta=[];b.wallentry=this.metaService.normalizeData(b.wallentry);c.emitSuccess(b);this.emitP("submitSuccess",b)};a.submitErrCallback=function(c,b,d){d.emitError(c,b);this.emitP("submitError",c,b)};a.createDraft=function(d,c){var b=this;this.microbloggingService.createDraft({objectType:14,objectID:1},{wallentry:{}}).addCallback(function(e){b.draftWallEntry=e;d()}).addErrback(function(f,e){c.emitError(f,e)})};a.initMBView=function(){throw"initMBView method is abstract. Need to implement in subclass"};this.renderView=function(){this.microbloggingView.postRender()};this.getMicrobloggingView=function(){return this.microbloggingView}});define("apps/microblogging/status_input_common_controller",function(){return jive.MicroBlogging.CommonController});
;
jive.namespace("MicroBlogging");define("apps/microblogging/models/microblogging_source",["apps/shared/models/rest_service"],function(a){jive.MicroBlogging.MicroBloggingSource=a.extend(function(b){jive.conc.observable(this);b.resourceType="wall";b.pluralizedResourceType=b.resourceType;this.publishEntry=function(c,f){var d=this.RESOURCE_ENDPOINT+"/"+c.objectType+"/"+c.objectID+(c.trackingID?"?sr="+c.trackingID:"");var e=$j.deparam.querystring().fromQ;if(e){f.wallentry.fromQuest=e}else{if(jive.Onboarding&&jive.Onboarding.Controller){var g=jive.Onboarding.Controller.getActiveQuestAndStep();if(g.activeQuestID=="StayInTouchQuest"&&g.activeQuestStep==0){f.wallentry.fromQuest=g.activeQuestID}}}return this.commonAjaxRequest(new jive.conc.Promise(),"POST",{url:d,data:JSON.stringify(f)},f)};this.createDraft=function(c,e){var d=this.RESOURCE_ENDPOINT+"/"+c.objectType+"/"+c.objectID+"/draft";return this.commonAjaxRequest(new jive.conc.Promise(),"POST",{url:d,data:JSON.stringify(e)},e)};this.repost=function(c,e){var d=this.RESOURCE_ENDPOINT+"/repost/"+c.wallEntryID;return this.commonAjaxRequest(new jive.conc.Promise(),"POST",{url:d,data:e},e)};this.createRepostDraft=function(c,e){var d=this.RESOURCE_ENDPOINT+"/repost/"+c.wallEntryID+"/draft";return this.commonAjaxRequest(new jive.conc.Promise(),"POST",{url:d,data:JSON.stringify(e)},e)}});return jive.MicroBlogging.MicroBloggingSource});
;
define("apps/shared/models/meta_source",["apps/shared/models/rest_service"],function(a){jive.MetaSource=a.extend(function(b){jive.conc.observable(this);b.resourceType="meta";b.pluralizedResourceType=b.resourceType;this.createLink=function(e){var f=new jive.conc.Promise(),c=this,d={url:jive.rest.url("/linkMarkUp/link-meta?url="+encodeURIComponent(e)),dataType:"html",success:function(g){f.emitSuccess(g)},error:function(g){console.log("jive.MetaSource.createLink ERROR "+g);c.errorCallback(f,this.errorSaving)}};$j.ajax(d);return f};this.createLinkMeta=function(e){var f=new jive.conc.Promise(),c=this,d={type:"POST",url:this.RESOURCE_ENDPOINT+"/link",dataType:"json",data:JSON.stringify(e),contentType:"application/json; charset=utf-8",success:function(h,g){f.emitSuccess(h)},error:function(g,i,h){c.errorCallback(f,this.errorSaving)}};$j.ajax(d);return f};this.setLinkThumbnail=function(e,d){if(!d){d=0}var c=this.RESOURCE_ENDPOINT+"/link/"+e+"/"+d+"/thumbnail";return this.commonAjaxRequest(new jive.conc.Promise(),"GET",{url:c})};this.fetchEmbedly=function(e){var f=new jive.conc.Promise(),c=this,d={type:"GET",url:this.RESOURCE_ENDPOINT+"/embedly?linkURL="+encodeURIComponent(e),dataType:"json",success:function(g){f.emitSuccess(g)},error:function(g){console.log("jive.MetaSource.fetchEmbedly ERROR "+g);f.emitError(g)}};$j.ajax(d);return f};this.createVideo=function(e,h){var g=new jive.conc.Promise(),c=this,f={contentObjectType:e.objectType,object:e.objectId,videoURL:encodeURIComponent(h)},d={url:jive.action.url("video-link-meta",f),dataType:"json",success:function(i){g.emitSuccess(i)},error:function(i){console.log("jive.MetaSource.createVideo ERROR "+i);c.errorCallback(g,this.errorSaving)}};$j.ajax(d);return g};this.normalizeData=function(f){if(typeof f.meta!="undefined"){var c=[];if((typeof f.meta!="undefined")&&(typeof f.meta.properties!="undefined")&&(f.meta.properties.entry.length>0)){c=f.meta.properties.entry}else{if((typeof f.meta!="undefined")&&f.meta.length>0){c=f.meta}}var e={};for(var d=0;d<c.length;d++){e[c[d].key]=c[d].value}f.meta.properties=e}return f};this.createImage=function(g,e,c,l){var i=this,d=this.RESOURCE_ENDPOINT+"/imageJackson/"+g.objectType+"/"+g.objectId+"/attachment",h="",k=new jive.conc.Promise();if(c){h=encodeURIComponent(e);d=this.RESOURCE_ENDPOINT+"/imageJackson/"+g.objectType+"/"+g.objectId}var j={url:d,dataType:"xml",data:{imageURL:h},contentType:"text/xml; charset=utf-8",complete:function(n,m){if($j(n.responseXML).find("meta id").length>0){i.fetch($j(n.responseXML).find("meta id").text()).addCallback(function(q){k.emitSuccess(q)}).addErrback(function(r,q){i.errorCallback(k,this.errorSaving)})}else{var p=$j(n.responseXML).find("code").text();var o=$j(n.responseXML).find("message").text();k.emitError(o,p)}},error:function(o,q,p){console.log("Error jive.Wall.ImageMetaSource create"+o+", "+q+", "+p);var n=$j(o.responseXML).find("code").text();var m=$j(o.responseXML).find("message").text();i.errorCallback(k,this.errorSaving)}};if(c){var f=l.find("input[name=image]");if(f.length>0){f.val("")}}else{l.find("input[name=imageURL]").val("")}l.ajaxSubmit(j);return k};this.fetch=function(d){var c=this.RESOURCE_ENDPOINT+"/"+d;return this.commonAjaxRequest(new jive.conc.Promise(),"GET",{url:c})};this.remove=function(d){var c=this.RESOURCE_ENDPOINT+"/remove/"+d;return this.commonAjaxRequest(new jive.conc.Promise(),"GET",{url:c})}});return jive.MetaSource});
;
define("apps/activity_stream/models/fill_in_the_gap_request",["jquery/jquery.oo"],function(a){return a.extend({init:function(b){this.originalIDs=b.originalIDs;this.timestamp=b.timestamp;this.fullContent=b.fullContent;this.pageSize=b.pageSize}})});
;
define("apps/activity_stream/models/full_replies_request",["jquery/jquery.oo"],function(a){return a.extend({init:function(b){this.originalIDs=b.originalIDs}})});
;
define("apps/activity_stream/models/activity_stream_source",["apps/shared/models/rest_service","lib/jiverscripts/src/conc/promise"],function(a,b){return a.extend(function(c){c.resourceType="activity-stream";c.pluralizedResourceType=c.resourceType;jive.conc.observable(this);this.initializeView=function(e,j,k,d,g,h,l){var f=this.RESOURCE_ENDPOINT+"/initializeView",i={objectType:g||3,objectID:h||window._jive_current_user.ID,streamSource:e,streamID:j||0,streamChannel:k||(e=="all"?"discovery":"recent"),filterType:d||["all"],timestamp:0};c.displayGenericErrorMessages=false;if(!l){l=new b()}return this.commonAjaxRequest(l,"POST",{url:f,data:JSON.stringify(i)}).addErrback(function(n,m){if(m==401||m==403||m==4026||m===0){location.reload()}}).always(function(){c.displayGenericErrorMessages=true})};this.list=function(e,f){var d=this.RESOURCE_ENDPOINT+"/list";c.displayGenericErrorMessages=false;if(!f){f=new b()}return this.commonAjaxRequest(f,"POST",{url:d,data:JSON.stringify(e)}).addErrback(function(h,g){if(g==401||g==403||g==4026||g===0){location.reload()}}).always(function(){c.displayGenericErrorMessages=true})};this.getMore=function(e){var d=this.RESOURCE_ENDPOINT+"/list/before";return this.commonAjaxRequest(new b(),"POST",{url:d,data:JSON.stringify(e)})};this.saveActiveStreamTab=function(e){var d=this.RESOURCE_ENDPOINT+"/activetab/save";return this.commonAjaxRequest(new b(),"POST",{url:d,data:e})};this.saveActiveStreamFilter=function(e,f){var d=this.RESOURCE_ENDPOINT+"/activefilter/save/"+e;return this.commonAjaxRequest(new b(),"POST",{url:d,data:f})};this.saveActiveCommunicationsItem=function(d,f){var e=this.RESOURCE_ENDPOINT+"/activeitem/save/"+d+"/"+f;return this.commonAjaxRequest(new b(),"POST",{url:e})};this.saveRefreshTime=function(d){var e=this.RESOURCE_ENDPOINT+"/refreshtime/save";return this.commonAjaxRequest(new b(),"POST",{url:e,data:d})};this.newCount=function(){var e=encodeURIComponent((window.location.pathname.split("/")).pop());var d=this.RESOURCE_ENDPOINT+"/new/count"+((e)?"?currentPage="+e:"");return this.commonAjaxRequest(new b(),"GET",{url:d})};this.getFullContent=function(d,i,g,e){var h=new b(),f={url:this.RESOURCE_ENDPOINT+"/fullcontent/"+d+"/"+i};if(d==1150305777){f.url=this.RESOURCE_ENDPOINT+"/acclaim"}if(g!=undefined&&e!=undefined&&e!=window._jive_effective_user_id){f.data={sr:g,ru:e}}return this.commonAjaxRequest(h,"GET",f)};this.getFullReplies=function(d,g,f){var e=this.RESOURCE_ENDPOINT+"/fullreplies/"+d+"/"+g;return this.commonAjaxRequest(new b(),"POST",{url:e,data:JSON.stringify(f)},f)};this.fillInTheGaps=function(d,h,f){var g=new b();var e=this.RESOURCE_ENDPOINT+"/fillinthegaps/"+d+"/"+h;return this.commonAjaxRequest(g,"POST",{url:e,data:JSON.stringify(f)},f)};this.fillActivity=function(d,h,f,g){var e=this.RESOURCE_ENDPOINT+"/fillactivity/"+d+"/"+h;return this.commonAjaxRequest(g,"POST",{url:e,data:JSON.stringify(f)})};this.saveInboxViewType=function(d){var e=this.RESOURCE_ENDPOINT+"/inbox/viewtype/save";return this.commonAjaxRequest(new b(),"POST",{url:e,data:d})};this.saveInboxListHeight=function(d){var e=this.RESOURCE_ENDPOINT+"/inbox/listheight/save";return this.commonAjaxRequest(new b(),"POST",{url:e,data:JSON.stringify(d)})};this.getGlobalNavMenu=function(){var d=this.RESOURCE_ENDPOINT+"/global/nav/menu";return this.commonAjaxRequest(new b(),"GET",{url:d})}})});
;
goog.provide("jive.welcome.updateIndicator");
jive.welcome.updateIndicator=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.type=="count"?'<span data-count="'+soy.$$escapeHtmlAttribute(opt_data.count)+'" class="j-js-update-indicator j-update-count'+(opt_data.count==0?" zero":"")+(opt_data.count>50?" fiftyplus":"")+(opt_data.extraCssClasses?" "+soy.$$escapeHtmlAttribute(opt_data.extraCssClasses):"")+'"'+(opt_data.count==0&&!opt_data.showZero?'style="display:none;"':"")+">"+(opt_data.count>50?"50+":opt_data.count==
0&&opt_data.initial?"&ndash;":soy.$$escapeHtml(opt_data.count))+'<span class="j-508-label" aria-hidden="'+soy.$$escapeHtmlAttribute(opt_data.count==0)+'">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("nav.bar.inbox.count.label"),[]))+"</span></span>":opt_data.type=="gauge"?'<span role="img" data-count="'+soy.$$escapeHtmlAttribute(opt_data.count)+'" class="j-js-update-indicator j-update-gauge jive-icon-glyph '+(opt_data.count<10?"icon-activity-gauge-low":opt_data.count<40?"icon-activity-gauge-med":
"icon-activity-gauge-high")+'" '+(opt_data.count==0?'style="display:none;"':"")+' title="'+(opt_data.count<10?soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("nav.bar.gauge.lessthanten"),[])):opt_data.count<40?soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("nav.bar.gauge.tenplus"),[])):soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("nav.bar.gauge.fiftyplus"),[])))+'" aria-label="'+(opt_data.count<10?soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("nav.bar.gauge.lessthanten"),
[])):opt_data.count<40?soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("nav.bar.gauge.tenplus"),[])):soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("nav.bar.gauge.fiftyplus"),[])))+'" tabindex="0" ></span>':"");return opt_sb?"":output.toString()};
;
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{a(jQuery)}}(function(d){var c=/iPhone|iPad|iPod/.test(window.navigator.platform),b=0,a={touchstart:null,touchend:null,touchmove:null,touchcancel:null},e=function(f){d(window)[f?"off":"on"]("focus blur",function(g){d.each(a,function(h,i){(this.ownerDocument||this)[(g.type==="focus")?"addEventListener":"removeEventListener"](h,i,true)})})};if(c){jQuery.each(a,function(f,g){jQuery.event.special[f]={setup:function(j,i,k,h){if(b++===0){a[f]=h;(this.ownerDocument||this).addEventListener(f,h,true);e()}},teardown:function(){if(--b===0){a[f]=null;(this.ownerDocument||this).removeEventListener(f,a[f],true);e(true)}}}})}}));
;
goog.provide("jive.integration.tiles.edit.errorEditing");jive.integration.tiles.edit.errorEditing=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<p>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.manage.template.error_editing"),[])),"</p>");return opt_sb?"":output.toString()};
;
define("apps/tile/tile",["jive/promise_util","underscore","jquery","soy!jive.integration.tiles.edit.errorEditing"],function(k,n,h,m){var p={};if(Object.freeze){Object.freeze(p)}function b(r){var q=jive.rest.corev3.url("/tiles/"+r);return h.getJSON(q).then(function(u,s,t){return o(u)})}function d(t){var r=h(t),s=r.data("tile"),q=r.data("instancePromise"),v=f(r).id,u;if(q){return q}else{if(s){u=k.success(o(s))}else{u=k.retry(b.bind(null,v),3);u.fail(function(){h(m()).message({style:"error"})})}}r.data("instancePromise",u);return u}function f(r){var q=h(r);return q.data("tile")||q.data("tileView")}function l(r,q){h(r).data("instancePromise",q.then(o))}function g(r,s){var q=d(r).then(function(t){return s(t)});l(r,q)}function o(q){var s=n.clone(q);if(!s.config){s.config=p}else{if(typeof s.config==="string"){try{s.config=JSON.parse(s.config)}catch(t){console.warn("Error [%s] trying to parse [%s]. Returning empty config.",t,s.config);s.config={}}}}(function r(u){if(u&&u.action&&u.action.context){if(typeof u.action.context==="string"){u.action.context=JSON.parse(u.action.context)}}else{if(u&&h.isArray(u)){u.forEach(r)}else{if(u&&typeof u==="object"){Object.keys(u).forEach(function(v){r(u[v])})}}}}(s.data));return s}function j(q){return !q.id||q.id==="-1"}function a(q){return !!q.config&&q.config!==p}function e(q){return !!q.definition.config}function i(q){return q.definition.configurationRequired}function c(q){return !!q.definition.register}return{fetch:b,fromDOM:d,viewFromDOM:f,set:l,update:g,isNew:j,isConfigured:a,canBeConfigured:e,requiresConfig:i,isExternal:c,normalized:o}});
;
define("apps/tile/template",["./tile","underscore","jquery"],function(p,n,h){function a(r){var q=jive.rest.corev3.url("/pages/"+r);return h.getJSON(q).then(function(u,s,t){return u})}function d(){var q=jive.rest.corev3.url("/people/@me/pages");return h.getJSON(q).then(function(t,r,s){if(t.list){if(t.list.length>0){return t.list[0]}else{return undefined}}return t})}function e(r){var q=jive.rest.corev3.url("/places/"+r+"/pages?filter=name(mobileHomePage)");return h.getJSON(q).then(function(u,s,t){return u.list instanceof Array&&u.list.length>0?u.list[0]:undefined})}function m(q){return(k(q)?j:g)(q)}function j(q){return i("POST","",q)}function g(q){return i("PUT",q.id,q)}function i(q,u,s){var r=jive.rest.corev3.url("/pages/"+u),t=s.tiles?h.extend({},s,{tiles:s.tiles.map(c),extstreams:s.extstreams.map(c)}):s;return h.ajax(r,{type:q,data:JSON.stringify(t),contentType:"application/json; charset=utf-8",dataType:"json"}).then(function(x,v,w){return x})}function k(q){return !q.id||q.id<=0}function c(q){var r=n.clone(q);if(!r.id||r.id=="-1"){delete r.id}if(!p.isConfigured(r)){delete r.config}if(typeof r.definition==="object"){r.definition=q.definition.resources.self.ref}return r}function o(r){var q=jive.app.url({path:"/api/core/v3/pages/"+r});return h.ajax(q,{type:"DELETE",contentType:"application/json; charset=utf-8",dataType:"json"})}function l(r,q){return b("name",r,q)}function f(r,q){return b("displayname",r,q)}function b(u,t,r){var q=jive.rest.url("/containers/"+t.objectType+"/"+u+"/validity"),s={name:r};if(t.parentID&&t.parentType){s=h.extend({},s,{parentID:t.parentID,parentType:t.parentType})}return h.ajax(q,{type:"GET",contentType:"application/json; charset=utf-8",dataType:"json",data:s})}return{fetch:a,fetchUserPage:d,fetchMobileHomePage:e,save:m,create:j,update:g,deleteTemplate:o,isNew:k,getNameValid:l,getDisplayNameValid:f}});
;
define("apps/tile/integrations/image_gallery",["jquery","underscore","documentReady"],function(d,b){function c(g){g.preventDefault();var f=d(this).data("index"),h=d(".j-slide.slick-slide:not(.slick-cloned) a",g.delegateTarget).map(function(){return d(this).data()});d.gallery(h,f)}function a(){d(".js-tile-image-gallery-wide").each(function(e,f){d(f).find("ul").slick({slide:"li",slidesToShow:3,slidesToScroll:1,dots:true})});d(".js-tile-image-gallery-narrow").each(function(e,f){d(f).find("ul").slick({slide:"li",slidesToShow:1,slidesToScroll:1,dots:true})});d(".js-tile-image-gallery").on("vclick",'a[data-action="showGallery"]:not([data-disabled="true"])',c)}if(d(".js-tile-image-gallery-wide, .js-tile-image-gallery-narrow").length){a()}return{initSlick:a}});
;
goog.provide("jive.place.layout.columnPlaceholder");
jive.place.layout.columnPlaceholder=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.customizeNow){output.append('<div class="js-column" style="display: none;" data-column="',soy.$$escapeHtmlAttribute(opt_data.column),'">');var instanceList8=opt_data.instances;var instanceListLen8=instanceList8.length;for(var instanceIndex8=0;instanceIndex8<instanceListLen8;instanceIndex8++){var instanceData8=instanceList8[instanceIndex8];output.append('<div class="js-tile" data-column="',
soy.$$escapeHtmlAttribute(opt_data.column),'" data-tile="',soy.$$escapeHtmlAttribute(JSON.stringify(instanceData8).replace(/</g,"\\u003C").replace(/>/g,"\\u003E").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")),'"></div>')}output.append("</div>")}return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.view.statusIcon");jive.integration.tiles.view.statusIcon=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;switch(opt_data.level){case "warn":output.append("jive-icon-warn");break;case "error":output.append("jive-icon-redalert");break;default:output.append("jive-icon-info")}return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.view.status");
jive.integration.tiles.view.status=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<a href="#" class="js-status j-status j-status-level-',soy.$$escapeHtmlAttribute(opt_data.status.level),'" data-status="',soy.$$escapeHtmlAttribute(JSON.stringify([{id:opt_data.id,name:opt_data.definition.displayNameLocalized,level:opt_data.status.level,message:opt_data.status.message,icon:opt_data.definition.icons["48"]?opt_data.definition.icons["48"]:"",internal:opt_data.status.__set_by_jive_canned_status}]).replace(/</g,
"\\u003C").replace(/>/g,"\\u003E").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")),'"><span class="jive-icon-med ');jive.integration.tiles.view.statusIcon(opt_data.status,output);output.append('"></span></a>');return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.view.disabled");jive.integration.tiles.view.disabled=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.tile.disabled"),[])));return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.authorLink");
jive.integration.tiles.viewstyle.authorLink=function(opt_data,opt_sb){opt_data=opt_data||{};var output=opt_sb||new soy.StringBuilder;output.append((opt_data.context||opt_data.url)&&opt_data.text?'<a href="'+(opt_data.authorUrl?soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.authorUrl)):!opt_data.context&&opt_data.url&&opt_data.containerUrl?soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.containerUrl))+soy.$$escapeHtmlAttribute(opt_data.url):!opt_data.context&&opt_data.url?
soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.url))):"#")+'" class="'+(opt_data.context?"js-action":"")+(opt_data.classes?" "+soy.$$escapeHtmlAttribute(opt_data.classes):"")+'"'+(opt_data.context?'data-action-context="'+soy.$$escapeHtmlAttribute(JSON.stringify(opt_data.context).replace(/</g,"\\u003C").replace(/>/g,"\\u003E").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029"))+'"':"")+(opt_data.url&&(opt_data.url.match(new RegExp("^https?:",
"i"))||[]).length>0?'target="_action_link"':"")+(opt_data.attrs?soy.$$filterNoAutoescape(opt_data.attrs):"")+">"+(opt_data.noEscapeText?soy.$$filterNoAutoescape(opt_data.text):soy.$$escapeHtml(opt_data.text))+"</a>":opt_data.text?opt_data.noEscapeText?soy.$$filterNoAutoescape(opt_data.text):soy.$$escapeHtml(opt_data.text):"");return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.bannerImage");
jive.integration.tiles.viewstyle.bannerImage=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<figure><a href="',soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.actionUrl)),'" data-index="',soy.$$escapeHtml(opt_data.index),'" data-caption="',soy.$$escapeHtml(opt_data.title),'" data-src="',soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.image)),'"',opt_data.openInNewWindow?'target="_blank"':"",'><img class="j-banner-image" src="',
soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.image)),'" data-src="',soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.image)),'" alt="',soy.$$escapeHtml(opt_data.title),'" ><\!-- not yet supported in all browsers, see https://developer.mozilla.org/en-US/docs/Link_prefetching_FAQ --\><meta http-equiv="Link" content="<',soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.image)),'>; rel=prefetch">',opt_data.title&&
!opt_data.hideCaptions?"<figcaption class='j-banner-caption'><p>"+soy.$$escapeHtml(opt_data.title)+"</p></figcaption>":"","</a></figure>");return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.view.actionLink");
jive.integration.tiles.view.actionLink=function(opt_data,opt_sb){opt_data=opt_data||{};var output=opt_sb||new soy.StringBuilder;output.append((opt_data.context||opt_data.url)&&opt_data.text?'<a href="'+(!opt_data.context&&opt_data.url&&opt_data.containerUrl?soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.containerUrl))+soy.$$escapeHtmlAttribute(opt_data.url):!opt_data.context&&opt_data.url?soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.url))):
"#")+'" class="'+(opt_data.context?"js-action":"")+(opt_data.classes?" "+soy.$$escapeHtmlAttribute(opt_data.classes):"")+" "+(opt_data.externalUrl?"jive-link-external-small":"")+'"'+(opt_data.context?'data-action-context="'+soy.$$escapeHtmlAttribute(JSON.stringify(opt_data.context).replace(/</g,"\\u003C").replace(/>/g,"\\u003E").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029"))+'"':"")+(opt_data.url&&(opt_data.url.match(new RegExp("^https?:","i"))||[]).length>0?'target="_action_link"':"")+
(opt_data.attrs?soy.$$filterNoAutoescape(opt_data.attrs):"")+">"+(opt_data.noEscapeText?soy.$$filterNoAutoescape(opt_data.text):soy.$$escapeHtml(opt_data.text))+"</a>":opt_data.text?opt_data.noEscapeText?soy.$$filterNoAutoescape(opt_data.text):soy.$$escapeHtml(opt_data.text):"");return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.view.footer");jive.integration.tiles.view.footer=function(opt_data,opt_sb){opt_data=opt_data||{};var output=opt_sb||new soy.StringBuilder;if(opt_data.text){output.append('<footer class="j-tile-footer clearfix">');jive.integration.tiles.view.actionLink(soy.$$augmentMap(opt_data,{classes:(opt_data.classes?"$classes ":"")+"j-footer-link"}),output);output.append("</footer>")}return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.banner");
jive.integration.tiles.viewstyle.banner=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<label class="j-508-label" id="tile-header-',opt_data.tileInstanceId?soy.$$escapeHtmlAttribute(opt_data.tileInstanceId):"-1",'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.tile.banner.config.images.label"),[])),'</label><section id="tile-banner-',soy.$$escapeHtmlAttribute(opt_data.tileInstanceId),'" class="j-tile-body  j-tile-banner j-tile-banner-',soy.$$escapeHtmlAttribute(opt_data.config.size),
"  js-tile-banner js-tile-banner-",soy.$$escapeHtmlAttribute(opt_data.config.size),"  ",!opt_data.config.disableFullScreenView?" j-fullscreen-enabled":"",typeof opt_data.contents=="string"||opt_data.contents.length==0?" j-empty-gallery":"",'">');if(typeof opt_data.contents!="string"&&opt_data.contents.length!=0){output.append('<ul class="">');var imageList28=opt_data.contents;var imageListLen28=imageList28.length;for(var imageIndex28=0;imageIndex28<imageListLen28;imageIndex28++){var imageData28=imageList28[imageIndex28];
if(imageData28.display!="none"){output.append('<li class="j-tile-banner-thumb ',opt_data.config&&opt_data.config.largeTile?" j-tile-banner-tall":"",'">');jive.integration.tiles.viewstyle.bannerImage(soy.$$augmentMap(imageData28,{hideCaptions:opt_data.config.hideCaptions,index:imageIndex28}),output);output.append("</li>")}}output.append("</ul>")}else output.append('<p class="noContent">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tile.banner.empty"),[])),"</p>");output.append("</section>");
if(opt_data.action&&opt_data.config.showAdditionalLink)jive.integration.tiles.view.footer(opt_data.action,output);return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.byline");
jive.integration.tiles.viewstyle.byline=function(opt_data,opt_sb){opt_data=opt_data||{};var output=opt_sb||new soy.StringBuilder;if(opt_data.user)output.append('<div class="linkDescription font-color-meta">',opt_data.user.title!=null?opt_data.user.dept!=null?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tile.sectionList.byline.user"),[opt_data.user.title,opt_data.user.dept])):soy.$$escapeHtml(opt_data.user.title):"","</div>");else if(opt_data.content){output.append('<div class="linkDescription font-color-meta" style="display: none;">');var userLink__soy16=
new soy.StringBuilder;jive.shared.displayutil.userDisplayNameLink(opt_data.content.author,userLink__soy16);userLink__soy16=userLink__soy16.toString();output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tile.sectionList.byline.content"),[new soydata.VERY_UNSAFE.ordainSanitizedHtml(userLink__soy16),opt_data.content.date])),"</div>")}return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.view.header");jive.integration.tiles.view.header=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<header class="j-tile-header"><h2 id="tile-header-',opt_data.tileInstanceId?soy.$$escapeHtmlAttribute(opt_data.tileInstanceId):"-1",'" class="font-color-meta">',soy.$$escapeHtml(opt_data.title),"</h2></header>");return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.eventLocation");jive.integration.tiles.viewstyle.eventLocation=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.event.location&&(!opt_data.config||opt_data.config&&opt_data.config.locationDisplay&&opt_data.config.locationDisplay!="false")?'<p class="j-eventLocation font-color-meta">'+soy.$$escapeHtml(opt_data.event.location)+"</p>":"");return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.eventList");
jive.integration.tiles.viewstyle.eventList=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(typeof opt_data.events=="string")output.append('<p class="noContent">',soy.$$escapeHtml(opt_data.events),"</p>");else{var eventList9=opt_data.events;var eventListLen9=eventList9.length;if(eventListLen9>0)for(var eventIndex9=0;eventIndex9<eventListLen9;eventIndex9++){var eventData9=eventList9[eventIndex9];if(eventData9.title){output.append('<li id="event_',soy.$$escapeHtmlAttribute(eventData9.start),
'" class="j-calEvent clearfix"><div class="j-tile-calendarIcon"><strong class="month">',soy.$$escapeHtml((eventData9.start?jive.model.DateUtil.parseISODateTime(eventData9.start):"")?_jive_moment.utc(parseFloat(eventData9.start?jive.model.DateUtil.parseISODateTime(eventData9.start):"")?parseFloat(eventData9.start?jive.model.DateUtil.parseISODateTime(eventData9.start):""):eventData9.start?jive.model.DateUtil.parseISODateTime(eventData9.start):"").lang(_jive_locale.toLowerCase().replace("_","-")).format("MMM"):
""),'</strong><strong class="day">',soy.$$escapeHtml((eventData9.start?jive.model.DateUtil.parseISODateTime(eventData9.start):"")?_jive_moment.utc(parseFloat(eventData9.start?jive.model.DateUtil.parseISODateTime(eventData9.start):"")?parseFloat(eventData9.start?jive.model.DateUtil.parseISODateTime(eventData9.start):""):eventData9.start?jive.model.DateUtil.parseISODateTime(eventData9.start):"").lang(_jive_locale.toLowerCase().replace("_","-")).format("D"):""),'</strong></div><header class="j-calEventHeader">');
if(eventData9.action)jive.integration.tiles.view.actionLink(soy.$$augmentMap(eventData9.action,{text:eventData9.title}),output);else output.append(soy.$$escapeHtml(eventData9.title));output.append('</header><section class="j-eventDescription"><p class="j-eventDescription">',eventData9.description?soy.$$escapeHtml(eventData9.description):"","</p>");jive.integration.tiles.viewstyle.eventLocation({event:eventData9,config:opt_data.config},output);output.append("</section></li>")}}else output.append('<li class="j-cal-empty"><p class="noContent"></p></li>')}return opt_sb?
"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.calendar");jive.integration.tiles.viewstyle.calendar=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.integration.tiles.view.header(opt_data,output);output.append('<section class="j-tile-body j-tile-calendar"><ul class="j-calendar">');jive.integration.tiles.viewstyle.eventList(opt_data,output);output.append("</ul></section>");if(opt_data.action)jive.integration.tiles.view.footer(opt_data.action,output);return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.noResults");jive.integration.tiles.viewstyle.noResults=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<p class="noContent">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("slide.no-results.text"),[])),"</p>");return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.controls");
jive.integration.tiles.viewstyle.controls=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-carousel-controls"><a href="#" class="j-prev js-prev-slide" aria-label="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("tile.carousel.page.previousSlide"),[])),'"><span class="jive-icon-med jive-icon-lb-prev inv"></span><span class="jive-icon-med jive-icon-lb-prev-dk init"></span></a><span class="j-carousel-counter"><em class="js-current-slide">1</em><em>/',soy.$$escapeHtml(opt_data.totalSlideNumber),
'</em></span><a href="#" class="j-next js-next-slide" aria-label="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("tile.carousel.page.nextSlide"),[])),'"><span class="jive-icon-med jive-icon-lb-next inv"></span><span class="jive-icon-med jive-icon-lb-next-dk init"></span></a></div>');return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.slide");
jive.integration.tiles.viewstyle.slide=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-cSlide js-slide-body"><div class="j-slide-ratio-box"><img class="j-slide-blank" src="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.resourceUrl(window._jive_base_url,"/9.0.5.998b920/","//files1.element14.com/community","/images/spacer/4by3.png"))),'" alt=""><span class="j-slideImgLink">',opt_data.slide.titleLink&&opt_data.slide.titleLink!=""?'<a href="'+
soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.slide.titleLink))+'" '+(opt_data.slide.openInNewWindow?'target="_blank"':"")+">":"",'<img class="j-slide-image" ',opt_data.slide.image?'src="'+soy.$$filterNoAutoescape(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.slide.image))+'"':"",' alt="',soy.$$escapeHtmlAttribute(opt_data.slide.titleText),'" ',!opt_data.slide.image?' style="display: none"':""," />",opt_data.slide.titleLink&&opt_data.slide.titleLink!=""?"</a>":"",'</span></div><div class="j-slideInfo"><div class="j-carousel-slideinfo-bg"></div><h3>',
opt_data.slide.titleLink&&opt_data.slide.titleLink!=""?'<a href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.slide.titleLink))+'" class="j-slideTextLink" '+(opt_data.slide.openInNewWindow?'target="_blank"':"")+'><p class="j-slide-title">'+soy.$$escapeHtml(opt_data.slide.titleText)+"</p></a>":'<p class="j-slide-title">'+soy.$$escapeHtml(opt_data.slide.titleText)+"</p>","</h3>",opt_data.slide.description&&opt_data.slide.description!=""?'<div class="j-slide-caption">'+soy.$$changeNewlineToBr(soy.$$escapeHtml(opt_data.slide.description))+
"</div>":"","</div></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.slideList");
jive.integration.tiles.viewstyle.slideList=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<ul class="j-cSlides js-main-slide clearfix"><li class="j-slide-item clearfix">');jive.integration.tiles.viewstyle.slide({slide:opt_data.slides[0]},output);output.append('</li></ul><div class="j-cPreview" ',!opt_data.previewPane?'style="display:none"':"",'><a href="#" class="j-prev js-prev-slide" aria-label="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("tile.carousel.page.previousSlide"),[])),
'"><span class="jive-icon-med jive-icon-lb-prev-dk"></span></a><ul class="j-cSlidePreview js-slides clearfix">');var slideList13=opt_data.slides;var slideListLen13=slideList13.length;for(var slideIndex13=0;slideIndex13<slideListLen13;slideIndex13++){var slideData13=slideList13[slideIndex13];output.append('<li class="j-slide-item js-slide',slideIndex13==0?" j-active":"",'" data-index="',soy.$$escapeHtmlAttribute(slideIndex13),'">');jive.integration.tiles.viewstyle.slide({slide:slideData13},output);
output.append("</li>")}output.append('</ul><a href="#" class="j-next js-next-slide" aria-label="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("tile.carousel.page.nextSlide"),[])),'"><span class="jive-icon-med jive-icon-lb-next-dk"></span></a></div>');return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.carouselbody");jive.integration.tiles.viewstyle.carouselbody=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.slides.length>1)jive.integration.tiles.viewstyle.controls({totalSlideNumber:opt_data.slides.length},output);jive.integration.tiles.viewstyle.slideList(opt_data,output);return opt_sb?"":output.toString()};
;
/*
 * jQuery UI Effects Slide 1.9.2
 * http://jqueryui.com
 *
 * Copyright 2012 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/slide-effect/
 *
 * Depends:
 * @depends path=/resources/scripts/jquery/ui/jquery.ui.effect.js
 */
(function(a,b){a.effects.effect.slide=function(e,i){var f=a(this),k=["position","top","bottom","left","right","width","height"],j=a.effects.setMode(f,e.mode||"show"),m=j==="show",l=e.direction||"left",g=(l==="up"||l==="down")?"top":"left",d=(l==="up"||l==="left"),c,h={};a.effects.save(f,k);f.show();c=e.distance||f[g==="top"?"outerHeight":"outerWidth"](true);a.effects.createWrapper(f).css({overflow:"hidden"});if(m){f.css(g,d?(isNaN(c)?"-"+c:-c):c)}h[g]=(m?(d?"+=":"-="):(d?"-=":"+="))+c;f.animate(h,{queue:false,duration:e.duration,easing:e.easing,complete:function(){if(j==="hide"){f.hide()}a.effects.restore(f,k);a.effects.removeWrapper(f);i()}})}})(jQuery);
;
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{if(typeof exports!=="undefined"){module.exports=a(require("jquery"))}else{a(jQuery)}}}(function(a){var b=window.Slick||{};b=(function(){var c=0;function d(g,i){var f=this,h,e;f.defaults={accessibility:true,adaptiveHeight:false,appendArrows:a(g),appendDots:a(g),arrows:true,asNavFor:null,prevArrow:'<button type="button" data-role="none" class="slick-prev">Previous</button>',nextArrow:'<button type="button" data-role="none" class="slick-next">Next</button>',autoplay:false,autoplaySpeed:3000,centerMode:false,centerPadding:"50px",cssEase:"ease",customPaging:function(k,j){return'<button type="button" data-role="none">'+(j+1)+"</button>"},dots:false,dotsClass:"slick-dots",draggable:true,easing:"linear",fade:false,focusOnSelect:false,infinite:true,initialSlide:0,lazyLoad:"ondemand",onBeforeChange:null,onAfterChange:null,onInit:null,onReInit:null,onSetPosition:null,pauseOnHover:true,pauseOnDotsHover:false,respondTo:"window",responsive:null,rtl:false,slide:"div",slidesToShow:1,slidesToScroll:1,speed:500,swipe:true,swipeToSlide:false,touchMove:true,touchThreshold:5,useCSS:true,variableWidth:false,vertical:false,waitForAnimate:true};f.initials={animating:false,dragging:false,autoPlayTimer:null,currentDirection:0,currentLeft:null,currentSlide:0,direction:1,$dots:null,listWidth:null,listHeight:null,loadIndex:0,$nextArrow:null,$prevArrow:null,slideCount:null,slideWidth:null,$slideTrack:null,$slides:null,sliding:false,slideOffset:0,swipeLeft:null,$list:null,touchObject:{},transformsEnabled:false};a.extend(f,f.initials);f.activeBreakpoint=null;f.animType=null;f.animProp=null;f.breakpoints=[];f.breakpointSettings=[];f.cssTransitions=false;f.paused=false;f.positionProp=null;f.respondTo=null;f.shouldClick=true;f.$slider=a(g);f.$slidesCache=null;f.transformType=null;f.transitionType=null;f.windowWidth=0;f.windowTimer=null;f.options=a.extend({},f.defaults,i);f.currentSlide=f.options.initialSlide;f.originalSettings=f.options;h=f.options.responsive||null;if(h&&h.length>-1){f.respondTo=f.options.respondTo||"window";for(e in h){if(h.hasOwnProperty(e)){f.breakpoints.push(h[e].breakpoint);f.breakpointSettings[h[e].breakpoint]=h[e].settings}}f.breakpoints.sort(function(k,j){return j-k})}f.autoPlay=a.proxy(f.autoPlay,f);f.autoPlayClear=a.proxy(f.autoPlayClear,f);f.changeSlide=a.proxy(f.changeSlide,f);f.clickHandler=a.proxy(f.clickHandler,f);f.selectHandler=a.proxy(f.selectHandler,f);f.setPosition=a.proxy(f.setPosition,f);f.swipeHandler=a.proxy(f.swipeHandler,f);f.dragHandler=a.proxy(f.dragHandler,f);f.keyHandler=a.proxy(f.keyHandler,f);f.autoPlayIterator=a.proxy(f.autoPlayIterator,f);f.instanceUid=c++;f.htmlExpr=/^(?:\s*(<[\w\W]+>)[^>]*)$/;f.init();f.checkResponsive()}return d}());b.prototype.addSlide=function(c,e,f){var d=this;if(typeof(e)==="boolean"){f=e;e=null}else{if(e<0||(e>=d.slideCount)){return false}}d.unload();if(typeof(e)==="number"){if(e===0&&d.$slides.length===0){a(c).appendTo(d.$slideTrack)}else{if(f){a(c).insertBefore(d.$slides.eq(e))}else{a(c).insertAfter(d.$slides.eq(e))}}}else{if(f===true){a(c).prependTo(d.$slideTrack)}else{a(c).appendTo(d.$slideTrack)}}d.$slides=d.$slideTrack.children(this.options.slide);d.$slideTrack.children(this.options.slide).detach();d.$slideTrack.append(d.$slides);d.$slides.each(function(g,h){a(h).attr("index",g)});d.$slidesCache=d.$slides;d.reinit()};b.prototype.animateSlide=function(g,f){var e={},d=this;if(d.options.slidesToShow===1&&d.options.adaptiveHeight===true&&d.options.vertical===false){var c=d.$slides.eq(d.currentSlide).outerHeight(true);d.$list.animate({height:c},d.options.speed)}if(d.options.rtl===true&&d.options.vertical===false){g=-g}if(d.transformsEnabled===false){if(d.options.vertical===false){d.$slideTrack.animate({left:g},d.options.speed,d.options.easing,f)}else{d.$slideTrack.animate({top:g},d.options.speed,d.options.easing,f)}}else{if(d.cssTransitions===false){a({animStart:d.currentLeft}).animate({animStart:g},{duration:d.options.speed,easing:d.options.easing,step:function(h){if(d.options.vertical===false){e[d.animType]="translate("+h+"px, 0px)";d.$slideTrack.css(e)}else{e[d.animType]="translate(0px,"+h+"px)";d.$slideTrack.css(e)}},complete:function(){if(f){f.call()}}})}else{d.applyTransition();if(d.options.vertical===false){e[d.animType]="translate3d("+g+"px, 0px, 0px)"}else{e[d.animType]="translate3d(0px,"+g+"px, 0px)"}d.$slideTrack.css(e);if(f){setTimeout(function(){d.disableTransition();f.call()},d.options.speed)}}}};b.prototype.asNavFor=function(e){var d=this,c=d.options.asNavFor!=null?a(d.options.asNavFor).getSlick():null;if(c!=null){c.slideHandler(e,true)}};b.prototype.applyTransition=function(c){var d=this,e={};if(d.options.fade===false){e[d.transitionType]=d.transformType+" "+d.options.speed+"ms "+d.options.cssEase}else{e[d.transitionType]="opacity "+d.options.speed+"ms "+d.options.cssEase}if(d.options.fade===false){d.$slideTrack.css(e)}else{d.$slides.eq(c).css(e)}};b.prototype.autoPlay=function(){var c=this;if(c.autoPlayTimer){clearInterval(c.autoPlayTimer)}if(c.slideCount>=c.options.slidesToShow&&c.paused!==true){c.autoPlayTimer=setInterval(c.autoPlayIterator,c.options.autoplaySpeed)}};b.prototype.autoPlayClear=function(){var c=this;if(c.autoPlayTimer){clearInterval(c.autoPlayTimer)}};b.prototype.autoPlayIterator=function(){var c=this;if(c.options.infinite===false){if(c.direction===1){if((c.currentSlide+1)===c.slideCount-1){c.direction=0}c.slideHandler(c.currentSlide+c.options.slidesToScroll)}else{if((c.currentSlide-1===0)){c.direction=1}c.slideHandler(c.currentSlide-c.options.slidesToScroll)}}else{c.slideHandler(c.currentSlide+c.options.slidesToScroll)}};b.prototype.buildArrows=function(){var c=this;if(c.options.arrows===true&&c.slideCount>c.options.slidesToShow){c.$prevArrow=a(c.options.prevArrow);c.$nextArrow=a(c.options.nextArrow);if(c.htmlExpr.test(c.options.prevArrow)){c.$prevArrow.appendTo(c.options.appendArrows)}if(c.htmlExpr.test(c.options.nextArrow)){c.$nextArrow.appendTo(c.options.appendArrows)}if(c.options.infinite!==true){c.$prevArrow.addClass("slick-disabled")}}};b.prototype.buildDots=function(){var d=this,e,c;if(d.options.dots===true&&d.slideCount>d.options.slidesToShow){c='<ul class="'+d.options.dotsClass+'">';for(e=0;e<=d.getDotCount();e+=1){c+="<li>"+d.options.customPaging.call(this,d,e)+"</li>"}c+="</ul>";d.$dots=a(c).appendTo(d.options.appendDots);d.$dots.find("li").first().addClass("slick-active")}};b.prototype.buildOut=function(){var c=this;c.$slides=c.$slider.children(c.options.slide+":not(.slick-cloned)").addClass("slick-slide");c.slideCount=c.$slides.length;c.$slides.each(function(d,e){a(e).attr("index",d)});c.$slidesCache=c.$slides;c.$slider.addClass("slick-slider");c.$slideTrack=(c.slideCount===0)?a('<div class="slick-track"/>').appendTo(c.$slider):c.$slides.wrapAll('<div class="slick-track"/>').parent();c.$list=c.$slideTrack.wrap('<div class="slick-list"/>').parent();c.$slideTrack.css("opacity",0);if(c.options.centerMode===true){c.options.slidesToScroll=1}a("img[data-lazy]",c.$slider).not("[src]").addClass("slick-loading");c.setupInfinite();c.buildArrows();c.buildDots();c.updateDots();if(c.options.accessibility===true){c.$list.prop("tabIndex",0)}c.setSlideClasses(typeof this.currentSlide==="number"?this.currentSlide:0);if(c.options.draggable===true){c.$list.addClass("draggable")}};b.prototype.checkResponsive=function(){var d=this,c,h,g;var f=d.$slider.width();var e=window.innerWidth||a(window).width();if(d.respondTo==="window"){g=e}else{if(d.respondTo==="slider"){g=f}else{if(d.respondTo==="min"){g=Math.min(e,f)}}}if(d.originalSettings.responsive&&d.originalSettings.responsive.length>-1&&d.originalSettings.responsive!==null){h=null;for(c in d.breakpoints){if(d.breakpoints.hasOwnProperty(c)){if(g<d.breakpoints[c]){h=d.breakpoints[c]}}}if(h!==null){if(d.activeBreakpoint!==null){if(h!==d.activeBreakpoint){d.activeBreakpoint=h;d.options=a.extend({},d.originalSettings,d.breakpointSettings[h]);d.refresh()}}else{d.activeBreakpoint=h;d.options=a.extend({},d.originalSettings,d.breakpointSettings[h]);d.refresh()}}else{if(d.activeBreakpoint!==null){d.activeBreakpoint=null;d.options=d.originalSettings;d.refresh()}}}};b.prototype.changeSlide=function(d,c){var m=this,g=a(d.target),j,e,i,l,f;g.is("a")&&d.preventDefault();i=(m.slideCount%m.options.slidesToScroll!==0);j=i?0:(m.slideCount-m.currentSlide)%m.options.slidesToScroll;switch(d.data.message){case"previous":e=j===0?m.options.slidesToScroll:m.options.slidesToShow-j;if(m.slideCount>=m.options.slidesToShow){m.slideHandler(m.currentSlide-e,false,c)}break;case"next":e=j===0?m.options.slidesToScroll:j;if(m.slideCount>=m.options.slidesToShow){m.slideHandler(m.currentSlide+e,false,c)}break;case"index":var k=d.data.index===0?0:d.data.index||a(d.target).parent().index()*m.options.slidesToScroll;l=m.getNavigableIndexes();f=0;if(l[k]&&l[k]===k){if(k>l[l.length-1]){k=l[l.length-1]}else{for(var h in l){if(k<l[h]){k=f;break}f=l[h]}}}m.slideHandler(k,false,c);default:return}};b.prototype.clickHandler=function(d){var c=this;if(c.shouldClick===false){d.stopImmediatePropagation();d.stopPropagation();d.preventDefault()}};b.prototype.destroy=function(){var c=this;c.autoPlayClear();c.touchObject={};a(".slick-cloned",c.$slider).remove();if(c.$dots){c.$dots.remove()}if(c.$prevArrow&&(typeof c.options.prevArrow!=="object")){c.$prevArrow.remove()}if(c.$nextArrow&&(typeof c.options.nextArrow!=="object")){c.$nextArrow.remove()}if(c.$slides.parent().hasClass("slick-track")){c.$slides.unwrap().unwrap()}c.$slides.removeClass("slick-slide slick-active slick-center slick-visible").removeAttr("index").css({position:"",left:"",top:"",zIndex:"",opacity:"",width:""});c.$slider.removeClass("slick-slider");c.$slider.removeClass("slick-initialized");c.$list.off(".slick");a(window).off(".slick-"+c.instanceUid);a(document).off(".slick-"+c.instanceUid)};b.prototype.disableTransition=function(c){var d=this,e={};e[d.transitionType]="";if(d.options.fade===false){d.$slideTrack.css(e)}else{d.$slides.eq(c).css(e)}};b.prototype.fadeSlide=function(d,e,f){var c=this;if(c.cssTransitions===false){c.$slides.eq(e).css({zIndex:1000});c.$slides.eq(e).animate({opacity:1},c.options.speed,c.options.easing,f);c.$slides.eq(d).animate({opacity:0},c.options.speed,c.options.easing)}else{c.applyTransition(e);c.applyTransition(d);c.$slides.eq(e).css({opacity:1,zIndex:1000});c.$slides.eq(d).css({opacity:0});if(f){setTimeout(function(){c.disableTransition(e);c.disableTransition(d);f.call()},c.options.speed)}}};b.prototype.filterSlides=function(d){var c=this;if(d!==null){c.unload();c.$slideTrack.children(this.options.slide).detach();c.$slidesCache.filter(d).appendTo(c.$slideTrack);c.reinit()}};b.prototype.getCurrent=function(){var c=this;return c.currentSlide};b.prototype.getDotCount=function(){var d=this;var f=0;var c=0;var e=0;if(d.options.infinite===true){e=Math.ceil(d.slideCount/d.options.slidesToScroll)}else{while(f<d.slideCount){++e;f=c+d.options.slidesToShow;c+=d.options.slidesToScroll<=d.options.slidesToShow?d.options.slidesToScroll:d.options.slidesToShow}}return e-1};b.prototype.getLeft=function(f){var d=this,i,e,c=0,h,g;d.slideOffset=0;e=d.$slides.first().outerHeight();if(d.options.infinite===true){if(d.slideCount>d.options.slidesToShow){d.slideOffset=(d.slideWidth*d.options.slidesToShow)*-1;c=(e*d.options.slidesToShow)*-1}if(d.slideCount%d.options.slidesToScroll!==0){if(f+d.options.slidesToScroll>d.slideCount&&d.slideCount>d.options.slidesToShow){if(f>d.slideCount){d.slideOffset=((d.options.slidesToShow-(f-d.slideCount))*d.slideWidth)*-1;c=((d.options.slidesToShow-(f-d.slideCount))*e)*-1}else{d.slideOffset=((d.slideCount%d.options.slidesToScroll)*d.slideWidth)*-1;c=((d.slideCount%d.options.slidesToScroll)*e)*-1}}}}else{if(f+d.options.slidesToShow>d.slideCount){d.slideOffset=((f+d.options.slidesToShow)-d.slideCount)*d.slideWidth;c=((f+d.options.slidesToShow)-d.slideCount)*e}}if(d.slideCount<=d.options.slidesToShow){d.slideOffset=0;c=0}if(d.options.centerMode===true&&d.options.infinite===true){d.slideOffset+=d.slideWidth*Math.floor(d.options.slidesToShow/2)-d.slideWidth}else{if(d.options.centerMode===true){d.slideOffset=0;d.slideOffset+=d.slideWidth*Math.floor(d.options.slidesToShow/2)}}if(d.options.vertical===false){i=((f*d.slideWidth)*-1)+d.slideOffset}else{i=((f*e)*-1)+c}if(d.options.variableWidth===true){if(d.slideCount<=d.options.slidesToShow||d.options.infinite===false){g=d.$slideTrack.children(".slick-slide").eq(f)}else{g=d.$slideTrack.children(".slick-slide").eq(f+d.options.slidesToShow)}i=g[0]?g[0].offsetLeft*-1:0;if(d.options.centerMode===true){if(d.options.infinite===false){g=d.$slideTrack.children(".slick-slide").eq(f)}else{g=d.$slideTrack.children(".slick-slide").eq(f+d.options.slidesToShow+1)}i=g[0]?g[0].offsetLeft*-1:0;i+=(d.$list.width()-g.outerWidth())/2}}return i};b.prototype.getNavigableIndexes=function(){var e=this;var f=0;var c=0;var d=[];while(f<e.slideCount){d.push(f);f=c+e.options.slidesToScroll;c+=e.options.slidesToScroll<=e.options.slidesToShow?e.options.slidesToScroll:e.options.slidesToShow}return d};b.prototype.getSlideCount=function(){var d=this,c;if(d.options.swipeToSlide===true){var e=null;d.$slideTrack.find(".slick-slide").each(function(g,f){if(f.offsetLeft+(a(f).outerWidth()/2)>(d.swipeLeft*-1)){e=f;return false}});c=Math.abs(a(e).attr("index")-d.currentSlide);return c}else{return d.options.slidesToScroll}};b.prototype.init=function(){var c=this;if(!a(c.$slider).hasClass("slick-initialized")){a(c.$slider).addClass("slick-initialized");c.buildOut();c.setProps();c.startLoad();c.loadSlider();c.initializeEvents();c.updateArrows();c.updateDots()}if(c.options.onInit!==null){c.options.onInit.call(this,c)}};b.prototype.initArrowEvents=function(){var c=this;if(c.options.arrows===true&&c.slideCount>c.options.slidesToShow){c.$prevArrow.on("click.slick",{message:"previous"},c.changeSlide);c.$nextArrow.on("click.slick",{message:"next"},c.changeSlide)}};b.prototype.initDotEvents=function(){var c=this;if(c.options.dots===true&&c.slideCount>c.options.slidesToShow){a("li",c.$dots).on("click.slick",{message:"index"},c.changeSlide)}if(c.options.dots===true&&c.options.pauseOnDotsHover===true&&c.options.autoplay===true){a("li",c.$dots).on("mouseenter.slick",function(){c.paused=true;c.autoPlayClear()}).on("mouseleave.slick",function(){c.paused=false;c.autoPlay()})}};b.prototype.initializeEvents=function(){var c=this;c.initArrowEvents();c.initDotEvents();c.$list.on("touchstart.slick mousedown.slick",{action:"start"},c.swipeHandler);c.$list.on("touchmove.slick mousemove.slick",{action:"move"},c.swipeHandler);c.$list.on("touchend.slick mouseup.slick",{action:"end"},c.swipeHandler);c.$list.on("touchcancel.slick mouseleave.slick",{action:"end"},c.swipeHandler);c.$list.on("click.slick",c.clickHandler);if(c.options.pauseOnHover===true&&c.options.autoplay===true){c.$list.on("mouseenter.slick",function(){c.paused=true;c.autoPlayClear()});c.$list.on("mouseleave.slick",function(){c.paused=false;c.autoPlay()})}if(c.options.accessibility===true){c.$list.on("keydown.slick",c.keyHandler)}if(c.options.focusOnSelect===true){a(c.options.slide,c.$slideTrack).on("click.slick",c.selectHandler)}a(window).on("orientationchange.slick.slick-"+c.instanceUid,function(){c.checkResponsive();c.setPosition()});a(window).on("resize.slick.slick-"+c.instanceUid,function(){if(a(window).width()!==c.windowWidth){clearTimeout(c.windowDelay);c.windowDelay=window.setTimeout(function(){c.windowWidth=a(window).width();c.checkResponsive();c.setPosition()},50)}});a("*[draggable!=true]",c.$slideTrack).on("dragstart",function(d){d.preventDefault()});a(window).on("load.slick.slick-"+c.instanceUid,c.setPosition);a(document).on("ready.slick.slick-"+c.instanceUid,c.setPosition)};b.prototype.initUI=function(){var c=this;if(c.options.arrows===true&&c.slideCount>c.options.slidesToShow){c.$prevArrow.show();c.$nextArrow.show()}if(c.options.dots===true&&c.slideCount>c.options.slidesToShow){c.$dots.show()}if(c.options.autoplay===true){c.autoPlay()}};b.prototype.keyHandler=function(d){var c=this;if(d.keyCode===37&&c.options.accessibility===true){c.changeSlide({data:{message:"previous"}})}else{if(d.keyCode===39&&c.options.accessibility===true){c.changeSlide({data:{message:"next"}})}}};b.prototype.lazyLoad=function(){var e=this,c,h,g,f;function d(i){a("img[data-lazy]",i).each(function(){var j=a(this),k=a(this).attr("data-lazy");j.load(function(){j.animate({opacity:1},200)}).css({opacity:0}).attr("src",k).removeAttr("data-lazy").removeClass("slick-loading")})}if(e.options.centerMode===true){if(e.options.infinite===true){g=e.currentSlide+(e.options.slidesToShow/2+1);f=g+e.options.slidesToShow+2}else{g=Math.max(0,e.currentSlide-(e.options.slidesToShow/2+1));f=2+(e.options.slidesToShow/2+1)+e.currentSlide}}else{g=e.options.infinite?e.options.slidesToShow+e.currentSlide:e.currentSlide;f=g+e.options.slidesToShow;if(e.options.fade===true){if(g>0){g--}if(f<=e.slideCount){f++}}}c=e.$slider.find(".slick-slide").slice(g,f);d(c);if(e.slideCount<=e.options.slidesToShow){h=e.$slider.find(".slick-slide");d(h)}else{if(e.currentSlide>=e.slideCount-e.options.slidesToShow){h=e.$slider.find(".slick-cloned").slice(0,e.options.slidesToShow);d(h)}else{if(e.currentSlide===0){h=e.$slider.find(".slick-cloned").slice(e.options.slidesToShow*-1);d(h)}}}};b.prototype.loadSlider=function(){var c=this;c.setPosition();c.$slideTrack.css({opacity:1});c.$slider.removeClass("slick-loading");c.initUI();if(c.options.lazyLoad==="progressive"){c.progressiveLazyLoad()}};b.prototype.postSlide=function(d){var c=this;if(c.options.onAfterChange!==null){c.options.onAfterChange.call(this,c,d)}c.animating=false;c.setPosition();c.swipeLeft=null;if(c.options.autoplay===true&&c.paused===false){c.autoPlay()}};b.prototype.progressiveLazyLoad=function(){var d=this,c,e;c=a("img[data-lazy]",d.$slider).length;if(c>0){e=a("img[data-lazy]",d.$slider).first();e.attr("src",e.attr("data-lazy")).removeClass("slick-loading").load(function(){e.removeAttr("data-lazy");d.progressiveLazyLoad()}).error(function(){e.removeAttr("data-lazy");d.progressiveLazyLoad()})}};b.prototype.refresh=function(){var c=this,d=c.currentSlide;c.destroy();a.extend(c,c.initials);c.init();c.changeSlide({data:{message:"index",index:d,}},true)};b.prototype.reinit=function(){var c=this;c.$slides=c.$slideTrack.children(c.options.slide).addClass("slick-slide");c.slideCount=c.$slides.length;if(c.currentSlide>=c.slideCount&&c.currentSlide!==0){c.currentSlide=c.currentSlide-c.options.slidesToScroll}if(c.slideCount<=c.options.slidesToShow){c.currentSlide=0}c.setProps();c.setupInfinite();c.buildArrows();c.updateArrows();c.initArrowEvents();c.buildDots();c.updateDots();c.initDotEvents();if(c.options.focusOnSelect===true){a(c.options.slide,c.$slideTrack).on("click.slick",c.selectHandler)}c.setSlideClasses(0);c.setPosition();if(c.options.onReInit!==null){c.options.onReInit.call(this,c)}};b.prototype.removeSlide=function(d,f,e){var c=this;if(typeof(d)==="boolean"){f=d;d=f===true?0:c.slideCount-1}else{d=f===true?--d:d}if(c.slideCount<1||d<0||d>c.slideCount-1){return false}c.unload();if(e===true){c.$slideTrack.children().remove()}else{c.$slideTrack.children(this.options.slide).eq(d).remove()}c.$slides=c.$slideTrack.children(this.options.slide);c.$slideTrack.children(this.options.slide).detach();c.$slideTrack.append(c.$slides);c.$slidesCache=c.$slides;c.reinit()};b.prototype.setCSS=function(d){var e=this,f={},c,g;if(e.options.rtl===true){d=-d}c=e.positionProp=="left"?d+"px":"0px";g=e.positionProp=="top"?d+"px":"0px";f[e.positionProp]=d;if(e.transformsEnabled===false){e.$slideTrack.css(f)}else{f={};if(e.cssTransitions===false){f[e.animType]="translate("+c+", "+g+")";e.$slideTrack.css(f)}else{f[e.animType]="translate3d("+c+", "+g+", 0px)";e.$slideTrack.css(f)}}};b.prototype.setDimensions=function(){var d=this;if(d.options.vertical===false){if(d.options.centerMode===true){d.$list.css({padding:("0px "+d.options.centerPadding)})}}else{d.$list.height(d.$slides.first().outerHeight(true)*d.options.slidesToShow);if(d.options.centerMode===true){d.$list.css({padding:(d.options.centerPadding+" 0px")})}}d.listWidth=d.$list.width();d.listHeight=d.$list.height();if(d.options.vertical===false&&d.options.variableWidth===false){d.slideWidth=Math.ceil(d.listWidth/d.options.slidesToShow);d.$slideTrack.width(Math.ceil((d.slideWidth*d.$slideTrack.children(".slick-slide").length))+d.slideWidth)}else{if(d.options.variableWidth===true){var c=0;d.slideWidth=Math.ceil(d.listWidth/d.options.slidesToShow);d.$slideTrack.children(".slick-slide").each(function(){c+=Math.ceil(a(this).outerWidth(true))});d.$slideTrack.width(Math.ceil(c)+1)}else{d.slideWidth=Math.ceil(d.listWidth);d.$slideTrack.height(Math.ceil((d.$slides.first().outerHeight(true)*d.$slideTrack.children(".slick-slide").length)))}}var e=d.$slides.first().outerWidth(true)-d.$slides.first().width();if(d.options.variableWidth===false){d.$slideTrack.children(".slick-slide").width(d.slideWidth-e)}};b.prototype.setFade=function(){var c=this,d;c.$slides.each(function(e,f){d=(c.slideWidth*e)*-1;if(c.options.rtl===true){a(f).css({position:"relative",right:d,top:0,zIndex:800,opacity:0})}else{a(f).css({position:"relative",left:d,top:0,zIndex:800,opacity:0})}});c.$slides.eq(c.currentSlide).css({zIndex:900,opacity:1})};b.prototype.setHeight=function(){var d=this;if(d.options.slidesToShow===1&&d.options.adaptiveHeight===true&&d.options.vertical===false){var c=d.$slides.eq(d.currentSlide).outerHeight(true);d.$list.css("height",c)}};b.prototype.setPosition=function(){var c=this;c.setDimensions();c.setHeight();if(c.options.fade===false){c.setCSS(c.getLeft(c.currentSlide))}else{c.setFade()}if(c.options.onSetPosition!==null){c.options.onSetPosition.call(this,c)}};b.prototype.setProps=function(){var d=this,c=document.body.style;d.positionProp=d.options.vertical===true?"top":"left";if(d.positionProp==="top"){d.$slider.addClass("slick-vertical")}else{d.$slider.removeClass("slick-vertical")}if(c.WebkitTransition!==undefined||c.MozTransition!==undefined||c.msTransition!==undefined){if(d.options.useCSS===true){d.cssTransitions=true}}if(c.OTransform!==undefined){d.animType="OTransform";d.transformType="-o-transform";d.transitionType="OTransition";if(c.perspectiveProperty===undefined&&c.webkitPerspective===undefined){d.animType=false}}if(c.MozTransform!==undefined){d.animType="MozTransform";d.transformType="-moz-transform";d.transitionType="MozTransition";if(c.perspectiveProperty===undefined&&c.MozPerspective===undefined){d.animType=false}}if(c.webkitTransform!==undefined){d.animType="webkitTransform";d.transformType="-webkit-transform";d.transitionType="webkitTransition";if(c.perspectiveProperty===undefined&&c.webkitPerspective===undefined){d.animType=false}}if(c.msTransform!==undefined){d.animType="msTransform";d.transformType="-ms-transform";d.transitionType="msTransition";if(c.msTransform===undefined){d.animType=false}}if(c.transform!==undefined&&d.animType!==false){d.animType="transform";d.transformType="transform";d.transitionType="transition"}d.transformsEnabled=(d.animType!==null&&d.animType!==false)};b.prototype.setSlideClasses=function(f){var e=this,c,d,h,g;e.$slider.find(".slick-slide").removeClass("slick-active").removeClass("slick-center");d=e.$slider.find(".slick-slide");if(e.options.centerMode===true){c=Math.floor(e.options.slidesToShow/2);if(e.options.infinite===true){if(f>=c&&f<=(e.slideCount-1)-c){e.$slides.slice(f-c,f+c+1).addClass("slick-active")}else{h=e.options.slidesToShow+f;d.slice(h-c+1,h+c+2).addClass("slick-active")}if(f===0){d.eq(d.length-1-e.options.slidesToShow).addClass("slick-center")}else{if(f===e.slideCount-1){d.eq(e.options.slidesToShow).addClass("slick-center")}}}e.$slides.eq(f).addClass("slick-center")}else{if(f>=0&&f<=(e.slideCount-e.options.slidesToShow)){e.$slides.slice(f,f+e.options.slidesToShow).addClass("slick-active")}else{if(d.length<=e.options.slidesToShow){d.addClass("slick-active")}else{g=e.slideCount%e.options.slidesToShow;h=e.options.infinite===true?e.options.slidesToShow+f:f;if(e.options.slidesToShow==e.options.slidesToScroll&&(e.slideCount-f)<e.options.slidesToShow){d.slice(h-(e.options.slidesToShow-g),h+g).addClass("slick-active")}else{d.slice(h,h+e.options.slidesToShow).addClass("slick-active")}}}}if(e.options.lazyLoad==="ondemand"){e.lazyLoad()}};b.prototype.setupInfinite=function(){var c=this,d,f,e;if(c.options.fade===true){c.options.centerMode=false}if(c.options.infinite===true&&c.options.fade===false){f=null;if(c.slideCount>c.options.slidesToShow){if(c.options.centerMode===true){e=c.options.slidesToShow+1}else{e=c.options.slidesToShow}for(d=c.slideCount;d>(c.slideCount-e);d-=1){f=d-1;a(c.$slides[f]).clone(true).attr("id","").attr("index",f-c.slideCount).prependTo(c.$slideTrack).addClass("slick-cloned")}for(d=0;d<e;d+=1){f=d;a(c.$slides[f]).clone(true).attr("id","").attr("index",f+c.slideCount).appendTo(c.$slideTrack).addClass("slick-cloned")}c.$slideTrack.find(".slick-cloned").find("[id]").each(function(){a(this).attr("id","")})}}};b.prototype.selectHandler=function(e){var d=this;var c=parseInt(a(e.target).parents(".slick-slide").attr("index"));if(!c){c=0}if(d.slideCount<=d.options.slidesToShow){d.$slider.find(".slick-slide").removeClass("slick-active");d.$slides.eq(c).addClass("slick-active");if(d.options.centerMode===true){d.$slider.find(".slick-slide").removeClass("slick-center");d.$slides.eq(c).addClass("slick-center")}d.asNavFor(c);return}d.slideHandler(c)};b.prototype.slideHandler=function(f,i,d){var c,l,h,j,e,g=null,k=this;i=i||false;if(k.animating===true&&k.options.waitForAnimate===true){return}if(k.options.fade===true&&k.currentSlide===f){return}if(k.slideCount<k.options.slidesToShow){return}if(i===false){k.asNavFor(f)}c=f;g=k.getLeft(c);j=k.getLeft(k.currentSlide);k.currentLeft=k.swipeLeft===null?j:k.swipeLeft;if(k.options.infinite===false&&k.options.centerMode===false&&(f<0||f>k.getDotCount()*k.options.slidesToScroll)){if(k.options.fade===false){c=k.currentSlide;if(d!==true){k.animateSlide(j,function(){k.postSlide(c)})}else{k.postSlide(c)}}return}else{if(k.options.infinite===false&&k.options.centerMode===true&&(f<0||f>(k.slideCount-k.options.slidesToScroll))){if(k.options.fade===false){c=k.currentSlide;if(d!==true){k.animateSlide(j,function(){k.postSlide(c)})}else{k.postSlide(c)}}return}}if(k.options.autoplay===true){clearInterval(k.autoPlayTimer)}if(c<0){if(k.slideCount%k.options.slidesToScroll!==0){l=k.slideCount-(k.slideCount%k.options.slidesToScroll)}else{l=k.slideCount+c}}else{if(c>=k.slideCount){if(k.slideCount%k.options.slidesToScroll!==0){l=0}else{l=c-k.slideCount}}else{l=c}}k.animating=true;if(k.options.onBeforeChange!==null&&f!==k.currentSlide){k.options.onBeforeChange.call(this,k,k.currentSlide,l)}h=k.currentSlide;k.currentSlide=l;k.setSlideClasses(k.currentSlide);k.updateDots();k.updateArrows();if(k.options.fade===true){if(d!==true){k.fadeSlide(h,l,function(){k.postSlide(l)})}else{k.postSlide(l)}return}if(d!==true){k.animateSlide(g,function(){k.postSlide(l)})}else{k.postSlide(l)}};b.prototype.startLoad=function(){var c=this;if(c.options.arrows===true&&c.slideCount>c.options.slidesToShow){c.$prevArrow.hide();c.$nextArrow.hide()}if(c.options.dots===true&&c.slideCount>c.options.slidesToShow){c.$dots.hide()}c.$slider.addClass("slick-loading")};b.prototype.swipeDirection=function(){var c,f,e,g,d=this;c=d.touchObject.startX-d.touchObject.curX;f=d.touchObject.startY-d.touchObject.curY;e=Math.atan2(f,c);g=Math.round(e*180/Math.PI);if(g<0){g=360-Math.abs(g)}if((g<=45)&&(g>=0)){return(d.options.rtl===false?"left":"right")}if((g<=360)&&(g>=315)){return(d.options.rtl===false?"left":"right")}if((g>=135)&&(g<=225)){return(d.options.rtl===false?"right":"left")}return"vertical"};b.prototype.swipeEnd=function(e){var d=this,c;d.dragging=false;d.shouldClick=(d.touchObject.swipeLength>10)?false:true;if(d.touchObject.curX===undefined){return false}if(d.touchObject.swipeLength>=d.touchObject.minSwipe){switch(d.swipeDirection()){case"left":d.slideHandler(d.currentSlide+d.getSlideCount());d.currentDirection=0;d.touchObject={};break;case"right":d.slideHandler(d.currentSlide-d.getSlideCount());d.currentDirection=1;d.touchObject={};break}}else{if(d.touchObject.startX!==d.touchObject.curX){d.slideHandler(d.currentSlide);d.touchObject={}}}};b.prototype.swipeHandler=function(d){var c=this;if((c.options.swipe===false)||("ontouchend" in document&&c.options.swipe===false)){return}else{if(c.options.draggable===false&&d.type.indexOf("mouse")!==-1){return}}c.touchObject.fingerCount=d.originalEvent&&d.originalEvent.touches!==undefined?d.originalEvent.touches.length:1;c.touchObject.minSwipe=c.listWidth/c.options.touchThreshold;switch(d.data.action){case"start":c.swipeStart(d);break;case"move":c.swipeMove(d);break;case"end":c.swipeEnd(d);break}};b.prototype.swipeMove=function(f){var e=this,g,d,c,h;h=f.originalEvent!==undefined?f.originalEvent.touches:null;if(!e.dragging||h&&h.length!==1){return false}g=e.getLeft(e.currentSlide);e.touchObject.curX=h!==undefined?h[0].pageX:f.clientX;e.touchObject.curY=h!==undefined?h[0].pageY:f.clientY;e.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(e.touchObject.curX-e.touchObject.startX,2)));d=e.swipeDirection();if(d==="vertical"){return}if(f.originalEvent!==undefined&&e.touchObject.swipeLength>4){f.preventDefault()}c=(e.options.rtl===false?1:-1)*(e.touchObject.curX>e.touchObject.startX?1:-1);if(e.options.vertical===false){e.swipeLeft=g+e.touchObject.swipeLength*c}else{e.swipeLeft=g+(e.touchObject.swipeLength*(e.$list.height()/e.listWidth))*c}if(e.options.fade===true||e.options.touchMove===false){return false}if(e.animating===true){e.swipeLeft=null;return false}e.setCSS(e.swipeLeft)};b.prototype.swipeStart=function(d){var c=this,e;if(c.touchObject.fingerCount!==1||c.slideCount<=c.options.slidesToShow){c.touchObject={};return false}if(d.originalEvent!==undefined&&d.originalEvent.touches!==undefined){e=d.originalEvent.touches[0]}c.touchObject.startX=c.touchObject.curX=e!==undefined?e.pageX:d.clientX;c.touchObject.startY=c.touchObject.curY=e!==undefined?e.pageY:d.clientY;c.dragging=true};b.prototype.unfilterSlides=function(){var c=this;if(c.$slidesCache!==null){c.unload();c.$slideTrack.children(this.options.slide).detach();c.$slidesCache.appendTo(c.$slideTrack);c.reinit()}};b.prototype.unload=function(){var c=this;a(".slick-cloned",c.$slider).remove();if(c.$dots){c.$dots.remove()}if(c.$prevArrow&&(typeof c.options.prevArrow!=="object")){c.$prevArrow.remove()}if(c.$nextArrow&&(typeof c.options.nextArrow!=="object")){c.$nextArrow.remove()}c.$slides.removeClass("slick-slide slick-active slick-visible").css("width","")};b.prototype.updateArrows=function(){var d=this,c;c=Math.floor(d.options.slidesToShow/2);if(d.options.arrows===true&&d.options.infinite!==true&&d.slideCount>d.options.slidesToShow){d.$prevArrow.removeClass("slick-disabled");d.$nextArrow.removeClass("slick-disabled");if(d.currentSlide===0){d.$prevArrow.addClass("slick-disabled");d.$nextArrow.removeClass("slick-disabled")}else{if(d.currentSlide>=d.slideCount-d.options.slidesToShow&&d.options.centerMode===false){d.$nextArrow.addClass("slick-disabled");d.$prevArrow.removeClass("slick-disabled")}else{if(d.currentSlide>d.slideCount-d.options.slidesToShow+c&&d.options.centerMode===true){d.$nextArrow.addClass("slick-disabled");d.$prevArrow.removeClass("slick-disabled")}}}}};b.prototype.updateDots=function(){var c=this;if(c.$dots!==null){c.$dots.find("li").removeClass("slick-active");c.$dots.find("li").eq(Math.floor(c.currentSlide/c.options.slidesToScroll)).addClass("slick-active")}};a.fn.slick=function(d){var c=this;return c.each(function(e,f){f.slick=new b(f,d)})};a.fn.slickAdd=function(c,f,e){var d=this;return d.each(function(g,h){h.slick.addSlide(c,f,e)})};a.fn.slickCurrentSlide=function(){var c=this;return c.get(0).slick.getCurrent()};a.fn.slickFilter=function(d){var c=this;return c.each(function(e,f){f.slick.filterSlides(d)})};a.fn.slickGoTo=function(c,e){var d=this;return d.each(function(f,g){g.slick.changeSlide({data:{message:"index",index:parseInt(c)}},e)})};a.fn.slickNext=function(){var c=this;return c.each(function(d,e){e.slick.changeSlide({data:{message:"next"}})})};a.fn.slickPause=function(){var c=this;return c.each(function(d,e){e.slick.autoPlayClear();e.slick.paused=true})};a.fn.slickPlay=function(){var c=this;return c.each(function(d,e){e.slick.paused=false;e.slick.autoPlay()})};a.fn.slickPrev=function(){var c=this;return c.each(function(d,e){e.slick.changeSlide({data:{message:"previous"}})})};a.fn.slickRemove=function(d,e){var c=this;return c.each(function(f,g){g.slick.removeSlide(d,e)})};a.fn.slickRemoveAll=function(){var c=this;return c.each(function(d,e){e.slick.removeSlide(null,null,true)})};a.fn.slickGetOption=function(d){var c=this;return c.get(0).slick.options[d]};a.fn.slickSetOption=function(e,f,d){var c=this;return c.each(function(g,h){h.slick.options[e]=f;if(d===true){h.slick.unload();h.slick.reinit()}})};a.fn.slickUnfilter=function(){var c=this;return c.each(function(d,e){e.slick.unfilterSlides()})};a.fn.unslick=function(){var c=this;return c.each(function(d,e){if(e.slick){e.slick.destroy()}})};a.fn.getSlick=function(){var d=null;var c=this;c.each(function(e,f){d=f.slick});return d}}));
;
goog.provide("jive.integration.tiles.viewstyle.carousel");
jive.integration.tiles.viewstyle.carousel=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.title)jive.integration.tiles.view.header(opt_data,output);output.append('<section id="js-tile-carousel-',soy.$$escapeHtmlAttribute(opt_data.tileInstanceId),'" class="j-tile-carousel j-tile-body clearfix ',opt_data.config&&opt_data.config.previewPane?"js-carousel-preview-pane j-carousel-show-previewPane":"",'">');if(typeof opt_data.contents=="string"||opt_data.contents.length<=0)jive.integration.tiles.viewstyle.noResults(null,
output);else jive.integration.tiles.viewstyle.carouselbody({slides:opt_data.contents,previewPane:opt_data.config&&opt_data.config.previewPane},output);output.append("</section><script type=\"text/javascript\">$j(function() {require(['apps/tile/integrations/carousel'], function(carouselFunction) {carouselFunction();});});<\/script>");return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.commentControl");
jive.integration.tiles.viewstyle.commentControl=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;switch(opt_data.type){default:output.append('<a href="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.url+"#jive-comments"))),'">');jive.shared.soy.getCountTextByType({count:opt_data.commentCount,type:"commentcount"},output);output.append("</a>")}return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.badge.badges");jive.outcomes.badge.badges=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;var outcomeList3=opt_data.outcomes;var outcomeListLen3=outcomeList3.length;for(var outcomeIndex3=0;outcomeIndex3<outcomeListLen3;outcomeIndex3++){var outcomeData3=outcomeList3[outcomeIndex3];jive.outcomes.badge.outcomeBadge({outcome:outcomeData3,embedded:opt_data.embedded},output)}return opt_sb?"":output.toString()};
;
goog.provide("jive.outcomes.badge.badgeContainer");
jive.outcomes.badge.badgeContainer=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<ul class="js-outcome-badge-container j-outcome-badge-container js-ed-',soy.$$escapeHtml(opt_data.objectType),"-",soy.$$escapeHtml(opt_data.objectId),opt_data.extraClasses?" "+soy.$$escapeHtml(opt_data.extraClasses):"",'" data-object-type="',soy.$$escapeHtml(opt_data.objectType),'" data-object-id="',soy.$$escapeHtml(opt_data.objectId),'"',opt_data.parentType?'data-parent-object-type="'+
soy.$$escapeHtml(opt_data.parentType)+'"':"",opt_data.parentID?'data-parent-object-id="'+soy.$$escapeHtml(opt_data.parentID)+'"':"",'aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.badgeContainer.ariaLabel"),[])),'"',opt_data.allowedOutcomeTypes?'data-allowed-outcome-types="'+soy.$$escapeHtml(JSON.stringify(opt_data.allowedOutcomeTypes).replace(/</g,"\\u003C").replace(/>/g,"\\u003E").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029"))+'"':"",'aria-live="polite">');
if(opt_data.outcomes)jive.outcomes.badge.badges(opt_data,output);else if(opt_data.outcomeTypeName)jive.outcomes.badge.badge({outcomeType:opt_data.outcomeTypeName,embedded:opt_data.embedded,objectType:opt_data.objectType,objectId:opt_data.objectId,outcomeId:opt_data.outcomeId},output);output.append("</ul>");return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.outcomes");jive.integration.tiles.viewstyle.outcomes=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.outcomes.badge.badgeContainer({objectType:opt_data.type,objectId:opt_data.id},output);return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.userLink");
jive.integration.tiles.viewstyle.userLink=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<a href="',soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/people/"+encodeURIComponent(opt_data.username))),'" class="linkText jiveTT-hover-user ',opt_data.userIsPartner?"j-partner ":"",'" target="_action_link" data-userid="',soy.$$escapeHtml(opt_data.userID),'">',soy.$$filterNoAutoescape(opt_data.displayName),"</a>");return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.titleAndAuthor");
jive.integration.tiles.viewstyle.titleAndAuthor=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-title" role="heading">',opt_data.iconClass?'<span class="jive-icon-big '+soy.$$escapeHtml(opt_data.iconClass)+"\" role='img'></span>":"",'<a href="',soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.action.url)),'">',soy.$$escapeHtml(opt_data.subject),'</a></div><div class="j-byline font-color-meta">');var param16=new soy.StringBuilder;
jive.integration.tiles.viewstyle.userLink(opt_data.originalAuthor,param16);var param20=new soy.StringBuilder;jive.integration.tiles.viewstyle.userLink(opt_data.lastModifiedBy,param20);jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("doc.created_by.modified_by_uc"),arg0:param16.toString(),arg1:soy.$$escapeHtml(opt_data.creationDate?_jive_moment(parseFloat(opt_data.creationDate)?parseFloat(opt_data.creationDate):opt_data.creationDate).add(_jive_timezoneoffset*60*60*1E3).lang(_jive_locale.toLowerCase().replace("_",
"-")).format("lll"):""),arg2:param20.toString(),arg3:soy.$$escapeHtml(opt_data.modificationDate?_jive_moment(parseFloat(opt_data.modificationDate)?parseFloat(opt_data.modificationDate):opt_data.modificationDate).add(_jive_timezoneoffset*60*60*1E3).lang(_jive_locale.toLowerCase().replace("_","-")).format("lll"):""),noAutoEscape:true},output);output.append("</div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.header");jive.integration.tiles.viewstyle.header=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(!opt_data.suppressOutcomes)jive.integration.tiles.viewstyle.outcomes(opt_data,output);if(!opt_data.suppressTitle)jive.integration.tiles.viewstyle.titleAndAuthor(opt_data,output);return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.contentBody");jive.integration.tiles.viewstyle.contentBody=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-content-body">',soy.$$filterNoAutoescape(opt_data.body),"</div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.acclaim.renderIcon");
jive.eae.acclaim.renderIcon=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.acclaimType=="like"?opt_data.iconType=="small"?'<span class="jive-icon-glyph icon-thumbs-up '+(opt_data.iconClass?soy.$$escapeHtml(opt_data.iconClass):"")+'"></span>':opt_data.iconType=="medium"?'<span class="jive-icon-glyph icon-thumbs-up2"><span class="icon-variant-unlike"></span><span class="icon-variant-disabled"></span></span>':opt_data.iconType=="news"?'<span class="jive-icon-glyph icon-thumbs-up2"></span>':
"":"");return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.acclaim.getAcclaimTextByType");
jive.eae.acclaim.getAcclaimTextByType=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;switch(opt_data.acclaimType){case "same_question":output.append(opt_data.applied?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("acclaim.same_question.uncredit"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("acclaim.same_question.credit"),[])));break;default:output.append(opt_data.applied?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("acclaim.liking.unlike"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("acclaim.liking.like"),
[])))}return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.acclaim.expressLike");
jive.eae.acclaim.expressLike=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;var likeBody__soy3=new soy.StringBuilder;jive.eae.acclaim.renderIcon(opt_data,likeBody__soy3);if(!opt_data.suppressLikeText)jive.eae.acclaim.getAcclaimTextByType(opt_data,likeBody__soy3);likeBody__soy3=likeBody__soy3.toString();if(!opt_data.disabled){output.append("<a ",opt_data.id?'id="'+soy.$$escapeHtml(opt_data.id)+'"':"",'class="',opt_data.classes?soy.$$escapeHtml(opt_data.classes):""," ",soy.$$escapeHtml(opt_data.type),
'" data-command="',soy.$$escapeHtml(opt_data.type),'" data-object-id="',soy.$$escapeHtml(opt_data.objectId),'" data-object-type="',soy.$$escapeHtml(opt_data.objectType),'" data-acclaim-type="',opt_data.acclaimType?soy.$$escapeHtml(opt_data.acclaimType):"like",'"',opt_data.followObjectType&&opt_data.followObjectId?'data-follow-object-type="'+soy.$$escapeHtml(opt_data.followObjectType)+'" data-follow-object-id="'+soy.$$escapeHtml(opt_data.followObjectId)+'"':"",'title="');jive.eae.acclaim.getAcclaimTextByType(opt_data,
output);output.append('" aria-label="');jive.eae.acclaim.getAcclaimTextByType(opt_data,output);output.append('" href="#">',soy.$$filterNoAutoescape(likeBody__soy3),"</a>")}else output.append(soy.$$filterNoAutoescape(likeBody__soy3));return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.acclaim.acclaimContainerMedium");
jive.eae.acclaim.acclaimContainerMedium=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<span id="acclaim-container-',soy.$$escapeHtml(opt_data.objectType),"-",soy.$$escapeHtml(opt_data.objectId),'" data-type="medium" data-can-apply="',soy.$$escapeHtml(opt_data.canApply),'" data-acclaim-type="',soy.$$escapeHtml(opt_data.acclaimType),'" data-acclaim-count="',soy.$$escapeHtml(opt_data.acclaimCount),'" class="js-acclaim-container acclaim-container acclaim-like-container',!opt_data.canApply?
" j-disabled":"",'"><span>');if(opt_data.canApply)jive.eae.acclaim.expressLike(soy.$$augmentMap(opt_data,{disabled:!opt_data.canApply,iconType:"medium",type:opt_data.applied?"uncredit":"credit",classes:"jive-acclaim-likelink j-social-action",suppressLikeText:false}),output);else{output.append('<span class="j-social-action">');jive.eae.acclaim.renderIcon({acclaimType:opt_data.acclaimType,iconType:"medium",iconClass:opt_data.iconClass},output);jive.eae.acclaim.getAcclaimTextByType(opt_data,output);
output.append("</span>")}var param45=new soy.StringBuilder;jive.shared.soy.getCountTextByType({count:opt_data.acclaimCount,type:opt_data.acclaimType=="same_question"?"same_question":"showlikescount"},param45);jive.eae.acclaim.count(soy.$$augmentMap(opt_data,{command:"showAcclaim",count:opt_data.acclaimCount,acclaimType:opt_data.acclaimType,classes:"j-people-count j-rc3 jive-acclaim-likedlink",accessibilityLinkLabel:param45.toString()}),output);output.append("</span></span>");return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.acclaim.activityAcclaimLinkContainer");
jive.eae.acclaim.activityAcclaimLinkContainer=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.showIcon)jive.eae.acclaim.renderIcon({acclaimType:opt_data.acclaimType,iconType:"small",showGlyph:opt_data.showGlyph,iconClass:opt_data.iconClass},output);output.append('<span id="acclaim-container-',soy.$$escapeHtml(opt_data.objectType),"-",soy.$$escapeHtml(opt_data.objectId),'" class="acclaim-container"><span id="jive-acclaim-like-container-',soy.$$escapeHtml(opt_data.objectType),
"-",soy.$$escapeHtml(opt_data.objectId),'" data-acclaim-count="',soy.$$escapeHtml(opt_data.acclaimCount),'" data-can-apply="',soy.$$escapeHtml(opt_data.canApply),'" data-type="',opt_data.type?soy.$$escapeHtml(opt_data.type):"mini",'" data-show-icon="',soy.$$escapeHtml(opt_data.showIcon),'"',opt_data.followObjectType&&opt_data.followObjectId?'data-follow-object-type="'+soy.$$escapeHtml(opt_data.followObjectType)+'" data-follow-object-id="'+soy.$$escapeHtml(opt_data.followObjectId)+'"':"",'class="js-acclaim-container acclaim-like-container',
opt_data.acclaimType!="same_question"?"":"",'"><span class="j-social-action">');jive.eae.acclaim.expressLike(soy.$$augmentMap(opt_data,{disabled:!opt_data.canApply,iconType:"none",type:opt_data.applied?"uncredit":"credit",applied:opt_data.applied,classes:"jive-acclaim-likelink",acclaimType:opt_data.acclaimType,followObjectType:opt_data.followObjectType,followObjectId:opt_data.followObjectId,suppressLikeText:false}),output);output.append(" ");var param66=new soy.StringBuilder;jive.shared.soy.getCountTextByType({count:opt_data.acclaimCount,
type:opt_data.acclaimType=="same_question"?"same_question":"showlikescount"},param66);jive.eae.acclaim.count(soy.$$augmentMap(opt_data,{command:"showAcclaim",count:opt_data.acclaimCount,acclaimType:opt_data.acclaimType,classes:"jive-acclaim-likedlink",text:"("+soy.$$escapeHtml(opt_data.acclaimCount)+")",accessibilityLinkLabel:param66.toString()}),output);output.append("</span></span></span>");return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.acclaim.activityAcclaimLinkContainerNews");
jive.eae.acclaim.activityAcclaimLinkContainerNews=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<span class="font-color-meta-light j-brick-meta"><span id="acclaim-container-',soy.$$escapeHtml(opt_data.objectType),"-",soy.$$escapeHtml(opt_data.objectId),'" class="acclaim-container"><span id="jive-acclaim-like-container-',soy.$$escapeHtml(opt_data.objectType),"-",soy.$$escapeHtml(opt_data.objectId),'" data-acclaim-count="',soy.$$escapeHtml(opt_data.acclaimCount),
'" data-can-apply="',soy.$$escapeHtml(opt_data.canApply),'" data-type="',opt_data.type?soy.$$escapeHtml(opt_data.type):"mini",'"',opt_data.followObjectType&&opt_data.followObjectId?'data-follow-object-type="'+soy.$$escapeHtml(opt_data.followObjectType)+'" data-follow-object-id="'+soy.$$escapeHtml(opt_data.followObjectId)+'"':"",'class="js-acclaim-container acclaim-like-container',opt_data.acclaimType!="same_question"?"":"",'">');jive.eae.acclaim.expressLike(soy.$$augmentMap(opt_data,{disabled:!opt_data.canApply,
iconType:"news",type:opt_data.applied?"uncredit":"credit",applied:opt_data.applied,classes:"jive-acclaim-likelink",acclaimType:opt_data.acclaimType,followObjectType:opt_data.followObjectType,followObjectId:opt_data.followObjectId,suppressLikeText:true}),output);output.append(" ");var param54=new soy.StringBuilder;jive.shared.soy.getCountTextByType({count:opt_data.acclaimCount,type:opt_data.acclaimType=="same_question"?"same_question":"showlikescount"},param54);jive.eae.acclaim.count(soy.$$augmentMap(opt_data,
{command:"showAcclaim",count:opt_data.acclaimCount,acclaimType:opt_data.acclaimType,classes:"jive-acclaim-likedlink lnk",text:false,accessibilityLinkLabel:param54.toString()}),output);output.append("</span></span></span>");return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.acclaim.acclaimControl");
jive.eae.acclaim.acclaimControl=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;switch(opt_data.type){case "medium":jive.eae.acclaim.acclaimContainerMedium(opt_data,output);break;case "mini":jive.eae.acclaim.activityAcclaimLinkContainer(opt_data,output);break;case "news":jive.eae.acclaim.activityAcclaimLinkContainerNews(opt_data,output);break;case "small":output.append('<span class="js-liking-control j-liking-control">');jive.eae.acclaim.activityAcclaimLinkContainer(opt_data,output);
output.append("</span>");break}return opt_sb?"":output.toString()};
;
define("apps/core_acclaim/models/core_acclaim_source",["apps/shared/models/rest_service","jive/dispatcher"],function(a,b){return jive.oo.Class.extend(function(d,c){jive.conc.observable(this);c.resourceType="acclaim";c.pluralizedResourceType=c.resourceType;this.getCredits=function(f,h,e){var g=this.RESOURCE_ENDPOINT+"/"+f+"/"+h+"/scoredisplay";return this.commonAjaxRequest(new jive.conc.Promise(),"POST",{url:g,data:{ratingType:e}})};this.getCreditData=function(f,h,e){var g=this.RESOURCE_ENDPOINT+"/"+f+"/"+h;return this.commonAjaxRequest(new jive.conc.Promise(),"GET",{url:g,data:{ratingType:e}})};this.setCredited=function(j,f,h,g){var e,i,m=1,n=new jive.conc.Promise();if(j){i={ratingType:g,voteValue:m};var l=$j.deparam.querystring().fromQ;if(l){i.fromQuest=l}else{if(jive.Onboarding&&jive.Onboarding.Controller&&g=="like"){var k=jive.Onboarding.Controller.getActiveQuestAndStep();if(k.activeQuestID=="StayInTouchQuest"&&k.activeQuestStep==1){i.fromQuest=k.activeQuestID}}}if(i.fromQuest){n.addCallback(function(){jive.localexchange.emit("trial.like.created");b.dispatch("trial.updatePercentComplete")})}e="/"+this.resourceType+"/"+f+"/"+h+"/addvote"}else{e="/"+this.resourceType+"/"+f+"/"+h+"/removevote";i={ratingType:g}}$j.post(jive.rest.url(e),i,function(){n.emitSuccess()}).fail(function(p,o,q){n.emitError(p.responseJSON.error)});return n}})});
;
define("apps/core_acclaim/core_acclaim",["jive/dispatcher","apps/core_acclaim/models/core_acclaim_source","apps/shared/controllers/localexchange","soy!jive.eae.acclaim.acclaimControl"],function(b,d,a,c){return jive.oo.Class.extend(function(f){f.acclaimSource=new d();var e={};a.addListener("discussions.correct_answer.marked",function(g){$j("#same-question-acclaim-control-"+g.threadId).hide()});a.addListener("discussions.correct_answer.unmarked",function(g){$j("#same-question-acclaim-control-"+g.threadId).show()});b.listen(["credit","uncredit"],function(n,k,m){var i=n.objectType,h=n.objectId,g=n.acclaimType;var j=i+"_"+h+"_"+g;if(e[j]){console.log("duplicate credit request, ignoring",n,k,m);return}else{e[j]=true}var l=k==="credit";f.acclaimSource.setCredited(l,i,h,g).addCallback(function(){jive.switchboard.emit("acclaim.recorded."+g,l,i,h);f.updateUI($j(m),l,i,h,g);if(g==="same_question"){jive.switchboard.emit("follows.updateStreamAssociations",n,l)}}).addErrback(function(o){$j("<p>"+o.message+"</p>").message({style:"error"})}).always(function(){delete e[j]})});f.updateUI=function(n,j,g,l,h){var o=n.closest(".js-acclaim-container"),i,k=o.data("acclaimCount"),p={canApply:true,objectId:l,objectType:g,type:o.data("type"),showIcon:o.data("showIcon"),applied:j,acclaimType:h,followObjectType:o.data("followObjectType"),followObjectId:o.data("followObjectId")};k+=j?1:-1;k=k<0?0:k;p.acclaimCount=k;switch(p.type){case"mini":i=n.closest(".js-liking-control").html(c(p));break;case"news":i=n.closest(".js-liking-control").html(c(p));break;case"medium":i=n.closest(".js-acclaim-container").replaceWith(c(p));break;case"small":i=$j(c($j.extend({showGlyph:true},p)));var m=o.closest(".js-liking-control");if(m.length>0){m.replaceWith(i)}else{o.replaceWith(i)}break;default:throw"Unknown widget type"}if(i){i.find("a.jive-acclaim-likelink").focus()}}})});
;
goog.provide("jive.integration.tiles.viewstyle.socialActions");
jive.integration.tiles.viewstyle.socialActions=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-meta-actions font-color-meta">');if(opt_data.shareable){jive.soy.share.control({objectId:opt_data.id,objectType:opt_data.type,type:"text"},output);output.append(' <span class="j-bullet">&#8226;</span> ')}if(opt_data.commentsAllowed){output.append('<span id="jive-comments-count" class="j-comment-count">');jive.integration.tiles.viewstyle.commentControl({commentCount:opt_data.commentCount?
opt_data.commentCount:0,url:opt_data.action.url,type:"mini"},output);output.append('</span> <span class="j-bullet">&#8226;</span> ')}if(opt_data.likeInfo.likeable){output.append('<span class="js-liking-control j-liking-control">');jive.eae.acclaim.acclaimControl({canApply:opt_data.likeInfo.canLike,applied:opt_data.likeInfo.liked,acclaimCount:opt_data.likeInfo.likeCount,acclaimType:"like",objectId:opt_data.id,objectType:opt_data.type,showIcon:false,type:"mini"},output);output.append("</span>")}output.append("</div>");
return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.content");
jive.integration.tiles.viewstyle.content=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.integration.tiles.view.header(opt_data,output);output.append('<section class="j-tile-body j-tile-content">');if(opt_data.content&&typeof opt_data.content!="string"){jive.integration.tiles.viewstyle.header(soy.$$augmentMap(opt_data.content,{suppressTitle:opt_data.suppressTitle,suppressOutcomes:opt_data.suppressOutcomes}),output);jive.integration.tiles.viewstyle.contentBody(opt_data.content,output);
if(!opt_data.suppressSocial)jive.integration.tiles.viewstyle.socialActions(opt_data.content,output)}else output.append('<p class="noContent">',typeof opt_data.content=="string"?soy.$$escapeHtml(opt_data.content):"","</p>");output.append("</section>");if(opt_data.action)jive.integration.tiles.view.footer(opt_data.action,output);return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.contentIcon");
jive.integration.tiles.viewstyle.contentIcon=function(opt_data,opt_sb){opt_data=opt_data||{};var output=opt_sb||new soy.StringBuilder;output.append(opt_data.jiveIconClasses?'<span class="'+soy.$$escapeHtml(opt_data.jiveIconClasses)+'"></span>':(typeof opt_data.icon=="string"?'<img src="'+soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.icon))+'" class="jive-ext-icon-'+soy.$$escapeHtml(opt_data.iconClass)+' icn jive-avatar" alt="">':opt_data.iconUrl?'<img src="'+soy.$$escapeHtml(opt_data.iconUrl)+
'" class="icn '+(opt_data.externalIconClass?soy.$$escapeHtml(opt_data.externalIconClass):"")+'" alt="">':'<img src="'+soy.$$escapeHtml(jive.soy.func.resourceUrl(window._jive_base_url,"/9.0.5.998b920/","//files1.element14.com/community","/images/transparent.png"))+'" class="jive-ext-icon-'+soy.$$escapeHtml(opt_data.iconClass)+' icn" alt="" style="background-image: url('+soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.icon.backgroundUrl))+"); background-position: "+soy.$$escapeHtml(opt_data.icon.backgroundOffset)+
';">')+(opt_data.userIsPartner?'<span class="jive-icon-med jive-icon-partner" role="img"></span>':""));return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.icon");
jive.integration.tiles.viewstyle.icon=function(opt_data,opt_sb){opt_data=opt_data||{};var output=opt_sb||new soy.StringBuilder;output.append(opt_data.jiveIconClasses?'<span class="'+soy.$$escapeHtml(opt_data.jiveIconClasses)+'"></span>':(typeof opt_data.icon=="string"?'<img src="'+soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.icon))+'" class="jive-ext-icon-'+soy.$$escapeHtml(opt_data.iconClass)+' icn" alt="">':'<img src="'+soy.$$escapeHtml(jive.soy.func.resourceUrl(window._jive_base_url,
"/9.0.5.998b920/","//files1.element14.com/community","/images/transparent.png"))+'" class="jive-ext-icon-'+soy.$$escapeHtml(opt_data.iconClass)+' icn" alt="" style="background-image: url('+soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.icon.backgroundUrl))+"); background-position: "+soy.$$escapeHtml(opt_data.icon.backgroundOffset)+';">')+(opt_data.userIsPartner?'<span class="jive-icon-med jive-icon-partner"></span>':""));return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.common.activityContainer");
jive.eae.common.activityContainer=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.location!="subActivity")if(opt_data.activityContainer.container.type&&opt_data.activityContainer.container.type!=-2)if(opt_data.activityContainer.container.type==2020){var param11=new soy.StringBuilder;jive.shared.displayutil.userDisplayNameLink(opt_data.activityContainer.originalAuthor,param11);jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("main.in_user_container.label"),arg0:param11.toString(),
arg1:String(opt_data.activityContainer.jiveObject.contentTypeFeatureName).toLowerCase(),noAutoEscape:true},output)}else{var param19=new soy.StringBuilder;jive.shared.displayutil.containerDisplayNameLink({container:opt_data.activityContainer.container},param19);jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("eae.container.in"),arg0:param19.toString(),noAutoEscape:true},output)}return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.tileActivity.renderOnBehalfOModified");
jive.eae.tileActivity.renderOnBehalfOModified=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tse.modified.by"),[])),' <span id="act-title-',soy.$$escapeHtmlAttribute(opt_data.viewBean.domIDPostfix),'" class="font-color-meta-light" aria-role="heading">');if(opt_data.viewBean.modifierName||opt_data.viewBean.modifierEmail){var param15=new soy.StringBuilder;if(opt_data.viewBean.modifierUser)jive.shared.displayutil.userDisplayNameLink(opt_data.viewBean.modifierUser,
param15);else if(opt_data.viewBean.modifierName&&opt_data.viewBean.modifierEmail)param15.append('<a href="mailto:',soy.$$escapeHtmlAttribute(opt_data.viewBean.attributionEmail),'" class="jive-username-span jive-username-link"> ',soy.$$escapeHtml(opt_data.viewBean.modifierName),"  </a>");else if(opt_data.viewBean.modifierEmail)param15.append('<a href="mailto:',soy.$$escapeHtmlAttribute(opt_data.viewBean.attributionEmail),'" class="jive-username-span jive-username-link"> ',soy.$$escapeHtml(opt_data.viewBean.modifierEmail),
"  </a>");else param15.append('<span class="jive-username-span jive-username-link"> ',soy.$$escapeHtml(opt_data.viewBean.modifierName),"  </span>");jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("tse.XonbehalfofY"),arg0:'<strong class="font-color-normal">'+soy.$$escapeHtml(opt_data.viewBean.tile.serviceName?opt_data.viewBean.tile.serviceName:opt_data.viewBean.tile.displayName)+"</strong>",arg1:param15.toString(),noAutoEscape:"true"},output)}else output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tse.Xposted"),
[opt_data.viewBean.tile.serviceName?opt_data.viewBean.tile.serviceName:opt_data.viewBean.tile.displayName])));output.append(' <span class="font-color-meta-light">',opt_data.viewBean.modificationTime?soy.$$escapeHtml(opt_data.viewBean.modificationTime):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.less_than_a_minute_ago"),[])),"</span></span>");return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.tileActivity.extModified");
jive.eae.tileActivity.extModified=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.viewBean.modifierName||opt_data.viewBean.modifierEmail)if(opt_data.noCell)jive.eae.tileActivity.renderOnBehalfOModified(opt_data,output);else{output.append('<div class="j-act-node j-mod font-color-meta-light j-js-collapsed"><span class="jive-icon-sml jive-glyph-edit actglyph"></span>');jive.eae.tileActivity.renderOnBehalfOModified(opt_data,output);output.append("</div>")}return opt_sb?
"":output.toString()};
;
goog.provide("jive.eae.tileActivity.parentPreviewLinks");
jive.eae.tileActivity.parentPreviewLinks=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<span class="font-color-meta-light paren">(</span><a href=\'#\' class="j-js-show-full-content j-act-preview font-color-meta" data-extVisible="false" data-objectID="',soy.$$escapeHtmlAttribute(opt_data.activityContainer.jiveObject.id),'" data-objectType="',soy.$$escapeHtmlAttribute(opt_data.activityContainer.jiveObject.objectType),'" ',opt_data.activityContainer.jiveObject.typePoll?
'data-containerID="'+soy.$$escapeHtmlAttribute(opt_data.activityContainer.container.id)+'" data-containerType="'+soy.$$escapeHtmlAttribute(opt_data.activityContainer.container.type)+'" ':"",' aria-hidden="false" ',opt_data.activityContainer.jiveObject.typeTask||opt_data.activityContainer.jiveObject.typeExternalActivity?'title="'+soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("global.show_details"),[]))+'">':'title="'+soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("eae.menu.show.full.link.title"),
[]))+'">','<span class="lnk">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("eae.menu.show.full.more"),[])),'</span></a><a href=\'#\' class="j-js-hide-full-content j-act-preview font-color-meta" style="display:none;" aria-hidden="true" ',opt_data.activityContainer.jiveObject.typeTask||opt_data.activityContainer.jiveObject.typeExternalActivity?'title="'+soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("global.show_details"),[]))+'">':'title="'+soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("eae.menu.hide.full"),
[]))+'">','<span class="lnk">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("eae.menu.show.full.less"),[])),'</span></a><span class="font-color-meta-light paren">)</span>');return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.tileActivity.renderOnBehalfOf");
jive.eae.tileActivity.renderOnBehalfOf=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.viewBean.streamTileEntryCreator){var param17=new soy.StringBuilder;if(opt_data.viewBean.jiveUser=="true")jive.shared.displayutil.userDisplayNameLink(opt_data.viewBean.streamTileEntryCreator,param17);else if(opt_data.viewBean.attributionName&&opt_data.viewBean.attributionEmail)param17.append('<a href="mailto:',soy.$$escapeHtmlAttribute(opt_data.viewBean.attributionEmail),'" class="jive-username-span jive-username-link"> ',
soy.$$escapeHtml(opt_data.viewBean.attributionName),"  </a>");else if(opt_data.viewBean.attributionEmail)param17.append('<a href="mailto:',soy.$$escapeHtmlAttribute(opt_data.viewBean.attributionEmail),'" class="jive-username-span jive-username-link"> ',soy.$$escapeHtml(opt_data.viewBean.attributionEmail),"  </a>");else if(opt_data.viewBean.attributionName)param17.append('<strong class="font-color-normal"> ',soy.$$escapeHtml(opt_data.viewBean.attributionName),"  </strong>");else jive.shared.displayutil.userDisplayNameLink(opt_data.viewBean.streamTileEntryCreator,
param17);jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("tse.XpostedonbehalfofY"),arg0:'<strong class="font-color-normal">'+(opt_data.viewBean.tileInstance&&opt_data.viewBean.tileInstance.displayName?soy.$$escapeHtml(opt_data.viewBean.tileInstance.displayName):opt_data.viewBean.tile.serviceName?soy.$$escapeHtml(opt_data.viewBean.tile.serviceName):soy.$$escapeHtml(opt_data.viewBean.tile.displayName))+"</strong>                ",arg1:param17.toString(),noAutoEscape:"true"},output);output.append(" ");
if(opt_data.viewBean.externalGroupName){output.append("<span>");jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("tse.XpostedonbehalfofYin"),arg0:'<strong class="font-color-normal"> '+soy.$$escapeHtml(opt_data.viewBean.externalGroupName)+"  </strong>",noAutoEscape:"true"},output);output.append("</span>")}else if(opt_data.activityContainer)jive.eae.common.activityContainer(opt_data,output)}else output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tse.Xposted"),[opt_data.viewBean.tile.serviceName?
opt_data.viewBean.tile.serviceName:opt_data.viewBean.tile.displayName])));if(opt_data.viewBean.creationTime&&!opt_data.hideTimestamp){output.append('<span class="j-author-act-meta font-color-meta-light"><span class="j-act-time font-color-meta-light">',!opt_data.viewBean.hideJiveObjectURL?'<a href="'+soy.$$filterNoAutoescape(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.viewBean.jiveObjectURL))+'" class="font-color-meta-light">':'<span class="font-color-meta-light">',soy.$$escapeHtml(opt_data.viewBean.creationTime),
!opt_data.viewBean.hideJiveObjectURL?"</a>":"</span>",opt_data.showGoToItem?opt_data.viewBean.externalURL?'<span class="act-tile-go-to-item font-color-meta"> <span class="j-bullet">&#8226;</span> <a href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.viewBean.externalURL))+'" alt="" target="'+(!opt_data.viewBean.relativeUrl?"_blank":"")+'"> '+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tse.gotoitem.link"),[]))+"</a></span>":"":"");if(opt_data.showModified&&(opt_data.viewBean.modifierName||
opt_data.viewBean.modifierEmail)){output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tse.lastModified"),[]))," ");jive.eae.tileActivity.extModified({viewBean:opt_data.viewBean,noCell:true},output)}if(opt_data.activityContainer){output.append('<span class="j-act-preview-control j-act-show-more"> <span class="j-bullet">&#8226;</span> ');jive.eae.tileActivity.parentPreviewLinks(opt_data,output);output.append("</span>")}output.append("</span></span>")}return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.tileActivity.renderUser");
jive.eae.tileActivity.renderUser=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.viewBean.jiveUser=="true")jive.shared.displayutil.userDisplayNameLink(opt_data.viewBean.streamTileEntryCreator,output);else if(opt_data.viewBean.attributionName&&opt_data.viewBean.attributionEmail)output.append('<a href="mailto:',soy.$$escapeHtmlAttribute(opt_data.viewBean.attributionEmail),'" class="jive-username-span jive-username-link"> ',soy.$$escapeHtml(opt_data.viewBean.attributionName),
"  </a>");else if(opt_data.viewBean.attributionEmail)output.append('<a href="mailto:',soy.$$escapeHtmlAttribute(opt_data.viewBean.attributionEmail),'" class="jive-username-span jive-username-link"> ',soy.$$escapeHtml(opt_data.viewBean.attributionEmail),"  </a>");else if(opt_data.viewBean.tileInstance&&opt_data.viewBean.tileInstance.displayName){output.append('<strong class="font-color-normal">');jive.shared.displayutil.userDisplayNameLink(soy.$$augmentMap(opt_data.viewBean.streamTileEntryCreator,
{displayNameOverride:opt_data.viewBean.tileInstance.displayName}),output);output.append("</strong>")}else jive.shared.displayutil.userDisplayNameLink(opt_data.viewBean.streamTileEntryCreator,output);output.append(" ",!opt_data.hideTimestamp?' <span class="j-author-act-meta font-color-meta-light"><span class="font-color-meta-light">'+(opt_data.viewBean.modificationTime?soy.$$escapeHtml(opt_data.viewBean.modificationTime):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.less_than_a_minute_ago"),
[])))+"</span></span>":"");return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.renderUser");
jive.integration.tiles.viewstyle.renderUser=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.integration.tiles.viewstyle.authorLink(soy.$$augmentMap(opt_data.action,{authorUrl:opt_data.authorUsername?soy.$$filterNoAutoescape(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/people/"+encodeURIComponent(opt_data.authorUsername))):"",classes:opt_data.authorID?"jiveTT-hover-user jive-username-link ":"",attrs:opt_data.authorID?'data-userid="'+soy.$$escapeHtml(opt_data.authorID)+
'" ':"",text:opt_data.authorDisplayName,noEscapeText:true}),output);if(opt_data.authorDisplayName){output.append('<span class="contentAuthor ',opt_data.avatar?"showAvatar":"noAvatar",'"><span class="authorInfo">');if(opt_data.avatar){var param50=new soy.StringBuilder;if(opt_data.icon||opt_data.jiveIconClasses)jive.integration.tiles.viewstyle.contentIcon({externalIconClass:opt_data.externalIconClass,icon:soy.$$escapeHtml(opt_data.avatar),iconClass:"48",userIsPartner:opt_data.authorIsPartner},param50);
jive.integration.tiles.viewstyle.authorLink(soy.$$augmentMap(opt_data.action,{authorUrl:opt_data.authorUsername?soy.$$filterNoAutoescape(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/people/"+encodeURIComponent(opt_data.authorUsername))):"",classes:(opt_data.authorID?"jiveTT-hover-user j-avatar ":"")+(opt_data.authorIsPartner?"j-partner ":""),attrs:opt_data.authorID?'data-userid="'+soy.$$escapeHtml(opt_data.authorID)+'" ':"",text:param50.toString(),noEscapeText:true}),output)}output.append("</span></span>")}return opt_sb?
"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.contentListItem");
jive.integration.tiles.viewstyle.contentListItem=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<li class="listItem showIcon ',soy.$$escapeHtml(opt_data.iconSizes!=null?opt_data.iconSizes:"")," ",opt_data.index%2==0?"odd":"even",'">');if(opt_data.action){var param25=new soy.StringBuilder;if(opt_data.icon||opt_data.jiveIconClasses||opt_data.iconUrl)jive.integration.tiles.viewstyle.contentIcon(opt_data,param25);param25.append(soy.$$escapeHtml(opt_data.text));jive.integration.tiles.view.actionLink(soy.$$augmentMap(opt_data.action,
{classes:"linkText "+(opt_data.description?"showDescription ":""),attrs:opt_data.userID?'data-userid="'+soy.$$escapeHtml(opt_data.userID)+'" ':"",text:param25.toString(),noEscapeText:true}),output)}else{if(opt_data.icon||opt_data.jiveIconClasses)jive.integration.tiles.viewstyle.icon(opt_data,output);output.append(soy.$$escapeHtml(opt_data.text))}output.append('<div class="linkDescription font-color-meta j-timestamp">');if(opt_data.viewBean&&!opt_data.viewBean.hideOnBehalfOf)jive.eae.tileActivity.renderOnBehalfOf({viewBean:opt_data.viewBean,
showGoToItem:false,showModified:false,hideTimestamp:true},output);else if(opt_data.viewBean)jive.eae.tileActivity.renderUser(soy.$$augmentMap(opt_data,{viewBean:opt_data.viewBean,hideTimestamp:true}),output);else jive.integration.tiles.viewstyle.renderUser(opt_data,output);output.append("  ",soy.$$escapeHtml(opt_data.relativeTimestamp),"</div></li>",opt_data.showDescription&&opt_data.description?'<p class="linkDescription">'+soy.$$escapeHtml(opt_data.description)+"</p>":"",opt_data.showDescription&&
opt_data.moreDescription?'<p class="linkDescription">'+soy.$$escapeHtml(opt_data.moreDescription)+"</p>":"");return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.contentSectionClasses");jive.integration.tiles.viewstyle.contentSectionClasses=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("j-tile-body j-tile-list-narrow clearfix");return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.contentUlClasses");jive.integration.tiles.viewstyle.contentUlClasses=function(opt_data,opt_sb){opt_data=opt_data||{};var output=opt_sb||new soy.StringBuilder;output.append(opt_data.config&&(opt_data.config.listStyle&&opt_data.config.listStyle=="peopleList"||opt_data.config.style&&opt_data.config.style=="peopleList")?"peopleList j-icon-list":"contentList j-icon-list");return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.defaults.emptyDefault");
jive.integration.tiles.defaults.emptyDefault=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="noContent  ',soy.$$escapeHtmlAttribute(opt_data.iconClassOne)," ",soy.$$escapeHtmlAttribute(opt_data.iconClassTwo),' clearfix"><img src="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/images/empty-tile-1col-oneType.png"))),'" alt="" class="emptyListIcon"><p>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(opt_data.i18nKeyOne),
[])),"</p><p>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(opt_data.i18nKeyTwo),[])),"</p></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.defaults.emptyDefaultWide");
jive.integration.tiles.defaults.emptyDefaultWide=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="noContent ',soy.$$escapeHtmlAttribute(opt_data.iconClassOne),"  ",soy.$$escapeHtmlAttribute(opt_data.iconClassTwo),' clearfix"><img src="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/images/empty-tile-1col-oneType.png"))),'" alt="" class="emptyListIcon"><p>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(opt_data.i18nKeyOne),
[])),"</p><p>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(opt_data.i18nKeyTwo),[])),"</p></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.defaults.frequentlyViewed");
jive.integration.tiles.defaults.frequentlyViewed=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.integration.tiles.defaults.emptyDefault({iconClassOne:"showIconEmpty",iconClassTwo:"",i18nKeyOne:soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.tile.frequently.viewed.empty.one"),[])),i18nKeyTwo:soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.tile.frequently.viewed.empty.two"),[]))},output);return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.defaults.frequentlyViewedWide");
jive.integration.tiles.defaults.frequentlyViewedWide=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.integration.tiles.defaults.emptyDefaultWide({iconClassOne:"showIconEmpty",iconClassTwo:"",i18nKeyOne:soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.tile.frequently.viewed.empty.one"),[])),i18nKeyTwo:soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.tile.frequently.viewed.empty.two"),[]))},output);return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.defaults.noContent");
jive.integration.tiles.defaults.noContent=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data["default"]&&opt_data["default"].defaultTemplate)jive.shared.soy.render({templateName:opt_data["default"].defaultTemplate,data:function(){var map={};var pairs=[];for(var i=0;i<pairs.length;i+=1)map[pairs[i][0]]=pairs[i][1];return map}(),failGracefully:true},output);else if(opt_data["default"]&&opt_data["default"].defaultMessage)output.append('<div class="noContent clearfix">',soy.$$escapeHtml(opt_data["default"].defaultMessage),
"</div>");else if(typeof opt_data.contents=="string")output.append('<div class="noContent clearfix">',soy.$$escapeHtml(opt_data.contents),"</div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.defaults.recentBlog");
jive.integration.tiles.defaults.recentBlog=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.integration.tiles.defaults.emptyDefault({iconClassOne:"showIconEmpty",iconClassTwo:"",i18nKeyOne:"",i18nKeyOne:soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.tile.recent.blog.empty.one"),[])),i18nKeyTwo:soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.tile.recent.blog.empty.two"),[]))},output);return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.defaults.recentBlogWide");
jive.integration.tiles.defaults.recentBlogWide=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.integration.tiles.defaults.emptyDefaultWide({iconClassOne:"showIconEmpty",iconClassTwo:"",i18nKeyOne:soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.tile.recent.blog.empty.one"),[])),i18nKeyTwo:soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.tile.recent.blog.empty.two"),[]))},output);return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.defaults.recentlyViewed");
jive.integration.tiles.defaults.recentlyViewed=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.integration.tiles.defaults.emptyDefault({iconClassOne:"showIconEmpty",iconClassTwo:"",i18nKeyOne:soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.tile.recently.viewed.empty.one"),[])),i18nKeyTwo:soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.tile.recently.viewed.empty.two"),[]))},output);return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.defaults.recentlyViewedWide");
jive.integration.tiles.defaults.recentlyViewedWide=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.integration.tiles.defaults.emptyDefaultWide({iconClassOne:"showIconEmpty",iconClassTwo:"",i18nKeyOne:soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.tile.recently.viewed.empty.one"),[])),i18nKeyTwo:soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.tile.recently.viewed.empty.two"),[]))},output);return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.defaults.trendingContent");
jive.integration.tiles.defaults.trendingContent=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.integration.tiles.defaults.emptyDefault({iconClassOne:"showIconEmpty",iconClassTwo:"",i18nKeyOne:"",i18nKeyOne:soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.tile.trending.content.empty.one"),[])),i18nKeyTwo:soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.tile.trending.content.empty.two"),[]))},output);return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.defaults.trendingContentWide");
jive.integration.tiles.defaults.trendingContentWide=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.integration.tiles.defaults.emptyDefaultWide({iconClassOne:"showIconEmpty",iconClassTwo:"",i18nKeyOne:soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.tile.trending.content.empty.one"),[])),i18nKeyTwo:soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.tile.trending.content.empty.two"),[]))},output);return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.defaults.trendingPeople");
jive.integration.tiles.defaults.trendingPeople=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.integration.tiles.defaults.emptyDefault({iconClassOne:"showIconEmpty",iconClassTwo:"",i18nKeyOne:"",i18nKeyOne:soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.tile.trending.people.empty.one"),[])),i18nKeyTwo:soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.tile.trending.people.empty.two"),[]))},output);return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.contentlistnarrow");
jive.integration.tiles.viewstyle.contentlistnarrow=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.integration.tiles.view.header(opt_data,output);output.append('<section class="');jive.integration.tiles.viewstyle.contentSectionClasses(opt_data,output);output.append('">');if(opt_data.contents&&typeof opt_data.contents!="string"&&opt_data.contents.length!=0){output.append('<ul class="contentList j-icon-list">');var itemList13=opt_data.contents;var itemListLen13=itemList13.length;
for(var itemIndex13=0;itemIndex13<itemListLen13;itemIndex13++){var itemData13=itemList13[itemIndex13];jive.integration.tiles.viewstyle.contentListItem(soy.$$augmentMap(itemData13,{iconClass:itemData13.action&&itemData13.action.iconSize?soy.$$escapeHtml(itemData13.action.iconSize):"16",index:itemIndex13}),output)}output.append("</ul>")}else jive.integration.tiles.defaults.noContent(opt_data,output);output.append("</section>");if(opt_data.action)jive.integration.tiles.view.footer(opt_data.action,output);
return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.contentlistwide");
jive.integration.tiles.viewstyle.contentlistwide=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.integration.tiles.view.header(opt_data,output);output.append('<section class="');jive.integration.tiles.viewstyle.contentSectionClasses(opt_data,output);output.append('">');if(opt_data.contents&&typeof opt_data.contents!="string"&&opt_data.contents.length!=0){output.append('<ul class="contentList">');var itemList13=opt_data.contents;var itemListLen13=itemList13.length;for(var itemIndex13=
0;itemIndex13<itemListLen13;itemIndex13++){var itemData13=itemList13[itemIndex13];jive.integration.tiles.viewstyle.contentListItem(soy.$$augmentMap(itemData13,{iconClass:itemData13.action&&itemData13.action.iconSize?soy.$$escapeHtml(itemData13.action.iconSize):"16",iconSizes:"ic24",index:itemIndex13,externalIconClass:"jive-icon-big"}),output)}output.append("</ul>")}else jive.integration.tiles.defaults.noContent(opt_data,output);output.append("</section>");if(opt_data.action)jive.integration.tiles.view.footer(opt_data.action,
output);return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.customViewError");
jive.integration.tiles.viewstyle.customViewError=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div id="jive-customview-modal-error" class="jive-modal jive-modal-wide style="display: none;"><header><h2>',jive.i18n.i18nText(jive.i18n.getMsg("global.error"),[]),'</h2></header><a href="#" class="j-modal-close-top close">',jive.i18n.i18nText(jive.i18n.getMsg("global.close"),[]),'<span class="j-close-icon j-ui-elem" role="img"></span></a><section class="jive-modal-content clearfix"><textarea readonly rows="10" cols="80">',opt_data.message,
"</textarea></section></div>");return opt_sb?"":output.toString()};
;
define("apps/tile/integrations/custom_view",["jquery","underscore","documentReady"],function(b,a){return jive.oo.Class.extend(function(d){d.init=function(e){require(["syntheticAppContainer"],function(f){var i=b("#"+e.domElement);var g=i.closest(".js-tile").data("tile-view");if(g){e={domElement:i,url:g.definition.view,objectType:"tileInstance",objectID:g.id,relatedTiles:[],context:g.data,container:{type:jive.global.containerType,id:jive.global.containerID},instanceId:jive.global.instanceID,userId:_jive_current_user.ID,errorCallback:function(j){c(e.domElement,j)}};if(g.definition.action){e.actionHandler=function(j,l){var k=b.Deferred();require(["apps/tile/embedded_view","soy!jive.integration.tiles.view.embeddedExperience"],function(o,p){var r=b(p());var q="dummyContext_"+String(Math.random()).substring(2);var n={left:(i.position().left+l.left)+"px",top:(i.position().top+l.top)+"px",width:l.width+"px",height:l.height+"px",position:"absolute"};var m=b("<div/>").attr("id",q).css(n).insertAfter(i);r.popover({context:m,position:"left",align:"middle",beforeClose:function(){r.find("iframe").prop("src","about:blank");b("#"+q).remove()},onClose:function(){f.rejectAppActionDataPromise()}});o.render({url:g.definition.action,objectType:"tileInstance",objectID:g.id,domElement:r.find(".js-embed"),context:j,relatedTiles:[],container:{type:jive.global.containerType,id:jive.global.containerID},instanceId:jive.global.instanceID,userId:_jive_current_user.ID}).then(function(s){k.resolve(s);r.trigger("close")},function(){k.reject();r.trigger("close")})});return k}}f.renderEmbeddedView(e)}else{var h=i.closest(".js-tile").data("tile")}})};function c(f,e){b(".js-error",f).show();if(e&&e.message){b(".js-error a",f).click(function(h){var g=b(jive.integration.tiles.viewstyle.customViewError(e));g.lightbox_me({closeSelector:".close",destroyOnClose:true,centered:true})})}}})});
;
goog.provide("jive.integration.tiles.viewstyle.custom_view");
jive.integration.tiles.viewstyle.custom_view=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.title)jive.integration.tiles.view.header(opt_data,output);if(!opt_data.editing){output.append('<section class="j-tile-body"><div id="j-app-tile-parent-',soy.$$escapeHtmlAttribute(opt_data.tileInstanceId),'"><div class="js-error" style="display: none;"><div>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tile.customView.error.text"),[])),'</div><a href="#">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.show_details"),
[])),'</a></div><div class="j-custom-view-tile-placeholder">&nbsp;</div></div></section>');if(opt_data.action)jive.integration.tiles.view.footer(opt_data.action,output)}else output.append('<section class="j-tile-body"><div class="noContent clearfix">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tile.customView.edit.preview.text"),[])),"</div></section>");output.append("<script>require(['apps/tile/integrations/custom_view', 'documentReady'], function(TileAppRenderer) {new TileAppRenderer({domElement: \"j-app-tile-parent-",
soy.$$escapeJsString(opt_data.tileInstanceId),'"});});<\/script>');return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.galleryImage");
jive.integration.tiles.viewstyle.galleryImage=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<figure><a href="#" data-action="showGallery" data-disabled="',opt_data.disableFullScreen?"true":"false",'" data-index="',soy.$$escapeHtml(opt_data.index),'" data-caption="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tile.image_gallery.tileName"),[])),'" data-src="',soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.image)),'"><img class="j-slide-image j-gallery js-slide-image " src="',
soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.thumb?opt_data.thumb:opt_data.image)),'"',opt_data.thumb?'data-thumb="'+soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.thumb))+'"':"",'alt="" data-src="',soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.image)),'" ><\!-- not yet supported in all browsers, see https://developer.mozilla.org/en-US/docs/Link_prefetching_FAQ --\><meta http-equiv="Link" content="<',
soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.image)),'>; rel=prefetch">',opt_data.title&&!opt_data.hideCaptions?"<figcaption><p>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tile.image_gallery.tileName"),[]))+"</p></figcaption>":"","</a></figure>");return opt_sb?"":output.toString()};
;
goog.provide("jive.overlay.imageGallery");
jive.overlay.imageGallery=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="lb-overlay"></div><div class="lb-container lb-gallery"><div class="lb-actions"><a class="lb-close font-color-white" data-action="close" href="#" aria-label="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("global.close"),[])),'" title="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("global.close"),[])),'"><span class="jive-icon-glyph icon-close-med"></span></a></div><nav class="lb-dotnav">');if(opt_data.imageData.length>
1){output.append('<ul class="lb-dots js-dots">');var imageList11=opt_data.imageData;var imageListLen11=imageList11.length;for(var imageIndex11=0;imageIndex11<imageListLen11;imageIndex11++){var imageData11=imageList11[imageIndex11];output.append('<li data-action="goto" data-index="',soy.$$escapeHtmlAttribute(imageIndex11),'"><a href="#">',soy.$$escapeHtml(imageIndex11),"</a></li>")}output.append("</ul>")}output.append("</nav>",opt_data.imageData.length>1?'<a class="lb-pagination lb-previous" href="#" data-action="previous"><span>'+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.previous"),[]))+'</span></a><a class="lb-pagination lb-next" href="#" data-action="next"><span>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.next"),[]))+"</span></a>":"",'<div class="lb"><div class="lb-content gallery j-active clearfix"><div class="js-figures">');var imageList28=opt_data.imageData;var imageListLen28=imageList28.length;for(var imageIndex28=0;imageIndex28<imageListLen28;imageIndex28++){var imageData28=imageList28[imageIndex28];
output.append('<figure><img src="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(imageData28.src)),'" alt="">',imageData28.caption?'<figcaption class="font-color-white">'+soy.$$escapeHtml(imageData28.caption)+"</figcaption>":"","</figure>")}output.append("</div></div></div></div>");return opt_sb?"":output.toString()};
;
define('jquery/jquery.gallery', ['jquery', 'soy!jive.overlay.imageGallery', 'jquery/jquery.imagesloaded'], function($, tmpl) {
    var PADDING = 100;

    function activate(nodes, index) {
        $(nodes).removeClass('j-active').eq(index).addClass('j-active');
    }

    function setMaxDimensions() {
        gallery().find('.js-figures > figure.j-active img').css({
            maxHeight: $(window).height() - PADDING,
            maxWidth : $(window).width()  - PADDING
        });
    }

    function gallery() {
        return $('body > .lb-container .lb-content.gallery');
    }

    function close() {
        $('body > .lb-container').remove();
        $('body').removeClass('lb-active').add(window).off('.gallery');
    }

    function offsetIndex(offset)  {
        return gallery().find('.js-figures > figure.j-active').index() + offset;
    }

    function goto(index) {
        var $figures = gallery().find('.js-figures > figure');

        // normalize index
        index = index > $figures.length - 1 ? 0 : index;
        index = index < 0 ? $figures.length - 1 : index;

        // set the current dot and image, move current image in to place
        activate($('body > .lb-container .js-dots li'), index);
        activate($figures, index);
        setMaxDimensions();
    }

    function handleClick(e) {
        var action = this.getAttribute('data-action');

        if ('close'    == action) { close(); }
        if ('goto'     == action) { goto($(this).data('index')); }
        if ('next'     == action) { goto(offsetIndex(1)); }
        if ('previous' == action) { goto(offsetIndex(-1)); }

        e.preventDefault();
    }

    function handleKey(e) {
        var key = $.ui.keyCode;

        if      (key.ESCAPE == e.which)   { close(); }
        else if (key.LEFT   == e.which)   { goto(offsetIndex(-1)); }
        else if (key.RIGHT  == e.which)   { goto(offsetIndex(1)); }
        else                              { return; }

        e.preventDefault();
    }


    $.gallery = function(imageData, index) {
        $(window).on('resize.gallery', setMaxDimensions);
        $('body').addClass('lb-active')
            .on('keydown.gallery', handleKey)
            .on('click.gallery', '[data-action]', handleClick)
            .append(tmpl({ imageData: imageData }));

        goto(index);
    };


    return $.gallery;
});

;
goog.provide("jive.integration.tiles.viewstyle.gallery");
jive.integration.tiles.viewstyle.gallery=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.integration.tiles.view.header({title:jive.i18n.i18nText(jive.i18n.getMsg("tile.image_gallery.tileName"),[]),tileInstanceId:opt_data.tileInstanceId},output);output.append('<section id="tile-image-gallery-',soy.$$escapeHtmlAttribute(opt_data.tileInstanceId),'" class="j-tile-body  j-tile-image-gallery j-tile-image-gallery-',soy.$$escapeHtmlAttribute(opt_data.config.size),"  js-tile-image-gallery js-tile-image-gallery-",
soy.$$escapeHtmlAttribute(opt_data.config.size),"  j-slideshow",!opt_data.config.disableFullScreenView?" j-fullscreen-enabled":"",typeof opt_data.contents=="string"||opt_data.contents.length==0?" j-empty-gallery":"",'">');if(typeof opt_data.contents!="string"&&opt_data.contents.length!=0){output.append('<ul class="',!opt_data.config.disableFullScreenView?" js-fullscreen-enabled":"",'">');var imageList27=opt_data.contents;var imageListLen27=imageList27.length;for(var imageIndex27=0;imageIndex27<imageListLen27;imageIndex27++){var imageData27=
imageList27[imageIndex27];output.append('<li class="j-tile-image-gallery-thumb j-slide',imageIndex27==0?" j-selected":"",'">');jive.integration.tiles.viewstyle.galleryImage(soy.$$augmentMap(imageData27,{disableFullScreen:opt_data.config.disableFullScreenView,hideCaptions:opt_data.config.hideCaptions,index:imageIndex27}),output);output.append("</li>")}output.append("</ul>")}else output.append('<p class="noContent">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tile.image_gallery.empty"),[])),
"</p>");output.append("</section>");if(opt_data.action&&opt_data.config.showAdditionalLink)jive.integration.tiles.view.footer(opt_data.action,output);return opt_sb?"":output.toString()};
;
(function(i){var e="0.3.4",j="hasOwnProperty",b=/[\.\/]/,a="*",g=function(){},f=function(m,l){return m-l},d,h,k={n:{}},c=function(m,C){var v=k,s=h,w=Array.prototype.slice.call(arguments,2),y=c.listeners(m),x=0,u=false,p,o=[],t={},q=[],n=d,A=[];d=m;h=0;for(var r=0,B=y.length;r<B;r++){if("zIndex" in y[r]){o.push(y[r].zIndex);if(y[r].zIndex<0){t[y[r].zIndex]=y[r]}}}o.sort(f);while(o[x]<0){p=t[o[x++]];q.push(p.apply(C,w));if(h){h=s;return q}}for(r=0;r<B;r++){p=y[r];if("zIndex" in p){if(p.zIndex==o[x]){q.push(p.apply(C,w));if(h){break}do{x++;p=t[o[x]];p&&q.push(p.apply(C,w));if(h){break}}while(p)}else{t[p.zIndex]=p}}else{q.push(p.apply(C,w));if(h){break}}}h=s;d=n;return q.length?q:null};c.listeners=function(l){var t=l.split(b),r=k,x,s,m,p,w,o,q,u,v=[r],n=[];for(p=0,w=t.length;p<w;p++){u=[];for(o=0,q=v.length;o<q;o++){r=v[o].n;s=[r[t[p]],r[a]];m=2;while(m--){x=s[m];if(x){u.push(x);n=n.concat(x.f||[])}}}v=u}return n};c.on=function(l,o){var q=l.split(b),p=k;for(var m=0,n=q.length;m<n;m++){p=p.n;!p[q[m]]&&(p[q[m]]={n:{}});p=p[q[m]]}p.f=p.f||[];for(m=0,n=p.f.length;m<n;m++){if(p.f[m]==o){return g}}p.f.push(o);return function(r){if(+r==+r){o.zIndex=+r}}};c.stop=function(){h=1};c.nt=function(l){if(l){return new RegExp("(?:\\.|\\/|^)"+l+"(?:\\.|\\/|$)").test(d)}return d};c.off=c.unbind=function(m,r){var t=m.split(b),s,v,n,p,w,o,q,u=[k];for(p=0,w=t.length;p<w;p++){for(o=0;o<u.length;o+=n.length-2){n=[o,1];s=u[o].n;if(t[p]!=a){if(s[t[p]]){n.push(s[t[p]])}}else{for(v in s){if(s[j](v)){n.push(s[v])}}}u.splice.apply(u,n)}}for(p=0,w=u.length;p<w;p++){s=u[p];while(s.n){if(r){if(s.f){for(o=0,q=s.f.length;o<q;o++){if(s.f[o]==r){s.f.splice(o,1);break}}!s.f.length&&delete s.f}for(v in s.n){if(s.n[j](v)&&s.n[v].f){var l=s.n[v].f;for(o=0,q=l.length;o<q;o++){if(l[o]==r){l.splice(o,1);break}}!l.length&&delete s.n[v].f}}}else{delete s.f;for(v in s.n){if(s.n[j](v)&&s.n[v].f){delete s.n[v].f}}}s=s.n}}};c.once=function(l,m){var n=function(){var o=m.apply(this,arguments);c.unbind(l,n);return o};return c.on(l,n)};c.version=e;c.toString=function(){return"You are running Eve "+e};(typeof module!="undefined"&&module.exports)?(module.exports=c):(typeof define!="undefined"?((i.eve=c)&&define("eve",[],function(){return c})):(i.eve=c))})(this);(function(){function aR(g){if(aR.is(g,"function")){return ao?g():eve.on("raphael.DOMload",g)}else{if(aR.is(g,bd)){return aR._engine.create[bG](aR,g.splice(0,3+aR.is(g[0],aL))).add(g)}else{var b=Array.prototype.slice.call(arguments,0);if(aR.is(b[b.length-1],"function")){var d=b.pop();return ao?d.call(aR._engine.create[bG](aR,b)):eve.on("raphael.DOMload",function(){d.call(aR._engine.create[bG](aR,b))})}else{return aR._engine.create[bG](aR,arguments)}}}}aR.version="2.1.0";aR.eve=eve;var ao,a=/[, ]+/,bw={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},br=/\{(\d+)\}/g,bJ="prototype",ak="hasOwnProperty",aA={doc:document,win:window},s={was:Object.prototype[ak].call(aA.win,"Raphael"),is:aA.win.Raphael},bF=function(){this.ca=this.customAttributes={}},a4,bo="appendChild",bG="apply",bE="concat",Z="createTouch" in aA.doc,aX="",aQ=" ",bH=String,F="split",Q="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[F](aQ),bx={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},bK=bH.prototype.toLowerCase,au=Math,m=au.max,bm=au.min,aw=au.abs,bp=au.pow,aV=au.PI,aL="number",aj="string",bd="array",a5="toString",a9="fill",a1=Object.prototype.toString,bz={},j="push",f=aR._ISURL=/^url\(['"]?([^\)]+?)['"]?\)$/i,A=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,av={"NaN":1,"Infinity":1,"-Infinity":1},c=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,ah=au.round,z="setAttribute",an=parseFloat,U=parseInt,bt=bH.prototype.toUpperCase,r=aR._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0},ar=aR._availableAnimAttrs={blur:aL,"clip-rect":"csv",cx:aL,cy:aL,fill:"colour","fill-opacity":aL,"font-size":aL,height:aL,opacity:aL,path:"path",r:aL,rx:aL,ry:aL,stroke:"colour","stroke-opacity":aL,"stroke-width":aL,transform:"transform",width:aL,x:aL,y:aL},ac=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]/g,bi=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,n={hs:1,rg:1},bg=/,?([achlmqrstvxz]),?/gi,a0=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,ai=/([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,aP=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/ig,aW=aR._radial_gradient=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/,aU={},bq=function(g,d){return g.key-d.key},u=function(g,d){return an(g)-an(d)},I=function(){},bB=function(b){return b},az=aR._rectPath=function(b,E,d,g,i){if(i){return[["M",b+i,E],["l",d-i*2,0],["a",i,i,0,0,1,i,i],["l",0,g-i*2],["a",i,i,0,0,1,-i,i],["l",i*2-d,0],["a",i,i,0,0,1,-i,-i],["l",0,i*2-g],["a",i,i,0,0,1,i,-i],["z"]]}return[["M",b,E],["l",d,0],["l",0,g],["l",-d,0],["z"]]},K=function(b,i,g,d){if(d==null){d=g}return[["M",b,i],["m",0,-d],["a",g,d,0,1,1,0,2*d],["a",g,d,0,1,1,0,-2*d],["z"]]},N=aR._getPath={path:function(b){return b.attr("path")},circle:function(d){var b=d.attrs;return K(b.cx,b.cy,b.r)},ellipse:function(d){var b=d.attrs;return K(b.cx,b.cy,b.rx,b.ry)},rect:function(d){var b=d.attrs;return az(b.x,b.y,b.width,b.height,b.r)},image:function(d){var b=d.attrs;return az(b.x,b.y,b.width,b.height)},text:function(b){var d=b._getBBox();return az(d.x,d.y,d.width,d.height)}},L=aR.mapPath=function(bN,S){if(!S){return bN}var bL,R,g,b,bM,E,d;bN=W(bN);for(g=0,bM=bN.length;g<bM;g++){d=bN[g];for(b=1,E=d.length;b<E;b+=2){bL=S.x(d[b],d[b+1]);R=S.y(d[b],d[b+1]);d[b]=bL;d[b+1]=R}}return bN};aR._g=aA;aR.type=(aA.win.SVGAngle||aA.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML");if(aR.type=="VML"){var aE=aA.doc.createElement("div"),aH;aE.innerHTML='<v:shape adj="1"/>';aH=aE.firstChild;aH.style.behavior="url(#default#VML)";if(!(aH&&typeof aH.adj=="object")){return(aR.type=aX)}aE=null}aR.svg=!(aR.vml=aR.type=="VML");aR._Paper=bF;aR.fn=a4=bF.prototype=aR.prototype;aR._id=0;aR._oid=0;aR.is=function(d,b){b=bK.call(b);if(b=="finite"){return !av[ak](+d)}if(b=="array"){return d instanceof Array}return(b=="null"&&d===null)||(b==typeof d&&d!==null)||(b=="object"&&d===Object(d))||(b=="array"&&Array.isArray&&Array.isArray(d))||a1.call(d).slice(8,-1).toLowerCase()==b};function X(g){if(Object(g)!==g){return g}var d=new g.constructor;for(var b in g){if(g[ak](b)){d[b]=X(g[b])}}return d}aR.angle=function(E,S,g,R,d,i){if(d==null){var b=E-g,bL=S-R;if(!b&&!bL){return 0}return(180+au.atan2(-bL,-b)*180/aV+360)%360}else{return aR.angle(E,S,d,i)-aR.angle(g,R,d,i)}};aR.rad=function(b){return b%360*aV/180};aR.deg=function(b){return b*180/aV%360};aR.snapTo=function(d,E,b){b=aR.is(b,"finite")?b:10;if(aR.is(d,bd)){var g=d.length;while(g--){if(aw(d[g]-E)<=b){return d[g]}}}else{d=+d;var R=E%d;if(R<b){return E-R}if(R>d-b){return E-R+d}}return E};var h=aR.createUUID=(function(b,d){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(b,d).toUpperCase()}})(/[xy]/g,function(g){var d=au.random()*16|0,b=g=="x"?d:(d&3|8);return b.toString(16)});aR.setWindow=function(b){eve("raphael.setWindow",aR,aA.win,b);aA.win=b;aA.doc=aA.win.document;if(aR._engine.initWin){aR._engine.initWin(aA.win)}};var bf=function(g){if(aR.vml){var b=/^\s+|\s+$/g;var R;try{var S=new ActiveXObject("htmlfile");S.write("<body>");S.close();R=S.body}catch(bL){R=createPopup().document.body}var d=R.createTextRange();bf=aG(function(i){try{R.style.color=bH(i).replace(b,aX);var bM=d.queryCommandValue("ForeColor");bM=((bM&255)<<16)|(bM&65280)|((bM&16711680)>>>16);return"#"+("000000"+bM.toString(16)).slice(-6)}catch(bN){return"none"}})}else{var E=aA.doc.createElement("i");E.title="Rapha\xebl Colour Picker";E.style.display="none";aA.doc.body.appendChild(E);bf=aG(function(i){E.style.color=i;return aA.doc.defaultView.getComputedStyle(E,aX).getPropertyValue("color")})}return bf(g)},aI=function(){return"hsb("+[this.h,this.s,this.b]+")"},M=function(){return"hsl("+[this.h,this.s,this.l]+")"},x=function(){return this.hex},aY=function(R,E,d){if(E==null&&aR.is(R,"object")&&"r" in R&&"g" in R&&"b" in R){d=R.b;E=R.g;R=R.r}if(E==null&&aR.is(R,aj)){var i=aR.getRGB(R);R=i.r;E=i.g;d=i.b}if(R>1||E>1||d>1){R/=255;E/=255;d/=255}return[R,E,d]},a2=function(R,E,d,S){R*=255;E*=255;d*=255;var i={r:R,g:E,b:d,hex:aR.rgb(R,E,d),toString:x};aR.is(S,"finite")&&(i.opacity=S);return i};aR.color=function(b){var d;if(aR.is(b,"object")&&"h" in b&&"s" in b&&"b" in b){d=aR.hsb2rgb(b);b.r=d.r;b.g=d.g;b.b=d.b;b.hex=d.hex}else{if(aR.is(b,"object")&&"h" in b&&"s" in b&&"l" in b){d=aR.hsl2rgb(b);b.r=d.r;b.g=d.g;b.b=d.b;b.hex=d.hex}else{if(aR.is(b,"string")){b=aR.getRGB(b)}if(aR.is(b,"object")&&"r" in b&&"g" in b&&"b" in b){d=aR.rgb2hsl(b);b.h=d.h;b.s=d.s;b.l=d.l;d=aR.rgb2hsb(b);b.v=d.b}else{b={hex:"none"};b.r=b.g=b.b=b.h=b.s=b.v=b.l=-1}}}b.toString=x;return b};aR.hsb2rgb=function(S,bN,bL,i){if(this.is(S,"object")&&"h" in S&&"s" in S&&"b" in S){bL=S.b;bN=S.s;S=S.h;i=S.o}S*=360;var E,bM,d,g,b;S=(S%360)/60;b=bL*bN;g=b*(1-aw(S%2-1));E=bM=d=bL-b;S=~~S;E+=[b,g,0,0,g,b][S];bM+=[g,b,b,g,0,0][S];d+=[0,0,g,b,b,g][S];return a2(E,bM,d,i)};aR.hsl2rgb=function(bL,bN,E,i){if(this.is(bL,"object")&&"h" in bL&&"s" in bL&&"l" in bL){E=bL.l;bN=bL.s;bL=bL.h}if(bL>1||bN>1||E>1){bL/=360;bN/=100;E/=100}bL*=360;var S,bM,d,g,b;bL=(bL%360)/60;b=2*bN*(E<0.5?E:1-E);g=b*(1-aw(bL%2-1));S=bM=d=E-b/2;bL=~~bL;S+=[b,g,0,0,g,b][bL];bM+=[g,b,b,g,0,0][bL];d+=[0,0,g,b,b,g][bL];return a2(S,bM,d,i)};aR.rgb2hsb=function(bM,bL,d){d=aY(bM,bL,d);bM=d[0];bL=d[1];d=d[2];var R,E,i,bN;i=m(bM,bL,d);bN=i-bm(bM,bL,d);R=(bN==0?null:i==bM?(bL-d)/bN:i==bL?(d-bM)/bN+2:(bM-bL)/bN+4);R=((R+360)%6)*60/360;E=bN==0?0:bN/i;return{h:R,s:E,b:i,toString:aI}};aR.rgb2hsl=function(d,bL,bO){bO=aY(d,bL,bO);d=bO[0];bL=bO[1];bO=bO[2];var bP,R,bN,bM,E,i;bM=m(d,bL,bO);E=bm(d,bL,bO);i=bM-E;bP=(i==0?null:bM==d?(bL-bO)/i:bM==bL?(bO-d)/i+2:(d-bL)/i+4);bP=((bP+360)%6)*60/360;bN=(bM+E)/2;R=(i==0?0:bN<0.5?i/(2*bN):i/(2-2*bN));return{h:bP,s:R,l:bN,toString:M}};aR._path2string=function(){return this.join(",").replace(bg,"$1")};function bk(E,g){for(var b=0,d=E.length;b<d;b++){if(E[b]===g){return E.push(E.splice(b,1)[0])}}}function aG(i,d,b){function g(){var E=Array.prototype.slice.call(arguments,0),S=E.join("\u2400"),R=g.cache=g.cache||{},bL=g.count=g.count||[];if(R[ak](S)){bk(bL,S);return b?b(R[S]):R[S]}bL.length>=1000&&delete R[bL.shift()];bL.push(S);R[S]=i[bG](d,E);return b?b(R[S]):R[S]}return g}var bv=aR._preload=function(g,d){var b=aA.doc.createElement("img");b.style.cssText="position:absolute;left:-9999em;top:-9999em";b.onload=function(){d.call(this);this.onload=null;aA.doc.body.removeChild(this)};b.onerror=function(){aA.doc.body.removeChild(this)};aA.doc.body.appendChild(b);b.src=g};function aq(){return this.hex}aR.getRGB=aG(function(b){if(!b||!!((b=bH(b)).indexOf("-")+1)){return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:aq}}if(b=="none"){return{r:-1,g:-1,b:-1,hex:"none",toString:aq}}!(n[ak](b.toLowerCase().substring(0,2))||b.charAt()=="#")&&(b=bf(b));var E,d,g,S,i,bM,bL,R=b.match(A);if(R){if(R[2]){S=U(R[2].substring(5),16);g=U(R[2].substring(3,5),16);d=U(R[2].substring(1,3),16)}if(R[3]){S=U((bM=R[3].charAt(3))+bM,16);g=U((bM=R[3].charAt(2))+bM,16);d=U((bM=R[3].charAt(1))+bM,16)}if(R[4]){bL=R[4][F](bi);d=an(bL[0]);bL[0].slice(-1)=="%"&&(d*=2.55);g=an(bL[1]);bL[1].slice(-1)=="%"&&(g*=2.55);S=an(bL[2]);bL[2].slice(-1)=="%"&&(S*=2.55);R[1].toLowerCase().slice(0,4)=="rgba"&&(i=an(bL[3]));bL[3]&&bL[3].slice(-1)=="%"&&(i/=100)}if(R[5]){bL=R[5][F](bi);d=an(bL[0]);bL[0].slice(-1)=="%"&&(d*=2.55);g=an(bL[1]);bL[1].slice(-1)=="%"&&(g*=2.55);S=an(bL[2]);bL[2].slice(-1)=="%"&&(S*=2.55);(bL[0].slice(-3)=="deg"||bL[0].slice(-1)=="\xb0")&&(d/=360);R[1].toLowerCase().slice(0,4)=="hsba"&&(i=an(bL[3]));bL[3]&&bL[3].slice(-1)=="%"&&(i/=100);return aR.hsb2rgb(d,g,S,i)}if(R[6]){bL=R[6][F](bi);d=an(bL[0]);bL[0].slice(-1)=="%"&&(d*=2.55);g=an(bL[1]);bL[1].slice(-1)=="%"&&(g*=2.55);S=an(bL[2]);bL[2].slice(-1)=="%"&&(S*=2.55);(bL[0].slice(-3)=="deg"||bL[0].slice(-1)=="\xb0")&&(d/=360);R[1].toLowerCase().slice(0,4)=="hsla"&&(i=an(bL[3]));bL[3]&&bL[3].slice(-1)=="%"&&(i/=100);return aR.hsl2rgb(d,g,S,i)}R={r:d,g:g,b:S,toString:aq};R.hex="#"+(16777216|S|(g<<8)|(d<<16)).toString(16).slice(1);aR.is(i,"finite")&&(R.opacity=i);return R}return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:aq}},aR);aR.hsb=aG(function(i,g,d){return aR.hsb2rgb(i,g,d).hex});aR.hsl=aG(function(g,d,b){return aR.hsl2rgb(g,d,b).hex});aR.rgb=aG(function(E,i,d){return"#"+(16777216|d|(i<<8)|(E<<16)).toString(16).slice(1)});aR.getColor=function(d){var g=this.getColor.start=this.getColor.start||{h:0,s:1,b:d||0.75},b=this.hsb2rgb(g.h,g.s,g.b);g.h+=0.075;if(g.h>1){g.h=0;g.s-=0.2;g.s<=0&&(this.getColor.start={h:0,s:1,b:g.b})}return b.hex};aR.getColor.reset=function(){delete this.start};function bb(E,bL){var S=[];for(var g=0,b=E.length;b-2*!bL>g;g+=2){var R=[{x:+E[g-2],y:+E[g-1]},{x:+E[g],y:+E[g+1]},{x:+E[g+2],y:+E[g+3]},{x:+E[g+4],y:+E[g+5]}];if(bL){if(!g){R[0]={x:+E[b-2],y:+E[b-1]}}else{if(b-4==g){R[3]={x:+E[0],y:+E[1]}}else{if(b-2==g){R[2]={x:+E[0],y:+E[1]};R[3]={x:+E[2],y:+E[3]}}}}}else{if(b-4==g){R[3]=R[2]}else{if(!g){R[0]={x:+E[g],y:+E[g+1]}}}}S.push(["C",(-R[0].x+6*R[1].x+R[2].x)/6,(-R[0].y+6*R[1].y+R[2].y)/6,(R[1].x+6*R[2].x-R[3].x)/6,(R[1].y+6*R[2].y-R[3].y)/6,R[2].x,R[2].y])}return S}aR.parsePathString=function(b){if(!b){return null}var g=Y(b);if(g.arr){return aZ(g.arr)}var i={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},d=[];if(aR.is(b,bd)&&aR.is(b[0],bd)){d=aZ(b)}if(!d.length){bH(b).replace(a0,function(R,E,bM){var bL=[],S=E.toLowerCase();bM.replace(aP,function(bO,bN){bN&&bL.push(+bN)});if(S=="m"&&bL.length>2){d.push([E][bE](bL.splice(0,2)));S="l";E=E=="m"?"l":"L"}if(S=="r"){d.push([E][bE](bL))}else{while(bL.length>=i[S]){d.push([E][bE](bL.splice(0,i[S])));if(!i[S]){break}}}})}d.toString=aR._path2string;g.arr=aZ(d);return d};aR.parseTransformString=aG(function(d){if(!d){return null}var g={r:3,s:4,t:2,m:6},b=[];if(aR.is(d,bd)&&aR.is(d[0],bd)){b=aZ(d)}if(!b.length){bH(d).replace(ai,function(E,i,bL){var S=[],R=bK.call(i);bL.replace(aP,function(bN,bM){bM&&S.push(+bM)});b.push([i][bE](S))})}b.toString=aR._path2string;return b});var Y=function(d){var b=Y.ps=Y.ps||{};if(b[d]){b[d].sleep=100}else{b[d]={sleep:100}}setTimeout(function(){for(var g in b){if(b[ak](g)&&g!=d){b[g].sleep--;!b[g].sleep&&delete b[g]}}});return b[d]};aR.findDotsAtSegment=function(d,b,b2,b0,S,E,bN,bL,bV){var bS=1-bV,bX=bp(bS,3),bY=bp(bS,2),bP=bV*bV,bM=bP*bV,bR=bX*d+bY*3*bV*b2+bS*3*bV*bV*S+bM*bN,bO=bX*b+bY*3*bV*b0+bS*3*bV*bV*E+bM*bL,bW=d+2*bV*(b2-d)+bP*(S-2*b2+d),bU=b+2*bV*(b0-b)+bP*(E-2*b0+b),b1=b2+2*bV*(S-b2)+bP*(bN-2*S+b2),bZ=b0+2*bV*(E-b0)+bP*(bL-2*E+b0),bT=bS*d+bV*b2,bQ=bS*b+bV*b0,i=bS*S+bV*bN,g=bS*E+bV*bL,R=(90-au.atan2(bW-b1,bU-bZ)*180/aV);(bW>b1||bU<bZ)&&(R+=180);return{x:bR,y:bO,m:{x:bW,y:bU},n:{x:b1,y:bZ},start:{x:bT,y:bQ},end:{x:i,y:g},alpha:R}};aR.bezierBBox=function(d,b,i,g,bM,S,R,E){if(!aR.is(d,"array")){d=[d,b,i,g,bM,S,R,E]}var bL=ba.apply(null,d);return{x:bL.min.x,y:bL.min.y,x2:bL.max.x,y2:bL.max.y,width:bL.max.x-bL.min.x,height:bL.max.y-bL.min.y}};aR.isPointInsideBBox=function(d,b,g){return b>=d.x&&b<=d.x2&&g>=d.y&&g<=d.y2};aR.isBBoxIntersect=function(g,d){var b=aR.isPointInsideBBox;return b(d,g.x,g.y)||b(d,g.x2,g.y)||b(d,g.x,g.y2)||b(d,g.x2,g.y2)||b(g,d.x,d.y)||b(g,d.x2,d.y)||b(g,d.x,d.y2)||b(g,d.x2,d.y2)||(g.x<d.x2&&g.x>d.x||d.x<g.x2&&d.x>g.x)&&(g.y<d.y2&&g.y>d.y||d.y<g.y2&&d.y>g.y)};function bj(b,S,R,E,i){var g=-3*S+9*R-9*E+3*i,d=b*g+6*S-12*R+6*E;return b*d-3*S+3*R}function q(bW,R,bV,g,bU,d,bR,b,bO){if(bO==null){bO=1}bO=bO>1?1:bO<0?0:bO;var bP=bO/2,bQ=12,bL=[-0.1252,0.1252,-0.3678,0.3678,-0.5873,0.5873,-0.7699,0.7699,-0.9041,0.9041,-0.9816,0.9816],bT=[0.2491,0.2491,0.2335,0.2335,0.2032,0.2032,0.1601,0.1601,0.1069,0.1069,0.0472,0.0472],E=0;for(var bS=0;bS<bQ;bS++){var bM=bP*bL[bS]+bP,bN=bj(bM,bW,bV,bU,bR),bX=bj(bM,R,g,d,b),S=bN*bN+bX*bX;E+=bT[bS]*au.sqrt(S)}return bP*E}function C(g,bP,d,bO,b,bM,bR,bL,bN){if(bN<0||q(g,bP,d,bO,b,bM,bR,bL)<bN){return}var bQ=1,i=bQ/2,R=bQ-i,E,S=0.01;E=q(g,bP,d,bO,b,bM,bR,bL,R);while(aw(E-bN)>S){i/=2;R+=(E<bN?1:-1)*i;E=q(g,bP,d,bO,b,bM,bR,bL,R)}return R}function O(i,bQ,g,bO,b,bN,bS,bM){if(m(i,g)<bm(b,bS)||bm(i,g)>m(b,bS)||m(bQ,bO)<bm(bN,bM)||bm(bQ,bO)>m(bN,bM)){return}var bL=(i*bO-bQ*g)*(b-bS)-(i-g)*(b*bM-bN*bS),S=(i*bO-bQ*g)*(bN-bM)-(bQ-bO)*(b*bM-bN*bS),E=(i-g)*(bN-bM)-(bQ-bO)*(b-bS);if(!E){return}var bR=bL/E,bP=S/E,R=+bR.toFixed(2),d=+bP.toFixed(2);if(R<+bm(i,g).toFixed(2)||R>+m(i,g).toFixed(2)||R<+bm(b,bS).toFixed(2)||R>+m(b,bS).toFixed(2)||d<+bm(bQ,bO).toFixed(2)||d>+m(bQ,bO).toFixed(2)||d<+bm(bN,bM).toFixed(2)||d>+m(bN,bM).toFixed(2)){return}return{x:bR,y:bP}}function ay(d,b){return af(d,b)}function t(d,b){return af(d,b,1)}function af(b2,b1,b0){var E=aR.bezierBBox(b2),d=aR.bezierBBox(b1);if(!aR.isBBoxIntersect(E,d)){return b0?0:[]}var bV=q.apply(0,b2),bU=q.apply(0,b1),bM=~~(bV/5),bL=~~(bU/5),bS=[],bR=[],g={},b3=b0?0:[];for(var bX=0;bX<bM+1;bX++){var bT=aR.findDotsAtSegment.apply(aR,b2.concat(bX/bM));bS.push({x:bT.x,y:bT.y,t:bX/bM})}for(bX=0;bX<bL+1;bX++){bT=aR.findDotsAtSegment.apply(aR,b1.concat(bX/bL));bR.push({x:bT.x,y:bT.y,t:bX/bL})}for(bX=0;bX<bM;bX++){for(var bW=0;bW<bL;bW++){var bZ=bS[bX],b=bS[bX+1],bY=bR[bW],S=bR[bW+1],bQ=aw(b.x-bZ.x)<0.001?"y":"x",bP=aw(S.x-bY.x)<0.001?"y":"x",R=O(bZ.x,bZ.y,b.x,b.y,bY.x,bY.y,S.x,S.y);if(R){if(g[R.x.toFixed(4)]==R.y.toFixed(4)){continue}g[R.x.toFixed(4)]=R.y.toFixed(4);var bO=bZ.t+aw((R[bQ]-bZ[bQ])/(b[bQ]-bZ[bQ]))*(b.t-bZ.t),bN=bY.t+aw((R[bP]-bY[bP])/(S[bP]-bY[bP]))*(S.t-bY.t);if(bO>=0&&bO<=1&&bN>=0&&bN<=1){if(b0){b3++}else{b3.push({x:R.x,y:R.y,t1:bO,t2:bN})}}}}}return b3}aR.pathIntersection=function(d,b){return D(d,b)};aR.pathIntersectionNumber=function(d,b){return D(d,b,1)};function D(g,b,bW){g=aR._path2curve(g);b=aR._path2curve(b);var bU,S,bT,E,bR,bL,d,bO,b0,bZ,b1=bW?0:[];for(var bS=0,bM=g.length;bS<bM;bS++){var bY=g[bS];if(bY[0]=="M"){bU=bR=bY[1];S=bL=bY[2]}else{if(bY[0]=="C"){b0=[bU,S].concat(bY.slice(1));bU=b0[6];S=b0[7]}else{b0=[bU,S,bU,S,bR,bL,bR,bL];bU=bR;S=bL}for(var bQ=0,bV=b.length;bQ<bV;bQ++){var bX=b[bQ];if(bX[0]=="M"){bT=d=bX[1];E=bO=bX[2]}else{if(bX[0]=="C"){bZ=[bT,E].concat(bX.slice(1));bT=bZ[6];E=bZ[7]}else{bZ=[bT,E,bT,E,d,bO,d,bO];bT=d;E=bO}var bN=af(b0,bZ,bW);if(bW){b1+=bN}else{for(var bP=0,R=bN.length;bP<R;bP++){bN[bP].segment1=bS;bN[bP].segment2=bQ;bN[bP].bez1=b0;bN[bP].bez2=bZ}b1=b1.concat(bN)}}}}}return b1}aR.isPointInsidePath=function(d,b,i){var g=aR.pathBBox(d);return aR.isPointInsideBBox(g,b,i)&&D(d,[["M",b,i],["H",g.x2+10]],1)%2==1};aR._removedFactory=function(b){return function(){eve("raphael.log",null,"Rapha\xebl: you are calling to method \u201c"+b+"\u201d of removed object",b)}};var am=aR.pathBBox=function(bT){var bN=Y(bT);if(bN.bbox){return bN.bbox}if(!bT){return{x:0,y:0,width:0,height:0,x2:0,y2:0}}bT=W(bT);var bQ=0,bP=0,R=[],d=[],g;for(var bL=0,bS=bT.length;bL<bS;bL++){g=bT[bL];if(g[0]=="M"){bQ=g[1];bP=g[2];R.push(bQ);d.push(bP)}else{var bM=ba(bQ,bP,g[1],g[2],g[3],g[4],g[5],g[6]);R=R[bE](bM.min.x,bM.max.x);d=d[bE](bM.min.y,bM.max.y);bQ=g[5];bP=g[6]}}var b=bm[bG](0,R),bR=bm[bG](0,d),S=m[bG](0,R),E=m[bG](0,d),bO={x:b,y:bR,x2:S,y2:E,width:S-b,height:E-bR};bN.bbox=X(bO);return bO},aZ=function(d){var b=X(d);b.toString=aR._path2string;return b},aC=aR._pathToRelative=function(E){var bM=Y(E);if(bM.rel){return aZ(bM.rel)}if(!aR.is(E,bd)||!aR.is(E&&E[0],bd)){E=aR.parsePathString(E)}var bP=[],bR=0,bQ=0,bU=0,bT=0,g=0;if(E[0][0]=="M"){bR=E[0][1];bQ=E[0][2];bU=bR;bT=bQ;g++;bP.push(["M",bR,bQ])}for(var bL=g,bV=E.length;bL<bV;bL++){var b=bP[bL]=[],bS=E[bL];if(bS[0]!=bK.call(bS[0])){b[0]=bK.call(bS[0]);switch(b[0]){case"a":b[1]=bS[1];b[2]=bS[2];b[3]=bS[3];b[4]=bS[4];b[5]=bS[5];b[6]=+(bS[6]-bR).toFixed(3);b[7]=+(bS[7]-bQ).toFixed(3);break;case"v":b[1]=+(bS[1]-bQ).toFixed(3);break;case"m":bU=bS[1];bT=bS[2];default:for(var S=1,bN=bS.length;S<bN;S++){b[S]=+(bS[S]-((S%2)?bR:bQ)).toFixed(3)}}}else{b=bP[bL]=[];if(bS[0]=="m"){bU=bS[1]+bR;bT=bS[2]+bQ}for(var R=0,d=bS.length;R<d;R++){bP[bL][R]=bS[R]}}var bO=bP[bL].length;switch(bP[bL][0]){case"z":bR=bU;bQ=bT;break;case"h":bR+=+bP[bL][bO-1];break;case"v":bQ+=+bP[bL][bO-1];break;default:bR+=+bP[bL][bO-2];bQ+=+bP[bL][bO-1]}}bP.toString=aR._path2string;bM.rel=aZ(bP);return bP},w=aR._pathToAbsolute=function(bQ){var g=Y(bQ);if(g.abs){return aZ(g.abs)}if(!aR.is(bQ,bd)||!aR.is(bQ&&bQ[0],bd)){bQ=aR.parsePathString(bQ)}if(!bQ||!bQ.length){return[["M",0,0]]}var bW=[],bL=0,S=0,bO=0,bN=0,E=0;if(bQ[0][0]=="M"){bL=+bQ[0][1];S=+bQ[0][2];bO=bL;bN=S;E++;bW[0]=["M",bL,S]}var bV=bQ.length==3&&bQ[0][0]=="M"&&bQ[1][0].toUpperCase()=="R"&&bQ[2][0].toUpperCase()=="Z";for(var bP,b,bT=E,bM=bQ.length;bT<bM;bT++){bW.push(bP=[]);b=bQ[bT];if(b[0]!=bt.call(b[0])){bP[0]=bt.call(b[0]);switch(bP[0]){case"A":bP[1]=b[1];bP[2]=b[2];bP[3]=b[3];bP[4]=b[4];bP[5]=b[5];bP[6]=+(b[6]+bL);bP[7]=+(b[7]+S);break;case"V":bP[1]=+b[1]+S;break;case"H":bP[1]=+b[1]+bL;break;case"R":var R=[bL,S][bE](b.slice(1));for(var bS=2,bU=R.length;bS<bU;bS++){R[bS]=+R[bS]+bL;R[++bS]=+R[bS]+S}bW.pop();bW=bW[bE](bb(R,bV));break;case"M":bO=+b[1]+bL;bN=+b[2]+S;default:for(bS=1,bU=b.length;bS<bU;bS++){bP[bS]=+b[bS]+((bS%2)?bL:S)}}}else{if(b[0]=="R"){R=[bL,S][bE](b.slice(1));bW.pop();bW=bW[bE](bb(R,bV));bP=["R"][bE](b.slice(-2))}else{for(var bR=0,d=b.length;bR<d;bR++){bP[bR]=b[bR]}}}switch(bP[0]){case"Z":bL=bO;S=bN;break;case"H":bL=bP[1];break;case"V":S=bP[1];break;case"M":bO=bP[bP.length-2];bN=bP[bP.length-1];default:bL=bP[bP.length-2];S=bP[bP.length-1]}}bW.toString=aR._path2string;g.abs=aZ(bW);return bW},bI=function(d,i,b,g){return[d,i,b,g,b,g]},bn=function(d,i,S,E,b,g){var R=1/3,bL=2/3;return[R*d+bL*S,R*i+bL*E,R*b+bL*S,R*g+bL*E,b,g]},ae=function(bS,cn,b1,bZ,bT,bN,E,bR,cm,bU){var bY=aV*120/180,b=aV/180*(+bT||0),b5=[],b2,cj=aG(function(co,cr,i){var cq=co*au.cos(i)-cr*au.sin(i),cp=co*au.sin(i)+cr*au.cos(i);return{x:cq,y:cp}});if(!bU){b2=cj(bS,cn,-b);bS=b2.x;cn=b2.y;b2=cj(bR,cm,-b);bR=b2.x;cm=b2.y;var d=au.cos(aV/180*bT),bP=au.sin(aV/180*bT),b7=(bS-bR)/2,b6=(cn-cm)/2;var ch=(b7*b7)/(b1*b1)+(b6*b6)/(bZ*bZ);if(ch>1){ch=au.sqrt(ch);b1=ch*b1;bZ=ch*bZ}var g=b1*b1,ca=bZ*bZ,cc=(bN==E?-1:1)*au.sqrt(aw((g*ca-g*b6*b6-ca*b7*b7)/(g*b6*b6+ca*b7*b7))),bW=cc*b1*b6/bZ+(bS+bR)/2,bV=cc*-bZ*b7/b1+(cn+cm)/2,bM=au.asin(((cn-bV)/bZ).toFixed(9)),bL=au.asin(((cm-bV)/bZ).toFixed(9));bM=bS<bW?aV-bM:bM;bL=bR<bW?aV-bL:bL;bM<0&&(bM=aV*2+bM);bL<0&&(bL=aV*2+bL);if(E&&bM>bL){bM=bM-aV*2}if(!E&&bL>bM){bL=bL-aV*2}}else{bM=bU[0];bL=bU[1];bW=bU[2];bV=bU[3]}var bQ=bL-bM;if(aw(bQ)>bY){var bX=bL,b0=bR,bO=cm;bL=bM+bY*(E&&bL>bM?1:-1);bR=bW+b1*au.cos(bL);cm=bV+bZ*au.sin(bL);b5=ae(bR,cm,b1,bZ,bT,0,E,b0,bO,[bL,bX,bW,bV])}bQ=bL-bM;var S=au.cos(bM),cl=au.sin(bM),R=au.cos(bL),ck=au.sin(bL),b8=au.tan(bQ/4),cb=4/3*b1*b8,b9=4/3*bZ*b8,ci=[bS,cn],cg=[bS+cb*cl,cn-b9*S],cf=[bR+cb*ck,cm-b9*R],cd=[bR,cm];cg[0]=2*ci[0]-cg[0];cg[1]=2*ci[1]-cg[1];if(bU){return[cg,cf,cd][bE](b5)}else{b5=[cg,cf,cd][bE](b5).join()[F](",");var b3=[];for(var ce=0,b4=b5.length;ce<b4;ce++){b3[ce]=ce%2?cj(b5[ce-1],b5[ce],b).y:cj(b5[ce],b5[ce+1],b).x}return b3}},ag=function(d,b,i,g,bM,bL,S,R,bN){var E=1-bN;return{x:bp(E,3)*d+bp(E,2)*3*bN*i+E*3*bN*bN*bM+bp(bN,3)*S,y:bp(E,3)*b+bp(E,2)*3*bN*g+E*3*bN*bN*bL+bp(bN,3)*R}},ba=aG(function(i,d,R,E,bU,bT,bQ,bN){var bS=(bU-2*R+i)-(bQ-2*bU+R),bP=2*(R-i)-2*(bU-R),bM=i-R,bL=(-bP+au.sqrt(bP*bP-4*bS*bM))/2/bS,S=(-bP-au.sqrt(bP*bP-4*bS*bM))/2/bS,bO=[d,bN],bR=[i,bQ],g;aw(bL)>"1e12"&&(bL=0.5);aw(S)>"1e12"&&(S=0.5);if(bL>0&&bL<1){g=ag(i,d,R,E,bU,bT,bQ,bN,bL);bR.push(g.x);bO.push(g.y)}if(S>0&&S<1){g=ag(i,d,R,E,bU,bT,bQ,bN,S);bR.push(g.x);bO.push(g.y)}bS=(bT-2*E+d)-(bN-2*bT+E);bP=2*(E-d)-2*(bT-E);bM=d-E;bL=(-bP+au.sqrt(bP*bP-4*bS*bM))/2/bS;S=(-bP-au.sqrt(bP*bP-4*bS*bM))/2/bS;aw(bL)>"1e12"&&(bL=0.5);aw(S)>"1e12"&&(S=0.5);if(bL>0&&bL<1){g=ag(i,d,R,E,bU,bT,bQ,bN,bL);bR.push(g.x);bO.push(g.y)}if(S>0&&S<1){g=ag(i,d,R,E,bU,bT,bQ,bN,S);bR.push(g.x);bO.push(g.y)}return{min:{x:bm[bG](0,bR),y:bm[bG](0,bO)},max:{x:m[bG](0,bR),y:m[bG](0,bO)}}}),W=aR._path2curve=aG(function(bU,bP){var bN=!bP&&Y(bU);if(!bP&&bN.curve){return aZ(bN.curve)}var E=w(bU),bQ=bP&&w(bP),bR={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},d={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},S=function(bV,bW){var i,bX;if(!bV){return["C",bW.x,bW.y,bW.x,bW.y,bW.x,bW.y]}!(bV[0] in {T:1,Q:1})&&(bW.qx=bW.qy=null);switch(bV[0]){case"M":bW.X=bV[1];bW.Y=bV[2];break;case"A":bV=["C"][bE](ae[bG](0,[bW.x,bW.y][bE](bV.slice(1))));break;case"S":i=bW.x+(bW.x-(bW.bx||bW.x));bX=bW.y+(bW.y-(bW.by||bW.y));bV=["C",i,bX][bE](bV.slice(1));break;case"T":bW.qx=bW.x+(bW.x-(bW.qx||bW.x));bW.qy=bW.y+(bW.y-(bW.qy||bW.y));bV=["C"][bE](bn(bW.x,bW.y,bW.qx,bW.qy,bV[1],bV[2]));break;case"Q":bW.qx=bV[1];bW.qy=bV[2];bV=["C"][bE](bn(bW.x,bW.y,bV[1],bV[2],bV[3],bV[4]));break;case"L":bV=["C"][bE](bI(bW.x,bW.y,bV[1],bV[2]));break;case"H":bV=["C"][bE](bI(bW.x,bW.y,bV[1],bW.y));break;case"V":bV=["C"][bE](bI(bW.x,bW.y,bW.x,bV[1]));break;case"Z":bV=["C"][bE](bI(bW.x,bW.y,bW.X,bW.Y));break}return bV},b=function(bV,bW){if(bV[bW].length>7){bV[bW].shift();var bX=bV[bW];while(bX.length){bV.splice(bW++,0,["C"][bE](bX.splice(0,6)))}bV.splice(bW,1);bS=m(E.length,bQ&&bQ.length||0)}},g=function(bZ,bY,bW,bV,bX){if(bZ&&bY&&bZ[bX][0]=="M"&&bY[bX][0]!="M"){bY.splice(bX,0,["M",bV.x,bV.y]);bW.bx=0;bW.by=0;bW.x=bZ[bX][1];bW.y=bZ[bX][2];bS=m(E.length,bQ&&bQ.length||0)}};for(var bM=0,bS=m(E.length,bQ&&bQ.length||0);bM<bS;bM++){E[bM]=S(E[bM],bR);b(E,bM);bQ&&(bQ[bM]=S(bQ[bM],d));bQ&&b(bQ,bM);g(E,bQ,bR,d,bM);g(bQ,E,d,bR,bM);var bL=E[bM],bT=bQ&&bQ[bM],R=bL.length,bO=bQ&&bT.length;bR.x=bL[R-2];bR.y=bL[R-1];bR.bx=an(bL[R-4])||bR.x;bR.by=an(bL[R-3])||bR.y;d.bx=bQ&&(an(bT[bO-4])||d.x);d.by=bQ&&(an(bT[bO-3])||d.y);d.x=bQ&&bT[bO-2];d.y=bQ&&bT[bO-1]}if(!bQ){bN.curve=aZ(E)}return bQ?[E,bQ]:E},null,aZ),v=aR._parseDots=aG(function(bO){var bN=[];for(var S=0,bP=bO.length;S<bP;S++){var b={},bM=bO[S].match(/^([^:]*):?([\d\.]*)/);b.color=aR.getRGB(bM[1]);if(b.color.error){return null}b.color=b.color.hex;bM[2]&&(b.offset=bM[2]+"%");bN.push(b)}for(S=1,bP=bN.length-1;S<bP;S++){if(!bN[S].offset){var g=an(bN[S-1].offset||0),E=0;for(var R=S+1;R<bP;R++){if(bN[R].offset){E=bN[R].offset;break}}if(!E){E=100;R=bP}E=an(E);var bL=(E-g)/(R-S+1);for(;S<R;S++){g+=bL;bN[S].offset=g+"%"}}}return bN}),aK=aR._tear=function(b,d){b==d.top&&(d.top=b.prev);b==d.bottom&&(d.bottom=b.next);b.next&&(b.next.prev=b.prev);b.prev&&(b.prev.next=b.next)},ap=aR._tofront=function(b,d){if(d.top===b){return}aK(b,d);b.next=null;b.prev=d.top;d.top.next=b;d.top=b},p=aR._toback=function(b,d){if(d.bottom===b){return}aK(b,d);b.next=d.bottom;b.prev=null;d.bottom.prev=b;d.bottom=b},G=aR._insertafter=function(d,b,g){aK(d,g);b==g.top&&(g.top=d);b.next&&(b.next.prev=d);d.next=b.next;d.prev=b;b.next=d},aT=aR._insertbefore=function(d,b,g){aK(d,g);b==g.bottom&&(g.bottom=d);b.prev&&(b.prev.next=d);d.prev=b.prev;b.prev=d;d.next=b},bl=aR.toMatrix=function(g,b){var i=am(g),d={_:{transform:aX},getBBox:function(){return i}};aO(d,b);return d.matrix},T=aR.transformPath=function(d,b){return L(d,bl(d,b))},aO=aR._extractTransform=function(d,bZ){if(bZ==null){return d._.transform}bZ=bH(bZ).replace(/\.{3}|\u2026/g,d._.transform||aX);var bR=aR.parseTransformString(bZ),bP=0,bN=0,bM=0,bT=1,bS=1,b0=d._,bU=new aF;b0.transform=bR||[];if(bR){for(var bV=0,bO=bR.length;bV<bO;bV++){var bQ=bR[bV],b=bQ.length,R=bH(bQ[0]).toLowerCase(),bY=bQ[0]!=R,bL=bY?bU.invert():0,bX,E,bW,g,S;if(R=="t"&&b==3){if(bY){bX=bL.x(0,0);E=bL.y(0,0);bW=bL.x(bQ[1],bQ[2]);g=bL.y(bQ[1],bQ[2]);bU.translate(bW-bX,g-E)}else{bU.translate(bQ[1],bQ[2])}}else{if(R=="r"){if(b==2){S=S||d.getBBox(1);bU.rotate(bQ[1],S.x+S.width/2,S.y+S.height/2);bP+=bQ[1]}else{if(b==4){if(bY){bW=bL.x(bQ[2],bQ[3]);g=bL.y(bQ[2],bQ[3]);bU.rotate(bQ[1],bW,g)}else{bU.rotate(bQ[1],bQ[2],bQ[3])}bP+=bQ[1]}}}else{if(R=="s"){if(b==2||b==3){S=S||d.getBBox(1);bU.scale(bQ[1],bQ[b-1],S.x+S.width/2,S.y+S.height/2);bT*=bQ[1];bS*=bQ[b-1]}else{if(b==5){if(bY){bW=bL.x(bQ[3],bQ[4]);g=bL.y(bQ[3],bQ[4]);bU.scale(bQ[1],bQ[2],bW,g)}else{bU.scale(bQ[1],bQ[2],bQ[3],bQ[4])}bT*=bQ[1];bS*=bQ[2]}}}else{if(R=="m"&&b==7){bU.add(bQ[1],bQ[2],bQ[3],bQ[4],bQ[5],bQ[6])}}}}b0.dirtyT=1;d.matrix=bU}}d.matrix=bU;b0.sx=bT;b0.sy=bS;b0.deg=bP;b0.dx=bN=bU.e;b0.dy=bM=bU.f;if(bT==1&&bS==1&&!bP&&b0.bbox){b0.bbox.x+=+bN;b0.bbox.y+=+bM}else{b0.dirtyT=1}},l=function(d){var b=d[0];switch(b.toLowerCase()){case"t":return[b,0,0];case"m":return[b,1,0,0,1,0,0];case"r":if(d.length==4){return[b,0,d[2],d[3]]}else{return[b,0]}case"s":if(d.length==5){return[b,1,1,d[3],d[4]]}else{if(d.length==3){return[b,1,1]}else{return[b,1]}}}},aB=aR._equaliseTransform=function(R,E){E=bH(E).replace(/\.{3}|\u2026/g,R);R=aR.parseTransformString(R)||[];E=aR.parseTransformString(E)||[];var b=m(R.length,E.length),bN=[],bO=[],g=0,d,S,bM,bL;for(;g<b;g++){bM=R[g]||l(E[g]);bL=E[g]||l(bM);if((bM[0]!=bL[0])||(bM[0].toLowerCase()=="r"&&(bM[2]!=bL[2]||bM[3]!=bL[3]))||(bM[0].toLowerCase()=="s"&&(bM[3]!=bL[3]||bM[4]!=bL[4]))){return}bN[g]=[];bO[g]=[];for(d=0,S=m(bM.length,bL.length);d<S;d++){d in bM&&(bN[g][d]=bM[d]);d in bL&&(bO[g][d]=bL[d])}}return{from:bN,to:bO}};aR._getContainer=function(b,E,g,i){var d;d=i==null&&!aR.is(b,"object")?aA.doc.getElementById(b):b;if(d==null){return}if(d.tagName){if(E==null){return{container:d,width:d.style.pixelWidth||d.offsetWidth,height:d.style.pixelHeight||d.offsetHeight}}else{return{container:d,width:E,height:g}}}return{container:1,x:b,y:E,width:g,height:i}};aR.pathToRelative=aC;aR._engine={};aR.path2curve=W;aR.matrix=function(i,g,bL,S,R,E){return new aF(i,g,bL,S,R,E)};function aF(i,g,bL,S,R,E){if(i!=null){this.a=+i;this.b=+g;this.c=+bL;this.d=+S;this.e=+R;this.f=+E}else{this.a=1;this.b=0;this.c=0;this.d=1;this.e=0;this.f=0}}(function(g){g.add=function(bT,bQ,bO,bM,S,R){var E=[[],[],[]],i=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],bS=[[bT,bO,S],[bQ,bM,R],[0,0,1]],bR,bP,bN,bL;if(bT&&bT instanceof aF){bS=[[bT.a,bT.c,bT.e],[bT.b,bT.d,bT.f],[0,0,1]]}for(bR=0;bR<3;bR++){for(bP=0;bP<3;bP++){bL=0;for(bN=0;bN<3;bN++){bL+=i[bR][bN]*bS[bN][bP]}E[bR][bP]=bL}}this.a=E[0][0];this.b=E[1][0];this.c=E[0][1];this.d=E[1][1];this.e=E[0][2];this.f=E[1][2]};g.invert=function(){var E=this,i=E.a*E.d-E.b*E.c;return new aF(E.d/i,-E.b/i,-E.c/i,E.a/i,(E.c*E.f-E.d*E.e)/i,(E.b*E.e-E.a*E.f)/i)};g.clone=function(){return new aF(this.a,this.b,this.c,this.d,this.e,this.f)};g.translate=function(i,E){this.add(1,0,0,1,i,E)};g.scale=function(E,S,i,R){S==null&&(S=E);(i||R)&&this.add(1,0,0,1,i,R);this.add(E,0,0,S,0,0);(i||R)&&this.add(1,0,0,1,-i,-R)};g.rotate=function(E,i,bL){E=aR.rad(E);i=i||0;bL=bL||0;var S=+au.cos(E).toFixed(9),R=+au.sin(E).toFixed(9);this.add(S,R,-R,S,i,bL);this.add(1,0,0,1,-i,-bL)};g.x=function(i,E){return i*this.a+E*this.c+this.e};g.y=function(i,E){return i*this.b+E*this.d+this.f};g.get=function(E){return +this[bH.fromCharCode(97+E)].toFixed(4)};g.toString=function(){return aR.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()};g.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"};g.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]};function d(i){return i[0]*i[0]+i[1]*i[1]}function b(i){var E=au.sqrt(d(i));i[0]&&(i[0]/=E);i[1]&&(i[1]/=E)}g.split=function(){var E={};E.dx=this.e;E.dy=this.f;var S=[[this.a,this.c],[this.b,this.d]];E.scalex=au.sqrt(d(S[0]));b(S[0]);E.shear=S[0][0]*S[1][0]+S[0][1]*S[1][1];S[1]=[S[1][0]-S[0][0]*E.shear,S[1][1]-S[0][1]*E.shear];E.scaley=au.sqrt(d(S[1]));b(S[1]);E.shear/=E.scaley;var i=-S[0][1],R=S[1][1];if(R<0){E.rotate=aR.deg(au.acos(R));if(i<0){E.rotate=360-E.rotate}}else{E.rotate=aR.deg(au.asin(i))}E.isSimple=!+E.shear.toFixed(9)&&(E.scalex.toFixed(9)==E.scaley.toFixed(9)||!E.rotate);E.isSuperSimple=!+E.shear.toFixed(9)&&E.scalex.toFixed(9)==E.scaley.toFixed(9)&&!E.rotate;E.noRotation=!+E.shear.toFixed(9)&&!E.rotate;return E};g.toTransformString=function(i){var E=i||this[F]();if(E.isSimple){E.scalex=+E.scalex.toFixed(4);E.scaley=+E.scaley.toFixed(4);E.rotate=+E.rotate.toFixed(4);return(E.dx||E.dy?"t"+[E.dx,E.dy]:aX)+(E.scalex!=1||E.scaley!=1?"s"+[E.scalex,E.scaley,0,0]:aX)+(E.rotate?"r"+[E.rotate,0,0]:aX)}else{return"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}})(aF.prototype);var V=navigator.userAgent.match(/Version\/(.*?)\s/)||navigator.userAgent.match(/Chrome\/(\d+)/);if((navigator.vendor=="Apple Computer, Inc.")&&(V&&V[1]<4||navigator.platform.slice(0,2)=="iP")||(navigator.vendor=="Google Inc."&&V&&V[1]<8)){a4.safari=function(){var b=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});setTimeout(function(){b.remove()})}}else{a4.safari=I}var P=function(){this.returnValue=false},bD=function(){return this.originalEvent.preventDefault()},a8=function(){this.cancelBubble=true},aJ=function(){return this.originalEvent.stopPropagation()},aD=(function(){if(aA.doc.addEventListener){return function(R,i,g,d){var b=Z&&bx[i]?bx[i]:i,E=function(bP){var bO=aA.doc.documentElement.scrollTop||aA.doc.body.scrollTop,bQ=aA.doc.documentElement.scrollLeft||aA.doc.body.scrollLeft,S=bP.clientX+bQ,bR=bP.clientY+bO;if(Z&&bx[ak](i)){for(var bM=0,bN=bP.targetTouches&&bP.targetTouches.length;bM<bN;bM++){if(bP.targetTouches[bM].target==R){var bL=bP;bP=bP.targetTouches[bM];bP.originalEvent=bL;bP.preventDefault=bD;bP.stopPropagation=aJ;break}}}return g.call(d,bP,S,bR)};R.addEventListener(b,E,false);return function(){R.removeEventListener(b,E,false);return true}}}else{if(aA.doc.attachEvent){return function(R,i,g,d){var E=function(bM){bM=bM||aA.win.event;var bL=aA.doc.documentElement.scrollTop||aA.doc.body.scrollTop,bN=aA.doc.documentElement.scrollLeft||aA.doc.body.scrollLeft,S=bM.clientX+bN,bO=bM.clientY+bL;bM.preventDefault=bM.preventDefault||P;bM.stopPropagation=bM.stopPropagation||a8;return g.call(d,bM,S,bO)};R.attachEvent("on"+i,E);var b=function(){R.detachEvent("on"+i,E);return true};return b}}}})(),be=[],by=function(bM){var bP=bM.clientX,bO=bM.clientY,bR=aA.doc.documentElement.scrollTop||aA.doc.body.scrollTop,bS=aA.doc.documentElement.scrollLeft||aA.doc.body.scrollLeft,g,E=be.length;while(E--){g=be[E];if(Z){var S=bM.touches.length,R;while(S--){R=bM.touches[S];if(R.identifier==g.el._drag.id){bP=R.clientX;bO=R.clientY;(bM.originalEvent?bM.originalEvent:bM).preventDefault();break}}}else{bM.preventDefault()}var d=g.el.node,b,bL=d.nextSibling,bQ=d.parentNode,bN=d.style.display;aA.win.opera&&bQ.removeChild(d);d.style.display="none";b=g.el.paper.getElementByPoint(bP,bO);d.style.display=bN;aA.win.opera&&(bL?bQ.insertBefore(d,bL):bQ.appendChild(d));b&&eve("raphael.drag.over."+g.el.id,g.el,b);bP+=bS;bO+=bR;eve("raphael.drag.move."+g.el.id,g.move_scope||g.el,bP-g.el._drag.x,bO-g.el._drag.y,bP,bO,bM)}},e=function(g){aR.unmousemove(by).unmouseup(e);var d=be.length,b;while(d--){b=be[d];b.el._drag={};eve("raphael.drag.end."+b.el.id,b.end_scope||b.start_scope||b.move_scope||b.el,g)}be=[]},bh=aR.el={};for(var ax=Q.length;ax--;){(function(b){aR[b]=bh[b]=function(g,d){if(aR.is(g,"function")){this.events=this.events||[];this.events.push({name:b,f:g,unbind:aD(this.shape||this.node||aA.doc,b,g,d||this)})}return this};aR["un"+b]=bh["un"+b]=function(i){var g=this.events||[],d=g.length;while(d--){if(g[d].name==b&&g[d].f==i){g[d].unbind();g.splice(d,1);!g.length&&delete this.events;return this}}return this}})(Q[ax])}bh.data=function(d,E){var g=aU[this.id]=aU[this.id]||{};if(arguments.length==1){if(aR.is(d,"object")){for(var b in d){if(d[ak](b)){this.data(b,d[b])}}return this}eve("raphael.data.get."+this.id,this,g[d],d);return g[d]}g[d]=E;eve("raphael.data.set."+this.id,this,E,d);return this};bh.removeData=function(b){if(b==null){aU[this.id]={}}else{aU[this.id]&&delete aU[this.id][b]}return this};bh.hover=function(i,b,g,d){return this.mouseover(i,g).mouseout(b,d||g)};bh.unhover=function(d,b){return this.unmouseover(d).unmouseout(b)};var bu=[];bh.drag=function(d,R,E,b,g,i){function S(bM){(bM.originalEvent||bM).preventDefault();var bL=aA.doc.documentElement.scrollTop||aA.doc.body.scrollTop,bN=aA.doc.documentElement.scrollLeft||aA.doc.body.scrollLeft;this._drag.x=bM.clientX+bN;this._drag.y=bM.clientY+bL;this._drag.id=bM.identifier;!be.length&&aR.mousemove(by).mouseup(e);be.push({el:this,move_scope:b,start_scope:g,end_scope:i});R&&eve.on("raphael.drag.start."+this.id,R);d&&eve.on("raphael.drag.move."+this.id,d);E&&eve.on("raphael.drag.end."+this.id,E);eve("raphael.drag.start."+this.id,g||b||this,bM.clientX+bN,bM.clientY+bL,bM)}this._drag={};bu.push({el:this,start:S});this.mousedown(S);return this};bh.onDragOver=function(b){b?eve.on("raphael.drag.over."+this.id,b):eve.unbind("raphael.drag.over."+this.id)};bh.undrag=function(){var b=bu.length;while(b--){if(bu[b].el==this){this.unmousedown(bu[b].start);bu.splice(b,1);eve.unbind("raphael.drag.*."+this.id)}}!bu.length&&aR.unmousemove(by).unmouseup(e)};a4.circle=function(b,i,g){var d=aR._engine.circle(this,b||0,i||0,g||0);this.__set__&&this.__set__.push(d);return d};a4.rect=function(b,R,d,i,E){var g=aR._engine.rect(this,b||0,R||0,d||0,i||0,E||0);this.__set__&&this.__set__.push(g);return g};a4.ellipse=function(b,E,i,g){var d=aR._engine.ellipse(this,b||0,E||0,i||0,g||0);this.__set__&&this.__set__.push(d);return d};a4.path=function(b){b&&!aR.is(b,aj)&&!aR.is(b[0],bd)&&(b+=aX);var d=aR._engine.path(aR.format[bG](aR,arguments),this);this.__set__&&this.__set__.push(d);return d};a4.image=function(E,b,R,d,i){var g=aR._engine.image(this,E||"about:blank",b||0,R||0,d||0,i||0);this.__set__&&this.__set__.push(g);return g};a4.text=function(b,i,g){var d=aR._engine.text(this,b||0,i||0,bH(g));this.__set__&&this.__set__.push(d);return d};a4.set=function(d){!aR.is(d,"array")&&(d=Array.prototype.splice.call(arguments,0,arguments.length));var b=new al(d);this.__set__&&this.__set__.push(b);return b};a4.setStart=function(b){this.__set__=b||this.set()};a4.setFinish=function(d){var b=this.__set__;delete this.__set__;return b};a4.setSize=function(d,b){return aR._engine.setSize.call(this,d,b)};a4.setViewBox=function(b,E,d,i,g){return aR._engine.setViewBox.call(this,b,E,d,i,g)};a4.top=a4.bottom=null;a4.raphael=aR;var bs=function(g){var E=g.getBoundingClientRect(),bM=g.ownerDocument,R=bM.body,b=bM.documentElement,i=b.clientTop||R.clientTop||0,S=b.clientLeft||R.clientLeft||0,bL=E.top+(aA.win.pageYOffset||b.scrollTop||R.scrollTop)-i,d=E.left+(aA.win.pageXOffset||b.scrollLeft||R.scrollLeft)-S;return{y:bL,x:d}};a4.getElementByPoint=function(d,bL){var S=this,g=S.canvas,R=aA.doc.elementFromPoint(d,bL);if(aA.win.opera&&R.tagName=="svg"){var E=bs(g),i=g.createSVGRect();i.x=d-E.x;i.y=bL-E.y;i.width=i.height=1;var b=g.getIntersectionList(i,null);if(b.length){R=b[b.length-1]}}if(!R){return null}while(R.parentNode&&R!=g.parentNode&&!R.raphael){R=R.parentNode}R==S.canvas.parentNode&&(R=g);R=R&&R.raphael?S.getById(R.raphaelid):null;return R};a4.getById=function(d){var b=this.bottom;while(b){if(b.id==d){return b}b=b.next}return null};a4.forEach=function(g,b){var d=this.bottom;while(d){if(g.call(b,d)===false){return this}d=d.next}return this};a4.getElementsByPoint=function(b,g){var d=this.set();this.forEach(function(i){if(i.isPointInside(b,g)){d.push(i)}});return d};function y(){return this.x+aQ+this.y}function at(){return this.x+aQ+this.y+aQ+this.width+" \xd7 "+this.height}bh.isPointInside=function(b,g){var d=this.realPath=this.realPath||N[this.type](this);return aR.isPointInsidePath(d,b,g)};bh.getBBox=function(d){if(this.removed){return{}}var b=this._;if(d){if(b.dirty||!b.bboxwt){this.realPath=N[this.type](this);b.bboxwt=am(this.realPath);b.bboxwt.toString=at;b.dirty=0}return b.bboxwt}if(b.dirty||b.dirtyT||!b.bbox){if(b.dirty||!this.realPath){b.bboxwt=0;this.realPath=N[this.type](this)}b.bbox=am(L(this.realPath,this.matrix));b.bbox.toString=at;b.dirty=b.dirtyT=0}return b.bbox};bh.clone=function(){if(this.removed){return null}var b=this.paper[this.type]().attr(this.attr());this.__set__&&this.__set__.push(b);return b};bh.glow=function(bL){if(this.type=="text"){return null}bL=bL||{};var g={width:(bL.width||10)+(+this.attr("stroke-width")||1),fill:bL.fill||false,opacity:bL.opacity||0.5,offsetx:bL.offsetx||0,offsety:bL.offsety||0,color:bL.color||"#000"},S=g.width/2,E=this.paper,b=E.set(),R=this.realPath||N[this.type](this);R=this.matrix?L(R,this.matrix):R;for(var d=1;d<S+1;d++){b.push(E.path(R).attr({stroke:g.color,fill:g.fill?g.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(g.width/S*d).toFixed(3),opacity:+(g.opacity/S).toFixed(3)}))}return b.insertBefore(this).translate(g.offsetx,g.offsety)};var a7={},k=function(d,b,E,i,bM,bL,S,R,g){if(g==null){return q(d,b,E,i,bM,bL,S,R)}else{return aR.findDotsAtSegment(d,b,E,i,bM,bL,S,R,C(d,b,E,i,bM,bL,S,R,g))}},a6=function(b,d){return function(bT,R,S){bT=W(bT);var bP,bO,g,bL,E="",bS={},bQ,bN=0;for(var bM=0,bR=bT.length;bM<bR;bM++){g=bT[bM];if(g[0]=="M"){bP=+g[1];bO=+g[2]}else{bL=k(bP,bO,g[1],g[2],g[3],g[4],g[5],g[6]);if(bN+bL>R){if(d&&!bS.start){bQ=k(bP,bO,g[1],g[2],g[3],g[4],g[5],g[6],R-bN);E+=["C"+bQ.start.x,bQ.start.y,bQ.m.x,bQ.m.y,bQ.x,bQ.y];if(S){return E}bS.start=E;E=["M"+bQ.x,bQ.y+"C"+bQ.n.x,bQ.n.y,bQ.end.x,bQ.end.y,g[5],g[6]].join();bN+=bL;bP=+g[5];bO=+g[6];continue}if(!b&&!d){bQ=k(bP,bO,g[1],g[2],g[3],g[4],g[5],g[6],R-bN);return{x:bQ.x,y:bQ.y,alpha:bQ.alpha}}}bN+=bL;bP=+g[5];bO=+g[6]}E+=g.shift()+g}bS.end=E;bQ=b?bN:d?bS:aR.findDotsAtSegment(bP,bO,g[0],g[1],g[2],g[3],g[4],g[5],1);bQ.alpha&&(bQ={x:bQ.x,y:bQ.y,alpha:bQ.alpha});return bQ}};var aS=a6(1),J=a6(),ad=a6(0,1);aR.getTotalLength=aS;aR.getPointAtLength=J;aR.getSubpath=function(d,i,g){if(this.getTotalLength(d)-g<0.000001){return ad(d,i).end}var b=ad(d,g,1);return i?ad(b,i).end:b};bh.getTotalLength=function(){if(this.type!="path"){return}if(this.node.getTotalLength){return this.node.getTotalLength()}return aS(this.attrs.path)};bh.getPointAtLength=function(b){if(this.type!="path"){return}return J(this.attrs.path,b)};bh.getSubpath=function(d,b){if(this.type!="path"){return}return aR.getSubpath(this.attrs.path,d,b)};var o=aR.easing_formulas={linear:function(b){return b},"<":function(b){return bp(b,1.7)},">":function(b){return bp(b,0.48)},"<>":function(bL){var i=0.48-bL/1.04,g=au.sqrt(0.1734+i*i),b=g-i,S=bp(aw(b),1/3)*(b<0?-1:1),R=-g-i,E=bp(aw(R),1/3)*(R<0?-1:1),d=S+E+0.5;return(1-d)*3*d*d+d*d*d},backIn:function(d){var b=1.70158;return d*d*((b+1)*d-b)},backOut:function(d){d=d-1;var b=1.70158;return d*d*((b+1)*d+b)+1},elastic:function(b){if(b==!!b){return b}return bp(2,-10*b)*au.sin((b-0.075)*(2*aV)/0.3)+1},bounce:function(i){var d=7.5625,g=2.75,b;if(i<(1/g)){b=d*i*i}else{if(i<(2/g)){i-=(1.5/g);b=d*i*i+0.75}else{if(i<(2.5/g)){i-=(2.25/g);b=d*i*i+0.9375}else{i-=(2.625/g);b=d*i*i+0.984375}}}return b}};o.easeIn=o["ease-in"]=o["<"];o.easeOut=o["ease-out"]=o[">"];o.easeInOut=o["ease-in-out"]=o["<>"];o["back-in"]=o.backIn;o["back-out"]=o.backOut;var ab=[],aN=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(b){setTimeout(b,16)},bC=function(){var bL=+new Date,bT=0;for(;bT<ab.length;bT++){var bZ=ab[bT];if(bZ.el.removed||bZ.paused){continue}var E=bL-bZ.start,bR=bZ.ms,bQ=bZ.easing,bU=bZ.from,bO=bZ.diff,d=bZ.to,bN=bZ.t,S=bZ.el,bP={},b,bX={},b1;if(bZ.initstatus){E=(bZ.initstatus*bZ.anim.top-bZ.prev)/(bZ.percent-bZ.prev)*bR;bZ.status=bZ.initstatus;delete bZ.initstatus;bZ.stop&&ab.splice(bT--,1)}else{bZ.status=(bZ.prev+(bZ.percent-bZ.prev)*(E/bR))/bZ.anim.top}if(E<0){continue}if(E<bR){var g=bQ(E/bR);for(var bS in bU){if(bU[ak](bS)){switch(ar[bS]){case aL:b=+bU[bS]+g*bR*bO[bS];break;case"colour":b="rgb("+[H(ah(bU[bS].r+g*bR*bO[bS].r)),H(ah(bU[bS].g+g*bR*bO[bS].g)),H(ah(bU[bS].b+g*bR*bO[bS].b))].join(",")+")";break;case"path":b=[];for(var bW=0,bM=bU[bS].length;bW<bM;bW++){b[bW]=[bU[bS][bW][0]];for(var bV=1,bY=bU[bS][bW].length;bV<bY;bV++){b[bW][bV]=+bU[bS][bW][bV]+g*bR*bO[bS][bW][bV]}b[bW]=b[bW].join(aQ)}b=b.join(aQ);break;case"transform":if(bO[bS].real){b=[];for(bW=0,bM=bU[bS].length;bW<bM;bW++){b[bW]=[bU[bS][bW][0]];for(bV=1,bY=bU[bS][bW].length;bV<bY;bV++){b[bW][bV]=bU[bS][bW][bV]+g*bR*bO[bS][bW][bV]}}}else{var b0=function(b2){return +bU[bS][b2]+g*bR*bO[bS][b2]};b=[["m",b0(0),b0(1),b0(2),b0(3),b0(4),b0(5)]]}break;case"csv":if(bS=="clip-rect"){b=[];bW=4;while(bW--){b[bW]=+bU[bS][bW]+g*bR*bO[bS][bW]}}break;default:var R=[][bE](bU[bS]);b=[];bW=S.paper.customAttributes[bS].length;while(bW--){b[bW]=+R[bW]+g*bR*bO[bS][bW]}break}bP[bS]=b}}S.attr(bP);(function(b3,i,b2){setTimeout(function(){eve("raphael.anim.frame."+b3,i,b2)})})(S.id,S,bZ.anim)}else{(function(b3,b2,i){setTimeout(function(){eve("raphael.anim.frame."+b2.id,b2,i);eve("raphael.anim.finish."+b2.id,b2,i);aR.is(b3,"function")&&b3.call(b2)})})(bZ.callback,S,bZ.anim);S.attr(d);ab.splice(bT--,1);if(bZ.repeat>1&&!bZ.next){for(b1 in d){if(d[ak](b1)){bX[b1]=bZ.totalOrigin[b1]}}bZ.el.attr(bX);aM(bZ.anim,bZ.el,bZ.anim.percents[0],null,bZ.totalOrigin,bZ.repeat-1)}if(bZ.next&&!bZ.stop){aM(bZ.anim,bZ.el,bZ.next,null,bZ.totalOrigin,bZ.repeat)}}}aR.svg&&S&&S.paper&&S.paper.safari();ab.length&&aN(bC)},H=function(b){return b>255?255:b<0?0:b};bh.animateWith=function(d,E,g,b,bL,bQ){var S=this;if(S.removed){bQ&&bQ.call(S);return S}var bO=g instanceof bA?g:aR.animation(g,b,bL,bQ),bN,bM;aM(bO,S,bO.percents[0],null,S.attr());for(var R=0,bP=ab.length;R<bP;R++){if(ab[R].anim==E&&ab[R].el==d){ab[bP-1].start=ab[R].start;break}}return S};function a3(bR,i,d,bQ,bP,bL){var bM=3*i,bO=3*(bQ-i)-bM,b=1-bM-bO,S=3*d,bN=3*(bP-d)-S,bS=1-S-bN;function R(bT){return((b*bT+bO)*bT+bM)*bT}function g(bT,bV){var bU=E(bT,bV);return((bS*bU+bN)*bU+S)*bU}function E(bT,b0){var bZ,bY,bW,bU,bX,bV;for(bW=bT,bV=0;bV<8;bV++){bU=R(bW)-bT;if(aw(bU)<b0){return bW}bX=(3*b*bW+2*bO)*bW+bM;if(aw(bX)<0.000001){break}bW=bW-bU/bX}bZ=0;bY=1;bW=bT;if(bW<bZ){return bZ}if(bW>bY){return bY}while(bZ<bY){bU=R(bW);if(aw(bU-bT)<b0){return bW}if(bT>bU){bZ=bW}else{bY=bW}bW=(bY-bZ)/2+bZ}return bW}return g(bR,1/(200*bL))}bh.onAnimation=function(b){b?eve.on("raphael.anim.frame."+this.id,b):eve.unbind("raphael.anim.frame."+this.id);return this};function bA(E,g){var d=[],i={};this.ms=g;this.times=1;if(E){for(var b in E){if(E[ak](b)){i[an(b)]=E[b];d.push(an(b))}}d.sort(u)}this.anim=i;this.top=d[d.length-1];this.percents=d}bA.prototype.delay=function(d){var b=new bA(this.anim,this.ms);b.times=this.times;b.del=+d||0;return b};bA.prototype.repeat=function(d){var b=new bA(this.anim,this.ms);b.del=this.del;b.times=au.floor(m(d,0))||1;return b};function aM(b3,g,b,b1,bL,bP){b=an(b);var ca,S,bO,cb=[],bV,bU,R,bX=b3.ms,b2={},E={},bR={};if(b1){for(b6=0,bQ=ab.length;b6<bQ;b6++){var b8=ab[b6];if(b8.el.id==g.id&&b8.anim==b3){if(b8.percent!=b){ab.splice(b6,1);bO=1}else{S=b8}g.attr(b8.totalOrigin);break}}}else{b1=+E}for(var b6=0,bQ=b3.percents.length;b6<bQ;b6++){if(b3.percents[b6]==b||b3.percents[b6]>b1*b3.top){b=b3.percents[b6];bU=b3.percents[b6-1]||0;bX=bX/b3.top*(b-bU);bV=b3.percents[b6+1];ca=b3.anim[b];break}else{if(b1){g.attr(b3.anim[b3.percents[b6]])}}}if(!ca){return}if(!S){for(var bZ in ca){if(ca[ak](bZ)){if(ar[ak](bZ)||g.paper.customAttributes[ak](bZ)){b2[bZ]=g.attr(bZ);(b2[bZ]==null)&&(b2[bZ]=r[bZ]);E[bZ]=ca[bZ];switch(ar[bZ]){case aL:bR[bZ]=(E[bZ]-b2[bZ])/bX;break;case"colour":b2[bZ]=aR.getRGB(b2[bZ]);var b0=aR.getRGB(E[bZ]);bR[bZ]={r:(b0.r-b2[bZ].r)/bX,g:(b0.g-b2[bZ].g)/bX,b:(b0.b-b2[bZ].b)/bX};break;case"path":var bM=W(b2[bZ],E[bZ]),bT=bM[1];b2[bZ]=bM[0];bR[bZ]=[];for(b6=0,bQ=b2[bZ].length;b6<bQ;b6++){bR[bZ][b6]=[0];for(var b5=1,b7=b2[bZ][b6].length;b5<b7;b5++){bR[bZ][b6][b5]=(bT[b6][b5]-b2[bZ][b6][b5])/bX}}break;case"transform":var cd=g._,cc=aB(cd[bZ],E[bZ]);if(cc){b2[bZ]=cc.from;E[bZ]=cc.to;bR[bZ]=[];bR[bZ].real=true;for(b6=0,bQ=b2[bZ].length;b6<bQ;b6++){bR[bZ][b6]=[b2[bZ][b6][0]];for(b5=1,b7=b2[bZ][b6].length;b5<b7;b5++){bR[bZ][b6][b5]=(E[bZ][b6][b5]-b2[bZ][b6][b5])/bX}}}else{var bY=(g.matrix||new aF),b9={_:{transform:cd.transform},getBBox:function(){return g.getBBox(1)}};b2[bZ]=[bY.a,bY.b,bY.c,bY.d,bY.e,bY.f];aO(b9,E[bZ]);E[bZ]=b9._.transform;bR[bZ]=[(b9.matrix.a-bY.a)/bX,(b9.matrix.b-bY.b)/bX,(b9.matrix.c-bY.c)/bX,(b9.matrix.d-bY.d)/bX,(b9.matrix.e-bY.e)/bX,(b9.matrix.f-bY.f)/bX]}break;case"csv":var d=bH(ca[bZ])[F](a),bN=bH(b2[bZ])[F](a);if(bZ=="clip-rect"){b2[bZ]=bN;bR[bZ]=[];b6=bN.length;while(b6--){bR[bZ][b6]=(d[b6]-b2[bZ][b6])/bX}}E[bZ]=d;break;default:d=[][bE](ca[bZ]);bN=[][bE](b2[bZ]);bR[bZ]=[];b6=g.paper.customAttributes[bZ].length;while(b6--){bR[bZ][b6]=((d[b6]||0)-(bN[b6]||0))/bX}break}}}}var bW=ca.easing,b4=aR.easing_formulas[bW];if(!b4){b4=bH(bW).match(c);if(b4&&b4.length==5){var bS=b4;b4=function(i){return a3(i,+bS[1],+bS[2],+bS[3],+bS[4],bX)}}else{b4=bB}}R=ca.start||b3.start||+new Date;b8={anim:b3,percent:b,timestamp:R,start:R+(b3.del||0),status:0,initstatus:b1||0,stop:false,ms:bX,easing:b4,from:b2,diff:bR,to:E,el:g,callback:ca.callback,prev:bU,next:bV,repeat:bP||b3.times,origin:g.attr(),totalOrigin:bL};ab.push(b8);if(b1&&!S&&!bO){b8.stop=true;b8.start=new Date-bX*b1;if(ab.length==1){return bC()}}if(bO){b8.start=new Date-b8.ms*b1}ab.length==1&&aN(bC)}else{S.initstatus=b1;S.start=new Date-S.ms*b1}eve("raphael.anim.start."+g.id,g,b3)}aR.animation=function(E,d,S,R){if(E instanceof bA){return E}if(aR.is(S,"function")||!S){R=R||S||null;S=null}E=Object(E);d=+d||0;var i={},g,b;for(b in E){if(E[ak](b)&&an(b)!=b&&an(b)+"%"!=b){g=true;i[b]=E[b]}}if(!g){return new bA(E,d)}else{S&&(i.easing=S);R&&(i.callback=R);return new bA({100:i},d)}};bh.animate=function(i,b,R,E){var d=this;if(d.removed){E&&E.call(d);return d}var g=i instanceof bA?i:aR.animation(i,b,R,E);aM(g,d,g.percents[0],null,d.attr());return d};bh.setTime=function(d,b){if(d&&b!=null){this.status(d,bm(b,d.ms)/d.ms)}return this};bh.status=function(R,E){var d=[],g=0,b,S;if(E!=null){aM(R,this,-1,bm(E,1));return this}else{b=ab.length;for(;g<b;g++){S=ab[g];if(S.el.id==this.id&&(!R||S.anim==R)){if(R){return S.status}d.push({anim:S.anim,status:S.status})}}if(R){return 0}return d}};bh.pause=function(d){for(var b=0;b<ab.length;b++){if(ab[b].el.id==this.id&&(!d||ab[b].anim==d)){if(eve("raphael.anim.pause."+this.id,this,ab[b].anim)!==false){ab[b].paused=true}}}return this};bh.resume=function(d){for(var b=0;b<ab.length;b++){if(ab[b].el.id==this.id&&(!d||ab[b].anim==d)){var g=ab[b];if(eve("raphael.anim.resume."+this.id,this,g.anim)!==false){delete g.paused;this.status(g.anim,g.status)}}}return this};bh.stop=function(d){for(var b=0;b<ab.length;b++){if(ab[b].el.id==this.id&&(!d||ab[b].anim==d)){if(eve("raphael.anim.stop."+this.id,this,ab[b].anim)!==false){ab.splice(b--,1)}}}return this};function aa(d){for(var b=0;b<ab.length;b++){if(ab[b].el.paper==d){ab.splice(b--,1)}}}eve.on("raphael.remove",aa);eve.on("raphael.clear",aa);bh.toString=function(){return"Rapha\xebl\u2019s object"};var al=function(b){this.items=[];this.length=0;this.type="set";if(b){for(var d=0,g=b.length;d<g;d++){if(b[d]&&(b[d].constructor==bh.constructor||b[d].constructor==al)){this[this.items.length]=this.items[this.items.length]=b[d];this.length++}}}},bc=al.prototype;bc.push=function(){var E,b;for(var d=0,g=arguments.length;d<g;d++){E=arguments[d];if(E&&(E.constructor==bh.constructor||E.constructor==al)){b=this.items.length;this[b]=this.items[b]=E;this.length++}}return this};bc.pop=function(){this.length&&delete this[this.length--];return this.items.pop()};bc.forEach=function(E,b){for(var d=0,g=this.items.length;d<g;d++){if(E.call(b,this.items[d],d)===false){return this}}return this};for(var B in bh){if(bh[ak](B)){bc[B]=(function(b){return function(){var d=arguments;return this.forEach(function(g){g[b][bG](g,d)})}})(B)}}bc.attr=function(d,S){if(d&&aR.is(d,bd)&&aR.is(d[0],"object")){for(var b=0,R=d.length;b<R;b++){this.items[b].attr(d[b])}}else{for(var g=0,E=this.items.length;g<E;g++){this.items[g].attr(d,S)}}return this};bc.clear=function(){while(this.length){this.pop()}};bc.splice=function(E,bL,bM){E=E<0?m(this.length+E,0):E;bL=m(0,bm(this.length-E,bL));var g=[],b=[],d=[],R;for(R=2;R<arguments.length;R++){d.push(arguments[R])}for(R=0;R<bL;R++){b.push(this[E+R])}for(;R<this.length-E;R++){g.push(this[E+R])}var S=d.length;for(R=0;R<S+g.length;R++){this.items[E+R]=this[E+R]=R<S?d[R]:g[R-S]}R=this.items.length=this.length-=bL-S;while(this[R]){delete this[R++]}return new al(b)};bc.exclude=function(g){for(var b=0,d=this.length;b<d;b++){if(this[b]==g){this.splice(b,1);return true}}};bc.animate=function(g,b,bL,bN){(aR.is(bL,"function")||!bL)&&(bN=bL||null);var S=this.items.length,E=S,bO,bM=this,R;if(!S){return this}bN&&(R=function(){!--S&&bN.call(bM)});bL=aR.is(bL,aj)?bL:R;var d=aR.animation(g,b,bL,R);bO=this.items[--E].animate(d);while(E--){this.items[E]&&!this.items[E].removed&&this.items[E].animateWith(bO,d,d)}return this};bc.insertAfter=function(d){var b=this.items.length;while(b--){this.items[b].insertAfter(d)}return this};bc.getBBox=function(){var b=[],S=[],d=[],E=[];for(var g=this.items.length;g--;){if(!this.items[g].removed){var R=this.items[g].getBBox();b.push(R.x);S.push(R.y);d.push(R.x+R.width);E.push(R.y+R.height)}}b=bm[bG](0,b);S=bm[bG](0,S);d=m[bG](0,d);E=m[bG](0,E);return{x:b,y:S,x2:d,y2:E,width:d-b,height:E-S}};bc.clone=function(g){g=new al;for(var b=0,d=this.items.length;b<d;b++){g.push(this.items[b].clone())}return g};bc.toString=function(){return"Rapha\xebl\u2018s set"};aR.registerFont=function(d){if(!d.face){return d}this.fonts=this.fonts||{};var i={w:d.w,face:{},glyphs:{}},g=d.face["font-family"];for(var S in d.face){if(d.face[ak](S)){i.face[S]=d.face[S]}}if(this.fonts[g]){this.fonts[g].push(i)}else{this.fonts[g]=[i]}if(!d.svg){i.face["units-per-em"]=U(d.face["units-per-em"],10);for(var E in d.glyphs){if(d.glyphs[ak](E)){var R=d.glyphs[E];i.glyphs[E]={w:R.w,k:{},d:R.d&&"M"+R.d.replace(/[mlcxtrv]/g,function(bL){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[bL]||"M"})+"z"};if(R.k){for(var b in R.k){if(R[ak](b)){i.glyphs[E].k[b]=R.k[b]}}}}}}return d};a4.getFont=function(bM,bN,d,E){E=E||"normal";d=d||"normal";bN=+bN||{normal:400,bold:700,lighter:300,bolder:800}[bN]||400;if(!aR.fonts){return}var R=aR.fonts[bM];if(!R){var g=new RegExp("(^|\\s)"+bM.replace(/[^\w\d\s+!~.:_-]/g,aX)+"(\\s|$)","i");for(var b in aR.fonts){if(aR.fonts[ak](b)){if(g.test(b)){R=aR.fonts[b];break}}}}var S;if(R){for(var bL=0,bO=R.length;bL<bO;bL++){S=R[bL];if(S.face["font-weight"]==bN&&(S.face["font-style"]==d||!S.face["font-style"])&&S.face["font-stretch"]==E){break}}}return S};a4.print=function(bL,S,b,bO,bP,bY,d){bY=bY||"middle";d=m(bm(d||0,1),-1);var bX=bH(b)[F](aX),bU=0,bW=0,bS=aX,bZ;aR.is(bO,b)&&(bO=this.getFont(bO));if(bO){bZ=(bP||16)/bO.face["units-per-em"];var E=bO.face.bbox[F](a),bN=+E[0],g=E[3]-E[1],R=0,bQ=+E[1]+(bY=="baseline"?g+(+bO.face.descent):g/2);for(var bT=0,bM=bX.length;bT<bM;bT++){if(bX[bT]=="\n"){bU=0;bV=0;bW=0;R+=g}else{var bR=bW&&bO.glyphs[bX[bT-1]]||{},bV=bO.glyphs[bX[bT]];bU+=bW?(bR.w||bO.w)+(bR.k&&bR.k[bX[bT]]||0)+(bO.w*d):0;bW=1}if(bV&&bV.d){bS+=aR.transformPath(bV.d,["t",bU*bZ,R*bZ,"s",bZ,bZ,bN,bQ,"t",(bL-bN)/bZ,(S-bQ)/bZ])}}}return this.path(bS).attr({fill:"#000",stroke:"none"})};a4.add=function(E){if(aR.is(E,"array")){var g=this.set(),d=0,R=E.length,b;for(;d<R;d++){b=E[d]||{};bw[ak](b.type)&&g.push(this[b.type]().attr(b))}}return g};aR.format=function(d,g){var b=aR.is(g,bd)?[0][bE](g):arguments;d&&aR.is(d,aj)&&b.length-1&&(d=d.replace(br,function(R,E){return b[++E]==null?aX:b[E]}));return d||aX};aR.fullfill=(function(){var g=/\{([^\}]+)\}/g,b=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,d=function(R,E,S){var i=S;E.replace(b,function(bN,bM,bL,bP,bO){bM=bM||bP;if(i){if(bM in i){i=i[bM]}typeof i=="function"&&bO&&(i=i())}});i=(i==null||i==S?R:i)+"";return i};return function(E,i){return String(E).replace(g,function(S,R){return d(S,R,i)})}})();aR.ninja=function(){s.was?(aA.win.Raphael=s.is):delete Raphael;return aR};aR.st=bc;(function(i,d,g){if(i.readyState==null&&i.addEventListener){i.addEventListener(d,g=function(){i.removeEventListener(d,g,false);i.readyState="complete"},false);i.readyState="loading"}function b(){(/in/).test(i.readyState)?setTimeout(b,9):aR.eve("raphael.DOMload")}b()})(document,"DOMContentLoaded");s.was?(aA.win.Raphael=aR):(Raphael=aR);eve.on("raphael.DOMload",function(){ao=true})})();window.Raphael.svg&&function(l){var d="hasOwnProperty",B=String,n=parseFloat,q=parseInt,f=Math,C=f.max,s=f.abs,h=f.pow,g=/[, ]+/,z=l.eve,r="",j=" ";var o="http://www.w3.org/1999/xlink",y={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},u={};l.toString=function(){return"Your browser supports SVG.\nYou are running Rapha\xebl "+this.version};var i=function(F,D){if(D){if(typeof F=="string"){F=i(F)}for(var E in D){if(D[d](E)){if(E.substring(0,6)=="xlink:"){F.setAttributeNS(o,E.substring(6),B(D[E]))}else{F.setAttribute(E,B(D[E]))}}}}else{F=l._g.doc.createElementNS("http://www.w3.org/2000/svg",F);F.style&&(F.style.webkitTapHighlightColor="rgba(0,0,0,0)")}return F},a=function(M,Q){var O="linear",E=M.id+Q,K=0.5,I=0.5,G=M.node,D=M.paper,S=G.style,F=l._g.doc.getElementById(E);if(!F){Q=B(Q).replace(l._radial_gradient,function(V,T,W){O="radial";if(T&&W){K=n(T);I=n(W);var U=((I>0.5)*2-1);h(K-0.5,2)+h(I-0.5,2)>0.25&&(I=f.sqrt(0.25-h(K-0.5,2))*U+0.5)&&I!=0.5&&(I=I.toFixed(5)-0.00001*U)}return r});Q=Q.split(/\s*\-\s*/);if(O=="linear"){var J=Q.shift();J=-n(J);if(isNaN(J)){return null}var H=[0,0,f.cos(l.rad(J)),f.sin(l.rad(J))],P=1/(C(s(H[2]),s(H[3]))||1);H[2]*=P;H[3]*=P;if(H[2]<0){H[0]=-H[2];H[2]=0}if(H[3]<0){H[1]=-H[3];H[3]=0}}var N=l._parseDots(Q);if(!N){return null}E=E.replace(/[\(\)\s,\xb0#]/g,"_");if(M.gradient&&E!=M.gradient.id){D.defs.removeChild(M.gradient);delete M.gradient}if(!M.gradient){F=i(O+"Gradient",{id:E});M.gradient=F;i(F,O=="radial"?{fx:K,fy:I}:{x1:H[0],y1:H[1],x2:H[2],y2:H[3],gradientTransform:M.matrix.invert()});D.defs.appendChild(F);for(var L=0,R=N.length;L<R;L++){F.appendChild(i("stop",{offset:N[L].offset?N[L].offset:L?"100%":"0%","stop-color":N[L].color||"#fff"}))}}}i(G,{fill:"url(#"+E+")",opacity:1,"fill-opacity":1});S.fill=r;S.opacity=1;S.fillOpacity=1;return 1},b=function(E){var D=E.getBBox(1);i(E.pattern,{patternTransform:E.matrix.invert()+" translate("+D.x+","+D.y+")"})},c=function(O,Q,J){if(O.type=="path"){var D=B(Q).toLowerCase().split("-"),N=O.paper,ab=J?"end":"start",S=O.node,P=O.attrs,I=P["stroke-width"],W=D.length,G="classic",V,F,L,T,R,K=3,X=3,M=5;while(W--){switch(D[W]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":G=D[W];break;case"wide":X=5;break;case"narrow":X=2;break;case"long":K=5;break;case"short":K=2;break}}if(G=="open"){K+=2;X+=2;M+=2;L=1;T=J?4:1;R={fill:"none",stroke:P.stroke}}else{T=L=K/2;R={fill:P.stroke,stroke:"none"}}if(O._.arrows){if(J){O._.arrows.endPath&&u[O._.arrows.endPath]--;O._.arrows.endMarker&&u[O._.arrows.endMarker]--}else{O._.arrows.startPath&&u[O._.arrows.startPath]--;O._.arrows.startMarker&&u[O._.arrows.startMarker]--}}else{O._.arrows={}}if(G!="none"){var E="raphael-marker-"+G,aa="raphael-marker-"+ab+G+K+X;if(!l._g.doc.getElementById(E)){N.defs.appendChild(i(i("path"),{"stroke-linecap":"round",d:y[G],id:E}));u[E]=1}else{u[E]++}var H=l._g.doc.getElementById(aa),U;if(!H){H=i(i("marker"),{id:aa,markerHeight:X,markerWidth:K,orient:"auto",refX:T,refY:X/2});U=i(i("use"),{"xlink:href":"#"+E,transform:(J?"rotate(180 "+K/2+" "+X/2+") ":r)+"scale("+K/M+","+X/M+")","stroke-width":(1/((K/M+X/M)/2)).toFixed(4)});H.appendChild(U);N.defs.appendChild(H);u[aa]=1}else{u[aa]++;U=H.getElementsByTagName("use")[0]}i(U,R);var Z=L*(G!="diamond"&&G!="oval");if(J){V=O._.arrows.startdx*I||0;F=l.getTotalLength(P.path)-Z*I}else{V=Z*I;F=l.getTotalLength(P.path)-(O._.arrows.enddx*I||0)}R={};R["marker-"+ab]="url(#"+aa+")";if(F||V){R.d=Raphael.getSubpath(P.path,V,F)}i(S,R);O._.arrows[ab+"Path"]=E;O._.arrows[ab+"Marker"]=aa;O._.arrows[ab+"dx"]=Z;O._.arrows[ab+"Type"]=G;O._.arrows[ab+"String"]=Q}else{if(J){V=O._.arrows.startdx*I||0;F=l.getTotalLength(P.path)-V}else{V=0;F=l.getTotalLength(P.path)-(O._.arrows.enddx*I||0)}O._.arrows[ab+"Path"]&&i(S,{d:Raphael.getSubpath(P.path,V,F)});delete O._.arrows[ab+"Path"];delete O._.arrows[ab+"Marker"];delete O._.arrows[ab+"dx"];delete O._.arrows[ab+"Type"];delete O._.arrows[ab+"String"]}for(R in u){if(u[d](R)&&!u[R]){var Y=l._g.doc.getElementById(R);Y&&Y.parentNode.removeChild(Y)}}}},v={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},k=function(J,H,I){H=v[B(H).toLowerCase()];if(H){var F=J.attrs["stroke-width"]||"1",D={round:F,square:F,butt:0}[J.attrs["stroke-linecap"]||I["stroke-linecap"]]||0,G=[],E=H.length;while(E--){G[E]=H[E]*F+((E%2)?1:-1)*D}i(J.node,{"stroke-dasharray":G.join(",")})}},w=function(O,W){var S=O.node,P=O.attrs,M=S.style.visibility;S.style.visibility="hidden";for(var R in W){if(W[d](R)){if(!l._availableAttrs[d](R)){continue}var Q=W[R];P[R]=Q;switch(R){case"blur":O.blur(Q);break;case"href":case"title":case"target":var U=S.parentNode;if(U.tagName.toLowerCase()!="a"){var H=i("a");U.insertBefore(H,S);H.appendChild(S);U=H}if(R=="target"){U.setAttributeNS(o,"show",Q=="blank"?"new":Q)}else{U.setAttributeNS(o,R,Q)}break;case"cursor":S.style.cursor=Q;break;case"transform":O.transform(Q);break;case"arrow-start":c(O,Q);break;case"arrow-end":c(O,Q,1);break;case"clip-rect":var E=B(Q).split(g);if(E.length==4){O.clip&&O.clip.parentNode.parentNode.removeChild(O.clip.parentNode);var F=i("clipPath"),T=i("rect");F.id=l.createUUID();i(T,{x:E[0],y:E[1],width:E[2],height:E[3]});F.appendChild(T);O.paper.defs.appendChild(F);i(S,{"clip-path":"url(#"+F.id+")"});O.clip=T}if(!Q){var N=S.getAttribute("clip-path");if(N){var V=l._g.doc.getElementById(N.replace(/(^url\(#|\)$)/g,r));V&&V.parentNode.removeChild(V);i(S,{"clip-path":r});delete O.clip}}break;case"path":if(O.type=="path"){i(S,{d:Q?P.path=l._pathToAbsolute(Q):"M0,0"});O._.dirty=1;if(O._.arrows){"startString" in O._.arrows&&c(O,O._.arrows.startString);"endString" in O._.arrows&&c(O,O._.arrows.endString,1)}}break;case"width":S.setAttribute(R,Q);O._.dirty=1;if(P.fx){R="x";Q=P.x}else{break}case"x":if(P.fx){Q=-P.x-(P.width||0)}case"rx":if(R=="rx"&&O.type=="rect"){break}case"cx":S.setAttribute(R,Q);O.pattern&&b(O);O._.dirty=1;break;case"height":S.setAttribute(R,Q);O._.dirty=1;if(P.fy){R="y";Q=P.y}else{break}case"y":if(P.fy){Q=-P.y-(P.height||0)}case"ry":if(R=="ry"&&O.type=="rect"){break}case"cy":S.setAttribute(R,Q);O.pattern&&b(O);O._.dirty=1;break;case"r":if(O.type=="rect"){i(S,{rx:Q,ry:Q})}else{S.setAttribute(R,Q)}O._.dirty=1;break;case"src":if(O.type=="image"){S.setAttributeNS(o,"href",Q)}break;case"stroke-width":if(O._.sx!=1||O._.sy!=1){Q/=C(s(O._.sx),s(O._.sy))||1}if(O.paper._vbSize){Q*=O.paper._vbSize}S.setAttribute(R,Q);if(P["stroke-dasharray"]){k(O,P["stroke-dasharray"],W)}if(O._.arrows){"startString" in O._.arrows&&c(O,O._.arrows.startString);"endString" in O._.arrows&&c(O,O._.arrows.endString,1)}break;case"stroke-dasharray":k(O,Q,W);break;case"fill":var I=B(Q).match(l._ISURL);if(I){F=i("pattern");var L=i("image");F.id=l.createUUID();i(F,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1});i(L,{x:0,y:0,"xlink:href":I[1]});F.appendChild(L);(function(X){l._preload(I[1],function(){var Y=this.offsetWidth,Z=this.offsetHeight;i(X,{width:Y,height:Z});i(L,{width:Y,height:Z});O.paper.safari()})})(F);O.paper.defs.appendChild(F);i(S,{fill:"url(#"+F.id+")"});O.pattern=F;O.pattern&&b(O);break}var G=l.getRGB(Q);if(!G.error){delete W.gradient;delete P.gradient;!l.is(P.opacity,"undefined")&&l.is(W.opacity,"undefined")&&i(S,{opacity:P.opacity});!l.is(P["fill-opacity"],"undefined")&&l.is(W["fill-opacity"],"undefined")&&i(S,{"fill-opacity":P["fill-opacity"]})}else{if((O.type=="circle"||O.type=="ellipse"||B(Q).charAt()!="r")&&a(O,Q)){if("opacity" in P||"fill-opacity" in P){var D=l._g.doc.getElementById(S.getAttribute("fill").replace(/^url\(#|\)$/g,r));if(D){var J=D.getElementsByTagName("stop");i(J[J.length-1],{"stop-opacity":("opacity" in P?P.opacity:1)*("fill-opacity" in P?P["fill-opacity"]:1)})}}P.gradient=Q;P.fill="none";break}}G[d]("opacity")&&i(S,{"fill-opacity":G.opacity>1?G.opacity/100:G.opacity});case"stroke":G=l.getRGB(Q);S.setAttribute(R,G.hex);R=="stroke"&&G[d]("opacity")&&i(S,{"stroke-opacity":G.opacity>1?G.opacity/100:G.opacity});if(R=="stroke"&&O._.arrows){"startString" in O._.arrows&&c(O,O._.arrows.startString);"endString" in O._.arrows&&c(O,O._.arrows.endString,1)}break;case"gradient":(O.type=="circle"||O.type=="ellipse"||B(Q).charAt()!="r")&&a(O,Q);break;case"opacity":if(P.gradient&&!P[d]("stroke-opacity")){i(S,{"stroke-opacity":Q>1?Q/100:Q})}case"fill-opacity":if(P.gradient){D=l._g.doc.getElementById(S.getAttribute("fill").replace(/^url\(#|\)$/g,r));if(D){J=D.getElementsByTagName("stop");i(J[J.length-1],{"stop-opacity":Q})}break}default:R=="font-size"&&(Q=q(Q,10)+"px");var K=R.replace(/(\-.)/g,function(X){return X.substring(1).toUpperCase()});S.style[K]=Q;O._.dirty=1;S.setAttribute(R,Q);break}}}p(O,W);S.style.visibility=M},A=1.2,p=function(D,H){if(D.type!="text"||!(H[d]("text")||H[d]("font")||H[d]("font-size")||H[d]("x")||H[d]("y"))){return}var M=D.attrs,F=D.node,O=F.firstChild?q(l._g.doc.defaultView.getComputedStyle(F.firstChild,r).getPropertyValue("font-size"),10):10;if(H[d]("text")){M.text=H.text;while(F.firstChild){F.removeChild(F.firstChild)}var G=B(H.text).split("\n"),E=[],K;for(var I=0,N=G.length;I<N;I++){K=i("tspan");I&&i(K,{dy:O*A,x:M.x});K.appendChild(l._g.doc.createTextNode(G[I]));F.appendChild(K);E[I]=K}}else{E=F.getElementsByTagName("tspan");for(I=0,N=E.length;I<N;I++){if(I){i(E[I],{dy:O*A,x:M.x})}else{i(E[0],{dy:0})}}}i(F,{x:M.x,y:M.y});D._.dirty=1;var J=D._getBBox(),L=M.y-(J.y+J.height/2);L&&l.is(L,"finite")&&i(E[0],{dy:L})},t=function(E,D){var G=0,F=0;this[0]=this.node=E;E.raphael=true;this.id=l._oid++;E.raphaelid=this.id;this.matrix=l.matrix();this.realPath=null;this.paper=D;this.attrs=this.attrs||{};this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1};!D.bottom&&(D.bottom=this);this.prev=D.top;D.top&&(D.top.next=this);D.top=this;this.next=null},m=l.el;t.prototype=m;m.constructor=t;l._engine.path=function(D,G){var E=i("path");G.canvas&&G.canvas.appendChild(E);var F=new t(E,G);F.type="path";w(F,{fill:"none",stroke:"#000",path:D});return F};m.rotate=function(E,D,G){if(this.removed){return this}E=B(E).split(g);if(E.length-1){D=n(E[1]);G=n(E[2])}E=n(E[0]);(G==null)&&(D=G);if(D==null||G==null){var F=this.getBBox(1);D=F.x+F.width/2;G=F.y+F.height/2}this.transform(this._.transform.concat([["r",E,D,G]]));return this};m.scale=function(H,F,D,G){if(this.removed){return this}H=B(H).split(g);if(H.length-1){F=n(H[1]);D=n(H[2]);G=n(H[3])}H=n(H[0]);(F==null)&&(F=H);(G==null)&&(D=G);if(D==null||G==null){var E=this.getBBox(1)}D=D==null?E.x+E.width/2:D;G=G==null?E.y+E.height/2:G;this.transform(this._.transform.concat([["s",H,F,D,G]]));return this};m.translate=function(E,D){if(this.removed){return this}E=B(E).split(g);if(E.length-1){D=n(E[1])}E=n(E[0])||0;D=+D||0;this.transform(this._.transform.concat([["t",E,D]]));return this};m.transform=function(E){var F=this._;if(E==null){return F.transform}l._extractTransform(this,E);this.clip&&i(this.clip,{transform:this.matrix.invert()});this.pattern&&b(this);this.node&&i(this.node,{transform:this.matrix});if(F.sx!=1||F.sy!=1){var D=this.attrs[d]("stroke-width")?this.attrs["stroke-width"]:1;this.attr({"stroke-width":D})}return this};m.hide=function(){!this.removed&&this.paper.safari(this.node.style.display="none");return this};m.show=function(){!this.removed&&this.paper.safari(this.node.style.display="");return this};m.remove=function(){if(this.removed||!this.node.parentNode){return}var E=this.paper;E.__set__&&E.__set__.exclude(this);z.unbind("raphael.*.*."+this.id);if(this.gradient){E.defs.removeChild(this.gradient)}l._tear(this,E);if(this.node.parentNode.tagName.toLowerCase()=="a"){this.node.parentNode.parentNode.removeChild(this.node.parentNode)}else{this.node.parentNode.removeChild(this.node)}for(var D in this){this[D]=typeof this[D]=="function"?l._removedFactory(D):null}this.removed=true};m._getBBox=function(){if(this.node.style.display=="none"){this.show();var D=true}var F={};try{F=this.node.getBBox()}catch(E){}finally{F=F||{}}D&&this.hide();return F};m.attr=function(D,M){if(this.removed){return this}if(D==null){var J={};for(var L in this.attrs){if(this.attrs[d](L)){J[L]=this.attrs[L]}}J.gradient&&J.fill=="none"&&(J.fill=J.gradient)&&delete J.gradient;J.transform=this._.transform;return J}if(M==null&&l.is(D,"string")){if(D=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient){return this.attrs.gradient}if(D=="transform"){return this._.transform}var K=D.split(g),G={};for(var H=0,O=K.length;H<O;H++){D=K[H];if(D in this.attrs){G[D]=this.attrs[D]}else{if(l.is(this.paper.customAttributes[D],"function")){G[D]=this.paper.customAttributes[D].def}else{G[D]=l._availableAttrs[D]}}}return O-1?G:G[K[0]]}if(M==null&&l.is(D,"array")){G={};for(H=0,O=D.length;H<O;H++){G[D[H]]=this.attr(D[H])}return G}if(M!=null){var E={};E[D]=M}else{if(D!=null&&l.is(D,"object")){E=D}}for(var N in E){z("raphael.attr."+N+"."+this.id,this,E[N])}for(N in this.paper.customAttributes){if(this.paper.customAttributes[d](N)&&E[d](N)&&l.is(this.paper.customAttributes[N],"function")){var I=this.paper.customAttributes[N].apply(this,[].concat(E[N]));this.attrs[N]=E[N];for(var F in I){if(I[d](F)){E[F]=I[F]}}}}w(this,E);return this};m.toFront=function(){if(this.removed){return this}if(this.node.parentNode.tagName.toLowerCase()=="a"){this.node.parentNode.parentNode.appendChild(this.node.parentNode)}else{this.node.parentNode.appendChild(this.node)}var D=this.paper;D.top!=this&&l._tofront(this,D);return this};m.toBack=function(){if(this.removed){return this}var E=this.node.parentNode;if(E.tagName.toLowerCase()=="a"){E.parentNode.insertBefore(this.node.parentNode,this.node.parentNode.parentNode.firstChild)}else{if(E.firstChild!=this.node){E.insertBefore(this.node,this.node.parentNode.firstChild)}}l._toback(this,this.paper);var D=this.paper;return this};m.insertAfter=function(D){if(this.removed){return this}var E=D.node||D[D.length-1].node;if(E.nextSibling){E.parentNode.insertBefore(this.node,E.nextSibling)}else{E.parentNode.appendChild(this.node)}l._insertafter(this,D,this.paper);return this};m.insertBefore=function(D){if(this.removed){return this}var E=D.node||D[0].node;E.parentNode.insertBefore(this.node,E);l._insertbefore(this,D,this.paper);return this};m.blur=function(E){var D=this;if(+E!==0){var F=i("filter"),G=i("feGaussianBlur");D.attrs.blur=E;F.id=l.createUUID();i(G,{stdDeviation:+E||1.5});F.appendChild(G);D.paper.defs.appendChild(F);D._blur=F;i(D.node,{filter:"url(#"+F.id+")"})}else{if(D._blur){D._blur.parentNode.removeChild(D._blur);delete D._blur;delete D.attrs.blur}D.node.removeAttribute("filter")}};l._engine.circle=function(E,D,I,H){var G=i("circle");E.canvas&&E.canvas.appendChild(G);var F=new t(G,E);F.attrs={cx:D,cy:I,r:H,fill:"none",stroke:"#000"};F.type="circle";i(G,F.attrs);return F};l._engine.rect=function(F,D,K,E,I,J){var H=i("rect");F.canvas&&F.canvas.appendChild(H);var G=new t(H,F);G.attrs={x:D,y:K,width:E,height:I,r:J||0,rx:J||0,ry:J||0,fill:"none",stroke:"#000"};G.type="rect";i(H,G.attrs);return G};l._engine.ellipse=function(E,D,J,I,H){var G=i("ellipse");E.canvas&&E.canvas.appendChild(G);var F=new t(G,E);F.attrs={cx:D,cy:J,rx:I,ry:H,fill:"none",stroke:"#000"};F.type="ellipse";i(G,F.attrs);return F};l._engine.image=function(F,J,D,K,E,I){var H=i("image");i(H,{x:D,y:K,width:E,height:I,preserveAspectRatio:"none"});H.setAttributeNS(o,"href",J);F.canvas&&F.canvas.appendChild(H);var G=new t(H,F);G.attrs={x:D,y:K,width:E,height:I,src:J};G.type="image";return G};l._engine.text=function(E,D,I,H){var G=i("text");E.canvas&&E.canvas.appendChild(G);var F=new t(G,E);F.attrs={x:D,y:I,"text-anchor":"middle",text:H,font:l._availableAttrs.font,stroke:"none",fill:"#000"};F.type="text";w(F,F.attrs);return F};l._engine.setSize=function(E,D){this.width=E||this.width;this.height=D||this.height;this.canvas.setAttribute("width",this.width);this.canvas.setAttribute("height",this.height);if(this._viewBox){this.setViewBox.apply(this,this._viewBox)}return this};l._engine.create=function(){var G=l._getContainer.apply(0,arguments),E=G&&G.container,K=G.x,J=G.y,F=G.width,L=G.height;if(!E){throw new Error("SVG container not found.")}var D=i("svg"),I="overflow:hidden;",H;K=K||0;J=J||0;F=F||512;L=L||342;i(D,{height:L,version:1.1,width:F,xmlns:"http://www.w3.org/2000/svg"});if(E==1){D.style.cssText=I+"position:absolute;left:"+K+"px;top:"+J+"px";l._g.doc.body.appendChild(D);H=1}else{D.style.cssText=I+"position:relative";if(E.firstChild){E.insertBefore(D,E.firstChild)}else{E.appendChild(D)}}E=new l._Paper;E.width=F;E.height=L;E.canvas=D;E.clear();E._left=E._top=0;H&&(E.renderfix=function(){});E.renderfix();return E};l._engine.setViewBox=function(I,G,K,D,E){z("raphael.setViewBox",this,this._viewBox,[I,G,K,D,E]);var M=C(K/this.width,D/this.height),H=this.top,L=E?"meet":"xMinYMin",F,J;if(I==null){if(this._vbSize){M=1}delete this._vbSize;F="0 0 "+this.width+j+this.height}else{this._vbSize=M;F=I+j+G+j+K+j+D}i(this.canvas,{viewBox:F,preserveAspectRatio:L});while(M&&H){J="stroke-width" in H.attrs?H.attrs["stroke-width"]:1;H.attr({"stroke-width":J});H._.dirty=1;H._.dirtyT=1;H=H.prev}this._viewBox=[I,G,K,D,!!E];return this};l.prototype.renderfix=function(){var I=this.canvas,D=I.style,H;try{H=I.getScreenCTM()||I.createSVGMatrix()}catch(G){H=I.createSVGMatrix()}var F=-H.e%1,E=-H.f%1;if(F||E){if(F){this._left=(this._left+F)%1;D.left=this._left+"px"}if(E){this._top=(this._top+E)%1;D.top=this._top+"px"}}};l.prototype.clear=function(){l.eve("raphael.clear",this);var D=this.canvas;while(D.firstChild){D.removeChild(D.firstChild)}this.bottom=this.top=null;(this.desc=i("desc")).appendChild(l._g.doc.createTextNode("Created with Rapha\xebl "+l.version));D.appendChild(this.desc);D.appendChild(this.defs=i("defs"))};l.prototype.remove=function(){z("raphael.remove",this);this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var D in this){this[D]=typeof this[D]=="function"?l._removedFactory(D):null}};var x=l.st;for(var e in m){if(m[d](e)&&!x[d](e)){x[e]=(function(D){return function(){var E=arguments;return this.forEach(function(F){F[D].apply(F,E)})}})(e)}}}(window.Raphael);window.Raphael.vml&&function(l){var e="hasOwnProperty",F=String,n=parseFloat,h=Math,B=h.round,I=h.max,C=h.min,s=h.abs,v="fill",i=/[, ]+/,A=l.eve,w=" progid:DXImageTransform.Microsoft",k=" ",q="",D={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},j=/([clmz]),?([^clmz]*)/gi,t=/ progid:\S+Blur\([^\)]+\)/g,H=/-?[^,\s-]+/g,d="position:absolute;left:0;top:0;width:1px;height:1px",b=21600,z={path:1,rect:1,image:1},r={circle:1,ellipse:1},f=function(S){var P=/[ahqstv]/ig,K=l._pathToAbsolute;F(S).match(P)&&(K=l._path2curve);P=/[clmz]/g;if(K==l._pathToAbsolute&&!F(S).match(P)){var O=F(S).replace(j,function(W,Y,U){var X=[],T=Y.toLowerCase()=="m",V=D[Y];U.replace(H,function(Z){if(T&&X.length==2){V+=X+D[Y=="m"?"l":"L"];X=[]}X.push(B(Z*b))});return V+X});return O}var Q=K(S),J,E;O=[];for(var M=0,R=Q.length;M<R;M++){J=Q[M];E=Q[M][0].toLowerCase();E=="z"&&(E="x");for(var L=1,N=J.length;L<N;L++){E+=B(J[L]*b)+(L!=N-1?",":q)}O.push(E)}return O.join(k)},o=function(L,K,J){var E=l.matrix();E.rotate(-L,0.5,0.5);return{dx:E.x(K,J),dy:E.y(K,J)}},p=function(R,Q,P,M,L,N){var Z=R._,T=R.matrix,E=Z.fillpos,S=R.node,O=S.style,K=1,J="",V,X=b/Q,W=b/P;O.visibility="hidden";if(!Q||!P){return}S.coordsize=s(X)+k+s(W);O.rotation=N*(Q*P<0?-1:1);if(N){var Y=o(N,M,L);M=Y.dx;L=Y.dy}Q<0&&(J+="x");P<0&&(J+=" y")&&(K=-1);O.flip=J;S.coordorigin=(M*-X)+k+(L*-W);if(E||Z.fillsize){var U=S.getElementsByTagName(v);U=U&&U[0];S.removeChild(U);if(E){Y=o(N,T.x(E[0],E[1]),T.y(E[0],E[1]));U.position=Y.dx*K+k+Y.dy*K}if(Z.fillsize){U.size=Z.fillsize[0]*s(Q)+k+Z.fillsize[1]*s(P)}S.appendChild(U)}O.visibility="visible"};l.toString=function(){return"Your browser doesn\u2019t support SVG. Falling down to VML.\nYou are running Rapha\xebl "+this.version};var c=function(E,O,J){var Q=F(O).toLowerCase().split("-"),M=J?"end":"start",K=Q.length,N="classic",P="medium",L="medium";while(K--){switch(Q[K]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":N=Q[K];break;case"wide":case"narrow":L=Q[K];break;case"long":case"short":P=Q[K];break}}var R=E.node.getElementsByTagName("stroke")[0];R[M+"arrow"]=N;R[M+"arrowlength"]=P;R[M+"arrowwidth"]=L},x=function(Z,aj){Z.attrs=Z.attrs||{};var ae=Z.node,an=Z.attrs,V=ae.style,R,ah=z[Z.type]&&(aj.x!=an.x||aj.y!=an.y||aj.width!=an.width||aj.height!=an.height||aj.cx!=an.cx||aj.cy!=an.cy||aj.rx!=an.rx||aj.ry!=an.ry||aj.r!=an.r),Y=r[Z.type]&&(an.cx!=aj.cx||an.cy!=aj.cy||an.r!=aj.r||an.rx!=aj.rx||an.ry!=aj.ry),aq=Z;for(var W in aj){if(aj[e](W)){an[W]=aj[W]}}if(ah){an.path=l._getPath[Z.type](Z);Z._.dirty=1}aj.href&&(ae.href=aj.href);aj.title&&(ae.title=aj.title);aj.target&&(ae.target=aj.target);aj.cursor&&(V.cursor=aj.cursor);"blur" in aj&&Z.blur(aj.blur);if(aj.path&&Z.type=="path"||ah){ae.path=f(~F(an.path).toLowerCase().indexOf("r")?l._pathToAbsolute(an.path):an.path);if(Z.type=="image"){Z._.fillpos=[an.x,an.y];Z._.fillsize=[an.width,an.height];p(Z,1,1,0,0,0)}}"transform" in aj&&Z.transform(aj.transform);if(Y){var M=+an.cx,K=+an.cy,Q=+an.rx||+an.r||0,P=+an.ry||+an.r||0;ae.path=l.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",B((M-Q)*b),B((K-P)*b),B((M+Q)*b),B((K+P)*b),B(M*b))}if("clip-rect" in aj){var J=F(aj["clip-rect"]).split(i);if(J.length==4){J[2]=+J[2]+(+J[0]);J[3]=+J[3]+(+J[1]);var X=ae.clipRect||l._g.doc.createElement("div"),ap=X.style;ap.clip=l.format("rect({1}px {2}px {3}px {0}px)",J);if(!ae.clipRect){ap.position="absolute";ap.top=0;ap.left=0;ap.width=Z.paper.width+"px";ap.height=Z.paper.height+"px";ae.parentNode.insertBefore(X,ae);X.appendChild(ae);ae.clipRect=X}}if(!aj["clip-rect"]){ae.clipRect&&(ae.clipRect.style.clip="auto")}}if(Z.textpath){var al=Z.textpath.style;aj.font&&(al.font=aj.font);aj["font-family"]&&(al.fontFamily='"'+aj["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,q)+'"');aj["font-size"]&&(al.fontSize=aj["font-size"]);aj["font-weight"]&&(al.fontWeight=aj["font-weight"]);aj["font-style"]&&(al.fontStyle=aj["font-style"])}if("arrow-start" in aj){c(aq,aj["arrow-start"])}if("arrow-end" in aj){c(aq,aj["arrow-end"],1)}if(aj.opacity!=null||aj["stroke-width"]!=null||aj.fill!=null||aj.src!=null||aj.stroke!=null||aj["stroke-width"]!=null||aj["stroke-opacity"]!=null||aj["fill-opacity"]!=null||aj["stroke-dasharray"]!=null||aj["stroke-miterlimit"]!=null||aj["stroke-linejoin"]!=null||aj["stroke-linecap"]!=null){var af=ae.getElementsByTagName(v),am=false;af=af&&af[0];!af&&(am=af=G(v));if(Z.type=="image"&&aj.src){af.src=aj.src}aj.fill&&(af.on=true);if(af.on==null||aj.fill=="none"||aj.fill===null){af.on=false}if(af.on&&aj.fill){var O=F(aj.fill).match(l._ISURL);if(O){af.parentNode==ae&&ae.removeChild(af);af.rotate=true;af.src=O[1];af.type="tile";var E=Z.getBBox(1);af.position=E.x+k+E.y;Z._.fillpos=[E.x,E.y];l._preload(O[1],function(){Z._.fillsize=[this.offsetWidth,this.offsetHeight]})}else{af.color=l.getRGB(aj.fill).hex;af.src=q;af.type="solid";if(l.getRGB(aj.fill).error&&(aq.type in {circle:1,ellipse:1}||F(aj.fill).charAt()!="r")&&a(aq,aj.fill,af)){an.fill="none";an.gradient=aj.fill;af.rotate=false}}}if("fill-opacity" in aj||"opacity" in aj){var N=((+an["fill-opacity"]+1||2)-1)*((+an.opacity+1||2)-1)*((+l.getRGB(aj.fill).o+1||2)-1);N=C(I(N,0),1);af.opacity=N;if(af.src){af.color="none"}}ae.appendChild(af);var S=(ae.getElementsByTagName("stroke")&&ae.getElementsByTagName("stroke")[0]),ao=false;!S&&(ao=S=G("stroke"));if((aj.stroke&&aj.stroke!="none")||aj["stroke-width"]||aj["stroke-opacity"]!=null||aj["stroke-dasharray"]||aj["stroke-miterlimit"]||aj["stroke-linejoin"]||aj["stroke-linecap"]){S.on=true}(aj.stroke=="none"||aj.stroke===null||S.on==null||aj.stroke==0||aj["stroke-width"]==0)&&(S.on=false);var ad=l.getRGB(aj.stroke);S.on&&aj.stroke&&(S.color=ad.hex);N=((+an["stroke-opacity"]+1||2)-1)*((+an.opacity+1||2)-1)*((+ad.o+1||2)-1);var aa=(n(aj["stroke-width"])||1)*0.75;N=C(I(N,0),1);aj["stroke-width"]==null&&(aa=an["stroke-width"]);aj["stroke-width"]&&(S.weight=aa);aa&&aa<1&&(N*=aa)&&(S.weight=1);S.opacity=N;aj["stroke-linejoin"]&&(S.joinstyle=aj["stroke-linejoin"]||"miter");S.miterlimit=aj["stroke-miterlimit"]||8;aj["stroke-linecap"]&&(S.endcap=aj["stroke-linecap"]=="butt"?"flat":aj["stroke-linecap"]=="square"?"square":"round");if(aj["stroke-dasharray"]){var ac={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};S.dashstyle=ac[e](aj["stroke-dasharray"])?ac[aj["stroke-dasharray"]]:q}ao&&ae.appendChild(S)}if(aq.type=="text"){aq.paper.canvas.style.display=q;var ag=aq.paper.span,ab=100,L=an.font&&an.font.match(/\d+(?:\.\d*)?(?=px)/);V=ag.style;an.font&&(V.font=an.font);an["font-family"]&&(V.fontFamily=an["font-family"]);an["font-weight"]&&(V.fontWeight=an["font-weight"]);an["font-style"]&&(V.fontStyle=an["font-style"]);L=n(an["font-size"]||L&&L[0])||10;V.fontSize=L*ab+"px";aq.textpath.string&&(ag.innerHTML=F(aq.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));var U=ag.getBoundingClientRect();aq.W=an.w=(U.right-U.left)/ab;aq.H=an.h=(U.bottom-U.top)/ab;aq.X=an.x;aq.Y=an.y+aq.H/2;("x" in aj||"y" in aj)&&(aq.path.v=l.format("m{0},{1}l{2},{1}",B(an.x*b),B(an.y*b),B(an.x*b)+1));var T=["x","y","text","font","font-family","font-weight","font-style","font-size"];for(var ai=0,ak=T.length;ai<ak;ai++){if(T[ai] in aj){aq._.dirty=1;break}}switch(an["text-anchor"]){case"start":aq.textpath.style["v-text-align"]="left";aq.bbx=aq.W/2;break;case"end":aq.textpath.style["v-text-align"]="right";aq.bbx=-aq.W/2;break;default:aq.textpath.style["v-text-align"]="center";aq.bbx=0;break}aq.textpath.style["v-text-kern"]=true}},a=function(E,R,U){E.attrs=E.attrs||{};var S=E.attrs,L=Math.pow,M,N,P="linear",Q=".5 .5";E.attrs.gradient=R;R=F(R).replace(l._radial_gradient,function(X,Y,W){P="radial";if(Y&&W){Y=n(Y);W=n(W);L(Y-0.5,2)+L(W-0.5,2)>0.25&&(W=h.sqrt(0.25-L(Y-0.5,2))*((W>0.5)*2-1)+0.5);Q=Y+k+W}return q});R=R.split(/\s*\-\s*/);if(P=="linear"){var J=R.shift();J=-n(J);if(isNaN(J)){return null}}var O=l._parseDots(R);if(!O){return null}E=E.shape||E.node;if(O.length){E.removeChild(U);U.on=true;U.method="none";U.color=O[0].color;U.color2=O[O.length-1].color;var V=[];for(var K=0,T=O.length;K<T;K++){O[K].offset&&V.push(O[K].offset+k+O[K].color)}U.colors=V.length?V.join():"0% "+U.color;if(P=="radial"){U.type="gradientTitle";U.focus="100%";U.focussize="0 0";U.focusposition=Q;U.angle=0}else{U.type="gradient";U.angle=(270-J)%360}E.appendChild(U)}return 1},u=function(J,E){this[0]=this.node=J;J.raphael=true;this.id=l._oid++;J.raphaelid=this.id;this.X=0;this.Y=0;this.attrs={};this.paper=E;this.matrix=l.matrix();this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1};!E.bottom&&(E.bottom=this);this.prev=E.top;E.top&&(E.top.next=this);E.top=this;this.next=null};var m=l.el;u.prototype=m;m.constructor=u;m.transform=function(M){if(M==null){return this._.transform}var O=this.paper._viewBoxShift,N=O?"s"+[O.scale,O.scale]+"-1-1t"+[O.dx,O.dy]:q,R;if(O){R=M=F(M).replace(/\.{3}|\u2026/g,this._.transform||q)}l._extractTransform(this,N+M);var S=this.matrix.clone(),U=this.skew,K=this.node,Q,L=~F(this.attrs.fill).indexOf("-"),E=!F(this.attrs.fill).indexOf("url(");S.translate(-0.5,-0.5);if(E||L||this.type=="image"){U.matrix="1 0 0 1";U.offset="0 0";Q=S.split();if((L&&Q.noRotation)||!Q.isSimple){K.style.filter=S.toFilter();var P=this.getBBox(),J=this.getBBox(1),V=P.x-J.x,T=P.y-J.y;K.coordorigin=(V*-b)+k+(T*-b);p(this,1,1,V,T,0)}else{K.style.filter=q;p(this,Q.scalex,Q.scaley,Q.dx,Q.dy,Q.rotate)}}else{K.style.filter=q;U.matrix=F(S);U.offset=S.offset()}R&&(this._.transform=R);return this};m.rotate=function(J,E,L){if(this.removed){return this}if(J==null){return}J=F(J).split(i);if(J.length-1){E=n(J[1]);L=n(J[2])}J=n(J[0]);(L==null)&&(E=L);if(E==null||L==null){var K=this.getBBox(1);E=K.x+K.width/2;L=K.y+K.height/2}this._.dirtyT=1;this.transform(this._.transform.concat([["r",J,E,L]]));return this};m.translate=function(J,E){if(this.removed){return this}J=F(J).split(i);if(J.length-1){E=n(J[1])}J=n(J[0])||0;E=+E||0;if(this._.bbox){this._.bbox.x+=J;this._.bbox.y+=E}this.transform(this._.transform.concat([["t",J,E]]));return this};m.scale=function(M,K,E,L){if(this.removed){return this}M=F(M).split(i);if(M.length-1){K=n(M[1]);E=n(M[2]);L=n(M[3]);isNaN(E)&&(E=null);isNaN(L)&&(L=null)}M=n(M[0]);(K==null)&&(K=M);(L==null)&&(E=L);if(E==null||L==null){var J=this.getBBox(1)}E=E==null?J.x+J.width/2:E;L=L==null?J.y+J.height/2:L;this.transform(this._.transform.concat([["s",M,K,E,L]]));this._.dirtyT=1;return this};m.hide=function(){!this.removed&&(this.node.style.display="none");return this};m.show=function(){!this.removed&&(this.node.style.display=q);return this};m._getBBox=function(){if(this.removed){return{}}return{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}};m.remove=function(){if(this.removed||!this.node.parentNode){return}this.paper.__set__&&this.paper.__set__.exclude(this);l.eve.unbind("raphael.*.*."+this.id);l._tear(this,this.paper);this.node.parentNode.removeChild(this.node);this.shape&&this.shape.parentNode.removeChild(this.shape);for(var E in this){this[E]=typeof this[E]=="function"?l._removedFactory(E):null}this.removed=true};m.attr=function(E,R){if(this.removed){return this}if(E==null){var O={};for(var Q in this.attrs){if(this.attrs[e](Q)){O[Q]=this.attrs[Q]}}O.gradient&&O.fill=="none"&&(O.fill=O.gradient)&&delete O.gradient;O.transform=this._.transform;return O}if(R==null&&l.is(E,"string")){if(E==v&&this.attrs.fill=="none"&&this.attrs.gradient){return this.attrs.gradient}var P=E.split(i),L={};for(var M=0,T=P.length;M<T;M++){E=P[M];if(E in this.attrs){L[E]=this.attrs[E]}else{if(l.is(this.paper.customAttributes[E],"function")){L[E]=this.paper.customAttributes[E].def}else{L[E]=l._availableAttrs[E]}}}return T-1?L:L[P[0]]}if(this.attrs&&R==null&&l.is(E,"array")){L={};for(M=0,T=E.length;M<T;M++){L[E[M]]=this.attr(E[M])}return L}var J;if(R!=null){J={};J[E]=R}R==null&&l.is(E,"object")&&(J=E);for(var S in J){A("raphael.attr."+S+"."+this.id,this,J[S])}if(J){for(S in this.paper.customAttributes){if(this.paper.customAttributes[e](S)&&J[e](S)&&l.is(this.paper.customAttributes[S],"function")){var N=this.paper.customAttributes[S].apply(this,[].concat(J[S]));this.attrs[S]=J[S];for(var K in N){if(N[e](K)){J[K]=N[K]}}}}if(J.text&&this.type=="text"){this.textpath.string=J.text}x(this,J)}return this};m.toFront=function(){!this.removed&&this.node.parentNode.appendChild(this.node);this.paper&&this.paper.top!=this&&l._tofront(this,this.paper);return this};m.toBack=function(){if(this.removed){return this}if(this.node.parentNode.firstChild!=this.node){this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild);l._toback(this,this.paper)}return this};m.insertAfter=function(E){if(this.removed){return this}if(E.constructor==l.st.constructor){E=E[E.length-1]}if(E.node.nextSibling){E.node.parentNode.insertBefore(this.node,E.node.nextSibling)}else{E.node.parentNode.appendChild(this.node)}l._insertafter(this,E,this.paper);return this};m.insertBefore=function(E){if(this.removed){return this}if(E.constructor==l.st.constructor){E=E[0]}E.node.parentNode.insertBefore(this.node,E.node);l._insertbefore(this,E,this.paper);return this};m.blur=function(E){var J=this.node.runtimeStyle,K=J.filter;K=K.replace(t,q);if(+E!==0){this.attrs.blur=E;J.filter=K+k+w+".Blur(pixelradius="+(+E||1.5)+")";J.margin=l.format("-{0}px 0 0 -{0}px",B(+E||1.5))}else{J.filter=K;J.margin=0;delete this.attrs.blur}};l._engine.path=function(L,J){var M=G("shape");M.style.cssText=d;M.coordsize=b+k+b;M.coordorigin=J.coordorigin;var N=new u(M,J),E={fill:"none",stroke:"#000"};L&&(E.path=L);N.type="path";N.path=[];N.Path=q;x(N,E);J.canvas.appendChild(M);var K=G("skew");K.on=true;M.appendChild(K);N.skew=K;N.transform(q);return N};l._engine.rect=function(J,O,M,P,K,E){var Q=l._rectPath(O,M,P,K,E),L=J.path(Q),N=L.attrs;L.X=N.x=O;L.Y=N.y=M;L.W=N.width=P;L.H=N.height=K;N.r=E;N.path=Q;L.type="rect";return L};l._engine.ellipse=function(J,E,O,N,M){var L=J.path(),K=L.attrs;L.X=E-N;L.Y=O-M;L.W=N*2;L.H=M*2;L.type="ellipse";x(L,{cx:E,cy:O,rx:N,ry:M});return L};l._engine.circle=function(J,E,N,M){var L=J.path(),K=L.attrs;L.X=E-M;L.Y=N-M;L.W=L.H=M*2;L.type="circle";x(L,{cx:E,cy:N,r:M});return L};l._engine.image=function(J,E,P,N,Q,L){var S=l._rectPath(P,N,Q,L),M=J.path(S).attr({stroke:"none"}),O=M.attrs,K=M.node,R=K.getElementsByTagName(v)[0];O.src=E;M.X=O.x=P;M.Y=O.y=N;M.W=O.width=Q;M.H=O.height=L;O.path=S;M.type="image";R.parentNode==K&&K.removeChild(R);R.rotate=true;R.src=E;R.type="tile";M._.fillpos=[P,N];M._.fillsize=[Q,L];K.appendChild(R);p(M,1,1,0,0,0);return M};l._engine.text=function(E,O,N,P){var L=G("shape"),R=G("path"),K=G("textpath");O=O||0;N=N||0;P=P||"";R.v=l.format("m{0},{1}l{2},{1}",B(O*b),B(N*b),B(O*b)+1);R.textpathok=true;K.string=F(P);K.on=true;L.style.cssText=d;L.coordsize=b+k+b;L.coordorigin="0 0";var J=new u(L,E),M={fill:"#000",stroke:"none",font:l._availableAttrs.font,text:P};J.shape=L;J.path=R;J.textpath=K;J.type="text";J.attrs.text=F(P);J.attrs.x=O;J.attrs.y=N;J.attrs.w=1;J.attrs.h=1;x(J,M);L.appendChild(K);L.appendChild(R);E.canvas.appendChild(L);var Q=G("skew");Q.on=true;L.appendChild(Q);J.skew=Q;J.transform(q);return J};l._engine.setSize=function(K,E){var J=this.canvas.style;this.width=K;this.height=E;K==+K&&(K+="px");E==+E&&(E+="px");J.width=K;J.height=E;J.clip="rect(0 "+K+" "+E+" 0)";if(this._viewBox){l._engine.setViewBox.apply(this,this._viewBox)}return this};l._engine.setViewBox=function(N,M,O,K,L){l.eve("raphael.setViewBox",this,this._viewBox,[N,M,O,K,L]);var E=this.width,Q=this.height,R=1/I(O/E,K/Q),P,J;if(L){P=Q/K;J=E/O;if(O*P<E){N-=(E-O*P)/2/P}if(K*J<Q){M-=(Q-K*J)/2/J}}this._viewBox=[N,M,O,K,!!L];this._viewBoxShift={dx:-N,dy:-M,scale:R};this.forEach(function(S){S.transform("...")});return this};var G;l._engine.initWin=function(K){var J=K.document;J.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!J.namespaces.rvml&&J.namespaces.add("rvml","urn:schemas-microsoft-com:vml");G=function(L){return J.createElement("<rvml:"+L+' class="rvml">')}}catch(E){G=function(L){return J.createElement("<"+L+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}};l._engine.initWin(l._g.win);l._engine.create=function(){var K=l._getContainer.apply(0,arguments),E=K.container,Q=K.height,R,J=K.width,P=K.x,O=K.y;if(!E){throw new Error("VML container not found.")}var M=new l._Paper,N=M.canvas=l._g.doc.createElement("div"),L=N.style;P=P||0;O=O||0;J=J||512;Q=Q||342;M.width=J;M.height=Q;J==+J&&(J+="px");Q==+Q&&(Q+="px");M.coordsize=b*1000+k+b*1000;M.coordorigin="0 0";M.span=l._g.doc.createElement("span");M.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;";N.appendChild(M.span);L.cssText=l.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",J,Q);if(E==1){l._g.doc.body.appendChild(N);L.left=P+"px";L.top=O+"px";L.position="absolute"}else{if(E.firstChild){E.insertBefore(N,E.firstChild)}else{E.appendChild(N)}}M.renderfix=function(){};return M};l.prototype.clear=function(){l.eve("raphael.clear",this);this.canvas.innerHTML=q;this.span=l._g.doc.createElement("span");this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";this.canvas.appendChild(this.span);this.bottom=this.top=null};l.prototype.remove=function(){l.eve("raphael.remove",this);this.canvas.parentNode.removeChild(this.canvas);for(var E in this){this[E]=typeof this[E]=="function"?l._removedFactory(E):null}return true};var y=l.st;for(var g in m){if(m[e](g)&&!y[e](g)){y[g]=(function(E){return function(){var J=arguments;return this.forEach(function(K){K[E].apply(K,J)})}})(g)}}}(window.Raphael);
;
/*
 * g.Raphael 0.51 - Charting library, based on Raphal
 *
 * Copyright (c) 2009-2012 Dmitry Baranovskiy (http://g.raphaeljs.com)
 * Licensed under the MIT (http://www.opensource.org/licenses/mit-license.php) license.
 */
Raphael.el.popup=function(o,r,q,m){var n=this.paper||this[0].paper,p,l,j,k;if(n){switch(this.type){case"text":case"circle":case"ellipse":l=!0;break;default:l=!1}o=null==o?"up":o;r=r||5;p=this.getBBox();q="number"==typeof q?q:l?p.x+p.width/2:p.x;m="number"==typeof m?m:l?p.y+p.height/2:p.y;j=Math.max(p.width/2-r,0);k=Math.max(p.height/2-r,0);this.translate(q-p.x-(l?p.width/2:0),m-p.y-(l?p.height/2:0));p=this.getBBox();q={up:["M",q,m,"l",-r,-r,-j,0,"a",r,r,0,0,1,-r,-r,"l",0,-p.height,"a",r,r,0,0,1,r,-r,"l",2*r+2*j,0,"a",r,r,0,0,1,r,r,"l",0,p.height,"a",r,r,0,0,1,-r,r,"l",-j,0,"z"].join(),down:["M",q,m,"l",r,r,j,0,"a",r,r,0,0,1,r,r,"l",0,p.height,"a",r,r,0,0,1,-r,r,"l",-(2*r+2*j),0,"a",r,r,0,0,1,-r,-r,"l",0,-p.height,"a",r,r,0,0,1,r,-r,"l",j,0,"z"].join(),left:["M",q,m,"l",-r,r,0,k,"a",r,r,0,0,1,-r,r,"l",-p.width,0,"a",r,r,0,0,1,-r,-r,"l",0,-(2*r+2*k),"a",r,r,0,0,1,r,-r,"l",p.width,0,"a",r,r,0,0,1,r,r,"l",0,k,"z"].join(),right:["M",q,m,"l",r,-r,0,-k,"a",r,r,0,0,1,r,-r,"l",p.width,0,"a",r,r,0,0,1,r,r,"l",0,2*r+2*k,"a",r,r,0,0,1,-r,r,"l",-p.width,0,"a",r,r,0,0,1,-r,-r,"l",0,-k,"z"].join()};r={up:{x:-!l*(p.width/2),y:2*-r-(l?p.height/2:p.height)},down:{x:-!l*(p.width/2),y:2*r+(l?p.height/2:p.height)},left:{x:2*-r-(l?p.width/2:p.width),y:-!l*(p.height/2)},right:{x:2*r+(l?p.width/2:p.width),y:-!l*(p.height/2)}}[o];this.translate(r.x,r.y);return n.path(q[o]).attr({fill:"#000",stroke:"none"}).insertBefore(this.node?this:this[0])}};Raphael.el.tag=function(o,r,q,m){var n=this.paper||this[0].paper;if(n){var n=n.path().attr({fill:"#000",stroke:"#000"}),p=this.getBBox(),l,j,k;switch(this.type){case"text":case"circle":case"ellipse":k=!0;break;default:k=!1}o=o||0;q="number"==typeof q?q:k?p.x+p.width/2:p.x;m="number"==typeof m?m:k?p.y+p.height/2:p.y;r=null==r?5:r;j=0.5522*r;p.height>=2*r?n.attr({path:["M",q,m+r,"a",r,r,0,1,1,0,2*-r,r,r,0,1,1,0,2*r,"m",0,2*-r-3,"a",r+3,r+3,0,1,0,0,2*(r+3),"L",q+r+3,m+p.height/2+3,"l",p.width+6,0,0,-p.height-6,-p.width-6,0,"L",q,m-r-3].join()}):(l=Math.sqrt(Math.pow(r+3,2)-Math.pow(p.height/2+3,2)),n.attr({path:["M",q,m+r,"c",-j,0,-r,j-r,-r,-r,0,-j,r-j,-r,r,-r,j,0,r,r-j,r,r,0,j,j-r,r,-r,r,"M",q+l,m-p.height/2-3,"a",r+3,r+3,0,1,0,0,p.height+6,"l",r+3-l+p.width+6,0,0,-p.height-6,"L",q+l,m-p.height/2-3].join()}));o=360-o;n.rotate(o,q,m);this.attrs?(this.attr(this.attrs.x?"x":"cx",q+r+3+(!k?"text"==this.type?p.width:0:p.width/2)).attr("y",k?m:m-p.height/2),this.rotate(o,q,m),90<o&&270>o&&this.attr(this.attrs.x?"x":"cx",q-r-3-(!k?p.width:p.width/2)).rotate(180,q,m)):90<o&&270>o?(this.translate(q-p.x-p.width-r-3,m-p.y-p.height/2),this.rotate(o-180,p.x+p.width+r+3,p.y+p.height/2)):(this.translate(q-p.x+r+3,m-p.y-p.height/2),this.rotate(o,p.x-r-3,p.y+p.height/2));return n.insertBefore(this.node?this:this[0])}};Raphael.el.drop=function(m,i,h){var k=this.getBBox(),l=this.paper||this[0].paper,n,j;if(l){switch(this.type){case"text":case"circle":case"ellipse":n=!0;break;default:n=!1}m=m||0;i="number"==typeof i?i:n?k.x+k.width/2:k.x;h="number"==typeof h?h:n?k.y+k.height/2:k.y;j=Math.max(k.width,k.height)+Math.min(k.width,k.height);l=l.path(["M",i,h,"l",j,0,"A",0.4*j,0.4*j,0,1,0,i+0.7*j,h-0.7*j,"z"]).attr({fill:"#000",stroke:"none"}).rotate(22.5-m,i,h);m=(m+90)*Math.PI/180;i=i+j*Math.sin(m)-(n?0:k.width/2);m=h+j*Math.cos(m)-(n?0:k.height/2);this.attrs?this.attr(this.attrs.x?"x":"cx",i).attr(this.attrs.y?"y":"cy",m):this.translate(i-k.x,m-k.y);return l.insertBefore(this.node?this:this[0])}};Raphael.el.flag=function(m,i,h){var k=this.paper||this[0].paper;if(k){var k=k.path().attr({fill:"#000",stroke:"#000"}),l=this.getBBox(),n=l.height/2,j;switch(this.type){case"text":case"circle":case"ellipse":j=!0;break;default:j=!1}m=m||0;i="number"==typeof i?i:j?l.x+l.width/2:l.x;h="number"==typeof h?h:j?l.y+l.height/2:l.y;k.attr({path:["M",i,h,"l",n+3,-n-3,l.width+6,0,0,l.height+6,-l.width-6,0,"z"].join()});m=360-m;k.rotate(m,i,h);this.attrs?(this.attr(this.attrs.x?"x":"cx",i+n+3+(!j?"text"==this.type?l.width:0:l.width/2)).attr("y",j?h:h-l.height/2),this.rotate(m,i,h),90<m&&270>m&&this.attr(this.attrs.x?"x":"cx",i-n-3-(!j?l.width:l.width/2)).rotate(180,i,h)):90<m&&270>m?(this.translate(i-l.x-l.width-n-3,h-l.y-l.height/2),this.rotate(m-180,l.x+l.width+n+3,l.y+l.height/2)):(this.translate(i-l.x+n+3,h-l.y-l.height/2),this.rotate(m,l.x-n-3,l.y+l.height/2));return k.insertBefore(this.node?this:this[0])}};Raphael.el.label=function(){var f=this.getBBox(),e=this.paper||this[0].paper,c=Math.min(20,f.width+10,f.height+10)/2;if(e){return e.rect(f.x-c/2,f.y-c/2,f.width+c,f.height+c,c).attr({stroke:"none",fill:"#000"}).insertBefore(this.node?this:this[0])}};Raphael.el.blob=function(w,z,y){var u=this.getBBox(),v=Math.PI/180,x=this.paper||this[0].paper,t,r;if(x){switch(this.type){case"text":case"circle":case"ellipse":t=!0;break;default:t=!1}x=x.path().attr({fill:"#000",stroke:"none"});w=(+w+1?w:45)+90;r=Math.min(u.height,u.width);var z="number"==typeof z?z:t?u.x+u.width/2:u.x,y="number"==typeof y?y:t?u.y+u.height/2:u.y,s=Math.max(u.width+r,25*r/12),q=Math.max(u.height+r,25*r/12);t=z+r*Math.sin((w-22.5)*v);var k=y+r*Math.cos((w-22.5)*v),p=z+r*Math.sin((w+22.5)*v),w=y+r*Math.cos((w+22.5)*v),v=(p-t)/2;r=(w-k)/2;var s=s/2,q=q/2,m=-Math.sqrt(Math.abs(s*s*q*q-s*s*r*r-q*q*v*v)/(s*s*r*r+q*q*v*v));r=m*s*r/q+(p+t)/2;v=m*-q*v/s+(w+k)/2;x.attr({x:r,y:v,path:["M",z,y,"L",p,w,"A",s,q,0,1,1,t,k,"z"].join()});this.translate(r-u.x-u.width/2,v-u.y-u.height/2);return x.insertBefore(this.node?this:this[0])}};Raphael.fn.label=function(h,e,c){var g=this.set(),c=this.text(h,e,c).attr(Raphael.g.txtattr);return g.push(c.label(),c)};Raphael.fn.popup=function(k,h,g,i,j){var l=this.set(),g=this.text(k,h,g).attr(Raphael.g.txtattr);return l.push(g.popup(i,j),g)};Raphael.fn.tag=function(k,h,g,i,j){var l=this.set(),g=this.text(k,h,g).attr(Raphael.g.txtattr);return l.push(g.tag(i,j),g)};Raphael.fn.flag=function(j,g,c,h){var i=this.set(),c=this.text(j,g,c).attr(Raphael.g.txtattr);return i.push(c.flag(h),c)};Raphael.fn.drop=function(j,g,c,h){var i=this.set(),c=this.text(j,g,c).attr(Raphael.g.txtattr);return i.push(c.drop(h),c)};Raphael.fn.blob=function(j,g,c,h){var i=this.set(),c=this.text(j,g,c).attr(Raphael.g.txtattr);return i.push(c.blob(h),c)};Raphael.el.lighter=function(c){var c=c||2,b=[this.attrs.fill,this.attrs.stroke];this.fs=this.fs||[b[0],b[1]];b[0]=Raphael.rgb2hsb(Raphael.getRGB(b[0]).hex);b[1]=Raphael.rgb2hsb(Raphael.getRGB(b[1]).hex);b[0].b=Math.min(b[0].b*c,1);b[0].s/=c;b[1].b=Math.min(b[1].b*c,1);b[1].s/=c;this.attr({fill:"hsb("+[b[0].h,b[0].s,b[0].b]+")",stroke:"hsb("+[b[1].h,b[1].s,b[1].b]+")"});return this};Raphael.el.darker=function(c){var c=c||2,b=[this.attrs.fill,this.attrs.stroke];this.fs=this.fs||[b[0],b[1]];b[0]=Raphael.rgb2hsb(Raphael.getRGB(b[0]).hex);b[1]=Raphael.rgb2hsb(Raphael.getRGB(b[1]).hex);b[0].s=Math.min(b[0].s*c,1);b[0].b/=c;b[1].s=Math.min(b[1].s*c,1);b[1].b/=c;this.attr({fill:"hsb("+[b[0].h,b[0].s,b[0].b]+")",stroke:"hsb("+[b[1].h,b[1].s,b[1].b]+")"});return this};Raphael.el.resetBrightness=function(){this.fs&&(this.attr({fill:this.fs[0],stroke:this.fs[1]}),delete this.fs);return this};(function(){var f=["lighter","darker","resetBrightness"],e="popup tag flag label drop blob".split(" "),c;for(c in e){(function(b){Raphael.st[b]=function(){return Raphael.el[b].apply(this,arguments)}})(e[c])}for(c in f){(function(b){Raphael.st[b]=function(){for(var a=0;a<this.length;a++){this[a][b].apply(this[a],arguments)}return this}})(f[c])}})();Raphael.g={shim:{stroke:"none",fill:"#000","fill-opacity":0},txtattr:{font:"12px Arial, sans-serif",fill:"#fff"},colors:function(){for(var f=[0.6,0.2,0.05,0.1333,0.75,0],e=[],c=0;10>c;c++){c<f.length?e.push("hsb("+f[c]+",.75, .75)"):e.push("hsb("+f[c-f.length]+", 1, .5)")}return e}(),snapEnds:function(m,i,h){function k(b){return 0.25>Math.abs(b-0.5)?~~b+0.5:Math.round(b)}var l=m,n=i;if(l==n){return{from:l,to:n,power:0}}var l=(n-l)/h,j=n=~~l,h=0;if(n){for(;j;){h--,j=~~(l*Math.pow(10,h))/Math.pow(10,h)}h++}else{if(0==l||!isFinite(l)){h=1}else{for(;!n;){h=h||1,n=~~(l*Math.pow(10,h))/Math.pow(10,h),h++}}h&&h--}n=k(i*Math.pow(10,h))/Math.pow(10,h);n<i&&(n=k((i+0.5)*Math.pow(10,h))/Math.pow(10,h));l=k((m-(0<h?0:0.5))*Math.pow(10,h))/Math.pow(10,h);return{from:l,to:n,power:h}},axis:function(Q,T,S,O,P,R,N,L,M,K,F){var K=null==K?2:K,M=M||"t",R=R||10,F=arguments[arguments.length-1],I="|"==M||" "==M?["M",Q+0.5,T,"l",0,0.001]:1==N||3==N?["M",Q+0.5,T,"l",0,-S]:["M",Q,T+0.5,"l",S,0],G=this.snapEnds(O,P,R),E=G.from,A=G.to,H=G.power,z=0,y={font:"11px 'Fontin Sans', Fontin-Sans, sans-serif"},G=F.set(),A=(A-E)/R,J=E,C=0<H?H:0,B=S/R;if(1==+N||3==+N){H=T;for(E=(N-1?1:-1)*(K+3+!!(N-1));H>=T-S;){"-"!=M&&" "!=M&&(I=I.concat(["M",Q-("+"==M||"|"==M?K:2*!(N-1)*K),H+0.5,"l",2*K+1,0])),G.push(F.text(Q+E,H,L&&L[z++]||(Math.round(J)==J?J:+J.toFixed(C))).attr(y).attr({"text-anchor":N-1?"start":"end"})),J+=A,H-=B}Math.round(H+B-(T-S))&&("-"!=M&&" "!=M&&(I=I.concat(["M",Q-("+"==M||"|"==M?K:2*!(N-1)*K),T-S+0.5,"l",2*K+1,0])),G.push(F.text(Q+E,T-S,L&&L[z]||(Math.round(J)==J?J:+J.toFixed(C))).attr(y).attr({"text-anchor":N-1?"start":"end"})))}else{for(var J=E,C=(0<H)*H,E=(N?-1:1)*(K+9+!N),H=Q,B=S/R,D=0,x=0;H<=Q+S;){"-"!=M&&" "!=M&&(I=I.concat(["M",H+0.5,T-("+"==M?K:2*!!N*K),"l",0,2*K+1])),G.push(D=F.text(H,T+E,L&&L[z++]||(Math.round(J)==J?J:+J.toFixed(C))).attr(y)),D=D.getBBox(),x>=D.x-5?G.pop(G.length-1).remove():x=D.x+D.width,J+=A,H+=B}Math.round(H-B-Q-S)&&("-"!=M&&" "!=M&&(I=I.concat(["M",Q+S+0.5,T-("+"==M?K:2*!!N*K),"l",0,2*K+1])),G.push(F.text(Q+S,T+E,L&&L[z]||(Math.round(J)==J?J:+J.toFixed(C))).attr(y)))}I=F.path(I);I.text=G;I.all=F.set([I,G]);I.remove=function(){this.text.remove();this.constructor.prototype.remove.call(this)};return I},labelise:function(f,e,c){return f?(f+"").replace(/(##+(?:\.#+)?)|(%%+(?:\.%+)?)/g,function(b,a,g){if(a){return(+e).toFixed(a.replace(/^#+\.?/g,"").length)}if(g){return(100*e/c).toFixed(g.replace(/^%+\.?/g,"").length)+"%"}}):(+e).toFixed(0)}};
;
/*
 * g.Raphael 0.51 - Charting library, based on Raphal
 *
 * Copyright (c) 2009-2012 Dmitry Baranovskiy (http://g.raphaeljs.com)
 * Licensed under the MIT (http://www.opensource.org/licenses/mit-license.php) license.
 */
(function(){function b(K,F,E,H,M,O){function w(s,u,t,r,q){var Q=Math.PI/180,p=s+t*Math.cos(-r*Q),n=s+t*Math.cos(-q*Q),o=s+t/2*Math.cos(-(r+(q-r)/2)*Q),m=u+t*Math.sin(-r*Q),l=u+t*Math.sin(-q*Q),Q=u+t/2*Math.sin(-(r+(q-r)/2)*Q),s=["M",s,u,"L",p,m,"A",t,t,0,+(180<Math.abs(q-r)),1,n,l,"z"];s.middle={x:o,y:Q};return s}var O=O||{},z=[],D=K.set(),P=K.set(),C=K.set(),B=M.length,I=0,G=0,A=0,J=O.maxSlices||100,L=parseFloat(O.minPercent)||1,y=Boolean(L);P.covers=D;if(1==B){C.push(K.circle(F,E,H).attr({fill:O.colors&&O.colors[0]||this.colors[0],stroke:O.stroke||"#fff","stroke-width":null==O.strokewidth?1:O.strokewidth})),D.push(K.circle(F,E,H).attr(this.shim)),G=M[0],M[0]={value:M[0],order:0,valueOf:function(){return this.value}},O.href&&O.href[0]&&D[0].attr({href:O.href[0]}),C[0].middle={x:F,y:E},C[0].mangle=180}else{for(var N=0;N<B;N++){G+=M[N],M[N]={value:M[N],order:N,valueOf:function(){return this.value}}}M.sort(function(f,e){return e.value-f.value});for(N=0;N<B;N++){if(y&&100*M[N]/G<L&&(J=N,y=!1),N>J){y=!1,M[J].value+=M[N],M[J].others=!0,A=M[J].value}}B=Math.min(J+1,M.length);A&&M.splice(B)&&(M[J].others=!0);for(N=0;N<B;N++){A=I-360*M[N]/G/2;N||(I=90-A,A=I-360*M[N]/G/2);if(O.init){var x=w(F,E,1,I,I-360*M[N]/G).join(",")}J=w(F,E,H,I,I-=360*M[N]/G);L=O.matchColors&&!0==O.matchColors?M[N].order:N;L=K.path(O.init?x:J).attr({fill:O.colors&&O.colors[L]||this.colors[L]||"#666",stroke:O.stroke||"#fff","stroke-width":null==O.strokewidth?1:O.strokewidth,"stroke-linejoin":"round"});L.value=M[N];L.middle=J.middle;L.mangle=A;z.push(L);C.push(L);O.init&&L.animate({path:J.join(",")},+O.init-1||1000,">")}for(N=0;N<B;N++){L=K.path(z[N].attr("path")).attr(this.shim),O.href&&O.href[N]&&L.attr({href:O.href[N]}),L.attr=function(){},D.push(L),C.push(L)}}P.hover=function(h,d){for(var d=d||function(){},g=this,f=0;f<B;f++){(function(c,j,i){var e={sector:c,cover:j,cx:F,cy:E,mx:c.middle.x,my:c.middle.y,mangle:c.mangle,r:H,value:M[i],total:G,label:g.labels&&g.labels[i]};j.mouseover(function(){h.call(e)}).mouseout(function(){d.call(e)})})(C[f],D[f],f)}return this};P.each=function(f){for(var d=0;d<B;d++){var e=C[d];f.call({sector:e,cover:D[d],cx:F,cy:E,x:e.middle.x,y:e.middle.y,mangle:e.mangle,r:H,value:M[d],total:G,label:this.labels&&this.labels[d]})}return this};P.click=function(d){for(var f=this,e=0;e<B;e++){(function(c,j,i){var h={sector:c,cover:j,cx:F,cy:E,mx:c.middle.x,my:c.middle.y,mangle:c.mangle,r:H,value:M[i],total:G,label:f.labels&&f.labels[i]};j.click(function(){d.call(h)})})(C[e],D[e],e)}return this};P.inject=function(c){c.insertBefore(D[0])};if(O.legend){I=O.legend;N=O.legendothers;x=O.legendmark;z=O.legendpos;A=F+H+H/5;J=E+10;I=I||[];z=z&&z.toLowerCase&&z.toLowerCase()||"east";x=K[x&&x.toLowerCase()]||"circle";P.labels=K.set();for(L=0;L<B;L++){var y=C[L].attr("fill"),v=M[L].order;M[L].others&&(I[v]=N||"Others");I[v]=this.labelise(I[v],M[L],G);P.labels.push(K.set());P.labels[L].push(K[x](A+5,J,5).attr({fill:y,stroke:"none"}));P.labels[L].push(y=K.text(A+20,J,I[v]||M[v]).attr(this.txtattr).attr({fill:O.legendcolor||"#000","text-anchor":"start"}));D[L].label=P.labels[L];J+=1.2*y.getBBox().height}K=P.labels.getBBox();P.labels.translate.apply(P.labels,{east:[0,-K.height/2],west:[-K.width-2*H-20,-K.height/2],north:[-H-K.width/2,-H-K.height-10],south:[-H-K.width/2,H+10]}[z]);P.push(P.labels)}P.push(C,D);P.series=C;P.covers=D;return P}var a=function(){};a.prototype=Raphael.g;b.prototype=new a;Raphael.fn.piechart=function(h,e,c,g,j){return new b(this,h,e,c,g,j)}})();
;
define("apps/tile/integrations/gauge_view_basic",["jquery","underscore"],function(c,b){function a(g,e,p,r){r=c.extend(true,{},a.defaults,r);var q=this,n={x:e/2,y:p},k=c.extend({},n,{y:n.y+r.needle.yOffset}),j=-90,i=r.logger,f;function o(s){f=Raphael(g,e,p);m(s);var t=h(s,r.needle.background);d(r.needle,t)}function d(t,v){var u=t.radius/Math.sqrt(2),s=["M",k.x-u,k.y-u,"A",t.radius,t.radius,0,1,0,Math.round(k.x+u),Math.round(k.y-u),"L",k.x,k.y-t.radius-t.length,"z"];i.info("Needle path",s.join(" "));q.needle=f.path(s.join(" ")).attr({fill:t.fill,stroke:t.stroke});q.needle.transform(["r",-90,k.x,k.y])}function m(s){f.piechart(n.x,p,p,l(s.sections.length),{colors:["transparent"].concat(b.pluck(s.sections,"color")),stroke:r.backgroundColor,maxSlices:s.length}).transform(["r180",n.x,p])}function h(v,z){var u=Math.PI*z.radius/v.sections.length,t=u/2,s=["M",n.x-z.radius,n.y,"a",z.radius,z.radius,0,1,1,z.radius*2,0],x=Raphael.getPointAtLength(s,u*v.activeIndex+t);i.info("semicircleArc (in blue)",s.join(" "));i.info("pointOnArc",{x:x.x,y:x.y});f.path(s.concat(["z"])).attr({fill:z.fill,stroke:z.stroke});q.angle=Math.round(Raphael.angle(k.x,k.y,x.x,x.y))+j;i.info("angle (in red)",q.angle+"");if(r.debug){var y=Raphael.pathIntersection(["M",k.x,k.y,"L",0,k.y],s)[0],w=["M",x.x,x.y,"L",k.x,k.y,"L",y.x,y.y,"z"];f.path(s).attr({stroke:"#00f"});f.path(w).attr({stroke:"#f00"})}}function l(u){var s=[5],t=function(){s.unshift(5/u)};b.times(u,t);return s}q.render=function(u){i.warn("Begin",{activeIndex:u.activeIndex,count:u.sections.length});i.info("Pivot point",k);var s=c.Deferred();c(g).empty();o(u);if(r.animation.enabled){var t=Raphael.animation({transform:["r"+q.angle,k.x,k.y]},r.animation.duration,r.animation.easing,function(){i.warn("End");s.resolve()}).delay(r.animation.delay);q.needle.animate(t)}else{q.needle.transform(["r"+q.angle,k.x,k.y])}return s.promise()};return q}a.defaults={animation:{delay:1000,duration:1500,easing:"backOut",enabled:true},backgroundColor:"#fff",debug:false,logger:{info:c.noop,warn:c.noop},needle:{background:{fill:"#fff",radius:100,stroke:"#fff"},fill:"#666",length:125,radius:10,stroke:"#000",yOffset:-12}};return a});
;
define("apps/tile/integrations/gauge",["jquery","jive/promise_util","apps/tile/tile","apps/tile/integrations/gauge_view_basic"],function(e,d,b,g){var c=300,a=150;function f(h){h=e.extend(true,{activeIndex:-1,sections:[]},h);return h.sections.length>0&&!!h.sections[h.activeIndex]}return{render:function(){e(".js-tile:has(.js-gauge)").each(function(i,k){var j=e(k).find(".js-gauge")[0],m=e(k).data(),h=m.latestData,l=h?d.success({data:h}):b.fromDOM(k);l.done(function(n){if(f(n.data)){(new g(j,c,a)).render(n.data)}})});e(".j-gauge-msg-toggle").on("click",function(){var h=e(".j-gauge-msg-less").toggle().is(":visible");e(".j-gauge-msg-more").toggle(h)})}}});
;
goog.provide("jive.integration.tiles.viewstyle.gauge");
jive.integration.tiles.viewstyle.gauge=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<header class="j-tile-header">',opt_data.sections&&opt_data.activeIndex&&opt_data.status?'<h4 id="tile-header-'+soy.$$escapeHtml(opt_data.tileInstanceId)+'" class="font-color-meta">Status: <span style="color: '+soy.$$escapeHtml(opt_data.sections[opt_data.activeIndex].color)+';">'+soy.$$escapeHtml(opt_data.status)+"</span></h4>":"","</header><section class=\"j-tile-body j-tile-gauge clearfix\"><div class=\"j-gauge js-gauge\"></div><script>\n                require(['jquery', 'apps/tile/integrations/gauge'], function($, gaugeController) {\n                    $(gaugeController.render.bind(gaugeController));\n                });\n            <\/script>",
opt_data.message?'<div class="j-gauge-msg-less" '+(opt_data.message.split(new RegExp("","")).length<120?' style="display:none"':"")+'><p class="j-gauge-msg">'+soy.$$truncate(soy.$$escapeHtml(opt_data.message),120,true)+" <a href=\"#\" class='j-gauge-msg-toggle'>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.tile.gauge.showmore"),[]))+'</a></p></div><div class="j-gauge-msg-more" '+(opt_data.message.split(new RegExp("","")).length>=120?' style="display:none"':"")+'><p class="j-gauge-msg">'+
soy.$$escapeHtml(opt_data.message)+" "+(opt_data.message.split(new RegExp("","")).length>=120?"<a href=\"#\" class='j-gauge-msg-toggle'>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.tile.gauge.showless"),[]))+"</a>":"")+"</p></div>":"","</section>");if(opt_data.action)jive.integration.tiles.view.footer(opt_data.action,output);return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.hero");
jive.integration.tiles.viewstyle.hero=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<section id="tile-hero-unit-',soy.$$escapeHtmlAttribute(opt_data.tileInstanceId),'" class="j-tile-body j-tile-hero-unit js-tile-hero-unit">');if(typeof opt_data.contents!="string"&&opt_data.contents.length!=0){var hasOverlay__soy8=opt_data.contents[0].caption.headline||opt_data.contents[0].caption.text||opt_data.action.text?true:false;output.append("<figure>",!hasOverlay__soy8&&
opt_data.action.url?' <a href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.action.url))+'" '+(opt_data.action.openInNewWindow?'target="_blank"':"")+"> ":"",'<img class="j-hero-image" alt="',soy.$$escapeHtmlAttribute(opt_data.contents[0].alt),'" src="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.contents[0].image))),'">',!hasOverlay__soy8&&opt_data.action.url?" </a> ":"",hasOverlay__soy8?'<figcaption class="j-hero-caption '+
soy.$$escapeHtmlAttribute(opt_data.contents[0].caption.position)+'">'+(opt_data.contents[0].caption.headline?'<h1 class="j-hero-headline">'+soy.$$escapeHtml(opt_data.contents[0].caption.headline)+"</h1>":"")+(opt_data.contents[0].caption.text?'<p class="j-hero-captiontext">'+soy.$$escapeHtml(opt_data.contents[0].caption.text)+"</p>":"")+(opt_data.action.text&&opt_data.action.url?'<a class="j-hero-actionlink" href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.action.url))+'" '+(opt_data.action.openInNewWindow?
'target="_blank"':"")+">"+soy.$$escapeHtml(opt_data.action.text)+" </a>":opt_data.action.url?'<a class="j-hero-actionlink" href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.action.url))+'" '+(opt_data.action.openInNewWindow?'target="_blank"':"")+">Read More </a>":"")+"</figcaption>":"","</figure>")}else output.append('<p class="noContent">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tile.hero_unit.empty"),[])),"</p>");output.append("</section>");return opt_sb?"":output.toString()};
;
goog.provide("jive.video.embedded.showandshareplayer");
jive.video.embedded.showandshareplayer=function(opt_data,opt_sb){opt_data=opt_data||{};var output=opt_sb||new soy.StringBuilder;var domain__soy3=opt_data.sourceDomain!=null?opt_data.sourceDomain:opt_data.bean.sourceDomain;var videoID__soy4=opt_data.videoId!=null?opt_data.videoId:opt_data.bean.videoID;var color__soy5="transparent";var width__soy6=opt_data.tileWidth!=null?opt_data.tileWidth:opt_data.bean.width;var height__soy7=opt_data.tileHeight!=null?opt_data.tileHeight:opt_data.bean.height;output.append('<body><object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" id="Embed-1.0-SNAPSHOT',
soy.$$escapeHtmlAttribute(videoID__soy4),'" width="',soy.$$escapeHtmlAttribute(width__soy6),'" height="',soy.$$escapeHtmlAttribute(height__soy7),'"><param name="src" value="',soy.$$escapeHtmlAttribute(domain__soy3),'/vportal/swf/Embed-1.0-SNAPSHOT.swf"/><param name="quality" value="high" /><param name="allowFullScreen" value="true" /><param name="allowNetworking" value="all" /><param name="allowScriptAccess" value="sameDomain" /><param name="bgcolor" value="',soy.$$escapeHtmlAttribute(color__soy5),
'" /><param name="flashVars" value="baseurl=',soy.$$escapeHtmlAttribute(domain__soy3),"/vportal/VideoPlayer.jsp?ccsid=",soy.$$escapeHtmlAttribute(videoID__soy4),'#&play=false&embedurl="/><param name="wmode" value="transparent"/><param name="play" value="true"/><param name="loop" value="false"/><embed src="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(domain__soy3)),'/vportal/swf/Embed-1.0-SNAPSHOT.swf" bgcolor="transparent" width="',soy.$$escapeHtmlAttribute(width__soy6),'" height="',soy.$$escapeHtmlAttribute(height__soy7),
'" id="Embed-1.0-SNAPSHOT',soy.$$escapeHtmlAttribute(videoID__soy4),'" name="Embed-1.0-SNAPSHOT',soy.$$escapeHtmlAttribute(videoID__soy4),'" align="middle" play="true" loop="false" flashVars="baseurl=',soy.$$escapeHtmlAttribute(domain__soy3),"/vportal/VideoPlayer.jsp?ccsid=",soy.$$escapeHtmlAttribute(videoID__soy4),'#&play=false&embedurl=" quality="high" allowfullscreen="true" wmode="transparent" allowscriptaccess="sameDomain" type="application/x-shockwave-flash" pluginspage="http://www.adobe.com/go/getflashplayer"/></object></body>');
return opt_sb?"":output.toString()};
;
goog.provide("jive.video.embedded.kalturaplayer");
jive.video.embedded.kalturaplayer=function(opt_data,opt_sb){opt_data=opt_data||{};var output=opt_sb||new soy.StringBuilder;var domain__soy3=opt_data.sourceDomain!=null?opt_data.sourceDomain:opt_data.bean.sourceDomain;var videoID__soy4=opt_data.videoId!=null?opt_data.videoId:opt_data.bean.videoID;var partnerID__soy5=opt_data.partnerID!=null?opt_data.partnerID:opt_data.bean.partnerID;var playerID__soy6=opt_data.playerID!=null?opt_data.playerID:opt_data.bean.playerID;var width__soy7=opt_data.tileWidth!=
null?opt_data.tileWidth:opt_data.bean.width;var height__soy8=opt_data.tileHeight!=null?opt_data.tileHeight:opt_data.bean.height;var color__soy9="#FFFFFF";output.append(domain__soy3==""?'<script type="text/javascript" src="https://cdnapisec.kaltura.com/p/'+soy.$$escapeHtmlAttribute(partnerID__soy5)+"/sp/"+soy.$$escapeHtmlAttribute(partnerID__soy5)+"00/embedIframeJs/uiconf_id/"+soy.$$escapeHtmlAttribute(playerID__soy6)+"/partner_id/"+soy.$$escapeHtmlAttribute(partnerID__soy5)+'"><\/script><body><object id="kaltura_player_'+
soy.$$escapeHtmlAttribute(videoID__soy4)+'" name="kaltura_player_'+soy.$$escapeHtmlAttribute(videoID__soy4)+'" type="application/x-shockwave-flash" height="'+soy.$$escapeHtmlAttribute(height__soy8)+'" width="'+soy.$$escapeHtmlAttribute(width__soy7)+'" allowFullScreen="true" allowNetworking="all" allowScriptAccess="always" data="https://cdnapisec.kaltura.com/index.php/kwidget/wid/_'+soy.$$escapeHtmlAttribute(partnerID__soy5)+"/uiconf_id/"+soy.$$escapeHtmlAttribute(playerID__soy6)+"/entry_id/"+soy.$$escapeHtmlAttribute(videoID__soy4)+
'" style="width: '+soy.$$escapeHtmlAttribute(soy.$$filterCssValue(width__soy7))+"px; height: "+soy.$$escapeHtmlAttribute(soy.$$filterCssValue(height__soy8))+'px;" xmlns:media="https://search.yahoo.com/searchmonkey/media/" rel="media:video" resource="https://cdnapisec.kaltura.com/index.php/kwidget/wid/_'+soy.$$escapeHtmlAttribute(partnerID__soy5)+"/uiconf_id/"+soy.$$escapeHtmlAttribute(playerID__soy6)+"/entry_id/"+soy.$$escapeHtmlAttribute(videoID__soy4)+'"><param name="allowFullScreen" value="true" /><param name="allowNetworking" value="all" /><param name="allowScriptAccess" value="always" /><param name="bgcolor" value="'+
soy.$$escapeHtmlAttribute(color__soy9)+'" /><param name="flashVars" value="" /><param name="movie" value="https://cdnapisec.kaltura.com/index.php/kwidget/wid/_'+soy.$$escapeHtmlAttribute(partnerID__soy5)+"/uiconf_id/"+soy.$$escapeHtmlAttribute(playerID__soy6)+"/entry_id/"+soy.$$escapeHtmlAttribute(videoID__soy4)+'" /><\!--You can enter alternate content here. --\></object></body>':'<body><object type="text/html" width="'+soy.$$escapeHtmlAttribute(width__soy7)+'" height="'+soy.$$escapeHtmlAttribute(height__soy8)+
'" style="overflow: hidden" data="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(domain__soy3))+"/embed/secure/iframe/entryId/"+soy.$$escapeHtmlAttribute(videoID__soy4)+'"></object></body>');return opt_sb?"":output.toString()};
;
goog.provide("jive.video.embedded.externalplayertriage");jive.video.embedded.externalplayertriage=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.videoProvider=="showandshare")jive.video.embedded.showandshareplayer(opt_data,output);else jive.video.embedded.kalturaplayer(opt_data,output);return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.iframe");
jive.integration.tiles.viewstyle.iframe=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.title)jive.integration.tiles.view.header(opt_data,output);output.append('<section class="j-tile-body clearfix">');if(opt_data.config&&opt_data.config.videoProvider&&(opt_data.config.videoProvider.match(new RegExp("(showandshare|brightcove|kaltura)",""))||[]).length>0){output.append('<div class="j-tile-embed-block"><div class="j-tile-embed-wrapper">');jive.video.embedded.externalplayertriage(opt_data.config,
output);output.append("</div></div>")}else if(opt_data.contents&&typeof opt_data.contents!="string"){var frameId__soy15=jive.soy.func.randomString();var frameSrc__soy16=(opt_data.contents.url.match(new RegExp("^\\$/",""))||[]).length>0?jive.soy.func.buildSecureSubdomainUrl(opt_data.contents.url.replace(new RegExp("^\\$",""),"")):opt_data.contents.url;var isExternalVideo__soy17=opt_data.config&&opt_data.config.videoProvider&&(opt_data.config.videoProvider.match(new RegExp("(youtube|vimeo)",""))||[]).length>
0;var height__soy18=opt_data.config.tileHeight?opt_data.config.tileHeight:opt_data.height;output.append('<iframe src="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(frameSrc__soy16)),'" id="',soy.$$escapeHtmlAttribute(frameId__soy15),'" frameborder="0" allowfullscreen="true" class="j-tile-iframe j-tile-iframe-',soy.$$escapeHtmlAttribute(opt_data.columnWidth?opt_data.columnWidth:opt_data.config.size),!(opt_data.responsive||isExternalVideo__soy17)?" j-tile-iframe-not-responsive":"",'"',height__soy18&&
(height__soy18.match(new RegExp("^[1-9]\\d*$",""))||[]).length>0?'style="height:'+soy.$$escapeHtmlAttribute(soy.$$filterCssValue(height__soy18))+'px;"':"","></iframe>",opt_data.message?'<script type="text/javascript">require([\'apps/shared/controllers/localexchange\'], function(localExchange){(function(msg){var frame = document.getElementById("'+soy.$$escapeJsString(frameId__soy15)+"\"); var target = frame.src.substring(0,frame.src.indexOf('/', 8)); frame.addEventListener(\"load\", function(){frame.contentWindow.postMessage(msg, target); var div = $j(frame).contents().find('#__content'); $j(div).bind(\"DOMSubtreeModified\", function() {$j(div).unbind(\"DOMSubtreeModified\"); div.find('a').each(function() {var href = $j(this).attr('href'); $j(this).attr('target', '_parent'); if ("+
soy.$$escapeJsValue(opt_data.openInNewWindow)+" && isExternalUrl(href)) {$j(this).attr('target', '_blank'); $j(this).attr('href', '"+soy.$$filterNoAutoescape(opt_data.jiveUrl)+"/external-link.jspa?url=' + encodeURIComponent(href));}}); localExchange.emit('htmlTile', div);});});})(\""+soy.$$escapeJsString(opt_data.message)+'"); function isExternalUrl(url) {return !url.startsWith("'+soy.$$filterNoAutoescape(opt_data.jiveUrl)+'");};});<\/script>':"")}else output.append(opt_data.contents?opt_data.contents.replace(new RegExp("\\.",
"g"),"_")=="tile_video_empty"?'<p class="noContent">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tile.video.empty"),[]))+"</p>":'<p class="noContent">'+soy.$$escapeHtml(opt_data.contents)+"</p>":'<p class="noContent">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tile.iframe.empty"),[]))+"</p>");output.append(opt_data.description?'<div class="j-contentDescription">'+soy.$$changeNewlineToBr(soy.$$escapeHtml(opt_data.description))+"</div>":"","</section>");if(opt_data.action)jive.integration.tiles.view.footer(opt_data.action,
output);return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.image_grid");
jive.integration.tiles.viewstyle.image_grid=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.integration.tiles.view.header(opt_data,output);output.append('<section class="j-image-grid-tile clearfix">');if(opt_data.contents&&typeof opt_data.contents!="string"&&opt_data.contents.length!=0){var itemList9=opt_data.contents;var itemListLen9=itemList9.length;for(var itemIndex9=0;itemIndex9<itemListLen9;itemIndex9++){var itemData9=itemList9[itemIndex9];output.append('<figure class="j-tile-gallery-img"><a href="',
soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,itemData9.url))),'"><img src="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,itemData9.image))),'" height="120" width="160" alt="" border="0"></a><figcaption><a href="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,itemData9.url))),'" class="font-color-white">',soy.$$escapeHtml(itemData9.titleText),
"</a></figcaption></figure>")}}else jive.integration.tiles.defaults.noContent(opt_data,output);output.append("</section>");if(opt_data.action)jive.integration.tiles.view.footer(opt_data.action,output);return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.link");
jive.integration.tiles.viewstyle.link=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<li class="listItem ',opt_data.jiveIconClasses||opt_data.iconUrl?"showIcon":opt_data.avatar?"showIcon ic24":"noIcon",'">');if(opt_data.action){jive.integration.tiles.view.actionLink(soy.$$augmentMap(opt_data.action,{classes:"js-accordion-link linkText "+(opt_data.avatar?"j-avatar  jiveTT-hover-user":"")+" ",attrs:opt_data.action.userId!=null?'data-userid="'+soy.$$escapeHtml(opt_data.action.userId)+
'"':"",text:(opt_data.jiveIconClasses?'<span class="'+soy.$$escapeHtml(opt_data.jiveIconClasses)+' icn"></span>':"")+(opt_data.avatar?'<img src="'+soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.avatar))+'" class="jive-avatar icn" alt="">':"")+(opt_data.iconUrl?'<img src="'+soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.iconUrl))+'" class="icn" alt="">':"")+soy.$$escapeHtml(opt_data.text),noEscapeText:true}),output);if(opt_data.byline)jive.integration.tiles.viewstyle.byline(opt_data.byline,
output);output.append(opt_data.external?'<span class="j-browse-external-access"><em>'+(opt_data.avatar?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tile.sectionList.external.contributor"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tile.sectionList.ext_access"),[])))+"</em></span>":"")}else{output.append(opt_data.jiveIconClasses?'<span class="'+soy.$$escapeHtml(opt_data.jiveIconClasses)+' icn"></span>':"",opt_data.avatar?'<img src="'+soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,
opt_data.avatar))+'" class="jive-avatar icn" alt="">':"",soy.$$escapeHtml(opt_data.text));if(opt_data.byline)jive.integration.tiles.viewstyle.byline(opt_data.byline,output);output.append(opt_data.external?'<span class="j-browse-external-access"><em>'+(opt_data.avatar?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tile.sectionList.external.contributor"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tile.sectionList.ext_access"),[])))+"</em></span>":"")}output.append("</li>");return opt_sb?
"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.sectionClasses");jive.integration.tiles.viewstyle.sectionClasses=function(opt_data,opt_sb){opt_data=opt_data||{};var output=opt_sb||new soy.StringBuilder;output.append(opt_data.config&&opt_data.config.displayWidth=="WIDE"?"j-tile-body j-tile-list-wide clearfix":opt_data.config&&opt_data.config.displayWidth=="HERO"?"j-tile-body j-tile-list-hero clearfix":"j-tile-body j-tile-list-narrow clearfix");return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.ulClasses");jive.integration.tiles.viewstyle.ulClasses=function(opt_data,opt_sb){opt_data=opt_data||{};var output=opt_sb||new soy.StringBuilder;output.append(opt_data.config&&(opt_data.config.listStyle&&opt_data.config.listStyle=="peopleList"||opt_data.config.style&&opt_data.config.style=="peopleList")?"peopleList j-icon-list":"contentList j-icon-list");return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.listItem");
jive.integration.tiles.viewstyle.listItem=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<li class="listItem ',opt_data.jiveIconClasses?"showIcon":opt_data.icon?"showIcon ic"+soy.$$escapeHtml(opt_data.iconClass):"noIcon",'">');if(opt_data.action){var param45=new soy.StringBuilder;if(opt_data.icon||opt_data.jiveIconClasses)jive.integration.tiles.viewstyle.icon(opt_data,param45);param45.append(soy.$$escapeHtml(opt_data.text));jive.integration.tiles.view.actionLink(soy.$$augmentMap(opt_data.action,
{classes:"linkText "+(opt_data.linkDescription?"showDescription ":"")+(opt_data.userID?"jiveTT-hover-user ":"")+(opt_data.userIsPartner?"j-partner ":"")+(opt_data.containerID?"jivecontainerTT-hover-container ":""),attrs:(opt_data.userID?'data-userid="'+soy.$$escapeHtml(opt_data.userID)+'" ':"")+(opt_data.containerID?'data-objectid="'+soy.$$escapeHtml(opt_data.containerID)+'" ':"")+(opt_data.containerType?'data-objecttype="'+soy.$$escapeHtml(opt_data.containerType)+'" ':""),text:param45.toString(),
containerUrl:opt_data.action.relativeUrl&&opt_data.place?soy.$$escapeHtml(opt_data.place.objectURL):"",noEscapeText:true}),output)}else{if(opt_data.icon||opt_data.jiveIconClasses)jive.integration.tiles.viewstyle.icon(opt_data,output);output.append(opt_data.url?'<a href="'+soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.url))+'" class="linkText">'+soy.$$filterNoAutoescape(opt_data.text)+"</a>":soy.$$escapeHtml(opt_data.text))}output.append(opt_data.showDescription&&
opt_data.linkDescription?'<p class="linkDescription">'+soy.$$escapeHtml(opt_data.linkDescription)+"</p>":"",opt_data.showDescription&&opt_data.linkMoreDescription?'<p class="linkDescription">'+soy.$$escapeHtml(opt_data.linkMoreDescription)+"</p>":"","</li>");return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.list");
jive.integration.tiles.viewstyle.list=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.integration.tiles.view.header(opt_data,output);output.append('<section class="');jive.integration.tiles.viewstyle.sectionClasses(opt_data,output);output.append('">');if(opt_data.contents&&typeof opt_data.contents!="string"&&opt_data.contents.length!=0){var itemList12=opt_data.contents;var itemListLen12=itemList12.length;for(var itemIndex12=0;itemIndex12<itemListLen12;itemIndex12++){var itemData12=
itemList12[itemIndex12];if(itemIndex12==0){output.append('<ul class="');jive.integration.tiles.viewstyle.ulClasses(opt_data,output);output.append('">')}if(typeof itemData12=="string")jive.integration.tiles.viewstyle.listItem(soy.$$augmentMap(itemData12,{text:itemData12,place:opt_data.place}),output);else if(opt_data.config&&opt_data.config.listStyle=="peopleList")jive.integration.tiles.viewstyle.listItem(soy.$$augmentMap(itemData12,{iconClass:(itemData12.action&&itemData12.action.iconSize?soy.$$escapeHtml(itemData12.action.iconSize):
"48")+" jive-avatar",place:opt_data.place,showDescription:true}),output);else jive.integration.tiles.viewstyle.listItem(soy.$$augmentMap(itemData12,{iconClass:itemData12.action&&itemData12.action.iconSize?soy.$$escapeHtml(itemData12.action.iconSize):"16",place:opt_data.place}),output);output.append(itemIndex12==itemListLen12-1?"</ul>":"")}}else jive.integration.tiles.defaults.noContent(opt_data,output);output.append("</section>");if(opt_data.action&&!opt_data.hideAllContentLink)jive.integration.tiles.view.footer(opt_data.action,
output);return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.listItem_2");
jive.integration.tiles.viewstyle.listItem_2=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<li class="listItem ',opt_data.jiveIconClasses?"showIcon":opt_data.icon?"showIcon ic"+soy.$$escapeHtml(opt_data.iconClass):"noIcon",'">');if(opt_data.action){var param45=new soy.StringBuilder;if(opt_data.icon||opt_data.jiveIconClasses)jive.integration.tiles.viewstyle.icon(opt_data,param45);param45.append(soy.$$escapeHtml(opt_data.text));jive.integration.tiles.view.actionLink(soy.$$augmentMap(opt_data.action,
{classes:"linkText "+(opt_data.description?"showDescription ":"")+(opt_data.userID?"jiveTT-hover-user ":"")+(opt_data.userIsPartner?"j-partner ":"")+(opt_data.containerID?"jivecontainerTT-hover-container ":""),attrs:(opt_data.userID?'data-userid="'+soy.$$escapeHtml(opt_data.userID)+'" ':"")+(opt_data.containerID?'data-objectid="'+soy.$$escapeHtml(opt_data.containerID)+'" ':"")+(opt_data.containerType?'data-objecttype="'+soy.$$escapeHtml(opt_data.containerType)+'" ':""),text:param45.toString(),containerUrl:opt_data.action.relativeUrl&&
opt_data.place?soy.$$escapeHtml(opt_data.place.objectURL):"",noEscapeText:true}),output)}else{if(opt_data.icon||opt_data.jiveIconClasses)jive.integration.tiles.viewstyle.icon(opt_data,output);output.append(soy.$$escapeHtml(opt_data.text))}output.append(opt_data.showDescription&&opt_data.description?'<p class="linkDescription">'+soy.$$escapeHtml(opt_data.description)+"</p>":"",opt_data.showDescription&&opt_data.moreDescription?'<p class="linkDescription">'+soy.$$escapeHtml(opt_data.moreDescription)+
"</p>":"","</li>");return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.list_2");
jive.integration.tiles.viewstyle.list_2=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.integration.tiles.view.header(opt_data,output);output.append('<section class="');jive.integration.tiles.viewstyle.sectionClasses(opt_data,output);output.append('">');if(opt_data.contents&&typeof opt_data.contents!="string"&&opt_data.contents.length!=0){var itemList12=opt_data.contents;var itemListLen12=itemList12.length;for(var itemIndex12=0;itemIndex12<itemListLen12;itemIndex12++){var itemData12=
itemList12[itemIndex12];if(itemIndex12==0){output.append('<ul class="');jive.integration.tiles.viewstyle.ulClasses(opt_data,output);output.append('">')}if(typeof itemData12=="string")jive.integration.tiles.viewstyle.listItem_2({text:itemData12,place:opt_data.place},output);else if(opt_data.config&&opt_data.config.style&&opt_data.config.style=="peopleList")jive.integration.tiles.viewstyle.listItem_2(soy.$$augmentMap(itemData12,{iconClass:(itemData12.action&&itemData12.action.iconSize?soy.$$escapeHtml(itemData12.action.iconSize):
"48")+" jive-avatar",place:opt_data.place,showDescription:true}),output);else jive.integration.tiles.viewstyle.listItem_2(soy.$$augmentMap(itemData12,{iconClass:itemData12.action&&itemData12.action.iconSize?soy.$$escapeHtml(itemData12.action.iconSize):"16",place:opt_data.place}),output);output.append(itemIndex12==itemListLen12-1?"</ul>":"")}}else output.append('<p class="noContent">',typeof opt_data.contents=="string"?soy.$$escapeHtml(opt_data.contents):"","</p>");output.append("</section>");if(opt_data.action&&
!opt_data.hideAllContentLink)jive.integration.tiles.view.footer(opt_data.action,output);return opt_sb?"":output.toString()};
;
define("apps/tile/integrations/ask_a_question/views/question_view",["jquery","apps/shared/views/abstract_view"],function(b,a){return a.extend(function(c){this.init=function(e,h,g,f){var d=this;b(e).suggestBox({typeAheadOptions:{itemSelector:"li:visible:has('a')"},parseSearchString:function(i){if(i==""&&b(e).trigger("close.suggestBox")){}return i.trim()},processResults:function(k,j,i){var l=k.results.length>=1&&i&&i.trim()!="";return $j.extend(k,{isResults:l})},displayEmptySearch:false,queryFunc:h.search.bind(h),template:function(i){return f($j.extend(i,{placeName:b(e).data("placeName"),action:g}))},popoverOptions:{focusPopover:false,container:b(".js-ask-a-question-popover"),addClass:"j-autocomplete j-ask-a-question-picker"},closeOnBlur:false}).on("selectionChosen",function(k,i,j){d.$input.trigger("close")}).on("close",function(i){i.stopPropagation()})}})});
;
define("apps/tile/integrations/ask_a_question/models/question_source",["apps/shared/models/rest_service"],function(a){return a.extend(function(b,c){var d=this;b.resourceType="askaquestion";b.pluralizedResourceType=b.resourceType;this.init=function e(f){c.init.call(this,f);d.options=f};this.search=function(f){if(!f){f=""}return this.get("",{q:f,containerType:d.options.searchContainerType,containerID:d.options.searchContainerId,wholeCommunityScope:d.options.wholeCommunityScope,numResults:d.options.numResults,displayThreadResults:d.options.displayThreadResults,displayAnsweredQuestionResults:d.options.displayAnsweredQuestionResults,displayDocumentResults:d.options.displayDocumentResults,displayQuestionsOnly:d.options.displayQuestionsOnly,searchSubCommunities:d.options.searchSubCommunities})}})});
;
goog.provide("jive.integration.tiles.viewstyle.questionResults");
jive.integration.tiles.viewstyle.questionResults=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-pop-main j-menu j-quick-menu j-tile-ask-a-question-results">');if(opt_data.isResults){output.append("<ul>");var resultList7=opt_data.results;var resultListLen7=resultList7.length;for(var resultIndex7=0;resultIndex7<resultListLen7;resultIndex7++){var resultData7=resultList7[resultIndex7];output.append('<li><a href="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(resultData7.objectURL)),
"?q=",soy.$$escapeUri(opt_data.query),'" class="j-result-item"><span class="',soy.$$escapeHtmlAttribute(resultData7.objectCSS),'" /><span class="j-search-result lnk">',soy.$$escapeHtml(resultData7.subject),"</span><em>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.tile.ask.a.question.askedby"),[resultData7.userDisplayName,(resultData7.created?jive.model.DateUtil.parseISODateTime(resultData7.created):"")?_jive_moment(parseFloat(resultData7.created?jive.model.DateUtil.parseISODateTime(resultData7.created):
"")?parseFloat(resultData7.created?jive.model.DateUtil.parseISODateTime(resultData7.created):""):resultData7.created?jive.model.DateUtil.parseISODateTime(resultData7.created):"").add(_jive_timezoneoffset*60*60*1E3).lang(_jive_locale.toLowerCase().replace("_","-")).format("l"):""])),"</em></a></li>")}output.append("</ul>",opt_data.results.length>=5?'<a href="#" class="j-view-all-results js-view-all-results">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tile.askAQuestion.viewAllResults"),
[opt_data.placeName]))+"</a>":"",opt_data.action?'<button class="js-ask-it-button j-ask-question-btn" data-action="'+soy.$$escapeHtmlAttribute(opt_data.action)+'">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tile.askAQuestion.ask.it"),[]))+"</button>":"")}else output.append('<p class="j-no-results-msg">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tile.askAQuestion.noSimilar"),[])),'</p><a href="#" class="j-view-all-results js-view-all-results">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tile.askAQuestion.searchAllResultsInGroup"),
[opt_data.placeName])),"</a>",opt_data.action?'<button class="js-ask-it-button j-ask-question-btn" data-action="'+soy.$$escapeHtmlAttribute(opt_data.action)+'">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tile.askAQuestion.ask.it"),[]))+"</button>":"");output.append("</div>");return opt_sb?"":output.toString()};
;
define("apps/tile/integrations/ask_a_question/main",["apps/tile/integrations/ask_a_question/views/question_view","apps/tile/integrations/ask_a_question/models/question_source","soy!jive.integration.tiles.viewstyle.questionResults"],function(c,b,a){return jive.oo.Class.extend(function(d){d.init=function(){var k=jQuery,h=k("#js-ask-a-question-search");var g=h.data("containerId"),e=h.data("containerType"),f=h.data("maxResults"),j=h.data("action");var i=new b({searchContainerId:g,searchContainerType:e,wholeCommunityScope:(e==14&&g==1),numResults:f,displayThreadResults:false,displayAnsweredQuestionResults:false,displayDocumentResults:false,displayQuestionsOnly:true,searchSubCommunities:true});new c(h,i,j,a);k("body").off(".question").on("click.question touchstart.question","button.js-ask-it-button",function(m){m.preventDefault();var l=h.val();location.href=_jive_base_url+k(this).data("action")+"&containerID="+g+"&containerType="+e+"&subject="+l}).on("click.question touchstart.question",".js-view-all-results",function(l){l.preventDefault();var m=h.val();location.href=window._jive_base_url+k("#js-ask-a-question-search").data("all-results-url")+"&q="+m})}})});
;
goog.provide("jive.integration.tiles.viewstyle.question");
jive.integration.tiles.viewstyle.question=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.integration.tiles.view.header(opt_data,output);output.append('<section class="j-tile-body">',opt_data.place?'<span class="j-form"><label for="js-ask-a-question-search" class="j-508-label">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tile.askAQuestion.default"),[]))+'</label><input id="js-ask-a-question-search" required role="combobox" class="ask-a-question-search"'+(opt_data.action?
'data-action="'+soy.$$escapeHtmlAttribute(opt_data.action)+'"':"")+'data-container-type="'+soy.$$escapeHtmlAttribute(opt_data.place.objectType)+'" data-container-id="'+soy.$$escapeHtmlAttribute(opt_data.place.id)+'" data-max-results="'+soy.$$escapeHtmlAttribute(opt_data.maxNumberOfResults)+'" data-all-results-url="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.allResultsURL))+'" data-object-id="'+soy.$$escapeHtmlAttribute(opt_data.tileInstanceId)+'" '+(opt_data.place.name?'data-place-name="'+
soy.$$escapeHtmlAttribute(opt_data.place.name)+'"':opt_data.place.groupName?'data-place-name="'+soy.$$escapeHtmlAttribute(opt_data.place.groupName)+'"':"")+' type="text" aria-required="true" autocomplete="off" placeholder="'+soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("tile.askAQuestion.placeholder"),[]))+'" /></span><div class="js-ask-a-question-popover"></div>':"","</section>");jive.shared.soy.resourceInlineJs({code:"$j(function() {require(['apps/tile/integrations/ask_a_question/main'], function(questionFunction) {var func = new questionFunction();});});"},
output);return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.rowItem");
jive.integration.tiles.viewstyle.rowItem=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<tr class="',opt_data.rowIndex%2==1?"odd":"even",'"><td class="key">');if(typeof opt_data.name!="string"){output.append("<span>");jive.integration.tiles.view.actionLink(opt_data.name,output);output.append("</span>")}else output.append("<span>",soy.$$escapeHtml(opt_data.name),"</span>");output.append('</td><td class="value">');if(typeof opt_data.value!="string"){output.append("<span>");
jive.integration.tiles.view.actionLink(opt_data.value,output);output.append("</span>")}else output.append("<span>",opt_data.url?'<a href="'+soy.$$escapeHtml(opt_data.url)+'">'+soy.$$escapeHtml(opt_data.value)+"</a>":soy.$$escapeHtml(opt_data.value),"</span>");output.append("</td></tr>");return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.section");
jive.integration.tiles.viewstyle.section=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<li class="listItem ',opt_data.accordion?"showIcon":"noIcon"," ",!opt_data.hide&&opt_data.accordion?"active":"",'"><h5>',opt_data.accordion?'<a href="#" class="trigger"><span class="lnk">'+soy.$$escapeHtml(opt_data.text)+"</span></a>":"<span>"+soy.$$escapeHtml(opt_data.text)+"</span>",opt_data.desc?'<div class="linkDescription font-color-normal">'+soy.$$changeNewlineToBr(soy.$$escapeHtml(opt_data.desc))+
"</div>":"","</h5><div ",opt_data.hide?'style="display:none;"':"",'><ul class="linksDisplay contentList levelTwo j-icon-list">');var itemList34=opt_data.items;var itemListLen34=itemList34.length;for(var itemIndex34=0;itemIndex34<itemListLen34;itemIndex34++){var itemData34=itemList34[itemIndex34];jive.integration.tiles.viewstyle.link(itemData34,output)}if(opt_data.browseFilterURL)jive.integration.tiles.viewstyle.link(soy.$$augmentMap(opt_data.browseFilterURL,{action:opt_data.browseFilterURL,text:opt_data.browseFilterURL.text}),
output);output.append("</ul></div></li>");return opt_sb?"":output.toString()};
;
define("apps/tile/integrations/accordion",["jquery","underscore","apps/guided_navigation/helper"],function(f,b,d){var c={animate:false,heightStyle:"content",icons:{header:"jive-icon-glyph icon-arrow-right2 vmicon",activeHeader:"jive-icon-glyph icon-arrow-down2 vmicon"},activate:a};function a(g,h){h.newHeader.closest("li.listItem").addClass("active");h.oldHeader.closest("li.listItem").removeClass("active")}function e(g){return g.find(".guidedNavigation").length>0}return function(i){var h=this;h.tileID=i.tileID.replace("-1-","");var g=f('.js-tile[js-instance-id="'+h.tileID+'"]');g.find(".js-accordion-container").accordion(c);if(e(g)){b.each(g.find(".js-accordion-link"),function(m,l){var k=f(m),n=l+1;var j=d.processURL(k.attr("href"),n,h.tileID);k.attr("href",j)})}}});
;
goog.provide("jive.integration.tiles.viewstyle.sectionlist");
jive.integration.tiles.viewstyle.sectionlist=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.integration.tiles.view.header(opt_data,output);var accordion__soy6=String(opt_data.style).toLowerCase()=="accordion";output.append('<section class="j-tile-body j-tile-',soy.$$escapeHtmlAttribute(String(opt_data.style).toLowerCase())," j-tile-list-narrow ",opt_data.config&&opt_data.config.listStyle?soy.$$escapeHtmlAttribute(opt_data.config.listStyle):"",'">',accordion__soy6?"<script>require([ 'apps/tile/integrations/accordion', 'documentReady' ], function(Accordion) {var main = new Accordion({tileID: '"+
soy.$$escapeJsString(opt_data.tileInstanceId)+"'});});<\/script>":"");if(opt_data.content&&typeof opt_data.content!="string"&&opt_data.content.length!=0){output.append('<ul class="',accordion__soy6?"js-accordion-container":""," contentList levelOne col",soy.$$escapeHtmlAttribute(opt_data.content.length),'sections">');var sectionList28=opt_data.content;var sectionListLen28=sectionList28.length;for(var sectionIndex28=0;sectionIndex28<sectionListLen28;sectionIndex28++){var sectionData28=sectionList28[sectionIndex28];
jive.integration.tiles.viewstyle.section(soy.$$augmentMap(sectionData28,{hide:!(sectionIndex28==0)&&accordion__soy6,accordion:accordion__soy6}),output)}output.append("</ul>")}else jive.integration.tiles.defaults.noContent(soy.$$augmentMap(opt_data,{contents:opt_data.content}),output);output.append("</section>");return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.viewstyle.table");
jive.integration.tiles.viewstyle.table=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<header class="j-tile-header"><h4 id="tile-header-',soy.$$escapeHtml(opt_data.tileInstanceId),'" class="font-color-meta">',soy.$$escapeHtml(opt_data.title),'</h4></header><section class="j-tile-body j-tile-table">');if(typeof opt_data.contents!="string"&&opt_data.contents.length!=0){output.append("<table>");var itemList11=opt_data.contents;var itemListLen11=itemList11.length;for(var itemIndex11=
0;itemIndex11<itemListLen11;itemIndex11++){var itemData11=itemList11[itemIndex11];jive.integration.tiles.viewstyle.rowItem(soy.$$augmentMap(itemData11,{rowIndex:itemIndex11}),output)}output.append("</table>")}else output.append('<p class="noContent">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.tile.table.default"),[])),"</p>");output.append("</section>");if(opt_data.action)jive.integration.tiles.view.footer(opt_data.action,output);return opt_sb?"":output.toString()};
;
define("apps/video/models/video_render_model",["jquery","lib/jiverscripts/src/oo/class","url"],function(c,a,b){return a.extend(function(){this.getVideoData=function(e,d,f){return c.get(b.v2Url("/videos")+"/"+e+"?objectType="+d+"&objectID="+f)}})});
;
define("apps/content/videos/view/config",function(){return{maxWidth:1280,maxHeight:720,originalAspectRatio:1.77,offsetPercentage:76,offsetParentPercentage:90,fixedPlayerSize:false,defaultWidth:1280,defaultHeight:720,enableAutoResize:false,container:{color:"#3d3d3d",height:560}}});
;
define("apps/content/videos/view/view_utils",["jquery","lib/jiverscripts/src/oo/class","apps/content/videos/view/config"],function(c,a,b){return a.extend(function(d){this.init=function(e,f){this.$parentVideoContainer=e;this.videoContainer=f;this.$videoContainer=null};this.centerElement=function(e){var j=e.parent(),i=e.children()[0],h=0;e.siblings().each(function(){if(!(c(this).css("display")=="none")){h+=isNaN(c(this).height())?0:c(this).height()}});if(i&&i.tagName.toUpperCase()==="IFRAME"){e.height(c(i).height());e.width(c(i).width())}else{e.height("100%");e.width("100%")}var f=parseInt((j.height()-e.height()-h)/2);var g=parseInt((j.width()-e.width())/2);e.css("margin-top",f+"px");e.css("margin-left",g+"px")};this.centerVideo=function(){this.centerElement(this.getVideoContainer())};this.detectResize=function(){var e=this;c(window).resize(function(){if(b.enableAutoResize){e.resizePlayer()}})};this.resizePlayer=function(){var f=this,j=f.getVideoContainer(),g=j.parent(),i=0;if(!b.fixedPlayerSize){j.siblings().each(function(){if(!(c(this).css("display")=="none")){i+=isNaN(c(this).height())?0:c(this).height()}});g=g.height()>0?g:c("#jive-body-main");var e=parseInt((g.height()-i)*b.offsetParentPercentage/100);e=e<b.maxHeight?e:b.maxHeight;var h=parseInt(e*b.originalAspectRatio);if(h>=g.width()*b.offsetParentPercentage/100){h=parseInt((g.width()-i)*b.offsetParentPercentage/100);e=parseInt(h/b.originalAspectRatio)}f.setPlayerSizes(h,e)}f.centerElement(j);return{width:h,height:e}};this.setFixedPlayerSizes=function(g,e){var f=this;b.fixedPlayerSize=true;f.setPlayerSizes(g,e);f.resizePlayer()};this.setPlayerSizes=function(g,f){var e=this,i=e.getVideoContainer(),h=i.children();i.width(g).height(f);if(h.length){if(h.attr("src")&&h.attr("src").indexOf("standalone-video-player")>=0){e.centerElement(h)}else{h.css("width",g);h.css("height",f);h.attr("width",g);h.attr("height",f)}}};d.getVideoContainer=function(){var e=this;if(!e.$videoContainer){e.$videoContainer=e.$parentVideoContainer.find(e.videoContainer)}return e.$videoContainer}})});
;
goog.provide("jive.videos.common.encodingWarning");
jive.videos.common.encodingWarning=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<link rel="stylesheet" href="',soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/styles/jive-content.css")),'" type="text/css" media="all" /><div class="jive-video-encode-box"><div class="jive-video-message-large"> ',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("video.encoding.text"),[])),' </div><div class="jive-video-encode-icon"></div></div>');return opt_sb?
"":output.toString()};
;
define("apps/video/views/video_render_view","jquery lib/jiverscripts/src/oo/class apps/content/videos/view/view_utils apps/content/videos/view/config url soy!jive.videos.common.encodingWarning".split(" "),function($$$$,$Class$$,$ViewUtils$$,$viewConfig$$,$url$$0$$,$encodingWarn$$){return $Class$$.extend(function($protect$$){var $fixedWidth$$,$fixedHeight$$;this.init=function $this$init$($containerSelector$$,$options$$){this.$videoContainer=$$$$($containerSelector$$);this.isTiny=void 0===$options$$.isTiny?
!1:$options$$.isTiny;this.video=$options$$.video;this.utils=new $ViewUtils$$($$$$($containerSelector$$).parent(),$containerSelector$$);$options$$&&!1!==$options$$.detectResize&&this.utils.detectResize()};this.loadPerceptiveVideo=function $this$loadPerceptiveVideo$(){this.renderVideo();this.showVideoPlayerElements();this.isTiny||this.utils.centerVideo()};this.loadEmbeddedVideo=function $this$loadEmbeddedVideo$(){var $video$$=this.video,$iframe_setSizesOrig$$=$video$$.setSizes,$height$$=$video$$.height,
$width$$=$video$$.width;parentIsTable=this.$videoContainer.parents(".mce-item-table").is("table");if(!$video$$.hasOwnProperty("videoType")||"video_perceptive_type"===$video$$.videoType)if((!$video$$.hasOwnProperty("service")||$video$$.videoType.startsWith("Brightcove"))&&!$video$$.transcoded){$video$$.embedded?this.$videoContainer.html($encodingWarn$$()):this.$videoContainer.replaceWith($encodingWarn$$());return}$video$$.videoSource.match(/data-showshare-player/)&&($video$$.setSizes&&440==$video$$.width?
($width$$=$fixedWidth$$="440",$height$$=$fixedHeight$$="299"):($width$$=$fixedWidth$$="747",$height$$=$fixedHeight$$="470.1875"),$viewConfig$$.fixedPlayerSize=!0,$video$$.setSizes=!1);this.isTiny&&($height$$=this.$videoContainer.find("img").height(),$width$$=this.$videoContainer.find("img").width());$iframe_setSizesOrig$$='\x3ciframe src\x3d"embedded-video-player.jspa?autoplay\x3d'+$video$$.autoplay+"\x26mediaID\x3d"+$video$$.videoID+"\x26fixedPlayerSize\x3d"+$viewConfig$$.fixedPlayerSize+"\x26setSizes\x3d"+
$iframe_setSizesOrig$$+"\x26width\x3d"+$width$$+'" frameborder\x3d"0" height\x3d"'+$height$$+'" width\x3d"'+$width$$+'" id\x3d"mediaFrame" name\x3d"mediaFrame" loading\x3d"lazy" class\x3d"e14-video-iframe" allowTransparency\x3d"true" tabIndex\x3d"0" allowfullscreen\x3e \x3c/iframe\x3e';parentIsTable||($iframe_setSizesOrig$$='\x3cdiv class\x3d"e14-video-container" style\x3d"max-width: '+$width$$+'px"\x3e\x3cdiv class\x3d"e14-video"\x3e'+$iframe_setSizesOrig$$+"\x3c/div\x3e\x3c/div\x3e");this.insertVideoElement($iframe_setSizesOrig$$,
$video$$.setSizes,$width$$,$height$$)};this.processVideoForThumbnails=function $this$processVideoForThumbnails$(){var $view$$=this,$video$$=$view$$.video,$embedChildren_videoEmbed$$=$$$$($video$$.videoSource),$src$$=$embedChildren_videoEmbed$$.attr("src");if(void 0===$src$$)for(var $embedChildren_videoEmbed$$=$embedChildren_videoEmbed$$.children(),$i$$=0;$i$$<$embedChildren_videoEmbed$$.length;$i$$++){var $childElement$$=$embedChildren_videoEmbed$$[$i$$],$tagName$$=$childElement$$.tagName.toLowerCase();
if("iframe"==$tagName$$){$src$$=$$$$($childElement$$).attr("src");break}if("object"==$tagName$$){$src$$=$$$$($childElement$$).attr("data");break}if("param"==$tagName$$&&$$$$($childElement$$).attr("movie")){$src$$=$$$$($childElement$$).attr("value");break}if("embed"==$tagName$$){$src$$=$$$$($childElement$$).attr("src");break}}require(["apps/shared/models/meta_source"],function($MetaSource_meta$$){if($MetaSource_meta$$=new $MetaSource_meta$$){null==$src$$.match(/https?\:(?=\/\/)/)&&($src$$=$src$$.replace("//",
"https://"));var $indexAmp_indexUrl$$=$src$$.indexOf("url\x3d");-1!==$indexAmp_indexUrl$$&&($src$$=$src$$.substring($indexAmp_indexUrl$$+4),$indexAmp_indexUrl$$=$src$$.indexOf("\x26"),$src$$=$src$$.substring(0,$indexAmp_indexUrl$$));$src$$=decodeURIComponent($src$$);$MetaSource_meta$$.fetchEmbedly($src$$).addCallback(function($data$$){$data$$&&($video$$.data=$data$$,$data$$.images&&($data$$.images[0]&&$data$$.images[0].url)&&$view$$.loadThumb($data$$.images[0].url))})}})};this.loadThumb=function $this$loadThumb$($thumbUrl$$){$thumbUrl$$=
$thumbUrl$$?$thumbUrl$$:this.video.videoThumbnail;this.$videoContainer.find("img").attr("src",this.matchProtocols($thumbUrl$$))};this.getVideo=function $this$getVideo$(){return this.video};$protect$$.renderVideo=function $$protect$$$renderVideo$(){var $$videoIframe_video$$=this.video;if($$videoIframe_video$$.transcoded){var $sizes$$;$sizes$$=this.isTiny?{height:this.$videoContainer.find("img").height(),width:this.$videoContainer.find("img").width()}:this.utils.resizePlayer();$$videoIframe_video$$=
this.makeVideoIframe($$videoIframe_video$$,$sizes$$);this.$videoContainer.find("img").replaceWith($$videoIframe_video$$);null==$$videoIframe_video$$[0].contentWindow&&this.$videoContainer.append($$videoIframe_video$$)}else $$videoIframe_video$$.embedded?this.$videoContainer.html($encodingWarn$$()):this.$videoContainer.replaceWith($encodingWarn$$())};$protect$$.makeVideoIframe=function $$protect$$$makeVideoIframe$($video$$,$sizes$$){var $externalVideoID$$=$video$$.externalID?""+$video$$.externalID:
"";return $$$$('\x3ciframe width\x3d"'+$sizes$$.width+'" height\x3d"'+$sizes$$.height+'" id\x3d"iframe_'+$externalVideoID$$+'" style\x3d"background-color:black" allowfullscreen\x3d"true" src\x3d"'+$url$$0$$.absoluteBaseUrl("/standalone-video-player.jspa",{videoID:$externalVideoID$$,width:$sizes$$.width-16,height:$sizes$$.height-16,authtoken:$video$$.authtoken,embedded:$video$$.embedded})+'"\x3e')};$protect$$.showVideoPlayerElements=function $$protect$$$showVideoPlayerElements$(){$$$$(".jive-video-poster").hide();
this.$videoContainer.show();$$$$(".jive-video-message").hide()};$protect$$.insertVideoElement=function $$protect$$$insertVideoElement$($videoElement$$,$setSizes$$,$setWidth$$,$setHeight$$){this.$videoContainer.empty().append($videoElement$$).show();$viewConfig$$.fixedPlayerSize?this.utils.setFixedPlayerSizes($fixedWidth$$,$fixedHeight$$):$setSizes$$&&this.applyElementSizing($videoElement$$,$setWidth$$,$setHeight$$);this.showVideoPlayerElements();!this.isTiny&&!$setSizes$$&&this.utils.resizePlayer()};
$protect$$.applyElementSizing=function $$protect$$$applyElementSizing$($element$$4_embedChildren$$,$width$$,$height$$){$element$$4_embedChildren$$=$$$$($element$$4_embedChildren$$);$element$$4_embedChildren$$.attr("width",$width$$+"px");$element$$4_embedChildren$$.attr("height",$height$$+"px");$element$$4_embedChildren$$=$element$$4_embedChildren$$.children();for(var $i$$=0;$i$$<$element$$4_embedChildren$$.length;$i$$++){var $childElement$$=$element$$4_embedChildren$$[$i$$],$tagName$$=$childElement$$.tagName.toLowerCase();
if("iframe"==$tagName$$||"object"==$tagName$$||"embed"==$tagName$$)$$$$($childElement$$).attr("width",$width$$+"px"),$$$$($childElement$$).attr("height",$height$$+"px")}};$protect$$.matchProtocols=function $$protect$$$matchProtocols$($url$$){return $url$$.replace("http://","//")}})});
;
define("apps/video/video_render_main",["jquery","lib/jiverscripts/src/oo/class","apps/video/models/video_render_model","apps/video/views/video_render_view"],function($$$$,$Class$$,$Model$$,$View$$){return $Class$$.extend(function($protect$$){this.init=function $this$init$($options$$){this.model=new $Model$$;this.options=$options$$;this.VIDEO_EMBEDDED_TYPE="video_embeded_type";this.VIDEO_PERCEPTIVE_TYPE="video_perceptive_type";this.videos={};this.views={}};this.getVideoDataAndRender=function $this$getVideoDataAndRender$($options$$){this.genericGetDataAndRender("videoResultHandler",
$options$$)};this.getVideoThumbnailAndRender=function $this$getVideoThumbnailAndRender$($options$$){this.genericGetDataAndRender("thumbnailResultHandler",$options$$)};$protect$$.genericGetDataAndRender=function $$protect$$$genericGetDataAndRender$($handlerResult$$,$options$$){var $main$$=this,$model$$=$main$$.model;$main$$.videos&&null!=$main$$.videos[$options$$.videoID]?($options$$.video=$main$$.videos[$options$$.videoID],$main$$.views[$options$$.divID]=new $View$$("#"+$options$$.divID,$options$$),
$main$$[$handlerResult$$]($main$$.views[$options$$.divID])):$model$$.getVideoData($options$$.videoID,$options$$.objectType,$options$$.objectID).success(function($video$$){$video$$.authtoken&&($video$$.videoID=$options$$.videoID,$options$$.width&&$video$$&&($video$$.width=$options$$.width,$video$$.setSizes=!0),$options$$.height&&$video$$&&($video$$.height=$options$$.height,$video$$.setSizes=!0),$options$$.autoplay&&$video$$&&($video$$.autoplay=$options$$.autoplay),$main$$.videos[$video$$.videoID]=
$video$$,$options$$.video=$video$$,$main$$.views[$options$$.divID]=new $View$$("#"+$options$$.divID,$options$$),$main$$[$handlerResult$$]($main$$.views[$options$$.divID]))})};$protect$$.videoResultHandler=function $$protect$$$videoResultHandler$($view$$){var $video$$=$view$$.getVideo();!$video$$.hasOwnProperty("videoType")||$video$$.videoType===this.VIDEO_PERCEPTIVE_TYPE?!$video$$.hasOwnProperty("service")||"Brightcove"===$video$$.videoType?$view$$.loadEmbeddedVideo():$view$$.loadPerceptiveVideo():
$video$$.videoType===this.VIDEO_EMBEDDED_TYPE&&$view$$.loadEmbeddedVideo()};$protect$$.thumbnailResultHandler=function $$protect$$$thumbnailResultHandler$($view$$){var $video$$=$view$$.getVideo();$video$$.videoType===this.VIDEO_EMBEDDED_TYPE&&(void 0!==$video$$.videoThumbnail?$view$$.loadThumb():$view$$.processVideoForThumbnails())}})});
;
goog.provide("jive.integration.tiles.viewstyle.tileVideoInfo");
jive.integration.tiles.viewstyle.tileVideoInfo=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<div class=\"j-stream-comms-video-info clearfix\" style=\"text-align: center;\"><script>require(['jquery', 'apps/video/video_render_main', 'jive/accessibility'], function($, VideoRenderMain, Accessibility) {var videoRender = new VideoRenderMain(); $('#video-tile-link-",soy.$$escapeJsString(opt_data.tileInstanceId),"').one(\"click\", function(e) {var $this = $(this); Accessibility.pushFocus($this); videoRender.getVideoDataAndRender({'divID' : 'video-tile-link-",
soy.$$escapeJsString(opt_data.tileInstanceId),"', 'videoID' : ",soy.$$escapeJsValue(opt_data.video.videoID),", 'objectType' : ",soy.$$escapeJsValue(opt_data.video.objectType),", 'objectID' : ",soy.$$escapeJsValue(opt_data.video.videoID),', \'isTiny\' : true}); $(this).find(".js-video-preview-content").remove(); e.preventDefault();});});<\/script><a href="#" class="j-tile-video-thumb" id="video-tile-link-',soy.$$escapeHtmlAttribute(opt_data.tileInstanceId),'"><img src="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.video.previewImageURL)),
'" width="100%" title="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("video.preview.image"),[])),'" alt="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("video.preview.image"),[])),"\"/><div class='j-video-preview-content js-video-preview-content'><span id='video-span-tile-",soy.$$escapeHtmlAttribute(opt_data.tileInstanceId),"' class='js-play-button'>\u25b6</span></div></a></div>");return opt_sb?"":output.toString()};
;
"undefined"!=typeof jive&&(jive.rte.plugin.videomacro=function $jive$rte$plugin$videomacro$($shortname$$,$url$$,$macrotag$$,$settingsHuh$$,$displayHuh$$,$paramSets$$,$params$$,$enabled$$,$button$$){var $that$$=this;$params$$=[{}];this.getName=function $this$getName$(){return $shortname$$};this.getUrl=function $this$getUrl$(){return $url$$};this.isButton=function $this$isButton$(){return $button$$};this.isEnabled=function $this$isEnabled$(){return $enabled$$};this.isShowSettings=function $this$isShowSettings$(){return $settingsHuh$$};
this.isShowInMacroList=function $this$isShowInMacroList$(){return $displayHuh$$};this.getMacroType=function $this$getMacroType$(){return $macrotag$$};this.getAllowedParameters=function $this$getAllowedParameters$(){return $params$$};this.usesCustomBackground=function $this$usesCustomBackground$(){return!0};this.refreshPosition=function $this$refreshPosition$($rte$$,$ele$$,$$ele$$){$that$$.updatePreviewContentPosition($ele$$,$$ele$$)};this.updatePreviewContentPosition=function $this$updatePreviewContentPosition$($ele$$,
$$ele$$){var $t$$=jive.ext.x.xPageY($ele$$),$l$$=jive.ext.x.xPageX($ele$$);$$ele$$&&($$ele$$.css("top")!=$t$$&&$$ele$$.css("top",$t$$),$$ele$$.css("left")!=$l$$&&$$ele$$.css("left",$l$$))};this.refresh=function $this$refresh$($rte$$,$ele$$){console.log("videomacro.js - refresh");var $$ele$$=$rte$$.getHiddenElementFor($j($ele$$).attr("_jivemacro_uid"));null!=$$ele$$&&(null==$$ele$$.data("init")?setTimeout(function(){$that$$.displayVideo($rte$$,$ele$$,$$ele$$);$that$$.updatePreviewContentPosition($ele$$,
$$ele$$)},328):$that$$.displayVideo($rte$$,$ele$$,$$ele$$))};this.displayVideo=function $this$displayVideo$($$e_previewImgSrc_rte$$,$ele$$,$$ele$$){console.log("videomacro.js - displayVideo");$ele$$.getAttribute("_jivemacro_uid");$$e_previewImgSrc_rte$$=$j($ele$$);var $_id$$=$$e_previewImgSrc_rte$$.attr("_id"),$_videoid$$=$$e_previewImgSrc_rte$$.attr("_videoid");$_id$$&&!$_videoid$$&&$$e_previewImgSrc_rte$$.attr("_videoid",$_id$$);if($$e_previewImgSrc_rte$$=$ele$$.getAttribute("_imageURL"))$j($ele$$).width(1040).height(656).css("background",
"transparent"),$$ele$$.width(1040).height(656).html('\x3cimg src\x3d"'+$$e_previewImgSrc_rte$$+'"/\x3e')};this.retrieveInsertionUUID=function $this$retrieveInsertionUUID$($$ele$$){return $j($$ele$$,"#insertionUUID").attr("id")};this.getEditorWindowHandle=function $this$getEditorWindowHandle$(){return"undefined"==typeof window.parent.editor?window.parent.tinyMCE.activeEditor.getWin().parent:window.parent};this.doSetResizedDimensions=function $this$doSetResizedDimensions$($ele$$,$$ele$$,$width$$,$height$$,
$superRichContentMaxWidth$$){$$ele$$.width($superRichContentMaxWidth$$-500>$width$$?$superRichContentMaxWidth$$-500:$width$$);$$ele$$.height($height$$);$j($ele$$).width($superRichContentMaxWidth$$-500>$width$$?$superRichContentMaxWidth$$-500:$width$$);$j($ele$$).height($height$$);$j($ele$$).attr("src","/images/tiny_mce3/plugins/alignment/img/spacer.gif")}},jive.localexchange&&jive.localexchange.addListener("renderedContentWithSelector",function($$renderedContent$$){$$renderedContent$$.find("span.jive-content-video[data-video-id]").each(function($index$$,
$element$$){var $$element$$=$j($element$$);$$element$$.attr("data-video-id")&&!$$element$$.attr("data-video-rendered")&&(require(["apps/video/video_render_main"],function($VideoRenderMain_id$$1_options$$){Math.trunc=Math.trunc||function($x$$){return $x$$-$x$$%1};var $func$$=new $VideoRenderMain_id$$1_options$$,$$revisionTable$$=$j(".jive-revision-table");$VideoRenderMain_id$$1_options$$=$$element$$.attr("id")+"_"+Math.trunc(Math.random()*Math.pow(10,10));$$element$$.attr("id",$VideoRenderMain_id$$1_options$$);
$func$$=$$revisionTable$$.length?$func$$.getVideoThumbnailAndRender:$func$$.getVideoDataAndRender;$VideoRenderMain_id$$1_options$$={divID:$VideoRenderMain_id$$1_options$$,videoID:$$element$$.attr("data-video-id"),objectType:$$element$$.attr("data-object-type"),objectID:$$element$$.attr("data-object-id"),isTiny:!1,width:$$element$$.attr("data-width"),height:0.63*$$element$$.attr("data-width")};$func$$($VideoRenderMain_id$$1_options$$)}),$$element$$.attr("data-video-rendered","true"))})}));
;
goog.provide("jive.integration.tiles.viewstyle.video");
jive.integration.tiles.viewstyle.video=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.integration.tiles.view.header(opt_data,output);output.append('<section class="j-tile-body j-tile-video">');if(typeof opt_data.video=="string")output.append('<p class="noContent">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tile.video.empty"),[])),"</p>");else jive.integration.tiles.viewstyle.tileVideoInfo(opt_data,output);output.append("</section>");if(opt_data.action)jive.integration.tiles.view.footer(opt_data.action,
output);return opt_sb?"":output.toString()};
;
var CryptoJS=CryptoJS||function(z,d){var f={},h=f.lib={},e=function(){},b=h.Base={extend:function(a){e.prototype=this;var g=new e;a&&g.mixIn(a);g.hasOwnProperty("init")||(g.init=function(){g.$super.init.apply(this,arguments)});g.init.prototype=g;g.$super=this;return g},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var g in a){a.hasOwnProperty(g)&&(this[g]=a[g])}a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},c=h.WordArray=b.extend({init:function(a,g){a=this.words=a||[];this.sigBytes=g!=d?g:4*a.length},toString:function(a){return(a||y).stringify(this)},concat:function(k){var n=this.words,l=k.words,m=this.sigBytes;k=k.sigBytes;this.clamp();if(m%4){for(var p=0;p<k;p++){n[m+p>>>2]|=(l[p>>>2]>>>24-8*(p%4)&255)<<24-8*((m+p)%4)}}else{if(65535<l.length){for(p=0;p<k;p+=4){n[m+p>>>2]=l[p>>>2]}}else{n.push.apply(n,l)}}this.sigBytes+=k;return this},clamp:function(){var a=this.words,g=this.sigBytes;a[g>>>2]&=4294967295<<32-8*(g%4);a.length=z.ceil(g/4)},clone:function(){var a=b.clone.call(this);a.words=this.words.slice(0);return a},random:function(g){for(var l=[],k=0;k<g;k+=4){l.push(4294967296*z.random()|0)}return new c.init(l,g)}}),w=f.enc={},y=w.Hex={stringify:function(l){var m=l.words;l=l.sigBytes;for(var q=[],p=0;p<l;p++){var n=m[p>>>2]>>>24-8*(p%4)&255;q.push((n>>>4).toString(16));q.push((n&15).toString(16))}return q.join("")},parse:function(k){for(var l=k.length,n=[],m=0;m<l;m+=2){n[m>>>3]|=parseInt(k.substr(m,2),16)<<24-4*(m%8)}return new c.init(n,l/2)}},o=w.Latin1={stringify:function(k){var l=k.words;k=k.sigBytes;for(var n=[],m=0;m<k;m++){n.push(String.fromCharCode(l[m>>>2]>>>24-8*(m%4)&255))}return n.join("")},parse:function(k){for(var l=k.length,n=[],m=0;m<l;m++){n[m>>>2]|=(k.charCodeAt(m)&255)<<24-8*(m%4)}return new c.init(n,l)}},x=w.Utf8={stringify:function(a){try{return decodeURIComponent(escape(o.stringify(a)))}catch(k){throw Error("Malformed UTF-8 data")}},parse:function(a){return o.parse(unescape(encodeURIComponent(a)))}},j=h.BufferedBlockAlgorithm=b.extend({reset:function(){this._data=new c.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(p){var r=this._data,u=r.words,t=r.sigBytes,s=this.blockSize,n=t/(4*s),n=p?z.ceil(n):z.max((n|0)-this._minBufferSize,0);p=n*s;t=z.min(4*p,t);if(p){for(var q=0;q<p;q+=s){this._doProcessBlock(u,q)}q=u.splice(0,p);r.sigBytes-=t}return new c.init(q,t)},clone:function(){var a=b.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});h.Hasher=j.extend({cfg:b.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){j.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(k,l){return(new a.init(l)).finalize(k)}},_createHmacHelper:function(a){return function(k,l){return(new i.HMAC.init(a,l)).finalize(k)}}});var i=f.algo={};return f}(Math);(function(o){function d(r,s,p,u,q,t,n){r=r+(s&p|~s&u)+q+n;return(r<<t|r>>>32-t)+s}function f(r,s,p,u,q,t,n){r=r+(s&u|p&~u)+q+n;return(r<<t|r>>>32-t)+s}function g(r,s,p,u,q,t,n){r=r+(s^p^u)+q+n;return(r<<t|r>>>32-t)+s}function e(r,s,p,u,q,t,n){r=r+(p^(s|~u))+q+n;return(r<<t|r>>>32-t)+s}for(var b=CryptoJS,c=b.lib,i=c.WordArray,k=c.Hasher,c=b.algo,h=[],j=0;64>j;j++){h[j]=4294967296*o.abs(o.sin(j+1))|0}c=c.MD5=k.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(Q,N){for(var V=0;16>V;V++){var P=N+V,n=Q[P];Q[P]=(n<<8|n>>>24)&16711935|(n<<24|n>>>8)&4278255360}var V=this._hash.words,P=Q[N+0],n=Q[N+1],O=Q[N+2],L=Q[N+3],J=Q[N+4],H=Q[N+5],F=Q[N+6],E=Q[N+7],p=Q[N+8],m=Q[N+9],l=Q[N+10],a=Q[N+11],M=Q[N+12],K=Q[N+13],I=Q[N+14],G=Q[N+15],U=V[0],T=V[1],S=V[2],R=V[3],U=d(U,T,S,R,P,7,h[0]),R=d(R,U,T,S,n,12,h[1]),S=d(S,R,U,T,O,17,h[2]),T=d(T,S,R,U,L,22,h[3]),U=d(U,T,S,R,J,7,h[4]),R=d(R,U,T,S,H,12,h[5]),S=d(S,R,U,T,F,17,h[6]),T=d(T,S,R,U,E,22,h[7]),U=d(U,T,S,R,p,7,h[8]),R=d(R,U,T,S,m,12,h[9]),S=d(S,R,U,T,l,17,h[10]),T=d(T,S,R,U,a,22,h[11]),U=d(U,T,S,R,M,7,h[12]),R=d(R,U,T,S,K,12,h[13]),S=d(S,R,U,T,I,17,h[14]),T=d(T,S,R,U,G,22,h[15]),U=f(U,T,S,R,n,5,h[16]),R=f(R,U,T,S,F,9,h[17]),S=f(S,R,U,T,a,14,h[18]),T=f(T,S,R,U,P,20,h[19]),U=f(U,T,S,R,H,5,h[20]),R=f(R,U,T,S,l,9,h[21]),S=f(S,R,U,T,G,14,h[22]),T=f(T,S,R,U,J,20,h[23]),U=f(U,T,S,R,m,5,h[24]),R=f(R,U,T,S,I,9,h[25]),S=f(S,R,U,T,L,14,h[26]),T=f(T,S,R,U,p,20,h[27]),U=f(U,T,S,R,K,5,h[28]),R=f(R,U,T,S,O,9,h[29]),S=f(S,R,U,T,E,14,h[30]),T=f(T,S,R,U,M,20,h[31]),U=g(U,T,S,R,H,4,h[32]),R=g(R,U,T,S,p,11,h[33]),S=g(S,R,U,T,a,16,h[34]),T=g(T,S,R,U,I,23,h[35]),U=g(U,T,S,R,n,4,h[36]),R=g(R,U,T,S,J,11,h[37]),S=g(S,R,U,T,E,16,h[38]),T=g(T,S,R,U,l,23,h[39]),U=g(U,T,S,R,K,4,h[40]),R=g(R,U,T,S,P,11,h[41]),S=g(S,R,U,T,L,16,h[42]),T=g(T,S,R,U,F,23,h[43]),U=g(U,T,S,R,m,4,h[44]),R=g(R,U,T,S,M,11,h[45]),S=g(S,R,U,T,G,16,h[46]),T=g(T,S,R,U,O,23,h[47]),U=e(U,T,S,R,P,6,h[48]),R=e(R,U,T,S,E,10,h[49]),S=e(S,R,U,T,I,15,h[50]),T=e(T,S,R,U,H,21,h[51]),U=e(U,T,S,R,M,6,h[52]),R=e(R,U,T,S,L,10,h[53]),S=e(S,R,U,T,l,15,h[54]),T=e(T,S,R,U,n,21,h[55]),U=e(U,T,S,R,p,6,h[56]),R=e(R,U,T,S,G,10,h[57]),S=e(S,R,U,T,F,15,h[58]),T=e(T,S,R,U,K,21,h[59]),U=e(U,T,S,R,J,6,h[60]),R=e(R,U,T,S,a,10,h[61]),S=e(S,R,U,T,O,15,h[62]),T=e(T,S,R,U,m,21,h[63]);V[0]=V[0]+U|0;V[1]=V[1]+T|0;V[2]=V[2]+S|0;V[3]=V[3]+R|0},_doFinalize:function(){var p=this._data,q=p.words,m=8*this._nDataBytes,r=8*p.sigBytes;q[r>>>5]|=128<<24-r%32;var n=o.floor(m/4294967296);q[(r+64>>>9<<4)+15]=(n<<8|n>>>24)&16711935|(n<<24|n>>>8)&4278255360;q[(r+64>>>9<<4)+14]=(m<<8|m>>>24)&16711935|(m<<24|m>>>8)&4278255360;p.sigBytes=4*(q.length+1);this._process();p=this._hash;q=p.words;for(m=0;4>m;m++){r=q[m],q[m]=(r<<8|r>>>24)&16711935|(r<<24|r>>>8)&4278255360}return p},clone:function(){var l=k.clone.call(this);l._hash=this._hash.clone();return l}});b.MD5=k._createHelper(c);b.HmacMD5=k._createHmacHelper(c)})(Math);
;
goog.provide("jive.integration.tiles.view.render");
jive.integration.tiles.view.render=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(!opt_data.id)jive.shared.soy.render({templateName:"jive.integration.tiles.viewstyle."+String(opt_data.viewstyle).toLowerCase(),data:soy.$$augmentMap(opt_data.data,{tileInstanceId:"-1-"+opt_data.definition.id,place:opt_data.place,displayWidth:opt_data.definition.displayWidth,editing:opt_data.editing,columnWidth:opt_data.columnWidth}),failGracefully:true},output);else jive.shared.soy.render({templateName:"jive.integration.tiles.viewstyle."+
String(opt_data.viewstyle).toLowerCase(),data:soy.$$augmentMap(opt_data.data,{tileInstanceId:opt_data.id,place:opt_data.place,displayWidth:opt_data.definition.displayWidth,editing:opt_data.editing,columnWidth:opt_data.columnWidth}),failGracefully:true},output);return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.view.tile");
jive.integration.tiles.view.tile=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="js-tile j-tile j-tileType-',soy.$$escapeHtmlAttribute(opt_data.instance.viewstyle),opt_data.editing?" j-tile-editing":"",!(opt_data.features==null?null:opt_data.features.responsive)==true&&opt_data.instance.viewstyle=="custom_view"?" j-tile-"+soy.$$escapeHtmlAttribute(opt_data.instance.viewstyle)+"-not-responsive ":"",'"',opt_data.column!=null&&opt_data.column>=0?' data-column="'+
soy.$$escapeHtmlAttribute(opt_data.column)+'"':"",opt_data.index!=null&&opt_data.index>=0?' data-index="'+soy.$$escapeHtmlAttribute(opt_data.index)+'"':"",opt_data.editing?' data-tile="'+soy.$$escapeHtmlAttribute(JSON.stringify(opt_data.instance).replace(/</g,"\\u003C").replace(/>/g,"\\u003E").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029"))+'"':' data-tile-view="'+soy.$$escapeHtmlAttribute(JSON.stringify({id:opt_data.instance.id,data:opt_data.instance.data,definition:opt_data.instance.definition,
status:opt_data.instance.status}).replace(/</g,"\\u003C").replace(/>/g,"\\u003E").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029"))+'"','role="complementary"',opt_data.instance.data.title?!opt_data.instance.id?'aria-labelledby="tile-header-'+soy.$$escapeHtmlAttribute("-1-"+opt_data.instance.definition.id)+'"':'aria-labelledby="tile-header-'+soy.$$escapeHtmlAttribute(opt_data.instance.id)+'"':"",'tabindex="0"',!opt_data.instance.id?'js-instance-id="'+soy.$$escapeHtmlAttribute(opt_data.instance.definition.id)+
'"':'js-instance-id="'+soy.$$escapeHtmlAttribute(opt_data.instance.id)+'"',">",opt_data.editing?'<div class="j-configMenu j-expandedMenu">'+(String(opt_data.instance.definition.state).toLowerCase()=="disabled"?'<a href="#" class="j-disabled configOpt font-color-notify"><span class="jive-icon-med jive-icon-warn"></span><span class="j-configMenuLabel">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.manage.tile.disabled"),[]))+"</span></a>":"")+(opt_data.maxTiles!=null&&opt_data.maxTiles>
1?'<a href="#" class="js-up'+(opt_data.first?" disabled":"")+' configOpt font-color-normal"><span class="jive-icon-glyph icon-arrow-up"></span><span class="j-configMenuLabel">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.moveUp"),[]))+'</span></a><a href="#" class="js-down'+(opt_data.last?" disabled":"")+' configOpt font-color-normal"><span class="jive-icon-glyph icon-arrow-down"></span><span class="j-configMenuLabel">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.moveDown"),
[]))+"</span></a>":"")+'<a href="#" class="js-delete configOpt last j-rc4 j-rc-none-left font-color-normal"><span class="jive-icon-glyph icon-remove"></span><span class="j-configMenuLabel">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.delete"),[]))+'</span></a><a href="#" class="js-configure'+(!opt_data.instance.definition.config?" disabled":"")+' j-rc4 j-rc-none-right configOpt font-color-normal"><span class="jive-icon-glyph icon-gear"></span><span class="j-configMenuLabel">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.manage.configure"),
[]))+" "+(!opt_data.instance.definition.config?" (disabled)":"")+"</span></a></div>":opt_data.canManage&&opt_data.instance.definition.config&&opt_data.instance.id?'<div class="j-configMenu normalMode"><a href="'+(opt_data.place?soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/"+opt_data.editPage,function(){var map={};var pairs=[["containerType",opt_data.place.objectType],["containerID",opt_data.place.id],["autoConfig",opt_data.instance.id],
["pageId",opt_data.templateId]];for(var i=0;i<pairs.length;i+=1)map[pairs[i][0]]=pairs[i][1];return map}()))):"#")+'" class="js-place-edit-settings configOpt font-color-normal last"><span class="jive-icon-glyph icon-gear"></span><span class="j-configMenuLabel">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.manage.configure"),[]))+"</span></a></div>":"");if(opt_data.instance.status&&opt_data.instance.status.level)jive.integration.tiles.view.status(opt_data.instance,output);output.append('<div class="js-tile-body j-tile-display">');
if(!opt_data.editing&&String(opt_data.instance.definition.state).toLowerCase()=="disabled")jive.integration.tiles.view.disabled(null,output);else if(opt_data.instance.data)jive.integration.tiles.view.render(soy.$$augmentMap(opt_data.instance,{place:opt_data.place,editing:opt_data.editing,columnWidth:opt_data.columnWidth}),output);output.append("</div>");if(opt_data.instance.definition.client_id&&opt_data.instance.definition.icons["16"]&&opt_data.instance.definition.productName){output.append('<div class="j-3rdPartyIntegration font-color-meta j-rc4 j-rc-none-top"><img class="jive-icon-med jive-ext-icon-16" src="',
soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.instance.definition.icons["16"])),'" role="img" alt=""/>');jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("tile.footer.data.provided.by"),arg0:soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(opt_data.instance.definition.productName),[])),noAutoEscape:true},output);output.append("</div>")}output.append("</div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.view.addMarker");jive.integration.tiles.view.addMarker=function(opt_data,opt_sb){opt_data=opt_data||{};var output=opt_sb||new soy.StringBuilder;output.append('<a href="#" class="j-add-tile-marker j-js-add-tile-marker font-color-meta-light j-rc6 ',opt_data.columnWidth&&opt_data.columnWidth=="wide"?"js-column-wrap-wide":"",'"  aria-haspopup="true">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("place.tile.marker"),[])),"</a>");return opt_sb?"":output.toString()};
;
goog.provide("jive.integration.tiles.view.list");
jive.integration.tiles.view.list=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;var tileInstanceList3=opt_data.instances;var tileInstanceListLen3=tileInstanceList3.length;for(var tileInstanceIndex3=0;tileInstanceIndex3<tileInstanceListLen3;tileInstanceIndex3++){var tileInstanceData3=tileInstanceList3[tileInstanceIndex3];jive.integration.tiles.view.tile({column:opt_data.column,instance:tileInstanceData3,editing:opt_data.editing,canManage:opt_data.canManage,first:tileInstanceIndex3==
0,last:tileInstanceIndex3==opt_data.maxTiles-1,index:tileInstanceIndex3,place:opt_data.place,templateId:opt_data.templateId,editPage:opt_data.editPage,features:tileInstanceData3.definition.view!=null&&tileInstanceData3.viewstyle=="custom_view"?function(uri){var match=/[\?&]features=([^&#]*)/.exec(uri);var features=match==null?[]:match[1].split(",");var result={};for(var i=0;i<features.length;i++){var feature=features[i];var value=true;if(/\(.*\)/.test(feature)){value=feature.substring(feature.indexOf("(")+
1,feature.lastIndexOf(")"));feature=feature.substring(0,feature.indexOf("("))}result[feature]=value}return result}(tileInstanceData3.definition.view):null,columnWidth:opt_data.columnWidth,maxTiles:opt_data.maxTiles},output)}if(opt_data.editing){var unusedInit21=opt_data.instances.length;var unusedLimit21=opt_data.maxTiles;for(var unused21=unusedInit21;unused21<unusedLimit21;unused21++)jive.integration.tiles.view.addMarker(opt_data,output)}return opt_sb?"":output.toString()};
;
goog.provide("jive.place.layout.wideTileLayout");
jive.place.layout.wideTileLayout=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div id="streamAndDatablocks"><div id="datablock-content" class="j-layout j-layout-l clearfix" data-can-manage="',soy.$$escapeHtmlAttribute(opt_data.canManageContainer),'">');jive.place.layout.columnPlaceholder(soy.$$augmentMap(opt_data,{column:0,instances:opt_data.tileColumn0}),output);output.append('<div class="js-column j-place-column-wrap  j-column-wrap-wide  js-column-wrap-wide" data-column="1"><div class="j-place-column">');jive.integration.tiles.view.list(soy.$$augmentMap(opt_data,
{column:1,instances:opt_data.tileColumn1,maxTiles:opt_data.maxWideTiles,canManage:opt_data.canManageContainer,editing:opt_data.customizeNow,place:opt_data.place,templateId:opt_data.template.id,editPage:opt_data.editPage,columnWidth:"wide"}),output);output.append("</div></div>");jive.place.layout.columnPlaceholder(soy.$$augmentMap(opt_data,{column:2,instances:opt_data.tileColumn2}),output);output.append("</div></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.place.layout.narrowTileLayout");
jive.place.layout.narrowTileLayout=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div id="streamAndDatablocks"><div id="datablock-content" class="j-layout j-layout-ml clearfix" data-can-manage="',soy.$$escapeHtmlAttribute(opt_data.canManageContainer),'"><div class="js-column j-place-column-wrap" data-column="0"><div class="j-place-column">');jive.integration.tiles.view.list(soy.$$augmentMap(opt_data,{column:0,instances:opt_data.tileColumn0,maxTiles:opt_data.maxNarrowTiles,
canManage:opt_data.canManageContainer,editing:opt_data.customizeNow,place:opt_data.place,templateId:opt_data.template.id,editPage:opt_data.editPage,columnWidth:"narrow"}),output);output.append("</div></div>");jive.place.layout.columnPlaceholder(soy.$$augmentMap(opt_data,{column:1,instances:opt_data.tileColumn1}),output);jive.place.layout.columnPlaceholder(soy.$$augmentMap(opt_data,{column:2,instances:opt_data.tileColumn2}),output);output.append("</div></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.place.layout.narrowWideTileLayout");
jive.place.layout.narrowWideTileLayout=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div id="streamAndDatablocks"><div id="datablock-content" class="j-layout j-layout-ml clearfix" data-can-manage="',soy.$$escapeHtmlAttribute(opt_data.canManageContainer),'"><div class="js-column j-place-column-wrap" data-column="0"><div class="j-place-column">');jive.integration.tiles.view.list(soy.$$augmentMap(opt_data,{column:0,instances:opt_data.tileColumn0,maxTiles:opt_data.maxNarrowTiles,
canManage:opt_data.canManageContainer,editing:opt_data.customizeNow,place:opt_data.place,templateId:opt_data.template.id,editPage:opt_data.editPage,columnWidth:"narrow"}),output);output.append('</div></div><div class="js-column j-place-column-wrap  j-column-wrap-wide  js-column-wrap-wide" data-column="1"><div class="j-place-column">');jive.integration.tiles.view.list(soy.$$augmentMap(opt_data,{column:1,instances:opt_data.tileColumn1,maxTiles:opt_data.maxWideTiles,canManage:opt_data.canManageContainer,
editing:opt_data.customizeNow,place:opt_data.place,templateId:opt_data.template.id,editPage:opt_data.editPage,columnWidth:"wide"}),output);output.append("</div></div>");jive.place.layout.columnPlaceholder(soy.$$augmentMap(opt_data,{column:2,instances:opt_data.tileColumn2}),output);output.append("</div></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.place.layout.narrowWideNarrowTileLayout");
jive.place.layout.narrowWideNarrowTileLayout=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div id="streamAndDatablocks"><div id="datablock-content" class="j-layout j-layout-sms clearfix" data-can-manage="',soy.$$escapeHtmlAttribute(opt_data.canManageContainer),'"><div class="js-column j-place-column-wrap" data-column="0"><div class="j-place-column">');jive.integration.tiles.view.list(soy.$$augmentMap(opt_data,{column:0,instances:opt_data.tileColumn0,maxTiles:opt_data.maxNwnLayoutNarrowTiles,
canManage:opt_data.canManageContainer,editing:opt_data.customizeNow,place:opt_data.place,templateId:opt_data.template.id,editPage:opt_data.editPage,columnWidth:"narrow"}),output);output.append('</div></div><div class="js-column j-place-column-wrap  j-column-wrap-wide  js-column-wrap-wide" data-column="1"><div class="j-place-column">');jive.integration.tiles.view.list(soy.$$augmentMap(opt_data,{column:1,instances:opt_data.tileColumn1,maxTiles:opt_data.maxWideTiles,canManage:opt_data.canManageContainer,
editing:opt_data.customizeNow,place:opt_data.place,templateId:opt_data.template.id,editPage:opt_data.editPage,columnWidth:"wide"}),output);output.append('</div></div><div class="js-column j-place-column-wrap" data-column="2"><div class="j-place-column">');jive.integration.tiles.view.list(soy.$$augmentMap(opt_data,{column:2,instances:opt_data.tileColumn2,maxTiles:opt_data.maxNwnLayoutNarrowTiles,canManage:opt_data.canManageContainer,editing:opt_data.customizeNow,place:opt_data.place,templateId:opt_data.template.id,
editPage:opt_data.editPage,columnWidth:"narrow"}),output);output.append("</div></div></div></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.place.layout.wideNarrowTileLayout");
jive.place.layout.wideNarrowTileLayout=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div id="streamAndDatablocks"><div id="datablock-content" class="j-layout j-layout-lm clearfix" data-can-manage="',soy.$$escapeHtmlAttribute(opt_data.canManageContainer),'">');jive.place.layout.columnPlaceholder(soy.$$augmentMap(opt_data,{column:0,instances:opt_data.tileColumn0}),output);output.append('<div class="js-column j-place-column-wrap  j-column-wrap-wide  js-column-wrap-wide" data-column="1"><div class="j-place-column">');jive.integration.tiles.view.list(soy.$$augmentMap(opt_data,
{column:1,instances:opt_data.tileColumn1,maxTiles:opt_data.maxWideTiles,canManage:opt_data.canManageContainer,editing:opt_data.customizeNow,place:opt_data.place,templateId:opt_data.template.id,editPage:opt_data.editPage,columnWidth:"wide"}),output);output.append('</div></div><div class="js-column j-place-column-wrap" data-column="2"><div class="j-place-column">');jive.integration.tiles.view.list(soy.$$augmentMap(opt_data,{column:2,instances:opt_data.tileColumn2,maxTiles:opt_data.maxNarrowTiles,canManage:opt_data.canManageContainer,
editing:opt_data.customizeNow,place:opt_data.place,templateId:opt_data.template.id,editPage:opt_data.editPage,columnWidth:"narrow"}),output);output.append("</div></div></div></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.place.layout.columns");
jive.place.layout.columns=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.template.layout=="wide")jive.place.layout.wideTileLayout(opt_data,output);else if(opt_data.template.layout=="narrow")jive.place.layout.narrowTileLayout(opt_data,output);else if(opt_data.template.layout=="narrow_wide")jive.place.layout.narrowWideTileLayout(opt_data,output);else if(opt_data.template.layout=="narrow_wide_narrow")jive.place.layout.narrowWideNarrowTileLayout(opt_data,output);else jive.place.layout.wideNarrowTileLayout(opt_data,
output);return opt_sb?"":output.toString()};
;
goog.provide("jive.tilepage.mobile.homePageDynamicPane");
jive.tilepage.mobile.homePageDynamicPane=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="your-view"><header class="j-act-header"><h1 class="header">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("nav.bar.mobile.homepage.link"),[])),"</h1>",opt_data.canManageContainer?'<div id="tilepage-actions-container" class="j-act-filter-controls"><a class="tile-page-edit-button" href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,"edit-mobile-home.jspa")))+
'">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tilepage.edit.link"),[]))+"</a></div>":"","</header>",opt_data.welcomeMessage?'<div class="j-home-welcome-message"><p>'+soy.$$changeNewlineToBr(soy.$$escapeHtml(opt_data.welcomeMessage))+"</p></div>":"");if(!opt_data.template||!opt_data.template.tiles||opt_data.template.tiles.length==0)output.append('<div id="streamAndDatablocks"><div class="j-tile"><div class="j-tile-display"><p class="noContent">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tilepage.personal.noTiles"),
[])),'<br><br><a class="tile-page-edit-button" href="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,"edit-your-view.jspa"))),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tilepage.personal.addTiles"),[])),"</a></p></div></div></div>");else jive.place.layout.columns(soy.$$augmentMap(opt_data,{editPage:"edit-mobile-home.jspa"}),output);output.append("</div>",opt_data.canManageContainer?"<p>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("mobile.homepage.info"),
[]))+"</p>":"");jive.shared.soy.resourceInlineJs({code:"$j(function() {var tmp = 'asdf'; require(['apps/tile/responsive_tile'], function(updateColumns) {updateColumns();});});"},output);return opt_sb?"":output.toString()};
;
goog.provide("jive.nav.menu.home.inbox");
jive.nav.menu.home.inbox=function(opt_data,opt_sb){opt_data=opt_data||{};var output=opt_sb||new soy.StringBuilder;output.append('<h4 class="j-badge-hd j-rc5 j-rc-none-bottom"><a href="',soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/inbox")),'" title="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.inbox"),[])),'"><span class="lnk">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.inbox"),[])),"</span>");if(opt_data.unreadCount>0){output.append('<strong class="j-menu-count font-color-notify">');
jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("nav.bar.home.menu.unread"),arg0:opt_data.unreadCount>50?"50+":soy.$$escapeHtml(opt_data.unreadCount),noAutoEscape:true},output);output.append("</strong>")}output.append("</a></h4>");return opt_sb?"":output.toString()};
;
define("jive/responsive","jquery underscore apps/activity_stream/activity_notifier apps/tile/template apps/tile/integrations/image_gallery soy!jive.tilepage.mobile.homePageDynamicPane".split(" "),function($$$$,$_$$,$activityNotifier$$,$tilePageSource$$,$imageGallery$$,$homePageDynamicPane$$){var $Menu$$=function $$Menu$$$($$trigger$$,$$menu$$,$options$$){$options$$=$options$$||{};var $menu$$=this;this.$trigger=$$trigger$$;this.$menu=$$menu$$;this.options=$options$$;this.$trigger.off(".responsive").on("vclick.responsive",
function($e$$){$e$$.preventDefault();$menu$$.toggle()})};$j.extend($Menu$$.prototype,{isOpened:function(){return this.$menu.hasClass("active")},open:function(){$responsive$$.hideMenus();this.$menu.addClass("active");this.options.noOverlay||$responsive$$.showOverlay();this.options.$items&&(this.options.$items.addClass("mobile-active"),$$$$("#j-header-wrap").removeClass("fixed"),$$$$(window).scrollTop(0),"#j-spotlight-search"==this.options.$items.selector&&$$$$("#autosearch").focus())},close:function(){this.$menu.removeClass("active");
this.options.noOverlay||$responsive$$.hideOverlay();this.options.$items&&(this.options.$items.removeClass("mobile-active"),$$$$("#j-header-wrap").addClass("fixed"))},toggle:function(){this.isOpened()?this.close():this.open()}});var $responsive$$={_initialized:!1,_currentSize:null,_mediaQueryLists:{},_mediaQueryListListeners:{},_overlayCloseTimeoutId:null,init:function(){var $landingPage$$=location.pathname.replace(/\/$/,"").split("/").pop().replace(/([a-z])(.*)/i,function($str$$,$firstLetter$$,$rest$$){return $firstLetter$$.toUpperCase()+
$rest$$});if(!$responsive$$._initialized){$responsive$$._initialized=!0;$responsive$$.registerBreakpoint("only screen and (max-width:40em)","sm");$responsive$$.registerBreakpoint("only screen and (min-width:40em)","md");if($responsive$$["handle"+$landingPage$$+"Page"])$responsive$$["handle"+$landingPage$$+"Page"]();"sm"==this.getCurrentSize()&&($j.fn.popover.defaults.flip=!1);$responsive$$.bindEvents()}},buildMQLListener:function($size$$){var $$body$$=$$$$("body");return function($mql$$){var $classesToRemove_notCurrentSizes_sizes$$=
$_$$.keys($responsive$$._mediaQueryLists),$classesToRemove_notCurrentSizes_sizes$$=$_$$.without($classesToRemove_notCurrentSizes_sizes$$,$size$$),$classesToRemove_notCurrentSizes_sizes$$=$_$$.map($classesToRemove_notCurrentSizes_sizes$$,function($s$$){return"j-responsive-"+$s$$});$mql$$.matches?($responsive$$._currentSize=$size$$,jive.switchboard.emit("responsive.breakpoint.changed",$size$$),$$body$$.removeClass($classesToRemove_notCurrentSizes_sizes$$.join(" ")).addClass("j-responsive-"+$size$$)):
$$body$$.removeClass("j-responsive-"+$size$$)}},registerBreakpoint:function($mq$$,$size$$){var $mql$$,$handler$$;window.matchMedia&&($mql$$=window.matchMedia($mq$$),this._mediaQueryLists[$size$$]=$mql$$,this._mediaQueryListListeners[$mql$$.media]=$handler$$=this.buildMQLListener($size$$),$mql$$.addListener($handler$$),$handler$$($mql$$))},bindEvents:function(){var $jPopMain$$=$$$$(".j-pop-main");$$$$("#mob-spotlight-cancel").on("vclick",function($e$$){$e$$.preventDefault();$responsive$$.hideMenus();
$$$$(".mobile-tool \x3e a").removeClass("active");$$$$("#j-spotlight-search").removeClass("mobile-active");$$$$("#mobile-overlay").removeClass("active")});jive.search&&jive.search.searchParams&&jive.search.searchParams.addListener("change",function(){$responsive$$.accordionMenu.close()});$$$$("#mobile-overlay").on("vclick",function($e$$){$e$$.preventDefault();$responsive$$.hideMenus();$$$$(".mobile-tool \x3e a").removeClass("active")});$$$$(document).on("navbarPopoverLoad",".j-pop-main",function($e$$){clearTimeout($responsive$$._overlayCloseTimeoutId);
$jPopMain$$.is($e$$.target)||($responsive$$.hideMenus(),$$$$(".mobile-tool \x3e a").removeClass("active"));"sm"===$responsive$$.getCurrentSize()&&$responsive$$.showOverlay();$$$$(this).one("close.popoveroverlay",function(){$responsive$$._overlayCloseTimeoutId=setTimeout(function(){$responsive$$.hideOverlay()},100)})});$$$$(document).on("vclick",".j-pop-main a.quick",function(){$responsive$$.hideOverlay()});$$$$(document).on("vclick","input[type\x3dsubmit],button[type\x3dsubmit]",function($e$$){var $btn$$=
$$$$(this);/^touch/.test($e$$.originalEvent.type)&&($e$$.originalEvent.preventDefault(),$btn$$.click())});$$$$(window).on("blur",function(){$responsive$$.getCurrentSize()}).on("focus",function(){$$$$("#j-header-wrap").show()});if("sm"===$responsive$$.getCurrentSize()){String.prototype.endsWith||(String.prototype.endsWith=function $String$$endsWith$($searchString$$,$position$$){var $lastIndex$$inline_11_subjectString$$=this.toString();if("number"!==typeof $position$$||!isFinite($position$$)||Math.floor($position$$)!==
$position$$||$position$$>$lastIndex$$inline_11_subjectString$$.length)$position$$=$lastIndex$$inline_11_subjectString$$.length;$position$$-=$searchString$$.length;$lastIndex$$inline_11_subjectString$$=$lastIndex$$inline_11_subjectString$$.indexOf($searchString$$,$position$$);return-1!==$lastIndex$$inline_11_subjectString$$&&$lastIndex$$inline_11_subjectString$$===$position$$});var $currentPath$$inline_0_galleryWidth$$=window.location.pathname,$base_path$$inline_1_galleryHeight$$="undefined"!=typeof _jive_base_url&&
""!=_jive_base_url?_jive_base_url:"",$currentPath$$inline_0_galleryWidth$$=$currentPath$$inline_0_galleryWidth$$.slice($base_path$$inline_1_galleryHeight$$.length,$currentPath$$inline_0_galleryWidth$$.length);$currentPath$$inline_0_galleryWidth$$.endsWith("/")&&($currentPath$$inline_0_galleryWidth$$=$currentPath$$inline_0_galleryWidth$$.slice(0,$currentPath$$inline_0_galleryWidth$$.length-1));$$$$("#j-profile-header-avatar-stats *, .j-endorse-count").bind("click",function(){return!1});$$$$(".j-homenav-link, .js-select-link").on("vclick",
function($e$$inline_12_thisLink$$){$e$$inline_12_thisLink$$.preventDefault();$e$$inline_12_thisLink$$=$$$$(this).attr("href");window.location=$e$$inline_12_thisLink$$});if($$$$("body").hasClass("j-header-mode-basic")){var $createMenu$$=$$$$("#navCreate"),$userMenu$$=$$$$("#j-satNav-wrap .j-globalNav-li").children(),$count$$=$$$$("#j-satNav-wrap .js-satellite-nav-container").children();$$$$("#j-links .j-globalNav").prepend('\x3cli class\x3d"j-nav-create j-nav-cmenu j-globalNav-li js-create-nav-container" aria-haspopup\x3d"true"\x3e\x3c/li\x3e').prepend('\x3cli class\x3d"j-globalNav-li j-nav-create j-nav-user j-satNav-user-menu"\x3e').prepend('\x3cli class\x3d"j-nav-create j-nav-user j-globalNav-li js-satellite-nav-container" aria-haspopup\x3d"true"\x3e\x3c/li\x3e');
$$$$("#j-links .j-nav-cmenu").append($createMenu$$);$$$$("#j-links .j-satNav-user-menu").append($userMenu$$);$$$$("#j-links .js-satellite-nav-container").append($count$$);$$$$("#jive-nav-link-create").remove();$$$$("#j-satNav-wrap").remove()}$$$$("#j-header-wrap").addClass("fixed");$$$$("#navCreate").length||$$$$(".j-globalNav").addClass("no-create");if($$$$("#jive-nav-link-dashboard").length){if("/get-started"===$currentPath$$inline_0_galleryWidth$$||"/moderation"===$currentPath$$inline_0_galleryWidth$$)window.location=
$base_path$$inline_1_galleryHeight$$+"/welcome"}else if("/get-started"===$currentPath$$inline_0_galleryWidth$$||"/moderation"===$currentPath$$inline_0_galleryWidth$$)window.location=$base_path$$inline_1_galleryHeight$$+"/news";$currentPath$$inline_0_galleryWidth$$=$$$$(".js-tile-image-gallery").width();$base_path$$inline_1_galleryHeight$$=parseInt($$$$(".js-tile-image-gallery").height()*($currentPath$$inline_0_galleryWidth$$/300));$$$$(".js-tile-image-gallery .j-slide").width($currentPath$$inline_0_galleryWidth$$);
$$$$(".js-tile-image-gallery .js-carousel").height($base_path$$inline_1_galleryHeight$$);$$$$(".js-tile-image-gallery").addClass("j-loaded")}$$$$("#mobile-place-menu").on("vclick",function($e$$){$e$$.preventDefault();$$$$(this).toggleClass("active");$$$$("nav.j-placeNav ul.j-placeMainNav").toggleClass("mobile-active")});$$$$("#jive-place-link-actions").on("vclick",function(){$$$$("#mobile-place-menu").hasClass("active")&&($$$$("#mobile-place-menu").toggleClass("active"),$$$$("nav.j-placeNav ul.j-placeMainNav").toggleClass("mobile-active"))});
$activityNotifier$$.addListener("activityStream.poll",function($data$$){var $unreadCount$$=$data$$.fullCounts.communications.unreadCount,$userMenuInboxMenuItem$$=$$$$(".j-badge-hd.j-rc5.j-rc-none-bottom"),$updateUserMenu$$=function $$updateUserMenu$$$(){require(["soy!jive.nav.menu.home.inbox"],function($inboxTemplate$$){var $promise$$=new $j.Deferred;$promise$$.then(function updateUnreadCount(){$userMenuInboxMenuItem$$.replaceWith($inboxTemplate$$({unreadCount:$unreadCount$$}))});var $interval$$=
setInterval(function waitForDOMToSettle(){$userMenuInboxMenuItem$$=$$$$(".j-badge-hd.j-rc5.j-rc-none-bottom");0<$userMenuInboxMenuItem$$.length&&($promise$$.resolve(),clearInterval($interval$$))},16)})};$$$$("#j-satNav-indicator").html(jive.welcome.updateIndicator({type:"count",count:$unreadCount$$,extraCssClasses:"j-navbadge-count visible-xs"}));if($userMenuInboxMenuItem$$.length)$updateUserMenu$$();else $$$$(document).on("navbarPopoverLoad updatePopoverHTML",function($e$$){"j-satNav-menu"===$e$$.target.id&&
($userMenuInboxMenuItem$$=$$$$(".j-badge-hd.j-rc5.j-rc-none-bottom"),$_$$.defer($updateUserMenu$$))})});$currentPath$$inline_0_galleryWidth$$=function $$currentPath$$inline_0_galleryWidth$$$(){var $onBreakpointChanged$$=function $$onBreakpointChanged$$$($size$$){"sm"===$size$$&&(jive.ActivityStream&&jive.ActivityStream.GlobalCommunicationStreamController)&&jive.ActivityStream.GlobalCommunicationStreamController.changeViewType("full",!0)};jive.switchboard.addListener("responsive.breakpoint.changed",
$onBreakpointChanged$$);$onBreakpointChanged$$($responsive$$._currentSize)};jive.ActivityStream&&jive.ActivityStream.GlobalCommunicationStreamController?$currentPath$$inline_0_galleryWidth$$():jive.switchboard.addListener("activity.communication.controller.initialized",$currentPath$$inline_0_galleryWidth$$);$responsive$$.showElems()},handleWelcomePage:function(){var $rootBrowseId$$=$$$$("#jive-body .j-home-welcome-responsive").data("browseId");$tilePageSource$$.fetchMobileHomePage($rootBrowseId$$).done(function($$dynamicPaneData_tilePage$$){$$dynamicPaneData_tilePage$$||
($$dynamicPaneData_tilePage$$=$$$$("#jive-body .j-home-welcome-responsive").data("defaultMobileHomePage"));var $data$$=$$$$("#jive-body .j-home-welcome-responsive").data("welcomeMessage"),$data$$=$$$$.extend({},{template:$$dynamicPaneData_tilePage$$},{place:{objectType:14,id:1,name:"Jive"}},{canManageContainer:!1},{welcomeMessage:$data$$});$responsive$$.getTileColumns($data$$,$$dynamicPaneData_tilePage$$);$$dynamicPaneData_tilePage$$=$$$$($homePageDynamicPane$$($data$$));$$$$("#jive-body .j-home-welcome-responsive").html($$dynamicPaneData_tilePage$$);
$$$$(".js-tile-image-gallery-wide, .js-tile-image-gallery-narrow").length&&$imageGallery$$.initSlick();$$$$("body.j-body-welcome .j-layout-sl nav.j-column-s").length&&$$$$("body.j-body-welcome").addClass("not-simple");jive.util.loadCSS(jive.resource.url({path:"/styles/jive-places.css"}),$$$$.noop,jive.resource.url({path:"/styles/jive.css"}))})},getTileColumns:function($data$$,$tilePage$$){var $col0$$=[],$col1$$=[],$col2$$=[],$c0$$=0,$c1$$=0,$c2$$=0;if($tilePage$$&&$tilePage$$.tiles)for(i=0;i<$tilePage$$.tiles.length;i++)switch($tilePage$$.tiles[i].column){case 0:$col0$$[$c0$$++]=
$tilePage$$.tiles[i];break;case 1:$col1$$[$c1$$++]=$tilePage$$.tiles[i];break;case 2:$col2$$[$c2$$++]=$tilePage$$.tiles[i]}$$$$.extend($data$$,{tileColumn0:$col0$$});$$$$.extend($data$$,{tileColumn1:$col1$$});$$$$.extend($data$$,{tileColumn2:$col2$$})},mainMenu:new $Menu$$($$$$("#mobile-menu \x3e a"),$$$$("#mobile-menu \x3e a"),{$items:$$$$("#j-globalNav \x3e li.j-globalNav-li.j-ui-elem")}),searchMenu:new $Menu$$($$$$("#mobile-search \x3e a"),$$$$("#mobile-search \x3e a"),{$items:$$$$("#j-spotlight-search")}),
accordionMenu:new $Menu$$($$$$("a#mobile-sidenav-btn"),$$$$("a#mobile-sidenav-btn").parent(),{noOverlay:!0}),showOverlay:function(){$$$$("#mobile-overlay").addClass("active")},hideOverlay:function(){!this.mainMenu.isOpened()&&(!this.searchMenu.isOpened()&&!$$$$("#navCreate").hasClass("active")&&!$$$$("#j-satNav").hasClass("active"))&&$$$$("#mobile-overlay").removeClass("active")},hideMenus:function(){$$$$(".j-pop .j-pop-main").trigger("close");$responsive$$.mainMenu.close();$responsive$$.searchMenu.close();
$responsive$$.accordionMenu.close();$$$$("#j-globalNav \x3e li.j-globalNav-li.j-ui-elem").removeClass("mobile-active");$$$$("body.j-body-home .j-layout-sl nav.j-column-s, body.j-body-home .j-layout-sls nav.j-column-s, body.jive-body-search .j-layout-sl .j-column-s, nav.j-second-nav, body.jive-body-content .j-column-s, #mobile-sidenav-btn").removeClass("active");$$$$("#mobile-place-menu").hasClass("active")&&($$$$("#mobile-place-menu").toggleClass("active"),$$$$("nav.j-placeNav ul.j-placeMainNav").toggleClass("mobile-active"))},
getCurrentSize:function(){return this._currentSize},showElems:function(){$$$$("body.j-body-home .j-layout-sl nav.j-column-s").addClass("j-loaded");$$$$("body.j-body-home .j-layout-sls nav.j-column-s").addClass("j-loaded");$$$$("body.jive-body-content .j-layout-ls .j-column-s").addClass("j-loaded");$$$$("body.jive-body-search .j-layout-sl .j-column-s").addClass("j-loaded");$$$$("nav.j-second-nav").addClass("j-loaded");$$$$(".j-placeNavWrap").addClass("j-loaded")}};return $responsive$$});
;
jive.namespace("Browse.User");define("apps/browse/user/model/user_source",["apps/shared/models/rest_service"],function(a){jive.Browse.User.ItemSource=a.extend(function(b){b.resourceType="user";this.findAll=function(e){var d=(e.userID)?e.userID:"current";var c=this.RESOURCE_ENDPOINT+"/"+d+"/browse";return this.commonAjaxRequest(new jive.conc.Promise(),"GET",{url:c,data:e||{}})};this.findAllOrgChart=function(e){var d=(e&&e.userID)?e.userID:"current";var c=this.RESOURCE_ENDPOINT+"/"+d+"/orgchart";return this.commonAjaxRequest(new jive.conc.Promise(),"GET",{url:c,data:e||{}})};this.getDirectReportCount=function(d){var c=this.RESOURCE_ENDPOINT+"/"+d.userID+"/directreports/count";return this.commonAjaxRequest(new jive.conc.Promise(),"GET",{url:c,data:{}})};this.getDirectReports=function(d){var c=this.RESOURCE_ENDPOINT+"/"+d.userID+"/directreports";return this.commonAjaxRequest(new jive.conc.Promise(),"GET",{url:c,data:{}})};this.getUserProperty=function(d){var c=this.RESOURCE_ENDPOINT+"/"+d.userID+"/prop/"+d.propName;return this.commonAjaxRequest(new jive.conc.Promise(),"GET",{url:c,data:{}})};this.setUserProperty=function(d){var c=this.RESOURCE_ENDPOINT+"/"+d.userID+"/prop/"+d.propName;return this.commonAjaxRequest(new jive.conc.Promise(),"POST",{url:c,data:d.propValue})};this.removeUserProperty=function(d){var c=this.RESOURCE_ENDPOINT+"/"+d.userID+"/prop/"+d.propName;return this.commonAjaxRequest(new jive.conc.Promise(),"DELETE",{url:c})};this.isLoginProcessing=function(d){var c=this.RESOURCE_ENDPOINT+"/"+d.userID+"/login/processing";return this.commonAjaxRequest(new jive.conc.Promise(),"GET",{url:c,data:{}})}});return jive.Browse.User.ItemSource});
;
jive.namespace("Tips");jive.Tips.TipGroupState=jive.oo.Class.extend(function(a){a.init=function(b){this.stateKey=b.stateKey;this.currentTipId=b.currentTipID||null;this.dismissed=b.dismissed||false;this.skipped=false};this.setCurrentTipId=function(b){this.currentTipId=b};this.getCurrentTipId=function(){return this.currentTipId};this.setDismissed=function(b){this.dismissed=b};this.isDismissed=function(){return this.dismissed};this.setSkipped=function(b){this.skipped=b};this.isSkipped=function(){return this.skipped};this.getKey=function(){return this.stateKey};this.serialize=function(){var b=this.isDismissed()?"true":"false";if(this.currentTipId){b+="#"+this.currentTipId}return b}});define("apps/tips/models/tip_group_state",function(){return jive.Tips.TipGroupState});
;
goog.provide("jive.tips.renderTip");
jive.tips.renderTip=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div id="jive-tips-',soy.$$escapeHtmlAttribute(opt_data.id),'" data-group-id="',soy.$$escapeHtmlAttribute(opt_data.groupId),'" style="display: none" class="j-tips ',opt_data.cssClass?soy.$$escapeHtmlAttribute(opt_data.cssClass):"",'" role="dialog" tabindex="1111" aria-labelledby="',soy.$$escapeHtmlAttribute(opt_data.id),'-Title" aria-describedby="',soy.$$escapeHtmlAttribute(opt_data.id),'-Desc">',
opt_data.templateName?soy.$$filterNoAutoescape(jive.soy.func.eval(opt_data.templateName,true,false,{"data":opt_data.templateData})):(opt_data.titleKey?'<h4 id= "'+soy.$$escapeHtmlAttribute(opt_data.id)+'-Title" class="font-face-deco">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(opt_data.titleKey),[]))+"</h4>":"")+'<p id="'+soy.$$escapeHtmlAttribute(opt_data.id)+'-Desc" >'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(opt_data.bodyKey),[]))+"</p>",'<\!-- BEGIN tip footer --\><div class="j-tips-footer"><div class="j-tips-footer-overlay"></div>',
opt_data.count>1?'<div class="j-pagination"><span class="j-tips-count font-color-meta-light">'+soy.$$escapeHtml(opt_data.index+1)+" / "+soy.$$escapeHtml(opt_data.count)+'</span><span class="j-pagination-prevnext">'+(!opt_data.first?'<a href="#" class="j-pagination-prev js-prev-tip" title="'+soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("tips.prev_tip.title"),[]))+'">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tips.prev_tip"),[]))+"</a>":'<span class="j-pagination-prev j-disabled font-color-meta">'+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tips.prev_tip"),[]))+"</span>")+(!opt_data.last?'<a href="#" class="j-pagination-next js-next-tip" title="'+soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("tips.next_tip.title"),[]))+'">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tips.next_tip"),[]))+"</a>":'<span class="j-pagination-next j-disabled font-color-meta">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tips.next_tip"),[]))+"</span>")+"</span></div>":
"",'<ul class="j-tips-actions"><li><a href="#" class="js-ignore-tips close" title="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("tips.ignore_tips.title"),[])),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tips.ignore_tips"),[])),'</a></li><li><a href="#" class="js-close-tips close" title="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("tips.close_tips.title"),[])),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("tips.close_tips"),[])),"</a></li></ul></div><\!-- END tip footer --\></div>");
return opt_sb?"":output.toString()};
;
/*
 * jQuery imagesLoaded plugin v1.0.3
 * http://github.com/desandro/imagesloaded
 *
 * MIT License. by Paul Irish et al.
 */
(function(a,b){a.fn.imagesLoaded=function(i){var g=this,e=g.find("img").add(g.filter("img")),c=e.length,h="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";function f(){i.call(g,e)}function d(){if(--c<=0&&this.src!==h){setTimeout(f);e.unbind("load error",d)}}if(!c){f()}e.bind("load error",d).each(function(){if(this.complete||this.complete===b){var j=this.src;this.src=h;this.src=j}});return g}})(jQuery);define("jquery/jquery.imagesloaded",["jquery"],function(a){return a.fn.imagesLoaded});
;
Array.prototype.forEach=Array.prototype.forEach||function(b){var a=this.length>>>0;if(typeof b!="function"){throw new TypeError()}var d=arguments[1];for(var c=0;c<a;c++){if(c in this){b.call(d,this[c],c,this)}}};Array.prototype.map=Array.prototype.map||function(b){var a=this.length>>>0;if(typeof b!="function"){throw new TypeError()}var e=new Array(a);var d=arguments[1];for(var c=0;c<a;c++){if(c in this){e[c]=b.call(d,this[c],c)}}return e};Array.prototype.reduce=Array.prototype.reduce||function(b){var a=this.length>>>0;if(typeof b!="function"){throw new TypeError()}if(a==0&&arguments.length==1){throw new TypeError()}var c=0;if(arguments.length>=2){var d=arguments[1]}else{do{if(c in this){d=this[c++];break}if(++c>=a){throw new TypeError()}}while(true)}for(;c<a;c++){if(c in this){d=b.call(null,d,this[c],c,this)}}return d};Array.prototype.reduceRight=function(b){var a=this.length>>>0;if(typeof b!="function"){throw new TypeError()}if(a==0&&arguments.length==1){throw new TypeError()}var c=a-1;if(arguments.length>=2){var d=arguments[1]}else{do{if(c in this){var d=this[c--];break}if(--c<0){throw new TypeError()}}while(true)}for(;c>=0;c--){if(c in this){d=b.call(null,d,this[c],c,this)}}return d};Array.prototype.filter=Array.prototype.filter||function(b){var a=this.length>>>0;if(typeof b!="function"){throw new TypeError()}var e=[];var d=arguments[1];for(var c=0;c<a;c++){if(c in this){var f=this[c];if(b.call(d,f,c)){e.push(f)}}}return e};Array.prototype.every=Array.prototype.every||function(b){var a=this.length>>>0;if(typeof b!="function"){throw new TypeError()}var d=arguments[1];for(var c=0;c<a;c++){if(c in this&&!b.call(d,this[c],c,this)){return false}}return true};Array.prototype.some=Array.prototype.some||function(b){var d=0,a=this.length>>>0;if(typeof b!="function"){throw new TypeError()}var c=arguments[1];for(;d<a;d++){if(d in this&&b.call(c,this[d],d,this)){return true}}return false};Array.prototype.indexOf=Array.prototype.indexOf||function(b){var a=this.length>>>0;var c=Number(arguments[1])||0;c=(c<0)?Math.ceil(c):Math.floor(c);if(c<0){c+=a}for(;c<a;c++){if(c in this&&this[c]===b){return c}}return -1};Array.prototype.lastIndexOf=Array.prototype.lastIndexOf||function(b){var a=this.length;var c=Number(arguments[1]);if(isNaN(c)){c=a-1}else{c=(c<0)?Math.ceil(c):Math.floor(c);if(c<0){c+=a}else{if(c>=a){c=a-1}}}for(;c>-1;c--){if(c in this&&this[c]===b){return c}}return -1};define("lib/jiverscripts/src/compat/array",{});
;
(function(f){var e=/^-?\d+$/;function a(g){var h=g.css("position");return h=="absolute"||h=="relative"||h=="fixed"}function d(g){var h=g.css("z-index");return typeof h=="number"||(h&&h.match(e))}function b(g){return(a(g)&&d(g))||g.is("body")}function c(h,g){return g.toArray().every(function(i){return f.contains(h,i)})}jQuery.fn.effectiveZIndex=function(h){var g;if(h&&h.context){g=f(h.context)}else{if(h&&h.relativeTo){g=this.stackingContexts(h)}else{g=f("body")}}var i=[],j=this;while(j.length>0){if(j[0]!==g[0]){i.push(j)}else{break}j=j.parent()}return i.reduce(function(m,l){var k=f(l);if(b(k)){return parseInt(k.css("z-index"),10)}else{return m}},0)};jQuery.fn.stackingContexts=function(g){var h=(g&&g.relativeTo)?f(g.relativeTo):this;var j=this;var i=this.parents().filter(function(){var l=f(this),k=c(this,j)&&c(this,h);return k&&b(l)});return i};jQuery.fn.stackingContext=function(g){return this.stackingContexts(g).filter(":first")}})(jQuery);
;
jive.namespace("Tips");jive.Tips.TipView=jive.AbstractView.extend(function(a){a.init=function(b){this.tipView=$j.extend({},b)};a.getId=function(){return this.tipView.id};this.hasBeenViewed=function(){return this.shown};this.hasValidSelector=function(){var c=this;if(c.tipView.selector){var d=$j(c.tipView.selector);var b=(c.tipView.hiddenSelectorAllowed||d.is(":visible"));return(d.length>0)&&b}return false};a.getLoadSelector=function(){return this.tipView.loadSelector};this.isInitialTip=function(){return this.initialTip};this.render=function(f){var c=this;this.shown=false;c.triggerEventType=f.triggerEventType;c.triggerSelector=f.triggerSelector;c.groupId=f.id;var b=f.getTipViewsWithValidSelectors();var e=f.findIndexById(c.getId(),b);this.initialTip=e==0;var g=$j.extend(c.tipView,{groupId:c.groupId,count:b.length,first:c.initialTip,last:e==(b.length-1),index:e});var d=jive.tips.renderTip(g);c.$tipElement=$j(d);c.bindTipElementHandlers(f)};a.bindTipElementHandlers=function(c){var b=this;b.$tipElement.find(".js-next-tip").bind("click",function(d){c.showNextTip();d.preventDefault()});b.$tipElement.find(".js-prev-tip").bind("click",function(d){c.showPreviousTip();d.preventDefault()});b.$tipElement.find(".js-ignore-tips").bind("click",function(d){c.skip();d.preventDefault()});b.$tipElement.find(".js-close-tips").bind("click",function(d){c.dismiss();d.preventDefault()})};this.display=function(){var b=this;b.$tipSelector=$j(b.tipView.selector).filter(":first");if(b.$tipSelector.length>0){var c=b.$tipSelector;if(b.triggerSelector){c=$j(b.triggerSelector)}if(c.length>0){this.showTip(c)}else{if(console){console.warn("Please ensure a valid trigger selector is specified for tip "+this.tipView.id)}}}else{if(console){console.warn("Please ensure a valid selector is specified for tip "+this.tipView.id)}}};a.isTransientTrigger=function(){return this.isMouseoverTrigger()||this.isFocusTrigger()};a.isMouseoverTrigger=function(){return this.triggerEventType=="mouseover"};a.isFocusTrigger=function(){return this.triggerEventType=="focus"};a.showTip=function(d){var b=this;if(b.triggerEventType&&b.isInitialTip()){b.$triggerSelector=d;b.$triggerSelector.one(b.triggerEventType,function(f){b.showPopover(f)})}else{var c=b.getLoadSelector();if(c){b.showTipWithLoadSelector(c)}else{b.showPopover()}}};a.showTipWithLoadSelector=function(d){var b=this;var c=$j(d);if(c.length>0){if(c.is("img")){c.imagesLoaded(function(){b.showPopover()})}else{c.bind("load",function(){b.showPopover()})}}else{b.showPopover()}};a.showPopover=function(f){var c=this;if(!c.shown){var b=c.determineTipContext(f);var d={context:b,closeOtherPopovers:true,closeOtherPopoversSelector:"BODY > .js-pop > .j-tips[data-group-id='"+c.groupId+"']"};if(c.tipView.hiddenSelectorAllowed){c.handleInvisibleContext(b)}d=$j.extend(d,c.unbindDefocusHandlers());d=$j.extend(d,c.addCloseOptions());d=$j.extend(d,c.addOffsetOptions());c.$tipElement.popover(d);var e=c.$tipElement.closest(".js-pop");e.css("z-index",b.effectiveZIndex({relativeTo:e})+5);c.bindDefocusHandlers();c.shown=true}};a.hasCloseSelector=function(){return(this.tipView.closeSelector&&this.tipView.closeSelector.length>0)||false};a.isCloseOnClick=function(){return this.hasCloseSelector()&&this.tipView.closeSelector.trim().toLowerCase()=="body"};a.addOffsetOptions=function(){var b=this;return{nudge:{top:b.tipView.belowOffset,bottom:b.tipView.aboveOffset}}};a.addCloseOptions=function(){var b=this;var d=b.hasCloseSelector();var c={closeOnClick:d};if(d){c=$j.extend(c,{closeOnClickSelector:b.tipView.closeSelector})}return c};a.bindDefocusHandlers=function(){var b=this;if(!b.isCloseOnClick()){b.$tipElement.bind("click",function(){b.focusTip()});jive.conc.nextTick(function(){$j("BODY").bind("click",function(c){b.blurTip(c)})})}};a.unbindDefocusHandlers=function(){var b=this;var c={};if(!b.isCloseOnClick()){c=$j.extend(c,{onClose:function(){b.$tipElement.unbind("click",b.focusTip);$j("BODY").unbind("click",b.blurTip);b.restoreContextVisibility()}})}return c};a.determineTipContext=function(e){var d=this;var c=d.$tipSelector;if(e){var b=$j(e.currentTarget);var f=b.find(d.tipView.selector);if(f.length==0&&d.triggerSelector){f=$j(e.target).find(d.triggerSelector)}if(f&&f.length>0){c=f}}return c};a.blurTip=function(f){var b=this;if(b.$tipElement){var c=b.$tipElement.parent();var d=$j(f.target).parents().addBack().toArray().reduce(function(h,e){return h||e==c[0]},false);var g=$j(f.target).parents("body").length>0;if(!d&&g){c.addClass("j-pop-blurred");b.restoreContextVisibility()}}};a.focusTip=function(){if(this.$tipElement){this.$tipElement.parent().removeClass("j-pop-blurred")}};a.handleInvisibleContext=function(c){var b=this;if(!c.is(":visible")){b.hiddenSelector=true;var e=c.attr("style");var d=e&&e.match(/display:/);b.cssDiplayValue=(d)?c.css("display"):"";c.show()}};a.restoreContextVisibility=function(){var b=this;if(b.hiddenSelector&&b.$tipSelector.is(":visible")){b.$tipSelector.css("display",b.cssDiplayValue)}};this.close=function(){if(this.$tipElement){this.$tipElement.trigger("close")}}});define("apps/tips/views/tip_view_view",function(){return jive.Tips.TipView});
;
jive.namespace("Tips");jive.Tips.Tip=jive.AbstractView.extend(function(a){a.init=function(d){var c=this;c.id=d.id;var b=d.views||[];if(!d.views){b.push(d)}this.views=$j.map(b,function(e){return new jive.Tips.TipView($j.extend(e,{id:c.id}))})};a.getActiveTipView=function(){return this.views[this.getValidSelectorIndex()]};this.getId=function(){return this.id};this.hasValidSelector=function(){return this.getValidSelectorIndex()>-1};a.getValidSelectorIndex=function(){var b=this;for(var d=0;d<b.views.length;d++){var c=b.views[d];if(c.hasValidSelector()){return d}}return -1};this.isInitialTip=function(){return this.getActiveTipView().isInitialTip()};this.render=function(b){this.getActiveTipView().render(b)};this.display=function(){this.getActiveTipView().display()};this.close=function(){if(this.hasValidSelector()){this.getActiveTipView().close()}}});define("apps/tips/views/tip_view",function(){return jive.Tips.Tip});
;
jive.namespace("Tips");jive.Tips.TipGroup=jive.AbstractView.extend(function(a){a.init=function(c){var b=this;b.id=c.id;b.index=c.index;b.triggerSelector=c.triggerSelector;b.triggerEventType=c.triggerEventType;b.dismissKey=c.dismissKey||[];b.tips=c.visibleTips||[];b.refreshSelector=c.refreshSelector;b.refreshTimeout=c.refreshTimeout||b.getRefreshTimeout();var d=c.state||{};b.state=new jive.Tips.TipGroupState($j.extend(d,{stateKey:b.dismissKey}));b.buildTipViews();b.bindRefreshHandler()};a.buildTipViews=function(){var b=this;b.tipViews=[];b.activeTipIndex=-1;var c=b.state.getCurrentTipId();$j.each(b.tips,function(e,f){var d=new jive.Tips.Tip(f);if(f.id==c){b.activeTipIndex=(e-1)}b.tipViews.push(d)});while(b.activeTipIndex>=(b.tipViews.length-1)){b.activeTipIndex--}};a.destroyTipViews=function(){$j.each(this.tipViews,function(c,b){b.close()})};a.refresh=function(){var b=this;if(!b.isHidden()){b.destroyTipViews();setTimeout(function(){b.buildTipViews();b.showNextTip()},b.refreshTimeout)}};a.isHidden=function(){return this.state&&(this.state.isSkipped()||this.state.isDismissed())};a.getRefreshTimeout=function(){return jive.localexchange?1000:5000};this.hasVisibleTips=function(){return this.getTipViewsWithValidSelectors().length>0};this.showNextTip=function(){var b=this;var c=b.tipViews;if(c&&b.activeTipIndex<(c.length-1)){b.activeTipIndex++;if(!b.showActiveTip()){b.showNextTip()}}else{if(b.hasVisibleTips()){b.resetSequence()}}};this.showPreviousTip=function(){var b=this;if(b.activeTipIndex>0){b.activeTipIndex--;if(!b.showActiveTip()){b.showPreviousTip()}}else{if(b.hasVisibleTips()){b.resetSequence()}}};a.resetSequence=function(){var b=this;b.activeTipIndex=-1;b.showNextTip()};a.showActiveTip=function(){var b=this;var c=b.getCurrentTipView();if(c){if(c.hasValidSelector()){c.render(b);c.display();b.storeState(c);return true}else{return false}}else{return false}};a.storeState=function(c){var b=this;var d=b.state.getCurrentTipId();if(c.getId()!=d){b.state.setCurrentTipId(c.getId());if(d){b.emit("state",b.state)}}};this.findIndexById=function(b,c){return $j.inArray(b,this.getTipIds(c))};a.getCurrentTipView=function(){return this.tipViews[this.activeTipIndex]};this.skip=function(){var b=this;b.state.setSkipped(true);b.state.setDismissed(false);b.emit("close",b.state)};this.dismiss=function(){var b=this;b.state.setSkipped(false);b.state.setDismissed(true);b.emit("close",b.state)};a.getTipIds=function(b){return $j.map(b,function(c){return c.getId()})};a.getTipViewsWithValidSelectors=function(){var b=this;return $j.map(b.tipViews,function(c){return c.hasValidSelector()?c:null})};a.bindRefreshHandler=function(){var b=this;if(b.hasRefreshSelector()){$j(b.refreshSelector).bind("click",function(c){b.refresh();c.preventDefault()})}else{if(jive.localexchange&&jive.localexchange.viewupdatesource){jive.localexchange.addListener("view.update.start",function(){if(!b.isHidden()){b.destroyTipViews()}});jive.localexchange.addListener("view.update.stop",function(){if(!b.isHidden()){setTimeout(function(){b.buildTipViews();b.showNextTip()},b.refreshTimeout)}})}}};a.hasRefreshSelector=function(){return(this.refreshSelector&&this.refreshSelector.length>0)||false}});define("apps/tips/views/tip_group_view",function(){return jive.Tips.TipGroup});
;
jive.namespace("Tips");jive.Tips.PageView=jive.AbstractView.extend(function(a){a.init=function(c){var b=this;b.currentTipGroupIndex=0;b.tipGroups=c.tipGroups||[];b.asyncLoad=(typeof c.asyncLoad!="undefined")?c.asyncLoad:true;if(b.tipGroups.length>0){b.handleAsyncLoad(function(){b.showNextTipGroup(b.tipGroups[0])})}};a.showNextTipGroup=function(d){var b=this;d.index=b.currentTipGroupIndex;var c=new jive.Tips.TipGroup(d);if(c.hasVisibleTips()){b.addListeners(c);c.showNextTip()}else{if(b.hasUnviewedTipGroups()){b.showNextTipGroup(b.tipGroups[++b.currentTipGroupIndex])}}};a.addListeners=function(c){var b=this;c.addListener("state",function(d){b.emit("state",d)});c.addListener("close",function(d){b.emit("state",d);if(b.hasUnviewedTipGroups()){b.showNextTipGroup(b.tipGroups[++b.currentTipGroupIndex])}})};a.hasUnviewedTipGroups=function(){return this.currentTipGroupIndex<(this.tipGroups.length-1)};a.handleAsyncLoad=function(c){var b=this;if(b.asyncLoad){jive.conc.nextTick(c)}else{c()}}});define("apps/tips/views/page_view",function(){return jive.Tips.PageView});
;
jive.namespace("Tips");jive.Tips.Main=jive.oo.Class.extend(function(a){a.init=function(c){var b=this;if(!$j.deparam.querystring().fromQ){b.userSource=c.userSource||new jive.Browse.User.ItemSource();b.tipView=new jive.Tips.PageView(c);b.skippedTipGroupIDs=c.skippedTipGroupIDs||[];b.tipView.addListener("state",function(d){if(d){if(!d.isSkipped()){b.userSource.setUserProperty({userID:"current",propName:d.getKey(),propValue:d.serialize()})}else{b.skippedTipGroupIDs.push(d.getKey());document.cookie="jive.tipGroups.skipped="+b.skippedTipGroupIDs.unique().join("|")}}})}}});define("apps/tips/main",function(){return jive.Tips.Main});
;
jive.namespace("Trial");define("apps/trial/views/trial_help_view",["jquery"],function(a){return jive.AbstractView.extend(function(b){jive.conc.observable(this);this.init=function(e){var c=this;this.trialBannerID="#jive-trial-banner";this.trialHelpLinkID="#jive-trial-help-link";this.trialHelpPanelID="#jive-trial-help-panel";var f=$j(c.trialBannerID),d=$j(c.trialHelpLinkID),g=$j(c.trialHelpPanelID);if(d){d.click(function(){var h=g.is(".j-active");$j("#jive-trial-help-link").toggleClass("open",!h);$j("#jive-trial-curtain, #jive-trial-help-panel").toggleClass("j-active",!h);b.setJiveHelpCopy(h);h||d.find(".j-js-chat-indicator").hide();return false})}$j("#jive-trial-help-panel a").click(function(h){h.preventDefault();window.open(this.getAttribute("href"))});$j("#jive-trial-help-panel iframe").load(function(){this.contentWindow.jQuery("body").on("onMessageToVisitor",function(){if(!$j("#jive-trial-help-panel").is(".j-active")){$j("#jive-trial-help-link .j-js-chat-indicator").show()}})});$j("#jive-trial-help-panel .close").click(function(h){h.preventDefault();d.click()})};b.setJiveHelpCopy=function(c){var d=c?jive.trial.openHelp():jive.trial.closeHelp();$j("#jive-trial-help-link .j-js-title").text(d)}})});
;
goog.provide("jive.browse.user.userProfileImage");
jive.browse.user.userProfileImage=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.prop.profileImage.url?'<a href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.link)))+'" class="j-user-photo" tabindex="-1"><img src="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.prop.profileImage.url)))+'" alt="'+soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("profile.image.primary"),
[]))+'" width="200"/>'+(opt_data.prop.isVisibleToPartner?'<div class="j-browse-external-access"><span class="jive-icon-med jive-icon-partner" title="'+soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("partner.browse.ext_access"),[]))+'"></span><span>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("partner.browse.external.contributor"),[]))+"</span></div>":"")+"</a>"+(opt_data.prop.profileImage.viewingSelf&&opt_data.prop.profileImage["default"]?'<span class="j-profile-img-text j-rc3"><a href="'+
soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/edit-profile-avatar!input.jspa")))+"?targetUser="+soy.$$escapeUri(opt_data.id)+'" class="j-btn-global">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("profile.image.text.add.photo"),[]))+"</a></span>":""):"");return opt_sb?"":output.toString()};
;
goog.provide("jive.shared.displayutil.userRoleBadgeImage");
jive.shared.displayutil.userRoleBadgeImage=function(opt_data,opt_sb){opt_data=opt_data||{};var output=opt_sb||new soy.StringBuilder;output.append(opt_data.groupBadgeUri&&opt_data.groupBadgeRoleName?'<img src="'+soy.$$escapeHtml(opt_data.groupBadgeUri)+'" title="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("rolebadge."+String(opt_data.groupBadgeRoleName).toLowerCase())),[]))+'" alt="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("rolebadge."+String(opt_data.groupBadgeRoleName).toLowerCase())),
[]))+'" height="16" width="16" class="j-role-badge">':"");return opt_sb?"":output.toString()};
;
goog.provide("jive.people.profile.statusLevel");
jive.people.profile.statusLevel=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.ready?'<div class="j-status-container"><span class="j-status-img"><img src="'+soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.imagePath))+'" alt="'+soy.$$escapeHtml(opt_data.name)+'" title="'+soy.$$escapeHtml(opt_data.name)+'" alt=""/></span><span class="j-status-levels">'+(opt_data.showPoints?soy.$$escapeHtml(opt_data.name)+" ("+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("stslvl.points"),
[opt_data.pointLevel]))+")":"")+"</span></div>":"");return opt_sb?"":output.toString()};
;
goog.provide("jive.nav.menu.create.appActionLink");
jive.nav.menu.create.appActionLink=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<li>");if(opt_data.windowSpec||!opt_data.actionUrl){output.append('<a href="#" rel="nofollow" class="app-action" data-action-id="',soy.$$escapeHtml(opt_data.id),'" data-app-url="',soy.$$escapeHtml(opt_data.appURL),'" data-app-uuid="',soy.$$escapeHtml(opt_data.appUUID),'" data-app-instance-uuid="',soy.$$escapeHtml(opt_data.appInstanceUUID),'" data-name="os-action-link" data-selection-type="',
soy.$$escapeHtml(opt_data.coreAPIType),'" data-label="',soy.$$escapeHtml(opt_data.label),'" data-selection-id="',opt_data.contextObject?soy.$$escapeHtml(opt_data.contextObject.id):"",'" data-view="',opt_data.view?soy.$$escapeHtml(opt_data.view):"",'" data-action-url="',opt_data.actionUrl?soy.$$escapeHtml(opt_data.actionUrl):"",'" data-action-window-spec="',opt_data.windowSpec?soy.$$escapeHtml(opt_data.windowSpec):"",'"',opt_data.tooltip?'title="'+soy.$$escapeHtml(opt_data.tooltip)+'"':"",">");switch(opt_data.icon){case "edit":output.append('<span class="jive-icon-glyph icon-edit"></span>');
break;case "manage":output.append('<span class="jive-icon-glyph icon-gear"></span>');break;case "move":output.append('<span class="jive-icon-glyph icon-move2"></span>');break;case "add":output.append('<span class="jive-icon-glyph icon-plus-circle2"></span>');break;case "delete":output.append('<span class="jive-icon-glyph icon-minus-circle2"></span>');break;case "download":output.append('<span class="jive-icon-glyph icon-download"></span>');break;case "flag":output.append('<span class="jive-icon-glyph icon-flag"></span>');
break;case "graph":output.append('<span class="jive-icon-glyph icon-stats-up"></span>');break;case "link":output.append('<span class="jive-icon-glyph icon-link"></span>');break;case "create":output.append('<span class="jive-icon-glyph icon-pencil2"></span>');break;default:output.append(opt_data.smallView?'<span class="jive-icon-med jive-icon-blank"><img src="'+soy.$$escapeHtml(opt_data.icon)+'" height="16" width="16" alt="" /></span>':'<span class="jive-icon-big jive-icon-blank"><img src="'+soy.$$escapeHtml(opt_data.icon)+
'" height="24" width="24" alt="" /></span>')}output.append('<span class="lnk">',soy.$$escapeHtml(opt_data.label),"</span></a>")}else{output.append('<a href="',soy.$$escapeHtml(opt_data.actionUrl),'" rel="nofollow" data-action-id="',soy.$$escapeHtml(opt_data.id),'" data-app-url="',soy.$$escapeHtml(opt_data.appURL),'" data-app-uuid="',soy.$$escapeHtml(opt_data.appUUID),'" data-app-instance-uuid="',soy.$$escapeHtml(opt_data.appInstanceUUID),'" data-name="os-action-link" data-selection-type="',soy.$$escapeHtml(opt_data.coreAPIType),
'" data-label="',soy.$$escapeHtml(opt_data.label),'" data-selection-id="',opt_data.contextObject?soy.$$escapeHtml(opt_data.contextObject.id):"",'" data-view="',opt_data.view?soy.$$escapeHtml(opt_data.view):"",'" data-action="',opt_data.actionUrl?soy.$$escapeHtml(opt_data.actionUrl):"",'"',opt_data.tooltip?'title="'+soy.$$escapeHtml(opt_data.tooltip)+'"':"",">");switch(opt_data.icon){case "edit":output.append('<span class="jive-icon-glyph icon-edit"></span>');break;case "manage":output.append('<span class="jive-icon-glyph icon-gear"></span>');
break;case "move":output.append('<span class="jive-icon-glyph icon-move2"></span>');break;case "add":output.append('<span class="jive-icon-glyph icon-plus-circle2"></span>');break;case "delete":output.append('<span class="jive-icon-glyph icon-cancel-circle2"></span>');break;case "download":output.append('<span class="jive-icon-glyph icon-download"></span>');break;case "flag":output.append('<span class="jive-icon-glyph icon-flag"></span>');break;case "graph":output.append('<span class="jive-icon-glyph icon-stats-up"></span>');
break;case "link":output.append('<span class="jive-icon-glyph icon-link"></span>');break;case "create":output.append('<span class="jive-icon-glyph icon-pencil2"></span>');break;default:output.append(opt_data.smallView?'<span class="jive-icon-med jive-icon-blank"><img src="'+soy.$$escapeHtml(opt_data.icon)+'" height="16" width="16" alt="" /></span>':'<span class="jive-icon-big jive-icon-blank"><img src="'+soy.$$escapeHtml(opt_data.icon)+'" height="24" width="24" alt="" /></span>')}output.append('<span class="lnk">',
soy.$$escapeHtml(opt_data.label),"</span></a>")}output.append("</li>");return opt_sb?"":output.toString()};
;
goog.provide("jive.nav.menu.create.contentTypeHref");
jive.nav.menu.create.contentTypeHref=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.legacy?opt_data.urlParams?soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.url,jQuery.extend({},function(){var map={};var pairs=[["sr","cmenu"]];for(var i=0;i<pairs.length;i+=1)map[pairs[i][0]]=pairs[i][1];return map}(),opt_data.urlParams))):soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.url,function(){var map=
{};var pairs=[["sr","cmenu"]];for(var i=0;i<pairs.length;i+=1)map[pairs[i][0]]=pairs[i][1];return map}())):"javascript:void(0)");return opt_sb?"":output.toString()};
;
goog.provide("jive.nav.menu.create.contentTypeLink");
jive.nav.menu.create.contentTypeLink=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.iconCss){output.append('<a href="');jive.nav.menu.create.contentTypeHref(soy.$$augmentMap(opt_data,{legacy:(opt_data.linkCss.match(new RegExp("js-legacy-create",""))||[]).length>0}),output);output.append('" class="',soy.$$escapeHtml(opt_data.linkCss),'"',opt_data.urlParams&&opt_data.urlParams.contentType?' data-content-type="'+soy.$$escapeHtml(opt_data.urlParams.contentType)+'"':"",
opt_data.upload?' data-upload="true"':"");if((opt_data.linkCss.match(new RegExp("quick",""))||[]).length>0){output.append(' data-quick-create-url="');jive.nav.menu.create.contentTypeHref(soy.$$augmentMap(opt_data,{legacy:true}),output);output.append('"')}output.append('><span class="',soy.$$escapeHtml(opt_data.iconCss)," jive-icon-",opt_data.iconSize?soy.$$escapeHtml(opt_data.iconSize):opt_data.smallView?"med":"big",'"></span><span class="lnk">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(opt_data.smallView&&
opt_data.smallNameKey?opt_data.smallNameKey:opt_data.nameKey),[])),"</span>",!opt_data.smallView&&opt_data.descriptionKey?'<p class="font-color-normal">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(opt_data.descriptionKey),[]))+"</p>":"","</a>")}return opt_sb?"":output.toString()};
;
goog.provide("jive.nav.menu.create.contentTypeLinkItem");
jive.nav.menu.create.contentTypeLinkItem=function(opt_data,opt_sb){opt_data=opt_data||{};var output=opt_sb||new soy.StringBuilder;if(opt_data.uploadable){output.append("<li>");jive.nav.menu.create.contentTypeLink(soy.$$augmentMap(opt_data.uploadLink,{upload:true,smallView:opt_data.smallView}),output);output.append("</li>")}output.append("<li ",opt_data.id?'id="'+soy.$$escapeHtml(opt_data.id)+'"':"",">");jive.nav.menu.create.contentTypeLink(opt_data,output);output.append("</li>");return opt_sb?"":
output.toString()};
;
/*
 * Copyright 2010 Jive Software
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


/*jslint laxbreak:true forin:true browser:true */
/*extern jive */

jive = this.jive || {};
jive.oo = jive.oo || {};

/**
 * Singleton representing an abstract member.  You can set the value of a field
 * or method of a class implemented with jive.oo.Class to jive.oo._abstract to
 * make that class abstract.  An abstract class or a subclass of an abstract
 * class cannot be instantiated unless any abstract members are overridden with
 * concrete definitions.
 *
 * @field
 * @requires jive.oo.Class
 */
jive.oo.abstract = function() {};
jive.oo._abstract = jive.oo.abstract; // Alias to non-reserved word.

;
define("jquery/jquery.slideMenu",["jquery","underscore","jive/accessibility","soy!jive.shared.displayutil.a11yBoundary"],function(c,b,a){function d(i,n){this.element=c(i);this.options=c.extend({},c.fn.slideMenu.defaults,n);var e=this.options;var m=this.element.addClass("j-slidemenu-main"),l=c('<div class="j-slidemenu js-slidemenu" />').addClass(e.addClass);if(e.setRole){l.attr("role",e.setRole)}e.container=c(e.container);if(!e.container||e.container.length===0){e.container=c("body")}if(e.side=="right"){l.addClass("j-slidemenu-right")}else{l.addClass("j-slidemenu-left")}l.append(m);m.show();l.appendTo(e.container);b.delay(function(){l.addClass("active")},5);(function(){if(e.focus){jive.conc.nextTick(k)}e.onLoad()})();m.autoclose(c.extend({},e,{onClose:j,decoration:l}));var f=new jive.Accessibility({scope:m,hoverSelection:e.hoverSelection,focusOnHover:e.focusOnHover,otherActions:[jive.Accessibility.focusRingAction(m),jive.Accessibility.menuSelectAction({container:m,moveFocus:true})]});if(e.accessibleBoundaryType){if(!m.children(".a11y-boundary").length){var g=a({type:e.accessibleBoundaryType});var h=a({type:e.accessibleBoundaryType,isEnd:true});m.prepend(g).append(h)}}function k(){jive.Accessibility.focusIn(m)}function j(o,p){e.beforeClose();l.remove();m.off(".slideMenu");f.teardown(!e.destroyOnClose);return e.onClose()}}c.fn.slideMenu=function(f){var e=Array.prototype.slice.call(arguments);return this.each(function(){var h=c(this),g=new d(h,f);if(typeof f==="string"&&c.isFunction(g[f])){var i=c.isArray(i[1])?i[1]:[];g[f].apply(g,i)}})};c.fn.slideMenu.Constructor=d;c.fn.slideMenu.defaults={container:c("body"),beforeClose:c.noop,onClose:c.noop,onLoad:c.noop,side:"right",focus:true,destroyOnClose:false,hoverSelection:false,focusOnHover:true,accessibleBoundaryType:"menu",addClass:"",setRole:null};return d});
;
jive.namespace("Navbar.Menu");jive.Navbar.Menu.AbstractListView=jive.AbstractView.extend(function(a,b){this.init=function(d,f,e,g){var c=this;c.$menu=$j(f);c.$button=$j(d);c.menuOpts=e||{};c.slideMenu=g;c.popoverOpen=false;c.$button.on("vclick",function(h){if(!c.popoverOpen){c.$button.addClass("active");c.showSpinner();if(c.spinning){c.spinning=false;c.open();c.spinning=true}c.emitP("toggle").addCallback(function(i){c.data=i||c.data;c.render(c.data);c.open()}).always(function(){c.hideSpinner()})}else{c.close()}h.preventDefault()});c.$menu.on("navbarPopoverLoad",function(){var h=$j(this);_.defer(function(){jive.Accessibility.focusIn(h)})})};this.render=jive.oo._abstract;a.setContent=function(c,d){this.content=$j(c);if(this.popoverOpen&&!this.shouldSlideMenu()){this.$menu.trigger("updatePopoverHTML",[this.content,d])}else{this.$menu.children().remove();this.$menu.append(this.content);if(d){d()}}};this.getContent=function(){this.content=this.content||this.$menu.children();return this.content};this.close=function(){this.$menu.trigger("close")};this.repositionPopover=$j.noop;a.createSpinner=function(){if(!this.popoverOpen){this.spinner=new jive.loader.LoaderView();this.setContent(this.spinner.getContent());this.open()}else{b.createSpinner.call(this)}this.spinning=true};a.destroySpinner=function(){this.spinning=false;b.destroySpinner.call(this);if(this.spinner){this.spinner.destroy()}};a.open=function(){if(this.shouldSlideMenu()){this.openSlideMenu()}else{this.openPopover()}};a.openPopover=function(){var c=this;if(!c.popoverOpen&&!c.spinning){c.$button.addClass("active");var d={};c.$menu.popover($j.extend(d,{context:c.$button,containWithinViewport:true,flip:false,hoverSelection:true,returnPopover:true,onClose:function(){c.repositionPopover=$j.noop;c.$button.removeClass("active");c.popoverOpen=false;c.$menu.find("div.js-onboarding-tip").remove()},onLoad:function(){c.repositionPopover=d.reposition;c.$menu.trigger("navbarPopoverLoad")}},c.menuOpts));c.popoverOpen=true}};a.openSlideMenu=function(){var c=this;if(!c.popoverOpen&&!c.spinning){c.$button.addClass("active");c.$menu.slideMenu({side:"right",onClose:function(){c.$button.removeClass("active");c.popoverOpen=false;c.$menu.find("div.js-onboarding-tip").remove()}});c.popoverOpen=true}};a.shouldSlideMenu=function(){return this.slideMenu&&!$j("body").hasClass("j-responsive-sm")}});define("apps/navbar/menu/view/abstract_list",["jquery/jquery.slideMenu"],function(){return jive.Navbar.Menu.AbstractListView});
;
jive.namespace("Navbar.Menu");jive.Navbar.Menu.Main=jive.oo.Class.extend(function(a){a.init=function(c,e,d){var b=this;this.initialized=false;this.buttonSelector=c;this.listView=this.buildListView(c,e,d);this.itemSource=this.buildItemSource();this.listView.addListener("toggle",function(f){b.populate(f)})};a.populate=function(c){var b=this;if(!b.initialized){if(b.itemSource!=null){$j(b.buttonSelector).attr("aria-busy","true");b.itemSource.findAll(b.sourceParams()).addCallback(function(d){c.emitSuccess(d);$j(b.buttonSelector).attr("aria-busy","false");b.initialized=true})}else{c.emitSuccess({});b.initialized=true}}else{c.emitSuccess()}return c};a.invalidate=function(){this.initialized=false};a.sourceParams=function(){return{}};a.buildListView=jive.oo._abstract;a.buildItemSource=jive.oo._abstract});define("apps/navbar/menu/main",function(){return jive.Navbar.Menu.Main});
;
jive=this.jive||{};jive.oo=jive.oo||{};jive.oo.resolve=function(b,a){var c;return a.superclass.extend(function(e,k){var j=a.definition,i,h=this;if(typeof j=="function"){j.call(h,e,k)}else{for(i in j){if(j.hasOwnProperty(i)){h[i]=j[i]}}}g(h);g(e);f(h);f(e);function g(l){d(l,function(m){if(b[m]===c){delete l[m]}})}function f(l){d(l,function(m){if(b[m]){l[b[m]]=l[m];delete l[m]}})}function d(m,n){for(var l in m){if(b.hasOwnProperty(l)&&m.hasOwnProperty(l)){n(l)}}}})};
;
define("apps/shared/controllers/abstract_flow_controller",function(){jive.AbstractFlowController=jive.oo.Class.extend(function(a){a.init=function(d,c){var b=this;this.initialView=c;this.activeView=c;this.transitions=d;this.events=Object.keys(d);this.views=[c].concat(Object.values(d)).unique();this.resetHistory();b.views.forEach(function(e){b.events.forEach(function(f){e.addListener(f,function(){var h=Array.prototype.slice.call(arguments),g=b.transitions[f];b.transitionTo.apply(b,[g].concat(h));b.viewHistory.push({view:g,args:h});b.activeView=g})});e.addListener("back",function(){b.viewHistory.pop();var h=b.viewHistory.last(),f=h.view,g=h.args;if(b.transitionBack){b.transitionBack.apply(b,[f].concat(g))}else{b.transitionTo.apply(b,[f].concat(g))}b.activeView=f})})};a.transitionTo=jive.oo._abstract;a.resetHistory=function(){this.viewHistory=[{view:this.initialView,data:[]}]}});return jive.AbstractFlowController});
;
define("apps/navbar/menu/create/controllers/create_flow_controller",["jquery","lib/jiverscripts/src/oo/compose","apps/shared/controllers/abstract_flow_controller","apps/navbar/menu/view/abstract_list","apps/shared/controllers/localexchange","jive/namespace"],function(b,e,d,c,a){jive.namespace("Navbar.Menu.Create");jive.Navbar.Menu.Create.CreateFlowController=e(jive.oo.resolve({init:"initFlowController"},d),jive.oo.resolve({init:"initListView"},c)).extend(function(f,g){f.init=function(h,k,l,j,i){this.initFlowController(l,j);this.initListView(h,k,i);this.views.forEach(function(m){m.addListener("browse",function(){jQuery(k).trigger("close")})})};this.render=function(h){this.activeView=this.initialView;this.activeView.render(h);this.setContent(this.activeView.getContent());this.setClass();this.resetHistory()};this.getContent=function(){return this.activeView.getContent()};f.setContent=function(h,i){this.setClass();g.setContent.call(this,h,i)};f.transitionTo=function(i){var k=Array.prototype.slice.call(arguments,1),h=this,j=this.activeView.getClass?this.activeView.getClass():"",m=i.getClass?i.getClass():"";var n=i.render.apply(i,k).addCallback(function(){var o=i.getContent();h.setContent(o,function(){o.find("a, input").filter(":visible").first().focus();a.emit("containerChooserUpdated")})});var l=k.last();if(k.last()&&k.last().emitSuccess&&k.last().emitError){n.addCallback(l.emitSuccess.bind(l));n.addErrback(l.emitError.bind(l))}};f.setClass=function(){var h=this.$menu,i=this.activeView.getClass?this.activeView.getClass():"";this.views.filter(function(j){return j.getClass||j.getClassToRemove}).forEach(function(k){var j=k.getClassToRemove?k.getClassToRemove():k.getClass;h.removeClass(j)});if(i){h.addClass(i)}}});return jive.Navbar.Menu.Create.CreateFlowController});
;
goog.provide("jive.nav.menu.create.contentTypes");
jive.nav.menu.create.contentTypes=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-pop-desc">',opt_data.smallView?'<a href="#" class="toggle j-menu-quick-toplink js-use-large-menu font-color-meta" role="presentation">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("nav.bar.create.use_large_link"),[]))+"</a>":'<a href="#" class="toggle j-menu-quick-toplink js-use-small-menu font-color-meta" role="presentation">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("nav.bar.create.use_small_link"),
[]))+"</a>","<h2>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("nav.bar.create.link"),[])),'</h2></div><div class="j-nav-menu-scrollable js-nav-menu-scrollable">');var sectionList16=opt_data.sections;var sectionListLen16=sectionList16.length;for(var sectionIndex16=0;sectionIndex16<sectionListLen16;sectionIndex16++){var sectionData16=sectionList16[sectionIndex16];if(sectionData16.visible){output.append('<strong class="j-menu-quick-sectionlabel font-color-meta-light">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(sectionData16.name),
[])),'</strong><ul id="create-list-',soy.$$escapeHtml(sectionIndex16),'" class="j-icon-list js-create-list">');var itemList24=sectionData16.items;var itemListLen24=itemList24.length;for(var itemIndex24=0;itemIndex24<itemListLen24;itemIndex24++){var itemData24=itemList24[itemIndex24];if(itemData24.visible)if(itemData24.appAction)jive.nav.menu.create.appActionLink(soy.$$augmentMap(itemData24,{smallView:opt_data.smallView}),output);else jive.nav.menu.create.contentTypeLinkItem(soy.$$augmentMap(itemData24,
{smallView:opt_data.smallView}),output)}output.append("</ul>")}}output.append("</div>");return opt_sb?"":output.toString()};
;
define("apps/navbar/menu/create/views/type_chooser_view",["jquery","underscore","apps/shared/views/abstract_view","lib/jiverscripts/src/conc/promise","channel!app","application/config","soy!jive.nav.menu.create.contentTypes","jive/namespace"],function(g,b,e,f,d,a,c){jive.namespace("Navbar.Menu.Create");jive.Navbar.Menu.Create.TypeChooserView=jive.AbstractView.extend(function(h){var i=jQuery;this.getContent=function(){return this.content};this.getClass=function(){if(this.data&&!this.data.smallView){return"j-choose-type j-large-view"}else{return"j-choose-type j-small-view"}};this.getClassToRemove=function(){return"j-choose-type j-small-view j-large-view"};this.render=function(k){var j=i(jive.nav.menu.create.contentTypes(this.data||k)),m=new jive.conc.Promise(),l=this;l.updateCurrentContainer();j.on("click",".js-create-list a",function(p){var q=i(this),r=q.attr("data-content-type"),o=!!q.attr("data-upload");if(q.hasClass("quick")){l.showSpinner({size:"small",showLabel:false,context:i(this).parent("li")});var n=q.data("quick-create-url");l.emit("quickCreate",r,n);p.preventDefault()}else{if(r&&q.hasClass("js-createmenu-containerchooser")){l.showSpinner({size:"small",showLabel:false,context:i(this).parent("li")});l.emitP("contentType",r,o).always(function(){l.hideSpinner()});p.preventDefault()}}});l.flatFind(j,".js-use-small-menu").click(function(n){l.data.smallView=true;l.emit("toggleView",true,l.data);n.preventDefault()});l.flatFind(j,".js-use-large-menu").click(function(n){l.data.smallView=false;l.emit("toggleView",false,l.data);n.preventDefault()});this.content=j;this.data=this.data||k;if(l.currentContainerType&&l.currentContainerID){$j(j).find("a.js-container-context").each(function(){$j(this).querystring("containerType="+l.currentContainerType+"&containerID="+l.currentContainerID)})}m.emitSuccess();return m};h.flatFind=function(k,j){return k.find(j).addBack().filter(j)};h.updateCurrentContainer=function(){var j=this;if(containerType&&containerID&&(typeof j.currentContainerType=="undefined"||typeof j.currentContainerID=="undefined")){j.currentContainerID=containerID;j.currentContainerType=containerType}}});return jive.Navbar.Menu.Create.TypeChooserView});
;
goog.provide("jive.statusinput.containers.microbloggingStatusInputModalSuccess");
jive.statusinput.containers.microbloggingStatusInputModalSuccess=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<p>",opt_data.wallentry.status!="AWAITING_MODERATION"?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("eae.mb.post.success.title"),[opt_data.wallentry.containerName])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("we.form.posted.moderation.place.name"),[opt_data.wallentry.containerName])),"</p>");return opt_sb?"":output.toString()};
;
jive.namespace("MicroBlogging");define("apps/microblogging/views/microblogging_view",["apps/microblogging/views/status_input_common_view","jquery","soy!jive.statusinput.mention_warnings.jsI18nHelper"],function(a,c,b){jive.MicroBlogging.MicroBloggingView=a.extend(function(d,e){this.init=function(f){this.options=f;this.publishBarIdentifier="";if(f.publishBarIdentifier){this.publishBarIdentifier=f.publishBarIdentifier}e.init.call(this,f)};d.getSoyTemplate=function(f){return jive.statusinput.containers.microbloggingStatusInput(f)};this.createWaitingViewElem=function(){this.$waitingViewElem=this.getContent()};this.createFormElem=function(){var f=this.getContent();this.$formElem=f.find("form");this.$imageFormElem=f.find("div.j-meta-image-container form")};this.renderResponse=function(f){e.renderResponse.call(this,f);this.renderResponseCommon(f)};this.getDataFromDom=function(){var f=0;var j=0;var g=0;var h=0;if(c("#"+this.publishBarIdentifier+"j-publishbar-place-id")){f=c("#"+this.publishBarIdentifier+"j-publishbar-place-id").val()}if(c("#"+this.publishBarIdentifier+"j-publishbar-place-type")){j=c("#"+this.publishBarIdentifier+"j-publishbar-place-type").val()}if(this.getContent().find("li.j-thumbnail.selected")){var i=this.getContent().find("li.j-thumbnail.selected");h=i.closest("li.js-attached-link").attr("id");g=i.find("img").data("image-id")}return{wallentry:{message:this.normalizeData(),containerID:f,containerType:j,imageID:g,attachmentID:h}}};this.handleAtMentionResult=function(l,i,h){var j=this;var g;var k;if(l&&l.split("-").length==2){g=l.split("-")[0];k=l.split("-")[1]}else{g=h;k=l}if(k&&g){if(g!=3&&g!="tag"){var f=new jive.rte.EntitlementService({objectID:0,objectType:0,entitlement:"VIEW"});if(f&&g){f.checkEntitlement(g,k).addCallback(function(m){if(!m){var n="";if(g==700){n=jive.i18n.keys.tinymceJivementionSecretGroup()}else{n=jive.i18n.keys.tinymceJivementionRestrictedContent()}c("<p>"+i+" "+n+"</p>").message({style:"warn"})}})}}}}});return jive.MicroBlogging.MicroBloggingView});
;
jive.namespace("MicroBlogging");define("apps/microblogging/status_input_mb_create_modal_controller",["apps/microblogging/status_input_common_controller","soy!jive.statusinput.containers.microbloggingStatusInputModalSuccess"],function(b,a){jive.MicroBlogging.MBCreateModalController=b.extend(function(c,d){this.init=function(e){if(!e){e={}}e.trackingID="cmenu";this.options=e;this.publishBarIdentifier="";if(e.publishBarIdentifier){this.publishBarIdentifier=e.publishBarIdentifier;this.publishBarViewBean=e.publishBarViewBean}d.init.call(this,e)};c.initMBView=function(){var e=$j("#j-js-mb-modal-editor");this.microbloggingView=new jive.MicroBlogging.MicroBloggingView({selector:"#j-js-mb-modal-editor",idPostfix:"mbASHeader",atMentionBtn:e.find("a.jive-js-mention-button"),imgAttachmentBtn:e.find(".jive-js-imgattach-button"),imagesEnabled:!!e.find(".jive-js-imgattach-button").data("enabled"),linkBtn:e.find("a.jive-js-link-button"),cancelBtn:e.find("a.j-status-input-cancel"),submitBtn:e.find("a.j-status-input-submit"),maxCharCount:parseInt(e.data("maxcharcount"),10),publishBarIdentifier:this.publishBarIdentifier,publishBarViewBean:this.publishBarViewBean})};c.submitSuccessCallback=function(e,f){d.submitSuccessCallback.call(this,e,f);if(e.wallentry.errorMessage==undefined){$j("div.jive-modal-quickcreate").trigger("close");$j(a({wallentry:e.wallentry})).message({style:"success"})}}});return jive.MicroBlogging.MBCreateModalController});
;
define("apps/navbar/menu/create/views/quick_create_view",["jquery","apps/shared/views/abstract_view","soy!jive.nav.menu.create.quick","jquery/jquery.lightbox_me","jive/namespace"],function(c,b,a){jive.namespace("Navbar.Menu.Create");jive.Navbar.Menu.Create.QuickCreateView=b.extend(function(d){var e;this.render=function(){var f=this;var g=this;return f.emitP("fetch").addCallback(function(h){g.showQuickView(h)})};this.showQuickView=function(k){var g=this;var m=new jive.conc.Promise();var i=g.separateScripts(k.body),h=i[0],f=i[1],l=(h.match(/data-title\s*=\s*(['"])(.+?)\1/)||[])[2]||"",j;l=c("<div/>",{html:l}).text();j=c(jive.nav.menu.create.quick({title:l,body:h}));j.lightbox_me({closeSelector:".close",closeClick:false,closeEsc:false,destroyOnClose:true,initialFocusSelector:"input[type=text]:first",additionalFocusSelectors:"div[contenteditable]",closeFocusSelector:"#navCreate",onLoad:function(){f();m.emitSuccess()},onClose:function(){j.trigger("lightboxclose");delete g.content}});g.content=j}});return jive.Navbar.Menu.Create.QuickCreateView});
;
goog.provide("jive.placepicker.containers");
jive.placepicker.containers=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<nav class="j-nav-back"><p class="font-color-meta"><strong><span class="',opt_data.upload&&opt_data.selectedContentType.uploadLink?soy.$$escapeHtmlAttribute(opt_data.selectedContentType.uploadLink.iconCss):soy.$$escapeHtmlAttribute(opt_data.selectedContentType.iconCss),' jive-icon-med"></span>',opt_data.upload&&opt_data.selectedContentType.uploadLink?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(opt_data.selectedContentType.uploadLink.headingKey),
[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(opt_data.selectedContentType.headingKey),[])),'</strong>(<a href="#" class="back">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("nav.bar.create.select_different_type"),[])),'</a>)</p></nav><div role="search"><h4 class="font-color-meta">',opt_data.upload&&opt_data.selectedContentType.uploadLink?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(opt_data.selectedContentType.uploadLink.searchPlaceholderKey),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(opt_data.selectedContentType.searchPlaceholderKey),
[])),'</h4><div class="j-createPlaceSearch"><label for="container-filter-id" class="j-508-label">',opt_data.upload&&opt_data.selectedContentType.uploadLink?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(opt_data.selectedContentType.uploadLink.searchPlaceholderKey),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(opt_data.selectedContentType.searchPlaceholderKey),[])),'</label><input type="search" name="container-filter" id="container-filter-id" class="j-form-elem-special j-container-browse-search j-ui-elem" /></div></div><div class="j-places-list">');
jive.placepicker.recentPlaces(opt_data,output);output.append('</div><a href="#" class="j-menu-quick-bottomlink">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("nav.bar.create.browse_places"),[])),"</a>");return opt_sb?"":output.toString()};
;
jive.namespace("Navbar.Menu.Create");jive.Navbar.Menu.Create.ContainerChooserView=jive.AbstractView.extend(function(a){var c=jQuery,b=jive.Navbar.Menu.Create;this.getContent=function(){return this.content};this.getClass=function(){return"j-choose-container"};this.render=function(){var e=new jive.conc.Promise(),d=this;this.emitP("render").addCallback(function(h){var f,i,j,g=$j.deparam.querystring();if(g.fromQ){h.fromQ=g.fromQ}d.content=c(jive.placepicker.containers(h));d.content.find(".back").one("click",function(k){d.emit("back");k.preventDefault()});d.content.filter(".j-menu-quick-bottomlink").one("click",function(k){d.emit("browse",h);k.preventDefault()});i=d.flatFind(d.content,".j-places-list");j=new jive.Placepicker.ContainerSearchView(d.flatFind(d.content,"input[name=container-filter]"),i);d.proxyListener(j,"search");e.emitSuccess()});return e};a.flatFind=function(e,d){return e.find("*").addBack().filter(d)}});define("apps/navbar/menu/create/views/container_chooser_view",function(){return jive.Navbar.Menu.Create.ContainerChooserView});
;
define("apps/navbar/menu/create/models/create_source",["apps/shared/models/rest_service"],function(a){jive.namespace("Navbar.Menu.Create");jive.Navbar.Menu.CreateSource=a.extend(function(b){b.resourceType=b.pluralizedResourceType="createmenu"});return jive.Navbar.Menu.CreateSource});
;
jive.namespace("Placepicker");define("apps/placepicker/models/suggested_containers_source",["apps/shared/models/rest_service"],function(a){jive.Placepicker.SuggestedContainersSource=a.extend(function(b,c){b.resourceType="container";b.init=function(d){c.init.call(this,d);$j.extend(this.defaultParams,{containerType:d.containerType,containerID:d.containerID});this.RESOURCE_ENDPOINT=jive.rest.url("/containers/suggested")}});return jive.Placepicker.SuggestedContainersSource});
;
jive.namespace("Navbar.Menu.Create");jive.Navbar.Menu.Create.QuickCreateSource=jive.oo.Class.extend(function(a){this.fetch=function(b,d){var c=d||new jive.conc.Promise();$j.get(b,function(e){c.emitSuccess({body:e})});return c}});define("apps/navbar/menu/create/models/quick_create_source",function(){return jive.Navbar.Menu.Create.QuickCreateSource});
;
jive.namespace("Navbar.Menu.Create");jive.Navbar.Menu.Create.Main=jive.Navbar.Menu.Main.extend(function(a,b){a.init=function(d,e){var c=this;b.init.call(this,d,e,{container:".js-create-nav-container"});this.suggestedContainers=new jive.Placepicker.SuggestedContainersSource({containerType:containerType,containerID:containerID});this.containers=new jive.Placepicker.SearchContainersSource();this.browseContainers=new jive.Placepicker.BrowseContainersSource();this.placePicker=new jive.Placepicker.PlacePickerSource("create",{containerType:containerType,containerID:containerID});this.quickCreateSource=new jive.Navbar.Menu.Create.QuickCreateSource();this.userPrefSource=new jive.Browse.User.ItemSource();this.contentTypes={};this.currentContainerType=containerType;this.currentContainerID=containerID;this.listView.addListener("toggle",function(f){f.addCallback(function(g){c.initializeData(g);jive.localexchange.emit("navbarCreateMenuToggled")})});jive.localexchange.addListener("actions.create",function(f){c.selectedContentType=f.contentType;c.upload=f.upload;c.populate(new jive.conc.Promise()).addCallback(function(h){c.initializeData(h);var g=new jive.Placepicker.Main($j.extend({pickerContext:"create",followLinks:true,objectType:c.selectedContentType,upload:c.upload},c.contentTypes[c.selectedContentType]));g.showPicker();c.invalidate()})});jive.Accessibility.main.addHotkey("c",false,false,false,jive.Accessibility.clickAction($j(d)))};a.buildListView=function(f,h,g){var d=new jive.Navbar.Menu.Create.TypeChooserView(),e=new jive.Navbar.Menu.Create.ContainerChooserView(),i=new jive.Navbar.Menu.Create.QuickCreateView(),c=this;c.flowController=new jive.Navbar.Menu.Create.CreateFlowController(f,h,{contentType:e,toggleView:d},d,g);d.addListener("contentType",function(k,j){c.selectedContentType=k;c.upload=j}).addListener("toggleView",function(k,j){c.userPrefSource.setUserProperty({userID:"current",propName:"CreateMenuService.smallView",propValue:String(k)});c.initializeData(j)});e.addListener("render",function(j){c.suggestedContainers.get(c.selectedContentType).addCallback(function(k){j.emitSuccess(jQuery.extend({upload:c.upload,selectedContentType:c.contentTypes[c.selectedContentType]},k))})});e.addListener("search",function(j,k){c.containers.findAll({query:j,contentType:c.selectedContentType,maxReturned:10}).addCallback(function(l){k.emitSuccess(jQuery.extend({contentType:c.selectedContentType,containerType:containerType,containerID:containerID,upload:c.upload},l))})});e.addListener("browse",function(k){var j=new jive.Placepicker.Main($j.extend({pickerContext:"create",followLinks:true,objectType:c.selectedContentType,containerType:k.containerType,containerID:k.containerID,upload:c.upload},k.selectedContentType));j.showPicker()});d.addListener("quickCreate",function(k,j){c.selectedContentType=k;c.url=j;require(["apps/direct_messaging/factory"],function(l){if(l.isContentTypeEqualTo(k)){c.flowController.close();l.create({trackingID:"cmenu"}).showModal()}else{i.render()}})});i.addListener("fetch",function(j){c.flowController.close();if(c.url){c.quickCreateSource.fetch(c.url,j)}});jive.localexchange.addListener("createMenu.close",function(){c.flowController.close()});return c.flowController};a.buildItemSource=function(){return new jive.Navbar.Menu.CreateSource()};a.sourceParams=function(){return{containerType:containerType,containerID:containerID}};a.initializeData=function(d){var c=this;if(d){d.sections.reduce(function(e,f){return e.concat(f.items)},[]).filter(function(e){return e.urlParams&&e.urlParams.contentType}).forEach(function(e){if(e.id===null){delete e.id}if(c.currentContainerType&&typeof e.urlParams.containerType=="undefined"){e.urlParams.containerType=""+c.currentContainerType}if(c.currentContainerID&&typeof e.urlParams.containerID=="undefined"){e.urlParams.containerID=""+c.currentContainerID}c.contentTypes[e.urlParams.contentType]=jQuery.extend({id:e.urlParams.contentType,headingKey:e.headingKey,personalContainerTitleKey:e.personalContainerTitleKey,personalContainerCaptionKey:e.personalContainerCaptionKey,searchPlaceholderKey:e.searchPlaceholderKey},e)})}$j("a.js-container-context.quick").each(function(){$j(this).data("quick-create-url",$j(this).data("quick-create-url")+"&containerType="+c.currentContainerType+"&containerID="+c.currentContainerID);$j(this).removeClass("js-container-context")});$j("a.js-container-context").each(function(){$j(this).querystring("containerType="+c.currentContainerType+"&containerID="+c.currentContainerID);$j(this).removeClass("js-container-context")})}});define("apps/navbar/menu/create/main",function(){return jive.Navbar.Menu.Create.Main});
;
goog.provide("jive.nav.menu.link");
jive.nav.menu.link=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<li",opt_data.itemCss?' class="'+soy.$$escapeHtml(opt_data.itemCss)+'"':"",'><a id="',soy.$$escapeHtml(opt_data.id),'" href="',soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.url?opt_data.url:"#")),'"',opt_data.urlParams&&opt_data.urlParams.contentType?' data-content-type="'+soy.$$escapeHtml(opt_data.urlParams.contentType)+'" ':"",opt_data.headingKey?' data-heading-key="'+
soy.$$escapeHtml(opt_data.headingKey)+'" ':"",opt_data.linkCss?'class="'+soy.$$escapeHtml(opt_data.linkCss)+'"':"",opt_data.target?' target="'+soy.$$escapeHtml(opt_data.target)+'" ':"",'><span class="lnk">',opt_data.name?soy.$$escapeHtml(opt_data.name):opt_data.nameKey?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(opt_data.nameKey),[])):"","</span></a></li>");return opt_sb?"":output.toString()};
;
goog.provide("jive.nav.menu.generic");jive.nav.menu.generic=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<ul>");var linkList4=opt_data.links;var linkListLen4=linkList4.length;for(var linkIndex4=0;linkIndex4<linkListLen4;linkIndex4++){var linkData4=linkList4[linkIndex4];if(linkData4.visible)jive.nav.menu.link(linkData4,output)}if(opt_data.lastLink&&opt_data.lastLink.visible)jive.nav.menu.link(opt_data.lastLink,output);output.append("</ul>");return opt_sb?"":output.toString()};
;
jive.namespace("Navbar.Menu.Custom");jive.Navbar.Menu.Custom.View=jive.AbstractView.extend(function(a,b){this.init=function(d,f,e){var c=this;c.$menu=$j(f);c.$button=$j(d);c.menuOpts=$j.extend({container:d},e);c.popoverOpen=false;c.$button.on("vclick",function(g){if(!c.popoverOpen){c.emitP("toggle").addCallback(function(h){c.data=h||c.data;c.openPopover()}).always(function(){c.hideSpinner();var h=c.getContent();if(h&&h.length){jive.Accessibility.focusIn(h)}})}if(!$j.contains(c.$menu[0],g.target)){g.preventDefault()}})};a.openPopover=function(){var c=this;if(!c.popoverOpen){c.$button.find("a").addClass("active");c.$menu.popover($j.extend({context:c.$button,flip:false,hoverSelection:true,onClose:function(){c.$button.find("a").removeClass("active");c.popoverOpen=false;c.$menu.find("div.js-onboarding-tip").remove();c.$menu.trigger("navbarPopoverClose")},onLoad:function(){c.$menu.trigger("navbarPopoverLoad")}},c.menuOpts));c.popoverOpen=true}}});define("apps/navbar/menu/custom/views/custom_view",function(){return jive.Navbar.Menu.Custom.View});
;
jive.namespace("Navbar.Menu.Custom");jive.Navbar.Menu.Custom.Main=jive.Navbar.Menu.Main.extend(function(a,b){this.init=function(d,f,e){var c=this;b.init.call(this,d,f,e)};a.buildListView=function(c,e,d){return new jive.Navbar.Menu.Custom.View(c,e,d)};a.buildItemSource=function(){return null}});define("apps/navbar/menu/custom/main",function(){return jive.Navbar.Menu.Custom.Main});
;
goog.provide("jive.i18n.keys.appframeworkAppInstalled");jive.i18n.keys.appframeworkAppInstalled=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("appframework.app.installed"),[])));return opt_sb?"":output.toString()};
;
goog.provide("jive.nav.menu.apps.instances.computeWidthIcon");
jive.nav.menu.apps.instances.computeWidthIcon=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.count==0?"app-list-cols-0 app-list-lg-icon":opt_data.count==1?"app-list-cols-1 app-list-lg-icon":opt_data.count<=4?"app-list-cols-2 app-list-lg-icon":opt_data.count<=9?"app-list-cols-3 app-list-lg-icon":opt_data.count<=16?"app-list-cols-4 app-list-sm-icon":opt_data.count<=25?"app-list-cols-5 app-list-sm-icon":"app-list-cols-6 app-list-sm-icon");return opt_sb?"":output.toString()};
;
goog.provide("jive.nav.menu.apps.instances.renderAppInstanceLink");
jive.nav.menu.apps.instances.renderAppInstanceLink=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<li class="j-quick-launch-app-item"',opt_data.searchResult?' data-search-found="'+soy.$$escapeHtmlAttribute(opt_data.searchResult.found)+'"':"","><a ",opt_data.appUUID?'id="app-ql-'+soy.$$escapeHtmlAttribute(opt_data.appUUID)+'"':"",' href="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.url)),'" ',opt_data.blockedAppInstance?'class="j-quick-launch-app-warn-alert"':
"",'><img alt="" src="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.iconSize==48?opt_data.smallIconSrc:opt_data.largeIconSrc)),'" width="',soy.$$escapeHtmlAttribute(opt_data.iconSize?opt_data.iconSize:"128"),'" height="',soy.$$escapeHtmlAttribute(opt_data.iconSize?opt_data.iconSize:"128"),'" class="js-app-icon"/><div class="j-app-title">',opt_data.blockedAppInstance?'<span class="jive-icon-sml  jive-icon-warn"></span>':"",'<span class="lnk">',soy.$$escapeHtml(opt_data.title),"</span></div></a></li>");
return opt_sb?"":output.toString()};
;
goog.provide("jive.nav.menu.apps.instances.appList");
jive.nav.menu.apps.instances.appList=function(opt_data,opt_sb){opt_data=opt_data||{};var output=opt_sb||new soy.StringBuilder;if(opt_data.links&&opt_data.links.length>0){output.append('<ul id="j-quick-launch-apps-list" class="clearfix ');jive.nav.menu.apps.instances.computeWidthIcon({count:opt_data.links.length},output);output.append('">');var linkList9=opt_data.links;var linkListLen9=linkList9.length;for(var linkIndex9=0;linkIndex9<linkListLen9;linkIndex9++){var linkData9=linkList9[linkIndex9];jive.nav.menu.apps.instances.renderAppInstanceLink({appUUID:linkData9.appUUID,
url:linkData9.url,largeIconSrc:linkData9.largeIconSrc,smallIconSrc:linkData9.iconSrc,iconSize:opt_data.links.length<=9?128:48,title:linkData9.displayTitle,blockedAppInstance:linkData9.blockedAppInstance,searchResult:opt_data.searchResults?opt_data.searchResults[linkIndex9]:null},output)}output.append("</ul>")}else if(opt_data.searchResults)output.append('<div class="j-no-apps-installed"><div class="j-empty-container"><p class="font-color-meta">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("nav.bar.apps.search.none.found"),
["No installed apps match your search"])),"</p></div></div>");else{output.append('<div class="j-no-apps-installed j-empty-view"><div class="j-empty-container"><p class="font-color-meta"><strong>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("nav.bar.apps.market.no.apps"),["There are currently no apps installed."])),"</strong></p>");if(opt_data.appsMarketEnabled){output.append("<p>");jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("nav.bar.apps.market.no.apps.expound"),arg0:'<a class="js-launch-app-market" href="#">'+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("nav.bar.apps.market.catalog.title"),[]))+'<span class="j-ui-elem j-cta-arrow"></span></a>',noAutoEscape:true},output);output.append("</p>")}output.append("</div></div>")}return opt_sb?"":output.toString()};
;
jive.namespace("Apps");jive.AppMarketLaunch=$Class.extend({init:function(a){var b=this;this.appLaunchView=a.appLaunchView},showAppMarket:function(a){require(["appContainer"],function(b){b.handleMarketContext(a)})},addApp:function(b){var a=$j(jive.nav.menu.apps.instances.renderAppInstanceLink({appLink:b}));this.appLaunchView.showLaunchPad();$j(this.appLaunchView.$menu).find("#j-quick-launch-apps-list").fadeIn(200).append(a)}});
;
jive.namespace("Navbar.Menu.Apps.Instances");jive.Navbar.Menu.Apps.Instances.Main=jive.Navbar.Menu.Main.extend(function(a,b){this.init=function(d,f,e){b.init.call(this,d,f,e);var c=this;require(["appContainer"],function(g){g.getMarketEvents().addListener("app_install",function(k,o){var n=o&&o.offset();if($j.isArray(k)){for(var m=0,j=k.length;m<j;++m){h(k[m])}}else{h(k)}function h(i){jive.switchboard.emit("app.install.ended");c.invalidate();var l=jive.apps.container.renderMessage({message:jive.i18n.keys.appframeworkAppInstalled()});$j("<p/>").html(l).message({style:"info"})}});g.getMarketEvents().addListener("show_app_detail",function(h){if(h&&h.appUUID){var i=jive.app.url({path:"/apps/market/marketapp/"})+h.appUUID;window.open(i)}})});jive.switchboard.addListener("apps_market.apps_have_changed",function(){c.invalidate()})};this.buildListView=function(c,e,d){return new jive.Navbar.Menu.Apps.Instances.ListView(c,e,d)};this.buildItemSource=function(){return new jive.AppInstanceSource()};a.sourceParams=function(){return{ts:new Date().getTime()}}});define("apps/navbar/menu/apps/instances/main",function(){return jive.Navbar.Menu.Apps.Instances.Main});
;
goog.provide("jive.nav.menu.apps.instances.content");
jive.nav.menu.apps.instances.content=function(opt_data,opt_sb){opt_data=opt_data||{};var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-pop-desc"><h2>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("nav.bar.apps.subTitle"),[])),"</h2></div>",opt_data.links&&opt_data.links.length>9?'<div id="j-quick-launch-search" class="j-appSearch j-form"><label for="js-quick-launch-search-string" class="j-508-label">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("nav.bar.apps.search.label"),["Search installed Apps"]))+
'</label><input id="js-quick-launch-search-string" type="text" placeholder="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("nav.bar.apps.search.prompt"),["Search installed Apps"]))+'"/></div>':"",'<div id="j-quick-launch-apps" class="j-nav-menu-scrollable js-nav-menu-scrollable">');jive.nav.menu.apps.instances.appList({links:opt_data.links,searchResults:false,appsMarketEnabled:opt_data.appsMarketEnabled},output);output.append("</div>");if(opt_data.appsMarketEnabled){output.append('<div id="app-market-links" class="j-appmarketLinks"><ul id="j-app-market-nav" class="');
jive.nav.menu.apps.instances.computeWidthIcon({count:opt_data.links.length},output);output.append('"><li><a id="app-launch-your-apps" href="#"><span class="lnk">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("nav.bar.apps.market.manage.title"),[])),'</span></a></li><li><a id="app-launch-market" href="#"><span class="lnk">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("nav.bar.apps.market.catalog.title"),[])),"</span></a></li></ul></div>")}return opt_sb?"":output.toString()};
;
(function(b){b.path={};var a={rotate:function(f,g){var e=g*3.141592654/180;var h=Math.cos(e),d=Math.sin(e);return[h*f[0]-d*f[1],d*f[0]+h*f[1]]},scale:function(c,d){return[d*c[0],d*c[1]]},add:function(d,c){return[d[0]+c[0],d[1]+c[1]]},minus:function(d,c){return[d[0]-c[0],d[1]-c[1]]}};b.path.bezier=function(g){g.start=b.extend({angle:0,length:0.3333},g.start);g.end=b.extend({angle:0,length:0.3333},g.end);this.p1=[g.start.x,g.start.y];this.p4=[g.end.x,g.end.y];var d=a.minus(this.p4,this.p1);var e=a.scale(d,g.start.length);e=a.rotate(e,g.start.angle);this.p2=a.add(this.p1,e);var c=a.scale(d,-1);var f=a.scale(c,g.end.length);f=a.rotate(f,g.end.angle);this.p3=a.add(this.p4,f);this.f1=function(h){return(h*h*h)};this.f2=function(h){return(3*h*h*(1-h))};this.f3=function(h){return(3*h*(1-h)*(1-h))};this.f4=function(h){return((1-h)*(1-h)*(1-h))};this.css=function(k){var i=this.f1(k),n=this.f2(k),l=this.f3(k),j=this.f4(k);var h=this.p1[0]*i+this.p2[0]*n+this.p3[0]*l+this.p4[0]*j;var m=this.p1[1]*i+this.p2[1]*n+this.p3[1]*l+this.p4[1]*j;return{top:m+"px",left:h+"px"}}};b.path.arc=function(d){for(var c in d){this[c]=d[c]}this.dir=this.dir||1;while(this.start>this.end&&this.dir>0){this.start-=360}while(this.start<this.end&&this.dir<0){this.start+=360}this.css=function(g){var f=this.start*(g)+this.end*(1-(g));f=f*3.1415927/180;var e=Math.sin(f)*this.radius+this.center[0];var h=Math.cos(f)*this.radius+this.center[1];return{top:h+"px",left:e+"px"}}};b.fx.step.path=function(e){var d=e.end.css(1-e.pos);for(var c in d){e.elem.style[c]=d[c]}}})(jQuery);
;
String.prototype.score=function(l,d){d=d||0;if(l.length==0){return 0.9}if(l.length>this.length){return 0}for(var g=l.length;g>0;g--){var n=l.substring(0,g);var h=this.indexOf(n);if(h<0){continue}if(h+l.length>this.length+d){continue}var m=this.substring(h+n.length);var f=null;if(g>=l.length){f=""}else{f=l.substring(g)}var e=m.score(f,d+h);if(e>0){var a=this.length-m.length;if(h!=0){var b=0;var k=this.charCodeAt(h-1);if(k==32||k==9){for(var b=(h-2);b>=0;b--){k=this.charCodeAt(b);a-=((k==32||k==9)?1:0.15)}}else{a-=h}}a+=e*m.length;a/=this.length;return a}}return 0};
;
jQuery.quickSilverFilter=function(a,f,b,c){var e=$j.trim(f.toLowerCase()),g=[];if(c==null){c=function(h){return h}}if(!e){return a}else{var d=[];jQuery(a).each(function(h,j){var k=c(j).score(e);if(k>0){g.push([k,h])}});jQuery.each(g.sort(function(i,h){return h[0]-i[0]}),function(){d.push(a[this[1]])});if(b!=null&&d.length>b){d=d.slice(0,b)}return d}};
;
jive.namespace("Navbar.Menu.Apps.Instances");jive.Navbar.Menu.Apps.Instances.ListView=jive.Navbar.Menu.AbstractListView.extend(function(a){var b=jQuery;this.render=function(i){var g=this;this.stripDomain(i);var h=b(jive.nav.menu.apps.instances.content({links:i,appsMarketEnabled:window.appsMarketEnabled}));this.$menu.html(h);this.repositionPopover();var j=new jive.AppMarketLaunch({appLaunchView:this});window.appsMarketLaunchPad=j;var e=function(k){window.location=jive.app.url({path:"/apps/market"})};b(this.$menu).find("#app-launch-market").unbind("click").click(e);b(this.$menu).find(".js-launch-app-market").unbind("click").click(e);jive.conc.nextTick(function(){c(i,b(g.$menu))});b(this.$menu).find("#app-launch-your-apps").unbind("click").click(function(k){window.location=jive.app.url({path:"/apps/market/yourApps"})});var f=this;jive.switchboard.addListener("at",function(l,k){f.animateInstall(l,k)})};this.showLaunchPad=function(){var e=this;e.$button.click()};this.toggleButton=function(f){var e=this;if(f>0){e.$button.show()}else{e.$button.hide()}};a.stripDomain=function(h){var g=document.createElement("a");g.href=_jive_base_absolute_url;var e=g.host;if(h&&h.length){for(var f=0;f<h.length;++f){h[f].url=d(h[f].url,e);h[f].iconSrc=d(h[f].iconSrc,e);h[f].largeIconSrc=d(h[f].largeIconSrc,e);h[f].favIconSrc=d(h[f].favIconSrc,e)}}};function d(f,e){var g=document.createElement("a");g.href=f;if(g.host==e&&f.indexOf(e)!==-1){f=f.substring(f.indexOf(e)+e.length)}return f}function c(k,g){var n=g.find("#js-quick-launch-search-string");if(!n.length){return}else{jive.conc.nextTick(function(){n[0].focus()})}var h=g.find("#j-quick-launch-apps");var m=[];var f={};var e=new Date().getTime();b.each(k,function(p,t){if(t.appUUID){var u="app-ql-"+t.appUUID;var s=t.title||t.displayTitle;var r=s.replace(/\W+/g," ").replace(/^ | $/,"").toLowerCase();var q={id:u,words:r,app:t};f[u]=p;m.push(q)}});var j=new Date().getTime();console.log("Built index of "+k.length+" apps in "+((j-e)/1000)+"s");var o="";var i=null;var l=function(){i=null;var p=n.val();if(p==o){return}var q,s;if(p){n.removeClass("font-color-meta");q=$j.quickSilverFilter(m,p,9,function(t){return t.words});console.log("Searching for '"+p+"'",q);s=b.map(q,function(t){return{found:t.words.split(/\s+/g).join(",")}});q=b.map(q,function(t){return t.app})}else{n.addClass("font-color-meta");q=k}o=p;var r=b(jive.nav.menu.apps.instances.appList({links:q,searchResults:s}));h.html(r)};n.unbind("keyup").keyup(function(){if(i!=null){window.clearTimeout(i)}i=window.setTimeout(l,333)})}});define("apps/navbar/menu/apps/instances/views/instance_list",function(){return jive.Navbar.Menu.Apps.Instances.ListView});
;
define("apps/shared/models/app_instance_source",["apps/shared/models/rest_service"],function(a){jive.AppInstanceSource=a.extend(function(b){b.init=function(c){this.resourceType="instance";this.pluralizedResourceType="instances";this.RESOURCE_ENDPOINT=jive.api.apps(this.pluralizedResourceType)}});return jive.AppDashboardSource});
;
jive.namespace("ReadTracking");define("apps/read_tracking/models/read_tracking_source",["apps/shared/models/rest_service"],function(a){jive.ReadTracking.ReadTrackingSource=a.extend(function(b,c){b.resourceType="readtracking";b.pluralizedResourceType=b.resourceType;this.save=function(e,h,g){var f=new jive.conc.Promise(),d="read";if(!g){d="unread"}$j.ajax({type:"POST",dataType:"json",url:this.RESOURCE_ENDPOINT+"/"+e+"/"+h+"/"+d,success:function(i){f.emitSuccess()}});return f};this.markAllRead=function(e){var d=this.RESOURCE_ENDPOINT+"/markallread";var e=e==null?"":e;return this.commonAjaxRequest(new jive.conc.Promise(),"POST",{url:d,data:JSON.stringify(e)})}});return jive.ReadTracking.ReadTrackingSource});
;
goog.provide("jive.eae.actions.markedContentItemInner");
jive.eae.actions.markedContentItemInner=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.item.jiveObjectViewBean.jiveObjectIconLink?soy.$$filterNoAutoescape(opt_data.item.jiveObjectViewBean.jiveObjectIconLink):'<span class="'+soy.$$escapeHtml(opt_data.item.jiveObjectViewBean.jiveObjectCSS)+'"></span>','<span class="j-item">',soy.$$filterNoAutoescape(opt_data.item.jiveObjectViewBean.subject),"</span>");return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.actions.markedContentItem");
jive.eae.actions.markedContentItem=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.renderLocation=="globalNav"){output.append('<div class="title font-color-link">');jive.eae.actions.markedContentItemInner(opt_data,output);output.append("</div>")}else{output.append('<a href="',soy.$$filterNoAutoescape(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.item.jiveObjectViewBean.jiveObjectURL)),'" class="title">');jive.eae.actions.markedContentItemInner(opt_data,
output);output.append("</a>")}return opt_sb?"":output.toString()};
;
goog.provide("jive.shared.displayutil.userDisplayName");jive.shared.displayutil.userDisplayName=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.displayName?!opt_data.anonymous?soy.$$escapeHtml(opt_data.displayName):'<em class="guest">'+soy.$$escapeHtml(opt_data.displayName)+"</em>":"");return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.actions.markedItemInnerText");
jive.eae.actions.markedItemInnerText=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.item.selfOwned){var commentStr__soy5=new soy.StringBuilder("eae.actionqueue.marked.",soy.$$escapeHtml(opt_data.type),".comment",soy.$$escapeHtml(opt_data.type=="active"?"."+opt_data.item.pendingType:""),".you");commentStr__soy5=commentStr__soy5.toString();var messageStr__soy11=new soy.StringBuilder("eae.actionqueue.marked.",soy.$$escapeHtml(opt_data.type),".reply",soy.$$escapeHtml(opt_data.type==
"active"?"."+opt_data.item.pendingType:""),".you");messageStr__soy11=messageStr__soy11.toString();var otherStr__soy17=new soy.StringBuilder("eae.actionqueue.marked.",soy.$$escapeHtml(opt_data.type),".tlo",soy.$$escapeHtml(opt_data.type=="active"?"."+opt_data.item.pendingType:""),".you");otherStr__soy17=otherStr__soy17.toString();var param31=new soy.StringBuilder;jive.eae.actions.markedContentItem(opt_data,param31);jive.shared.soy.i18nHelper({i18nKey:opt_data.item.jiveObjectViewBean.typeComment?soy.$$escapeHtml(jive.i18n.getMinKey(commentStr__soy5)):
opt_data.item.jiveObjectViewBean.typeMessage?soy.$$escapeHtml(jive.i18n.getMinKey(messageStr__soy11)):soy.$$escapeHtml(jive.i18n.getMinKey(otherStr__soy17)),arg0:param31.toString(),noAutoEscape:true},output)}else{var commentStr__soy38=new soy.StringBuilder("eae.actionqueue.marked.",soy.$$escapeHtml(opt_data.type),".comment",soy.$$escapeHtml(opt_data.type=="active"?"."+opt_data.item.pendingType:""));commentStr__soy38=commentStr__soy38.toString();var messageStr__soy43=new soy.StringBuilder("eae.actionqueue.marked.",
soy.$$escapeHtml(opt_data.type),".reply",soy.$$escapeHtml(opt_data.type=="active"?"."+opt_data.item.pendingType:""));messageStr__soy43=messageStr__soy43.toString();var otherStr__soy48=new soy.StringBuilder("eae.actionqueue.marked.",soy.$$escapeHtml(opt_data.type),".tlo",soy.$$escapeHtml(opt_data.type=="active"?"."+opt_data.item.pendingType:""));otherStr__soy48=otherStr__soy48.toString();var param61=new soy.StringBuilder;if(opt_data.renderLocation=="globalNav")jive.shared.displayutil.userDisplayName(opt_data.item.currentOutcomeOwner,
param61);else jive.shared.displayutil.userDisplayNameLink(opt_data.item.currentOutcomeOwner,param61);var param67=new soy.StringBuilder;jive.eae.actions.markedContentItem(opt_data,param67);jive.shared.soy.i18nHelper({i18nKey:opt_data.item.jiveObjectViewBean.typeComment?soy.$$escapeHtml(jive.i18n.getMinKey(commentStr__soy38)):opt_data.item.jiveObjectViewBean.typeMessage?soy.$$escapeHtml(jive.i18n.getMinKey(messageStr__soy43)):soy.$$escapeHtml(jive.i18n.getMinKey(otherStr__soy48)),arg0:param61.toString(),
arg1:param67.toString(),noAutoEscape:true},output)}return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.actions.markedItemBadgeContainer");
jive.eae.actions.markedItemBadgeContainer=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<ul id="js-outcome-badge-container-',soy.$$escapeHtml(opt_data.objectType),"-",soy.$$escapeHtml(opt_data.objectId),'" class="js-outcome-badge-container js-ed-',soy.$$escapeHtml(opt_data.objectType),"-",soy.$$escapeHtml(opt_data.objectId),' j-badge-action" data-object-type="',soy.$$escapeHtml(opt_data.objectType),'" data-object-id="',soy.$$escapeHtml(opt_data.objectId),'" data-allowed-outcome-types="',
soy.$$escapeHtml(["pending","resolved"]),'" data-no-hydrate="true" aria-label="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("outcomes.badgeContainer.ariaLabel"),[])),'" aria-live="polite"><li class="js-outcome-badge js-outcome-type-',soy.$$escapeHtml(opt_data.type),'" data-outcome="',soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/api/core/v3/outcomes/"+opt_data.item.outcomeId)),'" data-ed=\'{"type":',soy.$$escapeHtml(opt_data.objectType),', "id": ',soy.$$escapeHtml(opt_data.objectId),
"}' data-outcome-type=\"",soy.$$escapeHtml(opt_data.type),'"><a href="#" aria-haspopup="true">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("outcomes.badge.actionqueue."+opt_data.type)),[])),'<span class="jive-icon-med jive-icon-arrow-down"></span></a></li></ul>');return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.actions.markedItemInner");
jive.eae.actions.markedItemInner=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.renderLocation=="globalNav")jive.shared.displayutil.avatar(soy.$$augmentMap(opt_data.item.currentOutcomeOwner,{size:opt_data.renderLocation=="globalNav"?32:46,currentUserPartner:opt_data.item.currentOutcomeOwner.partner,hideLink:true}),output);else{output.append('<div class="j-act-avatar">');jive.shared.displayutil.avatar(soy.$$augmentMap(opt_data.item.currentOutcomeOwner,{size:46,currentUserPartner:opt_data.item.currentOutcomeOwner.partner}),
output);output.append("</div>")}if(opt_data.renderLocation=="globalNav"){output.append('<div class="font-color-meta">');jive.eae.actions.markedItemInnerText(opt_data,output);output.append("</div>")}else{output.append('<p class="font-color-meta">');jive.eae.actions.markedItemInnerText(opt_data,output);output.append("</p>")}output.append('<div class="j-act-meta"><strong>',soy.$$escapeHtml(opt_data.item.outcomeModificationDate),"</strong></div>");if(opt_data.renderLocation!="globalNav")jive.eae.actions.markedItemBadgeContainer({item:opt_data.item,
objectType:opt_data.item.jiveObjectViewBean.typeThread?1:opt_data.item.jiveObjectViewBean.objectType,objectId:opt_data.item.jiveObjectViewBean.typeThread?opt_data.item.jiveObjectViewBean.threadID:opt_data.item.jiveObjectViewBean.id,type:opt_data.type=="active"?"pending":"resolved"},output);return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.actions.markedItem");
jive.eae.actions.markedItem=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<li class="js-marked-item j-aq-data j-aq-marked-item j-markedActionItem" data-id="',soy.$$escapeHtml(opt_data.item.jiveObjectViewBean.typeThread?opt_data.item.jiveObjectViewBean.threadID:opt_data.item.jiveObjectViewBean.id),'" data-type="',soy.$$escapeHtml(opt_data.item.jiveObjectViewBean.typeThread?1:opt_data.item.jiveObjectViewBean.objectType),'" data-modification-date="',soy.$$escapeHtml(opt_data.item.outcomeModificationTimestamp),
'">');if(opt_data.renderLocation=="globalNav"){output.append('<a href="',soy.$$filterNoAutoescape(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.item.jiveObjectViewBean.jiveObjectURL)),'" class="j-aq-marked-entry font-color-normal clearfix">');jive.eae.actions.markedItemInner(opt_data,output);output.append("</a>")}else jive.eae.actions.markedItemInner(opt_data,output);output.append("</li>");return opt_sb?"":output.toString()};
;
goog.provide("jive.nav.menu.home.overdueTask");
jive.nav.menu.home.overdueTask=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<a href="',soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/actions/tasks")),'" class="j-aq-entry font-color-normal clearfix"><span class="jive-icon-big jive-icon-task acticon"></span><div class="title font-color-link">',soy.$$escapeHtml(opt_data.task.subject),'</div><div class="j-task-duedate font-color-danger">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("eae.task.dueDate.date"),[opt_data.task.dueDate])),
"</div></a>");return opt_sb?"":output.toString()};
;
goog.provide("jive.nav.menu.home.moderationItem");
jive.nav.menu.home.moderationItem=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<a href="',soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/moderation")),'" class="j-aq-entry font-color-normal clearfix"><span class="acticon">');jive.shared.displayutil.icon({type:opt_data.moderationItem.code,size:"med"},output);output.append('</span><div class="title font-color-link">',opt_data.moderationItem.code=="userregistration"?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("mod.userregistration.subj.text"),
[]))+" "+soy.$$escapeHtml(opt_data.moderationItem.user.displayName):opt_data.moderationItem.code=="profileimage"?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("mod.profileimage.subj.text"),[]))+' <span class="font-color-meta">by</span> '+soy.$$escapeHtml(opt_data.moderationItem.user.displayName):soy.$$escapeHtml(opt_data.moderationItem.displayName)+' <span class="font-color-meta">by</span> '+soy.$$escapeHtml(opt_data.moderationItem.user.displayName),'</div><div class="j-td-date font-color-meta">',
soy.$$escapeHtml(opt_data.moderationItem.creationDate),"</div></a>");return opt_sb?"":output.toString()};
;
goog.provide("jive.nav.menu.home.content");
jive.nav.menu.home.content=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-nav-menu-scrollable js-nav-menu-scrollable j-globalNav-notification">');if(opt_data.data.inboxItems.activityContainerList.length){jive.nav.menu.home.inbox({unreadCount:opt_data.counts["inbox"]},output);output.append('<ul id="j-home-nav-menu-inbox-list" class="j-badge-menu-list"></ul>')}if(opt_data.data.actionItems.outcomeList.length){output.append('<h4 class="j-badge-hd"><a href="',soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,
"/actions/marked")),'" title="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("eae.header.text.actionitems"),[])),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("eae.header.text.actionitems"),[])),'</a><strong class="j-menu-count font-color-notify">');jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("nav.bar.home.menu.active"),arg0:opt_data.counts["actions"]>50?"50+":soy.$$escapeHtml(opt_data.counts["actions"]),noAutoEscape:true},output);output.append('</strong></h4><ul id="j-home-nav-menu-tasks-list" class="j-badge-menu-list">');
var itemList29=opt_data.data.actionItems.outcomeList;var itemListLen29=itemList29.length;for(var itemIndex29=0;itemIndex29<itemListLen29;itemIndex29++){var itemData29=itemList29[itemIndex29];if(itemIndex29<5)jive.eae.actions.markedItem({item:itemData29,type:"active",renderLocation:"globalNav"},output)}output.append("</ul>")}if(opt_data.data.taskItems.taskList.length){output.append('<h4 class="j-badge-hd"><a href="',soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/actions/tasks")),
'" title="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("eae.header.text.overduetasks"),[])),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("eae.header.text.overduetasks"),[])),'</a><strong class="j-menu-count font-color-notify">');jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("nav.bar.home.menu.overdue"),arg0:opt_data.counts["tasks"]>50?"50+":soy.$$escapeHtml(opt_data.counts["tasks"]),noAutoEscape:true},output);output.append('</strong></h4><ul id="j-home-nav-menu-tasks-list" class="j-badge-menu-list">');
var taskList58=opt_data.data.taskItems.taskList;var taskListLen58=taskList58.length;for(var taskIndex58=0;taskIndex58<taskListLen58;taskIndex58++){var taskData58=taskList58[taskIndex58];if(taskIndex58<5){output.append("<li>");jive.nav.menu.home.overdueTask({task:taskData58},output);output.append("</li>")}}output.append("</ul>")}if(opt_data.data.moderationItems.moderationList.length){output.append('<h4 class="j-badge-hd"><a href="',soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,
"/moderation")),'" title="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("eae.header.text.moderation"),[])),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("nav.bar.moderation.link"),[])),'</a><strong class="j-menu-count font-color-notify">');jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("nav.bar.home.menu.new"),arg0:opt_data.counts["moderations"]>50?"50+":soy.$$escapeHtml(opt_data.counts["moderations"]),noAutoEscape:true},output);output.append('</strong></h4><ul id="j-home-nav-menu-moderation-list" class="j-badge-menu-list">');
var moderationItemList87=opt_data.data.moderationItems.moderationList;var moderationItemListLen87=moderationItemList87.length;for(var moderationItemIndex87=0;moderationItemIndex87<moderationItemListLen87;moderationItemIndex87++){var moderationItemData87=moderationItemList87[moderationItemIndex87];if(5>moderationItemIndex87){output.append("<li>");jive.nav.menu.home.moderationItem({moderationItem:moderationItemData87},output);output.append("</li>")}}output.append("<ul>")}output.append("</div>");return opt_sb?
"":output.toString()};
;
goog.provide("jive.nav.menu.home.main");jive.nav.menu.home.main=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div id="j-home-global-nav-menu" class="j-quick-menu j-badge-menu j-act">');if(opt_data.data)jive.nav.menu.home.content(opt_data,output);output.append("</div>");return opt_sb?"":output.toString()};
;
goog.provide("home.nav.drop.down.containerStart");
home.nav.drop.down.containerStart=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<li><a href="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/inbox?objectType="+opt_data.activityContainer.jiveObject.objectType+"&objectID="+opt_data.activityContainer.jiveObject.id))),'" id="homeNavCommItem_',opt_data.activityContainer.jiveObject.objectType,"_",opt_data.activityContainer.jiveObject.id,'" class="j-comm-entry j-js-ibx-item j-act-unread font-color-normal clearfix">');
return opt_sb?"":output.toString()};
;
goog.provide("home.nav.drop.down.containerEnd");home.nav.drop.down.containerEnd=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("</a></li>");return opt_sb?"":output.toString()};
;
goog.provide("home.nav.drop.down.announcement");
home.nav.drop.down.announcement=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.activityContainer.activityList.length>0){home.nav.drop.down.containerStart(opt_data,output);output.append('<div class="j-badge-oneliner"><span title=\'',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("global.announcement"),[])),'\' role=\'img\' class="jive-icon-big jive-icon-announcement acticon"></span><span class="jive-alert-announcement-label">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("anncmt.announcement.gtitle.colon"),
[])),'</span> <span class="title">',soy.$$filterNoAutoescape(opt_data.activityContainer.jiveObject.subject),"</span></div>");home.nav.drop.down.containerEnd(null,output)}return opt_sb?"":output.toString()};
;
goog.provide("jive.shared.displayutil.renderGuestDisplayName");
jive.shared.displayutil.renderGuestDisplayName=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.message.displayName?soy.$$escapeHtml(opt_data.message.displayName):opt_data.message.username?soy.$$escapeHtml(opt_data.message.username):opt_data.message.userEmail?soy.$$escapeHtml(opt_data.message.userEmail):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.guest"),[])));return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.activitystream.item.activity_verb.defaults.deleted");
jive.eae.activitystream.item.activity_verb.defaults.deleted=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<span class="font-color-meta j-act-deleted">',opt_data.object.deletedType&&opt_data.object.deletedType=="mentioned"?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("eae.user.deleted.mention"),[]))+" ":opt_data.type==2?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("eae.user.deleted.reply"),[]))+" ":opt_data.type==801?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("eae.user.deleted.bookmark"),
[]))+" ":soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("eae.user.deleted.comment"),[]))+" ","</span>");return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.activitystream.item.activity_verb.discussion.main");
jive.eae.activitystream.item.activity_verb.discussion.main=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.type=="created"?opt_data.object.hasQuestion?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("activity.type.asked"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("activity.type.starteddiscussion"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("activity.type."+opt_data.type),[true])));return opt_sb?"":output.toString()};
;
goog.provide("jive.shared.soy.escapeHelper");jive.shared.soy.escapeHelper=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.escape?soy.$$escapeHtml(opt_data.stringToEscape):soy.$$filterNoAutoescape(opt_data.stringToEscape));return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.activitystream.item.activity_verb.comment.main");
jive.eae.activitystream.item.activity_verb.comment.main=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.object.typeWallEntryComment){var param7=new soy.StringBuilder;var param8=new soy.StringBuilder;if(opt_data.displayAuthorLink)jive.shared.displayutil.userDisplayNameLink(opt_data.object.parentAuthor,param8);else param8.append(soy.$$escapeHtml(opt_data.object.parentAuthor.displayName));jive.shared.soy.escapeHelper({stringToEscape:param8.toString()},param7);jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("activity.type.wallentrycomment"),
arg0:param7.toString(),noAutoEscape:true},output)}else if(!opt_data.hideDetailedReplyTo){var param26=new soy.StringBuilder;var param27=new soy.StringBuilder;if(opt_data.displayAuthorLink)jive.shared.displayutil.userDisplayNameLink(opt_data.object.parentAuthor,param27);else param27.append(soy.$$escapeHtml(opt_data.object.parentAuthor.displayName));jive.shared.soy.escapeHelper({stringToEscape:param27.toString()},param26);jive.shared.soy.i18nHelper({i18nKey:opt_data.object.commentContentResource&&opt_data.object.commentContentResource.objectType==
129?soy.$$escapeHtml("activity.type.authorcommentedinresponseto"):opt_data.object.typeMessage?soy.$$escapeHtml("activity.type.repliedinresponseto"):soy.$$escapeHtml("activity.type.commentedinresponseto"),arg0:param26.toString(),noAutoEscape:true},output);output.append(opt_data.againstObject?" "+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("activity_stream.on_object"),[]))+" ":"")}return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.activitystream.item.activity_verb.discussion.reply");
jive.eae.activitystream.item.activity_verb.discussion.reply=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.type=="correct_answer_set"){var param7=new soy.StringBuilder;var param8=new soy.StringBuilder;if(opt_data.displayAuthorLink)jive.shared.displayutil.userDisplayNameLink(opt_data.object.user,param8);else param8.append(soy.$$escapeHtml(opt_data.object.user.displayName));jive.shared.soy.escapeHelper({stringToEscape:param8.toString()},param7);jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("activity.type.replymarkedcorrect"),
arg0:param7.toString(),noAutoEscape:true},output)}else if(!opt_data.againstObject)output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("activity.type.replied"),[]))," ");else output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("activity.type.replied.to"),[]))," ");return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.activitystream.item.activity_verb.outcome.comment");
jive.eae.activitystream.item.activity_verb.outcome.comment=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;var outcomeStr__soy3=new soy.StringBuilder("activity.type.outcome.",soy.$$escapeHtml(opt_data.object.outcomeTypeName),soy.$$escapeHtml(opt_data.object.outcomeTypeName=="pending"?"."+opt_data.object.pendingType:""));outcomeStr__soy3=outcomeStr__soy3.toString();var param9=new soy.StringBuilder;var param10=new soy.StringBuilder;if(opt_data.displayAuthorLink)jive.shared.displayutil.userDisplayNameLink(opt_data.object.targetObject.user,
param10);else param10.append(soy.$$escapeHtml(opt_data.object.targetObject.user.displayName));jive.shared.soy.escapeHelper({stringToEscape:param10.toString()},param9);jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml(jive.i18n.getMinKey(outcomeStr__soy3)),arg0:param9.toString(),arg1:opt_data.object.targetObject.typeMessage?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("eae.liking.message"),[])):opt_data.object.targetObject.typeComment?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("eae.liking.comment"),
[])):"",noAutoEscape:true},output);return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.activitystream.item.activity_verb.outcome.main");
jive.eae.activitystream.item.activity_verb.outcome.main=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;var outcomeStr__soy3=new soy.StringBuilder("activity.type.outcome.",soy.$$escapeHtml(opt_data.object.outcomeTypeName),".tlo",soy.$$escapeHtml(opt_data.object.outcomeTypeName=="pending"?"."+opt_data.object.pendingType:""));outcomeStr__soy3=outcomeStr__soy3.toString();output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey(outcomeStr__soy3)),[])));
return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.activitystream.item.activity_verb.share.main");
jive.eae.activitystream.item.activity_verb.share.main=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.object.commentContentResource&&opt_data.object.commentContentResource.objectType==129?!opt_data.againstObject?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("activity.type.authorcomment"),[]))+" ":soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("activity.type.authorcommentto"),[]))+" ":!opt_data.againstObject?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("activity.type.commented"),
[]))+" ":soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("activity.type.commentedon"),[]))+" ");return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.activitystream.item.activity_verb.we.main");
jive.eae.activitystream.item.activity_verb.we.main=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.type=="liked")output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("activity.type.liked"),[])));else if(opt_data.type=="repost"){var param13=new soy.StringBuilder;var param14=new soy.StringBuilder;jive.shared.displayutil.userDisplayNameLink(opt_data.object.repostedUser,param14);jive.shared.soy.escapeHelper({stringToEscape:param14.toString()},param13);jive.shared.soy.i18nHelper({i18nKey:opt_data.user&&
opt_data.object.repostedUser.id==opt_data.user.id?soy.$$escapeHtml("activity.type.status.repost.your"):soy.$$escapeHtml("activity.type.status.repost"),arg0:param13.toString(),noAutoEscape:true},output)}else if(opt_data.object.wallCreationSrc!="")jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("activity.type.status.with.source"),arg0:soy.$$filterNoAutoescape(opt_data.object.wallCreationSrc),noAutoEscape:true},output);else output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("activity.type.status"),
[])));return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.activitystream.item.activity_verb.project.main");jive.eae.activitystream.item.activity_verb.project.main=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("activity.type.updatedStatus"),[])));return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.activitystream.item.activity_verb.relationship.main");
jive.eae.activitystream.item.activity_verb.relationship.main=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;var param5=new soy.StringBuilder;var param6=new soy.StringBuilder;jive.shared.displayutil.avatar(soy.$$augmentMap(opt_data.object.relatedUser,{size:32,currentUserPartner:opt_data.user.partner}),param6);jive.shared.displayutil.userDisplayNameLink(opt_data.object.relatedUser,param6);jive.shared.soy.escapeHelper({stringToEscape:param6.toString()},param5);jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml(jive.i18n.getMinKey("activity.type."+
opt_data.type)),arg0:param5.toString(),noAutoEscape:true},output);return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.activitystream.item.activity_verb.tile_activity.external");jive.eae.activitystream.item.activity_verb.tile_activity.external=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$filterNoAutoescape(opt_data.object.text)," ");return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.activitystream.item.activity_verb.tile_activity.tile");jive.eae.activitystream.item.activity_verb.tile_activity.tile=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("activity.type.tileStreamEntry"),[])));return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.activitystream.item.activity_verb.rtc.main");jive.eae.activitystream.item.activity_verb.rtc.main=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.user&&opt_data.object.user.id==opt_data.user.id?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("activity.type.directmessage.you.sent"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("activity.type.directmessage"),[])));return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.activitystream.item.activity_verb.bookmarked.main");jive.eae.activitystream.item.activity_verb.bookmarked.main=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("activity.type.bookmarked"),[])));return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.activitystream.item.activity_verb.defaults.main");jive.eae.activitystream.item.activity_verb.defaults.main=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("activity.type."+opt_data.type)),[])));return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.activitystream.include.activityVerbPhrase");
jive.eae.activitystream.include.activityVerbPhrase=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.object.deleted)jive.eae.activitystream.item.activity_verb.defaults.deleted(opt_data,output);else if(opt_data.object.typeThread)jive.eae.activitystream.item.activity_verb.discussion.main(opt_data,output);else if(opt_data.object.parentAuthor&&(!opt_data.hideDetailedReplyTo||opt_data.object.typeWallEntryComment))jive.eae.activitystream.item.activity_verb.comment.main(opt_data,output);
else if(opt_data.object.typeMessage||opt_data.type=="correct_answer_set")jive.eae.activitystream.item.activity_verb.discussion.reply(opt_data,output);else if(opt_data.object.typeOutcome)if(opt_data.object.targetObject.typeMessage||opt_data.object.targetObject.typeComment)jive.eae.activitystream.item.activity_verb.outcome.comment(opt_data,output);else jive.eae.activitystream.item.activity_verb.outcome.main(opt_data,output);else if(opt_data.object.typeComment||opt_data.type=="share")jive.eae.activitystream.item.activity_verb.share.main(opt_data,
output);else if(opt_data.object.typePoll&&opt_data.type=="created")output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("activity.type.startedpoll"),[])));else if(opt_data.object.typeBlogPost&&opt_data.type=="created")output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("activity.type.wrote"),[])));else if(opt_data.object.typeDocument&&opt_data.type=="created"&&opt_data.object.binary)output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("activity.type.uploaded"),
[])));else if(opt_data.object.typeDocument&&opt_data.type=="created")output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("activity.type.wrote"),[])));else if(opt_data.object.typeWallEntry||opt_data.object.typeUserStatus)jive.eae.activitystream.item.activity_verb.we.main(opt_data,output);else if(opt_data.object.typeProjectStatus)jive.eae.activitystream.item.activity_verb.project.main(opt_data,output);else if(opt_data.object.typeUserRelationship&&opt_data.user)jive.eae.activitystream.item.activity_verb.relationship.main(opt_data,
output);else if(opt_data.object.typeExternalActivity)jive.eae.activitystream.item.activity_verb.tile_activity.external(opt_data,output);else if(opt_data.object.typeTileStreamEntry)jive.eae.activitystream.item.activity_verb.tile_activity.tile(opt_data,output);else if(opt_data.object.typeCollaboration)jive.eae.activitystream.item.activity_verb.rtc.main(opt_data,output);else if(opt_data.object.bookmarkedContent)jive.eae.activitystream.item.activity_verb.bookmarked.main(opt_data,output);else if(opt_data.type!=
"")jive.eae.activitystream.item.activity_verb.defaults.main(opt_data,output);return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.common.activityAuthor");
jive.eae.common.activityAuthor=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(!opt_data.activityUser.anonymous)if(opt_data.displayAuthorLink)jive.shared.displayutil.userDisplayNameLink(soy.$$augmentMap(opt_data.activityUser,{renderInvisible:opt_data.object.typeExternalActivity}),output);else if(opt_data.deleted);else output.append(soy.$$escapeHtml(opt_data.activityUser.displayName));else jive.shared.displayutil.renderGuestDisplayName({message:opt_data.activityUser},output);
if(!opt_data.object.typeShare){output.append(" ");jive.eae.activitystream.include.activityVerbPhrase(opt_data,output)}else output.append(" ",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("activity.type.shared"),[]))," ");return opt_sb?"":output.toString()};
;
goog.provide("jive.shared.displayutil.renderIconElementAttrs");
jive.shared.displayutil.renderIconElementAttrs=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;var nameList3=opt_data.attributeNames;var nameListLen3=nameList3.length;for(var nameIndex3=0;nameIndex3<nameListLen3;nameIndex3++){var nameData3=nameList3[nameIndex3];output.append(soy.$$escapeHtml(nameData3),'="',soy.$$escapeHtml(opt_data.attributes[nameData3]),opt_data.extraAttributes?" "+soy.$$escapeHtml(opt_data.extraAttributes):"",'" ')}return opt_sb?"":output.toString()};
;
goog.provide("jive.shared.displayutil.renderIconElement");
jive.shared.displayutil.renderIconElement=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;switch(opt_data.icon.tag){case "img":output.append("<img ");jive.shared.displayutil.renderIconElementAttrs(opt_data.icon,output);output.append("/>");break;case "span":output.append("<span ");jive.shared.displayutil.renderIconElementAttrs({attributeNames:opt_data.icon.attributeNames,attributes:opt_data.icon.attributes,extraAttributes:opt_data.extraAttributes},output);output.append("></span>");
break;case "div":output.append("<div ");jive.shared.displayutil.renderIconElementAttrs(opt_data.icon,output);output.append("></div>");break}return opt_sb?"":output.toString()};
;
goog.provide("home.nav.drop.down.app");
home.nav.drop.down.app=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.activityContainer.activityList.length>0){var activity__soy5=opt_data.activityContainer.activityList[opt_data.activityContainer.activityList.length-1];output.append('<li><a href="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/inbox?objectType="+opt_data.activityContainer.jiveObject.objectType+"&objectID="+opt_data.activityContainer.jiveObject.id))),
'" ',opt_data.activityContainer.jiveObject.extraData&&opt_data.activityContainer.jiveObject.extraData.appID?'id="homeNavCommItem_'+opt_data.activityContainer.jiveObject.objectType+"_"+opt_data.activityContainer.jiveObject.id+"_1400_"+soy.$$escapeHtmlAttribute(opt_data.activityContainer.jiveObject.extraData.appID)+'"':'id="homeNavCommItem_'+opt_data.activityContainer.jiveObject.objectType+"_"+opt_data.activityContainer.jiveObject.id+"_"+soy.$$escapeHtmlAttribute(opt_data.activityContainer.container.type)+
"_"+soy.$$escapeHtmlAttribute(opt_data.activityContainer.container.id)+'"',' class="j-comm-entry j-js-ibx-item j-act-unread',opt_data.activityContainer.lastMentionTime!="0"?" j-mentioned":"",' font-color-normal clearfix">');if(!activity__soy5.content.deleted)jive.shared.displayutil.avatar(soy.$$augmentMap(activity__soy5.activityUser,{size:32,hideLink:true,anonymous:activity__soy5.activityUser.anonymous,currentUserPartner:opt_data.user.partner}),output);if(activity__soy5.content&&activity__soy5.content.verb==
"uri:jiveName:app_install")output.append('<div class="font-color-meta">',soy.$$escapeHtml(activity__soy5.activityUser.displayName)," ",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("activity.type.installed"),[]))," ",soy.$$escapeHtml(opt_data.activityContainer.parentTime),"</div>");else{output.append('<div class="font-color-meta">');if(activity__soy5.content.verb=="post")output.append(soy.$$escapeHtml(activity__soy5.content.plainSubjectSnippet)," ",soy.$$escapeHtml(opt_data.activityContainer.parentTime));
else{jive.eae.common.activityAuthor({object:activity__soy5.content,type:activity__soy5.content.deleted?opt_data.activityContainer.jiveObject.objectType:activity__soy5.type,activityUser:activity__soy5.activityUser,displayAuthorLink:false,streamType:"communications",hideDetailedReplyTo:true,user:opt_data.user,againstObject:true,deleted:activity__soy5.content.deleted},output);output.append(" ",soy.$$escapeHtml(opt_data.activityContainer.parentTime))}output.append("</div>")}output.append('<div class="title font-color-link">');
if(opt_data.activityContainer.jiveObject.activityIcon)jive.shared.displayutil.renderIconElement({icon:opt_data.activityContainer.jiveObject.activityIcon},output);else output.append('<span class="',soy.$$escapeHtmlAttribute(opt_data.activityContainer.jiveObject.jiveObjectCSS),'"></span>');output.append(opt_data.activityContainer.jiveObject.subjectIsHtml?soy.$$filterNoAutoescape(opt_data.activityContainer.jiveObject.htmlSubject):soy.$$filterNoAutoescape(opt_data.activityContainer.jiveObject.subject),
"</div></a></li>")}return opt_sb?"":output.toString()};
;
goog.provide("home.nav.drop.down.bookmark");
home.nav.drop.down.bookmark=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.activityContainer.activityList.length>0){home.nav.drop.down.containerStart(opt_data,output);var activity__soy6=opt_data.activityContainer.activityList[opt_data.activityContainer.activityList.length-1];if(!activity__soy6.content.deleted)jive.shared.displayutil.avatar(soy.$$augmentMap(activity__soy6.activityUser,{size:32,hideLink:true,anonymous:activity__soy6.activityUser.anonymous,currentUserPartner:opt_data.user.partner}),
output);output.append('<div class="font-color-meta">');jive.eae.common.activityAuthor({object:activity__soy6.content,type:activity__soy6.type,activityUser:activity__soy6.activityUser,displayAuthorLink:false,streamType:"communications",hideDetailedReplyTo:true,user:opt_data.user,againstObject:true,deleted:activity__soy6.content.deleted},output);output.append(" ",soy.$$escapeHtml(opt_data.activityContainer.parentTime),'</div><div class="title font-color-link"><span title=\'',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("global.bookmark"),
[])),"' role='img' class=\"",soy.$$escapeHtmlAttribute(opt_data.activityContainer.jiveObject.jiveObjectCSS),'"></span>',soy.$$filterNoAutoescape(opt_data.activityContainer.jiveObject.subject),"</div>");home.nav.drop.down.containerEnd(null,output)}return opt_sb?"":output.toString()};
;
goog.provide("home.nav.drop.down.collaboratorNotification");
home.nav.drop.down.collaboratorNotification=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.activityContainer.activityList.length>0){home.nav.drop.down.containerStart(opt_data,output);jive.shared.displayutil.avatar(soy.$$augmentMap(opt_data.activityContainer.activityList[0].activityUser,{size:32,hideLink:true,hideTooltip:true}),output);output.append('<div class="font-color-meta">');jive.shared.displayutil.userDisplayName(opt_data.activityContainer.activityList[0].activityUser,output);
output.append(" ",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("activity.type.collabAdded"),[])),'</div><div class="title font-color-link"><span class="',soy.$$escapeHtml(opt_data.activityContainer.activityList[0].content.templateData.objData.iconCSS),'"></span>',soy.$$escapeHtml(opt_data.activityContainer.activityList[0].content.templateData.objData.displayName),"</div>");home.nav.drop.down.containerEnd(null,output)}return opt_sb?"":output.toString()};
;
goog.provide("home.nav.drop.down.discussion");
home.nav.drop.down.discussion=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.activityContainer.activityList.length>0){home.nav.drop.down.containerStart(opt_data,output);var activity__soy6=opt_data.activityContainer.activityList[opt_data.activityContainer.activityList.length-1];if(!activity__soy6.content.deleted)jive.shared.displayutil.avatar(soy.$$augmentMap(activity__soy6.activityUser,{size:32,hideLink:true,anonymous:activity__soy6.activityUser.anonymous,currentUserPartner:opt_data.user.partner}),
output);output.append('<div class="font-color-meta">');jive.eae.common.activityAuthor({object:activity__soy6.content,type:activity__soy6.content.deleted?opt_data.activityContainer.jiveObject.objectType:activity__soy6.type,activityUser:activity__soy6.activityUser,displayAuthorLink:false,streamType:"communications",hideDetailedReplyTo:true,user:opt_data.user,againstObject:true,deleted:activity__soy6.content.deleted},output);output.append(" ",activity__soy6.type!="notification"?soy.$$escapeHtml(opt_data.activityContainer.parentTime):
"",'</div><div class="title font-color-link"><span title=\'',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("global.discussion"),[])),"' role='img' class=\"",soy.$$escapeHtmlAttribute(opt_data.activityContainer.jiveObject.jiveObjectCSS),'"></span>',soy.$$filterNoAutoescape(opt_data.activityContainer.jiveObject.subject),"</div>");home.nav.drop.down.containerEnd(null,output)}return opt_sb?"":output.toString()};
;
goog.provide("home.nav.drop.down.document");
home.nav.drop.down.document=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.activityContainer.activityList.length>0){var activity__soy5=opt_data.activityContainer.activityList[opt_data.activityContainer.activityList.length-1];output.append("<li><a ",opt_data.activityContainer.activityList[0]&&opt_data.activityContainer.activityList[0].content.commentContentResource&&opt_data.activityContainer.activityList[0].content.commentContentResource.objectType==129?'href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,
"/inbox?objectType=129&objectID="+opt_data.activityContainer.jiveObject.id)))+'" ':'href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/inbox?objectType="+opt_data.activityContainer.jiveObject.objectType+"&objectID="+opt_data.activityContainer.jiveObject.id)))+'" ','id="homeNavCommItem_',opt_data.activityContainer.activityList[0]&&opt_data.activityContainer.activityList[0].content.commentContentResource&&opt_data.activityContainer.activityList[0].content.commentContentResource.objectType==
129?"129":opt_data.activityContainer.jiveObject.objectType,"_",opt_data.activityContainer.jiveObject.id,'" class="j-comm-entry j-js-ibx-item j-act-unread font-color-normal">');if(!activity__soy5.content.deleted)jive.shared.displayutil.avatar(soy.$$augmentMap(activity__soy5.activityUser,{size:32,hideLink:true,anonymous:activity__soy5.activityUser.anonymous,currentUserPartner:opt_data.user.partner}),output);output.append('<div class="font-color-meta">');jive.eae.common.activityAuthor({object:activity__soy5.content,
type:activity__soy5.content.deleted?opt_data.activityContainer.jiveObject.objectType:activity__soy5.type,activityUser:activity__soy5.activityUser,displayAuthorLink:false,streamType:"communications",hideDetailedReplyTo:true,user:opt_data.user,againstObject:true,deleted:activity__soy5.content.deleted},output);output.append(" ",activity__soy5.type!="notification"?soy.$$escapeHtml(opt_data.activityContainer.parentTime):"",'</div><div class="title font-color-link"><span title=\'',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("global.document"),
[])),"' role='img' class=\"",soy.$$escapeHtmlAttribute(opt_data.activityContainer.jiveObject.jiveObjectCSS),'"></span>',soy.$$filterNoAutoescape(opt_data.activityContainer.jiveObject.subject),"</div></a></li>")}return opt_sb?"":output.toString()};
;
goog.provide("home.nav.drop.down.event");
home.nav.drop.down.event=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.activityContainer.activityList.length>0){home.nav.drop.down.containerStart(opt_data,output);var activity__soy6=opt_data.activityContainer.activityList[opt_data.activityContainer.activityList.length-1];if(!activity__soy6.content.deleted)jive.shared.displayutil.avatar(soy.$$augmentMap(activity__soy6.activityUser,{size:32,hideLink:true,anonymous:activity__soy6.activityUser.anonymous,currentUserPartner:opt_data.user.partner}),
output);output.append('<div class="font-color-meta">');jive.eae.common.activityAuthor({object:activity__soy6.content,type:activity__soy6.content.deleted?opt_data.activityContainer.jiveObject.objectType:activity__soy6.type,activityUser:activity__soy6.activityUser,displayAuthorLink:false,streamType:"communications",hideDetailedReplyTo:true,user:opt_data.user,againstObject:true,deleted:activity__soy6.content.deleted},output);output.append(" ",activity__soy6.type!="notification"?soy.$$escapeHtml(opt_data.activityContainer.parentTime):
"",'</div><div class="title font-color-link"><span class="',soy.$$escapeHtmlAttribute(opt_data.activityContainer.jiveObject.jiveObjectCSS),'"></span>',soy.$$filterNoAutoescape(opt_data.activityContainer.jiveObject.subject),"</div>");home.nav.drop.down.containerEnd(null,output)}return opt_sb?"":output.toString()};
;
goog.provide("home.nav.drop.down.generic");
home.nav.drop.down.generic=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.objDescriptor)jive.shared.soy.render({templateName:"home.nav.drop.down."+opt_data.objDescriptor,data:function(){var map={};var pairs=[["activityContainer",opt_data.activityContainer],["user",opt_data.user]];for(var i=0;i<pairs.length;i+=1)map[pairs[i][0]]=pairs[i][1];return map}(),failGracefully:true},output);else if(opt_data.activityContainer.activityList.length>0){home.nav.drop.down.containerStart(opt_data,
output);var activity__soy13=opt_data.activityContainer.activityList[opt_data.activityContainer.activityList.length-1];if(!activity__soy13.content.deleted)jive.shared.displayutil.avatar(soy.$$augmentMap(activity__soy13.activityUser,{size:32,hideLink:true,anonymous:activity__soy13.activityUser.anonymous,currentUserPartner:opt_data.user.partner}),output);output.append('<div class="font-color-meta">');jive.eae.common.activityAuthor({object:activity__soy13.content,type:activity__soy13.content.deleted?
opt_data.activityContainer.jiveObject.objectType:activity__soy13.type,activityUser:activity__soy13.activityUser,displayAuthorLink:false,streamType:"communications",hideDetailedReplyTo:true,user:opt_data.user,againstObject:true,deleted:activity__soy13.content.deleted},output);output.append(" ",soy.$$escapeHtml(opt_data.activityContainer.parentTime),'</div><div class="title font-color-link">');if(opt_data.activityContainer.jiveObject.activityIcon)jive.shared.displayutil.renderIconElement({icon:opt_data.activityContainer.jiveObject.activityIcon},
output);else output.append('<span class="',soy.$$escapeHtmlAttribute(opt_data.activityContainer.jiveObject.jiveObjectCSS),'"></span>');output.append(opt_data.activityContainer.jiveObject.subjectIsHtml?soy.$$filterNoAutoescape(opt_data.activityContainer.jiveObject.htmlSubject):soy.$$filterNoAutoescape(opt_data.activityContainer.jiveObject.subject),"</div>");home.nav.drop.down.containerEnd(null,output)}return opt_sb?"":output.toString()};
;
goog.provide("home.nav.drop.down.latestAcclaim");
home.nav.drop.down.latestAcclaim=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.activityContainer.activityList.length>0){home.nav.drop.down.containerStart(opt_data,output);output.append('<div class="j-badge-oneliner title font-color-link"><span title=\'',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("global.access.content.type."+opt_data.activityContainer.jiveObject.objectType)),[])),"' role='img' class=\"jive-icon-big jive-icon-acclaim acticon\"></span><span>",
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("eae.acclaim.group.header.colon"),[]))," </span>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("eae.acclaim.group.subhead"),[])),"</div>");home.nav.drop.down.containerEnd(null,output)}return opt_sb?"":output.toString()};
;
goog.provide("home.nav.drop.down.mention");
home.nav.drop.down.mention=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.activityContainer.activityList.length>0){home.nav.drop.down.containerStart(opt_data,output);var activity__soy6=opt_data.activityContainer.activityList[opt_data.activityContainer.activityList.length-1];var mentionActivity__soy7=new soy.StringBuilder('<div class="title font-color-link"><span title=\'',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.mention"),[])),"' role='img' class=\"",
soy.$$escapeHtml(activity__soy6.content.context.jiveObjectCSS),'"></span>',soy.$$filterNoAutoescape(activity__soy6.content.context.name),"</div>");mentionActivity__soy7=mentionActivity__soy7.toString();jive.shared.displayutil.avatar(soy.$$augmentMap(activity__soy6.activityUser,{size:32,hideLink:true,currentUserPartner:opt_data.user.partner}),output);if(activity__soy6.content.mentionedObject.objectType==3){output.append('<div class="font-color-meta">');var param25=new soy.StringBuilder;jive.shared.displayutil.userDisplayName(activity__soy6.activityUser,
param25);jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("eae.mention.at.you.in"),arg0:param25.toString(),arg1:mentionActivity__soy7,noAutoEscape:true},output);output.append("</div>")}else{output.append(opt_data.activityContainer.jiveObject.typeDirectMessage?'<span class="jive-icon-glyph icon-direct-message-label" title="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("eae.direct_message.label"),[]))+'"></span>':opt_data.activityContainer.jiveObject.typeShare?'<span class="jive-icon-glyph icon-share-label" title="'+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.label"),[]))+'"></span>':"",'<div class="font-color-meta">');var mentionKey__soy42=new soy.StringBuilder(activity__soy6.content.mentionedObject.objectType==4||activity__soy6.content.mentionedObject.objectType==14?"eae.mention.at.item.in.place":"eae.mention.at.item.in.content");mentionKey__soy42=mentionKey__soy42.toString();var param50=new soy.StringBuilder;jive.shared.displayutil.userDisplayName(activity__soy6.activityUser,param50);jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml(jive.i18n.getMinKey(mentionKey__soy42)),
arg0:param50.toString(),arg1:soy.$$escapeHtml(activity__soy6.content.mentionedObject.name),arg2:mentionActivity__soy7,noAutoEscape:true},output);output.append("</div>")}home.nav.drop.down.containerEnd(null,output)}return opt_sb?"":output.toString()};
;
goog.provide("home.nav.drop.down.notifications");
home.nav.drop.down.notifications=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;home.nav.drop.down.containerStart(opt_data,output);output.append('<div class="j-badge-oneliner title font-color-link"><span title="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg(opt_data.activityContainer.jiveObject.name),[])),'" role="img" class="jive-icon-big ',soy.$$escapeHtmlAttribute(opt_data.activityContainer.jiveObject.iconClass),' acticon"></span><span>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(opt_data.activityContainer.jiveObject.name),
[])),"</span></div>");home.nav.drop.down.containerEnd(null,output);return opt_sb?"":output.toString()};
;
goog.provide("jive.rtc.xPeopleLink");
jive.rtc.xPeopleLink=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<a href=\'#\' class="js-show-grouped-users j-act-showParticipants font-color-meta-light" title="',opt_data.users.length==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("rtc.subject.count.participant"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("rtc.subject.count.participants"),[opt_data.users.length])),'"><span class="jive-icon-glyph icon-users"></span> <span class="j-508-label">',opt_data.users.length==
1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("rtc.subject.count.participant"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("rtc.subject.count.participants"),[opt_data.users.length])),"</span>",soy.$$escapeHtml(opt_data.users.length),'</a><div class="js-grouped-users-popover j-menu j-pop-main j-grouped-users-popover" style="display:none"><ul class="j-grouped-user-list">');var groupedUserList18=opt_data.users;var groupedUserListLen18=groupedUserList18.length;for(var groupedUserIndex18=
0;groupedUserIndex18<groupedUserListLen18;groupedUserIndex18++){var groupedUserData18=groupedUserList18[groupedUserIndex18];if((groupedUserData18.displayName.match(new RegExp("^__invited__",""))||[]).length)output.append(soy.$$escapeHtml(groupedUserData18.email));else if(!groupedUserData18.anonymous){output.append('<li class="j-grouped-user">');jive.shared.displayutil.userDisplayNameLink(soy.$$augmentMap(groupedUserData18,{displayNameOverride:opt_data.viewingUser&&opt_data.viewingUser.id==groupedUserData18.id?
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.you"),[])):"",extraCss:"lnk"}),output);output.append("</li>")}else{output.append('<li class="j-grouped-user">');jive.shared.displayutil.renderGuestDisplayName({message:groupedUserData18},output);output.append("</li>")}}output.append("</ul></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.eae.common.groupedUsers");
jive.eae.common.groupedUsers=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;var noOverflow__soy3=opt_data.groupedUserList.length<=opt_data.groupAfterNum;var singleUserOverflow__soy4=opt_data.groupedUserList.length==opt_data.groupAfterNum+1;var multiUserOverflow__soy5=opt_data.groupedUserList.length>opt_data.groupAfterNum+1;var singleUser__soy6=opt_data.groupedUserList.length==1;var multipleUsers__soy7=opt_data.groupedUserList.length!=1;var groupedUserList8=opt_data.groupedUserList;
var groupedUserListLen8=groupedUserList8.length;for(var groupedUserIndex8=0;groupedUserIndex8<groupedUserListLen8;groupedUserIndex8++){var groupedUserData8=groupedUserList8[groupedUserIndex8];var userIsNextToLastGrouped__soy9=groupedUserIndex8==opt_data.groupAfterNum-1;var userIsLastGrouped__soy10=groupedUserIndex8==opt_data.groupAfterNum;var userIsNotLastGrouped__soy11=groupedUserIndex8<opt_data.groupAfterNum;var userIsLastTotal__soy12=groupedUserIndex8==opt_data.groupedUserList.length-1;if(groupedUserData8&&
(userIsNotLastGrouped__soy11||userIsLastGrouped__soy10&&singleUserOverflow__soy4)){output.append(groupedUserIndex8==groupedUserListLen8-1&&opt_data.groupedUserList.length>1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.and"),[]))+" ":"");if((groupedUserData8.username.match(new RegExp("^__invited__",""))||[]).length)output.append(soy.$$escapeHtml(groupedUserData8.email));else if(!groupedUserData8.anonymous)if(!opt_data.hideLinks)jive.shared.displayutil.userDisplayNameLink(groupedUserData8,
output);else jive.shared.displayutil.userDisplayName(groupedUserData8,output);else jive.shared.displayutil.renderGuestDisplayName({message:groupedUserData8},output);output.append(multipleUsers__soy7&&(noOverflow__soy3&&!userIsLastTotal__soy12||singleUserOverflow__soy4&&!userIsLastGrouped__soy10||multiUserOverflow__soy5&&!userIsNextToLastGrouped__soy9)?(opt_data.groupedUserList.length>2?",":"")+" ":"")}}if(opt_data.groupedUserList.length>opt_data.groupAfterNum+1){output.append(" ",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.and"),
[]))," ",!opt_data.hideLinks?"<a href='#' class=\"js-show-grouped-users jive-username-link\">":"",soy.$$escapeHtml(opt_data.groupedUserList.length-opt_data.groupAfterNum)," ",opt_data.groupedUserList.length>opt_data.groupAfterNum+1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("eae.others"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("eae.other"),[])));if(!opt_data.hideLinks){output.append('</a><div class="js-grouped-users-popover j-grouped-users-popover" style="display:none"><ul class="j-grouped-user-list j-simple-list">');
var groupedUserList56=opt_data.groupedUserList;var groupedUserListLen56=groupedUserList56.length;for(var groupedUserIndex56=0;groupedUserIndex56<groupedUserListLen56;groupedUserIndex56++){var groupedUserData56=groupedUserList56[groupedUserIndex56];if(groupedUserData56&&groupedUserIndex56>=opt_data.groupAfterNum)if((groupedUserData56.displayName.match(new RegExp("^__invited__",""))||[]).length)output.append(soy.$$escapeHtml(groupedUserData56.email));else if(!groupedUserData56.anonymous){output.append('<li class="j-grouped-user">');
jive.shared.displayutil.userDisplayNameLink(groupedUserData56,output);output.append("</li>")}else{output.append('<li class="j-grouped-user">');jive.shared.displayutil.renderGuestDisplayName({message:groupedUserData56},output);output.append("</li>")}}output.append("</ul></div>")}}return opt_sb?"":output.toString()};
;
goog.provide("jive.rtc.defaultSubject");
jive.rtc.defaultSubject=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;var param16=new soy.StringBuilder;jive.eae.common.groupedUsers({groupedUserList:opt_data.users,groupAfterNum:2,user:opt_data.viewingUser,hideLinks:opt_data.plainText},param16);jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("rtc.subject.default"),arg0:!opt_data.plainText&&opt_data.collabID?'<a href="'+soy.$$filterNoAutoescape(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/collaborations/"+opt_data.collabID))+
'" class="" role="heading">':"",arg1:!opt_data.plainText&&opt_data.collabID?"</a>":"",arg2:param16.toString(),noAutoEscape:true},output);return opt_sb?"":output.toString()};
;
goog.provide("jive.rtc.subjectText");
jive.rtc.subjectText=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.collabType=="INDIVIDUAL")if(opt_data.plainText){if(opt_data.users[0]){jive.shared.displayutil.userDisplayName(opt_data.users[0],output);output.append(" ")}output.append(" : ",opt_data.users[1]?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.you"),[])):"")}else{output.append('<span class="title js-rtc-subject-text" role="heading">');if(opt_data.users[0]){jive.shared.displayutil.userDisplayNameLink(opt_data.users[0],output);
output.append(" ")}output.append(opt_data.collabID?'<a href="'+soy.$$filterNoAutoescape(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/collaborations/"+opt_data.collabID))+'">+</a>':"+");if(opt_data.users[1])jive.shared.displayutil.userDisplayNameLink(soy.$$augmentMap(opt_data.users[1],{displayNameOverride:soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.you"),[]))}),output);output.append("</span>")}else if(opt_data.subject)if(opt_data.plainText)output.append(soy.$$filterNoAutoescape(opt_data.subject));
else{output.append(opt_data.collabID?'<a href="'+soy.$$filterNoAutoescape(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/collaborations/"+opt_data.collabID))+'" class="title js-rtc-subject-text noParticipantShowing" role="heading">':'<span class="title js-rtc-subject-text noParticipantShowing" role="heading">','<span title="',soy.$$escapeHtml(opt_data.subject),'" class="j-rtc-subject-text">',soy.$$filterNoAutoescape(opt_data.subject),"</span>",opt_data.collabID?"</a>":"</span>");if(opt_data.users.length>
1){output.append('<span class="js-with-x-people j-with-x-people">');jive.rtc.xPeopleLink(opt_data,output);output.append("</span>")}}else{output.append(!opt_data.plainText?'<span class="title js-rtc-subject-text" role="heading">':"");jive.rtc.defaultSubject(opt_data,output);output.append(!opt_data.plainText?"</span>":"")}return opt_sb?"":output.toString()};
;
goog.provide("home.nav.drop.down.rtc");
home.nav.drop.down.rtc=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.activityContainer.activityList.length>0){home.nav.drop.down.containerStart(opt_data,output);var activity__soy6=opt_data.activityContainer.activityList[opt_data.activityContainer.activityList.length-1];var latestInteraction__soy7=opt_data.activityContainer.jiveObject.latestInteraction;var latestAuthor__soy8=latestInteraction__soy7?latestInteraction__soy7.author:opt_data.activityContainer.originalAuthor;
if(!activity__soy6.content.deleted)jive.shared.displayutil.avatar(soy.$$augmentMap(latestAuthor__soy8,{size:32,anonymous:latestAuthor__soy8.anonymous,currentUserPartner:opt_data.user.partner,hideLink:true,avatarID:latestAuthor__soy8.avatarID}),output);output.append('<div class="font-color-meta">');jive.eae.common.activityAuthor({object:opt_data.activityContainer.jiveObject,type:"",activityUser:latestAuthor__soy8,displayAuthorLink:false,hideDetailedReplyTo:true,user:opt_data.user,againstObject:true,
deleted:activity__soy6.content.deleted},output);output.append(" ",soy.$$escapeHtml(opt_data.activityContainer.parentTime),'</div><div class="title font-color-link">');if(opt_data.activityContainer.jiveObject.roomType=="INDIVIDUAL")output.append(soy.$$escapeHtml(latestAuthor__soy8.displayName),' <span class="jive-icon-direct-message-1-1-label jive-icon-med"></span>',latestAuthor__soy8.id==opt_data.user.id?soy.$$escapeHtml(opt_data.activityContainer.jiveObject.participants[0].displayName):soy.$$escapeHtml(opt_data.user.displayName));
else{output.append(' <span class="jive-icon-direct-message jive-icon-med" role="img"></span>');jive.rtc.subjectText({users:opt_data.activityContainer.jiveObject.participants,viewingUser:opt_data.user,subject:opt_data.activityContainer.jiveObject.subject,plainText:true,collabType:opt_data.activityContainer.jiveObject.roomType},output)}output.append("</div>");home.nav.drop.down.containerEnd(null,output)}return opt_sb?"":output.toString()};
;
goog.provide("home.nav.drop.down.share");
home.nav.drop.down.share=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.activityContainer.activityList.length>0){home.nav.drop.down.containerStart(opt_data,output);var activity__soy6=opt_data.activityContainer.activityList[opt_data.activityContainer.activityList.length-1];if(!activity__soy6.content.deleted)jive.shared.displayutil.avatar(soy.$$augmentMap(activity__soy6.activityUser,{size:32,hideLink:true,anonymous:activity__soy6.activityUser.anonymous,currentUserPartner:opt_data.user.partner}),
output);output.append('<div class="font-color-meta">');jive.eae.common.activityAuthor({object:activity__soy6.content,type:"share",activityUser:activity__soy6.activityUser,displayAuthorLink:false,streamType:"communications",hideDetailedReplyTo:true,user:opt_data.user,againstObject:true,deleted:activity__soy6.content.deleted},output);output.append(" ",soy.$$escapeHtml(opt_data.activityContainer.parentTime),'</div><div class="title font-color-link"><span class="jive-icon-glyph icon-share-label"></span>',
soy.$$filterNoAutoescape(opt_data.activityContainer.jiveObject.subject),"</div>");home.nav.drop.down.containerEnd(null,output)}return opt_sb?"":output.toString()};
;
goog.provide("home.nav.drop.down.statusUpdate");
home.nav.drop.down.statusUpdate=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.activityContainer.activityList.length>0){home.nav.drop.down.containerStart(opt_data,output);var activity__soy6=opt_data.activityContainer.activityList[opt_data.activityContainer.activityList.length-1];if(!activity__soy6.content.deleted)jive.shared.displayutil.avatar(soy.$$augmentMap(activity__soy6.activityUser,{size:32,hideLink:true,anonymous:activity__soy6.activityUser.anonymous,currentUserPartner:opt_data.user.partner}),
output);output.append('<div class="font-color-meta">');jive.eae.common.activityAuthor({object:activity__soy6.content,type:activity__soy6.content.deleted?opt_data.activityContainer.jiveObject.objectType:activity__soy6.type,activityUser:activity__soy6.activityUser,displayAuthorLink:false,streamType:"communications",hideDetailedReplyTo:true,user:opt_data.user,againstObject:true,deleted:activity__soy6.content.deleted},output);output.append(" ",soy.$$escapeHtml(opt_data.activityContainer.parentTime),'</div><div class="title font-color-link">');
if(opt_data.activityContainer.jiveObject.activityIcon)jive.shared.displayutil.renderIconElement({icon:opt_data.activityContainer.jiveObject.activityIcon},output);else output.append("<span title='",soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("global.status"),[])),"' role='img' class=\"",soy.$$escapeHtmlAttribute(opt_data.activityContainer.jiveObject.jiveObjectCSS),'"></span>');output.append(opt_data.activityContainer.jiveObject.subjectIsHtml?soy.$$filterNoAutoescape(opt_data.activityContainer.jiveObject.htmlSubject):
soy.$$filterNoAutoescape(opt_data.activityContainer.jiveObject.subject),"</div>");home.nav.drop.down.containerEnd(null,output)}return opt_sb?"":output.toString()};
;
goog.provide("home.nav.drop.down.tileActivity");
home.nav.drop.down.tileActivity=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.activityContainer.activityList.length>0){var activity__soy5=opt_data.activityContainer.activityList[opt_data.activityContainer.activityList.length-1];home.nav.drop.down.containerStart(opt_data,output);if(!activity__soy5.content.deleted)if(!activity__soy5.content.typeTileStreamEntry)jive.shared.displayutil.avatar(soy.$$augmentMap(activity__soy5.activityUser,{size:32,hideLink:true,anonymous:activity__soy5.activityUser.anonymous,
currentUserPartner:opt_data.user.partner}),output);else output.append('<img class="jive-avatar" src="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(activity__soy5.content.tile.icons.size48.url)),'" alt="" width="32" height="32"/>');output.append('<div class="font-color-meta">');jive.eae.common.activityAuthor({object:activity__soy5.content,type:activity__soy5.content.deleted?opt_data.activityContainer.jiveObject.objectType:activity__soy5.type,activityUser:activity__soy5.content.typeTileStreamEntry?
activity__soy5.content.tile:activity__soy5.activityUser,displayAuthorLink:false,streamType:"communications",hideDetailedReplyTo:true,user:opt_data.user,againstObject:true,deleted:activity__soy5.content.deleted},output);output.append(" ",soy.$$escapeHtml(opt_data.activityContainer.parentTime),'</div><div class="title font-color-link">',soy.$$filterNoAutoescape(opt_data.activityContainer.jiveObject.subject),"</div>");home.nav.drop.down.containerEnd(null,output)}return opt_sb?"":output.toString()};
;
goog.provide("home.nav.drop.down.video");
home.nav.drop.down.video=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.activityContainer.activityList.length>0){home.nav.drop.down.containerStart(opt_data,output);var activity__soy6=opt_data.activityContainer.activityList[opt_data.activityContainer.activityList.length-1];if(!activity__soy6.content.deleted)jive.shared.displayutil.avatar(soy.$$augmentMap(activity__soy6.activityUser,{size:32,hideLink:true,anonymous:activity__soy6.activityUser.anonymous,currentUserPartner:opt_data.user.partner}),
output);output.append('<div class="font-color-meta">');jive.eae.common.activityAuthor({object:activity__soy6.content,type:activity__soy6.content.deleted?opt_data.activityContainer.jiveObject.objectType:activity__soy6.type,activityUser:activity__soy6.activityUser,displayAuthorLink:false,streamType:"communications",hideDetailedReplyTo:true,user:opt_data.user,againstObject:true,deleted:activity__soy6.content.deleted},output);output.append(" ",soy.$$escapeHtml(opt_data.activityContainer.parentTime),'</div><div class="title font-color-link"><span class="',
soy.$$escapeHtmlAttribute(opt_data.activityContainer.jiveObject.jiveObjectCSS),'"></span>',soy.$$filterNoAutoescape(opt_data.activityContainer.jiveObject.subject),"</div>");home.nav.drop.down.containerEnd(null,output)}return opt_sb?"":output.toString()};
;
goog.provide("home.nav.drop.down.welcome");
home.nav.drop.down.welcome=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;home.nav.drop.down.containerStart(opt_data,output);output.append('<div class="j-badge-oneliner"><span title=\'',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.access.welcome.indicator"),[])),'\' role=\'img\' class="jive-icon-glyph icon-leaf acticon"></span><span class="title">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("trial.inbox.message.welcome.label"),[])),"</span></div>");home.nav.drop.down.containerEnd(null,
output);return opt_sb?"":output.toString()};
;
define("apps/navbar/menu/home/navbar_menu_home_main",["jquery","apps/activity_stream/models/activity_stream_source","apps/read_tracking/models/read_tracking_source","apps/activity_stream/activity_notifier","soy!jive.nav.menu.home.main","soy!jive.nav.menu.home.content","soy!jive.welcome.updateIndicator","soy!home.nav.drop.down.generic","lib/jiverscripts/src/oo/class","apps/shared/controllers/localexchange"],function(g,b,c,f,e,d,a,h){jive.namespace("Navbar.Menu.Home");jive.Navbar.Menu.Home.Main=jive.oo.Class.extend(function(i){this.init=function(k){var j=this;j.$button=g(k);j.menuSource=new b();j.readTrackingSource=new c();j.counts={inbox:0,tasks:0,moderations:0};j.unreadItems={};j.pendingActionsCount=0;this.options={showCountInTitle:g("#jive-nav-link-communications").length>0};f.addListener("activityStream.poll",function(l){j.updateCount(l)});f.addListener("activityStream.push",function(l){j.pushCount(l)});jive.localexchange.addListener("inbox.read",function(m,l){j.removeUnreadItem({objectType:m,id:l});j.decrementNewCount("inbox",1)}).addListener("inbox.unread",function(m,l){j.addUnreadItem({objectType:m,id:l});j.decrementNewCount("inbox",-1)});jive.switchboard.addListener("inbox.read",function(m,l){j.removeUnreadItem({objectType:m,id:l});j.decrementNewCount("inbox",1)}).addListener("inbox.unread",function(m,l){j.addUnreadItem({objectType:m,id:l});j.decrementNewCount("inbox",-1)}).addListener("inbox.markAllRead",function(){j.unreadItems={};j.decrementNewCount("inbox",10000)}).addListener("tasks.taskComplete",function(){j.decrementNewCount("tasks",1)}).addListener("tasks.taskIncomplete",function(){j.decrementNewCount("tasks",-1)})};this.updateCount=function(l){var j=this;j.counts.inbox=l.fullCounts.communications.unreadCount;j.counts.actions=l.fullCounts.actions;j.counts.tasks=l.fullCounts.overdueTasks;j.counts.moderations=l.fullCounts.moderations;var k=l.fullCounts.communications.unreadItems;g.each(k,function(m,n){j.addUnreadItem(n)});j.renderCounts()};this.pushCount=function(p){var j=this;var k=j.$button.find(".j-js-update-indicator"),l=k.data("count"),o,n=p.parent;if(p.counts.tasks){o=l+1;var m=g(a({type:"count",count:o,extraCssClasses:"j-navbadge-count j-ui-elem"}));if(k.length){k.replaceWith(m)}else{j.$button.append(m)}if(j.options.showCountInTitle){j.updateTitleCount(o)}}else{if(p.counts.communications&&!j.isItemPreviouslyUnread(n)){jive.localexchange.emit("inbox.unread",n.objectType,n.id)}else{if(!p.counts.communications&&p.updateCommsData&&j.isItemPreviouslyUnread(n)){jive.localexchange.emit("inbox.read",n.objectType,n.id)}}}};this.addUnreadItem=function(j){var l=this.hashUnreadItem(j);var k=this.unreadItems[l];if(k===undefined){this.unreadItems[l]=j}};this.removeUnreadItem=function(j){var l=this.hashUnreadItem(j);var k=this.unreadItems[l];if(k!==undefined){delete this.unreadItems[l]}};this.getUnreadItems=function(){return this.unreadItems};this.isItemPreviouslyUnread=function(k){var l=this.hashUnreadItem(k);var j=this.unreadItems[l];if(j===undefined){return false}return true};this.hashUnreadItem=function(j){return j.objectType+"-"+j.id};this.decrementNewCount=function(k,l){var j=this;if(j.counts[k]<=50||l>1000){j.counts[k]=j.counts[k]-l;if(j.counts[k]<0){j.counts[k]=0}j.renderCounts()}};this.renderCounts=function(){var j=this,m=j.counts.inbox+j.counts.moderations,l=g(a({type:"count",count:m,showZero:true,extraCssClasses:"j-navbadge-count j-ui-elem"}));var k=j.$button.find(".j-js-update-indicator");if(k.length){k.replaceWith(l)}else{j.$button.append(l)}if(j.options.showCountInTitle){j.updateTitleCount(m)}};this.updateTitleCount=function(n){var p=m(document.title),l=k(document.title),o="...";if(n!==l&&p.trim()!==o){document.title=j(n)+" "+p}function m(r){var q=r.indexOf(")");if(q!=-1){return r.substring(r.indexOf(")")+2)}else{return r}}function k(r){var q=r.match(/\((\d+)\+?\)[\w\s]*/);if(q&&q.length){return parseInt(q[1],10)}else{return 0}}function j(q){if(q<=0){return""}else{if(q>0&&q<=50){return"("+q+")"}else{if(q>50){return"(50+)"}}}}};this.markRead=function(j,m){var k=this,l={objectType:j,id:m};k.readTrackingSource.save(j,m,true);if(k.isItemPreviouslyUnread(l)){jive.switchboard.emit("inbox.read",j,m)}}});return jive.Navbar.Menu.Home.Main});
;
goog.provide("jive.soy.spotlight.navbar");
jive.soy.spotlight.navbar=function(opt_data,opt_sb){opt_data=opt_data||{};var output=opt_sb||new soy.StringBuilder;var fieldId__soy3="j-nav-search";var spotlightSearchDefaultEnabled__soy4=opt_data.user.prop.search.defaultEnabled;var bookmarksVisible__soy5=opt_data.bookmarksLink.visible;var historyVisible__soy6=opt_data.historyLink.visible;output.append(opt_data.showSearch&&opt_data.spotlightSearchEnabled&&opt_data.spotlightV2Enabled?'<li id="j-nav-search-li" class="j-nav-open-visor j-globalNav-li js-nav-open-visor-container j-nav-create" aria-haspopup="true"><a href="#" id="'+soy.$$escapeHtml(fieldId__soy3)+
'" title="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.search"),[]))+'" aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.search"),[]))+'" class="j-globalNavLink j-ui-elem" role="menuitem" data-hideviews="'+(!bookmarksVisible__soy5||!spotlightSearchDefaultEnabled__soy4?"bookmarks":"")+" "+(!historyVisible__soy6||!spotlightSearchDefaultEnabled__soy4?"default history":"")+'" data-hidetypes="'+(opt_data.excludePlaces?" place":"")+(opt_data.excludePeople?" person":
"")+'" ><span class="nav-link j-ui-elem"><i class="icon-search"></i></span></a></li>':"");return opt_sb?"":output.toString()};
;
goog.provide("jive.autosearch.overlay");jive.autosearch.overlay=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.type=="bookmark"?'<div class="j-tooltip j-pop" role="alert"><span class="jive-icon-med jive-icon-bookmark-ribbon"></span><span class="j-tooltip-content">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.placeholder.bookmark"),[]))+'</span><span class="belowArrow pointer" style="right: 30px;"></span></div>':"");return opt_sb?"":output.toString()};
;
goog.provide("jive.autosearch.spotlightPopup");jive.autosearch.spotlightPopup=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="jive-spotlight-search-result j-menu j-quick-menu" data-component="popup" style="display: none;"><div>');return opt_sb?"":output.toString()};
;
goog.provide("jive.autosearch.spotlightView");
jive.autosearch.spotlightView=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<div>",opt_data.view=="frequent"||opt_data.view=="recent"||opt_data.view=="bookmarks"?'<p class="j-pop-desc"><strong>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.view.default.header"),[opt_data.communityName]))+'</strong> <span class="j-ui-elem j-spotlight-arrow"></span></p><h5>'+(!opt_data.availableViews["bookmarks"]?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.view.nobookmarks.title"),[])):
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.view.default.title"),[])))+'</h5><nav class="j-spotlightnav font-color-meta" >'+(opt_data.availableViews["frequent"]?'<a data-component="button" data-view="frequent" class="'+(opt_data.view=="frequent"?"j-active":"")+" "+(!opt_data.availableViews["recent"]&&!opt_data.availableViews["bookmarks"]?" j-last":"")+'" href="javascript:void(0);">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.view.frequent.caption"),[]))+"</a>":"")+
(opt_data.availableViews["recent"]?'<a data-component="button" data-view="recent" class="'+(opt_data.view=="recent"?"j-active":"")+"  "+(!opt_data.availableViews["bookmarks"]?" j-last":"")+'" href="javascript:void(0);">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.view.recent.caption"),[]))+"</a>":"")+(opt_data.availableViews["bookmarks"]?'<a data-component="button" data-view="bookmarks" class="'+(opt_data.view=="bookmarks"?"j-active":"")+' j-last" href="javascript:void(0);">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.view.bookmarks.caption"),
[]))+"</a>":"")+"</nav>":(opt_data.availableViews["frequent"]||opt_data.availableViews["recent"]||opt_data.availableViews["bookmarks"]?'<p class="j-pop-desc">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.view.search.header.history"),[]))+"</p>":"")+(opt_data.view=="all"||opt_data.view=="filtered"?"<h5>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.view.search.title"),[]))+' <span class="spinner" data-component="progressmeter" data-mode="undetermined" data-active="false" data-size="small"></span></h5>':
"")+(opt_data.availableViews["filtered"]&&opt_data.availableViews["all"]?'<nav class="j-spotlightnav font-color-meta trimmed"><a href="javascript:void(0);" data-component="button" data-view="all" class="'+(opt_data.view=="all"?"j-active":"")+'">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.view.all.caption"),[]))+'</a><a href="javascript:void(0);" data-component="button" data-view="filtered" class="'+(opt_data.view=="filtered"?"j-active":"")+' j-last">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.view.filtered.caption"),
[opt_data.filterDisplayName]))+"</a></nav>":""),'<div class="j-spotlight-find" data-component="list" data-wrap="true"><div data-component="loadingpanel" class="j-spotlight-working font-color-meta"><div>',opt_data.view=="all"||opt_data.view=="filtered"?"<p>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.view.search.searching.text"),[]))+"</p>":"<p>"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.view.history.loading.text"),[]))+"</p>",'</div><span data-component="progressmeter" data-mode="undetermined" data-active="false"></span></div></div></div>');
return opt_sb?"":output.toString()};
;
goog.provide("jive.autosearch.results");
jive.autosearch.results=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.results.content&&opt_data.results.content.length){output.append('<div class="j-results" data-type="contents">',!(opt_data.view=="bookmarks")&&!(opt_data.view=="filtered")?'<h4 class="font-color-meta" id="header_content">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.search_for.content"),[]))+"</h4>":"");jive.autosearch.resultSection(soy.$$augmentMap(opt_data,{list:opt_data.results.content,
type:"content",max:!(opt_data.view=="bookmarks")&&!(opt_data.view=="filtered")?"5":""}),output);output.append("</div>")}if(opt_data.results.people&&opt_data.results.people.length){output.append('<div class="j-results" data-type="people"><h4 class="font-color-meta" id="header_people">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.search_for.people"),[])),"</h4>");jive.autosearch.resultSection(soy.$$augmentMap(opt_data,{list:opt_data.results.people,type:"people",max:5}),output);output.append("</div>")}if(opt_data.results.places&&
opt_data.results.places.length){output.append('<div class="j-results" data-type="places"><h4 class="font-color-meta"  id="header_places">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.search_for.places"),[])),"</h4>");jive.autosearch.resultSection(soy.$$augmentMap(opt_data,{list:opt_data.results.places,type:"places",max:5}),output);output.append("</div>")}output.append((!opt_data.results.content||!opt_data.results.content.length)&&(!opt_data.results.people||!opt_data.results.people.length)&&
(!opt_data.results.places||!opt_data.results.places.length)?'<div class="j-spotlight-empty font-color-meta">'+(opt_data.view=="frequent"?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.view.frequent.empty.text"),[])):opt_data.view=="recent"?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.view.recent.empty.text"),[])):opt_data.view=="bookmarks"?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.view.bookmarks.empty.text"),[])):opt_data.view=="all"||opt_data.view==
"filtered"?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.view.search.empty.text"),[])):"")+"</div>":"");return opt_sb?"":output.toString()};
;
goog.provide("jive.i18n.keys.searchViewDefaultTitle");jive.i18n.keys.searchViewDefaultTitle=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.view.default.title"),[])));return opt_sb?"":output.toString()};
;
goog.provide("jive.i18n.keys.searchViewSearchTitle");jive.i18n.keys.searchViewSearchTitle=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("search.view.search.title"),[])));return opt_sb?"":output.toString()};
;
define("jive.component.PopupView",["jquery"],function(b){var a=jive.oo.Class.extend(function(c){c.init=function(d){this.$element=b(d)};this.toString=function(){return"[object PopupView]"};this.show=function(f,e,i,d,h){e=e?e:f;i=i!=null?i:true;d=d!=null?d:false;this.trigger=f;var g=e.find("input").length>0?e.find("input"):e;this.$element.popover({container:e.id(),context:g,closeOnClick:true,closeOtherPopovers:i,destroyOnClose:false,flip:false,focusPopover:d,additionalContainerSelector:"#j-spotlight-search, .j-spotlight-search, .jive-spotlight-search-result"})};this.hide=function(){this.$element.trigger("close")};this.getTrigger=function(){return this.trigger};this.getState=function(){return this.$element.is(":visible")?"visible":"hidden"};this.getTopMargin=function(){return this.$element.closest(".js-pop").offset().top-b(window).scrollTop()};this.getOuterHeight=function(){return this.$element.closest(".js-pop").outerHeight()};this.scrollTo=function(d){var g=this.$element.find(".j-spotlight-find");if(g.length<1){return}var h=g.height();var n=g.offset().top;var e=n+h;var k=d.outerHeight();var m=d.offset().top;var l=m+k;var j=g.find("h4").outerHeight()||32;var i=m<n+j;var f=l>e-j;if(i){g.scrollTo(d,{offset:0-j})}else{if(f){g.scrollTo(d,{offset:0-(h-k-j)})}}}});a.toString=function(){return"[wrapper PopupView]"};a.getBindName=function(){return"PopupView"};return a});
;
define("jive.component.ProgressMeterView",["jquery"],function(a){var b=jive.oo.Class.extend(function(c){c.init=function(d){this.$element=a(d)};this.toString=function(){return"[object ProgressMeterView]"};this.start=function(){if(!this.spinner){this.spinner=new jive.loader.LoaderView({inline:true,showLabel:false,size:this.$element.attr("data-size")});this.spinner.appendTo(this.$element);this.$element.attr("data-active",true)}};this.stop=function(){if(this.spinner){this.spinner.getContent().remove();this.spinner.destroy();this.$element.attr("data-active",false)}};this.getMode=function(){var d=this.$element.data("mode");return d?d:"undetermined"};this.isActive=function(){var d=this.$element.data("active");return d?d:false}});b.toString=function(){return"[wrapper ProgressMeterView]"};b.getBindName=function(){return"ProgressMeterView"};return b});
;
(function(a){a.fn.view=function(b,c){if(!jQuery.isFunction(b)){throw"IllegalViewParameterException"}if(!c&&b.getBindName){c=b.getBindName()}if(!c){throw"IllegalBindParameterException"}var e;if(this.length){var d=this.first();e=d.data(c);if(e==null){e=new b(d.get(0));d.data(c,e)}else{if(!(e instanceof b)){throw"PropertyAlreadyBoundException"}}}return e}})(jQuery);
;
define("jive.component.list",["jquery"],function(b){var a={};a.ListView=jive.oo.Class.extend(function(c){this.init=function(d){this.$element=b(d)};this.toString=function(){return"[object ListView]"};this.allowWrap=function(){return this.$element.data("wrap")==true};this.getListItemElements=function(){return this.$element.find("[data-component='listitem']:visible").get()};this.getListItems=function(){var d=[];b(this.getListItemElements()).each(function(e,f){d.push(b(f).view(a.ListItemView))});return d};this.getSelectedElement=function(){return b(this.getListItemElements()).filter(".j-selected").get(0)};this.getSelectedIndex=function(){var d=this.getSelectedElement();if(d){return b(this.getListItemElements()).index(d)}else{return -1}};this.select=function(e){var d=this.getListItemElements();if(b.isNumeric(e)){if(this.allowWrap()){e=this.wrapIndex(e)}e=d[e]}b(d).filter(".j-selected").removeClass("j-selected");b(e).addClass("j-selected")};this.incriment=function(e){if(e==0){return}var d=this.getSelectedIndex();if(e<0&&d==-1){e++}e=d+e;this.select(e)};c.wrapIndex=function(e){var d=this.getListItemElements().length;e=e%d;e=e<0?d+e:e;return e}});a.ListView.toString=function(){return"[wrapper ListView]"};a.ListView.getBindName=function(){return"ListView"};a.ListItemView=jive.oo.Class.extend(function(c){this.init=function(d){this.$element=b(d)};this.toString=function(){return"[object ListItemView]"};this.getListElement=function(){return this.$element.closest("[data-component='list']").get()};this.getList=function(){return b(this.getListElement()).view(item.ListView)};this.select=function(){this.getList().select(this.$element.get())}});a.ListItemView.toString=function(){return"[wrapper ListItemView]"};a.ListItemView.getBindName=function(){return"ListItemView"};return a});
;
define("apps/autosearch/search_service",["jquery","apps/shared/models/deferred_rest_service"],function(b,a){return a.extend(function(c){c.resourceType="search";this.init=function(d){this.RESOURCE_ENDPOINT=_jive_base_url+"/api/core/v3/search"};this.createParams=function(e,i,d,g,h,k){var j={};j.startIndex=k;j.sort=g;j.origin="spotlight";j.highlight=false;j.count=h;j.filter=[];if(d){j.fields=b.isArray(d)?d.join(","):d}if(i){for(var f in i){j.filter.push(f+"("+i[f]+")")}}if(e){j.filter.push("search("+e+")")}return j};this.query=function(k,f,e,i,h,j,l){var g=this.createParams(f,e,i,h,j,l);var d=this.RESOURCE_ENDPOINT+"/"+k;if(k==="contents"){g.collapse=true;g.directive=["include_rtc"];g.socialSearch=true}if(k==="places"){g.socialSearch=true;d=this.RESOURCE_ENDPOINT}return this.commonAjaxRequest(new b.Deferred(),"GET",{url:d,data:g})}})});
;
define("jive.component.autosearch.ActivitySource",["jquery","apps/shared/models/deferred_rest_service"],function(b,a){return a.extend(function(c){c.resourceType="search";this.init=function(d){this.RESOURCE_ENDPOINT=_jive_base_url+"/api/core/v3/activities/"};this.queryFrequent=function(f,d,h,g){var i={};i.count=h;if(g){i.filter=g}if(d){i.fields=b.isArray(d)?d.join(","):d}var e=this.RESOURCE_ENDPOINT+"frequent/"+f;return this.commonAjaxRequest(new b.Deferred(),"GET",{url:e,data:i})};this.queryRecent=function(f,d,h,g){var i={};i.count=h;if(g){i.filter=g}if(d){i.fields=b.isArray(d)?d.join(","):d}var e=this.RESOURCE_ENDPOINT+"recent/"+f;return this.commonAjaxRequest(new b.Deferred(),"GET",{url:e,data:i})}})});
;
define("apps/autosearch/content_source",["jquery","apps/shared/models/rest_service"],function(b,a){return a.extend(function(c){c.resourceType="search";this.init=function(d){this.suppressGenericErrorMessages();this.RESOURCE_ENDPOINT=_jive_base_url+"/api/core/v3/contents"};this.query=function(g,f){var h={};h.count=f;h.origin="spotlight";h.filter=[];h.socialSearch=true;if(g){for(var e in g){h.filter.push(e+"("+g[e]+")")}}var d=this.RESOURCE_ENDPOINT;return this.commonAjaxRequest(new jive.conc.Promise(),"GET",{url:d,data:h})}})});
;
define("apps/autosearch/people_source",["jquery","apps/shared/models/rest_service"],function(b,a){return a.extend(function(c){c.resourceType="search";this.init=function(d){this.suppressGenericErrorMessages();this.RESOURCE_ENDPOINT=_jive_base_url+"/api/core/v3/people"};this.query=function(g,f){var h={};h.count=f;h.origin="spotlight";h.filter=[];if(g){for(var e in g){h.filter.push(e+"("+g[e]+")")}}var d=this.RESOURCE_ENDPOINT;return this.commonAjaxRequest(new jive.conc.Promise(),"GET",{url:d,data:h})}})});
;
define("apps/autosearch/place_source",["jquery","apps/shared/models/rest_service"],function(b,a){return a.extend(function(c){c.resourceType="search";this.init=function(d){this.suppressGenericErrorMessages();this.RESOURCE_ENDPOINT=_jive_base_url+"/api/core/v3/places"};this.query=function(g,f){var h={};h.count=f;h.origin="spotlight";h.filter=[];h.socialSearch=true;if(g){for(var e in g){h.filter.push(e+"("+g[e]+")")}}var d=this.RESOURCE_ENDPOINT;return this.commonAjaxRequest(new jive.conc.Promise(),"GET",{url:d,data:h})}})});
;
define("apps/shared/models/bookmark_source",["apps/shared/models/rest_service"],function(a){jive.BookmarkSource=a.extend(function(b){b.resourceType="bookmark"});return jive.BookmarkSource});
;
jive.namespace("search");jive.search.arrived=new Date().getTime();jive.search.SearchMetrics=jive.oo.Class.extend(function(a){var b=jQuery;a.init=function(d){this.data={name:d,referrer:document.referrer,pageArriveDate:jive.search.arrived,pageLeftDate:undefined,queries:[]};this.byName={};var c=this;b(window).on("beforeunload",function(){c.data.pageLeftDate=new Date().getTime();if(c.data.queries.length){c.commit(true)}})};this.commit=function(c){var d=JSON.stringify(this);return b.ajax({type:"POST",url:jive.app.url({path:"/api/core/v3/search/monitor"}),data:d,async:!c,contentType:"application/json",dataType:"json"})};this.addQuery=function(d,c){this.data.queries.push(d);if(c){this.byName[c]=d;if(c.slice(0,3)==="alt"){d.isAlternate=true}}return this};this.getQuery=function(c){return this.byName[c]};this.forEachCurrent=function(d){for(var c in this.byName){if(this.byName.hasOwnProperty(c)){d(this.byName[c],c)}}return this};this.setChoice=function(f,e,d){var g=this.byName[f],c=g.getResult(e);if(_.isObject(c)){g.setChoice({index:e,item:c,clickedUrl:d,date:new Date().getTime()})}return this};this.toJSON=function(){return this.data}});jive.search.SearchMetricsQuery=jive.oo.Class.extend(function(a){a.init=function(c,b){this.data={query:c||"",sentDate:b||new Date().getTime(),returnedDate:undefined,results:[]}};this.addResults=function(b){var c=this.data.results;c.push.apply(c,b);return this};this.getResult=function(b){return this.data.results[b]};this.forEachResult=function(d){var c=this.data.results;for(var b in c){if(c.hasOwnProperty(b)){d(c[b],b)}}return this};this.setReturnedDate=function(b){this.data.returnedDate=b;return this};this.incPage=function(){this.data.pagesLoaded=(this.data.pagesLoaded||0)+1;return this};this.abort=function(){this.data.aborted=new Date().getTime();return this};this.setChoice=function(b){this.data.choice=b;return this};this.toJSON=function(){return this.data}});
;
jive.namespace("search");(function(d){var l=jive.search,k=jive.app.url({path:"/api/core/v3"}),h={content:{url:k+"/search/contents",validParams:["count","startIndex","sort","socialSearch"],validFilters:["search","type","tag","author","place","after","language"],defaults:{origin:"searchpage",collapse:"true",depth:"none",socialSearch:"true",returnScore:"true",fields:"rootType,type,subject,author,question,answer,helpful,parentPlace,parentContent,highlightSubject,highlightBody,highlightTags,outcomeCounts,published,updated,replyCount,likeCount,viewCount,visibleToExternalContributors,binaryURL,uuid,index,iconCss",directive:["include_rtc"]}},people:{url:k+"/search/people",validParams:["count","startIndex","sort"],validFilters:["search","nameonly","include-disabled"],defaults:{origin:"searchpage"}},places:{url:k+"/search/places",validParams:["count","startIndex","sort","socialSearch"],validFilters:["search","type","tag"],defaults:{origin:"searchpage",socialSearch:"true",returnScore:"true"}}};function e(){return k}function j(m){return h[m].url}function b(m,o){var n=d.getJSON(m,o).then(function(p){if(p.links&&p.links.next){p.next=b.bind(this,p.links.next,{})}p.returnedDate=new Date().getTime();return p});n.query=m+"?"+d.param(o);n.sentDate=new Date().getTime();return n}function i(r,q){if(!h.hasOwnProperty(r)){throw new Error("Invalid type, must be content, people, or places")}if(!q){throw new Error("Must provide params to query")}var p=d.extend({},h[r].defaults),m=h[r].validParams;var n=l.getUrl(r);m.forEach(function(s){if(q[s]){p[s]=q[s]}});var o=q.filter;if(o instanceof Array){o=o.map(function(s){if(s==="type(dm)"){return"type(dm,collaboration,interaction)"}else{return s.replace(/^after\((.*)\)$/,function(t,u){return"after("+g(u)+")"})}})}p.filter=o;return b(n,p)}function a(n,m){var o=JSON.stringify(n);return d.ajax({type:"POST",url:k+"/search/monitor",data:o,async:!m,contentType:"application/json",dataType:"json"})}function c(o,n,m){if(!o.hasOwnProperty("filter")){o.filter=[]}if(d.isArray(m)){m=m.join(",")}o.filter.push(n+"("+m+")")}var f={day:1,week:7,month:30,quarter:90,year:365};function g(r){var n=86400000;var o=new Date();var m=new Date(o.getFullYear(),o.getMonth(),o.getDate());var q=m.getTime();var s=f[r];if(!s){return false}var p=new Date(q-n*s).toISOString();return p.replace(/Z$/,"+0000")}if(!Date.prototype.toISOString){(function(){function m(o){var n=String(o);if(n.length===1){n="0"+n}return n}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+m(this.getUTCMonth()+1)+"-"+m(this.getUTCDate())+"T"+m(this.getUTCHours())+":"+m(this.getUTCMinutes())+":"+m(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1000).toFixed(3)).slice(2,5)+"Z"}}())}l.query=i;l.logMonitoring=a;l.getBaseUrl=e;l.getUrl=j})(jQuery);
;
define("apps/autosearch/autosearch","jquery apps/autosearch/search_service jive.component.autosearch.ActivitySource apps/autosearch/content_source apps/autosearch/people_source apps/autosearch/place_source jive.component.list jive.component.PopupView jive.component.ProgressMeterView".split(" "),function($$$$,$SearchSource$$,$ActivitySource$$,$ContentSource$$,$PeopleSource$$,$PlaceSource$$,$list$$,$PopupView$$,$ProgressMeterView$$){var $autosearch$$={init:function(){var $$document$$=$$$$(document),
$viewsInitialized$$=[];$$$$("input[data-component\x3d'autosearch']").placeHeld();$$document$$.on("keypress.autosearchview, focus.autosearchview","input[data-component\x3d'autosearch']",function(){-1==$$$$.inArray($$$$(this).id(),$viewsInitialized$$)&&($viewsInitialized$$.push($$$$(this).id()),$$$$(this).view($AutoSearchView$$))});jive.switchboard.addListener("bookmark.create",function(){var $$searches$$=$$$$("#j-spotlight-search");$$searches$$.addClass("j-bookmark-created");$$searches$$.append(jive.autosearch.overlay({type:"bookmark"}));
var $$overlays$$=$$searches$$.find(".j-tooltip");$$overlays$$.fadeIn(250);setTimeout(function(){$$searches$$.removeClass("j-bookmark-created");$$overlays$$.fadeOut(250,function(){$$$$(this).remove()})},1500)})}},$AutoSearchView$$=jive.oo.Class.extend(function($protect$$){function $getFilterObject$$($inputFilters$$){var $filterObject$$={};_.each($inputFilters$$,function($filter_parts$$){/\w+\(\w+\)/.test($filter_parts$$)&&($filter_parts$$=$filter_parts$$.split("("),$filterObject$$[$filter_parts$$[0]]=
$filter_parts$$[1].replace(")",""))});return $filterObject$$}function $appendAsterisk$$($query$$){if(2>$query$$.length)return $query$$;var $lastToken_split$$=$query$$.split(" "),$lastToken_split$$=$lastToken_split$$[$lastToken_split$$.length-1];if(1<$lastToken_split$$.length)return $query$$+"*";var $JSCompiler_temp$$;if($JSCompiler_temp$$=1==$lastToken_split$$.length)$JSCompiler_temp$$=/^\d$/.test($lastToken_split$$);return $JSCompiler_temp$$?$query$$:$appendAsterisk$$($$$$.trim($query$$.substring(0,
$query$$.length-2)))}function $toMetricInfo$$($result$$){return{id:$result$$.id,type:$result$$.type}}function $formatResult$$($facet$$,$result$$){"favorite"==$result$$.type&&"url"!=$result$$.favoriteObject.type&&($result$$=$result$$.favoriteObject,$result$$.displayExternalAccess=!_jive_current_user.partner&&$result$$.visibleToExternalContributors);"content"==$facet$$?($result$$.published&&($result$$.publishedDate=$parseDate$$($result$$.published).getTime()),$result$$.updated&&($result$$.updatedDate=
$parseDate$$($result$$.updated).getTime()),$result$$.author&&!$result$$.author.displayName&&($result$$.author.displayName=$result$$.author.name.formatted||$result$$.author.jive.username),"file"==$result$$.type&&$result$$.binaryURL&&($result$$.extension=$result$$.binaryURL.split(".").slice(-1).join(".").toLowerCase()),!$result$$.subject&&$result$$.highlightSubject&&($result$$.subject=$result$$.highlightSubject),!$result$$.subject&&$result$$.parentContent&&($result$$.subject=$result$$.parentContent.name),
$result$$.subject=$$$$("\x3cdiv\x3e"+$result$$.subject+"\x3c/div\x3e").text(),$result$$.displayExternalAccess=!_jive_current_user.partner&&$result$$.visibleToExternalContributors):"people"==$facet$$?($result$$.jive&&($result$$.jive.profile&&$result$$.jive.profile instanceof Array)&&$$$$($result$$.jive.profile).each(function($i$$,$field$$){"Title"==$field$$.jive_label?$result$$.title=$field$$.value:"Department"==$field$$.jive_label&&($result$$.department=$field$$.value)}),$result$$.displayName||($result$$.displayName=
$result$$.name.formatted||$result$$.jive.username),$result$$.displayExternalContributor=!_jive_current_user.partner&&$result$$.jive&&$result$$.jive.externalContributor):$result$$.displayExternalAccess=!_jive_current_user.partner&&$result$$.visibleToExternalContributors}function $parseDate$$($almostISOString_formatForIE7etall_isoString$$){$almostISOString_formatForIE7etall_isoString$$=$almostISOString_formatForIE7etall_isoString$$.replace(/\+\d+/,"Z");var $date$$=new Date($almostISOString_formatForIE7etall_isoString$$);
isNaN($date$$.getTime())&&($almostISOString_formatForIE7etall_isoString$$=$almostISOString_formatForIE7etall_isoString$$.replace(/-/,"/").replace("T"," ").replace(/\.\d+Z/," GMT"),$date$$=new Date($almostISOString_formatForIE7etall_isoString$$));return $date$$}$protect$$.init=function $$protect$$$init$($containerSplit_element$$4_inputFilters$$inline_7_origin_resultFilterTypes$$){this.$element=$$$$($containerSplit_element$$4_inputFilters$$inline_7_origin_resultFilterTypes$$);$containerSplit_element$$4_inputFilters$$inline_7_origin_resultFilterTypes$$=
this.$element.data("origin")||"unknown";this.resultsView=this.$element.data("resultsView")||$PopupView$$;this.searchSource=new $SearchSource$$({origin:$containerSplit_element$$4_inputFilters$$inline_7_origin_resultFilterTypes$$});this.activitySource=new $ActivitySource$$;this.contentSource=new $ContentSource$$;this.peopleSource=new $PeopleSource$$;this.placeSource=new $PlaceSource$$;this.bookmarkSource=new jive.BookmarkSource;this.metrics=new jive.search.SearchMetrics("spotlight-search");this.$element.attr("maxlength",
250);this.inputFilters=($containerSplit_element$$4_inputFilters$$inline_7_origin_resultFilterTypes$$=this.$element.data("filters"))?$containerSplit_element$$4_inputFilters$$inline_7_origin_resultFilterTypes$$.split(","):[];this.resultFilterTypes=($containerSplit_element$$4_inputFilters$$inline_7_origin_resultFilterTypes$$=this.$element.data("resultFilterTypes"))?$containerSplit_element$$4_inputFilters$$inline_7_origin_resultFilterTypes$$.split(","):[];this.$element.data("container")?($containerSplit_element$$4_inputFilters$$inline_7_origin_resultFilterTypes$$=
this.$element.data("container").split(":"),this.containerType=parseInt($containerSplit_element$$4_inputFilters$$inline_7_origin_resultFilterTypes$$[0]),this.containerId=parseInt($containerSplit_element$$4_inputFilters$$inline_7_origin_resultFilterTypes$$[1]),this.containerBrowseId=parseInt(this.$element.data("container-browseid")),this.filterType="place",this.filter=["/places/"+this.containerBrowseId],this.additionalFilters={depth:"ALL"},this.displayName=this.$element.data("container-name"),this.forceFiltered=
!0):(this.containerType=jive.global.containerType,this.containerId=jive.global.containerID,this.containerBrowseId=jive.global.containerBrowseId);this.deferreds=[];3==this.containerType?this.peopleSource.get(this.containerId).addCallback(function($data$$){$data$$&&($formatResult$$("people",$data$$),this.filterType="author",this.filter=/\/[^/]*\/[^/]*$/.exec($data$$.resources.self.ref),this.displayName=$data$$.displayName)}.bind(this)):2020!=this.containerType&&-1!=this.containerBrowseId&&this.placeSource.get(this.containerBrowseId).addCallback(function($data$$){$data$$&&
!("space"==$data$$.type&&null==$data$$.parent)&&(this.filterType="place",this.filter=/\/[^/]*\/[^/]*$/.exec($data$$.resources.self.ref),this.additionalFilters={depth:"ALL"},this.displayName=$data$$.name)}.bind(this));var $search$$=this,$$clearButton$$=$$$$("[data-type\x3d'clear'][data-field\x3d'"+this.$element.get(0).id+"']");$$clearButton$$.on("click",function(){$search$$.$element.focus();$search$$.$element.val("");$search$$.setView(null);$search$$.renderView();$search$$.loadViewContent();$$$$(this).removeClass("j-active")});
this.$element.typeAhead({keystrokeWait:400,suppressBlurEvent:/iPhone|iPod|iPad/.test(navigator.userAgent),itemSelector:"li.j-listitem:visible",tabSelector:"nav a[data-component\x3d'button'][data-view]:visible",deselectOnMouseOut:!0}).on("keystroke",function keystrokeHandler(){var $query$$=$search$$.getSearchTerm();$query$$?$search$$.change():$search$$.clear($search$$);"visible"==$search$$.getPopup().getState()&&($query$$.length?$$clearButton$$.addClass("j-active"):$$clearButton$$.removeClass("j-active"))}).on("focusWaitFinished",
function($event$$){$$$$(this).closest("[role\x3dsearch]").addClass("focused");var $searchView$$=$$$$(this).view($AutoSearchView$$);if("visible"!=$searchView$$.getPopup().getState()&&(-1==$$$$(this).attr("data-hidetypes").indexOf("frequent")||1<$$$$($event$$.currentTarget).val().length))$searchView$$.renderView(),$searchView$$.loadViewContent()}).on("blurWaitFinished",function(){$$$$(this).closest("[role\x3dsearch]").removeClass("focused").end().trigger("close")}).on("selectionChosen",function($ev$$,
$id$$,$$target$$,$newSelection_origEv$$){var $$link$$=$$target$$.find("a:first"),$href$$=$$link$$.attr("href");$$link$$.is("[data-component\x3d'button']")?($$link$$.is("[data-command\x3d'more']")&&($newSelection_origEv$$=$$link$$.closest("ul").find("li.j-inactive").removeClass("j-inactive").first(),$id$$.setSelected($newSelection_origEv$$),$$link$$.closest("li").addClass("j-inactive")),$search$$.activateItem($$target$$)):$$$$($newSelection_origEv$$.target).is("[data-component\x3d'button']")?($$$$($newSelection_origEv$$.target).is("[data-command\x3d'remove']")&&
($id$$=$$target$$.find("[data-component\x3d'button'][data-command\x3d'remove']").data("id"),$search$$.deleteBookmark($id$$).addCallback(function(){$$target$$.fadeOut("fast",function(){$$target$$.remove()})})),$search$$.activateItem($$target$$)):"click"==$newSelection_origEv$$.type?($newSelection_origEv$$.noPreventDefault(),$search$$.activateItem($$target$$)):setTimeout(function(){$ev$$.isDefaultPrevented()||(window.location=$href$$)},0)}).on("otherClick",function($event$$,$typeAhead$$,$$target$$){$$target$$.is("[data-component\x3d'button'][data-view]")&&
($search$$.setView($$target$$.data("view")),$search$$.renderView(),$search$$.loadViewContent())}).on("otherEnter",function(){$search$$.navigateToSearchPage()}).on("close",function(){$search$$.hidePopup()}).on("selectionChanged",function($_$$1_popup$$,$__$$,$$selected$$,$source$$){$_$$1_popup$$=$search$$.getPopup();"mouse"!==$source$$&&$_$$1_popup$$.scrollTo&&$_$$1_popup$$.scrollTo($$selected$$)}).attr("aria-autocomplete","list").attr("role","combobox");$$$$("[data-type\x3d'search'][data-field\x3d'"+
this.$element.get(0).id+"']").on("click",function(){$search$$.navigateToSearchPage()})};this.toString=function $this$toString$(){return"[object AutoSearchView]"};$protect$$.getCurrentView=function $$protect$$$getCurrentView$(){var $view$$=this.currentView;$view$$||($view$$=this.getDefaultView());return $view$$};$protect$$.getDefaultView=function $$protect$$$getDefaultView$(){var $availableViews$$=this.getAvailableViews();return $availableViews$$.frequent?"frequent":$availableViews$$.bookmarks?"bookmarks":
$availableViews$$.filtered&&this.forceFiltered?"filtered":$availableViews$$.content?"content":null};this.getPopupElement=function $this$getPopupElement$(){var $$popupElement_popupElement_popupReference$$=this.$element.data("popupElement");$$popupElement_popupElement_popupReference$$||(($$popupElement_popupElement_popupReference$$=this.$element.data("popup"))?$$popupElement_popupElement_popupReference$$=$$$$("#"+$$popupElement_popupElement_popupReference$$):($$popupElement_popupElement_popupReference$$=
$$$$(jive.autosearch.spotlightPopup()),this.$element.after($$popupElement_popupElement_popupReference$$)),$$popupElement_popupElement_popupReference$$=$$popupElement_popupElement_popupReference$$.get(0),this.$element.data("popupElement",$$popupElement_popupElement_popupReference$$));return $$popupElement_popupElement_popupReference$$};$protect$$.getSearchTerm=function $$protect$$$getSearchTerm$(){var $query$$=this.$element.placeHeldVal();if(2<=($query$$.match(/[^\s]/g)||[]).length)if($query$$=$$$$.trim($query$$).replace(/\s+/g,
" "),2<=$query$$.length)return $query$$;return""};this.activateItem=function $this$activateItem$($$item_item$$){$$item_item$$=$$$$($$item_item$$);if(!$$item_item$$.children().addBack().hasClass("more")&&"all"==this.getCurrentView()||"filtered"==this.getCurrentView()){var $index$$=$$item_item$$.closest("[data-component\x3d'listitem']").prevAll("[data-component\x3d'listitem']").length,$type$$=$$item_item$$.closest("div[data-type]").attr("data-type");this.metrics.setChoice($type$$,$index$$,$$item_item$$.children("a").first().attr("href"))}};
this.getPopup=function $this$getPopup$(){return $$$$(this.getPopupElement()).view(this.resultsView)};this.hidePopup=function $this$hidePopup$(){this.getPopup().hide()};this.showPopup=function $this$showPopup$(){this.getPopup();if(!$$$$(this.getPopupElement()).is(":visible")){var $anchor$$=this.anchor?$$$$(this.anchor):null;$anchor$$||($anchor$$=($anchor$$=this.$element.data("popup-anchor"))?$$$$("#"+$anchor$$):this.$element);this.getPopup().show(this.$element.get(0),$anchor$$);this.$element.data("typeAhead").setSuggestElement(this.getPopupElement())}};
this.setAnchor=function $this$setAnchor$($node$$){this.anchor=$node$$};$protect$$.getListElement=function $$protect$$$getListElement$(){return $$$$(this.getPopupElement()).find("[data-component\x3d'list']").get(0)};$protect$$.specify=function $$protect$$$specify$($type$$,$promise$$,$params$$){this.deferreds.push($promise$$);return $promise$$.pipe(function($data$$){return{type:$type$$,params:$params$$,data:$data$$,filters:this.inputFilters?this.inputFilters:""}})};$protect$$.fieldsFor=function $$protect$$$fieldsFor$($type$$){return"content"==
$type$$?"type id author subject visibleToExternalContributors published updated question answer helpful uuid index iconCss".split(" "):"people"==$type$$?"type id name displayName thumbnailId jive.username jive.enabled jive.external".split(" "):"places"==$type$$?"type id name displayName parentPlace visibleToExternalContributors uuid index".split(" "):[]};$protect$$.loadFrequentlyViewed=function $$protect$$$loadFrequentlyViewed$(){var $promises$$=[],$view$$=this.getAvailableViews();$view$$.content&&
$promises$$.push(this.specify("content",this.activitySource.queryFrequent("content",this.fieldsFor("content"),10,this.inputFilters)));$view$$.people&&$promises$$.push(this.specify("people",this.activitySource.queryFrequent("people",this.fieldsFor("people"),10,this.inputFilters)));$view$$.places&&$promises$$.push(this.specify("places",this.activitySource.queryFrequent("places",this.fieldsFor("places"),10,this.inputFilters)));return $promises$$};$protect$$.loadBookmarks=function $$protect$$$loadBookmarks$(){var $deferred$$=
new $$$$.Deferred;this.contentSource.query({type:"favorite",author:"/people/"+_jive_current_user.ID},10).then(function($data$$){$deferred$$.resolve($data$$)});return[this.specify("content",$deferred$$)]};$protect$$.loadHistory=function $$protect$$$loadHistory$(){var $promises$$=[],$view$$=this.getAvailableViews();$view$$.content&&$promises$$.push(this.specify("content",this.activitySource.queryRecent("content",this.fieldsFor("content"),10,this.inputFilters)));$view$$.people&&$promises$$.push(this.specify("people",
this.activitySource.queryRecent("people",this.fieldsFor("people"),10,this.inputFilters)));$view$$.places&&$promises$$.push(this.specify("places",this.activitySource.queryRecent("places",this.fieldsFor("places"),10,this.inputFilters)));return $promises$$};$protect$$.executeSearch=function $$protect$$$executeSearch$(){var $promises$$=[],$searchTerm_view$$=this.getAvailableViews();$searchTerm_view$$.content&&$promises$$.push(this.performSearchQuery("content",this.fieldsFor("content"),this.inputFilters));
"filtered"!=this.getCurrentView()&&($searchTerm_view$$.people&&$promises$$.push(this.performSearchQuery("people",this.fieldsFor("people"),this.inputFilters)),$searchTerm_view$$.places&&$promises$$.push(this.performSearchQuery("places",this.fieldsFor("places"),this.inputFilters)),$searchTerm_view$$=$$$$.trim(this.getSearchTerm()),$promises$$.push(this.e14PerformFeaturedSearch(new $$$$.Deferred,$searchTerm_view$$)),$promises$$.push(this.e14PerformDesignCentreSearch(new $$$$.Deferred,$searchTerm_view$$)),
e14TrackingPixel("Search",{search_string:$searchTerm_view$$}),pfTrackEvent(!0,_jive_current_user.username,"event16","spotlightSearch",{eVar12:$searchTerm_view$$}));return $promises$$};$protect$$.executeProductSearch=function $$protect$$$executeProductSearch$(){var $promises$$=[],$searchTerm$$=$$$$.trim(this.getSearchTerm());$promises$$.push(this.e14PerformProductSearch(new $$$$.Deferred,$searchTerm$$));return $promises$$};$protect$$.e14PerformProductSearch=function $$protect$$$e14PerformProductSearch$($promise$$,
$term$$){this.e14ProductSearchResults=null;$j.ajax({url:_jive_base_url+"/__services/v2/rest/openSearch/"+e14ServerProperties.productSearchEngineSKUs+"?q\x3d"+$term$$,success:function($data$$){""!=$data$$&&0<$data$$.results.length?(e14SpotlightProductSearchResults=$j.extend({},e14ParseOpenSearchProductResults($data$$,"")),$promise$$.resolve($data$$)):""!=$data$$&&0==$data$$.results.length&&$promise$$.resolve($data$$)},failure:function($jqXHR$$,$textStatus$$){console.error($textStatus$$);$promise$$.resolve("")},
dataType:"json"});return $promise$$};$protect$$.e14PerformFeaturedSearch=function $$protect$$$e14PerformFeaturedSearch$($promise$$,$term$$){$j.ajax({url:_jive_base_url+"/view-json-featured-search-feed.jspa?feedType\x3djson\x26searchTerm\x3d"+$term$$+"\x26spotlight\x3dyes",dataType:"jsonp",type:"GET",processData:!1,async:!0}).done(function($data$$){e14SpotlightFeaturedSearchResults=$j.extend({},$data$$);$promise$$.resolve($data$$)});return $promise$$};$protect$$.e14PerformDesignCentreSearch=function $$protect$$$e14PerformDesignCentreSearch$($promise$$,
$term$$){var $request$$=$j.ajax({url:_jive_base_url+"/api/core/v3/search/contents?collapse\x3dtrue\x26filter\x3dsearch("+$term$$+"*)\x26filter\x3dplace(/places/829341)\x26filter\x3dtype(document)\x26fields\x3did,content,subject",dataType:"json",type:"GET",processData:!1,async:!0});$request$$.done(function($data$$){e14DesignCenterSearchResults=$j.extend({},$data$$);$promise$$.resolve($data$$)});$request$$.fail(function($jqxhr$$){console.log("DESIGN CENTER SEARCH FAILED !!!");console.log($jqxhr$$.responseText);
e14DesignCenterSearchResults="";$promise$$.resolve("")});return $promise$$};$protect$$.performSearchQuery=function $$protect$$$performSearchQuery$($type$$,$fields$$){var $searchTerm$$=$appendAsterisk$$($$$$.trim(this.getSearchTerm())),$filter$$={};"filtered"==this.getCurrentView()&&($filter$$[this.filterType]=this.filter,"place"==this.filterType&&$$$$.extend($filter$$,this.additionalFilters));_.extend($filter$$,$getFilterObject$$(this.inputFilters));var $queryType$$="content"==$type$$?"contents":
$type$$,$params$$1_query$$=this.searchSource.createParams($searchTerm$$,$filter$$,$fields$$,"relevanceDesc",10),$params$$1_query$$=new jive.search.SearchMetricsQuery("/api/core/v3/search/"+$queryType$$+"?"+$$$$.param($params$$1_query$$));this.metrics.addQuery($params$$1_query$$,$queryType$$);$filter$$=this.searchSource.query($queryType$$,$searchTerm$$,$filter$$,$fields$$,"relevanceDesc",10);$filter$$.then(this.processSearchResult.bind(this,$params$$1_query$$));return this.specify($type$$,$filter$$,
{searchTerm:$searchTerm$$,filterType:this.filterType,filter:this.filter})};$protect$$.processSearchResult=function $$protect$$$processSearchResult$($metricsQuery$$,$data$$){$metricsQuery$$.setReturnedDate((new Date).getTime());$metricsQuery$$.addResults($data$$.list.map($toMetricInfo$$))};this.deleteBookmark=function $this$deleteBookmark$($id$$){var $promise$$=new jive.conc.Promise;this.bookmarkSource.destroy($id$$).addCallback(function(){jive.switchboard.emit("bookmark.destroy",jQuery.extend({},
{id:$id$$}));$promise$$.emitSuccess()});return $promise$$};$protect$$.getAvailableViews=function $$protect$$$getAvailableViews$(){function $visible$$($view$$){return 0>$hidetypes$$.indexOf($view$$)}var $hidetypes$$=this.$element.data("hidetypes");return{bookmarks:$visible$$("bookmarks"),frequent:$visible$$("frequent"),recent:$visible$$("recent"),all:$visible$$("all"),filtered:this.filterType?$visible$$("filtered"):!1,content:$visible$$("content"),places:$visible$$("places"),people:$visible$$("people")}};
this.renderView=function $this$renderView$(){var $currentView$$=this.getCurrentView();if($currentView$$){var $$popupElement$$=$$$$(this.getPopupElement());$$popupElement$$.empty();$$popupElement$$.append(jive.autosearch.spotlightView({view:$currentView$$,availableViews:this.getAvailableViews(),filterDisplayName:this.displayName,communityName:this.$element.attr("data-community-name")}));this.showPopup();"bookmarks"==$currentView$$||"frequent"==$currentView$$||"recent"==$currentView$$||"all"==$currentView$$?
jive.Accessibility.speak(jive.i18n.keys.searchViewDefaultTitle(),"status"):jive.Accessibility.speak(jive.i18n.keys.searchViewSearchTitle(),"status")}else this.hidePopup()};$protect$$.startLoad=function $$protect$$$startLoad$(){var $$list$$=$$$$(this.getPopupElement());$$list$$.attr("aria-busy","true");var $$loading$$=$$list$$.find("[data-component\x3d'loadingpanel']"),$$list$$=$$list$$.find("[data-component\x3d'progressmeter']");$$loading$$.length&&($$list$$=$$loading$$.find("[data-component\x3d'progressmeter']"));
$$list$$.each(function($index$$,$item$$){$$$$($item$$).view($ProgressMeterView$$).start()})};$protect$$.endLoad=function $$protect$$$endLoad$(){var $$list$$=$$$$(this.getPopupElement());$$list$$.find("[data-component\x3d'progressmeter']").each(function($index$$,$item$$){$$$$($item$$).view($ProgressMeterView$$).stop()});$$list$$.attr("aria-busy","false")};this.loadViewContent=function $this$loadViewContent$(){for(var $currentView$$=this.getCurrentView(),$promises$$,$e14SlowerPromises$$;this.deferreds.length;)this.deferreds[0].reject(),
this.deferreds.shift();var $left$$=$j("#searchpopupanchor").parent().offset().left;$j(".jive-spotlight-search-result").parent().css("left",$left$$);this.startLoad();switch($currentView$$){case "frequent":$promises$$=this.loadFrequentlyViewed();break;case "recent":$promises$$=this.loadHistory();break;case "bookmarks":$promises$$=this.loadBookmarks();break;case "all":case "filtered":this.getSearchTerm()&&($promises$$=this.executeSearch(),$e14SlowerPromises$$=this.executeProductSearch())}if($promises$$&&
$promises$$.length){var $search$$=this,$searchTerm$$=$$$$.trim($search$$.getSearchTerm())+"*";$$$$.when.apply($$$$,$promises$$).done(function(){$search$$.processResult($currentView$$,$searchTerm$$,Array.prototype.slice.call(arguments))});$$$$.when.apply($$$$,$e14SlowerPromises$$).done(function(){$search$$.processSlowerResult($currentView$$,$searchTerm$$,Array.prototype.slice.call(arguments))})}else this.endLoad()};$protect$$.processResult=function $$protect$$$processResult$($$results_renderView$$,
$searchTerm$$,$data$$){if($$results_renderView$$==this.getCurrentView()){this.endLoad();var $views$$=this.getAvailableViews(),$filterDisplayName$$=this.displayName;"all"==$$results_renderView$$&&($filterDisplayName$$=this.$element.attr("data-community-name"));var $params$$={view:$$results_renderView$$,searchTerm:$searchTerm$$,filterType:this.filterType,filter:this.filter,filterDisplayName:$filterDisplayName$$,results:{}},$resultFilterTypes$$=this.resultFilterTypes;$data$$&&$data$$.forEach(function($result$$){$result$$&&
($result$$.data&&$result$$.data.list)&&($result$$.data.list.forEach(function($item$$){$formatResult$$($result$$.type,$item$$)}),$resultFilterTypes$$&&0<$resultFilterTypes$$.length&&($result$$.data.list=_.filter($result$$.data.list,function($item$$){return 0<=$resultFilterTypes$$.indexOf($item$$.type)})),$views$$[$result$$.type]&&($params$$.results[$result$$.type]=$result$$.data.list))});$$results_renderView$$=$$$$(jive.autosearch.results($params$$));var $$items$$=$$results_renderView$$.find("li[data-type][data-id]");
($data$$||[]).forEach(function($section$$){($section$$.data&&$section$$.data.list||[]).forEach(function($item$$){$$items$$.filter(function(){var $$item$$=$$$$(this);return $$item$$.attr("data-type")==$item$$.type&&$$item$$.attr("data-id")==$item$$.id}).data("item",$item$$)})});$$$$(this.getListElement()).empty();$j(".j-spotlight-find").prepend(e14PrepSearchResultsTable());$$$$("#e14SpotlightContentResults").append($$results_renderView$$);$j("div[data-type*\x3d'places']").detach().appendTo("#e14SpotlightPlacesResults");
$j("div[data-type*\x3d'people']").detach().appendTo("#e14SpotlightPeopleResults");$j("#pf-spotlight-featured-container").remove();"undefined"!=typeof e14SpotlightFeaturedSearchResults&&e14InjectFeaturedSearchContent("#e14SpotlightFeaturedResults",e14SpotlightFeaturedSearchResults,"true");"undefined"!=typeof e14DesignCenterSearchResults&&e14InjectDesignCenterSearchContent(e14DesignCenterSearchResults);e14FormatSpotlightResults();this.calculateResultsMaxHeight()}};$protect$$.processSlowerResult=function $$protect$$$processSlowerResult$(){$j("#pf-spotlight-products-container").remove();
"undefined"!=typeof e14SpotlightProductSearchResults&&e14InjectProductSearchContent(e14SpotlightProductSearchResults);this.calculateResultsMaxHeight()};this.setView=function $this$setView$($view$$){this.currentView=$view$$};$protect$$.change=function $$protect$$$change$(){var $currentView$$=this.getCurrentView();"all"!=$currentView$$&&"filtered"!=$currentView$$&&(this.forceFiltered?this.setView("filtered"):this.setView("all"));this.renderView();this.loadViewContent()};$protect$$.clear=function $$protect$$$clear$($search$$){var $currentView$$=
this.getCurrentView();if("all"==$currentView$$||"filtered"==$currentView$$)this.setView(null),"frequent"==this.getCurrentView()?this.renderView():"undefined"!=typeof $search$$&&$search$$.hidePopup();this.loadViewContent()};$protect$$.calculateResultsMaxHeight=function $$protect$$$calculateResultsMaxHeight$(){var $popupHeight_topPartHeight$$=this.getPopup().getOuterHeight(),$maxTotalPopoverHeight_topMargin$$=this.getPopup().getTopMargin(),$windowHeight$$=$$$$(window).height(),$$list$$=$$$$(this.getListElement());
$popupHeight_topPartHeight$$+$maxTotalPopoverHeight_topMargin$$<$windowHeight$$?this.setResultsMaxHeight("auto"):($maxTotalPopoverHeight_topMargin$$=$windowHeight$$-$maxTotalPopoverHeight_topMargin$$-10,$popupHeight_topPartHeight$$-=$$list$$.removeAttr("maxHeight").height(),this.setResultsMaxHeight($maxTotalPopoverHeight_topMargin$$-$popupHeight_topPartHeight$$))};$protect$$.setResultsMaxHeight=function $$protect$$$setResultsMaxHeight$(){$list=$$$$(this.getListElement());$list.removeAttr("maxHeight")};
this.navigateToSearchPage=function $this$navigateToSearchPage$(){var $query$$={};0<this.getSearchTerm().length&&($query$$.q=this.getSearchTerm());"filtered"==this.getCurrentView()&&($query$$[this.filterType]=this.filter,"place"==this.filterType&&$$$$.extend($query$$,this.additionalFilters));window.location=_jive_base_url+"/search.jspa?"+$$$$.param($query$$)}});$AutoSearchView$$.toString=function $$AutoSearchView$$$toString$(){return"[wrapper AutoSearchView]"};$AutoSearchView$$.getBindName=function $$AutoSearchView$$$getBindName$(){return"AutoSearchView"};
$$$$(document).ready(function(){$autosearch$$.init()});return $AutoSearchView$$});
;
goog.provide("jive.onboarding.onboardingProgress");jive.onboarding.onboardingProgress=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div id="j-onboarding-progress" class="j-onb-progress j-rc5"><div class="j-complete font-face-deco">');jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("onboarding.percent.complete"),arg0:soy.$$escapeHtml(opt_data.percentComplete),noAutoEscape:true},output);output.append("</div></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.onboarding.postHideViewTip");jive.onboarding.postHideViewTip=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-tips j-pop-main"><h4 class="font-face-deco">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("onboarding.getstarted.removed.title"),[])),"</h4><p>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("onboarding.getstarted.removed.body"),[])),"</p></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.trial.renderProgressTip");jive.trial.renderProgressTip=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.shared.soy.render({templateName:opt_data.template,data:function(){var map={};var pairs=[["nextQuestID",opt_data.nextQuestID]];for(var i=0;i<pairs.length;i+=1)map[pairs[i][0]]=pairs[i][1];return map}(),failGracefully:true},output);return opt_sb?"":output.toString()};
;
goog.provide("jive.onbStep.startStep.completedAriaLabel");jive.onbStep.startStep.completedAriaLabel=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<span class="j-508-label">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("trial.quest.completed.label.colon"),[]))," </span>");return opt_sb?"":output.toString()};
;
jive.namespace("Onboarding");define("apps/onboarding/models/onboarding_source",["jquery","underscore","apps/shared/models/rest_service","apps/shared/models/core_deferred","apps/browse/container/model/container_source"],function(e,d,b,a,c){jive.Onboarding.Source=b.extend(function(f,g){f.resourceType="container";f.init=function(h){h=h||{};g.init.call(this,h);this.RESOURCE_ENDPOINT=jive.rest.url("/onboarding");this.placeSource=new c()};this.core=a;this.initializeView=function(i){var h=this.RESOURCE_ENDPOINT;if(!i){i=new jive.conc.Promise()}return this.commonAjaxRequest(i,"GET",{url:h})};this.getStepData=function(i){var h=this.RESOURCE_ENDPOINT+"/"+i;return this.commonAjaxRequest(new jive.conc.Promise(),"GET",{url:h})};this.markStepComplete=function(i){var h=this.RESOURCE_ENDPOINT+"/"+i+"/complete",j=new jive.conc.Promise();j.addCallback(function(k){jive.switchboard.emit("onboarding.state.update",k)});return this.commonAjaxRequest(j,"POST",{url:h})};this.setOnboardingVisible=function(i){var h=this.RESOURCE_ENDPOINT+"/"+i.toString();return this.commonAjaxRequest(new jive.conc.Promise(),"POST",{url:h})};this.newUserExploreOnOwn=function(){var h=this.RESOURCE_ENDPOINT+"/exploreOnOwn";return this.commonAjaxRequest(new jive.conc.Promise(),"POST",{url:h})};this.saveLastViewedQuest=function(h){var i=this.RESOURCE_ENDPOINT+"/lastViewedQuest?q="+h;return this.commonAjaxRequest(new jive.conc.Promise(),"POST",{url:i,data:h})};this.getValueCases=function(i){var h=this.RESOURCE_ENDPOINT+"/valueGroup";return this.commonAjaxRequest(new jive.conc.Promise(),"GET",{url:h,data:i})};this.setValueCase=function(i){var h=this.RESOURCE_ENDPOINT+"/valueCase/"+i;return this.commonAjaxRequest(new jive.conc.Promise(),"POST",{url:h})};this.getSuggestedPlaces=function(m,j,r){var h=this,k,q,o,p=e.trim(j),l=false;if(j){j=j.replace(/[\'\"\?\@\*\n\.,-\/\\#!$%\^&\;:\+{}\[\]\|=\-_`~()<>]/g," ");j=e.trim(j);j=j.replace(/\s{2,}/g," ")}k=j.split(" ");q=d.flatten(d.map(m,function(s){return s.split(" ")}));o=d.without(q.concat(k),"");if(o.length>0){var n={type:["group","space"],limit:20};n.q=o.join(" OR ");var i=jive.app.url({path:"/api/core/v2"});i+="/search/places";i=e.param.querystring(i,n);h.commonAjaxRequest(new jive.conc.Promise(),"GET",{url:i}).addCallback(function(u){var t=[];if(u&&u.data&&u.data.length){l=true;t=e.map(u.data,function(v){return{readableType:v.type,id:v.id}})}if(t.length>0){var s=h.RESOURCE_ENDPOINT+"/suggestedPlaces";h.commonAjaxRequest(new jive.conc.Promise(),"POST",{url:s,data:JSON.stringify({profileData:{bio:p},entities:t})}).addCallback(function(v){var w={suggestedPlaces:v,suggestedPlacesExist:l};r.emitSuccess(w)})}else{r.emitSuccess({suggestedPlacesExist:false})}})}};this.updateUserProfile=function(n,o,k,q){var h=this,p=e.trim(k),j=h.RESOURCE_ENDPOINT+"/profile",m=new jive.conc.Promise(),l=d.map(o,function(r){return function(s){return s.jive.corev3.people.expertise.deleteExpertiseTag({personID:_jive_current_user.ID,tagName:r})}}),i=this.core.runAll([function(r){return r.jive.corev3.people.expertise.endorse(n,{personID:_jive_current_user.ID})}].concat(l));h.commonAjaxRequest(m,"POST",{url:j,data:JSON.stringify({profileData:{bio:p},entities:[]})});e.when(m,i).then(function(){q.emitSuccess()})}});return jive.Onboarding.Source});
;
goog.provide("jive.browse.grid.maxPageReached");jive.browse.grid.maxPageReached=function(opt_data,opt_sb){opt_data=opt_data||{};var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-browse-info j-empty font-color-meta">',opt_data.archetypeID?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse."+opt_data.archetypeID+".max.pages.message"),[])):"No archetype specified.","</div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.browse.user.flippable");jive.browse.user.flippable=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(!opt_data.flipperHidden&&(opt_data.connections&&opt_data.connections.followLinkShown||opt_data.directMessageActionLinkShown||opt_data.discussionActionInfo&&opt_data.discussionActionInfo.linkShown)?soy.$$filterNoAutoescape(opt_data.body):"");return opt_sb?"":output.toString()};
;
goog.provide("jive.browse.user.flippable");goog.provide("jive.browse.user.flipperControl");jive.browse.user.flippable=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(!opt_data.flipperHidden&&(opt_data.connections&&opt_data.connections.followLinkShown||opt_data.directMessageActionLinkShown||opt_data.discussionActionInfo&&opt_data.discussionActionInfo.linkShown)?soy.$$filterNoAutoescape(opt_data.body):"");return opt_sb?"":output.toString()};
jive.browse.user.flipperControl=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.browse.user.flippable(soy.$$augmentMap(opt_data,{body:'<a href="#" class="j-card-flipper j-ui-elem">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.actions"),[]))+"</a>"}),output);return opt_sb?"":output.toString()};
;
goog.provide("jive.browse.user.thumbnailUserItem");
jive.browse.user.thumbnailUserItem=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="card"><div class="j-thumb j-people-thumb j-rc4 face card-front js-browse-item ',!opt_data.enabled?"disabled":""," ");jive.browse.user.flippable(soy.$$augmentMap(opt_data.prop,{body:"flippable"}),output);output.append('" data-object-type="',soy.$$escapeHtmlAttribute(opt_data.type),'" data-object-id="',soy.$$escapeHtmlAttribute(opt_data.id),'"><header class="js-thumb-header"><h4><a href="',
soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.link))),'" title="',soy.$$escapeHtmlAttribute(opt_data.subject),'">',soy.$$escapeHtml(opt_data.subject),"</a>");if(opt_data.prop&&opt_data.prop.roleBadgeInfo)jive.shared.displayutil.userRoleBadgeImage(opt_data.prop.roleBadgeInfo,output);output.append("</h4></header><section>");jive.browse.user.userProfileImage(opt_data,output);output.append('<div class="j-user-info clearfix">');if(opt_data.prop.connections){if(!opt_data.prop.connections.bidirectional&&
opt_data.prop.connections.followerCount>=0&&opt_data.enabled){output.append('<div><span class="font-color-meta-light">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.heading.followers"),[])),"</span><br/>");if(opt_data.prop.connections.linkFollowCounts){var param41=new soy.StringBuilder;jive.shared.soy.getCountTextByType({count:soy.$$escapeHtml(opt_data.prop.connections?opt_data.prop.connections.followerCount:0),type:"showfollowcount"},param41);jive.eae.acclaim.count({command:"showFollowers",
count:opt_data.prop.connections.followerCount,objectId:opt_data.id,objectType:opt_data.type,classes:"j-user-follow-info",accessibilityLinkLabel:param41.toString()},output)}output.append("</div>")}if(opt_data.prop.connections.followingCount>=0&&opt_data.enabled){output.append('<div><span class="font-color-meta-light">',opt_data.prop.connections.bidirectional?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.friends"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.following"),
[])),"</span><br/>");if(opt_data.prop.connections.linkFollowCounts){var param64=new soy.StringBuilder;jive.shared.soy.getCountTextByType({count:soy.$$escapeHtml(opt_data.prop.connections?opt_data.prop.connections.followingCount:0),type:"showconnectioncount"},param64);jive.eae.acclaim.count({command:"showConnections",count:opt_data.prop.connections.followingCount,objectId:opt_data.id,objectType:opt_data.type,classes:"j-user-follow-info",accessibilityLinkLabel:param64.toString()},output)}output.append("</div>")}}output.append(!opt_data.enabled?
'<strong class="font-color-meta-light">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.user.deactivated"),[]))+"</strong>":"",'<div><span class="font-color-meta-light">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("profile.friends.labels.title"),[])),"</span><br/>");if(opt_data.prop.connections&&opt_data.prop.connections.labelsShown)if(opt_data.prop.connections.labelCount>4){output.append("<a href='#' class=\"js-label-count\">",soy.$$escapeHtml(opt_data.prop.connections.labelCount),
'</a><div class="js-label-details" style="display: none; padding:7px 15px;"><ul class="j-label-dot-list j-quick-menu">');var listList86=opt_data.prop.connections.friendLists;var listListLen86=listList86.length;for(var listIndex86=0;listIndex86<listListLen86;listIndex86++){var listData86=listList86[listIndex86];if(listData86.targetUserAMember)jive.browse.user.labelDot(listData86,output)}output.append("</ul></div>")}else{output.append('<ul class="j-label-dot-list j-td-user-info">');var listList94=opt_data.prop.connections.friendLists;
var listListLen94=listList94.length;for(var listIndex94=0;listIndex94<listListLen94;listIndex94++){var listData94=listList94[listIndex94];if(listData94.targetUserAMember)jive.browse.user.labelDot(listData94,output)}output.append("</ul>")}else output.append("<a href='#' class=\"js-label-count\">0</a>");output.append("</div></div>",opt_data.prop.title?' <strong class="j-user-title font-color-meta-light" title="'+soy.$$escapeHtmlAttribute(opt_data.prop.title)+'">'+soy.$$escapeHtml(opt_data.prop.title)+
"</strong>":"","</section><footer><div>");if(opt_data.columns.dateJoined||opt_data.columns.creationDate)if(opt_data.prop.membership||opt_data.creationDate){output.append('<span class="font-color-meta">');jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("browse.joined.date"),arg0:"<strong>",arg1:opt_data.prop.membership?soy.$$escapeHtml(opt_data.prop.membership.memberDate?_jive_moment(parseFloat(opt_data.prop.membership.memberDate)?parseFloat(opt_data.prop.membership.memberDate):opt_data.prop.membership.memberDate).add(_jive_timezoneoffset*
60*60*1E3).lang(_jive_locale.toLowerCase().replace("_","-")).format("LL"):""):opt_data.creationDate?soy.$$escapeHtml(opt_data.creationDate?_jive_moment(parseFloat(opt_data.creationDate)?parseFloat(opt_data.creationDate):opt_data.creationDate).add(_jive_timezoneoffset*60*60*1E3).lang(_jive_locale.toLowerCase().replace("_","-")).format("LL"):""):"",arg2:"</strong>",noAutoEscape:true},output);output.append("</span>")}if(opt_data.columns.statuslevel&&opt_data.prop.statuslevel&&opt_data.prop.statuslevel.enabled){output.append('<span class="font-color-meta">');
jive.people.profile.statusLevel(soy.$$augmentMap(opt_data.prop.statuslevel,{showPoints:true}),output);output.append("</span>")}output.append("</div></footer>");jive.browse.user.flipperControl(opt_data.prop,output);output.append("</div>");var param140=new soy.StringBuilder('<div class="j-thumb-back face card-back" aria-hidden="true"><h4 class="font-color-white">',soy.$$escapeHtml(opt_data.subject),'</h4><ul class="j-social-actions j-icon-list">');if(opt_data.prop.connections&&opt_data.prop.connections.followLinkShown){param140.append("<li>");
jive.people.profile.followLink(soy.$$augmentMap(opt_data.prop.connections,{targetUserID:opt_data.id,targetUserDisplayName:opt_data.subject,hideFollowingCount:true,darkButton:true,renderLocation:"browse",streamsAssociatedCount:opt_data.prop.connections.streamsAssociatedBean?opt_data.prop.connections.streamsAssociatedBean.streamIDs.length:0}),param140);param140.append("</li>")}param140.append(opt_data.prop.directMessageActionLinkShown?'<li><a href="#" class="js-create-direct-message j-social-action"><span><span class="jive-icon-med jive-icon-direct-message"></span>'+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.action.sendmessage"),[]))+"</span></a></li>":"",opt_data.prop.discussionActionInfo&&opt_data.prop.discussionActionInfo.linkShown?'<li><a href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.prop.discussionActionInfo.link)))+'" class="j-social-action js-link-cur-loc-param" data-cur-loc-param-name="cancelURL"><span><span class="jive-icon-med jive-icon-discussion"></span>'+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.action.startdiscussion"),[]))+"</span></a></li>":"",'</ul><a href="#" class="j-back-btn"><span class="jive-icon-glyph icon-angle-left"></span> ',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.back.button"),[])),"</a></div>");jive.browse.user.flippable(soy.$$augmentMap(opt_data.prop,{body:param140.toString()}),output);output.append("</div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.browse.container.flippable");jive.browse.container.flippable=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.followInfo&&opt_data.followInfo.showFollowControls||opt_data.shareInfo&&opt_data.shareInfo.shareable||opt_data.socialGroupInfo?soy.$$filterNoAutoescape(opt_data.body):"");return opt_sb?"":output.toString()};
;
goog.provide("jive.browse.container.cardBack");
jive.browse.container.cardBack=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;var param3=new soy.StringBuilder('<div class="j-thumb-back face card-back" aria-hidden="true"><header><h6 class="font-color-white"><img src="',soy.$$escapeHtml(jive.soy.func.resourceUrl(window._jive_base_url,"/9.0.5.998b920/","//files1.element14.com/community","/images/transparent.png")),'" alt="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("global.access.content.type."+opt_data.type)),
[])),'" class="',soy.$$escapeHtml(opt_data.iconCss),' jive-icon-med" /> ',soy.$$escapeHtml(opt_data.subject),"</h6>",opt_data.prop.parentInfo?'<p class="j-browse-content-location font-color-meta-light">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.in"),[]))+' <a href="'+soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.prop.parentInfo.link))+'" class="font-color-meta-light jivecontainerTT-hover-container" data-objectId="'+soy.$$escapeHtml(opt_data.prop.parentInfo.id)+
'" data-objectType="'+soy.$$escapeHtml(opt_data.prop.parentInfo.type)+'">'+soy.$$escapeHtml(opt_data.prop.parentInfo.subject)+"</a></p>":"","</header>",opt_data.prop.descSnippet?'<article class="font-color-meta-light j-browse-place-description"><span>'+soy.$$escapeHtml(opt_data.prop.descSnippet)+"</span></article>":"",'<ul class="j-social-actions j-icon-list">');if(opt_data.prop.followInfo&&opt_data.prop.followInfo.showFollowControls){param3.append('<li class="j-js-follow-controls" role="link" data-location="browse" data-streamsassoc="',
soy.$$escapeHtml(opt_data.prop.followInfo.streamsAssociatedBean.streamIDs.length),'" aria-live="polite" aria-atomic="true"><span class="start-follow"><a class="button j-follow-button j-social-action" href="#" data-objecttype="',soy.$$escapeHtml(opt_data.type),'" data-objectid="',soy.$$escapeHtml(opt_data.id),'" ',opt_data.prop.followInfo.followed?'style="display: none;"':"",'><span class="jive-icon-glyph icon-plus-circle2"></span>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.action.follow"),
[])),'</a></span><span class="following"><a class="button j-follow-button j-social-action" href="#" data-objecttype="',soy.$$escapeHtml(opt_data.type),'" data-objectid="',soy.$$escapeHtml(opt_data.id),'" ',!opt_data.prop.followInfo.followed?'style="display: none;"':"",'><span class="jive-icon-glyph icon-plus-circle2"></span>');jive.people.profile.followingAssociatedStreamCount({count:opt_data.prop.followInfo.streamsAssociatedBean.streamIDs.length,renderLocation:"browse"},param3);param3.append("</a></span></li>")}if(opt_data.prop.shareInfo&&
opt_data.prop.shareInfo.shareable){param3.append("<li>");jive.soy.share.control({objectId:opt_data.id,objectType:opt_data.type,type:"largeButton",icon:true,classes:"button j-social-action"},param3);param3.append("<li>")}param3.append(opt_data.prop.socialGroupInfo&&!opt_data.prop.socialGroupInfo.owner?'<li><a href="#" class="button j-social-action sgroup-join" data-objectid="'+soy.$$escapeHtml(opt_data.id)+'" '+(opt_data.prop.socialGroupInfo.member||opt_data.prop.socialGroupInfo.pendingApproval?' style="display: none;" ':
"")+'><span><span class="jive-icon-glyph icon-plus-circle2"></span>'+(opt_data.prop.socialGroupInfo.requestToJoin?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.action.reqjoingroup"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.action.joingroup"),[])))+'</span></a><a href="#" class="button j-social-action sgroup-leave" data-objectid="'+soy.$$escapeHtml(opt_data.id)+'" '+(!(opt_data.prop.socialGroupInfo.member||opt_data.prop.socialGroupInfo.pendingApproval)?' style="display: none;" ':
"")+'><span><span class="jive-icon-glyph icon-minus-circle2"></span>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.action.leavegroup"),[]))+"</span></a></li>":"",'</ul><a href="#" class="j-back-btn"><span class="jive-icon-glyph icon-angle-left"></span> ',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.back.button"),[])),"</a></div>");jive.browse.container.flippable(soy.$$augmentMap(opt_data.prop,{body:param3.toString()}),output);return opt_sb?"":output.toString()};
;
goog.provide("jive.browse.container.detailContainerHeader");
jive.browse.container.detailContainerHeader=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<thead><tr><th colspan="2"><strong class="font-color-meta-light">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.heading.place"),[])),'</strong></th><th><strong class="font-color-meta-light">',opt_data.columns&&opt_data.columns.creationDate?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.heading.creationdate"),[])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.heading.latestactivity"),
[])),'</strong></th><th class="number"><strong class="font-color-meta-light">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.heading.followers"),[])),'</strong></th><th class="j-508-label">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.heading.actions"),[])),"</th></tr></thead>");return opt_sb?"":output.toString()};
;
goog.provide("jive.browse.container.projectStatusMessage");
jive.browse.container.projectStatusMessage=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.prop.projectInfo?'<span class="font-color-meta j-proj-status-text-details">'+(opt_data.prop.projectInfo.archived?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.project.archived"),[])):opt_data.prop.projectInfo.complete?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.project.complete"),[])):opt_data.prop.projectInfo.overdue?opt_data.prop.projectInfo.years>
0?opt_data.prop.projectInfo.years==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.daysoverdue.singular"),[opt_data.prop.projectInfo.years])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.daysoverdue.plural"),[opt_data.prop.projectInfo.years])):opt_data.prop.projectInfo.months>0?opt_data.prop.projectInfo.months==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.monthsoverdue.singular"),[opt_data.prop.projectInfo.months])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.monthsoverdue.plural"),
[opt_data.prop.projectInfo.months])):opt_data.prop.projectInfo.days==1||opt_data.prop.projectInfo.days==0?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.daysoverdue.singular"),[1])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.daysoverdue.plural"),[opt_data.prop.projectInfo.days])):opt_data.prop.projectInfo.years?opt_data.prop.projectInfo.years==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.yearsremaining.singular"),[opt_data.prop.projectInfo.years])):
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.yearsremaining.plural"),[opt_data.prop.projectInfo.years])):opt_data.prop.projectInfo.months?opt_data.prop.projectInfo.months==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.monthsremaining.singular"),[opt_data.prop.projectInfo.months])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.monthsremaining.plural"),[opt_data.prop.projectInfo.months])):opt_data.prop.projectInfo.days==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.daysremaining.singular"),
[opt_data.prop.projectInfo.days])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.daysremaining.plural"),[opt_data.prop.projectInfo.days])))+"</span>":"");return opt_sb?"":output.toString()};
;
goog.provide("jive.browse.container.detailContainerItem");
jive.browse.container.detailContainerItem=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<tr class="j-place-row js-browse-item" data-object-type="',soy.$$escapeHtml(opt_data.type),'" data-object-id="',soy.$$escapeHtml(opt_data.id),'"><td class="j-td-icon"><img src="',soy.$$escapeHtml(jive.soy.func.resourceUrl(window._jive_base_url,"/9.0.5.998b920/","//files1.element14.com/community","/images/transparent.png")),'" alt="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("global.access.content.type."+
opt_data.type)),[])),'" class="',soy.$$escapeHtml(opt_data.iconCss),' jive-icon-big" /></td><td class="j-td-title"><a href="',soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.link)),'" class="jivecontainerTT-hover-container j-browse-title" data-objectId="',soy.$$escapeHtml(opt_data.id),'" data-objectType="',soy.$$escapeHtml(opt_data.type),'">',soy.$$escapeHtml(opt_data.subject),"</a>",opt_data.prop.projectInfo&&!opt_data.prop.projectInfo.archived?'<span class="font-color-meta-light j-browse-proj-status"> - <strong class="j-proj-status font-color-status-'+
soy.$$escapeHtml(opt_data.prop.projectInfo.statusKey)+'">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("project.status.type."+opt_data.prop.projectInfo.statusKey)),[]))+"</strong></span>":"");if(opt_data.prop.projectInfo&&opt_data.prop.projectInfo.archived){output.append("<span> - <strong>");jive.browse.container.projectStatusMessage(opt_data,output);output.append("</strong></span>")}output.append(opt_data.prop.socialGroupInfo&&opt_data.prop.socialGroupInfo.typeName?'<span class="font-color-meta-light j-browse-group-type"> - '+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("sgroup."+opt_data.prop.socialGroupInfo.typeName)),[]))+"</span>":"",opt_data.prop.isVisibleToPartner?'<span class="font-color-meta-light j-browse-external-access"> - <em>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("partner.browse.ext_access"),[]))+"</em></span>":"",opt_data.prop.childInfo&&opt_data.prop.childInfo.hasChildren?'<span class="font-color-meta-light j-browse-subspaces"> - <a href="#" class="j-sub-spaces j-view-children font-color-meta-light" data-activity-type="children" data-objecttype="'+
soy.$$escapeHtml(opt_data.type)+'" data-objectid="'+soy.$$escapeHtml(opt_data.id)+'">'+(opt_data.prop.childInfo.numChildren==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.subspacecount.singular"),[1])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.subspacecount.plural"),[opt_data.prop.childInfo.numChildren])))+"</a></span>":"");if(opt_data.prop.socialGroupInfo&&opt_data.prop.socialGroupInfo.numMembers){output.append('<p class="j-browse-content-location font-color-meta-light">');
var param70=new soy.StringBuilder;jive.shared.soy.getCountTextByType({count:opt_data.prop.socialGroupInfo?soy.$$escapeHtml(opt_data.prop.socialGroupInfo.numMembers):"0",type:"showmembercount"},param70);jive.eae.acclaim.count({command:"showMembers",count:opt_data.prop.socialGroupInfo?soy.$$escapeHtml(opt_data.prop.socialGroupInfo.numMembers):"0",objectId:opt_data.id,objectType:opt_data.type,text:opt_data.prop.socialGroupInfo.numMembers==1?jive.i18n.i18nText(jive.i18n.getMsg("browse.info.membercount.singular"),
[new soydata.VERY_UNSAFE.ordainSanitizedHtml("<strong>1</strong>")]):jive.i18n.i18nText(jive.i18n.getMsg("browse.info.membercount.plural"),[new soydata.VERY_UNSAFE.ordainSanitizedHtml("<strong>"+opt_data.prop.socialGroupInfo.numMembers+"</strong>")]),accessibilityLinkLabel:param70.toString()},output);output.append(opt_data.prop.isVisibleToPartner?" ("+(opt_data.prop.socialGroupInfo.numPartners==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.membercount.externalcontributors.singular"),
[1])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.membercount.externalcontributors.plural"),[opt_data.prop.socialGroupInfo.numPartners])))+")":"","</p>")}else output.append(opt_data.prop.parentInfo?'<p class="j-browse-content-location font-color-meta-light">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.in"),[]))+' <a href="'+soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.prop.parentInfo.link))+'" class="font-color-meta-light jivecontainerTT-hover-container" data-objectId="'+
soy.$$escapeHtml(opt_data.prop.parentInfo.id)+'" data-objectType="'+soy.$$escapeHtml(opt_data.prop.parentInfo.type)+'">'+soy.$$escapeHtml(opt_data.prop.parentInfo.subject)+"</a></p>":"");output.append("</td>",opt_data.columns&&opt_data.columns.creationDate?'<td class="j-td-date font-color-meta">'+soy.$$escapeHtml(opt_data.creationDate?_jive_moment(parseFloat(opt_data.creationDate)?parseFloat(opt_data.creationDate):opt_data.creationDate).add(_jive_timezoneoffset*60*60*1E3).lang(_jive_locale.toLowerCase().replace("_",
"-")).format("LLL"):"")+"</td>":'<td class="j-td-activity font-color-meta j-act">'+(opt_data.prop.latestActivity?opt_data.prop.latestActivity.creationTime&&opt_data.prop.latestActivity.creationDate?opt_data.modificationDate&&opt_data.modificationTime&&opt_data.modificationDate>opt_data.prop.latestActivity.creationDate?'<span class="font-color-meta-light">'+soy.$$escapeHtml(opt_data.modificationTime)+"</span>":'<span class="font-color-meta-light">'+soy.$$escapeHtml(opt_data.prop.latestActivity.creationTime)+
"</span>":"":"")+"</td>",'<td class="j-td-followers number font-color-meta">');if(opt_data.prop.followInfo){var param138=new soy.StringBuilder;jive.shared.soy.getCountTextByType({count:opt_data.prop.followInfo&&opt_data.prop.followInfo.numFollowers?soy.$$escapeHtml(opt_data.prop.followInfo.numFollowers):"0",type:"showfollowcount"},param138);jive.eae.acclaim.count({command:"showFollowers",count:opt_data.prop.followInfo.numFollowers?soy.$$escapeHtml(opt_data.prop.followInfo.numFollowers):"0",objectId:opt_data.id,
objectType:opt_data.type,accessibilityLinkLabel:param138.toString()},output)}output.append('</td><td class="j-td-actions">');var param149=new soy.StringBuilder('<a href="#" class="j-browse-action-button" title="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.actions"),[])),'"><span class="jive-icon-glyph icon-gear"></span><span class="jive-icon-glyph icon-arrow-down2"></span><span class="j-508-label">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.action.btn"),[])),'</span></a><div class="j-menu j-quick-menu j-js-browse-actions-container" style="display: none"><ul>');
if(opt_data.prop.followInfo&&opt_data.prop.followInfo.showFollowControls){param149.append('<li class="j-js-follow-controls" data-location="browse" data-streamsassoc="',soy.$$escapeHtml(opt_data.prop.followInfo.streamsAssociatedBean.streamIDs.length),'" aria-live="polite" aria-atomic="true"><span class="start-follow"><a href="#" class="j-follow-button lnk" data-objecttype="',soy.$$escapeHtml(opt_data.type),'" data-objectid="',soy.$$escapeHtml(opt_data.id),'"',opt_data.prop.followInfo.followed?' style="display:none" ':
"",">",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.action.follow"),[])),'</a></span><span class="following"><a href="#" class="j-follow-button lnk" data-objecttype="',soy.$$escapeHtml(opt_data.type),'" data-objectid="',soy.$$escapeHtml(opt_data.id),'"',!opt_data.prop.followInfo.followed?' style="display:none" ':"",">");jive.people.profile.followingAssociatedStreamCount({count:opt_data.prop.followInfo.streamsAssociatedBean.streamIDs.length,renderLocation:"browse"},param149);param149.append("</a></span></li>")}if(opt_data.prop.shareInfo&&
opt_data.prop.shareInfo.shareable){param149.append("<li>");jive.soy.share.control({objectId:opt_data.id,objectType:opt_data.type,type:"text"},param149);param149.append("</li>")}param149.append(opt_data.prop.socialGroupInfo&&!opt_data.prop.socialGroupInfo.owner?'<li><a href="#" class="sgroup-join j-follow-button" data-objectid="'+soy.$$escapeHtml(opt_data.id)+'"'+(opt_data.prop.socialGroupInfo.member||opt_data.prop.socialGroupInfo.pendingApproval?' style="display:none" ':"")+">"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.action.joingroup"),
[]))+'</a><a href="#" class="sgroup-leave j-follow-button" data-objectid="'+soy.$$escapeHtml(opt_data.id)+'"'+(!(opt_data.prop.socialGroupInfo.member||opt_data.prop.socialGroupInfo.pendingApproval)?' style="display:none" ':"")+">"+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.action.leavegroup"),[]))+"</a></li>":"","</ul></div>");jive.browse.container.flippable(soy.$$augmentMap(opt_data.prop,{body:param149.toString()}),output);output.append("</td>");return opt_sb?"":output.toString()};
;
goog.provide("jive.browse.container.flippable");goog.provide("jive.browse.container.flipperControl");jive.browse.container.flippable=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.followInfo&&opt_data.followInfo.showFollowControls||opt_data.shareInfo&&opt_data.shareInfo.shareable||opt_data.socialGroupInfo?soy.$$filterNoAutoescape(opt_data.body):"");return opt_sb?"":output.toString()};
jive.browse.container.flipperControl=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.browse.container.flippable(soy.$$augmentMap(opt_data,{body:'<a href="#" class="j-card-flipper j-ui-elem">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.actions"),[]))+"</a>"}),output);return opt_sb?"":output.toString()};
;
goog.provide("jive.browse.container.hierarchyContainerItem");
jive.browse.container.hierarchyContainerItem=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.prop.beforeInfo?'<li class="j-hierarchy-more" data-index-end="'+soy.$$escapeHtml(opt_data.prop.beforeInfo)+'" data-parent-objectid="'+soy.$$escapeHtml(opt_data.prop.parentInfo.id)+'" data-direction="0"><a href="#" title="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.hierarchy.loadmore.previous10"),[]))+'" ><span class="j-more-label j-rc6">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.hierarchy.loadmore"),
[]))+"</span></a></li>":"",'<li class="j-hierarchy-item" data-object-type="',soy.$$escapeHtml(opt_data.type),'" data-object-id="',soy.$$escapeHtml(opt_data.id),'">',opt_data.prop.perms.allowedToView?'<a href="'+soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.link))+'" class="j-anchor-icon jivecontainerTT-hover-container" data-objectid="'+soy.$$escapeHtml(opt_data.id)+'" data-objecttype="'+soy.$$escapeHtml(opt_data.type)+'">':"",!opt_data.omitIcon?'<span class="'+soy.$$escapeHtml(opt_data.iconCss)+
' jive-icon-med"></span>':"","<strong>",soy.$$escapeHtml(opt_data.subject),"</strong>",opt_data.prop.perms.allowedToView?"</a>":"",opt_data.prop.recursiveContentCount?' <span class="font-color-meta j-content-count">'+(opt_data.prop.recursiveContentCount.count==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.hierarchy.contentCount.singular"),[opt_data.prop.recursiveContentCount.count])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.hierarchy.contentCount.plural"),
[opt_data.prop.recursiveContentCount.count])))+"</span>":"",opt_data.prop.childInfo&&opt_data.prop.childInfo.hasTraversableChildren?'<div class="j-td-spaceactions"><a href="#" class="j-sub-spaces j-view-children" data-activity-type="children" data-objecttype="'+soy.$$escapeHtml(opt_data.type)+'" data-objectid="'+soy.$$escapeHtml(opt_data.id)+'" ><span class="j-show-children-msg"'+(opt_data.prop.childInfo.children?'style="display:none"':"")+">"+(opt_data.prop.childInfo.numTraversableChildren==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.hierarchy.viewsubspaces.singular"),
[opt_data.prop.childInfo.numTraversableChildren])):soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.hierarchy.viewsubspaces.plural"),[opt_data.prop.childInfo.numTraversableChildren])))+'</span><span class="j-hide-children-msg"'+(!opt_data.prop.childInfo.children?'style="display:none"':"")+">"+(opt_data.prop.childInfo.numTraversableChildren==1?soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.hierarchy.hidesubspaces.singular"),[opt_data.prop.childInfo.numTraversableChildren])):
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.hierarchy.hidesubspaces.plural"),[opt_data.prop.childInfo.numTraversableChildren])))+"</span></a></div>":"",'<ul class="j-hierarchy-child-holder"',opt_data.prop.childInfo.children?'data-children-loaded="true" ':' style="display:none"','><div class="j-hierarchy-child-expanded j-ui-elem"> </div>');if(opt_data.prop.childInfo&&opt_data.prop.childInfo.children){var childList84=opt_data.prop.childInfo.children;var childListLen84=childList84.length;
for(var childIndex84=0;childIndex84<childListLen84;childIndex84++){var childData84=childList84[childIndex84];jive.browse.container.hierarchyContainerItem(soy.$$augmentMap(childData84,{omitIcon:opt_data.omitIcon}),output)}}output.append("</ul></li>",opt_data.prop.afterInfo?'<li class="j-hierarchy-more" data-index-start="'+soy.$$escapeHtml(opt_data.prop.afterInfo)+'" data-parent-objectid="'+soy.$$escapeHtml(opt_data.prop.parentInfo.id)+'" data-direction="1"><a href="#" title="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.hierarchy.loadmore.next10"),
[]))+'" ><span class="j-more-label j-rc6">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.hierarchy.loadmore"),[]))+"</span></a></li>":"");return opt_sb?"":output.toString()};
;
goog.provide("jive.browse.container.thumbnailBlogItem");jive.browse.container.thumbnailBlogItem=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="card">Currently Blog containers do not have a visual representation and are not rendered in browse UI.</div>');return opt_sb?"":output.toString()};
;
goog.provide("jive.browse.container.thumbnailProjectItem");
jive.browse.container.thumbnailProjectItem=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="card"><div class="j-thumb j-place-thumb j-project-thumb j-rc4 js-browse-item face card-front ');jive.browse.container.flippable(soy.$$augmentMap(opt_data.prop,{body:"flippable"}),output);output.append('" data-object-type="',soy.$$escapeHtml(opt_data.type),'" data-object-id="',soy.$$escapeHtml(opt_data.id),'"><header class="js-thumb-header"><h4><a class="j-place-name" href="',
soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.link)),'" title="',soy.$$escapeHtml(opt_data.subject),'">',opt_data.prop.projectInfo.statusKey?'<span class="jive-icon-project-status-'+soy.$$escapeHtml(opt_data.prop.projectInfo.statusKey)+' jive-icon-med" role="img" title="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("global.access.content.type."+opt_data.type)),[]))+'"></span>':"",'<span class="js-header-text">',soy.$$escapeHtml(opt_data.subject),
'</span></a></h4></header><section><a href="',soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.link)),'" class="j-place-photo j-project-photo">',opt_data.prop.placeImage&&opt_data.prop.placeImage.urlMedium?'<img src="'+soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.prop.placeImage.urlMedium))+'" alt="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("project.form.image"),[]))+'" width="200"/>':"",'<div class="j-status-bar"><span class="font-color-meta">',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.status"),[])),' </span><span class="j-proj-status-text"><strong class="j-proj-status font-color-status-',soy.$$escapeHtml(opt_data.prop.projectInfo.statusKey),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("project.status.type."+opt_data.prop.projectInfo.statusKey)),[])),'</strong></span></div></a><div class="j-place-info clearfix ',opt_data.prop.isVisibleToPartner?"j-external":"",'">');if(opt_data.prop.followInfo){output.append('<div><span class="font-color-meta-light">',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.heading.followers"),[])),"</span><br/>");var param59=new soy.StringBuilder;jive.shared.soy.getCountTextByType({count:opt_data.prop.followInfo&&opt_data.prop.followInfo.numFollowers?soy.$$escapeHtml(opt_data.prop.followInfo.numFollowers):"0",type:"showfollowcount"},param59);jive.eae.acclaim.count({command:"showFollowers",count:opt_data.prop.followInfo.numFollowers?soy.$$escapeHtml(opt_data.prop.followInfo.numFollowers):"0",objectId:opt_data.id,
objectType:opt_data.type,accessibilityLinkLabel:param59.toString()},output);output.append("</div>")}output.append('<div><span class="font-color-meta-light">',opt_data.prop.projectInfo.overdue?'<span class="font-color-normal">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.overdue"),[]))+"</span>":soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.timeleft"),[])),"</span><br/>");if(opt_data.prop.projectInfo){output.append("<span><strong>");jive.browse.container.projectStatusMessage(opt_data,
output);output.append("</strong></span>")}output.append("</div>",opt_data.prop.isVisibleToPartner?'<div class="j-browse-external-access"><span class="font-color-meta-light">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("partner.browse.ext_access.short"),[]))+'</span><br/><span class=""><span class="jive-icon-med jive-icon-partner" title="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("partner.browse.ext_access"),[]))+'"></span></span></div>':"","</div>",opt_data.prop.descSnippet?
'<article class="font-color-meta"><span>'+soy.$$escapeHtml(opt_data.prop.descSnippet)+"</span></article>":"","</section>");jive.browse.container.flipperControl(opt_data.prop,output);output.append("</div>");jive.browse.container.cardBack(opt_data,output);output.append("</div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.browse.container.thumbnailSocialGroupItem");
jive.browse.container.thumbnailSocialGroupItem=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="card"><div class="j-thumb j-place-thumb j-group-thumb j-rc4 js-browse-item face card-front ');jive.browse.container.flippable(soy.$$augmentMap(opt_data.prop,{body:"flippable"}),output);output.append('" data-object-type="',soy.$$escapeHtml(opt_data.type),'" data-object-id="',soy.$$escapeHtml(opt_data.id),'"><header class="js-thumb-header"><h4><a class="j-place-name" href="',
soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.link)),'" title="',soy.$$escapeHtml(opt_data.subject),'"><span class="',soy.$$escapeHtml(opt_data.iconCss),' jive-icon-med" role="img" title="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("global.access.content.type."+opt_data.type)),[])),'"></span><span class="js-header-text">',soy.$$escapeHtml(opt_data.subject),'</span></a></h4></header><section><a href="',soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,
opt_data.link)),'" class="j-place-photo j-space-photo">',opt_data.prop.placeImage&&opt_data.prop.placeImage.urlMedium?'<img src="'+soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.prop.placeImage.urlMedium))+'" alt="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("sgroup.image"),[]))+'" width="200"/>':"",'</a><div class="j-place-info clearfix">');if(opt_data.prop.followInfo||opt_data.prop.socialGroupInfo||opt_data.prop.isVisibleToPartner){if(opt_data.prop.followInfo){output.append('<div><span class="font-color-meta-light">',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.heading.followers"),[])),"</span><br/>");var param47=new soy.StringBuilder;jive.shared.soy.getCountTextByType({count:opt_data.prop.followInfo&&opt_data.prop.followInfo.numFollowers?soy.$$escapeHtml(opt_data.prop.followInfo.numFollowers):"0",type:"showfollowcount"},param47);jive.eae.acclaim.count({command:"showFollowers",count:opt_data.prop.followInfo.numFollowers?soy.$$escapeHtml(opt_data.prop.followInfo.numFollowers):"0",objectId:opt_data.id,
objectType:opt_data.type,accessibilityLinkLabel:param47.toString()},output);output.append("</div>")}if(opt_data.prop.socialGroupInfo){output.append('<div><span class="font-color-meta-light">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.members.plural"),[])),"</span><br/>");var param72=new soy.StringBuilder;jive.shared.soy.getCountTextByType({count:opt_data.prop.socialGroupInfo?soy.$$escapeHtml(opt_data.prop.socialGroupInfo.numMembers):"0",type:"showmembercount"},param72);jive.eae.acclaim.count({command:"showMembers",
count:opt_data.prop.socialGroupInfo?soy.$$escapeHtml(opt_data.prop.socialGroupInfo.numMembers):"0",objectId:opt_data.id,objectType:opt_data.type,accessibilityLinkLabel:param72.toString()},output);output.append("</div>")}if(opt_data.prop.isVisibleToPartner){output.append('<div><span class="font-color-meta-light">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.members.externacontributors.singular"),[])),"</span><br/>");jive.eae.acclaim.count({command:"showExternalContributorMembers",
count:opt_data.prop.socialGroupInfo?soy.$$escapeHtml(opt_data.prop.socialGroupInfo.numPartners):"0",objectId:opt_data.id,objectType:opt_data.type},output);output.append("</div>")}}output.append('</div></section><footer><div class="j-thumb-footer clearfix">',opt_data.prop.latestActivity&&opt_data.prop.latestActivity.creationTime?'<span class="j-latest-activity font-color-meta-light">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.heading.latestactivity.colon"),[]))+" "+soy.$$escapeHtml(opt_data.prop.latestActivity.creationDate?
_jive_moment(parseFloat(opt_data.prop.latestActivity.creationDate)?parseFloat(opt_data.prop.latestActivity.creationDate):opt_data.prop.latestActivity.creationDate).add(_jive_timezoneoffset*60*60*1E3).lang(_jive_locale.toLowerCase().replace("_","-")).format("l"):"")+"</span>":"",'<ul class="j-type">',opt_data.prop.isVisibleToPartner?'<li><span class="jive-icon-med jive-icon-partner" title="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("partner.browse.ext_access"),[]))+'"></span></li>':"",
opt_data.prop.socialGroupInfo&&opt_data.prop.socialGroupInfo.typeName?'<li><span class="jive-icon-sml jive-icon-group-'+soy.$$escapeHtml(opt_data.prop.socialGroupInfo.typeName)+'-glyph" title="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("browse.info.sgroup."+opt_data.prop.socialGroupInfo.typeName)),[]))+'"></span></li>':"","</ul></div></footer>");jive.browse.container.flipperControl(opt_data.prop,output);output.append("</div>");jive.browse.container.cardBack(opt_data,
output);output.append("</div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.browse.container.thumbnailSpaceItem");
jive.browse.container.thumbnailSpaceItem=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="card"><div class="j-thumb j-place-thumb j-space-thumb j-rc4 js-browse-item face card-front ');jive.browse.container.flippable(soy.$$augmentMap(opt_data.prop,{body:"flippable"}),output);output.append('" data-object-type="',soy.$$escapeHtml(opt_data.type),'" data-object-id="',soy.$$escapeHtml(opt_data.id),'"><header class="js-thumb-header"><h4><a class="j-place-name" href="',soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,
opt_data.link)),'" title="',soy.$$escapeHtml(opt_data.subject),'"><span class="',soy.$$escapeHtml(opt_data.iconCss),' jive-icon-med" role="img" title="',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("global.access.content.type."+opt_data.type)),[])),'"></span><span class="js-header-text">',soy.$$escapeHtml(opt_data.subject),'</span></a></h4></header><section><a href="',soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.link)),'" class="j-place-photo j-space-photo">',
opt_data.prop.placeImage&&opt_data.prop.placeImage.urlMedium?'<img src="'+soy.$$escapeHtml(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.prop.placeImage.urlMedium))+'" alt="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("cmnty.form.image"),[]))+'" width="200"/>':"",'</a><div class="j-place-info clearfix"><div><span class="font-color-meta-light">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.heading.followers"),[])),"</span><br/>");var param42=new soy.StringBuilder;
jive.shared.soy.getCountTextByType({count:opt_data.prop.followInfo&&opt_data.prop.followInfo.numFollowers?soy.$$escapeHtml(opt_data.prop.followInfo.numFollowers):"0",type:"showfollowcount"},param42);jive.eae.acclaim.count({command:"showFollowers",count:opt_data.prop.followInfo&&opt_data.prop.followInfo.numFollowers?soy.$$escapeHtml(opt_data.prop.followInfo.numFollowers):"0",objectId:opt_data.id,objectType:opt_data.type,accessibilityLinkLabel:param42.toString()},output);output.append("</div>",opt_data.prop.childInfo&&
opt_data.prop.childInfo.hasChildren?'<div><span class="font-color-meta-light">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.info.subspaces.plural"),[]))+'</span><br/><a href="#" class="j-sub-spaces j-view-children" data-activity-type="children" data-objecttype="'+soy.$$escapeHtml(opt_data.type)+'" data-objectid="'+soy.$$escapeHtml(opt_data.id)+'">'+soy.$$escapeHtml(opt_data.prop.childInfo.numChildren)+"</a></div>":"","</div>",opt_data.prop.descSnippet?'<article class="font-color-meta"><span>'+
soy.$$escapeHtml(opt_data.prop.descSnippet)+"</span></article>":"","</section>");jive.browse.container.flipperControl(opt_data.prop,output);output.append("</div>");jive.browse.container.cardBack(opt_data,output);output.append("</div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.browse.content.flippable");jive.browse.content.flippable=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.followInfo&&opt_data.followInfo.showFollowControls||opt_data.shareInfo&&opt_data.shareInfo.shareable||opt_data.bookmarkInfo&&opt_data.bookmarkInfo.showBookmarkControls?soy.$$filterNoAutoescape(opt_data.body):"");return opt_sb?"":output.toString()};
;
goog.provide("jive.soy.share.removeContentPlaceLinkControl");jive.soy.share.removeContentPlaceLinkControl=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<a href="#" class="js-delete-content-place-rel button lnk" data-command="deleteContentPlaceRel" data-relationship-id="',soy.$$escapeHtmlAttribute(opt_data.contentPlaceRelationship.relationshipID),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.place.remove_link"),[])),"</a>");return opt_sb?"":output.toString()};
;
goog.provide("jive.browse.content.detailActionPanel");
jive.browse.content.detailActionPanel=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<a href="#" class="j-browse-action-button" title="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("global.actions"),[])),'"><span class="jive-icon-glyph icon-gear"></span><span class="jive-icon-glyph icon-arrow-down2"></span><span class="j-508-label">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.action.btn"),[])),'</span></a><div class="j-menu j-quick-menu j-js-browse-actions-container" style="display: none"><ul>');
if(opt_data.prop.followInfo&&opt_data.prop.followInfo.showFollowControls){output.append('<li class="j-js-follow-controls" data-location="browse" data-streamsassoc="',soy.$$escapeHtmlAttribute(opt_data.prop.followInfo.streamsAssociatedBean.streamIDs.length),'"><span class="start-follow"><a class="button j-follow-button lnk" href="#" data-objecttype="',soy.$$escapeHtmlAttribute(opt_data.type),'" data-objectid="',soy.$$escapeHtmlAttribute(opt_data.id),'" ',opt_data.prop.followInfo.followed?'style="display: none;"':
"",">",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.action.follow"),[])),'</a></span><span class="following"><a class="button j-follow-button lnk" href="#" data-objecttype="',soy.$$escapeHtmlAttribute(opt_data.type),'" data-objectid="',soy.$$escapeHtmlAttribute(opt_data.id),'" ',!opt_data.prop.followInfo.followed?'style="display: none;"':"",">");jive.people.profile.followingAssociatedStreamCount({count:opt_data.prop.followInfo.streamsAssociatedBean.streamIDs.length,renderLocation:"browse"},
output);output.append("</a></span></li>")}if(opt_data.prop.shareInfo&&opt_data.prop.shareInfo.shareable){output.append("<li>");jive.soy.share.control({objectId:opt_data.id,objectType:opt_data.type,type:"text",contentPlaceRelInfo:opt_data.contentPlaceRelInfo},output);output.append("</li>")}output.append(opt_data.prop.bookmarkInfo&&opt_data.prop.bookmarkInfo.showBookmarkControls?'<li class="js-bookmark" '+(opt_data.prop.bookmarkInfo.bookmarked?'style="display: none;"':"")+'><a class="bookmark-content lnk" data-objecttype="'+
soy.$$escapeHtmlAttribute(opt_data.type)+'" data-objectid="'+soy.$$escapeHtmlAttribute(opt_data.id)+'" href="#"><span>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.action.bookmark"),[]))+'</span></a></li><li class="js-bookmark" '+(!opt_data.prop.bookmarkInfo.bookmarked?'style="display: none;"':"")+'><a href="#" class="edit-bookmark bookmarked-content lnk" data-objecttype="'+soy.$$escapeHtmlAttribute(opt_data.type)+'" data-objectid="'+soy.$$escapeHtmlAttribute(opt_data.id)+'">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.action.editbookmark"),
[]))+'</a></li><li class="js-bookmark" '+(!opt_data.prop.bookmarkInfo.bookmarked?'style="display: none;"':"")+'><a href="#" class="unbookmark-content bookmarked-content lnk" data-objecttype="'+soy.$$escapeHtmlAttribute(opt_data.type)+'" data-objectid="'+soy.$$escapeHtmlAttribute(opt_data.id)+'" data-bookmarkid="'+soy.$$escapeHtmlAttribute(opt_data.prop.bookmarkInfo.bookmarkID)+'">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.action.removebookmark"),[]))+"</a></li>":"");if(opt_data.contentPlaceRelInfo&&
opt_data.contentPlaceRelInfo.removable){output.append('<li class="js-content-place-rel">');jive.soy.share.removeContentPlaceLinkControl({contentPlaceRelationship:opt_data.contentPlaceRelInfo},output);output.append("</li>")}output.append("</ul></ul></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.browse.bookmark.detailBookmarkedItem");
jive.browse.bookmark.detailBookmarkedItem=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append("<tr data-object-id=",soy.$$escapeHtmlAttributeNospace(opt_data.markedObjectId),' data-object-type="',soy.$$escapeHtmlAttribute(opt_data.markedObjectType),'"><td class="j-td-icon"><img src="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.resourceUrl(window._jive_base_url,"/9.0.5.998b920/","//files1.element14.com/community","/images/transparent.png"))),'" alt="" class="',
soy.$$escapeHtmlAttribute(opt_data.iconCss),' jive-icon-big" /></td><td class="j-td-title"><a href="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.link))),'" aria-label="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("global.go_to"),[])),'">',soy.$$filterNoAutoescape(opt_data.subject),opt_data.prop.privacyInfo&&opt_data.prop.privacyInfo["private"]?'<span src="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,
"/images/transparent.png")))+'" class="jive-icon-sml jive-icon-content-private'+(opt_data.prop.privacyInfo.shared?"-shared":"")+'" title="'+(opt_data.prop.privacyInfo.shared?soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("doc.visibility.restricted.tooltip"),[])):soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("doc.visibility.private.tooltip"),[])))+'" ></span>':"","</a>",opt_data.prop.isVisibleToPartner?'<span class="font-color-meta-light j-browse-external-access"> - '+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("partner.browse.ext_access"),[]))+"</span>":"","<div>",opt_data.prop.place?'<p class="j-browse-content-location font-color-meta-light">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.in"),[]))+' <a href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.prop.place.link)))+'" class="font-color-meta-light jivecontainerTT-hover-container" data-objectId="'+soy.$$escapeHtmlAttribute(opt_data.prop.place.id)+
'" data-objectType="'+soy.$$escapeHtmlAttribute(opt_data.prop.place.type)+'">'+soy.$$escapeHtml(opt_data.prop.place.subject)+"</a></p>":"",opt_data.externalURL?'<p class="j-browse-content-location font-color-meta-light"><a href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.externalURL))+'" class="font-color-meta-light" title="'+soy.$$escapeHtmlAttribute(opt_data.externalURL)+'" rel="nofollow noopener" target="_blank">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("bookmark.view.visit.site.label"),
[]))+"</a></p>":"",'</div></td><td class="j-td-author font-color-meta">');jive.shared.displayutil.userDisplayNameLink(opt_data.prop.author,output);output.append("</td>",opt_data.prop.lastActivityDate?'<td class="j-td-date font-color-meta">'+soy.$$escapeHtml(opt_data.prop.lastActivityDate?_jive_moment(parseFloat(opt_data.prop.lastActivityDate)?parseFloat(opt_data.prop.lastActivityDate):opt_data.prop.lastActivityDate).add(_jive_timezoneoffset*60*60*1E3).lang(_jive_locale.toLowerCase().replace("_","-")).format("LLL"):
"")+"</td>":'<td class="j-td-date font-color-meta">&nbsp;</td>','<td class="j-td-views center font-color-meta number"><span title="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("browse.heading.viewcount"),[])),'">',opt_data.prop.viewCount>-1?soy.$$escapeHtml(opt_data.prop.viewCount):"&nbsp;",'</span></td><td class="j-td-likes number font-color-meta"><span title="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("browse.heading.likecount"),[])),'"><span class="jive-icon-sml jive-icon-meta-like"></span>');
var param90=new soy.StringBuilder;jive.shared.soy.getCountTextByType({count:soy.$$escapeHtml(opt_data.prop.activityInfo?opt_data.prop.activityInfo.likeCount:0),type:"showlikescount"},param90);jive.eae.acclaim.count({command:"showAcclaim",count:soy.$$escapeHtml(opt_data.prop.activityInfo?opt_data.prop.activityInfo.likeCount:0),acclaimType:"like",objectId:opt_data.markedObjectId,objectType:opt_data.markedObjectType,classes:"j-meta-number",accessibilityLinkLabel:param90.toString()},output);output.append('</span></td><td class="j-td-bookmarks number font-color-meta"><span title="',
soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("browse.heading.bookmarkcount"),[])),'"><span class="jive-icon-sml jive-icon-meta-bookmark"></span>');var param105=new soy.StringBuilder;jive.shared.soy.getCountTextByType({count:soy.$$escapeHtml(opt_data.prop.activityInfo?opt_data.prop.activityInfo.bookmarkCount:0),type:"showbookmarkscount"},param105);jive.eae.acclaim.count({command:"showBookmarks",count:soy.$$escapeHtml(opt_data.prop.activityInfo?opt_data.prop.activityInfo.bookmarkCount:
0),objectId:opt_data.markedObjectId,objectType:opt_data.markedObjectType,classes:"j-meta-number",accessibilityLinkLabel:param105.toString()},output);output.append('</span></td><td class="j-td-replies center font-color-meta number"><span title="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("browse.heading.replycount"),[])),'"><img src="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.resourceUrl(window._jive_base_url,"/9.0.5.998b920/","//files1.element14.com/community",
"/images/transparent.png"))),'" alt="" class="jive-icon-sml jive-glyph-comment"/>',opt_data.prop.activityInfo?soy.$$escapeHtml(opt_data.prop.activityInfo.replyCount):"0",'</span></td><td class="j-td-actions">');var param122=new soy.StringBuilder;jive.browse.content.detailActionPanel({id:opt_data.markedObjectId,type:opt_data.markedObjectType,prop:opt_data.prop},param122);jive.browse.content.flippable(soy.$$augmentMap(opt_data.prop,{body:param122.toString()}),output);output.append("</td></tr>");return opt_sb?
"":output.toString()};
;
goog.provide("jive.browse.bookmark.detailBookmarksHeader");
jive.browse.bookmark.detailBookmarksHeader=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<thead><tr><th colspan="2"><strong class="font-color-meta-light">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.heading.content"),[])),'</strong></th><th><strong class="font-color-meta-light">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.heading.author"),[])),"</strong></th>",opt_data.yourBookmarks?"":"",'  <th><strong class="font-color-meta-light">',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.heading.bookmarkedon"),[])),'</strong></th><th class="number"><strong class="font-color-meta-light">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.heading.viewcount"),[])),'</strong></th><th class="number"><label class="j-508-label">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.heading.likecount"),[])),'"</label><span role="img" class="jive-icon-glyph icon-thumbs-up font-color-meta-light"></span></th><th class="number"><label class="j-508-label">',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.heading.bookmarkcount"),[])),'"</label><span role="img" class="jive-icon-glyph icon-bookmark2 font-color-meta-light"></span></th><th class="number"><label class="j-508-label">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.heading.replycount"),[])),'"</label><span role="img" class="jive-icon-glyph icon-reply font-color-meta-light"></span></th><th class="number"><label class="j-508-label">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.actions"),
[])),'"</label></th></tr></thead>');return opt_sb?"":output.toString()};
;
goog.provide("jive.browse.bookmark.popularBookmarkText");jive.browse.bookmark.popularBookmarkText=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-sort-meta font-color-meta js-bookmark-popular-text">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey(opt_data.popularRangeKey)),[opt_data.popularCount])),"</div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.browse.content.activityInfoBlock");
jive.browse.content.activityInfoBlock=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<ul class="j-stats"><li><span class="jive-icon-sml jive-icon-meta-like"></span>');var param15=new soy.StringBuilder;jive.shared.soy.getCountTextByType({count:opt_data.activityInfo?soy.$$escapeHtml(opt_data.activityInfo.likeCount):"0",type:"showlikescount"},param15);jive.eae.acclaim.count({command:"showAcclaim",acclaimType:"like",count:opt_data.activityInfo?soy.$$escapeHtml(opt_data.activityInfo.likeCount):
"0",objectId:opt_data.objectId,objectType:opt_data.objectType,classes:"j-meta-number",accessibilityLinkLabel:param15.toString()},output);output.append('</li><li><span class="jive-icon-sml jive-icon-meta-bookmark"></span>');var param36=new soy.StringBuilder;jive.shared.soy.getCountTextByType({count:opt_data.activityInfo?soy.$$escapeHtml(opt_data.activityInfo.bookmarkCount):"0",type:"showbookmarkscount"},param36);jive.eae.acclaim.count({command:"showBookmarks",count:opt_data.activityInfo?soy.$$escapeHtml(opt_data.activityInfo.bookmarkCount):
"0",objectId:opt_data.objectId,objectType:opt_data.objectType,classes:"j-meta-number",accessibilityLinkLabel:param36.toString()},output);output.append("</li><li>");var accessibilityLinkLabel__soy47=new soy.StringBuilder;jive.shared.soy.getCountTextByType({count:soy.$$escapeHtml(opt_data.activityInfo?opt_data.activityInfo.replyCount:0),type:"reply"},accessibilityLinkLabel__soy47);accessibilityLinkLabel__soy47=accessibilityLinkLabel__soy47.toString();output.append(accessibilityLinkLabel__soy47?'<label class="j-508-label" id="replies-'+
soy.$$escapeHtmlAttribute(opt_data.objectId)+"-"+soy.$$escapeHtmlAttribute(opt_data.objectType)+'-count-label">'+soy.$$escapeHtml(accessibilityLinkLabel__soy47)+"</label>":"",'<span class="jive-icon-sml jive-icon-meta-comment"></span><a href="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.activityInfo.objectUrl+"#comments"))),'"',accessibilityLinkLabel__soy47?'aria-labelledby="replies-'+soy.$$escapeHtmlAttribute(opt_data.objectId)+
"-"+soy.$$escapeHtmlAttribute(opt_data.objectType)+'-count-label" title="'+soy.$$escapeHtmlAttribute(accessibilityLinkLabel__soy47)+'"':"",">",opt_data.activityInfo?soy.$$escapeHtml(opt_data.activityInfo.replyCount):"0","</a></li></ul>");return opt_sb?"":output.toString()};
;
goog.provide("jive.browse.content.flippable");goog.provide("jive.browse.content.flipperControl");jive.browse.content.flippable=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.followInfo&&opt_data.followInfo.showFollowControls||opt_data.shareInfo&&opt_data.shareInfo.shareable||opt_data.bookmarkInfo&&opt_data.bookmarkInfo.showBookmarkControls?soy.$$filterNoAutoescape(opt_data.body):"");return opt_sb?"":output.toString()};
jive.browse.content.flipperControl=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;jive.browse.content.flippable(soy.$$augmentMap(opt_data,{body:'<a href="#" class="j-card-flipper j-ui-elem">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.actions"),[]))+"</a>"}),output);return opt_sb?"":output.toString()};
;
goog.provide("jive.browse.content.thumbnailActionPanel");
jive.browse.content.thumbnailActionPanel=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<ul class="j-social-actions j-icon-list" role="toolbar" aria-label="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("browse.action.label"),[])),'">');if(opt_data.prop.followInfo&&opt_data.prop.followInfo.showFollowControls){output.append('<li class="j-js-follow-controls" data-location="browse" data-streamsassoc="',soy.$$escapeHtmlAttribute(opt_data.prop.followInfo.streamsAssociatedBean.streamIDs.length),
'" aria-live="polite" aria-atomic="true"><span class="start-follow"><a class="button j-follow-button j-social-action" href="#" data-objecttype="',soy.$$escapeHtmlAttribute(opt_data.prop.followInfo.objectType),'" data-objectid="',soy.$$escapeHtmlAttribute(opt_data.prop.followInfo.objectID),'" ',opt_data.prop.followInfo.followed?'style="display: none;"':"",'><span class="jive-icon-glyph icon-plus-circle2"></span>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.action.follow"),[])),'</a></span><span class="following"><a class="button j-follow-button j-social-action" href="#" data-objecttype="',
soy.$$escapeHtmlAttribute(opt_data.prop.followInfo.objectType),'" data-objectid="',soy.$$escapeHtmlAttribute(opt_data.prop.followInfo.objectID),'" ',!opt_data.prop.followInfo.followed?'style="display: none;"':"",'><span class="jive-icon-glyph icon-plus-circle2"></span>');jive.people.profile.followingAssociatedStreamCount({count:opt_data.prop.followInfo.streamsAssociatedBean.streamIDs.length,renderLocation:"browse"},output);output.append("</a></span></li>")}if(opt_data.prop.shareInfo&&opt_data.prop.shareInfo.shareable){output.append("<li>");
jive.soy.share.control({objectId:opt_data.id,objectType:opt_data.type,type:"text",icon:true,classes:"j-social-action"},output);output.append("</li>")}output.append(opt_data.prop.bookmarkInfo&&opt_data.prop.bookmarkInfo.showBookmarkControls?'<li class="js-bookmark"><a class="bookmark-content j-social-action" data-objecttype="'+soy.$$escapeHtmlAttribute(opt_data.type)+'" data-objectid="'+soy.$$escapeHtmlAttribute(opt_data.id)+'" href="#" '+(opt_data.prop.bookmarkInfo.bookmarked?'style="display: none;"':
"")+'><span><span class="jive-icon-glyph icon-bookmark"></span>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.action.bookmark"),[]))+'</span></a><a class="bookmarked-content j-social-action" data-objecttype="'+soy.$$escapeHtmlAttribute(opt_data.type)+'" data-objectid="'+soy.$$escapeHtmlAttribute(opt_data.id)+'" href="#" '+(!opt_data.prop.bookmarkInfo.bookmarked?'style="display: none;"':"")+'><span><span class="jive-icon-glyph icon-bookmark"></span>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.action.unbookmark"),
[]))+'</span></a><div class="js-bookmark-actions j-menu j-quick-menu" style="display: none;"><ul><li><a href="#" class="edit-bookmark lnk" data-objecttype="'+soy.$$escapeHtmlAttribute(opt_data.type)+'" data-objectid="'+soy.$$escapeHtmlAttribute(opt_data.id)+'">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.edit"),[]))+'</a></li><li><a href="#" class="unbookmark-content lnk" data-objecttype="'+soy.$$escapeHtmlAttribute(opt_data.type)+'" data-objectid="'+soy.$$escapeHtmlAttribute(opt_data.id)+
'" data-bookmarkid="'+soy.$$escapeHtmlAttribute(opt_data.prop.bookmarkInfo.bookmarkID)+'">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.remove"),[]))+"</a></li></ul></div></li>":"","</ul>");return opt_sb?"":output.toString()};
;
goog.provide("jive.browse.bookmark.thumbnailBookmarkedItem");
jive.browse.bookmark.thumbnailBookmarkedItem=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="card j-small-card" role="article" aria-labelledby="bookmark-subject-',soy.$$escapeHtmlAttribute(opt_data.id),'" ',opt_data.prop.bodysnippet?'aria-describedby="bookmark-notes-'+soy.$$escapeHtmlAttribute(opt_data.id)+'"':"",'><div class="j-content-thumb j-bookmarked-thumb ',opt_data.yourBookmarks?"j-your-bookmark-thumb":""," j-thumb js-browse-item face card-front ");
jive.browse.content.flippable(soy.$$augmentMap(opt_data.prop,{body:"flippable"}),output);output.append('" data-object-type="',soy.$$escapeHtmlAttribute(opt_data.type),'" data-object-id="',soy.$$escapeHtmlAttribute(opt_data.id),'"><header class="js-thumb-header"><h4><label class="j-508-label" id="bookmar-item-',soy.$$escapeHtmlAttribute(opt_data.id),'">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("global.access.content.type."+opt_data.markedObjectType)),[]))," ",soy.$$filterNoAutoescape(opt_data.subject),
'</label><a href="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.link))),'" title="',soy.$$filterNoAutoescape(opt_data.subject),'" aria-labelledby="bookmar-item-',soy.$$escapeHtmlAttribute(opt_data.id),'"><span title="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("global.access.content.type."+opt_data.markedObjectType)),[])),'" class="jive-icon-med ',soy.$$escapeHtmlAttribute(opt_data.iconCss),
'" role="img"></span><span class="js-header-text j-header-text" id="bookmark-subject-',soy.$$escapeHtmlAttribute(opt_data.id),'">',soy.$$filterNoAutoescape(opt_data.subject),"</span></a></h4></header><section>",opt_data.externalURL?'<p class="j-bookmarked-link"><span class="jive-icon-sml jive-icon-link2"></span><a href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(opt_data.externalURL))+'" title="'+soy.$$escapeHtmlAttribute(opt_data.externalURL)+'" rel="nofollow noopener" target="_blank">'+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("bookmark.view.visit.site.label"),[]))+"</a></p>":"",opt_data.yourBookmarks?'<p id="bookmark-notes-'+soy.$$escapeHtmlAttribute(opt_data.id)+'"><span class="jive-icon-sml jive-glyph-notes" role="img" title="'+soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("bookmarks.create.notes.label"),[]))+'"></span>'+(opt_data.prop.bodysnippet?soy.$$filterNoAutoescape(opt_data.prop.bodysnippet):'<em class="font-color-meta-light">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.bookmarks.nonotes"),
[]))+"</em>")+"</p>":'<article id="bookmark-notes-'+soy.$$escapeHtmlAttribute(opt_data.id)+'">'+(opt_data.prop.bodysnippet?soy.$$filterNoAutoescape(opt_data.prop.bodysnippet):"")+"</article>");if(opt_data.prop.bookmarkTags&&opt_data.prop.bookmarkTags.tags&&opt_data.prop.bookmarkTags.tags.length>0){output.append('<p><span class="jive-icon-sml jive-icon-tag"></span>');var tagEntryList83=opt_data.prop.bookmarkTags.tags;var tagEntryListLen83=tagEntryList83.length;for(var tagEntryIndex83=0;tagEntryIndex83<
tagEntryListLen83;tagEntryIndex83++){var tagEntryData83=tagEntryList83[tagEntryIndex83];output.append('<a href="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/tags#/?tags="+tagEntryData83.tag))),'" title="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("tag.link.content.tagged.tooltip"),[tagEntryData83.tag])),'">',tagEntryData83.abbreviatedTag?soy.$$escapeHtml(tagEntryData83.abbreviatedTag):soy.$$escapeHtml(tagEntryData83.tag),
"</a>",!(tagEntryIndex83==tagEntryListLen83-1)?", ":"")}output.append(opt_data.prop.bookmarkTags.tagsRemaining>0?opt_data.yourBookmarks&&opt_data.canEdit?' (<a href="#" class="edit-bookmark" data-objecttype="'+soy.$$escapeHtmlAttribute(opt_data.markedObjectType)+'" data-objectid="'+soy.$$escapeHtmlAttribute(opt_data.markedObjectId)+'">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.bookmarks.more.tags"),[opt_data.prop.bookmarkTags.tagsRemaining]))+"</a>)":"":"","</p>")}output.append(opt_data.yourBookmarks&&
opt_data.canEdit?'<p><span class="jive-icon-sml jive-glyph-edit"></span><a href="#" role="button" class="edit-bookmark" data-objecttype="'+soy.$$escapeHtmlAttribute(opt_data.markedObjectType)+'" data-objectid="'+soy.$$escapeHtmlAttribute(opt_data.markedObjectId)+'">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.bookmarks.edit"),[]))+"</a></p>":"","</section><footer>");if(!opt_data.popularBookmarks&&!opt_data.yourBookmarks){output.append('<div class="j-sort-meta font-color-meta j-author-block" ><span class="j-avatar-container">');
jive.shared.displayutil.avatar(soy.$$augmentMap(opt_data.prop.creator,{size:24}),output);output.append('</span><div class="j-author-info font-color-meta">');var param131=new soy.StringBuilder('<span class="j-line2">');jive.shared.displayutil.userDisplayNameLink(opt_data.prop.creator,param131);param131.append("</span>");jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("browse.bookmarks.date_x_by_author"),arg0:soy.$$escapeHtml(new soydata.VERY_UNSAFE.ordainSanitizedHtml("<strong>"+opt_data.creationTime+
"</strong>")),arg1:param131.toString(),noAutoEscape:"true"},output);output.append("</div></div>")}if(opt_data.popularBookmarks)jive.browse.bookmark.popularBookmarkText(opt_data,output);output.append(opt_data.yourBookmarks?"":"",'<div class="j-thumb-footer" data-object-id="',soy.$$escapeHtmlAttribute(opt_data.markedObjectId),'" data-object-type="',soy.$$escapeHtmlAttribute(opt_data.markedObjectType),'">');jive.browse.content.activityInfoBlock(soy.$$augmentMap(opt_data.prop,{objectId:opt_data.markedObjectId,
objectType:opt_data.markedObjectType,displaySharedContentCue:opt_data.prop.isVisibleToPartner}),output);output.append('<span class="j-thumb-title-meta">',opt_data.prop.privacyInfo&&opt_data.prop.privacyInfo["private"]?'<span src="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/images/transparent.png")))+'" class="jive-icon-sml jive-icon-content-private'+(opt_data.prop.privacyInfo.shared?"-shared":"")+'" title="'+(opt_data.prop.privacyInfo.shared?
soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("doc.visibility.restricted.tooltip"),[])):soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("doc.visibility.private.tooltip"),[])))+'" ></span>':"",opt_data.prop.attachmentInfo&&opt_data.prop.attachmentInfo.hasAttachments?'<span class="jive-icon-sml jive-icon-content-attachment"></span>':"","</span></div></footer>");jive.browse.content.flipperControl(opt_data.prop,output);output.append('</div><div class="j-thumb-back face card-back j-thumb-back-small" aria-hidden="true"><header><h6 class="font-color-white"><label class="j-508-label" aria-hidden="true">',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.access.content.type."+opt_data.type),[]))," ",soy.$$filterNoAutoescape(opt_data.subject),'</label><span class="jive-icon-med ',soy.$$escapeHtmlAttribute(opt_data.iconCss),'"></span>',soy.$$filterNoAutoescape(opt_data.subject),"</h6></header>");jive.browse.content.thumbnailActionPanel({id:opt_data.markedObjectId,type:opt_data.markedObjectType,prop:opt_data.prop},output);output.append('<a href="#" class="j-back-btn j-ui-elem"><span class="j-ui-elem">',
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.back.button"),[])),"</span></a></div></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.browse.grid.thumbGrid");
jive.browse.grid.thumbGrid=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<ul class="temp j-browse-thumbnails j-thumb-view">');var itemList4=opt_data.items;var itemListLen4=itemList4.length;if(itemListLen4>0)for(var itemIndex4=0;itemIndex4<itemListLen4;itemIndex4++){var itemData4=itemList4[itemIndex4];output.append('<li class="js-browse-thumbnail" data-object-type="',soy.$$escapeHtml(itemData4.type),'" data-object-id="',soy.$$escapeHtml(itemData4.id),'">');if(opt_data.browseViewID)jive.shared.soy.render({templateName:itemData4.thumbnailTemplate,
data:jQuery.extend({},itemData4,function(){var map={};var pairs=[["browseViewID",opt_data.browseViewID],["columns",opt_data.itemGridDetailsColumns]];for(var i=0;i<pairs.length;i+=1)map[pairs[i][0]]=pairs[i][1];return map}()),failGracefully:false},output);else jive.shared.soy.render({templateName:itemData4.thumbnailTemplate,data:itemData4,failGracefully:false},output);output.append("</li>")}else output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.noresults"),[])));output.append("</ul>");
return opt_sb?"":output.toString()};
;
goog.provide("jive.browse.grid.hierarchyItems");
jive.browse.grid.hierarchyItems=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;var itemList3=opt_data.items;var itemListLen3=itemList3.length;if(itemListLen3>0)for(var itemIndex3=0;itemIndex3<itemListLen3;itemIndex3++){var itemData3=itemList3[itemIndex3];jive.browse.container.hierarchyContainerItem(soy.$$augmentMap(itemData3,{omitIcon:opt_data.omitIcons}),output)}else output.append("<li>",soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.noresults"),[])),"</li>");return opt_sb?
"":output.toString()};
;
goog.provide("jive.browse.grid.hierarchyView");jive.browse.grid.hierarchyView=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-browse-details"><ul class="j-browse-hierarchy">');jive.browse.grid.hierarchyItems(opt_data,output);output.append("</ul></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.shared.displayutil.renderAttachmentLink");
jive.shared.displayutil.renderAttachmentLink=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.object.meta&&opt_data.object.meta.length>0&&opt_data.object.meta[0].fullImageUrl?'<a href="'+soy.$$escapeHtml(opt_data.object.meta[0].fullImageUrl)+'" class="jive-icon-med jive-icon-photo" title="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("profile.update.status.image"),[]))+'" aria-label="'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("profile.update.status.image"),[]))+
'"></a>':"");return opt_sb?"":output.toString()};
;
goog.provide("jive.browse.user.detailUserItem");
jive.browse.user.detailUserItem=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<tr class="js-browse-row j-people-row ',!opt_data.enabled?"disabled":"",'" data-object-id="',soy.$$escapeHtmlAttribute(opt_data.id),'"  data-object-type="',soy.$$escapeHtmlAttribute(opt_data.type),'"><td class="j-td-avatar ',opt_data.currentUserPartner?"SPECIAL":"",'">');jive.shared.displayutil.avatar(soy.$$augmentMap(opt_data,{size:32,currentUserPartner:opt_data.currentUserPartner,hidePartnerBadge:true}),
output);output.append('</td><td class="j-td-user-info">');jive.shared.displayutil.userDisplayNameLink(opt_data,output);output.append(" ",!opt_data.enabled?' <span class="font-color-meta-light">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.user.deactivated.parens"),[]))+"</span>":"");if(opt_data.prop.isVisibleToPartner)output.append('<p class="font-color-meta-light j-browse-external-access"><em>',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("partner.browse.external.contributor"),
[])),"</em></p>");else if(opt_data.prop.roleBadgeInfo)jive.shared.displayutil.userRoleBadgeImage(opt_data.prop.roleBadgeInfo,output);if(opt_data.prop.connections&&opt_data.prop.connections.labelsShown){output.append('<ul class="j-label-dot-list">');var listList38=opt_data.prop.connections.friendLists;var listListLen38=listList38.length;for(var listIndex38=0;listIndex38<listListLen38;listIndex38++){var listData38=listList38[listIndex38];if(listData38.targetUserAMember)jive.browse.user.labelDot(listData38,
output)}output.append("</ul>")}output.append("</td>",opt_data.columns.latestActivity?'<td class="j-td-activity font-color-meta j-act">'+(opt_data.prop.latestActivity?opt_data.prop.latestActivity.creationTime?' <span class="font-color-meta-light">'+soy.$$escapeHtml(opt_data.prop.latestActivity.creationTime)+"</span> ":"":"&nbsp;")+"</td>":"");if(opt_data.columns.statuslevel){output.append('<td class="j-td-statuslevel font-color-meta">');if(opt_data.prop.statuslevel&&opt_data.prop.statuslevel.enabled)jive.people.profile.statusLevel(soy.$$augmentMap(opt_data.prop.statuslevel,
{showPoints:true}),output);else output.append("&nbsp;");output.append("</td>")}output.append(opt_data.columns.dateJoined?'<td class="j-td-date font-color-meta">'+(opt_data.prop.membership?soy.$$escapeHtml(opt_data.prop.membership.memberDate?_jive_moment(parseFloat(opt_data.prop.membership.memberDate)?parseFloat(opt_data.prop.membership.memberDate):opt_data.prop.membership.memberDate).add(_jive_timezoneoffset*60*60*1E3).lang(_jive_locale.toLowerCase().replace("_","-")).format("LLL"):""):opt_data.creationDate?
soy.$$escapeHtml(opt_data.creationDate?_jive_moment(parseFloat(opt_data.creationDate)?parseFloat(opt_data.creationDate):opt_data.creationDate).add(_jive_timezoneoffset*60*60*1E3).lang(_jive_locale.toLowerCase().replace("_","-")).format("LLL"):""):"")+"</td>":"");if(opt_data.prop.connections){if(!opt_data.prop.connections.bidirectional){output.append('<td class="j-td-followers number font-color-meta">');if(!opt_data.prop.connections.bidirectional&&opt_data.prop.connections.followerCount>=0&&opt_data.enabled&&
opt_data.prop.connections.linkFollowCounts){var param90=new soy.StringBuilder;jive.shared.soy.getCountTextByType({count:soy.$$escapeHtml(opt_data.prop.connections?opt_data.prop.connections.followerCount:0),type:"showfollowcount"},param90);jive.eae.acclaim.count({command:"showFollowers",count:soy.$$escapeHtml(opt_data.prop.connections?opt_data.prop.connections.followerCount:0),objectId:opt_data.id,objectType:opt_data.type,classes:"j-user-follow-info",accessibilityLinkLabel:param90.toString()},output)}else output.append("&nbsp;");
output.append("</td>")}output.append('<td class="j-td-following number font-color-meta">');if(opt_data.prop.connections.followingCount>=0&&opt_data.enabled&&opt_data.prop.connections.linkFollowCounts){var param108=new soy.StringBuilder;jive.shared.soy.getCountTextByType({count:soy.$$escapeHtml(opt_data.prop.connections?opt_data.prop.connections.followingCount:0),type:"showconnectioncount"},param108);jive.eae.acclaim.count({command:"showConnections",count:soy.$$escapeHtml(opt_data.prop.connections?
opt_data.prop.connections.followingCount:0),objectId:opt_data.id,objectType:opt_data.type,classes:"j-user-follow-info",accessibilityLinkLabel:param108.toString()},output)}else output.append("&nbsp;");output.append("</td>")}output.append('<td class="j-td-actions">');if(opt_data.prop.connections&&opt_data.prop.connections.followLinkShown)jive.people.profile.followLink(soy.$$augmentMap(opt_data.prop.connections,{targetUserID:opt_data.id,targetUserDisplayName:opt_data.subject,hideFollowingCount:true,
renderLocation:"browse",streamsAssociatedCount:opt_data.prop.connections.streamsAssociatedBean?opt_data.prop.connections.streamsAssociatedBean.streamIDs.length:0}),output);output.append(opt_data.prop.directMessageActionLinkShown||opt_data.prop.discussionActionInfo&&opt_data.prop.discussionActionInfo.linkShown?'<a href="#" class="j-browse-action-button j-btn-global j-btn-small" title="'+soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("global.actions"),[]))+'"><span class="jive-icon-glyph icon-gear"></span><span class="jive-icon-glyph icon-arrow-down2"></span><span class="j-508-label">'+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.action.btn"),[]))+"</span></a>":"",'<div class="j-menu j-action-popover j-js-browse-actions-container" style="display: none"><ul>',opt_data.prop.directMessageActionLinkShown?'<li><a href="#" class="j-js-create-direct-message lnk" onclick="require([\'apps/direct_messaging/factory\'], function(DirectMessaging) {DirectMessaging.sendMessageToUserIds(['+soy.$$escapeHtmlAttribute(soy.$$escapeJsValue(opt_data.id))+']);});return false;"><span>'+
soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.action.sendmessage"),[]))+"</span></a></li>":"",opt_data.prop.discussionActionInfo&&opt_data.prop.discussionActionInfo.linkShown?'<li><a href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.prop.discussionActionInfo.link)))+'" class="js-link-cur-loc-param lnk" data-cur-loc-param-name="cancelURL"><span>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.action.startdiscussion"),
[]))+"</span></a></li>":"","</ul></div></td></tr>");return opt_sb?"":output.toString()};
;
goog.provide("jive.browse.contentplacerel.detailContentItem");
jive.browse.contentplacerel.detailContentItem=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.prop.contentPlaceRelationship.referencedObject){output.append('<tr class="js-browse-item" data-object-id=',soy.$$escapeHtmlAttributeNospace(opt_data.id),' data-object-type="',soy.$$escapeHtmlAttribute(opt_data.type),'"><td class="j-td-icon"><img src="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.resourceUrl(window._jive_base_url,"/9.0.5.998b920/","//files1.element14.com/community",
"/images/transparent.png"))),'" alt="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg(jive.i18n.getMinKey("global.access.content.type."+opt_data.prop.contentPlaceRelationship.referencedObject.type)),[])),'" class="',soy.$$escapeHtmlAttribute(opt_data.prop.contentPlaceRelationship.referencedObject.iconCss),' jive-icon-big" /></td><td class="j-td-title"><div><a href="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.prop.contentPlaceRelationship.referencedObject.link))),
'" aria-label="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("global.go_to"),[])),'">',opt_data.prop.contentPlaceRelationship.referencedObject.hasUnreadReplies?"<strong>":"",soy.$$filterNoAutoescape(opt_data.prop.contentPlaceRelationship.referencedObject.subject),opt_data.prop.contentPlaceRelationship.referencedObject.hasUnreadReplies?"</strong>":"",opt_data.prop.contentPlaceRelationship.referencedObject.privacyInfo&&opt_data.prop.contentPlaceRelationship.referencedObject.privacyInfo["private"]?
'<span src="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,"/images/transparent.png")))+'" class="jive-icon-sml jive-icon-content-private'+(opt_data.prop.contentPlaceRelationship.referencedObject.privacyInfo.shared?"-shared":"")+'" title="'+(opt_data.prop.contentPlaceRelationship.referencedObject.privacyInfo.shared?soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("doc.visibility.restricted.tooltip"),[])):soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("doc.visibility.private.tooltip"),
[])))+'" ></span>':"","</a>",opt_data.prop.isVisibleToPartner?'<span class="font-color-meta-light j-browse-external-access"> - <em>'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("partner.browse.ext_access"),[]))+"</em></span>":"",'<p class="j-browse-content-location font-color-meta-light">');var param52=new soy.StringBuilder;jive.shared.displayutil.userDisplayNameLink(opt_data.prop.author,param52);jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("share.place.author.byline.no.place"),arg0:param52.toString(),
noAutoEscape:true},output);output.append('</p><p class="j-browse-content-location font-color-meta-light">');if(opt_data.prop.contentPlaceRelationship.referencedObject.prop.place)if(!(opt_data.prop.contentPlaceRelationship.referencedObject.prop.place.type==2020||opt_data.prop.contentPlaceRelationship.referencedObject.prop.place.type==37&&opt_data.prop.contentPlaceRelationship.referencedObject.prop.author))jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("share.place.original.place.from"),arg0:'<a href="'+
soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.prop.contentPlaceRelationship.referencedObject.prop.place.link)))+'" class="font-color-meta-light jivecontainerTT-hover-container" data-objectId="'+soy.$$escapeHtmlAttribute(opt_data.prop.contentPlaceRelationship.referencedObject.prop.place.id)+'" data-objectType="'+soy.$$escapeHtmlAttribute(opt_data.prop.contentPlaceRelationship.referencedObject.prop.place.type)+'">'+soy.$$escapeHtml(opt_data.prop.contentPlaceRelationship.referencedObject.prop.place.subject)+
"</a>",noAutoEscape:true},output);else{if(opt_data.prop.contentPlaceRelationship.referencedObject.prop.place.type==2020&&!opt_data.prop.contentPlaceRelationship.canViewReferencedObject)output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.place.original.place.no_access"),[])))}else output.append(soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("share.place.original.place.no_access"),[])));output.append('</p></div></td><td class="j-td-author">');if(opt_data.prop.contentPlaceRelationship.referencedObject.prop.author)if(!opt_data.prop.contentPlaceRelationship.referencedObject.prop.isOriginalAuthor){var param86=
new soy.StringBuilder;jive.shared.displayutil.userDisplayNameLink(opt_data.prop.contentPlaceRelationship.referencedObject.prop.author,param86);jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("browse.heading.lastmodifiedby"),arg0:param86.toString(),noAutoEscape:"true"},output)}else jive.shared.displayutil.userDisplayNameLink(opt_data.prop.contentPlaceRelationship.referencedObject.prop.author,output);output.append("</td>");if(opt_data.columns&&opt_data.columns.creationDate)output.append('<td class="j-td-date font-color-meta">',
soy.$$escapeHtml(opt_data.prop.contentPlaceRelationship.referencedObject.creationDate?_jive_moment(parseFloat(opt_data.prop.contentPlaceRelationship.referencedObject.creationDate)?parseFloat(opt_data.prop.contentPlaceRelationship.referencedObject.creationDate):opt_data.prop.contentPlaceRelationship.referencedObject.creationDate).add(_jive_timezoneoffset*60*60*1E3).lang(_jive_locale.toLowerCase().replace("_","-")).format("LLL"):""),"</td>");else if(opt_data.prop.lastActivityDate){output.append('<td class="j-td-date font-color-meta">',
soy.$$escapeHtml(opt_data.prop.contentPlaceRelationship.referencedObject.prop.lastActivityDate?_jive_moment(parseFloat(opt_data.prop.contentPlaceRelationship.referencedObject.prop.lastActivityDate)?parseFloat(opt_data.prop.contentPlaceRelationship.referencedObject.prop.lastActivityDate):opt_data.prop.contentPlaceRelationship.referencedObject.prop.lastActivityDate).add(_jive_timezoneoffset*60*60*1E3).lang(_jive_locale.toLowerCase().replace("_","-")).format("LLL"):"")," ");if(opt_data.prop.contentPlaceRelationship.referencedObject.prop.author){output.append('<span class="font-color-meta-light" style="display: none">');
var param108=new soy.StringBuilder;jive.shared.displayutil.userDisplayNameLink(opt_data.prop.contentPlaceRelationship.referencedObject.prop.author,param108);jive.shared.soy.i18nHelper({i18nKey:soy.$$escapeHtml("global.by_author"),arg0:param108.toString(),noAutoEscape:"true"},output);output.append("</span>")}output.append("</td>")}else output.append("<td></td>");output.append('<td class="j-td-views number font-color-meta"><span title="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("browse.heading.viewcount"),
[])),'">',opt_data.prop.contentPlaceRelationship.referencedObject.prop.viewCount&&opt_data.prop.contentPlaceRelationship.referencedObject.prop.viewCount>-1?soy.$$escapeHtml(opt_data.prop.contentPlaceRelationship.referencedObject.prop.viewCount):"&nbsp;",'</span></td><td class="j-td-likes number font-color-meta"><span title="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("browse.heading.likecount"),[])),'"><span class="jive-icon-sml jive-icon-meta-like"></span>');if(!opt_data.prop.contentPlaceRelationship.referencedObject.prop.activityInfo.canView)output.append(soy.$$escapeHtml(opt_data.prop.contentPlaceRelationship.referencedObject.prop.activityInfo.likeCount));
else{var param139=new soy.StringBuilder;jive.shared.soy.getCountTextByType({count:soy.$$escapeHtml(opt_data.prop.contentPlaceRelationship.referencedObject.prop.activityInfo?opt_data.prop.contentPlaceRelationship.referencedObject.prop.activityInfo.likeCount:0),type:"showlikescount"},param139);jive.eae.acclaim.count({command:"showAcclaim",acclaimType:"like",count:soy.$$escapeHtml(opt_data.prop.contentPlaceRelationship.referencedObject.prop.activityInfo?opt_data.prop.contentPlaceRelationship.referencedObject.prop.activityInfo.likeCount:
0),objectId:opt_data.prop.contentPlaceRelationship.referencedObject.id,objectType:opt_data.prop.contentPlaceRelationship.referencedObject.type,classes:"j-meta-number",accessibilityLinkLabel:param139.toString()},output)}output.append('</span></td><td class="j-td-bookmarks number font-color-meta"><span title="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("browse.heading.bookmarkcount"),[])),'"><span class="jive-icon-sml jive-icon-meta-bookmark"></span>');if(!opt_data.prop.contentPlaceRelationship.referencedObject.prop.activityInfo.canView)output.append(soy.$$escapeHtml(opt_data.prop.contentPlaceRelationship.referencedObject.prop.activityInfo.bookmarkCount));
else{var param158=new soy.StringBuilder;jive.shared.soy.getCountTextByType({count:soy.$$escapeHtml(opt_data.prop.contentPlaceRelationship.referencedObject.prop.activityInfo?opt_data.prop.contentPlaceRelationship.referencedObject.prop.activityInfo.bookmarkCount:0),type:"showbookmarkscount"},param158);jive.eae.acclaim.count({command:"showBookmarks",count:soy.$$escapeHtml(opt_data.prop.contentPlaceRelationship.referencedObject.prop.activityInfo?opt_data.prop.contentPlaceRelationship.referencedObject.prop.activityInfo.bookmarkCount:
0),objectId:opt_data.prop.contentPlaceRelationship.referencedObject.id,objectType:opt_data.prop.contentPlaceRelationship.referencedObject.type,classes:"j-meta-number",accessibilityLinkLabel:param158.toString()},output)}output.append('</span></td><td class="j-td-replies number font-color-meta">');var accessibilityLinkLabel__soy165=new soy.StringBuilder;jive.shared.soy.getCountTextByType({count:soy.$$escapeHtml(opt_data.prop.contentPlaceRelationship.referencedObject.prop.activityInfo?opt_data.prop.contentPlaceRelationship.referencedObject.prop.activityInfo.replyCount:
0),type:"reply"},accessibilityLinkLabel__soy165);accessibilityLinkLabel__soy165=accessibilityLinkLabel__soy165.toString();output.append(accessibilityLinkLabel__soy165?'<label class="j-508-label" id="replies-'+soy.$$escapeHtmlAttribute(opt_data.prop.contentPlaceRelationship.referencedObject.id)+"-"+soy.$$escapeHtmlAttribute(opt_data.prop.contentPlaceRelationship.referencedObject.type)+'-count-label">'+soy.$$escapeHtml(accessibilityLinkLabel__soy165)+"</label>":"",'<span title="',soy.$$escapeHtmlAttribute(jive.i18n.i18nText(jive.i18n.getMsg("browse.heading.replycount"),
[])),'"><img src="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.resourceUrl(window._jive_base_url,"/9.0.5.998b920/","//files1.element14.com/community","/images/transparent.png"))),'" alt="" class="jive-icon-sml jive-icon-meta-comment"/><a href="',soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(jive.soy.func.buildUrl(window._jive_base_absolute_url,opt_data.prop.activityInfo.objectUrl+"#comments"))),'"',accessibilityLinkLabel__soy165?'aria-labelledby="replies-'+soy.$$escapeHtmlAttribute(opt_data.prop.contentPlaceRelationship.referencedObject.id)+
"-"+soy.$$escapeHtmlAttribute(opt_data.prop.contentPlaceRelationship.referencedObject.type)+'-count-label" title="'+soy.$$escapeHtmlAttribute(accessibilityLinkLabel__soy165)+'"':"",">",opt_data.prop.contentPlaceRelationship.referencedObject.prop.activityInfo?soy.$$escapeHtml(opt_data.prop.contentPlaceRelationship.referencedObject.prop.activityInfo.replyCount):"0",'</a></span></td><td class="j-td-actions">');if(opt_data.prop.contentPlaceRelationship.canViewReferencedObject){var param204=new soy.StringBuilder;
jive.browse.content.detailActionPanel(soy.$$augmentMap(opt_data.prop.contentPlaceRelationship.referencedObject,{contentPlaceRelInfo:opt_data.prop.contentPlaceRelationship}),param204);jive.browse.content.flippable(soy.$$augmentMap(opt_data.prop,{body:param204.toString()}),output)}output.append("</td></tr>")}return opt_sb?"":output.toString()};
;
goog.provide("jive.browse.grid.listGrid");
jive.browse.grid.listGrid=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append('<div class="j-browse-details"><table class="j-browse-list" cellspacing="0" cellpadding="0" role="grid">');if(opt_data.itemGridDetailsHeaderTemplate)jive.shared.soy.render({templateName:opt_data.itemGridDetailsHeaderTemplate,data:function(){var map={};var pairs=[["columns",opt_data.itemGridDetailsColumns]];for(var i=0;i<pairs.length;i+=1)map[pairs[i][0]]=pairs[i][1];return map}(),failGracefully:false},
output);output.append('<tbody class="j-browse-details-tbody">');var itemList11=opt_data.items;var itemListLen11=itemList11.length;if(itemListLen11>0)for(var itemIndex11=0;itemIndex11<itemListLen11;itemIndex11++){var itemData11=itemList11[itemIndex11];if(opt_data.browseViewID)jive.shared.soy.render({templateName:itemData11.detailTemplate,data:jQuery.extend({},itemData11,function(){var map={};var pairs=[["browseViewID",opt_data.browseViewID],["columns",opt_data.itemGridDetailsColumns],["currentUserPartner",
opt_data.currentUserPartner]];for(var i=0;i<pairs.length;i+=1)map[pairs[i][0]]=pairs[i][1];return map}()),failGracefully:false},output);else jive.shared.soy.render({templateName:itemData11.detailTemplate,data:jQuery.extend({},itemData11,function(){var map={};var pairs=[["currentUserPartner",opt_data.currentUserPartner]];for(var i=0;i<pairs.length;i+=1)map[pairs[i][0]]=pairs[i][1];return map}()),failGracefully:false},output)}else output.append('<tr><td colspan="10">',soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("browse.noresults"),
[])),"</td></tr>");output.append("</tbody></table></div>");return opt_sb?"":output.toString()};
;
goog.provide("jive.browse.grid.itemGrid");
jive.browse.grid.itemGrid=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;if(opt_data.maxPageReached)jive.browse.grid.maxPageReached(opt_data,output);else if(opt_data.items.length<1&&opt_data.noResultTemplateConfig)jive.shared.soy.render(soy.$$augmentMap(opt_data.noResultTemplateConfig,{failGracefully:false}),output);else if(opt_data.itemViewID==null||opt_data.itemViewID=="thumbnail")jive.browse.grid.thumbGrid(opt_data,output);else if(opt_data.itemViewID=="hierarchy"&&opt_data.hierarchyViewSupported)jive.browse.grid.hierarchyView(opt_data,
output);else jive.browse.grid.listGrid(opt_data,output);return opt_sb?"":output.toString()};
;
goog.provide("jive.onboarding.msgFormatHelper");
jive.onboarding.msgFormatHelper=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.noAutoEscape?soy.$$escapeHtml(jive.i18n.i18nText(opt_data.i18nKey,[new soydata.VERY_UNSAFE.ordainSanitizedHtml(opt_data.arg0),new soydata.VERY_UNSAFE.ordainSanitizedHtml(opt_data.arg1),new soydata.VERY_UNSAFE.ordainSanitizedHtml(opt_data.arg2),new soydata.VERY_UNSAFE.ordainSanitizedHtml(opt_data.arg3),new soydata.VERY_UNSAFE.ordainSanitizedHtml(opt_data.arg4),new soydata.VERY_UNSAFE.ordainSanitizedHtml(opt_data.arg5),
new soydata.VERY_UNSAFE.ordainSanitizedHtml(opt_data.arg6),new soydata.VERY_UNSAFE.ordainSanitizedHtml(opt_data.arg7),new soydata.VERY_UNSAFE.ordainSanitizedHtml(opt_data.arg8),new soydata.VERY_UNSAFE.ordainSanitizedHtml(opt_data.arg9)])):soy.$$escapeHtml(jive.i18n.i18nText(opt_data.i18nKey,[opt_data.arg0,opt_data.arg1,opt_data.arg2,opt_data.arg3,opt_data.arg4,opt_data.arg5,opt_data.arg6,opt_data.arg7,opt_data.arg8,opt_data.arg9])));return opt_sb?"":output.toString()};
;
goog.provide("jive.onbStep.create_group.pageTips");
jive.onbStep.create_group.pageTips=function(opt_data,opt_sb){var output=opt_sb||new soy.StringBuilder;output.append(opt_data.renderLocation=="group-template"?'<div class="j-tips inline js-onboarding-tip" style="top: -30px;"><div class="d-'+soy.$$escapeHtml(opt_data.renderLocation)+'-tip"><h4 class="font-face-deco">'+soy.$$escapeHtml(jive.i18n.i18nText(opt_data.viewData.i18nData.create_group_group_template_label,[]))+'</h4><p class="font-color-meta">'+soy.$$escapeHtml(jive.i18n.i18nText(opt_data.viewData.i18nData.create_group_group_template_text,
[]))+'</p></div><span class="j-tiparrow-e j-tarrow" style="top: 30px"></span></div>':opt_data.renderLocation=="group-name"?'<div class="j-tips inline js-onboarding-tip" style="top: 0;"><div class="d-'+soy.$$escapeHtml(opt_data.renderLocation)+'-tip"><h4 class="font-face-deco">'+soy.$$escapeHtml(jive.i18n.i18nText(opt_data.viewData.i18nData.create_group_groupname_label,[]))+'</h4><p class="font-color-meta">'+soy.$$escapeHtml(jive.i18n.i18nText(opt_data.viewData.i18nData.create_group_groupname_text,
[]))+'</p></div><span class="j-tiparrow-e j-tarrow" style="top: 30px"></span></div>':opt_data.renderLocation=="group-img"?'<div class="j-tips inline js-onboarding-tip" style="top: 40px;"><div class="d-'+soy.$$escapeHtml(opt_data.renderLocation)+'-tip"><h4 class="font-color-meta font-face-deco optional">'+soy.$$escapeHtml(jive.i18n.i18nText(opt_data.viewData.i18nData.create_group_flair_label,[]))+'</h4><p class="font-color-meta">'+soy.$$escapeHtml(jive.i18n.i18nText(opt_data.viewData.i18nData.create_group_flair_text2,
[]))+'</p><p class="font-color-meta">'+soy.$$escapeHtml(jive.i18n.i18nText(opt_data.viewData.i18nData.create_group_flair_text1,[]))+'</p></div><span class="j-tiparrow-e j-tarrow" style="top: 20px"></span><span class="j-tiparrow-e j-tarrow" style="top: 20px; right: -350px;"></span></div>':opt_data.renderLocation=="group-type"?'<div class="j-tips inline p-bar js-onboarding-tip" style="top: -30px; visibility: visible; z-index: 100;"><div class="d-'+soy.$$escapeHtml(opt_data.renderLocation)+'-tip"><h4 class="font-face-deco">'+
soy.$$escapeHtml(jive.i18n.i18nText(opt_data.viewData.i18nData.create_group_type_label,[]))+'</h4><p class="font-color-meta">'+soy.$$escapeHtml(jive.i18n.i18nText(opt_data.viewData.i18nData.create_group_type_text,[]))+'</p></div><span class="j-tiparrow-e j-tarrow" style="top: 50px"></span></div>':opt_data.renderLocation=="submit"?'<div class="j-tips inline p-bar js-onboarding-tip" style="top: -10px;"><div class="d-'+soy.$$escapeHtml(opt_data.renderLocation)+'-tip"><h4 class="font-face-deco">'+soy.$$escapeHtml(jive.i18n.i18nText(opt_data.viewData.i18nData.create_group_alldone_label,
[]))+'</h4><p class="font-color-meta">'+soy.$$escapeHtml(jive.i18n.i18nText(opt_data.viewData.i18nData.create_group_alldone_text,[]))+'</p></div><span class="j-tiparrow-e j-tarrow" style="top: 20px"></span></div>':opt_data.renderLocation=="view-group"?'<div class="j-pop js-pop popover js-onboarding-tip" style="position: absolute; top: 50px; left: 50%; margin-left: -175px; visibility: visible; z-index: 100;"><div class="j-tips wide j-banner-tip d-'+soy.$$escapeHtml(opt_data.renderLocation)+'-tip j-pop-main"><h4 class="j-qtip-header font-face-deco">'+
soy.$$escapeHtml(jive.i18n.i18nText(opt_data.viewData.i18nData.create_group_done_label,[]))+"</h4><p>"+soy.$$escapeHtml(jive.i18n.i18nText(opt_data.viewData.i18nData.create_group_done_text,[]))+'</p><p><button class="js-back-to-onb j-btn-callout close">'+soy.$$escapeHtml(jive.i18n.i18nText(jive.i18n.getMsg("global.ok"),[]))+"</button></p></div></div>":"");return opt_sb?"":output.toString()};
;
jive.namespace("Onboarding");define("apps/onboarding/views/create_group",["jquery","apps/onboarding/models/onboarding_source"],function(c,a){var b={};b.onboardingSource=new a();b.setupPage=function(g,e,f){b.stepID=g;b.viewData=e;if(c("#jive-socialgroup-desc").length){c("body").addClass("j-quest-active");var h;if(!f||f==="private"){if(!f){h=c("#jive-socialgroup-type-OPEN")}else{h=c("#jive-socialgroup-type-PRIVATE")}h.click();if(c.browser.msie&&+c.browser.version<=8){h.change()}setTimeout(function(){var j=c(jive.onbStep.create_group.pageTips({renderLocation:"group-type",viewData:b.viewData})),i=h.offset();c("body").prepend(j);j.css({position:"fixed",top:i.top-(j.outerHeight()/2)+"px",left:i.left-j.width()-60+"px","z-index":1002});j.addClass("j-pop");j.children("div").addClass("j-pop-main");j.children("span").css("top",((j.outerHeight()/2)-(j.children("span:first").outerHeight()/2))+"px");c(".js-about-form .j-aboutClose button").one("click",function(){b.closeTip()})},700)}else{if(f=="shared"){var d=c("#shared_checkbox");d.click();h=c("#jive-socialgroup-type-PRIVATE");h.click();if(c.browser.msie&&+c.browser.version<=8){h.change()}setTimeout(function(){var j=c(jive.onbStep.create_group.pageTips({renderLocation:"group-type",viewData:b.viewData}));var i=d.offset();c("body").prepend(j);j.css({position:"fixed",top:i.top-(j.outerHeight()/2)+"px",left:i.left-j.width()-60+"px","z-index":1002});j.addClass("j-pop");j.children("div").addClass("j-pop-main");j.children("span").css("top",((j.outerHeight()/2)-(j.children("span:first").outerHeight()/2))+"px");c(".js-about-form .j-aboutClose button").one("click",function(){b.closeTip()})},700)}}c("#jive-socialgroup-template").prepend(c(jive.onbStep.create_group.pageTips({renderLocation:"group-template",viewData:b.viewData})));c("#jive-socialgroup-name").prepend(c(jive.onbStep.create_group.pageTips({renderLocation:"group-name",viewData:b.viewData})));c("#jive-socialgroup-img").prepend(c(jive.onbStep.create_group.pageTips({renderLocation:"group-img",viewData:b.viewData})));c("input.j-btn-callout").before(c(jive.onbStep.create_group.pageTips({renderLocation:"submit",viewData:b.viewData})))}else{if(window.location.href.indexOf("/groups/")!=-1){require(["apps/shared/models/core_deferred"],function(i){i.getObject(containerType,containerID).pipe(function(k){if((!f&&(k.groupType==="OPEN"||k.groupType==="MEMBER_ONLY"))||(f==="private"&&(k.groupType==="PRIVATE"||k.groupType==="SECRET"))||(f==="shared"&&k.visibleToExternalContributors===true)){var l=c(jive.onbStep.create_group.pageTips({renderLocation:"view-group",viewData:b.viewData}));c("#jive-body").prepend(l);var j=c("body");j.on("click.postConfirmationTip",function(o){var m=c(o.target);if(!m.closest(".js-onboarding-tip").length||m.hasClass("js-back-to-onb")){j.off("click.postConfirmationTip");b.closeTip();if(m.hasClass("js-back-to-onb")){var n=jive.app.url({path:"/get-started"});window.location=n}}})}})})}}};b.closeTip=function(d){var e="div.js-onboarding-tip";if(d){e+="[data-location="+d+"]"}var f=c(e);if(f.length){f.each(function(){var h=c(this);var g=h.closest("div.js-pop").length;if(g.length){g.trigger("close");g.remove()}else{h.remove()}})}};return b});
;
var __slice=Array.prototype.slice,__bind=function(a,b){return function(){return a.apply(b,arguments)}},__hasProp=Object.prototype.hasOwnProperty,__extends=function(d,b){for(var a in b){if(__hasProp.call(b,a)){d[a]=b[a]}}function c(){this.constructor=d}c.prototype=b.prototype;d.prototype=new c;d.__super__=b.prototype;return d};(function(a){var b;b=a.Wistia;if(!((a.Wistia!=null)&&(a.Wistia.wistia!=null))){a.Wistia={wistia:"1.0",extend:function(){var g,e,f,d,c;g=arguments[0],f=2<=arguments.length?__slice.call(arguments,1):[];if(!f.length){f=[g];g=this}for(d=0,c=f.length;d<c;d++){e=f[d];this.obj.eachDeep(e,__bind(function(i,j){var h;h=this.obj.get(g,j);if(this.obj.isArray(i)){if(this.obj.isEmpty(h)){return this.obj.set(g,j,[])}}else{if(this.obj.isObject(i)){if(this.obj.isEmpty(h)){return this.obj.set(g,j,{})}}else{return this.obj.set(g,j,i)}}},this))}return g},mixin:function(c,e){var d,f;for(d in e){f=e[d];if(e.hasOwnProperty(d)){c[d]=f}}},obj:{get:function(f,e,c){var d;if(typeof e==="string"){e=e.split(".")}else{e=e.slice(0,e.length)}while((f!=null)&&e.length){d=e.shift();if((f[d]===void 0||!this.isObject(f[d]))&&c){f[d]={}}f=f[d]}return f},set:function(e,d,c){var f;if(typeof d==="string"){d=d.split(".")}else{d=d.slice(0,d.length)}f=d.pop();e=this.get(e,d,true);if((e!=null)&&(this.isObject(e)||this.isArray(e))&&(f!=null)){if(c!=null){return e[f]=c}else{return delete e[f]}}else{}},unset:function(d,c){return this.set(d,c)},exists:function(d,c){return this.get(d,c)!==void 0},cast:function(c){if(c==null){return c}c=""+c;if(/^\d+?$/.test(c)){return parseInt(c,10)}else{if(/^\d*\.\d+/.test(c)){return parseFloat(c)}else{if(/^true$/i.test(c)){return true}else{if(/^false$/i.test(c)){return false}else{return c}}}}},castDeep:function(c){this.eachLeaf(c,__bind(function(d,e){if(typeof d==="string"){return this.set(c,e,this.cast(d))}},this));return c},isArray:function(c){return(c!=null)&&/^\s*function Array()/.test(c.constructor)},isObject:function(c){return(c!=null)&&/^\s*function Object()/.test(c.constructor)},isRegExp:function(c){return(c!=null)&&/^\s*function RegExp()/.test(c.constructor)},isBasicType:function(c){return(c!=null)&&(this.isRegExp(c)||/^string|number|boolean|function$/i.test(typeof c))},isEmpty:function(e){var c,d,f;if(!(e!=null)){return true}else{if(this.isArray(e)&&!e.length){return true}else{if(this.isObject(e)){c=true;for(d in e){f=e[d];c=false}return c}else{return false}}}},isEmptyDeep:function(d){var c;if(this.isEmpty(d)){return true}c=true;this.eachLeaf(d,__bind(function(){return c=false},this));return c},isSubsetDeep:function(e,d){var c;if(e===d){return true}if(((e!=null)&&!(d!=null))||(!(e!=null)&&(d!=null))){return false}c=true;this.eachLeaf(e,__bind(function(g,h){var f;f=this.get(d,h);if(g!==f){return c=false}},this));return c},equalsDeep:function(d,c){return this.isSubsetDeep(d,c)&&this.isSubsetDeep(c,d)},eachDeep:function(g,d,f){var c,e,h;if(f==null){f=[]}if(this.isBasicType(g)){d(g,f)}else{if(this.isObject(g)||this.isArray(g)){d(g,f);for(c in g){h=g[c];e=f.slice(0,f.length);e.push(c);this.eachDeep(h,d,e)}}else{d(g,f)}}},eachLeaf:function(d,c){return this.eachDeep(d,__bind(function(f,e){if(!this.isArray(f)&&!this.isObject(f)){return c(f,e)}},this))}},data:function(c,d){if(!this.obj.isArray(c)){c=c.split(".")}if(d!=null){this.obj.set(this,["_data"].concat(c),d)}return this.obj.get(this,["_data"].concat(c))},timeout:function(c,d,e){var f;if(e==null){e=1}this.clearTimeouts(c);if(!this.obj.isArray(c)){c=c.split(".")}c=["timeouts"].concat(c);if(d){f=setTimeout(__bind(function(){this.removeData(c);return d()},this),e);return this.data(c,f)}else{return this.data(c)}},clearTimeouts:function(c){var d;if(!this.obj.isArray(c)){c=c.split(".")}c=["timeouts"].concat(c);d=this.data(c);this.obj.eachLeaf(d,function(e){return clearTimeout(e)});return this.removeData(c)},removeData:function(c){return this.obj.unset(this,["_data"].concat(c))},seqId:function(e,f){var d,c,g;if(e==null){e="wistia_"}if(f==null){f=""}g=["sequence","val"];d=this.data(g)||1;c=e+d+f;this.data(g,d+1);return c},noConflict:function(){a.Wistia=b;return this},util:{elemHeight:function(d){var c;c=Wistia.detect.browser.quirks?parseInt(d.offsetHeight,10):a.getComputedStyle?parseInt(getComputedStyle(d,null).height,10):d.currentStyle?d.offsetHeight:-1;return c},elemWidth:function(c){if(Wistia.detect.browser.quirks){return parseInt(c.offsetWidth,10)}else{if(a.getComputedStyle){return parseInt(getComputedStyle(c,null).width,10)}else{if(c.currentStyle){return c.offsetWidth}else{return -1}}}},winHeight:function(){var c;return c=a.innerHeight?a.innerHeight:document.documentElement?document.documentElement.offsetHeight:document.body.offsetHeight},winWidth:function(){var c;return c=a.innerWidth?a.innerWidth:document.documentElement?document.documentElement.offsetWidth:document.body.offsetWidth}},bindable:{bind:function(c,d){if(!this._bindings){this._bindings={}}if(!this._bindings[c]){this._bindings[c]=[]}this._bindings[c].push(d);return this},unbind:function(e,h){var d,c,g,f;d=this._bindings[e];if(d){if(h){g=[];for(c=0,f=d.length;0<=f?c<f:c>f;0<=f?c++:c--){if(h!==d[c]){g.push(d[c])}}this._bindings[e]=g}else{this._bindings[e]=[]}}if(this._bindings[e]&&!this._bindings[e].length){this._bindings[e]=null;delete this._bindings[e]}return this},hasBindings:function(){var d,c,f,e;c=false;e=this._bindings;for(d in e){f=e[d];if(this._bindings.hasOwnProperty(d)){c=true}}return c},trigger:function(){var d,h,g,e,f,c;e=arguments[0],d=2<=arguments.length?__slice.call(arguments,1):[];if((h=this._bindings[e])){for(f=0,c=h.length;f<c;f++){g=h[f];if(g){g.apply(this,d)}}}return this}}}}if((b!=null)&&!(b.wistia!=null)){return Wistia.extend(b)}})(window);(function(a){a.extend({_detect:{na:navigator.userAgent,rwebkit:/(webkit)[ \/]([\w.]+)/i,ropera:/(opera)(?:.*version)?[ \/]([\w.]+)/i,rmsie:/(msie) ([\w.]+)/i,rmozilla:/(mozilla)(?:.*? rv:([\w.]+))?/i,randroid:/(android) ([^;])/i,riphone:/(iphone)/i,ripad:/(ipad)/i,browser:function(){return this.browserMatch()[1].toLowerCase()},browserVersion:function(){return this.browserMatch()[2]},browserMatch:function(){return this.na.match(this.rwebkit)||this.na.match(this.ropera)||this.na.match(this.rmsie)||this.na.match(this.rmozilla)},android:function(){var b;b=this.na.match(this.randroid);if(b==null){return false}return{version:b[2]}},iphone:function(){return this.riphone.test(this.na)},ipad:function(){return this.ripad.test(this.na)},flash:function(){var b;b=this.flashFullVersion();return{version:parseFloat(b[0]+"."+b[1]),major:parseInt(b[0],10),minor:parseInt(b[1],10),rev:parseInt(b[2],10)}},flashFullVersion:function(){var b;try{try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");try{b.AllowScriptAccess="always"}catch(c){return[6,0,0]}}catch(c){}return new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1].split(",")}catch(c){try{if(navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin){return(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1].split(",")}}catch(c){}}return[0,0,0]},html5Video:function(){var d,c,b;d=document.createElement("video");b=false;try{if(!!d.canPlayType){b={};c='video/mp4; codecs="avc1.42E01E';b.h264=!!d.canPlayType(c+'"')||!!d.canPlayType(c+', mp4a.40.2"')}}catch(f){b={h264:false}}return b}}});a.extend({detect:{browser:{version:a._detect.browserVersion(),quirks:a._detect.browser()==="msie"&&document.compatMode==="BackCompat",old:a._detect.browser()==="msie"&&(document.compatMode==="BackCompat"||a._detect.browserVersion()<7)},android:a._detect.android(),iphone:a._detect.iphone(),ipad:a._detect.ipad(),flash:a._detect.flash(),video:a._detect.html5Video()}});a.detect.browser[a._detect.browser()]=true})(Wistia);(function(a){var c,e,d,b;e=function(f){return f.mp4hq||f.flv||f.iphone};d=function(f){return f.mp4hq||f.iphone};c=function(f){return f.iphone};b=function(f){if(f.mp4hq&&f.mp4hq.width<=1280&&f.mp4hq.height<=720){return f.mp4hq}else{return f.iphone}};a.extend({judy:{judge:function(k,g){var h,j,i,f;if(!g){g={}}i=g.plea;j=g.force;f={media:k,plea:j||i,uuid:g.uuid||a.seqId("wistia_"),asset:null,embedType:null};h=k.assets;if(j==="html5"){f.embedType="html5";f.asset=d(h)}else{if(j==="flash"){f.embedType="flash";f.asset=e(h)}else{if(j==="external"){f.embedType="external";f.asset=c(h)}else{if(a.detect.iphone){f.embedType="html5";f.asset=c(h)}else{if(a.detect.ipad){f.embedType="html5";f.asset=b(h)}else{if(a.detect.android){f.embedType="external";f.asset=c(h)}else{if(i==="html5"&&a.detect.video.h264){f.embedType="html5";f.asset=d(h)}else{if(i==="flash"&&a.detect.flash.version>=7){f.embedType="flash";f.asset=e(h)}else{if(i==="external"){f.embedType="external";f.asset=c(h)}else{if(a.detect.flash.version>=7){f.embedType="flash";f.asset=e(h)}else{if(a.detect.video.h264){f.embedType="html5";f.asset=d(h)}else{if((a.detect.browser.msie&&(a.detect.browser.version<9||a.detect.browser.quirks))||a.detect.browser.mozilla){f.embedType="flash";f.asset=e(h)}else{f.embedType="external";f.asset=e(h)}}}}}}}}}}}}return f}}})})(Wistia);(function(a){a.extend({embed:function(f,e){var d,c,b;if(!e){e={}}b=new a._embed.Video({},e);a.data(["video",b.uuid],b);d=a._embed.getContainer(f,e);if(a.detect.browser.old){d.style.width=""+(a.util.elemWidth(d))+"px";d.style.height=""+(a.util.elemHeight(d))+"px"}if(a.gridify&&!b.params.noGrid){b.grid=a.gridify(b,d)}else{if(e.wmode!=="transparent"){d.style.backgroundColor="#000000"}}c=function(k){var i,j,l,g,h;if(k.error){if(typeof console!=="undefined"&&console!==null){console.log(k.error)}return}j=a.judy.judge(k,b.params);h=a._embed.classFor(j.embedType);g=new h(j,b.options);for(i in g){l=g[i];if(i!=="uuid"){b[i]=l}}b.embed()};setTimeout(function(){var g;if(typeof f==="string"){g=f;return a.remote.media(g,function(h){return c(h)})}else{return c(f)}},100);return b},_embed:{getContainer:function(c,b){if(typeof b.container==="string"){return document.getElementById(b.container)}else{if(typeof c==="string"){return document.getElementById("wistia_"+c)}else{if(c&&c.media){return document.getElementById("wistia_"+c.media.hashedId)}else{if(c&&c.hashedId){return document.getElementById("wistia_"+c.hashedId)}else{return null}}}}},classFor:function(b){switch(b){case"html5":return a._embed.Html5Video;case"flash":return a._embed.FlashVideo;case"external":return a._embed.ExternalVideo;default:return a._embed.Video}}}})})(Wistia);(function(a){var d,g,f,b,c,e;a.extend({util:{addInlineCss:function(k,h){var j,i;j=document.createElement("style");j.id=a.seqId("wistia_","_style");j.setAttribute("type","text/css");i=document.getElementsByTagName("style");k.appendChild(j,k.nextSibling);if(j.styleSheet){j.styleSheet.cssText=h}else{j.appendChild(document.createTextNode(h))}},objToHtml:function(n){var o,m,s,q,r,t,j,i,l,k,p,h;if(/string|number|boolean/.test(typeof n)){return n.toString()}if(n instanceof Array){t="";for(l=0,p=n.length;l<p;l++){q=n[l];t+=a.util.objToHtml(q)}return t}if(typeof n!=="object"){return n.toString()}m=[];for(r in n){i=n[r];if(r==="tagName"){j=i}else{if(r==="childNodes"){s=i}else{m.push({key:r,val:i})}}}j||(j="div");t="<"+j;for(k=0,h=m.length;k<h;k++){o=m[k];t+=" "+o.key+'="'+o.val+'"'}if(/^(br|hr|img|link|meta|input)$/i.test(j)){t+=" />"}else{t+=">";if(s){if(typeof s==="string"){t+=s}else{if(typeof s==="object"){t+=a.util.objToHtml(s)}}}t+="</"+j+">"}return t}}});b=function(j){var i,h,k;h=[];for(i in j){k=j[i];h.push(""+i+"="+(encodeURIComponent(k)))}return h.join("&")};c=function(i,h){return"display:inline-block;*display:inline;height:"+h+";margin:0;padding:0;position:relative;vertical-align:top;width:"+i+";zoom:1;"};g=function(o,q){var l,j,k,p,h,n,m,i;l=o.asset;h=o.media;q=a.extend({flashPlayerUrl:null,pageUrl:null,chromeless:false,doNotTrack:false,endVideoCallback:"",controlsVisibleOnLoad:false,autoLoad:false,autoPlay:false,endVideoBehavior:"default",playButton:true,wmode:"opaque",playerColor:"",smallPlayButton:true,volumeControl:false,playbar:true,fullscreenButton:true,stillUrl:h.assets.still?h.assets.still.url:""},q);q.unbufferedSeek=l.type==="flv";q.shouldTrack=!q.doNotTrack;k={videoUrl:l.url,hdUrl:h.assets.hdflv?h.assets.hdflv.url:"",stillUrl:q.stillUrl,unbufferedSeek:l.type==="flv",controlsVisibleOnLoad:q.controlsVisibleOnLoad,autoLoad:q.autoLoad,autoPlay:q.autoPlay&&!q.suppressAutoplay,endVideoBehavior:q.endVideoBehavior,playButtonVisible:q.playButton,mediaDuration:h.duration,customColor:q.playerColor,wemail:q.trackEmail,referrer:q.pageUrl,quality:q.videoQuality,chromeless:q.chromeless?true:null,endVideoCallback:q.endVideoCallback?q.endVideoCallback:null,showVolume:q.volumeControl?true:null,showPlaybar:q.playbar===false?false:null,showPlayButton:q.smallPlayButton===false?false:null,fullscreenDisabled:q.fullscreenButton===false?true:null,trackingTransmitInterval:q.trackingTransmitInterval?q.trackingTransmitInterval:null};if(q.shouldTrack){k.embedServiceURL=h.distilleryUrl;k.accountKey=h.accountKey;k.mediaID=h.mediaKey}for(p in k){i=k[p];if(i==null){delete k[p]}}n={tagName:"object",id:o.uuid,classid:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",style:c("100%","100%")};if(q.wmode!=="transparent"){n.bgcolor="#000000"}m=[{tagName:"param",name:"movie",value:q.flashPlayerUrl||h.flashPlayerUrl},{tagName:"param",name:"allowfullscreen",value:"true"},{tagName:"param",name:"allowscriptaccess",value:"always"},{tagName:"param",name:"wmode",value:q.wmode},{tagName:"param",name:"flashvars",value:b(k)}];j={tagName:"embed",src:q.flashPlayerUrl||h.flashPlayerUrl,name:o.uuid,type:"application/x-shockwave-flash",allowfullscreen:"true",allowscriptaccess:"always",wmode:q.wmode,flashvars:b(k),style:c("100%","100%")};if(q.wmode!=="transparent"){j.bgcolor="#000000"}n.childNodes=m.concat(j);if(a.detect.browser.msie&&(a.detect.browser.version<9||a.detect.browser.quirks)){if(a.detect.flash.version<7){n.childNodes=[{style:"background:#666;color:#fff;height:100%;width:100%;","class":"noflash",childNodes:['Whoops! It looks like Flash isn\'t installed. Please \n<a href="http://get.adobe.com/flashplayer/" style="color:white;text-decoration:underline;" target="_blank">\ndownload and install Adobe\'s Flash Player plugin\n</a>\nto watch this video.']}]}}return a.util.objToHtml(n)};f=function(l,h){var j,m,i,k;j=l.asset;m=l.media;h=a.extend({autoLoad:true,autoPlay:false,doNotTrack:false,stillUrl:m.assets.still?m.assets.still.url:""},h);h.shouldTrack=!h.doNotTrack;k=document.createElement("video");k.style.width="100%";k.style.height="100%";k.style.position="relative";k.style.display="block";k.controls="controls";k.id=l.uuid;k.poster=h.stillUrl;k.preload="none";if(h.autoPlay&&!h.suppressAutoplay){k.autoplay="autoplay"}i=document.createElement("source");i.src=j.url.replace(/\.bin$/,"")+"/file.mp4";i.type="video/mp4";k.appendChild(i);return k};d=function(k,i){var h,j,l,m;j=k.asset;m=k.media;i=a.extend({playButton:true,stillUrl:m.assets.still?m.assets.still.url.replace(/\.bin$/,".jpg?image_play_button=1"):""},i);h={tagName:"a",href:j.url,id:k.uuid,target:"_parent",style:c("100%","100%")};l={tagName:"img",src:e(k,i),border:0,alt:"Play video",style:"height:100%;vertical-align:top;width:100%;"};h.childNodes=[l];return a.util.objToHtml(h)};e=function(i,h){var j;j=i.media;if(h.videoWidth&&h.videoHeight){if(h.playButton){return j.assets.still.url.replace(/\.bin$/,".jpg?image_play_button=1&image_crop_resized="+h.videoWidth+"x"+h.videoHeight)}else{return j.assets.still.url.replace(/\.bin$/,".jpg?image_crop_resized="+h.videoWidth+"x"+h.videoHeight)}}else{if(h.playButton){return j.assets.still.url.replace(/\.bin$/,".jpg?image_play_button=1")}else{return j.assets.still.url.replace(/\.bin$/,".jpg")}}};return a.extend({generate:{video:function(j,i,h){if(j==="flash"){return g(i,h)}else{if(j==="html5"){return f(i,h)}else{if(j==="external"){return d(i,h)}else{if(j==="stillUrl"){return e(i,h)}}}}}}})})(Wistia);(function(a){a._embed.Video=(function(){function b(e,d){var c;this.data=e;this.options=d;this.params=a.extend(this.params||{},this.options);this.params.container=a._embed.getContainer(this.data,this.options);if(this.options.platformPreference){this.params.plea=this.options.platformPreference}this.params.shouldTrack=!this.options.doNotTrack;if(this.options.playButtonVisible!=null){this.params.playButton=this.options.playButtonVisible}this.params.rawEmbed=top===self;if(this.params.videoWidth){this.params.videoWidth=parseInt(this.params.videoWidth,10)}if(this.params.videoHeight){this.params.videoHeight=parseInt(this.params.videoHeight,10)}this.params.aspectRatio=this.params.videoWidth/this.params.videoHeight;if(!this.params.playerColor){this.params.playerColor="636155"}if(!this.params.trackEmail){if((c=location.href.match(/wemail\=([^\&]+)/))!=null){this.params.trackEmail=c[1]}}if(!this.params.stillUrl){this.params.stillUrl=a.obj.exists(this.data,"media.assets.still.url")?this.data.media.assets.still.url:""}if(!this.params.uuid){this.params.uuid=a.seqId()}this.uuid=this.params.uuid}b.prototype.embed=function(){this.embedAs(this.embedType);return this.ready(__bind(function(){return this.monitorSize()},this))};b.prototype.monitorSize=function(){var d,g,f,e,c;f=__bind(function(){if(this.params.rawEmbed&&a.detect.browser.old){return this.width()}else{if(this.params.rawEmbed){return a.util.elemWidth(this.container)}else{return a.util.winWidth()}}},this);g=__bind(function(){if(this.params.rawEmbed&&a.detect.browser.old){return this.height()}else{if(this.params.rawEmbed){return a.util.elemHeight(this.container)}else{return a.util.winHeight()}}},this);c=f();e=g();d=__bind(function(){var i,h;h=f();i=g();if(c!==h){this.width(h);c=h}if(e!==i){this.height(i);e=i}a.timeout(""+this.uuid+".auto_resize",d,1000)},this);d()};b.prototype.embedAs=function(c){this.container=this.params.container;this.embedCode=a.generate.video(c,this.data,this.params);this.placeEmbed(this.embedCode);return this};b.prototype.placeEmbed=function(c){var d;d=(this.grid&&this.grid.center)||this.container;if(typeof c==="string"){d.innerHTML=c}else{d.innerHTML="";d.appendChild(c)}return this.ieSizeHack()};b.prototype.rebuildAs=function(i){var e,f,g,h,c,d;g=this.uuid;f=a.judy.judge(this.data.media,{force:i});d=a._embed.classFor(f.embedType);c=new d(f,this.options);for(e in c){h=c[e];this[e]=h}this.uuid=g;a.clearTimeouts(this.uuid);this._isReady=false;this.embed(this.params.container);return this};b.prototype.remove=function(){a.clearTimeouts(this.uuid);a._data.video[this.uuid]=null;delete a._data.video[this.uuid];this.container.innerHTML=""};b.prototype.bind=function(c,d){if(!this._bindings){this._bindings={}}if(!this._bindings[c]){this._bindings[c]=[]}this._bindings[c].push(d);return this};b.prototype.unbind=function(e,h){var d,c,g,f;d=this._bindings[e];if(d){if(h){g=[];for(c=0,f=d.length;0<=f?c<f:c>f;0<=f?c++:c--){if(h!==d[c]){g.push(d[c])}}this._bindings[e]=g}else{this._bindings[e]=[]}}if(this._bindings[e]&&!this._bindings[e].length){this._bindings[e]=null;delete this._bindings[e]}return this};b.prototype.hasBindings=function(){var d,c,f,e;c=false;e=this._bindings;for(d in e){f=e[d];if(this._bindings.hasOwnProperty(d)){c=true}}return c};b.prototype.trigger=function(){var d,h,g,e,f,c;e=arguments[0],d=2<=arguments.length?__slice.call(arguments,1):[];if((h=this._bindings[e])){for(f=0,c=h.length;f<c;f++){g=h[f];if(g){g.apply(this,d)}}}return this};b.prototype._eventLoopDuration=300;b.prototype.play=function(){return this.ready("play")};b.prototype.pause=function(){return this.ready("pause")};b.prototype.time=function(c){if(c!=null){this.ready("time",c);return this}else{}};b.prototype.state=function(){return"unknown"};b.prototype.duration=function(){return 0};b.prototype.getEventKey=function(){return null};b.prototype.volume=function(c){if(c!=null){return this.ready("volume",c)}else{return 0}};b.prototype.setPlayerColor=function(c){this.ready("setPlayerColor",c);return this};b.prototype.ready=function(){var d,h,e,g,c,f;h=arguments[0],d=2<=arguments.length?__slice.call(arguments,1):[];if(!this._readyQueue){this._readyQueue=[]}if(this._isReady){if(h){this._readyQueue.push({callback:h,args:d})}f=this._readyQueue;for(g=0,c=f.length;g<c;g++){e=f[g];if(typeof e.callback==="string"){this[e.callback].apply(this,e.args)}else{e.callback.apply(this,e.args)}}this._readyQueue=[]}else{if(h){this._readyQueue.push({callback:h,args:d})}}return this};b.prototype.width=function(d){var c;if(d!=null){d=parseInt(d,10);if(this.grid){this.container.style.width=this.grid.wrapper.style.width=""+d+"px";this.grid.center.style.width="100%";this.elem().style.width="100%";a.grid.fitHorizontal(this);a.grid.fitVertical(this)}else{this.container.style.width=""+d+"px";this.elem().style.width="100%"}return this}else{if(a.detect.browser.old){this.elem().style.position="absolute"}if(this.grid){c=a.util.elemWidth(this.grid.left)+a.util.elemWidth(this.grid.center)+a.util.elemWidth(this.grid.right)}else{c=a.util.elemWidth(this.container)}if(a.detect.browser.old){this.elem().style.position="static"}return c}};b.prototype.height=function(d){var c;if(d!=null){d=parseInt(d,10);if(this.grid){this.container.style.height=this.grid.wrapper.style.height=""+d+"px";this.grid.center.style.height="100%";this.elem().style.height="100%";a.grid.fitHorizontal(this);a.grid.fitVertical(this)}else{this.container.style.height=""+d+"px";this.elem().style.height="100%"}return this}else{if(a.detect.browser.old){this.elem().style.position="absolute"}if(this.grid){c=a.util.elemHeight(this.grid.center)+Math.max(a.util.elemHeight(this.grid.above),a.util.elemHeight(this.grid.top))+Math.max(a.util.elemHeight(this.grid.below),a.util.elemHeight(this.grid.bottom))}else{c=a.util.elemHeight(this.container)}if(a.detect.browser.old){this.elem().style.position="static"}return c}};b.prototype.videoWidth=function(d){var e,c;if(d!=null){d=parseInt(d,10);if(this.grid){this.grid.center.style.width="100%";this.grid.main.style.width=""+d+"px";this.grid.main.style.width=""+d+"px";e=a.util.elemWidth(this.grid.left)+a.util.elemWidth(this.grid.right);this.container.style.width=this.grid.wrapper.style.width=""+(d+e)+"px";a.grid.fitHorizontal(this);a.grid.fitVertical(this)}else{this.container.style.width=""+d+"px";this.elem().style.width="100%"}return this}else{if(a.detect.browser.old){this.elem().style.position="absolute"}if(this.grid){c=a.util.elemWidth(this.grid.center)}else{c=a.util.elemWidth(this.container)}if(a.detect.browser.old){this.elem().style.position="static"}return c}};b.prototype.videoHeight=function(f){var e,d,c,g;if(f!=null){f=parseInt(f,10);if(this.grid){this.grid.main.style.height=""+f+"px";this.grid.center.style.height="100%";this.grid.main.style.height=""+f+"px";g=Math.max(a.util.elemHeight(this.grid.above),a.util.elemHeight(this.grid.top));e=Math.max(a.util.elemHeight(this.grid.below),a.util.elemHeight(this.grid.bottom));d=g+e;this.container.style.height=this.grid.wrapper.style.height=""+(f+d)+"px";a.grid.fitHorizontal(this);a.grid.fitVertical(this)}else{this.container.style.height=""+f+"px";this.elem().style.height="100%"}return this}else{if(a.detect.browser.old){this.elem().style.position="absolute"}if(this.grid){c=a.util.elemHeight(this.grid.center)}else{c=a.util.elemHeight(this.container)}if(a.detect.browser.old){this.elem().style.position="static"}return c}};b.prototype.ieSizeHack=function(){if(a.detect.browser.msie&&this.elem&&this.elem()){if(this.elem().offsetLeft%2===0){this.elem().style.width=""+(this.videoWidth()+1)+"px"}else{this.elem().style.width="100%"}}};b.prototype.setEmail=function(c){return this.params.trackEmail=c};b.prototype.getVisitorKey=function(){if(this.tracker){return this.tracker.visitorKey()}else{return""}};b.prototype.getEventKey=function(){if(this.tracker){return this.tracker.eventKey()}else{return""}};return b})()})(Wistia);(function(a){a._embed.FlashVideo=(function(){__extends(b,a._embed.Video);function b(){b.__super__.constructor.apply(this,arguments)}b.prototype.embedType="flash";b.prototype.elem=function(){return document[this.data.uuid]};b.prototype.embed=function(){var c;b.__super__.embed.apply(this,arguments);this._lastTimePosition=0;a.timeout(""+this.uuid+".quick_repair",__bind(function(){if(this.isBroken()){a.clearTimeouts(this.uuid);this.repair()}},this),50);c=__bind(function(d){if(d>=50){return}if(this.elem()&&this.elem().getCurrentTime){if(!this.isBroken()){a.timeout(""+this.uuid+".ready_delay",__bind(function(){this._isReady=true;this.ready();this.listenForEvents();if(!this.tracker){return this.tracker=a.tracker(this)}},this),200)}}else{a.timeout(""+this.uuid+".ready_check",(__bind(function(){return c.call(this,d+1)},this)),200)}},this);c();return this};b.prototype.remove=function(){a.clearTimeouts(this.uuid);return b.__super__.remove.call(this)};b.prototype.listenForEvents=function(){this._fireIfChanged=__bind(function(){var d,c;if(!this.hasBindings()){return}a.timeout(""+this.uuid+".fire_if_changed",(__bind(function(){return this._fireIfChanged.call(this)},this)),this._eventLoopDuration);d=this.state();c=this.time();if(d!==this._lastState){if(d==="playing"){this.trigger("play")}else{if(d==="paused"){this.trigger("pause")}else{if(d==="ended"){this.trigger("end")}}}}if(c!==this._lastTimePosition){this.trigger("timechange",c);this._lastTimePosition=c}this._lastState=d},this);this._fireIfChanged.call(this)};b.prototype.bind=function(){var c;c=1<=arguments.length?__slice.call(arguments,0):[];b.__super__.bind.apply(this,c);if(a.timeout(""+this.uuid+".fire_if_changed")==null){if(!this._isReady){return this.ready("listenForEvents")}this.listenForEvents()}return this};b.prototype.play=function(){if(!this._isReady){return this.ready("play")}this.elem().videoPlay();return this};b.prototype.pause=function(){if(!this._isReady){return this.ready("pause")}this.elem().videoPause();return this};b.prototype.time=function(d){var g,c,f;if((d!=null)&&!this._isReady){return this.ready("time",d)}if(d!=null){f=this.state();if(f==="unknown"){this.elem().videoPlay();c=this;g=function(){c.unbind("timechange",g);return c.elem().videoSeek(d)};this.bind("timechange",g)}else{this.elem().videoSeek(d);if(f==="paused"||f==="ended"){this.pause()}}return this}else{try{return this.elem().getCurrentTime()}catch(h){return -1}}};b.prototype.state=function(){try{switch(this.elem().getCurrentState()){case 0:return"ended";case 1:return"playing";case 2:return"paused";default:return"unknown"}}catch(c){return"unknown"}};b.prototype.volume=function(d){var c;if(d&&!this._isReady){return this.ready("volume",d)}if(d!=null){this.elem().setVolume(Math.min(Math.round(d*100),100));return this}else{c=this.elem().getVolume();if(c>0){c/=100}return c}};b.prototype.duration=function(){return this.data.media.duration};b.prototype.outsideContainer=function(){var c;c=this.elem();while(c.nodeType===1){c=c.parentNode;if(c===this.container){return false}}return true};b.prototype.ctfBlocked=function(){return document.getElementById("CTFstack")&&this.outsideContainer()};b.prototype.chromeFlashBlocked=function(){var d,c;if(a.detect.browser.webkit&&this.elem()){d=this.elem().parentNode.previousSibling;if(d){c=d.childNodes[0]}return c&&c.getAttribute("style")&&c.getAttribute("style").indexOf("gofhjkjmkpinhpoiabjplobcaignabnl")!==-1}};b.prototype.ffFlashBlocked=function(){var c;c=this.container.childNodes[0];return c&&c.getAttribute("bgactive")&&c.getAttribute("bgactive").indexOf("flashblock")!==-1};b.prototype.isBlocked=function(){return a.detect.flash.version>=7&&(this.ctfBlocked()||this.chromeFlashBlocked())};b.prototype.isBroken=function(){return a.detect.flash.version<7||this.isBlocked()};b.prototype.repair=function(){if(this.isBlocked()&&a.detect.video.h264){a.clearTimeouts(this.uuid);this.rebuildAs("html5")}};b.prototype.getEventKey=function(){try{return this.elem().getEventKey()}catch(c){return""}};b.prototype.setPlayerColor=function(c){this.params.playerColor=c;if(this._isReady){this.elem().changeColor(c)}else{this.ready("setPlayerColor",c)}};b.prototype.setEmail=function(c){b.__super__.setEmail.call(this,c);return this.elem().setEmail(c)};return b})()})(Wistia);(function(a){var b;b=function(d,c,f){var e;e=__bind(function(){d.removeEventListener(c,e);return f()},this);d.addEventListener(c,e)};a._embed.Html5Video=(function(){__extends(c,a._embed.Video);function c(){c.__super__.constructor.apply(this,arguments)}c.prototype.embedType="html5";c.prototype.elem=function(){return document.getElementById(this.data.uuid)};c.prototype.embed=function(){c.__super__.embed.apply(this,arguments);if(this.hasPreRoll){this.embedExternal()}else{this.embedHtml5()}if(this.hasPostRoll){this.preloadStill();this.bind("end",__bind(function(){return this.embedExternal()},this))}return this};c.prototype.preloadStill=function(){var d;d=new Image();if(this.options.playButton){return d.src=a.generate.video("stillUrl",this.data,this.params)}else{return d.src=a.generate.video("stillUrl",this.data,this.params)}};c.prototype.embedExternal=function(){var d;if(this.tracker){this.tracker.stopMonitoring()}d=this.params.playButton;this.params.playButton=this.options.playButton;this.embedAs("external");this.params.playButton=d;a.timeout(""+this.uuid+".vid_ready",__bind(function(){this._isReady=true;return this.ready()},this));return this.elem().addEventListener("click",__bind(function(e){e.preventDefault();this.embedHtml5();return this.play()},this))};c.prototype.embedHtml5=function(){this._isReady=false;this.embedAs("external");this.embedAs("html5");if(!this.tracker){this.tracker=a.tracker(this)}if(this.params.shouldTrack){this.ready(__bind(function(){return this.tracker.monitor()},this))}this.elem().addEventListener("playing",(__bind(function(){return this.trigger("play")},this)));this.elem().addEventListener("pause",(__bind(function(){return this.trigger("pause")},this)));this.elem().addEventListener("ended",(__bind(function(){return this.trigger("end")},this)));a.timeout(""+this.uuid+".vid_ready",__bind(function(){this._isReady=true;return this.ready()},this));return this.listenForEvents()};c.prototype.remove=function(){a.clearTimeouts(this.uuid);return c.__super__.remove.call(this)};c.prototype.listenForEvents=function(){if(!this._bindings){this._bindings={}}this._fireIfChanged=__bind(function(){var d;if(!this.hasBindings()){return}a.timeout(""+this.uuid+".fire_if_changed",(__bind(function(){return this._fireIfChanged.call(this)},this)),this._eventLoopDuration);if((d=this.time())!==this._lastTimePosition){this.trigger("timechange",d);this._lastTimePosition=d}},this);this._fireIfChanged()};c.prototype.bind=function(){var d;d=1<=arguments.length?__slice.call(arguments,0):[];c.__super__.bind.apply(this,d);if(!a.timeout(""+this.uuid+".fire_if_changed")){this.listenForEvents()}return this};c.prototype.play=function(d){if(/video/i.test(this.elem().tagName)){if(!this._isReady){return this.ready("play")}this.elem().play()}else{this.embedHtml5();this.play()}return this};c.prototype.pause=function(){if(!this._isReady){return this.ready("pause")}this.elem().pause();return this};c.prototype.time=function(d){if(d&&!this._isReady){return this.ready("time",d)}if(d!=null){if(this.state()==="unknown"){b("playing",__bind(function(){b(this.elem(),"seeked",__bind(function(){return this.pause()},this));this.elem().currentTime=d},this));this.play()}else{this.elem().currentTime=d}return this}return this.elem().currentTime};c.prototype.state=function(){try{if(this.elem().ended){return"ended"}else{if(this.elem().played.length===0){return"paused"}else{if(this.elem().paused){return"paused"}else{return"playing"}}}}catch(d){return"unknown"}};c.prototype.volume=function(d){if(d&&!this._isReady){return this.ready("volume",d)}if(d!=null){this.elem().volume=d;return this}else{return this.elem().volume}};c.prototype.duration=function(){return this.data.media.duration};c.prototype.setPlayerColor=function(){};return c})()})(Wistia);(function(a){a._embed.ExternalVideo=(function(){__extends(b,a._embed.Video);function b(){b.__super__.constructor.apply(this,arguments)}b.prototype.embedType="external";b.prototype.elem=function(){return document.getElementById(this.data.uuid)};b.prototype.embed=function(c){b.__super__.embed.call(this,c);this.params.stillUrl=this.elem().childNodes[0].src;this.elem().addEventListener("click",__bind(function(){this.trigger("play");a.timeout(""+this.uuid+".fake_video_end",__bind(function(){return this.trigger("end")},this),500);return false},this));this._isReady=true;this.ready();return this};b.prototype.duration=function(){return this.data.media.duration};return b})()})(Wistia);(function(a){a.extend({tracker:function(c,b){return new a.VideoTracker(c,b||{})}});return a.VideoTracker=(function(){var i,f,h,k,d,b,g,c,e;c=g=b=e=function(){};d=false;f="";h="";i=0;k=[];function j(m,l){this.video=m;this.options=l;this.params=a.extend({transmitInterval:10000},this.options);k=[];i=new Date().getTime();this._eventKey=this.newEventKey();this._visitorKey=this.visitorKeyFromCookie()||this.newVisitorKey();this.log("initialized");if(this.video.embedType==="html5"){this.transmit()}this}j.prototype._dataPrefix=function(){var l;l='{\n"account_key":"'+this.video.data.media.accountKey+'",\n"session_id":"'+this._visitorKey+'",\n"media_id":"'+this.video.data.media.mediaKey+'",\n"event_key":"'+this._eventKey+'",\n"media_duration":'+(parseFloat(this.video.data.media.duration))+',\n"referrer":"'+(this.video.params.pageUrl||window.location.href)+'",';if(this.video.params.trackEmail){l+='"email":"'+this.video.params.trackEmail+'",'}l+='"event_details":[';return l};j.prototype._dataSuffix=function(){return"]}"};j.prototype.visitorKeyFromCookie=function(){var l,m,n;l=document.cookie.split("; ");m=0;while(m<l.length){n=l[m].split("=");if(n[0]==="__distillery"){return n[1]}m++}};j.prototype.newVisitorKey=function(){var l,m;m=(new Date().getTime()).toString()+"-"+Math.random();l=new Date();l.setTime(l.getTime()+(365*24*60*60*1000));document.cookie="__distillery="+m+"; expires="+(l.toGMTString())+"; path=/";return m};j.prototype.newEventKey=function(){if(this.video.embedType==="flash"){return this.video.getEventKey()}else{return(new Date().getTime()).toString()+"e"+Math.random()}};j.prototype.monitor=function(){c=__bind(function(){this.log("play")},this);g=__bind(function(){if(Math.abs(this.video.duration()-this.video.time())>0.3){this.log("pause")}},this);b=__bind(function(){this.log("end");this.transmit()},this);e=__bind(function(l){if(Math.abs(this.video._lastTimePosition-l)>=5){this.log("seek")}},this);d=true;this.video.bind("play",c);this.video.bind("pause",g);this.video.bind("end",b);this.video.bind("timechange",e);a.timeout(""+this.uuid+".start_tracking_timeout",__bind(function(){var l;l=__bind(function(){if(this.video.state()==="playing"){this.log("update")}this.transmit();return a.timeout(""+this.uuid+".tracking_loop",l,this.params.transmitInterval)},this);a.timeout(""+this.uuid+".tracking_loop",l,this.params.transmitInterval);this.transmit()},this),Math.random()*this.params.transmitInterval+1000);if(this.video.state()==="playing"){c()}};j.prototype.stopMonitoring=function(){d=false;this.video.unbind("play",c);this.video.unbind("pause",g);this.video.unbind("end",b);this.video.unbind("timechange",e)};j.prototype.postToDistillery=function(l){a.remote.post(""+this.video.data.media.distilleryUrl+"?data="+(encodeURIComponent(l)))};j.prototype.transmit=function(){var l;if(this.video.params.doNotTrack){return}if(k.length!==0){l=this._dataPrefix()+k.join(",")+this._dataSuffix();this.postToDistillery(a.base64.encode(l));k=[]}};j.prototype.log=function(l){var n,m;if(this.video.params.doNotTrack){return}m=this.video.time();if(m==null){if(this.video.state()==="unknown"){m=0}else{m=this.video.duration()}}m=m.toFixed(1);n=(new Date().getTime())-i;k.push('{\n"key":"'+l+'",\n"value":'+m+',\n"timeDelta":'+n+"\n}")};j.prototype.visitorKey=function(){return this._visitorKey};j.prototype.eventKey=function(){return this._eventKey};return j})()})(Wistia);Wistia.extend({base64:{_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(c){var k,h,f,j,g,e,d,b,a;b=0;a="";while(b<c.length){k=c.charCodeAt(b++);h=c.charCodeAt(b++);f=c.charCodeAt(b++);j=k>>2;g=((k&3)<<4)|(h>>4);e=((h&15)<<2)|(f>>6);d=f&63;if(isNaN(h)){e=d=64}else{if(isNaN(f)){d=64}}a=a+this._keyStr.charAt(j)+this._keyStr.charAt(g)+this._keyStr.charAt(e)+this._keyStr.charAt(d)}return a}}});(function(a){return a.extend({constant:{embedHost:"fast.wistia.com"},remote:{post:function(c){var b;b=window.XDomainRequest?new window.XDomainRequest():new window.XMLHttpRequest();b.open("POST",c,true);b.send()},media:function(b,d){var c;if(a.data(["remote-media",b])){a.timeout("remote-media."+b+"."+(a.seqId()),function(){return d(a.data(["remote-media",b]))})}else{c=""+window.location.protocol+"//"+a.constant.embedHost+"/embed/medias/"+b+".json";this.fetch(c,{},function(e){if(e.error){a.data(["remote-media",b],e);d(e)}else{a.data(["remote-media",b],e.media);d(e.media)}},{onerror:function(){if(window.console){console.log("Timed out fetching "+c)}},timeout:10000})}},playlist:function(c,d){var b;if(a.data(["remote-playlist",c])){a.timeout("remote-playlist."+c+"."+(a.seqId()),function(){return d(a.data(["remote-playlist",c]))})}else{b=""+window.location.protocol+"//"+a.constant.embedHost+"/embed/playlists/"+c+".json";this.fetch(b,{},function(e){a.data(["remote-playlist",c],e);d(e)},{onerror:function(){if(window.console){console.log("Timed out fetching "+b)}},timeout:10000})}},fetch:function(c,e,f,b){var d;if(!b.timeout){b.timeout=5000}if(!b.onerror){b.onerror=(function(){})}d=setTimeout(b.onerror,b.timeout);a.jsonp.get(c,e,function(g){clearTimeout(d);if(f){f(g)}})}}})})(Wistia);if(!Wistia.jsonp){Wistia.jsonp=(function(){var a=0,c,f,b,d=this;function e(j){var i=document.createElement("script"),h=false;i.src=j;i.async=true;i.onload=i.onreadystatechange=function(){if(!h&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){h=true;i.onload=i.onreadystatechange=null;if(i&&i.parentNode){i.parentNode.removeChild(i)}}};if(!c){c=document.getElementsByTagName("head")[0]}c.appendChild(i)}function g(h,j,k){f="?";j=j||{};for(b in j){if(j.hasOwnProperty(b)){f+=encodeURIComponent(b)+"="+encodeURIComponent(j[b])+"&"}}var i="json"+(++a);d[i]=function(l){k(l);try{delete d[i]}catch(m){}d[i]=null};e(h+f+"callback="+i);return i}return{get:g}}())}(function(a){if(!a.Plugin){a.Plugin={}}a.Plugin.Base=(function(){function b(){this.pluginName="plugin";this}b.prototype.instances=function(){return a.data(["plugins",this.pluginName,this.video.uuid])};b.prototype.register=function(c){this.video.plugins[this.uuid]=c;return a.data(["plugins",this.pluginName,this.video.uuid,this.uuid],c)};b.prototype.remove=function(){this.video.plugins[this.uuid]=null;a.removeData(["plugins",this.pluginName,this.video.uuid,this.uuid]);delete this.video.plugins[this.uuid];if(this.video.grid){a.grid.fitHorizontal(this.video);return a.grid.fitVertical(this.video)}};b.prototype.fit=function(){};b.prototype.init=function(c,d){if(c.plugins==null){c.plugins={}}this.video=c;this.options=d||{};this.params=a.extend({},d||{});return this.uuid=this.params.uuid||a.seqId("wistia_","_plugin")};return b})();return a.extend({plugin:{init:function(g,f,e){var c,b,d;d=g.charAt(0).toUpperCase()+g.substr(1);b=a.Plugin[d];c=new b();c.init(f,e);return c},instance:function(c,b,d){return a.data(["plugins",c,b.uuid,d])},remove:function(d,b,e){var c;if((c=this.instance(d,b,e))!=null){c.remove()}},isActive:function(c,b,d){return !!this.instance(c,b,d)}}})})(Wistia);
;
jive.namespace("Onboarding");define("apps/onboarding/onboarding_main",["jquery","jive/dispatcher"],function(b,a){return jive.oo.Class.extend(function(c){this.init=function(e){var d=this;d.trialVideos=[];d.resourcesInitialized=false;d.trialBean=e.trialBean;d.instanceInfoView=e.instanceInfoView;d.trialAdminData=e.trialAdminData;d.instanceURL=e.instanceURL;d.daysRemaining=e.daysRemaining;d.trialProgress=e.trialProgress;d.communityName=e.communityName;var f=b.deparam.querystring();this.initActiveQuestID();if(f.fromQ){if(f.fromQ=="WorkBetterAsATeamQuest"||f.fromQ=="HaveFewerMeetingsQuest"||f.fromQ=="LessEmailQuest"||f.fromQ=="StayInTouchQuest"||f.fromQ=="CommunityFeedbackQuest"){d.initTrialResources(false,f)}else{require(["apps/onboarding/models/onboarding_source"],function(g){d.onboardingSource=new g();d.onboardingSource.getStepData(f.fromQ).addCallback(function(h){if(h.type){require(["apps/onboarding/views/"+h.type],function(i){if(i&&i.setupPage){i.setupPage(f.fromQ,h)}})}})})}}if(d.trialBean.trialProgress.questCompletionTips.userTips.length){d.showProgressTips(d.trialBean.trialProgress.questCompletionTips)}};this.initTrialResources=function(f,e){var d=this;require(["apps/trial/views/trial_view","apps/trial/views/trial_tip_helper","apps/trial/models/trial_panel_source","apps/onboarding/models/onboarding_source","apps/shared/controllers/switchboard","apps/metric/models/metric_source"],function(l,k,j,h,g,i){d.onboardingSource=new h();d.metricSource=new i();d.trialSource=new j();d.trialView=new l();d.trialView.addListener("saveLastViewedQuest",function(m){d.trialSource.saveLastViewedQuest(m)}).addListener("saveProgress",function(m){d.trialSource.saveProgress(m)}).addListener("clearUserTipQueue",function(){d.trialSource.clearUserTipQueue()}).addListener("metric",function(n,m){d.metricSource.metric({metricName:n,metricValues:m})});d.trialTipHelper=new k({communityName:d.instanceInfoView.rootCommunityName});d.trialTipHelper.addListener("shouldSetupPage",function(m,n,o){d.trialSource.getShouldShowTips(m,n).addCallback(function(p){if(p){d.activeQuestID=m;d.activeQuestStep=n}else{d.initActiveQuestID()}o.emitSuccess(p)})}).addListener("clearActiveQuest",function(){d.initActiveQuestID()}).addListener("getAllQuestProgressData",function(m){d.trialSource.get("panel").addCallback(function(n){m.emitSuccess(n)})});a.listen("trial.updatePercentComplete",function(){d.onboardingSource.initializeView().addCallback(function(m){g.emit("onboarding.state.update",m)});d.trialSource.get("percentComplete").addCallback(function(m){if(m.questCompletionTips.userTips.length){d.showProgressTips(m.questCompletionTips)}})});if(f){d.trialView.postRender()}d.resourcesInitialized=true})};this.postPageRender=function(f){var e=this,d=f.valueCaseName,h=f.videoID,g=function(n){var l=b(jive.onboarding.onboardingProgress({percentComplete:n.percentComplete}));b("#j-onboarding-progress").replaceWith(l);if(n.percentComplete==100){b("#j-onboarding .j-onb-quest-header .js-hide-onb").show()}for(var p=0,q=n.quests.length;p<q;p++){for(var o=0,m=n.quests[p].steps.length;o<m;o++){if(n.quests[p].steps[o].state==="completed"){var k=b('#j-onboarding .js-quest-step a[data-id="'+n.quests[p].steps[o].name+'"]');if(!k.hasClass("completed")){k.addClass("completed");k.prepend(jive.onbStep.startStep.completedAriaLabel())}}}}};if(d=="trial"){if(!e.resourcesInitialized){e.initTrialResources(true,{},false)}else{e.trialView.postRender()}e.$questBodies=b("div.collaboration");e.$questHeaders=b("a.js-quest-group-header");b(".js-quest-group-header").click(function(i){i.preventDefault();var j=b(this);if(!j.hasClass("j-active")){e.$questHeaders.removeClass("j-active font-color-normal");j.addClass("j-active font-color-normal");e.$questBodies.hide();e.$questBodies.filter("[data-id="+j.data("id")+"]").show();e.onboardingSource.saveLastViewedQuest(""+j.data("id"))}})}else{if(h!="video"){e.video=Wistia.embed(h,{videoWidth:"570",videoHeight:"365",controlsVisibleOnLoad:true})}}b("div.js-trial-tip, div.js-onboarding-tip").remove();jive.switchboard.removeListener("onboarding.state.update",g).addListener("onboarding.state.update",g);b("#j-onboarding").off().on("click",".js-do-step",function(l){l.preventDefault();var j=b(this),i=j.data("type"),k=j.data("id");require(["apps/onboarding/views/"+i],function(m){m.startStep(k,e.instanceInfoView,j)})}).on("click",".js-hide-onb",function(i){i.preventDefault();require(["apps/onboarding/models/onboarding_source"],function(j){e.onboardingSource=new j();e.onboardingSource.setOnboardingVisible(false).addCallback(function(){jive.HomeNav.GlobalController.hideView("onboarding");var k=b(jive.onboarding.postHideViewTip());k.popover({context:b("#j-satNav"),container:b(".js-satellite-nav-container")});$j("body").one("click",function(){k.trigger("close")})})})}).on("click",".js-onb-show-welcome-modal",function(i){i.preventDefault();jive.HomeNav.GlobalController.showOnboardingIntroModal(false)})};this.showProgressTips=function(h){var d=this,e=null;if(h.userTips.length){$j("div.js-trial-tip").remove();for(var g=0,f=h.questCompletionData.length;g<f;g++){if(!h.questCompletionData[g].completed){e=h.questCompletionData[g].questName;break}}}for(g=0,tipsLength=h.userTips.length;g<tipsLength;g++){if(h.userTips[g]!="jive.trial.quests.fewerMeetings.questReadyToComplete"||tipsLength==1){var j=$j(jive.trial.renderProgressTip({template:h.userTips[g],nextQuestID:e}));j.delegate("#quest-complete-close","click",function(i){i.preventDefault();$j("div.js-trial-tip").remove()});$j("body").prepend(j);require(["apps/trial/models/trial_panel_source"],function(i){d.trialSource=new i();d.trialSource.clearUserTipQueue()})}}$j("html, body").animate({scrollTop:0},"fast")};c.initActiveQuestID=function(){this.activeQuestID="";this.activeQuestStep=null};this.getActiveQuestAndStep=function(){return{activeQuestID:this.activeQuestID,activeQuestStep:this.activeQuestStep}};this.tearDownView=function(){if(this.trialView){this.trialView.tearDown()}if(this.video&&this.video._isReady){this.video.remove()}}})});
;
